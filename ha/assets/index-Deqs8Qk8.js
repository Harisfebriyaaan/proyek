const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DjDS4oXJ.js","assets/vendor-G3Ew41wm.js","assets/router-CVrnbT5v.js","assets/supabase-p-WtcZUz.js","assets/icons-Bg7tw3_W.js","assets/index.es-B8fvJ6Yq.js"])))=>i.map(i=>d[i]);
import{r as ae,a as mE,b as Nd,d as B4,g as gE,c as Nx}from"./vendor-G3Ew41wm.js";import{u as hr,a as Dy,L as vE,B as xE,R as bE,b as ur,N as Fn}from"./router-CVrnbT5v.js";import{c as yE,_ as gg}from"./supabase-p-WtcZUz.js";import{I as Hb,B as z4,C as Eu,a as Vt,M as T0,L as ml,E as wE,b as Wb,U as U4,c as ar,S as Wc,d as kd,e as Al,f as NE,g as Rn,h as _i,i as ji,j as Xi,k as lo,X as Si,l as Du,F as El,T as Ln,A as q4,R as Ty,D as Xf,m as H4,n as _5,o as W4,p as kf,q as xo,r as Gb,s as kE,t as vg,u as xg,v as Yr,P as SE,w as _E,x as Zh,y as ha,z as Gc,G as jE,H as R0,J as Hd,K as G4,N as j5,O as C5,Q as Sd,V as V4,W as CE,Y as AE,Z as EE}from"./icons-Bg7tw3_W.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var K4={exports:{}},L0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DE=Symbol.for("react.transitional.element"),TE=Symbol.for("react.fragment");function $4(e,t,n){var a=null;if(n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),"key"in t){n={};for(var r in t)r!=="key"&&(n[r]=t[r])}else n=t;return t=n.ref,{$$typeof:DE,type:e,key:a,ref:t!==void 0?t:null,props:n}}L0.Fragment=TE;L0.jsx=$4;L0.jsxs=$4;K4.exports=L0;var l=K4.exports,Y4={exports:{}},P0={},X4={exports:{}},J4={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(I,F){var q=I.length;I.push(F);e:for(;0<q;){var O=q-1>>>1,$=I[O];if(0<r($,F))I[O]=F,I[q]=$,q=O;else break e}}function n(I){return I.length===0?null:I[0]}function a(I){if(I.length===0)return null;var F=I[0],q=I.pop();if(q!==F){I[0]=q;e:for(var O=0,$=I.length,Z=$>>>1;O<Z;){var P=2*(O+1)-1,W=I[P],K=P+1,J=I[K];if(0>r(W,q))K<$&&0>r(J,W)?(I[O]=J,I[K]=q,O=K):(I[O]=W,I[P]=q,O=P);else if(K<$&&0>r(J,q))I[O]=J,I[K]=q,O=K;else break e}}return F}function r(I,F){var q=I.sortIndex-F.sortIndex;return q!==0?q:I.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],c=[],d=1,h=null,p=3,f=!1,g=!1,b=!1,w=!1,m=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function N(I){for(var F=n(c);F!==null;){if(F.callback===null)a(c);else if(F.startTime<=I)a(c),F.sortIndex=F.expirationTime,t(u,F);else break;F=n(c)}}function S(I){if(b=!1,N(I),!g)if(n(u)!==null)g=!0,T||(T=!0,D());else{var F=n(c);F!==null&&U(S,F.startTime-I)}}var T=!1,C=-1,A=5,R=-1;function L(){return w?!0:!(e.unstable_now()-R<A)}function j(){if(w=!1,T){var I=e.unstable_now();R=I;var F=!0;try{e:{g=!1,b&&(b=!1,x(C),C=-1),f=!0;var q=p;try{t:{for(N(I),h=n(u);h!==null&&!(h.expirationTime>I&&L());){var O=h.callback;if(typeof O=="function"){h.callback=null,p=h.priorityLevel;var $=O(h.expirationTime<=I);if(I=e.unstable_now(),typeof $=="function"){h.callback=$,N(I),F=!0;break t}h===n(u)&&a(u),N(I)}else a(u);h=n(u)}if(h!==null)F=!0;else{var Z=n(c);Z!==null&&U(S,Z.startTime-I),F=!1}}break e}finally{h=null,p=q,f=!1}F=void 0}}finally{F?D():T=!1}}}var D;if(typeof y=="function")D=function(){y(j)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,z=B.port2;B.port1.onmessage=j,D=function(){z.postMessage(null)}}else D=function(){m(j,0)};function U(I,F){C=m(function(){I(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(I){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var q=p;p=F;try{return I()}finally{p=q}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(I,F){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var q=p;p=I;try{return F()}finally{p=q}},e.unstable_scheduleCallback=function(I,F,q){var O=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?O+q:O):q=O,I){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=q+$,I={id:d++,callback:F,priorityLevel:I,startTime:q,expirationTime:$,sortIndex:-1},q>O?(I.sortIndex=q,t(c,I),n(u)===null&&I===n(c)&&(b?(x(C),C=-1):b=!0,U(S,q-O))):(I.sortIndex=$,t(u,I),g||f||(g=!0,T||(T=!0,D()))),I},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(I){var F=p;return function(){var q=p;p=F;try{return I.apply(this,arguments)}finally{p=q}}}})(J4);X4.exports=J4;var RE=X4.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ga=RE,Q4=ae,LE=mE;function We(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Z4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Jf(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ek(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function A5(e){if(Jf(e)!==e)throw Error(We(188))}function PE(e){var t=e.alternate;if(!t){if(t=Jf(e),t===null)throw Error(We(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(a=r.return,a!==null){n=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return A5(r),e;if(i===a)return A5(r),t;i=i.sibling}throw Error(We(188))}if(n.return!==a.return)n=r,a=i;else{for(var s=!1,o=r.child;o;){if(o===n){s=!0,n=r,a=i;break}if(o===a){s=!0,a=r,n=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===n){s=!0,n=i,a=r;break}if(o===a){s=!0,a=i,n=r;break}o=o.sibling}if(!s)throw Error(We(189))}}if(n.alternate!==a)throw Error(We(190))}if(n.tag!==3)throw Error(We(188));return n.stateNode.current===n?e:t}function tk(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=tk(e),t!==null)return t;e=e.sibling}return null}var Sn=Object.assign,ME=Symbol.for("react.element"),bm=Symbol.for("react.transitional.element"),$h=Symbol.for("react.portal"),Vc=Symbol.for("react.fragment"),nk=Symbol.for("react.strict_mode"),Vb=Symbol.for("react.profiler"),IE=Symbol.for("react.provider"),ak=Symbol.for("react.consumer"),uo=Symbol.for("react.context"),Ry=Symbol.for("react.forward_ref"),Kb=Symbol.for("react.suspense"),$b=Symbol.for("react.suspense_list"),Ly=Symbol.for("react.memo"),Qo=Symbol.for("react.lazy"),Yb=Symbol.for("react.activity"),OE=Symbol.for("react.memo_cache_sentinel"),E5=Symbol.iterator;function Ph(e){return e===null||typeof e!="object"?null:(e=E5&&e[E5]||e["@@iterator"],typeof e=="function"?e:null)}var FE=Symbol.for("react.client.reference");function Xb(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===FE?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vc:return"Fragment";case Vb:return"Profiler";case nk:return"StrictMode";case Kb:return"Suspense";case $b:return"SuspenseList";case Yb:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case $h:return"Portal";case uo:return(e.displayName||"Context")+".Provider";case ak:return(e._context.displayName||"Context")+".Consumer";case Ry:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ly:return t=e.displayName||null,t!==null?t:Xb(e.type)||"Memo";case Qo:t=e._payload,e=e._init;try{return Xb(e(t))}catch{}}return null}var Yh=Array.isArray,kt=Q4.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Zt=LE.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,mu={pending:!1,data:null,method:null,action:null},Jb=[],Kc=-1;function Is(e){return{current:e}}function Ca(e){0>Kc||(e.current=Jb[Kc],Jb[Kc]=null,Kc--)}function Cn(e,t){Kc++,Jb[Kc]=e.current,e.current=t}var js=Is(null),Sf=Is(null),gl=Is(null),bg=Is(null);function yg(e,t){switch(Cn(gl,t),Cn(Sf,e),Cn(js,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?PN(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=PN(t),e=y_(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Ca(js),Cn(js,e)}function _d(){Ca(js),Ca(Sf),Ca(gl)}function Qb(e){e.memoizedState!==null&&Cn(bg,e);var t=js.current,n=y_(t,e.type);t!==n&&(Cn(Sf,e),Cn(js,n))}function wg(e){Sf.current===e&&(Ca(js),Ca(Sf)),bg.current===e&&(Ca(bg),Pf._currentValue=mu)}var Zb=Object.prototype.hasOwnProperty,Py=ga.unstable_scheduleCallback,kx=ga.unstable_cancelCallback,BE=ga.unstable_shouldYield,zE=ga.unstable_requestPaint,Cs=ga.unstable_now,UE=ga.unstable_getCurrentPriorityLevel,rk=ga.unstable_ImmediatePriority,ik=ga.unstable_UserBlockingPriority,Ng=ga.unstable_NormalPriority,qE=ga.unstable_LowPriority,sk=ga.unstable_IdlePriority,HE=ga.log,WE=ga.unstable_setDisableYieldValue,Qf=null,Xr=null;function il(e){if(typeof HE=="function"&&WE(e),Xr&&typeof Xr.setStrictMode=="function")try{Xr.setStrictMode(Qf,e)}catch{}}var Jr=Math.clz32?Math.clz32:KE,GE=Math.log,VE=Math.LN2;function KE(e){return e>>>=0,e===0?32:31-(GE(e)/VE|0)|0}var ym=256,wm=4194304;function ru(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function M0(e,t,n){var a=e.pendingLanes;if(a===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=a&134217727;return o!==0?(a=o&~i,a!==0?r=ru(a):(s&=o,s!==0?r=ru(s):n||(n=o&~e,n!==0&&(r=ru(n))))):(o=a&~i,o!==0?r=ru(o):s!==0?r=ru(s):n||(n=a&~e,n!==0&&(r=ru(n)))),r===0?0:t!==0&&t!==r&&!(t&i)&&(i=r&-r,n=t&-t,i>=n||i===32&&(n&4194048)!==0)?t:r}function Zf(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function $E(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ok(){var e=ym;return ym<<=1,!(ym&4194048)&&(ym=256),e}function lk(){var e=wm;return wm<<=1,!(wm&62914560)&&(wm=4194304),e}function Sx(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ep(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function YE(e,t,n,a,r,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,u=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var d=31-Jr(n),h=1<<d;o[d]=0,u[d]=-1;var p=c[d];if(p!==null)for(c[d]=null,d=0;d<p.length;d++){var f=p[d];f!==null&&(f.lane&=-536870913)}n&=~h}a!==0&&uk(e,a,0),i!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=i&~(s&~t))}function uk(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-Jr(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|n&4194090}function ck(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-Jr(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}function My(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Iy(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function dk(){var e=Zt.p;return e!==0?e:(e=window.event,e===void 0?32:D_(e.type))}function XE(e,t){var n=Zt.p;try{return Zt.p=e,t()}finally{Zt.p=n}}var Ol=Math.random().toString(36).slice(2),Za="__reactFiber$"+Ol,Ar="__reactProps$"+Ol,Wd="__reactContainer$"+Ol,e1="__reactEvents$"+Ol,JE="__reactListeners$"+Ol,QE="__reactHandles$"+Ol,D5="__reactResources$"+Ol,tp="__reactMarker$"+Ol;function Oy(e){delete e[Za],delete e[Ar],delete e[e1],delete e[JE],delete e[QE]}function $c(e){var t=e[Za];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Wd]||n[Za]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ON(e);e!==null;){if(n=e[Za])return n;e=ON(e)}return t}e=n,n=e.parentNode}return null}function Gd(e){if(e=e[Za]||e[Wd]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function Xh(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(We(33))}function rd(e){var t=e[D5];return t||(t=e[D5]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function _a(e){e[tp]=!0}var hk=new Set,fk={};function Fu(e,t){jd(e,t),jd(e+"Capture",t)}function jd(e,t){for(fk[e]=t,e=0;e<t.length;e++)hk.add(t[e])}var ZE=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),T5={},R5={};function eD(e){return Zb.call(R5,e)?!0:Zb.call(T5,e)?!1:ZE.test(e)?R5[e]=!0:(T5[e]=!0,!1)}function ng(e,t,n){if(eD(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Nm(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Zs(e,t,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+a)}}var _x,L5;function Mc(e){if(_x===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);_x=t&&t[1]||"",L5=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_x+e+L5}var jx=!1;function Cx(e,t){if(!e||jx)return"";jx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(f){var p=f}Reflect.construct(e,[],h)}else{try{h.call()}catch(f){p=f}e.call(h.prototype)}}else{try{throw Error()}catch(f){p=f}(h=e())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(f){if(f&&p&&typeof f.stack=="string")return[f.stack,p.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=a.DetermineComponentFrameRoot(),s=i[0],o=i[1];if(s&&o){var u=s.split(`
`),c=o.split(`
`);for(r=a=0;a<u.length&&!u[a].includes("DetermineComponentFrameRoot");)a++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(a===u.length||r===c.length)for(a=u.length-1,r=c.length-1;1<=a&&0<=r&&u[a]!==c[r];)r--;for(;1<=a&&0<=r;a--,r--)if(u[a]!==c[r]){if(a!==1||r!==1)do if(a--,r--,0>r||u[a]!==c[r]){var d=`
`+u[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=r);break}}}finally{jx=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Mc(n):""}function tD(e){switch(e.tag){case 26:case 27:case 5:return Mc(e.type);case 16:return Mc("Lazy");case 13:return Mc("Suspense");case 19:return Mc("SuspenseList");case 0:case 15:return Cx(e.type,!1);case 11:return Cx(e.type.render,!1);case 1:return Cx(e.type,!0);case 31:return Mc("Activity");default:return""}}function P5(e){try{var t="";do t+=tD(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function mi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function nD(e){var t=pk(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(s){a=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(s){a=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function kg(e){e._valueTracker||(e._valueTracker=nD(e))}function mk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=pk(e)?e.checked?"true":"false":e.value),e=a,e!==n?(t.setValue(e),!0):!1}function Sg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var aD=/[\n"\\]/g;function bi(e){return e.replace(aD,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function t1(e,t,n,a,r,i,s,o){e.name="",s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"?e.type=s:e.removeAttribute("type"),t!=null?s==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+mi(t)):e.value!==""+mi(t)&&(e.value=""+mi(t)):s!=="submit"&&s!=="reset"||e.removeAttribute("value"),t!=null?n1(e,s,mi(t)):n!=null?n1(e,s,mi(n)):a!=null&&e.removeAttribute("value"),r==null&&i!=null&&(e.defaultChecked=!!i),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.name=""+mi(o):e.removeAttribute("name")}function gk(e,t,n,a,r,i,s,o){if(i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"&&(e.type=i),t!=null||n!=null){if(!(i!=="submit"&&i!=="reset"||t!=null))return;n=n!=null?""+mi(n):"",t=t!=null?""+mi(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}a=a??r,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.name=s)}function n1(e,t,n){t==="number"&&Sg(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function id(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+mi(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,a&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function vk(e,t,n){if(t!=null&&(t=""+mi(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+mi(n):""}function xk(e,t,n,a){if(t==null){if(a!=null){if(n!=null)throw Error(We(92));if(Yh(a)){if(1<a.length)throw Error(We(93));a=a[0]}n=a}n==null&&(n=""),t=n}n=mi(t),e.defaultValue=n,a=e.textContent,a===n&&a!==""&&a!==null&&(e.value=a)}function Cd(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rD=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function M5(e,t,n){var a=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,n):typeof n!="number"||n===0||rD.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function bk(e,t,n){if(t!=null&&typeof t!="object")throw Error(We(62));if(e=e.style,n!=null){for(var a in n)!n.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var r in t)a=t[r],t.hasOwnProperty(r)&&n[r]!==a&&M5(e,r,a)}else for(var i in t)t.hasOwnProperty(i)&&M5(e,i,t[i])}function Fy(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iD=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),sD=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ag(e){return sD.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var a1=null;function By(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Yc=null,sd=null;function I5(e){var t=Gd(e);if(t&&(e=t.stateNode)){var n=e[Ar]||null;e:switch(e=t.stateNode,t.type){case"input":if(t1(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+bi(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=a[Ar]||null;if(!r)throw Error(We(90));t1(a,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)a=n[t],a.form===e.form&&mk(a)}break e;case"textarea":vk(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&id(e,!!n.multiple,t,!1)}}}var Ax=!1;function yk(e,t,n){if(Ax)return e(t,n);Ax=!0;try{var a=e(t);return a}finally{if(Ax=!1,(Yc!==null||sd!==null)&&(G0(),Yc&&(t=Yc,e=sd,sd=Yc=null,I5(t),e)))for(t=0;t<e.length;t++)I5(e[t])}}function _f(e,t){var n=e.stateNode;if(n===null)return null;var a=n[Ar]||null;if(a===null)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(We(231,t,typeof n));return n}var bo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),r1=!1;if(bo)try{var Mh={};Object.defineProperty(Mh,"passive",{get:function(){r1=!0}}),window.addEventListener("test",Mh,Mh),window.removeEventListener("test",Mh,Mh)}catch{r1=!1}var sl=null,zy=null,rg=null;function wk(){if(rg)return rg;var e,t=zy,n=t.length,a,r="value"in sl?sl.value:sl.textContent,i=r.length;for(e=0;e<n&&t[e]===r[e];e++);var s=n-e;for(a=1;a<=s&&t[n-a]===r[i-a];a++);return rg=r.slice(e,1<a?1-a:void 0)}function ig(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function km(){return!0}function O5(){return!1}function Tr(e){function t(n,a,r,i,s){this._reactName=n,this._targetInst=r,this.type=a,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?km:O5,this.isPropagationStopped=O5,this}return Sn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=km)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=km)},persist:function(){},isPersistent:km}),t}var Bu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},I0=Tr(Bu),np=Sn({},Bu,{view:0,detail:0}),oD=Tr(np),Ex,Dx,Ih,O0=Sn({},np,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uy,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ih&&(Ih&&e.type==="mousemove"?(Ex=e.screenX-Ih.screenX,Dx=e.screenY-Ih.screenY):Dx=Ex=0,Ih=e),Ex)},movementY:function(e){return"movementY"in e?e.movementY:Dx}}),F5=Tr(O0),lD=Sn({},O0,{dataTransfer:0}),uD=Tr(lD),cD=Sn({},np,{relatedTarget:0}),Tx=Tr(cD),dD=Sn({},Bu,{animationName:0,elapsedTime:0,pseudoElement:0}),hD=Tr(dD),fD=Sn({},Bu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pD=Tr(fD),mD=Sn({},Bu,{data:0}),B5=Tr(mD),gD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bD(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xD[e])?!!t[e]:!1}function Uy(){return bD}var yD=Sn({},np,{key:function(e){if(e.key){var t=gD[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ig(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vD[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uy,charCode:function(e){return e.type==="keypress"?ig(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ig(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wD=Tr(yD),ND=Sn({},O0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z5=Tr(ND),kD=Sn({},np,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uy}),SD=Tr(kD),_D=Sn({},Bu,{propertyName:0,elapsedTime:0,pseudoElement:0}),jD=Tr(_D),CD=Sn({},O0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),AD=Tr(CD),ED=Sn({},Bu,{newState:0,oldState:0}),DD=Tr(ED),TD=[9,13,27,32],qy=bo&&"CompositionEvent"in window,ef=null;bo&&"documentMode"in document&&(ef=document.documentMode);var RD=bo&&"TextEvent"in window&&!ef,Nk=bo&&(!qy||ef&&8<ef&&11>=ef),U5=" ",q5=!1;function kk(e,t){switch(e){case"keyup":return TD.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xc=!1;function LD(e,t){switch(e){case"compositionend":return Sk(t);case"keypress":return t.which!==32?null:(q5=!0,U5);case"textInput":return e=t.data,e===U5&&q5?null:e;default:return null}}function PD(e,t){if(Xc)return e==="compositionend"||!qy&&kk(e,t)?(e=wk(),rg=zy=sl=null,Xc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nk&&t.locale!=="ko"?null:t.data;default:return null}}var MD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function H5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!MD[e.type]:t==="textarea"}function _k(e,t,n,a){Yc?sd?sd.push(a):sd=[a]:Yc=a,t=qg(t,"onChange"),0<t.length&&(n=new I0("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var tf=null,jf=null;function ID(e){v_(e,0)}function F0(e){var t=Xh(e);if(mk(t))return e}function W5(e,t){if(e==="change")return t}var jk=!1;if(bo){var Rx;if(bo){var Lx="oninput"in document;if(!Lx){var G5=document.createElement("div");G5.setAttribute("oninput","return;"),Lx=typeof G5.oninput=="function"}Rx=Lx}else Rx=!1;jk=Rx&&(!document.documentMode||9<document.documentMode)}function V5(){tf&&(tf.detachEvent("onpropertychange",Ck),jf=tf=null)}function Ck(e){if(e.propertyName==="value"&&F0(jf)){var t=[];_k(t,jf,e,By(e)),yk(ID,t)}}function OD(e,t,n){e==="focusin"?(V5(),tf=t,jf=n,tf.attachEvent("onpropertychange",Ck)):e==="focusout"&&V5()}function FD(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return F0(jf)}function BD(e,t){if(e==="click")return F0(t)}function zD(e,t){if(e==="input"||e==="change")return F0(t)}function UD(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ti=typeof Object.is=="function"?Object.is:UD;function Cf(e,t){if(ti(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!Zb.call(t,r)||!ti(e[r],t[r]))return!1}return!0}function K5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $5(e,t){var n=K5(e);e=0;for(var a;n;){if(n.nodeType===3){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=K5(n)}}function Ak(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ak(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ek(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Sg(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Sg(e.document)}return t}function Hy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var qD=bo&&"documentMode"in document&&11>=document.documentMode,Jc=null,i1=null,nf=null,s1=!1;function Y5(e,t,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;s1||Jc==null||Jc!==Sg(a)||(a=Jc,"selectionStart"in a&&Hy(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),nf&&Cf(nf,a)||(nf=a,a=qg(i1,"onSelect"),0<a.length&&(t=new I0("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=Jc)))}function tu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Qc={animationend:tu("Animation","AnimationEnd"),animationiteration:tu("Animation","AnimationIteration"),animationstart:tu("Animation","AnimationStart"),transitionrun:tu("Transition","TransitionRun"),transitionstart:tu("Transition","TransitionStart"),transitioncancel:tu("Transition","TransitionCancel"),transitionend:tu("Transition","TransitionEnd")},Px={},Dk={};bo&&(Dk=document.createElement("div").style,"AnimationEvent"in window||(delete Qc.animationend.animation,delete Qc.animationiteration.animation,delete Qc.animationstart.animation),"TransitionEvent"in window||delete Qc.transitionend.transition);function zu(e){if(Px[e])return Px[e];if(!Qc[e])return e;var t=Qc[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Dk)return Px[e]=t[n];return e}var Tk=zu("animationend"),Rk=zu("animationiteration"),Lk=zu("animationstart"),HD=zu("transitionrun"),WD=zu("transitionstart"),GD=zu("transitioncancel"),Pk=zu("transitionend"),Mk=new Map,o1="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");o1.push("scrollEnd");function Ji(e,t){Mk.set(e,t),Fu(t,[e])}var X5=new WeakMap;function yi(e,t){if(typeof e=="object"&&e!==null){var n=X5.get(e);return n!==void 0?n:(t={value:e,source:t,stack:P5(t)},X5.set(e,t),t)}return{value:e,source:t,stack:P5(t)}}var pi=[],Zc=0,Wy=0;function B0(){for(var e=Zc,t=Wy=Zc=0;t<e;){var n=pi[t];pi[t++]=null;var a=pi[t];pi[t++]=null;var r=pi[t];pi[t++]=null;var i=pi[t];if(pi[t++]=null,a!==null&&r!==null){var s=a.pending;s===null?r.next=r:(r.next=s.next,s.next=r),a.pending=r}i!==0&&Ik(n,r,i)}}function z0(e,t,n,a){pi[Zc++]=e,pi[Zc++]=t,pi[Zc++]=n,pi[Zc++]=a,Wy|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function Gy(e,t,n,a){return z0(e,t,n,a),_g(e)}function Vd(e,t){return z0(e,null,null,t),_g(e)}function Ik(e,t,n){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n);for(var r=!1,i=e.return;i!==null;)i.childLanes|=n,a=i.alternate,a!==null&&(a.childLanes|=n),i.tag===22&&(e=i.stateNode,e===null||e._visibility&1||(r=!0)),e=i,i=i.return;return e.tag===3?(i=e.stateNode,r&&t!==null&&(r=31-Jr(n),e=i.hiddenUpdates,a=e[r],a===null?e[r]=[t]:a.push(t),t.lane=n|536870912),i):null}function _g(e){if(50<ff)throw ff=0,A1=null,Error(We(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ed={};function VD(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(e,t,n,a){return new VD(e,t,n,a)}function Vy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mo(e,t){var n=e.alternate;return n===null?(n=Wr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Ok(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function sg(e,t,n,a,r,i){var s=0;if(a=e,typeof e=="function")Vy(e)&&(s=1);else if(typeof e=="string")s=$T(e,n,js.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Yb:return e=Wr(31,n,t,r),e.elementType=Yb,e.lanes=i,e;case Vc:return gu(n.children,r,i,t);case nk:s=8,r|=24;break;case Vb:return e=Wr(12,n,t,r|2),e.elementType=Vb,e.lanes=i,e;case Kb:return e=Wr(13,n,t,r),e.elementType=Kb,e.lanes=i,e;case $b:return e=Wr(19,n,t,r),e.elementType=$b,e.lanes=i,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case IE:case uo:s=10;break e;case ak:s=9;break e;case Ry:s=11;break e;case Ly:s=14;break e;case Qo:s=16,a=null;break e}s=29,n=Error(We(130,e===null?"null":typeof e,"")),a=null}return t=Wr(s,n,t,r),t.elementType=e,t.type=a,t.lanes=i,t}function gu(e,t,n,a){return e=Wr(7,e,a,t),e.lanes=n,e}function Mx(e,t,n){return e=Wr(6,e,null,t),e.lanes=n,e}function Ix(e,t,n){return t=Wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var td=[],nd=0,jg=null,Cg=0,gi=[],vi=0,vu=null,co=1,ho="";function iu(e,t){td[nd++]=Cg,td[nd++]=jg,jg=e,Cg=t}function Fk(e,t,n){gi[vi++]=co,gi[vi++]=ho,gi[vi++]=vu,vu=e;var a=co;e=ho;var r=32-Jr(a)-1;a&=~(1<<r),n+=1;var i=32-Jr(t)+r;if(30<i){var s=r-r%5;i=(a&(1<<s)-1).toString(32),a>>=s,r-=s,co=1<<32-Jr(t)+r|n<<r|a,ho=i+e}else co=1<<i|n<<r|a,ho=e}function Ky(e){e.return!==null&&(iu(e,1),Fk(e,1,0))}function $y(e){for(;e===jg;)jg=td[--nd],td[nd]=null,Cg=td[--nd],td[nd]=null;for(;e===vu;)vu=gi[--vi],gi[vi]=null,ho=gi[--vi],gi[vi]=null,co=gi[--vi],gi[vi]=null}var cr=null,Un=null,Xt=!1,xu=null,xs=!1,l1=Error(We(519));function Tu(e){var t=Error(We(418,""));throw Af(yi(t,e)),l1}function J5(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[Za]=e,t[Ar]=a,n){case"dialog":Ft("cancel",t),Ft("close",t);break;case"iframe":case"object":case"embed":Ft("load",t);break;case"video":case"audio":for(n=0;n<Tf.length;n++)Ft(Tf[n],t);break;case"source":Ft("error",t);break;case"img":case"image":case"link":Ft("error",t),Ft("load",t);break;case"details":Ft("toggle",t);break;case"input":Ft("invalid",t),gk(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),kg(t);break;case"select":Ft("invalid",t);break;case"textarea":Ft("invalid",t),xk(t,a.value,a.defaultValue,a.children),kg(t)}n=a.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||a.suppressHydrationWarning===!0||b_(t.textContent,n)?(a.popover!=null&&(Ft("beforetoggle",t),Ft("toggle",t)),a.onScroll!=null&&Ft("scroll",t),a.onScrollEnd!=null&&Ft("scrollend",t),a.onClick!=null&&(t.onclick=$0),t=!0):t=!1,t||Tu(e)}function Q5(e){for(cr=e.return;cr;)switch(cr.tag){case 5:case 13:xs=!1;return;case 27:case 3:xs=!0;return;default:cr=cr.return}}function Oh(e){if(e!==cr)return!1;if(!Xt)return Q5(e),Xt=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||P1(e.type,e.memoizedProps)),n=!n),n&&Un&&Tu(e),Q5(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(We(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){Un=$i(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}Un=null}}else t===27?(t=Un,Fl(e.type)?(e=O1,O1=null,Un=e):Un=t):Un=cr?$i(e.stateNode.nextSibling):null;return!0}function ap(){Un=cr=null,Xt=!1}function Z5(){var e=xu;return e!==null&&(kr===null?kr=e:kr.push.apply(kr,e),xu=null),e}function Af(e){xu===null?xu=[e]:xu.push(e)}var u1=Is(null),Uu=null,fo=null;function el(e,t,n){Cn(u1,t._currentValue),t._currentValue=n}function go(e){e._currentValue=u1.current,Ca(u1)}function c1(e,t,n){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function d1(e,t,n,a){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var i=r.dependencies;if(i!==null){var s=r.child;i=i.firstContext;e:for(;i!==null;){var o=i;i=r;for(var u=0;u<t.length;u++)if(o.context===t[u]){i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),c1(i.return,n,e),a||(s=null);break e}i=o.next}}else if(r.tag===18){if(s=r.return,s===null)throw Error(We(341));s.lanes|=n,i=s.alternate,i!==null&&(i.lanes|=n),c1(s,n,e),s=null}else s=r.child;if(s!==null)s.return=r;else for(s=r;s!==null;){if(s===e){s=null;break}if(r=s.sibling,r!==null){r.return=s.return,s=r;break}s=s.return}r=s}}function rp(e,t,n,a){e=null;for(var r=t,i=!1;r!==null;){if(!i){if(r.flags&524288)i=!0;else if(r.flags&262144)break}if(r.tag===10){var s=r.alternate;if(s===null)throw Error(We(387));if(s=s.memoizedProps,s!==null){var o=r.type;ti(r.pendingProps.value,s.value)||(e!==null?e.push(o):e=[o])}}else if(r===bg.current){if(s=r.alternate,s===null)throw Error(We(387));s.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(Pf):e=[Pf])}r=r.return}e!==null&&d1(t,e,n,a),t.flags|=262144}function Ag(e){for(e=e.firstContext;e!==null;){if(!ti(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ru(e){Uu=e,fo=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function er(e){return Bk(Uu,e)}function Sm(e,t){return Uu===null&&Ru(e),Bk(e,t)}function Bk(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},fo===null){if(e===null)throw Error(We(308));fo=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else fo=fo.next=t;return n}var KD=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},$D=ga.unstable_scheduleCallback,YD=ga.unstable_NormalPriority,da={$$typeof:uo,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yy(){return{controller:new KD,data:new Map,refCount:0}}function ip(e){e.refCount--,e.refCount===0&&$D(YD,function(){e.controller.abort()})}var af=null,h1=0,Ad=0,od=null;function XD(e,t){if(af===null){var n=af=[];h1=0,Ad=x2(),od={status:"pending",value:void 0,then:function(a){n.push(a)}}}return h1++,t.then(eN,eN),t}function eN(){if(--h1===0&&af!==null){od!==null&&(od.status="fulfilled");var e=af;af=null,Ad=0,od=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function JD(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(a.status="rejected",a.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),a}var tN=kt.S;kt.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&XD(e,t),tN!==null&&tN(e,t)};var bu=Is(null);function Xy(){var e=bu.current;return e!==null?e:bn.pooledCache}function og(e,t){t===null?Cn(bu,bu.current):Cn(bu,t.pool)}function zk(){var e=Xy();return e===null?null:{parent:da._currentValue,pool:e}}var sp=Error(We(460)),Uk=Error(We(474)),U0=Error(We(542)),f1={then:function(){}};function nN(e){return e=e.status,e==="fulfilled"||e==="rejected"}function _m(){}function qk(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(_m,_m),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,rN(e),e;default:if(typeof t.status=="string")t.then(_m,_m);else{if(e=bn,e!==null&&100<e.shellSuspendCounter)throw Error(We(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=a}},function(a){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,rN(e),e}throw rf=t,sp}}var rf=null;function aN(){if(rf===null)throw Error(We(459));var e=rf;return rf=null,e}function rN(e){if(e===sp||e===U0)throw Error(We(483))}var Zo=!1;function Jy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function p1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function vl(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function xl(e,t,n){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,on&2){var r=a.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),a.pending=t,t=_g(e),Ik(e,null,n),t}return z0(e,a,t,n),_g(e)}function sf(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,ck(e,n)}}function Ox(e,t){var n=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};i===null?r=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?r=i=t:i=i.next=t}else r=i=t;n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:a.shared,callbacks:a.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var m1=!1;function of(){if(m1){var e=od;if(e!==null)throw e}}function lf(e,t,n,a){m1=!1;var r=e.updateQueue;Zo=!1;var i=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var u=o,c=u.next;u.next=null,s===null?i=c:s.next=c,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=r.baseState;s=0,d=c=u=null,o=i;do{var p=o.lane&-536870913,f=p!==o.lane;if(f?(Ht&p)===p:(a&p)===p){p!==0&&p===Ad&&(m1=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=e,b=o;p=t;var w=n;switch(b.tag){case 1:if(g=b.payload,typeof g=="function"){h=g.call(w,h,p);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,p=typeof g=="function"?g.call(w,h,p):g,p==null)break e;h=Sn({},h,p);break e;case 2:Zo=!0}}p=o.callback,p!==null&&(e.flags|=64,f&&(e.flags|=8192),f=r.callbacks,f===null?r.callbacks=[p]:f.push(p))}else f={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=f,u=h):d=d.next=f,s|=p;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;f=o,o=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);d===null&&(u=h),r.baseState=u,r.firstBaseUpdate=c,r.lastBaseUpdate=d,i===null&&(r.shared.lanes=0),Rl|=s,e.lanes=s,e.memoizedState=h}}function Hk(e,t){if(typeof e!="function")throw Error(We(191,e));e.call(t)}function Wk(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Hk(n[e],t)}var Ed=Is(null),Eg=Is(0);function iN(e,t){e=No,Cn(Eg,e),Cn(Ed,t),No=e|t.baseLanes}function g1(){Cn(Eg,No),Cn(Ed,Ed.current)}function Qy(){No=Eg.current,Ca(Ed),Ca(Eg)}var Dl=0,It=null,hn=null,ra=null,Dg=!1,ld=!1,Lu=!1,Tg=0,Ef=0,ud=null,QD=0;function Vn(){throw Error(We(321))}function Zy(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ti(e[n],t[n]))return!1;return!0}function e2(e,t,n,a,r,i){return Dl=i,It=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,kt.H=e===null||e.memoizedState===null?wS:NS,Lu=!1,i=n(a,r),Lu=!1,ld&&(i=Vk(t,n,a,r)),Gk(e),i}function Gk(e){kt.H=Rg;var t=hn!==null&&hn.next!==null;if(Dl=0,ra=hn=It=null,Dg=!1,Ef=0,ud=null,t)throw Error(We(300));e===null||ja||(e=e.dependencies,e!==null&&Ag(e)&&(ja=!0))}function Vk(e,t,n,a){It=e;var r=0;do{if(ld&&(ud=null),Ef=0,ld=!1,25<=r)throw Error(We(301));if(r+=1,ra=hn=null,e.updateQueue!=null){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,i.memoCache!=null&&(i.memoCache.index=0)}kt.H=iT,i=t(n,a)}while(ld);return i}function ZD(){var e=kt.H,t=e.useState()[0];return t=typeof t.then=="function"?op(t):t,e=e.useState()[0],(hn!==null?hn.memoizedState:null)!==e&&(It.flags|=1024),t}function t2(){var e=Tg!==0;return Tg=0,e}function n2(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function a2(e){if(Dg){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Dg=!1}Dl=0,ra=hn=It=null,ld=!1,Ef=Tg=0,ud=null}function wr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ra===null?It.memoizedState=ra=e:ra=ra.next=e,ra}function sa(){if(hn===null){var e=It.alternate;e=e!==null?e.memoizedState:null}else e=hn.next;var t=ra===null?It.memoizedState:ra.next;if(t!==null)ra=t,hn=e;else{if(e===null)throw It.alternate===null?Error(We(467)):Error(We(310));hn=e,e={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},ra===null?It.memoizedState=ra=e:ra=ra.next=e}return ra}function r2(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function op(e){var t=Ef;return Ef+=1,ud===null&&(ud=[]),e=qk(ud,e,t),t=It,(ra===null?t.memoizedState:ra.next)===null&&(t=t.alternate,kt.H=t===null||t.memoizedState===null?wS:NS),e}function q0(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return op(e);if(e.$$typeof===uo)return er(e)}throw Error(We(438,String(e)))}function i2(e){var t=null,n=It.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var a=It.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=r2(),It.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=OE;return t.index++,n}function yo(e,t){return typeof t=="function"?t(e):t}function lg(e){var t=sa();return s2(t,hn,e)}function s2(e,t,n){var a=e.queue;if(a===null)throw Error(We(311));a.lastRenderedReducer=n;var r=e.baseQueue,i=a.pending;if(i!==null){if(r!==null){var s=r.next;r.next=i.next,i.next=s}t.baseQueue=r=i,a.pending=null}if(i=e.baseState,r===null)e.memoizedState=i;else{t=r.next;var o=s=null,u=null,c=t,d=!1;do{var h=c.lane&-536870913;if(h!==c.lane?(Ht&h)===h:(Dl&h)===h){var p=c.revertLane;if(p===0)u!==null&&(u=u.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===Ad&&(d=!0);else if((Dl&p)===p){c=c.next,p===Ad&&(d=!0);continue}else h={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},u===null?(o=u=h,s=i):u=u.next=h,It.lanes|=p,Rl|=p;h=c.action,Lu&&n(i,h),i=c.hasEagerState?c.eagerState:n(i,h)}else p={lane:h,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},u===null?(o=u=p,s=i):u=u.next=p,It.lanes|=h,Rl|=h;c=c.next}while(c!==null&&c!==t);if(u===null?s=i:u.next=o,!ti(i,e.memoizedState)&&(ja=!0,d&&(n=od,n!==null)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=u,a.lastRenderedState=i}return r===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function Fx(e){var t=sa(),n=t.queue;if(n===null)throw Error(We(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,i=t.memoizedState;if(r!==null){n.pending=null;var s=r=r.next;do i=e(i,s.action),s=s.next;while(s!==r);ti(i,t.memoizedState)||(ja=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function Kk(e,t,n){var a=It,r=sa(),i=Xt;if(i){if(n===void 0)throw Error(We(407));n=n()}else n=t();var s=!ti((hn||r).memoizedState,n);s&&(r.memoizedState=n,ja=!0),r=r.queue;var o=Xk.bind(null,a,r,e);if(lp(2048,8,o,[e]),r.getSnapshot!==t||s||ra!==null&&ra.memoizedState.tag&1){if(a.flags|=2048,Dd(9,H0(),Yk.bind(null,a,r,n,t),null),bn===null)throw Error(We(349));i||Dl&124||$k(a,t,n)}return n}function $k(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=It.updateQueue,t===null?(t=r2(),It.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Yk(e,t,n,a){t.value=n,t.getSnapshot=a,Jk(t)&&Qk(e)}function Xk(e,t,n){return n(function(){Jk(t)&&Qk(e)})}function Jk(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ti(e,n)}catch{return!0}}function Qk(e){var t=Vd(e,2);t!==null&&Zr(t,e,2)}function v1(e){var t=wr();if(typeof e=="function"){var n=e;if(e=n(),Lu){il(!0);try{n()}finally{il(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:e},t}function Zk(e,t,n,a){return e.baseState=n,s2(e,hn,typeof a=="function"?a:yo)}function eT(e,t,n,a,r){if(W0(e))throw Error(We(485));if(e=t.action,e!==null){var i={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(s){i.listeners.push(s)}};kt.T!==null?n(!0):i.isTransition=!1,a(i),n=t.pending,n===null?(i.next=t.pending=i,eS(t,i)):(i.next=n.next,t.pending=n.next=i)}}function eS(e,t){var n=t.action,a=t.payload,r=e.state;if(t.isTransition){var i=kt.T,s={};kt.T=s;try{var o=n(r,a),u=kt.S;u!==null&&u(s,o),sN(e,t,o)}catch(c){x1(e,t,c)}finally{kt.T=i}}else try{i=n(r,a),sN(e,t,i)}catch(c){x1(e,t,c)}}function sN(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(a){oN(e,t,a)},function(a){return x1(e,t,a)}):oN(e,t,n)}function oN(e,t,n){t.status="fulfilled",t.value=n,tS(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,eS(e,n)))}function x1(e,t,n){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=n,tS(t),t=t.next;while(t!==a)}e.action=null}function tS(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function nS(e,t){return t}function lN(e,t){if(Xt){var n=bn.formState;if(n!==null){e:{var a=It;if(Xt){if(Un){t:{for(var r=Un,i=xs;r.nodeType!==8;){if(!i){r=null;break t}if(r=$i(r.nextSibling),r===null){r=null;break t}}i=r.data,r=i==="F!"||i==="F"?r:null}if(r){Un=$i(r.nextSibling),a=r.data==="F!";break e}}Tu(a)}a=!1}a&&(t=n[0])}}return n=wr(),n.memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nS,lastRenderedState:t},n.queue=a,n=xS.bind(null,It,a),a.dispatch=n,a=v1(!1),i=c2.bind(null,It,!1,a.queue),a=wr(),r={state:t,dispatch:null,action:e,pending:null},a.queue=r,n=eT.bind(null,It,r,i,n),r.dispatch=n,a.memoizedState=e,[t,n,!1]}function uN(e){var t=sa();return aS(t,hn,e)}function aS(e,t,n){if(t=s2(e,t,nS)[0],e=lg(yo)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=op(t)}catch(s){throw s===sp?U0:s}else a=t;t=sa();var r=t.queue,i=r.dispatch;return n!==t.memoizedState&&(It.flags|=2048,Dd(9,H0(),tT.bind(null,r,n),null)),[a,i,e]}function tT(e,t){e.action=t}function cN(e){var t=sa(),n=hn;if(n!==null)return aS(t,n,e);sa(),t=t.memoizedState,n=sa();var a=n.queue.dispatch;return n.memoizedState=e,[t,a,!1]}function Dd(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},t=It.updateQueue,t===null&&(t=r2(),It.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function H0(){return{destroy:void 0,resource:void 0}}function rS(){return sa().memoizedState}function ug(e,t,n,a){var r=wr();a=a===void 0?null:a,It.flags|=e,r.memoizedState=Dd(1|t,H0(),n,a)}function lp(e,t,n,a){var r=sa();a=a===void 0?null:a;var i=r.memoizedState.inst;hn!==null&&a!==null&&Zy(a,hn.memoizedState.deps)?r.memoizedState=Dd(t,i,n,a):(It.flags|=e,r.memoizedState=Dd(1|t,i,n,a))}function dN(e,t){ug(8390656,8,e,t)}function iS(e,t){lp(2048,8,e,t)}function sS(e,t){return lp(4,2,e,t)}function oS(e,t){return lp(4,4,e,t)}function lS(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function uS(e,t,n){n=n!=null?n.concat([e]):null,lp(4,4,lS.bind(null,t,e),n)}function o2(){}function cS(e,t){var n=sa();t=t===void 0?null:t;var a=n.memoizedState;return t!==null&&Zy(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function dS(e,t){var n=sa();t=t===void 0?null:t;var a=n.memoizedState;if(t!==null&&Zy(t,a[1]))return a[0];if(a=e(),Lu){il(!0);try{e()}finally{il(!1)}}return n.memoizedState=[a,t],a}function l2(e,t,n){return n===void 0||Dl&1073741824?e.memoizedState=t:(e.memoizedState=n,e=t_(),It.lanes|=e,Rl|=e,n)}function hS(e,t,n,a){return ti(n,t)?n:Ed.current!==null?(e=l2(e,n,a),ti(e,t)||(ja=!0),e):Dl&42?(e=t_(),It.lanes|=e,Rl|=e,t):(ja=!0,e.memoizedState=n)}function fS(e,t,n,a,r){var i=Zt.p;Zt.p=i!==0&&8>i?i:8;var s=kt.T,o={};kt.T=o,c2(e,!1,t,n);try{var u=r(),c=kt.S;if(c!==null&&c(o,u),u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=JD(u,a);uf(e,t,d,Qr(e))}else uf(e,t,a,Qr(e))}catch(h){uf(e,t,{then:function(){},status:"rejected",reason:h},Qr())}finally{Zt.p=i,kt.T=s}}function nT(){}function b1(e,t,n,a){if(e.tag!==5)throw Error(We(476));var r=pS(e).queue;fS(e,r,t,mu,n===null?nT:function(){return mS(e),n(a)})}function pS(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:mu,baseState:mu,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:mu},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function mS(e){var t=pS(e).next.queue;uf(e,t,{},Qr())}function u2(){return er(Pf)}function gS(){return sa().memoizedState}function vS(){return sa().memoizedState}function aT(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Qr();e=vl(n);var a=xl(t,e,n);a!==null&&(Zr(a,t,n),sf(a,t,n)),t={cache:Yy()},e.payload=t;return}t=t.return}}function rT(e,t,n){var a=Qr();n={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},W0(e)?bS(t,n):(n=Gy(e,t,n,a),n!==null&&(Zr(n,e,a),yS(n,t,a)))}function xS(e,t,n){var a=Qr();uf(e,t,n,a)}function uf(e,t,n,a){var r={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(W0(e))bS(t,r);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,n);if(r.hasEagerState=!0,r.eagerState=o,ti(o,s))return z0(e,t,r,0),bn===null&&B0(),!1}catch{}finally{}if(n=Gy(e,t,r,a),n!==null)return Zr(n,e,a),yS(n,t,a),!0}return!1}function c2(e,t,n,a){if(a={lane:2,revertLane:x2(),action:a,hasEagerState:!1,eagerState:null,next:null},W0(e)){if(t)throw Error(We(479))}else t=Gy(e,n,a,2),t!==null&&Zr(t,e,2)}function W0(e){var t=e.alternate;return e===It||t!==null&&t===It}function bS(e,t){ld=Dg=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function yS(e,t,n){if(n&4194048){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,ck(e,n)}}var Rg={readContext:er,use:q0,useCallback:Vn,useContext:Vn,useEffect:Vn,useImperativeHandle:Vn,useLayoutEffect:Vn,useInsertionEffect:Vn,useMemo:Vn,useReducer:Vn,useRef:Vn,useState:Vn,useDebugValue:Vn,useDeferredValue:Vn,useTransition:Vn,useSyncExternalStore:Vn,useId:Vn,useHostTransitionStatus:Vn,useFormState:Vn,useActionState:Vn,useOptimistic:Vn,useMemoCache:Vn,useCacheRefresh:Vn},wS={readContext:er,use:q0,useCallback:function(e,t){return wr().memoizedState=[e,t===void 0?null:t],e},useContext:er,useEffect:dN,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,ug(4194308,4,lS.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ug(4194308,4,e,t)},useInsertionEffect:function(e,t){ug(4,2,e,t)},useMemo:function(e,t){var n=wr();t=t===void 0?null:t;var a=e();if(Lu){il(!0);try{e()}finally{il(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=wr();if(n!==void 0){var r=n(t);if(Lu){il(!0);try{n(t)}finally{il(!1)}}}else r=t;return a.memoizedState=a.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=rT.bind(null,It,e),[a.memoizedState,e]},useRef:function(e){var t=wr();return e={current:e},t.memoizedState=e},useState:function(e){e=v1(e);var t=e.queue,n=xS.bind(null,It,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:o2,useDeferredValue:function(e,t){var n=wr();return l2(n,e,t)},useTransition:function(){var e=v1(!1);return e=fS.bind(null,It,e.queue,!0,!1),wr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=It,r=wr();if(Xt){if(n===void 0)throw Error(We(407));n=n()}else{if(n=t(),bn===null)throw Error(We(349));Ht&124||$k(a,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,dN(Xk.bind(null,a,i,e),[e]),a.flags|=2048,Dd(9,H0(),Yk.bind(null,a,i,n,t),null),n},useId:function(){var e=wr(),t=bn.identifierPrefix;if(Xt){var n=ho,a=co;n=(a&~(1<<32-Jr(a)-1)).toString(32)+n,t="«"+t+"R"+n,n=Tg++,0<n&&(t+="H"+n.toString(32)),t+="»"}else n=QD++,t="«"+t+"r"+n.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:u2,useFormState:lN,useActionState:lN,useOptimistic:function(e){var t=wr();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=c2.bind(null,It,!0,n),n.dispatch=t,[e,t]},useMemoCache:i2,useCacheRefresh:function(){return wr().memoizedState=aT.bind(null,It)}},NS={readContext:er,use:q0,useCallback:cS,useContext:er,useEffect:iS,useImperativeHandle:uS,useInsertionEffect:sS,useLayoutEffect:oS,useMemo:dS,useReducer:lg,useRef:rS,useState:function(){return lg(yo)},useDebugValue:o2,useDeferredValue:function(e,t){var n=sa();return hS(n,hn.memoizedState,e,t)},useTransition:function(){var e=lg(yo)[0],t=sa().memoizedState;return[typeof e=="boolean"?e:op(e),t]},useSyncExternalStore:Kk,useId:gS,useHostTransitionStatus:u2,useFormState:uN,useActionState:uN,useOptimistic:function(e,t){var n=sa();return Zk(n,hn,e,t)},useMemoCache:i2,useCacheRefresh:vS},iT={readContext:er,use:q0,useCallback:cS,useContext:er,useEffect:iS,useImperativeHandle:uS,useInsertionEffect:sS,useLayoutEffect:oS,useMemo:dS,useReducer:Fx,useRef:rS,useState:function(){return Fx(yo)},useDebugValue:o2,useDeferredValue:function(e,t){var n=sa();return hn===null?l2(n,e,t):hS(n,hn.memoizedState,e,t)},useTransition:function(){var e=Fx(yo)[0],t=sa().memoizedState;return[typeof e=="boolean"?e:op(e),t]},useSyncExternalStore:Kk,useId:gS,useHostTransitionStatus:u2,useFormState:cN,useActionState:cN,useOptimistic:function(e,t){var n=sa();return hn!==null?Zk(n,hn,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:i2,useCacheRefresh:vS},cd=null,Df=0;function jm(e){var t=Df;return Df+=1,cd===null&&(cd=[]),qk(cd,e,t)}function Fh(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Cm(e,t){throw t.$$typeof===ME?Error(We(525)):(e=Object.prototype.toString.call(t),Error(We(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function hN(e){var t=e._init;return t(e._payload)}function kS(e){function t(m,x){if(e){var y=m.deletions;y===null?(m.deletions=[x],m.flags|=16):y.push(x)}}function n(m,x){if(!e)return null;for(;x!==null;)t(m,x),x=x.sibling;return null}function a(m){for(var x=new Map;m!==null;)m.key!==null?x.set(m.key,m):x.set(m.index,m),m=m.sibling;return x}function r(m,x){return m=mo(m,x),m.index=0,m.sibling=null,m}function i(m,x,y){return m.index=y,e?(y=m.alternate,y!==null?(y=y.index,y<x?(m.flags|=67108866,x):y):(m.flags|=67108866,x)):(m.flags|=1048576,x)}function s(m){return e&&m.alternate===null&&(m.flags|=67108866),m}function o(m,x,y,N){return x===null||x.tag!==6?(x=Mx(y,m.mode,N),x.return=m,x):(x=r(x,y),x.return=m,x)}function u(m,x,y,N){var S=y.type;return S===Vc?d(m,x,y.props.children,N,y.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Qo&&hN(S)===x.type)?(x=r(x,y.props),Fh(x,y),x.return=m,x):(x=sg(y.type,y.key,y.props,null,m.mode,N),Fh(x,y),x.return=m,x)}function c(m,x,y,N){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=Ix(y,m.mode,N),x.return=m,x):(x=r(x,y.children||[]),x.return=m,x)}function d(m,x,y,N,S){return x===null||x.tag!==7?(x=gu(y,m.mode,N,S),x.return=m,x):(x=r(x,y),x.return=m,x)}function h(m,x,y){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return x=Mx(""+x,m.mode,y),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case bm:return y=sg(x.type,x.key,x.props,null,m.mode,y),Fh(y,x),y.return=m,y;case $h:return x=Ix(x,m.mode,y),x.return=m,x;case Qo:var N=x._init;return x=N(x._payload),h(m,x,y)}if(Yh(x)||Ph(x))return x=gu(x,m.mode,y,null),x.return=m,x;if(typeof x.then=="function")return h(m,jm(x),y);if(x.$$typeof===uo)return h(m,Sm(m,x),y);Cm(m,x)}return null}function p(m,x,y,N){var S=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return S!==null?null:o(m,x,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case bm:return y.key===S?u(m,x,y,N):null;case $h:return y.key===S?c(m,x,y,N):null;case Qo:return S=y._init,y=S(y._payload),p(m,x,y,N)}if(Yh(y)||Ph(y))return S!==null?null:d(m,x,y,N,null);if(typeof y.then=="function")return p(m,x,jm(y),N);if(y.$$typeof===uo)return p(m,x,Sm(m,y),N);Cm(m,y)}return null}function f(m,x,y,N,S){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return m=m.get(y)||null,o(x,m,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case bm:return m=m.get(N.key===null?y:N.key)||null,u(x,m,N,S);case $h:return m=m.get(N.key===null?y:N.key)||null,c(x,m,N,S);case Qo:var T=N._init;return N=T(N._payload),f(m,x,y,N,S)}if(Yh(N)||Ph(N))return m=m.get(y)||null,d(x,m,N,S,null);if(typeof N.then=="function")return f(m,x,y,jm(N),S);if(N.$$typeof===uo)return f(m,x,y,Sm(x,N),S);Cm(x,N)}return null}function g(m,x,y,N){for(var S=null,T=null,C=x,A=x=0,R=null;C!==null&&A<y.length;A++){C.index>A?(R=C,C=null):R=C.sibling;var L=p(m,C,y[A],N);if(L===null){C===null&&(C=R);break}e&&C&&L.alternate===null&&t(m,C),x=i(L,x,A),T===null?S=L:T.sibling=L,T=L,C=R}if(A===y.length)return n(m,C),Xt&&iu(m,A),S;if(C===null){for(;A<y.length;A++)C=h(m,y[A],N),C!==null&&(x=i(C,x,A),T===null?S=C:T.sibling=C,T=C);return Xt&&iu(m,A),S}for(C=a(C);A<y.length;A++)R=f(C,m,A,y[A],N),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?A:R.key),x=i(R,x,A),T===null?S=R:T.sibling=R,T=R);return e&&C.forEach(function(j){return t(m,j)}),Xt&&iu(m,A),S}function b(m,x,y,N){if(y==null)throw Error(We(151));for(var S=null,T=null,C=x,A=x=0,R=null,L=y.next();C!==null&&!L.done;A++,L=y.next()){C.index>A?(R=C,C=null):R=C.sibling;var j=p(m,C,L.value,N);if(j===null){C===null&&(C=R);break}e&&C&&j.alternate===null&&t(m,C),x=i(j,x,A),T===null?S=j:T.sibling=j,T=j,C=R}if(L.done)return n(m,C),Xt&&iu(m,A),S;if(C===null){for(;!L.done;A++,L=y.next())L=h(m,L.value,N),L!==null&&(x=i(L,x,A),T===null?S=L:T.sibling=L,T=L);return Xt&&iu(m,A),S}for(C=a(C);!L.done;A++,L=y.next())L=f(C,m,A,L.value,N),L!==null&&(e&&L.alternate!==null&&C.delete(L.key===null?A:L.key),x=i(L,x,A),T===null?S=L:T.sibling=L,T=L);return e&&C.forEach(function(D){return t(m,D)}),Xt&&iu(m,A),S}function w(m,x,y,N){if(typeof y=="object"&&y!==null&&y.type===Vc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case bm:e:{for(var S=y.key;x!==null;){if(x.key===S){if(S=y.type,S===Vc){if(x.tag===7){n(m,x.sibling),N=r(x,y.props.children),N.return=m,m=N;break e}}else if(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Qo&&hN(S)===x.type){n(m,x.sibling),N=r(x,y.props),Fh(N,y),N.return=m,m=N;break e}n(m,x);break}else t(m,x);x=x.sibling}y.type===Vc?(N=gu(y.props.children,m.mode,N,y.key),N.return=m,m=N):(N=sg(y.type,y.key,y.props,null,m.mode,N),Fh(N,y),N.return=m,m=N)}return s(m);case $h:e:{for(S=y.key;x!==null;){if(x.key===S)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){n(m,x.sibling),N=r(x,y.children||[]),N.return=m,m=N;break e}else{n(m,x);break}else t(m,x);x=x.sibling}N=Ix(y,m.mode,N),N.return=m,m=N}return s(m);case Qo:return S=y._init,y=S(y._payload),w(m,x,y,N)}if(Yh(y))return g(m,x,y,N);if(Ph(y)){if(S=Ph(y),typeof S!="function")throw Error(We(150));return y=S.call(y),b(m,x,y,N)}if(typeof y.then=="function")return w(m,x,jm(y),N);if(y.$$typeof===uo)return w(m,x,Sm(m,y),N);Cm(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,x!==null&&x.tag===6?(n(m,x.sibling),N=r(x,y),N.return=m,m=N):(n(m,x),N=Mx(y,m.mode,N),N.return=m,m=N),s(m)):n(m,x)}return function(m,x,y,N){try{Df=0;var S=w(m,x,y,N);return cd=null,S}catch(C){if(C===sp||C===U0)throw C;var T=Wr(29,C,null,m.mode);return T.lanes=N,T.return=m,T}finally{}}}var Td=kS(!0),SS=kS(!1),Ci=Is(null),As=null;function tl(e){var t=e.alternate;Cn(fa,fa.current&1),Cn(Ci,e),As===null&&(t===null||Ed.current!==null||t.memoizedState!==null)&&(As=e)}function _S(e){if(e.tag===22){if(Cn(fa,fa.current),Cn(Ci,e),As===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(As=e)}}else nl()}function nl(){Cn(fa,fa.current),Cn(Ci,Ci.current)}function po(e){Ca(Ci),As===e&&(As=null),Ca(fa)}var fa=Is(0);function Lg(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||I1(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Bx(e,t,n,a){t=e.memoizedState,n=n(a,t),n=n==null?t:Sn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var y1={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Qr(),r=vl(a);r.payload=t,n!=null&&(r.callback=n),t=xl(e,r,a),t!==null&&(Zr(t,e,a),sf(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Qr(),r=vl(a);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=xl(e,r,a),t!==null&&(Zr(t,e,a),sf(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Qr(),a=vl(n);a.tag=2,t!=null&&(a.callback=t),t=xl(e,a,n),t!==null&&(Zr(t,e,n),sf(t,e,n))}};function fN(e,t,n,a,r,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,s):t.prototype&&t.prototype.isPureReactComponent?!Cf(n,a)||!Cf(r,i):!0}function pN(e,t,n,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&y1.enqueueReplaceState(t,t.state,null)}function Pu(e,t){var n=t;if("ref"in t){n={};for(var a in t)a!=="ref"&&(n[a]=t[a])}if(e=e.defaultProps){n===t&&(n=Sn({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Pg=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function jS(e){Pg(e)}function CS(e){console.error(e)}function AS(e){Pg(e)}function Mg(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function mN(e,t,n){try{var a=e.onCaughtError;a(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function w1(e,t,n){return n=vl(n),n.tag=3,n.payload={element:null},n.callback=function(){Mg(e,t)},n}function ES(e){return e=vl(e),e.tag=3,e}function DS(e,t,n,a){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=a.value;e.payload=function(){return r(i)},e.callback=function(){mN(t,n,a)}}var s=n.stateNode;s!==null&&typeof s.componentDidCatch=="function"&&(e.callback=function(){mN(t,n,a),typeof r!="function"&&(bl===null?bl=new Set([this]):bl.add(this));var o=a.stack;this.componentDidCatch(a.value,{componentStack:o!==null?o:""})})}function sT(e,t,n,a,r){if(n.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=n.alternate,t!==null&&rp(t,n,r,!0),n=Ci.current,n!==null){switch(n.tag){case 13:return As===null?E1():n.alternate===null&&qn===0&&(qn=3),n.flags&=-257,n.flags|=65536,n.lanes=r,a===f1?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([a]):t.add(a),Xx(e,a,r)),!1;case 22:return n.flags|=65536,a===f1?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([a]):n.add(a)),Xx(e,a,r)),!1}throw Error(We(435,n.tag))}return Xx(e,a,r),E1(),!1}if(Xt)return t=Ci.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=r,a!==l1&&(e=Error(We(422),{cause:a}),Af(yi(e,n)))):(a!==l1&&(t=Error(We(423),{cause:a}),Af(yi(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,a=yi(a,n),r=w1(e.stateNode,a,r),Ox(e,r),qn!==4&&(qn=2)),!1;var i=Error(We(520),{cause:a});if(i=yi(i,n),hf===null?hf=[i]:hf.push(i),qn!==4&&(qn=2),t===null)return!0;a=yi(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=w1(n.stateNode,a,e),Ox(n,e),!1;case 1:if(t=n.type,i=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||i!==null&&typeof i.componentDidCatch=="function"&&(bl===null||!bl.has(i))))return n.flags|=65536,r&=-r,n.lanes|=r,r=ES(r),DS(r,e,n,a),Ox(n,r),!1}n=n.return}while(n!==null);return!1}var TS=Error(We(461)),ja=!1;function Ma(e,t,n,a){t.child=e===null?SS(t,null,n,a):Td(t,e.child,n,a)}function gN(e,t,n,a,r){n=n.render;var i=t.ref;if("ref"in a){var s={};for(var o in a)o!=="ref"&&(s[o]=a[o])}else s=a;return Ru(t),a=e2(e,t,n,s,i,r),o=t2(),e!==null&&!ja?(n2(e,t,r),wo(e,t,r)):(Xt&&o&&Ky(t),t.flags|=1,Ma(e,t,a,r),t.child)}function vN(e,t,n,a,r){if(e===null){var i=n.type;return typeof i=="function"&&!Vy(i)&&i.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=i,RS(e,t,i,a,r)):(e=sg(n.type,null,a,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!d2(e,r)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:Cf,n(s,a)&&e.ref===t.ref)return wo(e,t,r)}return t.flags|=1,e=mo(i,a),e.ref=t.ref,e.return=t,t.child=e}function RS(e,t,n,a,r){if(e!==null){var i=e.memoizedProps;if(Cf(i,a)&&e.ref===t.ref)if(ja=!1,t.pendingProps=a=i,d2(e,r))e.flags&131072&&(ja=!0);else return t.lanes=e.lanes,wo(e,t,r)}return N1(e,t,n,a,r)}function LS(e,t,n){var a=t.pendingProps,r=a.children,i=e!==null?e.memoizedState:null;if(a.mode==="hidden"){if(t.flags&128){if(a=i!==null?i.baseLanes|n:n,e!==null){for(r=t.child=e.child,i=0;r!==null;)i=i|r.lanes|r.childLanes,r=r.sibling;t.childLanes=i&~a}else t.childLanes=0,t.child=null;return xN(e,t,a,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&og(t,i!==null?i.cachePool:null),i!==null?iN(t,i):g1(),_S(t);else return t.lanes=t.childLanes=536870912,xN(e,t,i!==null?i.baseLanes|n:n,n)}else i!==null?(og(t,i.cachePool),iN(t,i),nl(),t.memoizedState=null):(e!==null&&og(t,null),g1(),nl());return Ma(e,t,r,n),t.child}function xN(e,t,n,a){var r=Xy();return r=r===null?null:{parent:da._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&og(t,null),g1(),_S(t),e!==null&&rp(e,t,a,!0),null}function cg(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(We(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function N1(e,t,n,a,r){return Ru(t),n=e2(e,t,n,a,void 0,r),a=t2(),e!==null&&!ja?(n2(e,t,r),wo(e,t,r)):(Xt&&a&&Ky(t),t.flags|=1,Ma(e,t,n,r),t.child)}function bN(e,t,n,a,r,i){return Ru(t),t.updateQueue=null,n=Vk(t,a,n,r),Gk(e),a=t2(),e!==null&&!ja?(n2(e,t,i),wo(e,t,i)):(Xt&&a&&Ky(t),t.flags|=1,Ma(e,t,n,i),t.child)}function yN(e,t,n,a,r){if(Ru(t),t.stateNode===null){var i=ed,s=n.contextType;typeof s=="object"&&s!==null&&(i=er(s)),i=new n(a,i),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=y1,t.stateNode=i,i._reactInternals=t,i=t.stateNode,i.props=a,i.state=t.memoizedState,i.refs={},Jy(t),s=n.contextType,i.context=typeof s=="object"&&s!==null?er(s):ed,i.state=t.memoizedState,s=n.getDerivedStateFromProps,typeof s=="function"&&(Bx(t,n,s,a),i.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(s=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),s!==i.state&&y1.enqueueReplaceState(i,i.state,null),lf(t,a,i,r),of(),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){i=t.stateNode;var o=t.memoizedProps,u=Pu(n,o);i.props=u;var c=i.context,d=n.contextType;s=ed,typeof d=="object"&&d!==null&&(s=er(d));var h=n.getDerivedStateFromProps;d=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function",o=t.pendingProps!==o,d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o||c!==s)&&pN(t,i,a,s),Zo=!1;var p=t.memoizedState;i.state=p,lf(t,a,i,r),of(),c=t.memoizedState,o||p!==c||Zo?(typeof h=="function"&&(Bx(t,n,h,a),c=t.memoizedState),(u=Zo||fN(t,n,u,a,p,c,s))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),i.props=a,i.state=c,i.context=s,a=u):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,p1(e,t),s=t.memoizedProps,d=Pu(n,s),i.props=d,h=t.pendingProps,p=i.context,c=n.contextType,u=ed,typeof c=="object"&&c!==null&&(u=er(c)),o=n.getDerivedStateFromProps,(c=typeof o=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==h||p!==u)&&pN(t,i,a,u),Zo=!1,p=t.memoizedState,i.state=p,lf(t,a,i,r),of();var f=t.memoizedState;s!==h||p!==f||Zo||e!==null&&e.dependencies!==null&&Ag(e.dependencies)?(typeof o=="function"&&(Bx(t,n,o,a),f=t.memoizedState),(d=Zo||fN(t,n,d,a,p,f,u)||e!==null&&e.dependencies!==null&&Ag(e.dependencies))?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(a,f,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(a,f,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),i.props=a,i.state=f,i.context=u,a=d):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}return i=a,cg(e,t),a=(t.flags&128)!==0,i||a?(i=t.stateNode,n=a&&typeof n.getDerivedStateFromError!="function"?null:i.render(),t.flags|=1,e!==null&&a?(t.child=Td(t,e.child,null,r),t.child=Td(t,null,n,r)):Ma(e,t,n,r),t.memoizedState=i.state,e=t.child):e=wo(e,t,r),e}function wN(e,t,n,a){return ap(),t.flags|=256,Ma(e,t,n,a),t.child}var zx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ux(e){return{baseLanes:e,cachePool:zk()}}function qx(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Ni),e}function PS(e,t,n){var a=t.pendingProps,r=!1,i=(t.flags&128)!==0,s;if((s=i)||(s=e!==null&&e.memoizedState===null?!1:(fa.current&2)!==0),s&&(r=!0,t.flags&=-129),s=(t.flags&32)!==0,t.flags&=-33,e===null){if(Xt){if(r?tl(t):nl(),Xt){var o=Un,u;if(u=o){e:{for(u=o,o=xs;u.nodeType!==8;){if(!o){o=null;break e}if(u=$i(u.nextSibling),u===null){o=null;break e}}o=u}o!==null?(t.memoizedState={dehydrated:o,treeContext:vu!==null?{id:co,overflow:ho}:null,retryLane:536870912,hydrationErrors:null},u=Wr(18,null,null,0),u.stateNode=o,u.return=t,t.child=u,cr=t,Un=null,u=!0):u=!1}u||Tu(t)}if(o=t.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return I1(o)?t.lanes=32:t.lanes=536870912,null;po(t)}return o=a.children,a=a.fallback,r?(nl(),r=t.mode,o=Ig({mode:"hidden",children:o},r),a=gu(a,r,n,null),o.return=t,a.return=t,o.sibling=a,t.child=o,r=t.child,r.memoizedState=Ux(n),r.childLanes=qx(e,s,n),t.memoizedState=zx,a):(tl(t),k1(t,o))}if(u=e.memoizedState,u!==null&&(o=u.dehydrated,o!==null)){if(i)t.flags&256?(tl(t),t.flags&=-257,t=Hx(e,t,n)):t.memoizedState!==null?(nl(),t.child=e.child,t.flags|=128,t=null):(nl(),r=a.fallback,o=t.mode,a=Ig({mode:"visible",children:a.children},o),r=gu(r,o,n,null),r.flags|=2,a.return=t,r.return=t,a.sibling=r,t.child=a,Td(t,e.child,null,n),a=t.child,a.memoizedState=Ux(n),a.childLanes=qx(e,s,n),t.memoizedState=zx,t=r);else if(tl(t),I1(o)){if(s=o.nextSibling&&o.nextSibling.dataset,s)var c=s.dgst;s=c,a=Error(We(419)),a.stack="",a.digest=s,Af({value:a,source:null,stack:null}),t=Hx(e,t,n)}else if(ja||rp(e,t,n,!1),s=(n&e.childLanes)!==0,ja||s){if(s=bn,s!==null&&(a=n&-n,a=a&42?1:My(a),a=a&(s.suspendedLanes|n)?0:a,a!==0&&a!==u.retryLane))throw u.retryLane=a,Vd(e,a),Zr(s,e,a),TS;o.data==="$?"||E1(),t=Hx(e,t,n)}else o.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=u.treeContext,Un=$i(o.nextSibling),cr=t,Xt=!0,xu=null,xs=!1,e!==null&&(gi[vi++]=co,gi[vi++]=ho,gi[vi++]=vu,co=e.id,ho=e.overflow,vu=t),t=k1(t,a.children),t.flags|=4096);return t}return r?(nl(),r=a.fallback,o=t.mode,u=e.child,c=u.sibling,a=mo(u,{mode:"hidden",children:a.children}),a.subtreeFlags=u.subtreeFlags&65011712,c!==null?r=mo(c,r):(r=gu(r,o,n,null),r.flags|=2),r.return=t,a.return=t,a.sibling=r,t.child=a,a=r,r=t.child,o=e.child.memoizedState,o===null?o=Ux(n):(u=o.cachePool,u!==null?(c=da._currentValue,u=u.parent!==c?{parent:c,pool:c}:u):u=zk(),o={baseLanes:o.baseLanes|n,cachePool:u}),r.memoizedState=o,r.childLanes=qx(e,s,n),t.memoizedState=zx,a):(tl(t),n=e.child,e=n.sibling,n=mo(n,{mode:"visible",children:a.children}),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function k1(e,t){return t=Ig({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Ig(e,t){return e=Wr(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Hx(e,t,n){return Td(t,e.child,null,n),e=k1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function NN(e,t,n){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),c1(e.return,t,n)}function Wx(e,t,n,a,r){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=n,i.tailMode=r)}function MS(e,t,n){var a=t.pendingProps,r=a.revealOrder,i=a.tail;if(Ma(e,t,a.children,n),a=fa.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&NN(e,n,t);else if(e.tag===19)NN(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(Cn(fa,a),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&Lg(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Wx(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&Lg(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Wx(t,!0,n,null,i);break;case"together":Wx(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wo(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Rl|=t.lanes,!(n&t.childLanes))if(e!==null){if(rp(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(We(153));if(t.child!==null){for(e=t.child,n=mo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=mo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function d2(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&Ag(e)))}function oT(e,t,n){switch(t.tag){case 3:yg(t,t.stateNode.containerInfo),el(t,da,e.memoizedState.cache),ap();break;case 27:case 5:Qb(t);break;case 4:yg(t,t.stateNode.containerInfo);break;case 10:el(t,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(tl(t),t.flags|=128,null):n&t.child.childLanes?PS(e,t,n):(tl(t),e=wo(e,t,n),e!==null?e.sibling:null);tl(t);break;case 19:var r=(e.flags&128)!==0;if(a=(n&t.childLanes)!==0,a||(rp(e,t,n,!1),a=(n&t.childLanes)!==0),r){if(a)return MS(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cn(fa,fa.current),a)break;return null;case 22:case 23:return t.lanes=0,LS(e,t,n);case 24:el(t,da,e.memoizedState.cache)}return wo(e,t,n)}function IS(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)ja=!0;else{if(!d2(e,n)&&!(t.flags&128))return ja=!1,oT(e,t,n);ja=!!(e.flags&131072)}else ja=!1,Xt&&t.flags&1048576&&Fk(t,Cg,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,r=a._init;if(a=r(a._payload),t.type=a,typeof a=="function")Vy(a)?(e=Pu(a,e),t.tag=1,t=yN(null,t,a,e,n)):(t.tag=0,t=N1(null,t,a,e,n));else{if(a!=null){if(r=a.$$typeof,r===Ry){t.tag=11,t=gN(null,t,a,e,n);break e}else if(r===Ly){t.tag=14,t=vN(null,t,a,e,n);break e}}throw t=Xb(a)||a,Error(We(306,t,""))}}return t;case 0:return N1(e,t,t.type,t.pendingProps,n);case 1:return a=t.type,r=Pu(a,t.pendingProps),yN(e,t,a,r,n);case 3:e:{if(yg(t,t.stateNode.containerInfo),e===null)throw Error(We(387));a=t.pendingProps;var i=t.memoizedState;r=i.element,p1(e,t),lf(t,a,null,n);var s=t.memoizedState;if(a=s.cache,el(t,da,a),a!==i.cache&&d1(t,[da],n,!0),of(),a=s.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){t=wN(e,t,a,n);break e}else if(a!==r){r=yi(Error(We(424)),t),Af(r),t=wN(e,t,a,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Un=$i(e.firstChild),cr=t,Xt=!0,xu=null,xs=!0,n=SS(t,null,a,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ap(),a===r){t=wo(e,t,n);break e}Ma(e,t,a,n)}t=t.child}return t;case 26:return cg(e,t),e===null?(n=BN(t.type,null,t.pendingProps,null))?t.memoizedState=n:Xt||(n=t.type,e=t.pendingProps,a=Hg(gl.current).createElement(n),a[Za]=t,a[Ar]=e,za(a,n,e),_a(a),t.stateNode=a):t.memoizedState=BN(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Qb(t),e===null&&Xt&&(a=t.stateNode=N_(t.type,t.pendingProps,gl.current),cr=t,xs=!0,r=Un,Fl(t.type)?(O1=r,Un=$i(a.firstChild)):Un=r),Ma(e,t,t.pendingProps.children,n),cg(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Xt&&((r=a=Un)&&(a=MT(a,t.type,t.pendingProps,xs),a!==null?(t.stateNode=a,cr=t,Un=$i(a.firstChild),xs=!1,r=!0):r=!1),r||Tu(t)),Qb(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,P1(r,i)?a=null:s!==null&&P1(r,s)&&(t.flags|=32),t.memoizedState!==null&&(r=e2(e,t,ZD,null,null,n),Pf._currentValue=r),cg(e,t),Ma(e,t,a,n),t.child;case 6:return e===null&&Xt&&((e=n=Un)&&(n=IT(n,t.pendingProps,xs),n!==null?(t.stateNode=n,cr=t,Un=null,e=!0):e=!1),e||Tu(t)),null;case 13:return PS(e,t,n);case 4:return yg(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Td(t,null,a,n):Ma(e,t,a,n),t.child;case 11:return gN(e,t,t.type,t.pendingProps,n);case 7:return Ma(e,t,t.pendingProps,n),t.child;case 8:return Ma(e,t,t.pendingProps.children,n),t.child;case 12:return Ma(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,el(t,t.type,a.value),Ma(e,t,a.children,n),t.child;case 9:return r=t.type._context,a=t.pendingProps.children,Ru(t),r=er(r),a=a(r),t.flags|=1,Ma(e,t,a,n),t.child;case 14:return vN(e,t,t.type,t.pendingProps,n);case 15:return RS(e,t,t.type,t.pendingProps,n);case 19:return MS(e,t,n);case 31:return a=t.pendingProps,n=t.mode,a={mode:a.mode,children:a.children},e===null?(n=Ig(a,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=mo(e.child,a),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return LS(e,t,n);case 24:return Ru(t),a=er(da),e===null?(r=Xy(),r===null&&(r=bn,i=Yy(),r.pooledCache=i,i.refCount++,i!==null&&(r.pooledCacheLanes|=n),r=i),t.memoizedState={parent:a,cache:r},Jy(t),el(t,da,r)):(e.lanes&n&&(p1(e,t),lf(t,null,null,n),of()),r=e.memoizedState,i=t.memoizedState,r.parent!==a?(r={parent:a,cache:a},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),el(t,da,a)):(a=i.cache,el(t,da,a),a!==r.cache&&d1(t,[da],n,!0))),Ma(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(We(156,t.tag))}function eo(e){e.flags|=4}function kN(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!__(t)){if(t=Ci.current,t!==null&&((Ht&4194048)===Ht?As!==null:(Ht&62914560)!==Ht&&!(Ht&536870912)||t!==As))throw rf=f1,Uk;e.flags|=8192}}function Am(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?lk():536870912,e.lanes|=t,Rd|=t)}function Bh(e,t){if(!Xt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function En(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags&65011712,a|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function lT(e,t,n){var a=t.pendingProps;switch($y(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(t),null;case 1:return En(t),null;case 3:return n=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),go(da),_d(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Oh(t)?eo(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Z5())),En(t),null;case 26:return n=t.memoizedState,e===null?(eo(t),n!==null?(En(t),kN(t,n)):(En(t),t.flags&=-16777217)):n?n!==e.memoizedState?(eo(t),En(t),kN(t,n)):(En(t),t.flags&=-16777217):(e.memoizedProps!==a&&eo(t),En(t),t.flags&=-16777217),null;case 27:wg(t),n=gl.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==a&&eo(t);else{if(!a){if(t.stateNode===null)throw Error(We(166));return En(t),null}e=js.current,Oh(t)?J5(t):(e=N_(r,a,n),t.stateNode=e,eo(t))}return En(t),null;case 5:if(wg(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&eo(t);else{if(!a){if(t.stateNode===null)throw Error(We(166));return En(t),null}if(e=js.current,Oh(t))J5(t);else{switch(r=Hg(gl.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof a.is=="string"?r.createElement("select",{is:a.is}):r.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e=typeof a.is=="string"?r.createElement(n,{is:a.is}):r.createElement(n)}}e[Za]=t,e[Ar]=a;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(za(e,n,a),n){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&eo(t)}}return En(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&eo(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(We(166));if(e=gl.current,Oh(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,r=cr,r!==null)switch(r.tag){case 27:case 5:a=r.memoizedProps}e[Za]=t,e=!!(e.nodeValue===n||a!==null&&a.suppressHydrationWarning===!0||b_(e.nodeValue,n)),e||Tu(t)}else e=Hg(e).createTextNode(a),e[Za]=t,t.stateNode=e}return En(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=Oh(t),a!==null&&a.dehydrated!==null){if(e===null){if(!r)throw Error(We(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(We(317));r[Za]=t}else ap(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;En(t),r=!1}else r=Z5(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(po(t),t):(po(t),null)}if(po(t),t.flags&128)return t.lanes=n,t;if(n=a!==null,e=e!==null&&e.memoizedState!==null,n){a=t.child,r=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(r=a.alternate.memoizedState.cachePool.pool);var i=null;a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==r&&(a.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Am(t,t.updateQueue),En(t),null;case 4:return _d(),e===null&&b2(t.stateNode.containerInfo),En(t),null;case 10:return go(t.type),En(t),null;case 19:if(Ca(fa),r=t.memoizedState,r===null)return En(t),null;if(a=(t.flags&128)!==0,i=r.rendering,i===null)if(a)Bh(r,!1);else{if(qn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Lg(e),i!==null){for(t.flags|=128,Bh(r,!1),e=i.updateQueue,t.updateQueue=e,Am(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)Ok(n,e),n=n.sibling;return Cn(fa,fa.current&1|2),t.child}e=e.sibling}r.tail!==null&&Cs()>Fg&&(t.flags|=128,a=!0,Bh(r,!1),t.lanes=4194304)}else{if(!a)if(e=Lg(i),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,Am(t,e),Bh(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!Xt)return En(t),null}else 2*Cs()-r.renderingStartTime>Fg&&n!==536870912&&(t.flags|=128,a=!0,Bh(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(e=r.last,e!==null?e.sibling=i:t.child=i,r.last=i)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Cs(),t.sibling=null,e=fa.current,Cn(fa,a?e&1|2:e&1),t):(En(t),null);case 22:case 23:return po(t),Qy(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?n&536870912&&!(t.flags&128)&&(En(t),t.subtreeFlags&6&&(t.flags|=8192)):En(t),n=t.updateQueue,n!==null&&Am(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),e!==null&&Ca(bu),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),go(da),En(t),null;case 25:return null;case 30:return null}throw Error(We(156,t.tag))}function uT(e,t){switch($y(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return go(da),_d(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return wg(t),null;case 13:if(po(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(We(340));ap()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ca(fa),null;case 4:return _d(),null;case 10:return go(t.type),null;case 22:case 23:return po(t),Qy(),e!==null&&Ca(bu),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return go(da),null;case 25:return null;default:return null}}function OS(e,t){switch($y(t),t.tag){case 3:go(da),_d();break;case 26:case 27:case 5:wg(t);break;case 4:_d();break;case 13:po(t);break;case 19:Ca(fa);break;case 10:go(t.type);break;case 22:case 23:po(t),Qy(),e!==null&&Ca(bu);break;case 24:go(da)}}function up(e,t){try{var n=t.updateQueue,a=n!==null?n.lastEffect:null;if(a!==null){var r=a.next;n=r;do{if((n.tag&e)===e){a=void 0;var i=n.create,s=n.inst;a=i(),s.destroy=a}n=n.next}while(n!==r)}}catch(o){mn(t,t.return,o)}}function Tl(e,t,n){try{var a=t.updateQueue,r=a!==null?a.lastEffect:null;if(r!==null){var i=r.next;a=i;do{if((a.tag&e)===e){var s=a.inst,o=s.destroy;if(o!==void 0){s.destroy=void 0,r=t;var u=n,c=o;try{c()}catch(d){mn(r,u,d)}}}a=a.next}while(a!==i)}}catch(d){mn(t,t.return,d)}}function FS(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Wk(t,n)}catch(a){mn(e,e.return,a)}}}function BS(e,t,n){n.props=Pu(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){mn(e,t,a)}}function cf(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof n=="function"?e.refCleanup=n(a):n.current=a}}catch(r){mn(e,t,r)}}function ks(e,t){var n=e.ref,a=e.refCleanup;if(n!==null)if(typeof a=="function")try{a()}catch(r){mn(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){mn(e,t,r)}else n.current=null}function zS(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(r){mn(e,e.return,r)}}function Gx(e,t,n){try{var a=e.stateNode;DT(a,e.type,n,t),a[Ar]=t}catch(r){mn(e,e.return,r)}}function US(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Fl(e.type)||e.tag===4}function Vx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||US(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Fl(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function S1(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=$0));else if(a!==4&&(a===27&&Fl(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(S1(e,t,n),e=e.sibling;e!==null;)S1(e,t,n),e=e.sibling}function Og(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(a!==4&&(a===27&&Fl(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Og(e,t,n),e=e.sibling;e!==null;)Og(e,t,n),e=e.sibling}function qS(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);za(t,a,n),t[Za]=e,t[Ar]=n}catch(i){mn(e,e.return,i)}}var io=!1,$n=!1,Kx=!1,SN=typeof WeakSet=="function"?WeakSet:Set,Sa=null;function cT(e,t){if(e=e.containerInfo,R1=Kg,e=Ek(e),Hy(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,o=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(o=s+r),h!==i||a!==0&&h.nodeType!==3||(u=s+a),h.nodeType===3&&(s+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===r&&(o=s),p===i&&++d===a&&(u=s),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(L1={focusedElem:e,selectionRange:n},Kg=!1,Sa=t;Sa!==null;)if(t=Sa,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Sa=e;else for(;Sa!==null;){switch(t=Sa,i=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&i!==null){e=void 0,n=t,r=i.memoizedProps,i=i.memoizedState,a=n.stateNode;try{var g=Pu(n.type,r,n.elementType===n.type);e=a.getSnapshotBeforeUpdate(g,i),a.__reactInternalSnapshotBeforeUpdate=e}catch(b){mn(n,n.return,b)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)M1(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":M1(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(We(163))}if(e=t.sibling,e!==null){e.return=t.return,Sa=e;break}Sa=t.return}}function HS(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Go(e,n),a&4&&up(5,n);break;case 1:if(Go(e,n),a&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(s){mn(n,n.return,s)}else{var r=Pu(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){mn(n,n.return,s)}}a&64&&FS(n),a&512&&cf(n,n.return);break;case 3:if(Go(e,n),a&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Wk(e,t)}catch(s){mn(n,n.return,s)}}break;case 27:t===null&&a&4&&qS(n);case 26:case 5:Go(e,n),t===null&&a&4&&zS(n),a&512&&cf(n,n.return);break;case 12:Go(e,n);break;case 13:Go(e,n),a&4&&VS(e,n),a&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=bT.bind(null,n),OT(e,n))));break;case 22:if(a=n.memoizedState!==null||io,!a){t=t!==null&&t.memoizedState!==null||$n,r=io;var i=$n;io=a,($n=t)&&!i?Jo(e,n,(n.subtreeFlags&8772)!==0):Go(e,n),io=r,$n=i}break;case 30:break;default:Go(e,n)}}function WS(e){var t=e.alternate;t!==null&&(e.alternate=null,WS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Oy(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var jn=null,Nr=!1;function to(e,t,n){for(n=n.child;n!==null;)GS(e,t,n),n=n.sibling}function GS(e,t,n){if(Xr&&typeof Xr.onCommitFiberUnmount=="function")try{Xr.onCommitFiberUnmount(Qf,n)}catch{}switch(n.tag){case 26:$n||ks(n,t),to(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:$n||ks(n,t);var a=jn,r=Nr;Fl(n.type)&&(jn=n.stateNode,Nr=!1),to(e,t,n),pf(n.stateNode),jn=a,Nr=r;break;case 5:$n||ks(n,t);case 6:if(a=jn,r=Nr,jn=null,to(e,t,n),jn=a,Nr=r,jn!==null)if(Nr)try{(jn.nodeType===9?jn.body:jn.nodeName==="HTML"?jn.ownerDocument.body:jn).removeChild(n.stateNode)}catch(i){mn(n,t,i)}else try{jn.removeChild(n.stateNode)}catch(i){mn(n,t,i)}break;case 18:jn!==null&&(Nr?(e=jn,IN(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Of(e)):IN(jn,n.stateNode));break;case 4:a=jn,r=Nr,jn=n.stateNode.containerInfo,Nr=!0,to(e,t,n),jn=a,Nr=r;break;case 0:case 11:case 14:case 15:$n||Tl(2,n,t),$n||Tl(4,n,t),to(e,t,n);break;case 1:$n||(ks(n,t),a=n.stateNode,typeof a.componentWillUnmount=="function"&&BS(n,t,a)),to(e,t,n);break;case 21:to(e,t,n);break;case 22:$n=(a=$n)||n.memoizedState!==null,to(e,t,n),$n=a;break;default:to(e,t,n)}}function VS(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Of(e)}catch(n){mn(t,t.return,n)}}function dT(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new SN),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new SN),t;default:throw Error(We(435,e.tag))}}function $x(e,t){var n=dT(e);t.forEach(function(a){var r=yT.bind(null,e,a);n.has(a)||(n.add(a),a.then(r,r))})}function Br(e,t){var n=t.deletions;if(n!==null)for(var a=0;a<n.length;a++){var r=n[a],i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 27:if(Fl(o.type)){jn=o.stateNode,Nr=!1;break e}break;case 5:jn=o.stateNode,Nr=!1;break e;case 3:case 4:jn=o.stateNode.containerInfo,Nr=!0;break e}o=o.return}if(jn===null)throw Error(We(160));GS(i,s,r),jn=null,Nr=!1,i=r.alternate,i!==null&&(i.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)KS(t,e),t=t.sibling}var Gi=null;function KS(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Br(t,e),zr(e),a&4&&(Tl(3,e,e.return),up(3,e),Tl(5,e,e.return));break;case 1:Br(t,e),zr(e),a&512&&($n||n===null||ks(n,n.return)),a&64&&io&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?a:n.concat(a))));break;case 26:var r=Gi;if(Br(t,e),zr(e),a&512&&($n||n===null||ks(n,n.return)),a&4){var i=n!==null?n.memoizedState:null;if(a=e.memoizedState,n===null)if(a===null)if(e.stateNode===null){e:{a=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(a){case"title":i=r.getElementsByTagName("title")[0],(!i||i[tp]||i[Za]||i.namespaceURI==="http://www.w3.org/2000/svg"||i.hasAttribute("itemprop"))&&(i=r.createElement(a),r.head.insertBefore(i,r.querySelector("head > title"))),za(i,a,n),i[Za]=e,_a(i),a=i;break e;case"link":var s=UN("link","href",r).get(a+(n.href||""));if(s){for(var o=0;o<s.length;o++)if(i=s[o],i.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&i.getAttribute("rel")===(n.rel==null?null:n.rel)&&i.getAttribute("title")===(n.title==null?null:n.title)&&i.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){s.splice(o,1);break t}}i=r.createElement(a),za(i,a,n),r.head.appendChild(i);break;case"meta":if(s=UN("meta","content",r).get(a+(n.content||""))){for(o=0;o<s.length;o++)if(i=s[o],i.getAttribute("content")===(n.content==null?null:""+n.content)&&i.getAttribute("name")===(n.name==null?null:n.name)&&i.getAttribute("property")===(n.property==null?null:n.property)&&i.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&i.getAttribute("charset")===(n.charSet==null?null:n.charSet)){s.splice(o,1);break t}}i=r.createElement(a),za(i,a,n),r.head.appendChild(i);break;default:throw Error(We(468,a))}i[Za]=e,_a(i),a=i}e.stateNode=a}else qN(r,e.type,e.stateNode);else e.stateNode=zN(r,a,e.memoizedProps);else i!==a?(i===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):i.count--,a===null?qN(r,e.type,e.stateNode):zN(r,a,e.memoizedProps)):a===null&&e.stateNode!==null&&Gx(e,e.memoizedProps,n.memoizedProps)}break;case 27:Br(t,e),zr(e),a&512&&($n||n===null||ks(n,n.return)),n!==null&&a&4&&Gx(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Br(t,e),zr(e),a&512&&($n||n===null||ks(n,n.return)),e.flags&32){r=e.stateNode;try{Cd(r,"")}catch(f){mn(e,e.return,f)}}a&4&&e.stateNode!=null&&(r=e.memoizedProps,Gx(e,r,n!==null?n.memoizedProps:r)),a&1024&&(Kx=!0);break;case 6:if(Br(t,e),zr(e),a&4){if(e.stateNode===null)throw Error(We(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(f){mn(e,e.return,f)}}break;case 3:if(fg=null,r=Gi,Gi=Wg(t.containerInfo),Br(t,e),Gi=r,zr(e),a&4&&n!==null&&n.memoizedState.isDehydrated)try{Of(t.containerInfo)}catch(f){mn(e,e.return,f)}Kx&&(Kx=!1,$S(e));break;case 4:a=Gi,Gi=Wg(e.stateNode.containerInfo),Br(t,e),zr(e),Gi=a;break;case 12:Br(t,e),zr(e);break;case 13:Br(t,e),zr(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(g2=Cs()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,$x(e,a)));break;case 22:r=e.memoizedState!==null;var u=n!==null&&n.memoizedState!==null,c=io,d=$n;if(io=c||r,$n=d||u,Br(t,e),$n=d,io=c,zr(e),a&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||u||io||$n||su(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){u=n=t;try{if(i=u.stateNode,r)s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none";else{o=u.stateNode;var h=u.memoizedProps.style,p=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(f){mn(u,u.return,f)}}}else if(t.tag===6){if(n===null){u=t;try{u.stateNode.nodeValue=r?"":u.memoizedProps}catch(f){mn(u,u.return,f)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(n=a.retryQueue,n!==null&&(a.retryQueue=null,$x(e,n))));break;case 19:Br(t,e),zr(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,$x(e,a)));break;case 30:break;case 21:break;default:Br(t,e),zr(e)}}function zr(e){var t=e.flags;if(t&2){try{for(var n,a=e.return;a!==null;){if(US(a)){n=a;break}a=a.return}if(n==null)throw Error(We(160));switch(n.tag){case 27:var r=n.stateNode,i=Vx(e);Og(e,i,r);break;case 5:var s=n.stateNode;n.flags&32&&(Cd(s,""),n.flags&=-33);var o=Vx(e);Og(e,o,s);break;case 3:case 4:var u=n.stateNode.containerInfo,c=Vx(e);S1(e,c,u);break;default:throw Error(We(161))}}catch(d){mn(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $S(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;$S(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Go(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)HS(e,t.alternate,t),t=t.sibling}function su(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Tl(4,t,t.return),su(t);break;case 1:ks(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&BS(t,t.return,n),su(t);break;case 27:pf(t.stateNode);case 26:case 5:ks(t,t.return),su(t);break;case 22:t.memoizedState===null&&su(t);break;case 30:su(t);break;default:su(t)}e=e.sibling}}function Jo(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,r=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:Jo(r,i,n),up(4,i);break;case 1:if(Jo(r,i,n),a=i,r=a.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(c){mn(a,a.return,c)}if(a=i,r=a.updateQueue,r!==null){var o=a.stateNode;try{var u=r.shared.hiddenCallbacks;if(u!==null)for(r.shared.hiddenCallbacks=null,r=0;r<u.length;r++)Hk(u[r],o)}catch(c){mn(a,a.return,c)}}n&&s&64&&FS(i),cf(i,i.return);break;case 27:qS(i);case 26:case 5:Jo(r,i,n),n&&a===null&&s&4&&zS(i),cf(i,i.return);break;case 12:Jo(r,i,n);break;case 13:Jo(r,i,n),n&&s&4&&VS(r,i);break;case 22:i.memoizedState===null&&Jo(r,i,n),cf(i,i.return);break;case 30:break;default:Jo(r,i,n)}t=t.sibling}}function h2(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&ip(n))}function f2(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ip(e))}function hs(e,t,n,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)YS(e,t,n,a),t=t.sibling}function YS(e,t,n,a){var r=t.flags;switch(t.tag){case 0:case 11:case 15:hs(e,t,n,a),r&2048&&up(9,t);break;case 1:hs(e,t,n,a);break;case 3:hs(e,t,n,a),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ip(e)));break;case 12:if(r&2048){hs(e,t,n,a),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;typeof o=="function"&&o(s,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(u){mn(t,t.return,u)}}else hs(e,t,n,a);break;case 13:hs(e,t,n,a);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,t.memoizedState!==null?i._visibility&2?hs(e,t,n,a):df(e,t):i._visibility&2?hs(e,t,n,a):(i._visibility|=2,Ic(e,t,n,a,(t.subtreeFlags&10256)!==0)),r&2048&&h2(s,t);break;case 24:hs(e,t,n,a),r&2048&&f2(t.alternate,t);break;default:hs(e,t,n,a)}}function Ic(e,t,n,a,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var i=e,s=t,o=n,u=a,c=s.flags;switch(s.tag){case 0:case 11:case 15:Ic(i,s,o,u,r),up(8,s);break;case 23:break;case 22:var d=s.stateNode;s.memoizedState!==null?d._visibility&2?Ic(i,s,o,u,r):df(i,s):(d._visibility|=2,Ic(i,s,o,u,r)),r&&c&2048&&h2(s.alternate,s);break;case 24:Ic(i,s,o,u,r),r&&c&2048&&f2(s.alternate,s);break;default:Ic(i,s,o,u,r)}t=t.sibling}}function df(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,a=t,r=a.flags;switch(a.tag){case 22:df(n,a),r&2048&&h2(a.alternate,a);break;case 24:df(n,a),r&2048&&f2(a.alternate,a);break;default:df(n,a)}t=t.sibling}}var Jh=8192;function _c(e){if(e.subtreeFlags&Jh)for(e=e.child;e!==null;)XS(e),e=e.sibling}function XS(e){switch(e.tag){case 26:_c(e),e.flags&Jh&&e.memoizedState!==null&&XT(Gi,e.memoizedState,e.memoizedProps);break;case 5:_c(e);break;case 3:case 4:var t=Gi;Gi=Wg(e.stateNode.containerInfo),_c(e),Gi=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=Jh,Jh=16777216,_c(e),Jh=t):_c(e));break;default:_c(e)}}function JS(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function zh(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];Sa=a,ZS(a,e)}JS(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)QS(e),e=e.sibling}function QS(e){switch(e.tag){case 0:case 11:case 15:zh(e),e.flags&2048&&Tl(9,e,e.return);break;case 3:zh(e);break;case 12:zh(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,dg(e)):zh(e);break;default:zh(e)}}function dg(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];Sa=a,ZS(a,e)}JS(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Tl(8,t,t.return),dg(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,dg(t));break;default:dg(t)}e=e.sibling}}function ZS(e,t){for(;Sa!==null;){var n=Sa;switch(n.tag){case 0:case 11:case 15:Tl(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var a=n.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:ip(n.memoizedState.cache)}if(a=n.child,a!==null)a.return=n,Sa=a;else e:for(n=e;Sa!==null;){a=Sa;var r=a.sibling,i=a.return;if(WS(a),a===n){Sa=null;break e}if(r!==null){r.return=i,Sa=r;break e}Sa=i}}}var hT={getCacheForType:function(e){var t=er(da),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},fT=typeof WeakMap=="function"?WeakMap:Map,on=0,bn=null,Bt=null,Ht=0,sn=0,Ur=null,ol=!1,Kd=!1,p2=!1,No=0,qn=0,Rl=0,yu=0,m2=0,Ni=0,Rd=0,hf=null,kr=null,_1=!1,g2=0,Fg=1/0,Bg=null,bl=null,Ba=0,yl=null,Ld=null,dd=0,j1=0,C1=null,e_=null,ff=0,A1=null;function Qr(){if(on&2&&Ht!==0)return Ht&-Ht;if(kt.T!==null){var e=Ad;return e!==0?e:x2()}return dk()}function t_(){Ni===0&&(Ni=!(Ht&536870912)||Xt?ok():536870912);var e=Ci.current;return e!==null&&(e.flags|=32),Ni}function Zr(e,t,n){(e===bn&&(sn===2||sn===9)||e.cancelPendingCommit!==null)&&(Pd(e,0),ll(e,Ht,Ni,!1)),ep(e,n),(!(on&2)||e!==bn)&&(e===bn&&(!(on&2)&&(yu|=n),qn===4&&ll(e,Ht,Ni,!1)),Os(e))}function n_(e,t,n){if(on&6)throw Error(We(327));var a=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Zf(e,t),r=a?gT(e,t):Yx(e,t,!0),i=a;do{if(r===0){Kd&&!a&&ll(e,t,0,!1);break}else{if(n=e.current.alternate,i&&!pT(n)){r=Yx(e,t,!1),i=!1;continue}if(r===2){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=e.pendingLanes&-536870913,s=s!==0?s:s&536870912?536870912:0;if(s!==0){t=s;e:{var o=e;r=hf;var u=o.current.memoizedState.isDehydrated;if(u&&(Pd(o,s).flags|=256),s=Yx(o,s,!1),s!==2){if(p2&&!u){o.errorRecoveryDisabledLanes|=i,yu|=i,r=4;break e}i=kr,kr=r,i!==null&&(kr===null?kr=i:kr.push.apply(kr,i))}r=s}if(i=!1,r!==2)continue}}if(r===1){Pd(e,0),ll(e,t,0,!0);break}e:{switch(a=e,i=r,i){case 0:case 1:throw Error(We(345));case 4:if((t&4194048)!==t)break;case 6:ll(a,t,Ni,!ol);break e;case 2:kr=null;break;case 3:case 5:break;default:throw Error(We(329))}if((t&62914560)===t&&(r=g2+300-Cs(),10<r)){if(ll(a,t,Ni,!ol),M0(a,0,!0)!==0)break e;a.timeoutHandle=w_(_N.bind(null,a,n,kr,Bg,_1,t,Ni,yu,Rd,ol,i,2,-0,0),r);break e}_N(a,n,kr,Bg,_1,t,Ni,yu,Rd,ol,i,0,-0,0)}}break}while(!0);Os(e)}function _N(e,t,n,a,r,i,s,o,u,c,d,h,p,f){if(e.timeoutHandle=-1,h=t.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(Lf={stylesheets:null,count:0,unsuspend:YT},XS(t),h=JT(),h!==null)){e.cancelPendingCommit=h(CN.bind(null,e,t,i,n,a,r,s,o,u,d,1,p,f)),ll(e,i,s,!c);return}CN(e,t,i,n,a,r,s,o,u)}function pT(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var a=0;a<n.length;a++){var r=n[a],i=r.getSnapshot;r=r.value;try{if(!ti(i(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ll(e,t,n,a){t&=~m2,t&=~yu,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var r=t;0<r;){var i=31-Jr(r),s=1<<i;a[i]=-1,r&=~s}n!==0&&uk(e,n,t)}function G0(){return on&6?!0:(cp(0),!1)}function v2(){if(Bt!==null){if(sn===0)var e=Bt.return;else e=Bt,fo=Uu=null,a2(e),cd=null,Df=0,e=Bt;for(;e!==null;)OS(e.alternate,e),e=e.return;Bt=null}}function Pd(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,RT(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),v2(),bn=e,Bt=n=mo(e.current,null),Ht=t,sn=0,Ur=null,ol=!1,Kd=Zf(e,t),p2=!1,Rd=Ni=m2=yu=Rl=qn=0,kr=hf=null,_1=!1,t&8&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var r=31-Jr(a),i=1<<r;t|=e[r],a&=~i}return No=t,B0(),n}function a_(e,t){It=null,kt.H=Rg,t===sp||t===U0?(t=aN(),sn=3):t===Uk?(t=aN(),sn=4):sn=t===TS?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ur=t,Bt===null&&(qn=1,Mg(e,yi(t,e.current)))}function r_(){var e=kt.H;return kt.H=Rg,e===null?Rg:e}function i_(){var e=kt.A;return kt.A=hT,e}function E1(){qn=4,ol||(Ht&4194048)!==Ht&&Ci.current!==null||(Kd=!0),!(Rl&134217727)&&!(yu&134217727)||bn===null||ll(bn,Ht,Ni,!1)}function Yx(e,t,n){var a=on;on|=2;var r=r_(),i=i_();(bn!==e||Ht!==t)&&(Bg=null,Pd(e,t)),t=!1;var s=qn;e:do try{if(sn!==0&&Bt!==null){var o=Bt,u=Ur;switch(sn){case 8:v2(),s=6;break e;case 3:case 2:case 9:case 6:Ci.current===null&&(t=!0);var c=sn;if(sn=0,Ur=null,ad(e,o,u,c),n&&Kd){s=0;break e}break;default:c=sn,sn=0,Ur=null,ad(e,o,u,c)}}mT(),s=qn;break}catch(d){a_(e,d)}while(!0);return t&&e.shellSuspendCounter++,fo=Uu=null,on=a,kt.H=r,kt.A=i,Bt===null&&(bn=null,Ht=0,B0()),s}function mT(){for(;Bt!==null;)s_(Bt)}function gT(e,t){var n=on;on|=2;var a=r_(),r=i_();bn!==e||Ht!==t?(Bg=null,Fg=Cs()+500,Pd(e,t)):Kd=Zf(e,t);e:do try{if(sn!==0&&Bt!==null){t=Bt;var i=Ur;t:switch(sn){case 1:sn=0,Ur=null,ad(e,t,i,1);break;case 2:case 9:if(nN(i)){sn=0,Ur=null,jN(t);break}t=function(){sn!==2&&sn!==9||bn!==e||(sn=7),Os(e)},i.then(t,t);break e;case 3:sn=7;break e;case 4:sn=5;break e;case 7:nN(i)?(sn=0,Ur=null,jN(t)):(sn=0,Ur=null,ad(e,t,i,7));break;case 5:var s=null;switch(Bt.tag){case 26:s=Bt.memoizedState;case 5:case 27:var o=Bt;if(!s||__(s)){sn=0,Ur=null;var u=o.sibling;if(u!==null)Bt=u;else{var c=o.return;c!==null?(Bt=c,V0(c)):Bt=null}break t}}sn=0,Ur=null,ad(e,t,i,5);break;case 6:sn=0,Ur=null,ad(e,t,i,6);break;case 8:v2(),qn=6;break e;default:throw Error(We(462))}}vT();break}catch(d){a_(e,d)}while(!0);return fo=Uu=null,kt.H=a,kt.A=r,on=n,Bt!==null?0:(bn=null,Ht=0,B0(),qn)}function vT(){for(;Bt!==null&&!BE();)s_(Bt)}function s_(e){var t=IS(e.alternate,e,No);e.memoizedProps=e.pendingProps,t===null?V0(e):Bt=t}function jN(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=bN(n,t,t.pendingProps,t.type,void 0,Ht);break;case 11:t=bN(n,t,t.pendingProps,t.type.render,t.ref,Ht);break;case 5:a2(t);default:OS(n,t),t=Bt=Ok(t,No),t=IS(n,t,No)}e.memoizedProps=e.pendingProps,t===null?V0(e):Bt=t}function ad(e,t,n,a){fo=Uu=null,a2(t),cd=null,Df=0;var r=t.return;try{if(sT(e,r,t,n,Ht)){qn=1,Mg(e,yi(n,e.current)),Bt=null;return}}catch(i){if(r!==null)throw Bt=r,i;qn=1,Mg(e,yi(n,e.current)),Bt=null;return}t.flags&32768?(Xt||a===1?e=!0:Kd||Ht&536870912?e=!1:(ol=e=!0,(a===2||a===9||a===3||a===6)&&(a=Ci.current,a!==null&&a.tag===13&&(a.flags|=16384))),o_(t,e)):V0(t)}function V0(e){var t=e;do{if(t.flags&32768){o_(t,ol);return}e=t.return;var n=lT(t.alternate,t,No);if(n!==null){Bt=n;return}if(t=t.sibling,t!==null){Bt=t;return}Bt=t=e}while(t!==null);qn===0&&(qn=5)}function o_(e,t){do{var n=uT(e.alternate,e);if(n!==null){n.flags&=32767,Bt=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Bt=e;return}Bt=e=n}while(e!==null);qn=6,Bt=null}function CN(e,t,n,a,r,i,s,o,u){e.cancelPendingCommit=null;do K0();while(Ba!==0);if(on&6)throw Error(We(327));if(t!==null){if(t===e.current)throw Error(We(177));if(i=t.lanes|t.childLanes,i|=Wy,YE(e,n,i,s,o,u),e===bn&&(Bt=bn=null,Ht=0),Ld=t,yl=e,dd=n,j1=i,C1=r,e_=a,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,wT(Ng,function(){return h_(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,t.subtreeFlags&13878||a){a=kt.T,kt.T=null,r=Zt.p,Zt.p=2,s=on,on|=4;try{cT(e,t,n)}finally{on=s,Zt.p=r,kt.T=a}}Ba=1,l_(),u_(),c_()}}function l_(){if(Ba===1){Ba=0;var e=yl,t=Ld,n=(t.flags&13878)!==0;if(t.subtreeFlags&13878||n){n=kt.T,kt.T=null;var a=Zt.p;Zt.p=2;var r=on;on|=4;try{KS(t,e);var i=L1,s=Ek(e.containerInfo),o=i.focusedElem,u=i.selectionRange;if(s!==o&&o&&o.ownerDocument&&Ak(o.ownerDocument.documentElement,o)){if(u!==null&&Hy(o)){var c=u.start,d=u.end;if(d===void 0&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var h=o.ownerDocument||document,p=h&&h.defaultView||window;if(p.getSelection){var f=p.getSelection(),g=o.textContent.length,b=Math.min(u.start,g),w=u.end===void 0?b:Math.min(u.end,g);!f.extend&&b>w&&(s=w,w=b,b=s);var m=$5(o,b),x=$5(o,w);if(m&&x&&(f.rangeCount!==1||f.anchorNode!==m.node||f.anchorOffset!==m.offset||f.focusNode!==x.node||f.focusOffset!==x.offset)){var y=h.createRange();y.setStart(m.node,m.offset),f.removeAllRanges(),b>w?(f.addRange(y),f.extend(x.node,x.offset)):(y.setEnd(x.node,x.offset),f.addRange(y))}}}}for(h=[],f=o;f=f.parentNode;)f.nodeType===1&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var N=h[o];N.element.scrollLeft=N.left,N.element.scrollTop=N.top}}Kg=!!R1,L1=R1=null}finally{on=r,Zt.p=a,kt.T=n}}e.current=t,Ba=2}}function u_(){if(Ba===2){Ba=0;var e=yl,t=Ld,n=(t.flags&8772)!==0;if(t.subtreeFlags&8772||n){n=kt.T,kt.T=null;var a=Zt.p;Zt.p=2;var r=on;on|=4;try{HS(e,t.alternate,t)}finally{on=r,Zt.p=a,kt.T=n}}Ba=3}}function c_(){if(Ba===4||Ba===3){Ba=0,zE();var e=yl,t=Ld,n=dd,a=e_;t.subtreeFlags&10256||t.flags&10256?Ba=5:(Ba=0,Ld=yl=null,d_(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(bl=null),Iy(n),t=t.stateNode,Xr&&typeof Xr.onCommitFiberRoot=="function")try{Xr.onCommitFiberRoot(Qf,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=kt.T,r=Zt.p,Zt.p=2,kt.T=null;try{for(var i=e.onRecoverableError,s=0;s<a.length;s++){var o=a[s];i(o.value,{componentStack:o.stack})}}finally{kt.T=t,Zt.p=r}}dd&3&&K0(),Os(e),r=e.pendingLanes,n&4194090&&r&42?e===A1?ff++:(ff=0,A1=e):ff=0,cp(0)}}function d_(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ip(t)))}function K0(e){return l_(),u_(),c_(),h_()}function h_(){if(Ba!==5)return!1;var e=yl,t=j1;j1=0;var n=Iy(dd),a=kt.T,r=Zt.p;try{Zt.p=32>n?32:n,kt.T=null,n=C1,C1=null;var i=yl,s=dd;if(Ba=0,Ld=yl=null,dd=0,on&6)throw Error(We(331));var o=on;if(on|=4,QS(i.current),YS(i,i.current,s,n),on=o,cp(0,!1),Xr&&typeof Xr.onPostCommitFiberRoot=="function")try{Xr.onPostCommitFiberRoot(Qf,i)}catch{}return!0}finally{Zt.p=r,kt.T=a,d_(e,t)}}function AN(e,t,n){t=yi(n,t),t=w1(e.stateNode,t,2),e=xl(e,t,2),e!==null&&(ep(e,2),Os(e))}function mn(e,t,n){if(e.tag===3)AN(e,e,n);else for(;t!==null;){if(t.tag===3){AN(t,e,n);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(bl===null||!bl.has(a))){e=yi(n,e),n=ES(2),a=xl(t,n,2),a!==null&&(DS(n,a,t,e),ep(a,2),Os(a));break}}t=t.return}}function Xx(e,t,n){var a=e.pingCache;if(a===null){a=e.pingCache=new fT;var r=new Set;a.set(t,r)}else r=a.get(t),r===void 0&&(r=new Set,a.set(t,r));r.has(n)||(p2=!0,r.add(n),e=xT.bind(null,e,t,n),t.then(e,e))}function xT(e,t,n){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,bn===e&&(Ht&n)===n&&(qn===4||qn===3&&(Ht&62914560)===Ht&&300>Cs()-g2?!(on&2)&&Pd(e,0):m2|=n,Rd===Ht&&(Rd=0)),Os(e)}function f_(e,t){t===0&&(t=lk()),e=Vd(e,t),e!==null&&(ep(e,t),Os(e))}function bT(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),f_(e,n)}function yT(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(We(314))}a!==null&&a.delete(t),f_(e,n)}function wT(e,t){return Py(e,t)}var zg=null,Oc=null,D1=!1,Ug=!1,Jx=!1,wu=0;function Os(e){e!==Oc&&e.next===null&&(Oc===null?zg=Oc=e:Oc=Oc.next=e),Ug=!0,D1||(D1=!0,kT())}function cp(e,t){if(!Jx&&Ug){Jx=!0;do for(var n=!1,a=zg;a!==null;){if(e!==0){var r=a.pendingLanes;if(r===0)var i=0;else{var s=a.suspendedLanes,o=a.pingedLanes;i=(1<<31-Jr(42|e)+1)-1,i&=r&~(s&~o),i=i&201326741?i&201326741|1:i?i|2:0}i!==0&&(n=!0,EN(a,i))}else i=Ht,i=M0(a,a===bn?i:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),!(i&3)||Zf(a,i)||(n=!0,EN(a,i));a=a.next}while(n);Jx=!1}}function NT(){p_()}function p_(){Ug=D1=!1;var e=0;wu!==0&&(TT()&&(e=wu),wu=0);for(var t=Cs(),n=null,a=zg;a!==null;){var r=a.next,i=m_(a,t);i===0?(a.next=null,n===null?zg=r:n.next=r,r===null&&(Oc=n)):(n=a,(e!==0||i&3)&&(Ug=!0)),a=r}cp(e)}function m_(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes&-62914561;0<i;){var s=31-Jr(i),o=1<<s,u=r[s];u===-1?(!(o&n)||o&a)&&(r[s]=$E(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}if(t=bn,n=Ht,n=M0(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,n===0||e===t&&(sn===2||sn===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&kx(a),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||Zf(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(a!==null&&kx(a),Iy(n)){case 2:case 8:n=ik;break;case 32:n=Ng;break;case 268435456:n=sk;break;default:n=Ng}return a=g_.bind(null,e),n=Py(n,a),e.callbackPriority=t,e.callbackNode=n,t}return a!==null&&a!==null&&kx(a),e.callbackPriority=2,e.callbackNode=null,2}function g_(e,t){if(Ba!==0&&Ba!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(K0()&&e.callbackNode!==n)return null;var a=Ht;return a=M0(e,e===bn?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(n_(e,a,t),m_(e,Cs()),e.callbackNode!=null&&e.callbackNode===n?g_.bind(null,e):null)}function EN(e,t){if(K0())return null;n_(e,t,!0)}function kT(){LT(function(){on&6?Py(rk,NT):p_()})}function x2(){return wu===0&&(wu=ok()),wu}function DN(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ag(""+e)}function TN(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function ST(e,t,n,a,r){if(t==="submit"&&n&&n.stateNode===r){var i=DN((r[Ar]||null).action),s=a.submitter;s&&(t=(t=s[Ar]||null)?DN(t.formAction):s.getAttribute("formAction"),t!==null&&(i=t,s=null));var o=new I0("action","action",null,a,r);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(wu!==0){var u=s?TN(r,s):new FormData(r);b1(n,{pending:!0,data:u,method:r.method,action:i},null,u)}}else typeof i=="function"&&(o.preventDefault(),u=s?TN(r,s):new FormData(r),b1(n,{pending:!0,data:u,method:r.method,action:i},i,u))},currentTarget:r}]})}}for(var Qx=0;Qx<o1.length;Qx++){var Zx=o1[Qx],_T=Zx.toLowerCase(),jT=Zx[0].toUpperCase()+Zx.slice(1);Ji(_T,"on"+jT)}Ji(Tk,"onAnimationEnd");Ji(Rk,"onAnimationIteration");Ji(Lk,"onAnimationStart");Ji("dblclick","onDoubleClick");Ji("focusin","onFocus");Ji("focusout","onBlur");Ji(HD,"onTransitionRun");Ji(WD,"onTransitionStart");Ji(GD,"onTransitionCancel");Ji(Pk,"onTransitionEnd");jd("onMouseEnter",["mouseout","mouseover"]);jd("onMouseLeave",["mouseout","mouseover"]);jd("onPointerEnter",["pointerout","pointerover"]);jd("onPointerLeave",["pointerout","pointerover"]);Fu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tf));function v_(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var s=a.length-1;0<=s;s--){var o=a[s],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&r.isPropagationStopped())break e;i=o,r.currentTarget=c;try{i(r)}catch(d){Pg(d)}r.currentTarget=null,i=u}else for(s=0;s<a.length;s++){if(o=a[s],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&r.isPropagationStopped())break e;i=o,r.currentTarget=c;try{i(r)}catch(d){Pg(d)}r.currentTarget=null,i=u}}}}function Ft(e,t){var n=t[e1];n===void 0&&(n=t[e1]=new Set);var a=e+"__bubble";n.has(a)||(x_(t,e,2,!1),n.add(a))}function eb(e,t,n){var a=0;t&&(a|=4),x_(n,e,a,t)}var Em="_reactListening"+Math.random().toString(36).slice(2);function b2(e){if(!e[Em]){e[Em]=!0,hk.forEach(function(n){n!=="selectionchange"&&(CT.has(n)||eb(n,!1,e),eb(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Em]||(t[Em]=!0,eb("selectionchange",!1,t))}}function x_(e,t,n,a){switch(D_(t)){case 2:var r=eR;break;case 8:r=tR;break;default:r=k2}n=r.bind(null,t,n,e),r=void 0,!r1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),a?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function tb(e,t,n,a,r){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var s=a.tag;if(s===3||s===4){var o=a.stateNode.containerInfo;if(o===r)break;if(s===4)for(s=a.return;s!==null;){var u=s.tag;if((u===3||u===4)&&s.stateNode.containerInfo===r)return;s=s.return}for(;o!==null;){if(s=$c(o),s===null)return;if(u=s.tag,u===5||u===6||u===26||u===27){a=i=s;continue e}o=o.parentNode}}a=a.return}yk(function(){var c=i,d=By(n),h=[];e:{var p=Mk.get(e);if(p!==void 0){var f=I0,g=e;switch(e){case"keypress":if(ig(n)===0)break e;case"keydown":case"keyup":f=wD;break;case"focusin":g="focus",f=Tx;break;case"focusout":g="blur",f=Tx;break;case"beforeblur":case"afterblur":f=Tx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=F5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=uD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=SD;break;case Tk:case Rk:case Lk:f=hD;break;case Pk:f=jD;break;case"scroll":case"scrollend":f=oD;break;case"wheel":f=AD;break;case"copy":case"cut":case"paste":f=pD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=z5;break;case"toggle":case"beforetoggle":f=DD}var b=(t&4)!==0,w=!b&&(e==="scroll"||e==="scrollend"),m=b?p!==null?p+"Capture":null:p;b=[];for(var x=c,y;x!==null;){var N=x;if(y=N.stateNode,N=N.tag,N!==5&&N!==26&&N!==27||y===null||m===null||(N=_f(x,m),N!=null&&b.push(Rf(x,N,y))),w)break;x=x.return}0<b.length&&(p=new f(p,g,null,n,d),h.push({event:p,listeners:b}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&n!==a1&&(g=n.relatedTarget||n.fromElement)&&($c(g)||g[Wd]))break e;if((f||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,f?(g=n.relatedTarget||n.toElement,f=c,g=g?$c(g):null,g!==null&&(w=Jf(g),b=g.tag,g!==w||b!==5&&b!==27&&b!==6)&&(g=null)):(f=null,g=c),f!==g)){if(b=F5,N="onMouseLeave",m="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(b=z5,N="onPointerLeave",m="onPointerEnter",x="pointer"),w=f==null?p:Xh(f),y=g==null?p:Xh(g),p=new b(N,x+"leave",f,n,d),p.target=w,p.relatedTarget=y,N=null,$c(d)===c&&(b=new b(m,x+"enter",g,n,d),b.target=y,b.relatedTarget=w,N=b),w=N,f&&g)t:{for(b=f,m=g,x=0,y=b;y;y=jc(y))x++;for(y=0,N=m;N;N=jc(N))y++;for(;0<x-y;)b=jc(b),x--;for(;0<y-x;)m=jc(m),y--;for(;x--;){if(b===m||m!==null&&b===m.alternate)break t;b=jc(b),m=jc(m)}b=null}else b=null;f!==null&&RN(h,p,f,b,!1),g!==null&&w!==null&&RN(h,w,g,b,!0)}}e:{if(p=c?Xh(c):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=W5;else if(H5(p))if(jk)S=zD;else{S=FD;var T=OD}else f=p.nodeName,!f||f.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?c&&Fy(c.elementType)&&(S=W5):S=BD;if(S&&(S=S(e,c))){_k(h,S,n,d);break e}T&&T(e,p,c),e==="focusout"&&c&&p.type==="number"&&c.memoizedProps.value!=null&&n1(p,"number",p.value)}switch(T=c?Xh(c):window,e){case"focusin":(H5(T)||T.contentEditable==="true")&&(Jc=T,i1=c,nf=null);break;case"focusout":nf=i1=Jc=null;break;case"mousedown":s1=!0;break;case"contextmenu":case"mouseup":case"dragend":s1=!1,Y5(h,n,d);break;case"selectionchange":if(qD)break;case"keydown":case"keyup":Y5(h,n,d)}var C;if(qy)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Xc?kk(e,n)&&(A="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(Nk&&n.locale!=="ko"&&(Xc||A!=="onCompositionStart"?A==="onCompositionEnd"&&Xc&&(C=wk()):(sl=d,zy="value"in sl?sl.value:sl.textContent,Xc=!0)),T=qg(c,A),0<T.length&&(A=new B5(A,e,null,n,d),h.push({event:A,listeners:T}),C?A.data=C:(C=Sk(n),C!==null&&(A.data=C)))),(C=RD?LD(e,n):PD(e,n))&&(A=qg(c,"onBeforeInput"),0<A.length&&(T=new B5("onBeforeInput","beforeinput",null,n,d),h.push({event:T,listeners:A}),T.data=C)),ST(h,e,c,n,d)}v_(h,t)})}function Rf(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qg(e,t){for(var n=t+"Capture",a=[];e!==null;){var r=e,i=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||i===null||(r=_f(e,n),r!=null&&a.unshift(Rf(e,r,i)),r=_f(e,t),r!=null&&a.push(Rf(e,r,i))),e.tag===3)return a;e=e.return}return[]}function jc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function RN(e,t,n,a,r){for(var i=t._reactName,s=[];n!==null&&n!==a;){var o=n,u=o.alternate,c=o.stateNode;if(o=o.tag,u!==null&&u===a)break;o!==5&&o!==26&&o!==27||c===null||(u=c,r?(c=_f(n,i),c!=null&&s.unshift(Rf(n,c,u))):r||(c=_f(n,i),c!=null&&s.push(Rf(n,c,u)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var AT=/\r\n?/g,ET=/\u0000|\uFFFD/g;function LN(e){return(typeof e=="string"?e:""+e).replace(AT,`
`).replace(ET,"")}function b_(e,t){return t=LN(t),LN(e)===t}function $0(){}function dn(e,t,n,a,r,i){switch(n){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||Cd(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&Cd(e,""+a);break;case"className":Nm(e,"class",a);break;case"tabIndex":Nm(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":Nm(e,n,a);break;case"style":bk(e,a,i);break;case"data":if(t!=="object"){Nm(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=ag(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof i=="function"&&(n==="formAction"?(t!=="input"&&dn(e,t,"name",r.name,r,null),dn(e,t,"formEncType",r.formEncType,r,null),dn(e,t,"formMethod",r.formMethod,r,null),dn(e,t,"formTarget",r.formTarget,r,null)):(dn(e,t,"encType",r.encType,r,null),dn(e,t,"method",r.method,r,null),dn(e,t,"target",r.target,r,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=ag(""+a),e.setAttribute(n,a);break;case"onClick":a!=null&&(e.onclick=$0);break;case"onScroll":a!=null&&Ft("scroll",e);break;case"onScrollEnd":a!=null&&Ft("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(We(61));if(n=a.__html,n!=null){if(r.children!=null)throw Error(We(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}n=ag(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":a===!0?e.setAttribute(n,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Ft("beforetoggle",e),Ft("toggle",e),ng(e,"popover",a);break;case"xlinkActuate":Zs(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":Zs(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":Zs(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":Zs(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":Zs(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":Zs(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":Zs(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":Zs(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":Zs(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":ng(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=iD.get(n)||n,ng(e,n,a))}}function T1(e,t,n,a,r,i){switch(n){case"style":bk(e,a,i);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(We(61));if(n=a.__html,n!=null){if(r.children!=null)throw Error(We(60));e.innerHTML=n}}break;case"children":typeof a=="string"?Cd(e,a):(typeof a=="number"||typeof a=="bigint")&&Cd(e,""+a);break;case"onScroll":a!=null&&Ft("scroll",e);break;case"onScrollEnd":a!=null&&Ft("scrollend",e);break;case"onClick":a!=null&&(e.onclick=$0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fk.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),i=e[Ar]||null,i=i!=null?i[n]:null,typeof i=="function"&&e.removeEventListener(t,i,r),typeof a=="function")){typeof i!="function"&&i!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,r);break e}n in e?e[n]=a:a===!0?e.setAttribute(n,""):ng(e,n,a)}}}function za(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ft("error",e),Ft("load",e);var a=!1,r=!1,i;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(s!=null)switch(i){case"src":a=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(We(137,t));default:dn(e,t,i,s,n,null)}}r&&dn(e,t,"srcSet",n.srcSet,n,null),a&&dn(e,t,"src",n.src,n,null);return;case"input":Ft("invalid",e);var o=i=s=r=null,u=null,c=null;for(a in n)if(n.hasOwnProperty(a)){var d=n[a];if(d!=null)switch(a){case"name":r=d;break;case"type":s=d;break;case"checked":u=d;break;case"defaultChecked":c=d;break;case"value":i=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(We(137,t));break;default:dn(e,t,a,d,n,null)}}gk(e,i,o,u,c,s,r,!1),kg(e);return;case"select":Ft("invalid",e),a=s=i=null;for(r in n)if(n.hasOwnProperty(r)&&(o=n[r],o!=null))switch(r){case"value":i=o;break;case"defaultValue":s=o;break;case"multiple":a=o;default:dn(e,t,r,o,n,null)}t=i,n=s,e.multiple=!!a,t!=null?id(e,!!a,t,!1):n!=null&&id(e,!!a,n,!0);return;case"textarea":Ft("invalid",e),i=r=a=null;for(s in n)if(n.hasOwnProperty(s)&&(o=n[s],o!=null))switch(s){case"value":a=o;break;case"defaultValue":r=o;break;case"children":i=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(We(91));break;default:dn(e,t,s,o,n,null)}xk(e,a,r,i),kg(e);return;case"option":for(u in n)if(n.hasOwnProperty(u)&&(a=n[u],a!=null))switch(u){case"selected":e.selected=a&&typeof a!="function"&&typeof a!="symbol";break;default:dn(e,t,u,a,n,null)}return;case"dialog":Ft("beforetoggle",e),Ft("toggle",e),Ft("cancel",e),Ft("close",e);break;case"iframe":case"object":Ft("load",e);break;case"video":case"audio":for(a=0;a<Tf.length;a++)Ft(Tf[a],e);break;case"image":Ft("error",e),Ft("load",e);break;case"details":Ft("toggle",e);break;case"embed":case"source":case"link":Ft("error",e),Ft("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(a=n[c],a!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(We(137,t));default:dn(e,t,c,a,n,null)}return;default:if(Fy(t)){for(d in n)n.hasOwnProperty(d)&&(a=n[d],a!==void 0&&T1(e,t,d,a,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(a=n[o],a!=null&&dn(e,t,o,a,n,null))}function DT(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,i=null,s=null,o=null,u=null,c=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&h!=null)switch(f){case"checked":break;case"value":break;case"defaultValue":u=h;default:a.hasOwnProperty(f)||dn(e,t,f,null,a,h)}}for(var p in a){var f=a[p];if(h=n[p],a.hasOwnProperty(p)&&(f!=null||h!=null))switch(p){case"type":i=f;break;case"name":r=f;break;case"checked":c=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":o=f;break;case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(We(137,t));break;default:f!==h&&dn(e,t,p,f,a,h)}}t1(e,s,o,u,c,d,i,r);return;case"select":f=s=o=p=null;for(i in n)if(u=n[i],n.hasOwnProperty(i)&&u!=null)switch(i){case"value":break;case"multiple":f=u;default:a.hasOwnProperty(i)||dn(e,t,i,null,a,u)}for(r in a)if(i=a[r],u=n[r],a.hasOwnProperty(r)&&(i!=null||u!=null))switch(r){case"value":p=i;break;case"defaultValue":o=i;break;case"multiple":s=i;default:i!==u&&dn(e,t,r,i,a,u)}t=o,n=s,a=f,p!=null?id(e,!!n,p,!1):!!a!=!!n&&(t!=null?id(e,!!n,t,!0):id(e,!!n,n?[]:"",!1));return;case"textarea":f=p=null;for(o in n)if(r=n[o],n.hasOwnProperty(o)&&r!=null&&!a.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:dn(e,t,o,null,a,r)}for(s in a)if(r=a[s],i=n[s],a.hasOwnProperty(s)&&(r!=null||i!=null))switch(s){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(We(91));break;default:r!==i&&dn(e,t,s,r,a,i)}vk(e,p,f);return;case"option":for(var g in n)if(p=n[g],n.hasOwnProperty(g)&&p!=null&&!a.hasOwnProperty(g))switch(g){case"selected":e.selected=!1;break;default:dn(e,t,g,null,a,p)}for(u in a)if(p=a[u],f=n[u],a.hasOwnProperty(u)&&p!==f&&(p!=null||f!=null))switch(u){case"selected":e.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:dn(e,t,u,p,a,f)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var b in n)p=n[b],n.hasOwnProperty(b)&&p!=null&&!a.hasOwnProperty(b)&&dn(e,t,b,null,a,p);for(c in a)if(p=a[c],f=n[c],a.hasOwnProperty(c)&&p!==f&&(p!=null||f!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(We(137,t));break;default:dn(e,t,c,p,a,f)}return;default:if(Fy(t)){for(var w in n)p=n[w],n.hasOwnProperty(w)&&p!==void 0&&!a.hasOwnProperty(w)&&T1(e,t,w,void 0,a,p);for(d in a)p=a[d],f=n[d],!a.hasOwnProperty(d)||p===f||p===void 0&&f===void 0||T1(e,t,d,p,a,f);return}}for(var m in n)p=n[m],n.hasOwnProperty(m)&&p!=null&&!a.hasOwnProperty(m)&&dn(e,t,m,null,a,p);for(h in a)p=a[h],f=n[h],!a.hasOwnProperty(h)||p===f||p==null&&f==null||dn(e,t,h,p,a,f)}var R1=null,L1=null;function Hg(e){return e.nodeType===9?e:e.ownerDocument}function PN(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function y_(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function P1(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var nb=null;function TT(){var e=window.event;return e&&e.type==="popstate"?e===nb?!1:(nb=e,!0):(nb=null,!1)}var w_=typeof setTimeout=="function"?setTimeout:void 0,RT=typeof clearTimeout=="function"?clearTimeout:void 0,MN=typeof Promise=="function"?Promise:void 0,LT=typeof queueMicrotask=="function"?queueMicrotask:typeof MN<"u"?function(e){return MN.resolve(null).then(e).catch(PT)}:w_;function PT(e){setTimeout(function(){throw e})}function Fl(e){return e==="head"}function IN(e,t){var n=t,a=0,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(0<a&&8>a){n=a;var s=e.ownerDocument;if(n&1&&pf(s.documentElement),n&2&&pf(s.body),n&4)for(n=s.head,pf(n),s=n.firstChild;s;){var o=s.nextSibling,u=s.nodeName;s[tp]||u==="SCRIPT"||u==="STYLE"||u==="LINK"&&s.rel.toLowerCase()==="stylesheet"||n.removeChild(s),s=o}}if(r===0){e.removeChild(i),Of(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:a=n.charCodeAt(0)-48;else a=0;n=i}while(n);Of(t)}function M1(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":M1(n),Oy(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function MT(e,t,n,a){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[tp])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(i=e.getAttribute("rel"),i==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(i!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(i=e.getAttribute("src"),(i!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var i=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===i)return e}else return e;if(e=$i(e.nextSibling),e===null)break}return null}function IT(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=$i(e.nextSibling),e===null))return null;return e}function I1(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function OT(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function $i(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var O1=null;function ON(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function N_(e,t,n){switch(t=Hg(n),e){case"html":if(e=t.documentElement,!e)throw Error(We(452));return e;case"head":if(e=t.head,!e)throw Error(We(453));return e;case"body":if(e=t.body,!e)throw Error(We(454));return e;default:throw Error(We(451))}}function pf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Oy(e)}var Ai=new Map,FN=new Set;function Wg(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ko=Zt.d;Zt.d={f:FT,r:BT,D:zT,C:UT,L:qT,m:HT,X:GT,S:WT,M:VT};function FT(){var e=ko.f(),t=G0();return e||t}function BT(e){var t=Gd(e);t!==null&&t.tag===5&&t.type==="form"?mS(t):ko.r(e)}var $d=typeof document>"u"?null:document;function k_(e,t,n){var a=$d;if(a&&typeof t=="string"&&t){var r=bi(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),FN.has(r)||(FN.add(r),e={rel:e,crossOrigin:n,href:t},a.querySelector(r)===null&&(t=a.createElement("link"),za(t,"link",e),_a(t),a.head.appendChild(t)))}}function zT(e){ko.D(e),k_("dns-prefetch",e,null)}function UT(e,t){ko.C(e,t),k_("preconnect",e,t)}function qT(e,t,n){ko.L(e,t,n);var a=$d;if(a&&e&&t){var r='link[rel="preload"][as="'+bi(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+bi(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+bi(n.imageSizes)+'"]')):r+='[href="'+bi(e)+'"]';var i=r;switch(t){case"style":i=Md(e);break;case"script":i=Yd(e)}Ai.has(i)||(e=Sn({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Ai.set(i,e),a.querySelector(r)!==null||t==="style"&&a.querySelector(dp(i))||t==="script"&&a.querySelector(hp(i))||(t=a.createElement("link"),za(t,"link",e),_a(t),a.head.appendChild(t)))}}function HT(e,t){ko.m(e,t);var n=$d;if(n&&e){var a=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+bi(a)+'"][href="'+bi(e)+'"]',i=r;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Yd(e)}if(!Ai.has(i)&&(e=Sn({rel:"modulepreload",href:e},t),Ai.set(i,e),n.querySelector(r)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(hp(i)))return}a=n.createElement("link"),za(a,"link",e),_a(a),n.head.appendChild(a)}}}function WT(e,t,n){ko.S(e,t,n);var a=$d;if(a&&e){var r=rd(a).hoistableStyles,i=Md(e);t=t||"default";var s=r.get(i);if(!s){var o={loading:0,preload:null};if(s=a.querySelector(dp(i)))o.loading=5;else{e=Sn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Ai.get(i))&&y2(e,n);var u=s=a.createElement("link");_a(u),za(u,"link",e),u._p=new Promise(function(c,d){u.onload=c,u.onerror=d}),u.addEventListener("load",function(){o.loading|=1}),u.addEventListener("error",function(){o.loading|=2}),o.loading|=4,hg(s,t,a)}s={type:"stylesheet",instance:s,count:1,state:o},r.set(i,s)}}}function GT(e,t){ko.X(e,t);var n=$d;if(n&&e){var a=rd(n).hoistableScripts,r=Yd(e),i=a.get(r);i||(i=n.querySelector(hp(r)),i||(e=Sn({src:e,async:!0},t),(t=Ai.get(r))&&w2(e,t),i=n.createElement("script"),_a(i),za(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(r,i))}}function VT(e,t){ko.M(e,t);var n=$d;if(n&&e){var a=rd(n).hoistableScripts,r=Yd(e),i=a.get(r);i||(i=n.querySelector(hp(r)),i||(e=Sn({src:e,async:!0,type:"module"},t),(t=Ai.get(r))&&w2(e,t),i=n.createElement("script"),_a(i),za(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(r,i))}}function BN(e,t,n,a){var r=(r=gl.current)?Wg(r):null;if(!r)throw Error(We(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Md(n.href),n=rd(r).hoistableStyles,a=n.get(t),a||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Md(n.href);var i=rd(r).hoistableStyles,s=i.get(e);if(s||(r=r.ownerDocument||r,s={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},i.set(e,s),(i=r.querySelector(dp(e)))&&!i._p&&(s.instance=i,s.state.loading=5),Ai.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ai.set(e,n),i||KT(r,e,n,s.state))),t&&a===null)throw Error(We(528,""));return s}if(t&&a!==null)throw Error(We(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Yd(n),n=rd(r).hoistableScripts,a=n.get(t),a||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(We(444,e))}}function Md(e){return'href="'+bi(e)+'"'}function dp(e){return'link[rel="stylesheet"]['+e+"]"}function S_(e){return Sn({},e,{"data-precedence":e.precedence,precedence:null})}function KT(e,t,n,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),za(t,"link",n),_a(t),e.head.appendChild(t))}function Yd(e){return'[src="'+bi(e)+'"]'}function hp(e){return"script[async]"+e}function zN(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+bi(n.href)+'"]');if(a)return t.instance=a,_a(a),a;var r=Sn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),_a(a),za(a,"style",r),hg(a,n.precedence,e),t.instance=a;case"stylesheet":r=Md(n.href);var i=e.querySelector(dp(r));if(i)return t.state.loading|=4,t.instance=i,_a(i),i;a=S_(n),(r=Ai.get(r))&&y2(a,r),i=(e.ownerDocument||e).createElement("link"),_a(i);var s=i;return s._p=new Promise(function(o,u){s.onload=o,s.onerror=u}),za(i,"link",a),t.state.loading|=4,hg(i,n.precedence,e),t.instance=i;case"script":return i=Yd(n.src),(r=e.querySelector(hp(i)))?(t.instance=r,_a(r),r):(a=n,(r=Ai.get(i))&&(a=Sn({},n),w2(a,r)),e=e.ownerDocument||e,r=e.createElement("script"),_a(r),za(r,"link",a),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(We(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(a=t.instance,t.state.loading|=4,hg(a,n.precedence,e));return t.instance}function hg(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=a.length?a[a.length-1]:null,i=r,s=0;s<a.length;s++){var o=a[s];if(o.dataset.precedence===t)i=o;else if(i!==r)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function y2(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function w2(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var fg=null;function UN(e,t,n){if(fg===null){var a=new Map,r=fg=new Map;r.set(n,a)}else r=fg,a=r.get(n),a||(a=new Map,r.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var i=n[r];if(!(i[tp]||i[Za]||e==="link"&&i.getAttribute("rel")==="stylesheet")&&i.namespaceURI!=="http://www.w3.org/2000/svg"){var s=i.getAttribute(t)||"";s=e+s;var o=a.get(s);o?o.push(i):a.set(s,[i])}}return a}function qN(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function $T(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function __(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Lf=null;function YT(){}function XT(e,t,n){if(Lf===null)throw Error(We(475));var a=Lf;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var r=Md(n.href),i=e.querySelector(dp(r));if(i){e=i._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(a.count++,a=Gg.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=i,_a(i);return}i=e.ownerDocument||e,n=S_(n),(r=Ai.get(r))&&y2(n,r),i=i.createElement("link"),_a(i);var s=i;s._p=new Promise(function(o,u){s.onload=o,s.onerror=u}),za(i,"link",n),t.instance=i}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(a.count++,t=Gg.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}function JT(){if(Lf===null)throw Error(We(475));var e=Lf;return e.stylesheets&&e.count===0&&F1(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&F1(e,e.stylesheets),e.unsuspend){var a=e.unsuspend;e.unsuspend=null,a()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function Gg(){if(this.count--,this.count===0){if(this.stylesheets)F1(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Vg=null;function F1(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Vg=new Map,t.forEach(QT,e),Vg=null,Gg.call(e))}function QT(e,t){if(!(t.state.loading&4)){var n=Vg.get(e);if(n)var a=n.get(null);else{n=new Map,Vg.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<r.length;i++){var s=r[i];(s.nodeName==="LINK"||s.getAttribute("media")!=="not all")&&(n.set(s.dataset.precedence,s),a=s)}a&&n.set(null,a)}r=t.instance,s=r.getAttribute("data-precedence"),i=n.get(s)||a,i===a&&n.set(null,r),n.set(s,r),this.count++,a=Gg.bind(this),r.addEventListener("load",a),r.addEventListener("error",a),i?i.parentNode.insertBefore(r,i.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var Pf={$$typeof:uo,Provider:null,Consumer:null,_currentValue:mu,_currentValue2:mu,_threadCount:0};function ZT(e,t,n,a,r,i,s,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Sx(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sx(0),this.hiddenUpdates=Sx(null),this.identifierPrefix=a,this.onUncaughtError=r,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function j_(e,t,n,a,r,i,s,o,u,c,d,h){return e=new ZT(e,t,n,s,o,u,c,h),t=1,i===!0&&(t|=24),i=Wr(3,null,null,t),e.current=i,i.stateNode=e,t=Yy(),t.refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:a,isDehydrated:n,cache:t},Jy(i),e}function C_(e){return e?(e=ed,e):ed}function A_(e,t,n,a,r,i){r=C_(r),a.context===null?a.context=r:a.pendingContext=r,a=vl(t),a.payload={element:n},i=i===void 0?null:i,i!==null&&(a.callback=i),n=xl(e,a,t),n!==null&&(Zr(n,e,t),sf(n,e,t))}function HN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function N2(e,t){HN(e,t),(e=e.alternate)&&HN(e,t)}function E_(e){if(e.tag===13){var t=Vd(e,67108864);t!==null&&Zr(t,e,67108864),N2(e,67108864)}}var Kg=!0;function eR(e,t,n,a){var r=kt.T;kt.T=null;var i=Zt.p;try{Zt.p=2,k2(e,t,n,a)}finally{Zt.p=i,kt.T=r}}function tR(e,t,n,a){var r=kt.T;kt.T=null;var i=Zt.p;try{Zt.p=8,k2(e,t,n,a)}finally{Zt.p=i,kt.T=r}}function k2(e,t,n,a){if(Kg){var r=B1(a);if(r===null)tb(e,t,a,$g,n),WN(e,a);else if(aR(r,e,t,n,a))a.stopPropagation();else if(WN(e,a),t&4&&-1<nR.indexOf(e)){for(;r!==null;){var i=Gd(r);if(i!==null)switch(i.tag){case 3:if(i=i.stateNode,i.current.memoizedState.isDehydrated){var s=ru(i.pendingLanes);if(s!==0){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var u=1<<31-Jr(s);o.entanglements[1]|=u,s&=~u}Os(i),!(on&6)&&(Fg=Cs()+500,cp(0))}}break;case 13:o=Vd(i,2),o!==null&&Zr(o,i,2),G0(),N2(i,2)}if(i=B1(a),i===null&&tb(e,t,a,$g,n),i===r)break;r=i}r!==null&&a.stopPropagation()}else tb(e,t,a,null,n)}}function B1(e){return e=By(e),S2(e)}var $g=null;function S2(e){if($g=null,e=$c(e),e!==null){var t=Jf(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=ek(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return $g=e,null}function D_(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(UE()){case rk:return 2;case ik:return 8;case Ng:case qE:return 32;case sk:return 268435456;default:return 32}default:return 32}}var z1=!1,wl=null,Nl=null,kl=null,Mf=new Map,If=new Map,al=[],nR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function WN(e,t){switch(e){case"focusin":case"focusout":wl=null;break;case"dragenter":case"dragleave":Nl=null;break;case"mouseover":case"mouseout":kl=null;break;case"pointerover":case"pointerout":Mf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":If.delete(t.pointerId)}}function Uh(e,t,n,a,r,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:i,targetContainers:[r]},t!==null&&(t=Gd(t),t!==null&&E_(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function aR(e,t,n,a,r){switch(t){case"focusin":return wl=Uh(wl,e,t,n,a,r),!0;case"dragenter":return Nl=Uh(Nl,e,t,n,a,r),!0;case"mouseover":return kl=Uh(kl,e,t,n,a,r),!0;case"pointerover":var i=r.pointerId;return Mf.set(i,Uh(Mf.get(i)||null,e,t,n,a,r)),!0;case"gotpointercapture":return i=r.pointerId,If.set(i,Uh(If.get(i)||null,e,t,n,a,r)),!0}return!1}function T_(e){var t=$c(e.target);if(t!==null){var n=Jf(t);if(n!==null){if(t=n.tag,t===13){if(t=ek(n),t!==null){e.blockedOn=t,XE(e.priority,function(){if(n.tag===13){var a=Qr();a=My(a);var r=Vd(n,a);r!==null&&Zr(r,n,a),N2(n,a)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function pg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=B1(e.nativeEvent);if(n===null){n=e.nativeEvent;var a=new n.constructor(n.type,n);a1=a,n.target.dispatchEvent(a),a1=null}else return t=Gd(n),t!==null&&E_(t),e.blockedOn=n,!1;t.shift()}return!0}function GN(e,t,n){pg(e)&&n.delete(t)}function rR(){z1=!1,wl!==null&&pg(wl)&&(wl=null),Nl!==null&&pg(Nl)&&(Nl=null),kl!==null&&pg(kl)&&(kl=null),Mf.forEach(GN),If.forEach(GN)}function Dm(e,t){e.blockedOn===t&&(e.blockedOn=null,z1||(z1=!0,ga.unstable_scheduleCallback(ga.unstable_NormalPriority,rR)))}var Tm=null;function VN(e){Tm!==e&&(Tm=e,ga.unstable_scheduleCallback(ga.unstable_NormalPriority,function(){Tm===e&&(Tm=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],r=e[t+2];if(typeof a!="function"){if(S2(a||n)===null)continue;break}var i=Gd(n);i!==null&&(e.splice(t,3),t-=3,b1(i,{pending:!0,data:r,method:n.method,action:a},a,r))}}))}function Of(e){function t(u){return Dm(u,e)}wl!==null&&Dm(wl,e),Nl!==null&&Dm(Nl,e),kl!==null&&Dm(kl,e),Mf.forEach(t),If.forEach(t);for(var n=0;n<al.length;n++){var a=al[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<al.length&&(n=al[0],n.blockedOn===null);)T_(n),n.blockedOn===null&&al.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(a=0;a<n.length;a+=3){var r=n[a],i=n[a+1],s=r[Ar]||null;if(typeof i=="function")s||VN(n);else if(s){var o=null;if(i&&i.hasAttribute("formAction")){if(r=i,s=i[Ar]||null)o=s.formAction;else if(S2(r)!==null)continue}else o=s.action;typeof o=="function"?n[a+1]=o:(n.splice(a,3),a-=3),VN(n)}}}function _2(e){this._internalRoot=e}Y0.prototype.render=_2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(We(409));var n=t.current,a=Qr();A_(n,a,e,t,null,null)};Y0.prototype.unmount=_2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;A_(e.current,2,null,e,null,null),G0(),t[Wd]=null}};function Y0(e){this._internalRoot=e}Y0.prototype.unstable_scheduleHydration=function(e){if(e){var t=dk();e={blockedOn:null,target:e,priority:t};for(var n=0;n<al.length&&t!==0&&t<al[n].priority;n++);al.splice(n,0,e),n===0&&T_(e)}};var KN=Q4.version;if(KN!=="19.1.0")throw Error(We(527,KN,"19.1.0"));Zt.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(We(188)):(e=Object.keys(e).join(","),Error(We(268,e)));return e=PE(t),e=e!==null?tk(e):null,e=e===null?null:e.stateNode,e};var iR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:kt,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rm.isDisabled&&Rm.supportsFiber)try{Qf=Rm.inject(iR),Xr=Rm}catch{}}P0.createRoot=function(e,t){if(!Z4(e))throw Error(We(299));var n=!1,a="",r=jS,i=CS,s=AS,o=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(i=t.onCaughtError),t.onRecoverableError!==void 0&&(s=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(o=t.unstable_transitionCallbacks)),t=j_(e,1,!1,null,null,n,a,r,i,s,o,null),e[Wd]=t.current,b2(e),new _2(t)};P0.hydrateRoot=function(e,t,n){if(!Z4(e))throw Error(We(299));var a=!1,r="",i=jS,s=CS,o=AS,u=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(i=n.onUncaughtError),n.onCaughtError!==void 0&&(s=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(u=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=j_(e,1,!0,t,n??null,a,r,i,s,o,u,c),t.context=C_(null),n=t.current,a=Qr(),a=My(a),r=vl(a),r.callback=null,xl(n,r,a),n=a,t.current.lanes=n,ep(t,n),Os(t),e[Wd]=t.current,b2(e),new Y0(t)};P0.version="19.1.0";function R_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(R_)}catch(e){console.error(e)}}R_(),Y4.exports=P0;var sR=Y4.exports;const so="https://okltvbilvewzwyhjcfrp.supabase.co",U1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9rbHR2YmlsdmV3end5aGpjZnJwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEwOTUwMTIsImV4cCI6MjA2NjY3MTAxMn0.6OTF3BU5qiHyQ8m7dWfnBkLOvt7BAJoFffREQl6oM_Q",Xd=!so.startsWith("http")||so.includes("placeholder")||so.length<10,Jd=U1.includes("placeholder")||U1.length<10;let Te;if(Xd||Jd){console.warn(`⚠️ Supabase not configured - using development mode.
To connect to Supabase:
1. Click "Connect to Supabase" button in the top right
2. Or manually update your .env file with actual Supabase credentials
Current URL: ${so}
Current Key: [REDACTED]`);const e=(n="Supabase not configured")=>({data:null,error:{message:n,code:"SUPABASE_NOT_CONFIGURED"}}),t=(n=null)=>({data:n,error:null});Te={auth:{signUp:()=>Promise.resolve(e("Please configure Supabase to sign up")),signInWithPassword:()=>Promise.resolve(e("Please configure Supabase to sign in")),signOut:()=>Promise.resolve({error:null}),getSession:()=>Promise.resolve(t({session:null})),getUser:()=>Promise.resolve(t({user:null})),onAuthStateChange:n=>(n&&setTimeout(()=>n("SIGNED_OUT",null),0),{data:{subscription:{unsubscribe:()=>{}}}}),updateUser:()=>Promise.resolve(e("Please configure Supabase to update user")),resetPasswordForEmail:()=>Promise.resolve(e("Please configure Supabase for password reset"))},from:n=>({select:(a="*")=>({eq:(r,i)=>({single:()=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),maybeSingle:()=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),limit:s=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),order:(s,o)=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),neq:(r,i)=>({limit:s=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),order:(s,o)=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),order:(r,i)=>({limit:s=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),limit:r=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),range:(r,i)=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),insert:a=>({select:()=>Promise.resolve(e(`Please configure Supabase to insert into ${n}`))}),update:a=>({eq:(r,i)=>({select:()=>Promise.resolve(e(`Please configure Supabase to update ${n}`))})}),delete:()=>({eq:(a,r)=>Promise.resolve(e(`Please configure Supabase to delete from ${n}`))}),upsert:a=>({select:()=>Promise.resolve(e(`Please configure Supabase to upsert into ${n}`))})}),storage:{from:n=>({upload:(a,r,i)=>Promise.resolve(e("Please configure Supabase for file upload")),getPublicUrl:a=>({data:{publicUrl:""}}),remove:a=>Promise.resolve(e("Please configure Supabase for file removal"))})},rpc:(n,a)=>Promise.resolve(e(`Please configure Supabase to call function ${n}`))}}else try{Te=yE(so,U1,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"attendance-app"}}}),(async()=>{try{const{data:{session:t},error:n}=await Te.auth.getSession();if(n){console.warn("Session error detected, clearing session:",n.message),await Te.auth.signOut(),localStorage.removeItem(`sb-${so.split("//")[1].split(".")[0]}-auth-token`);return}if(t){const{error:a}=await Te.auth.getUser();a&&(a.message.includes("user_not_found")||a.message.includes("JWT"))&&(console.warn("Invalid user session detected, clearing session:",a.message),await Te.auth.signOut(),localStorage.removeItem(`sb-${so.split("//")[1].split(".")[0]}-auth-token`))}}catch(t){console.warn("Error during session validation, clearing session:",t.message);try{await Te.auth.signOut(),localStorage.removeItem(`sb-${so.split("//")[1].split(".")[0]}-auth-token`)}catch(n){console.warn("Error during sign out:",n.message)}}})(),console.log("✅ Supabase client initialized successfully")}catch(e){console.error("❌ Failed to initialize Supabase client:",e),Te={auth:{signUp:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),signInWithPassword:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),signOut:()=>Promise.resolve({error:null}),getSession:()=>Promise.resolve({data:{session:null},error:null}),getUser:()=>Promise.resolve({data:{user:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},from:()=>({select:()=>({eq:()=>({single:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),maybeSingle:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),limit:()=>Promise.resolve({data:[],error:{message:"Supabase initialization failed"}})}),order:()=>Promise.resolve({data:[],error:{message:"Supabase initialization failed"}}),limit:()=>Promise.resolve({data:[],error:{message:"Supabase initialization failed"}})}),insert:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),update:()=>({eq:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}})}),delete:()=>({eq:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}})}),upsert:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}})}),storage:{from:()=>({upload:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),getPublicUrl:()=>({data:{publicUrl:""}})})}}}const Id=async e=>{var t,n,a,r;if(e&&((t=e.message)!=null&&t.includes("user_not_found")||(n=e.message)!=null&&n.includes("JWT")||(a=e.message)!=null&&a.includes("Invalid token")||e.code==="user_not_found")){console.warn("Auth error detected, clearing session:",e.message);try{await Te.auth.signOut();const i=(r=so.split("//")[1])==null?void 0:r.split(".");i&&i[0]&&localStorage.removeItem(`sb-${i[0]}-auth-token`),window.location.href="/login"}catch(i){console.warn("Error during sign out:",i.message),window.location.href="/login"}}},L_=async()=>{try{if(Xd||Jd)return{latitude:-6.2,longitude:106.816666,radius:100,address:"Jakarta Office (Demo)"};const{data:e,error:t}=await Te.from("system_settings").select("setting_value").eq("setting_key","office_location").eq("is_enabled",!0).maybeSingle();if(t&&t.code!=="PGRST116")throw await Id(t),t;return(e==null?void 0:e.setting_value)||{latitude:-6.2,longitude:106.816666,radius:100,address:"Jakarta Office"}}catch(e){return console.error("Error fetching office location:",e),await Id(e),{latitude:-6.2,longitude:106.816666,radius:100,address:"Jakarta Office"}}};let Cc=null,ab=0;const oR=async(e=!1)=>{const n=Date.now();if(!e&&Cc&&n-ab<12e4)return Cc;try{if(Xd||Jd)return Cc={enabled:!0,required_for_admin:!1},ab=n,Cc;const{data:a,error:r}=await Te.from("system_settings").select("setting_value").eq("setting_key","camera_verification").eq("is_enabled",!0).maybeSingle();if(r&&r.code!=="PGRST116")throw await Id(r),r;return Cc=(a==null?void 0:a.setting_value)||{enabled:!0,required_for_admin:!1},ab=n,Cc}catch(a){return console.error("Error fetching camera verification settings:",a),await Id(a),{enabled:!0,required_for_admin:!1}}},Yg=async(e,t,n)=>{try{if(Xd||Jd)throw new Error("Supabase not configured - please connect to Supabase first");console.log("Uploading file:",n,"to bucket:",t);try{await Te.storage.from(t).remove([n])}catch(i){console.log("File delete attempt (ignore if not exists):",i.message)}const{data:a,error:r}=await Te.storage.from(t).upload(n,e,{cacheControl:"3600",upsert:!0});if(r)throw console.error("Upload error details:",r),await Id(r),new Error(`Upload failed: ${r.message}`);return console.log("Upload successful:",a),a}catch(a){throw console.error("Upload error:",a),await Id(a),a}},Xg=(e,t)=>{if(Xd||Jd)return"";const{data:n}=Te.storage.from(e).getPublicUrl(t);return n.publicUrl},ul=()=>!Xd&&!Jd;/*!
* sweetalert2 v11.22.2
* Released under the MIT License.
*/function P_(e,t,n){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function lR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $N(e,t){return e.get(P_(e,t))}function uR(e,t,n){lR(e,t),t.set(e,n)}function cR(e,t,n){return e.set(P_(e,t),n),n}const dR=100,bt={},hR=()=>{bt.previousActiveElement instanceof HTMLElement?(bt.previousActiveElement.focus(),bt.previousActiveElement=null):document.body&&document.body.focus()},fR=e=>new Promise(t=>{if(!e)return t();const n=window.scrollX,a=window.scrollY;bt.restoreFocusTimeout=setTimeout(()=>{hR(),t()},dR),window.scrollTo(n,a)}),M_="swal2-",pR=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],Me=pR.reduce((e,t)=>(e[t]=M_+t,e),{}),mR=["success","warning","info","question","error"],Jg=mR.reduce((e,t)=>(e[t]=M_+t,e),{}),I_="SweetAlert2:",j2=e=>e.charAt(0).toUpperCase()+e.slice(1),dr=e=>{console.warn(`${I_} ${typeof e=="object"?e.join(" "):e}`)},qu=e=>{console.error(`${I_} ${e}`)},YN=[],gR=e=>{YN.includes(e)||(YN.push(e),dr(e))},O_=(e,t=null)=>{gR(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},X0=e=>typeof e=="function"?e():e,C2=e=>e&&typeof e.toPromise=="function",fp=e=>C2(e)?e.toPromise():Promise.resolve(e),A2=e=>e&&Promise.resolve(e)===e,fr=()=>document.body.querySelector(`.${Me.container}`),pp=e=>{const t=fr();return t?t.querySelector(e):null},ai=e=>pp(`.${e}`),$t=()=>ai(Me.popup),Qd=()=>ai(Me.icon),vR=()=>ai(Me["icon-content"]),F_=()=>ai(Me.title),E2=()=>ai(Me["html-container"]),B_=()=>ai(Me.image),D2=()=>ai(Me["progress-steps"]),J0=()=>ai(Me["validation-message"]),Ls=()=>pp(`.${Me.actions} .${Me.confirm}`),Zd=()=>pp(`.${Me.actions} .${Me.cancel}`),Hu=()=>pp(`.${Me.actions} .${Me.deny}`),xR=()=>ai(Me["input-label"]),eh=()=>pp(`.${Me.loader}`),mp=()=>ai(Me.actions),z_=()=>ai(Me.footer),Q0=()=>ai(Me["timer-progress-bar"]),T2=()=>ai(Me.close),bR=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,R2=()=>{const e=$t();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(t).sort((i,s)=>{const o=parseInt(i.getAttribute("tabindex")||"0"),u=parseInt(s.getAttribute("tabindex")||"0");return o>u?1:o<u?-1:0}),a=e.querySelectorAll(bR),r=Array.from(a).filter(i=>i.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(r))].filter(i=>jr(i))},L2=()=>vo(document.body,Me.shown)&&!vo(document.body,Me["toast-shown"])&&!vo(document.body,Me["no-backdrop"]),Z0=()=>{const e=$t();return e?vo(e,Me.toast):!1},yR=()=>{const e=$t();return e?e.hasAttribute("data-loading"):!1},ri=(e,t)=>{if(e.textContent="",t){const a=new DOMParser().parseFromString(t,"text/html"),r=a.querySelector("head");r&&Array.from(r.childNodes).forEach(s=>{e.appendChild(s)});const i=a.querySelector("body");i&&Array.from(i.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?e.appendChild(s.cloneNode(!0)):e.appendChild(s)})}},vo=(e,t)=>{if(!t)return!1;const n=t.split(/\s+/);for(let a=0;a<n.length;a++)if(!e.classList.contains(n[a]))return!1;return!0},wR=(e,t)=>{Array.from(e.classList).forEach(n=>{!Object.values(Me).includes(n)&&!Object.values(Jg).includes(n)&&!Object.values(t.showClass||{}).includes(n)&&e.classList.remove(n)})},ni=(e,t,n)=>{if(wR(e,t),!t.customClass)return;const a=t.customClass[n];if(a){if(typeof a!="string"&&!a.forEach){dr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof a}"`);return}Jt(e,a)}},ev=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${Me.popup} > .${Me[t]}`);case"checkbox":return e.querySelector(`.${Me.popup} > .${Me.checkbox} input`);case"radio":return e.querySelector(`.${Me.popup} > .${Me.radio} input:checked`)||e.querySelector(`.${Me.popup} > .${Me.radio} input:first-child`);case"range":return e.querySelector(`.${Me.popup} > .${Me.range} input`);default:return e.querySelector(`.${Me.popup} > .${Me.input}`)}},U_=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},q_=(e,t,n)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(a=>{Array.isArray(e)?e.forEach(r=>{n?r.classList.add(a):r.classList.remove(a)}):n?e.classList.add(a):e.classList.remove(a)}))},Jt=(e,t)=>{q_(e,t,!0)},Ei=(e,t)=>{q_(e,t,!1)},cl=(e,t)=>{const n=Array.from(e.children);for(let a=0;a<n.length;a++){const r=n[a];if(r instanceof HTMLElement&&vo(r,t))return r}},Nu=(e,t,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?e.style.setProperty(t,typeof n=="number"?`${n}px`:n):e.style.removeProperty(t)},Ea=(e,t="flex")=>{e&&(e.style.display=t)},rr=e=>{e&&(e.style.display="none")},P2=(e,t="block")=>{e&&new MutationObserver(()=>{gp(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},XN=(e,t,n,a)=>{const r=e.querySelector(t);r&&r.style.setProperty(n,a)},gp=(e,t,n="flex")=>{t?Ea(e,n):rr(e)},jr=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),NR=()=>!jr(Ls())&&!jr(Hu())&&!jr(Zd()),q1=e=>e.scrollHeight>e.clientHeight,kR=(e,t)=>{let n=e;for(;n&&n!==t;){if(q1(n))return!0;n=n.parentElement}return!1},H_=e=>{const t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("animation-duration")||"0"),a=parseFloat(t.getPropertyValue("transition-duration")||"0");return n>0||a>0},M2=(e,t=!1)=>{const n=Q0();n&&jr(n)&&(t&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${e/1e3}s linear`,n.style.width="0%"},10))},SR=()=>{const e=Q0();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const n=parseInt(window.getComputedStyle(e).width),a=t/n*100;e.style.width=`${a}%`},_R=()=>typeof window>"u"||typeof document>"u",jR=`
 <div aria-labelledby="${Me.title}" aria-describedby="${Me["html-container"]}" class="${Me.popup}" tabindex="-1">
   <button type="button" class="${Me.close}"></button>
   <ul class="${Me["progress-steps"]}"></ul>
   <div class="${Me.icon}"></div>
   <img class="${Me.image}" />
   <h2 class="${Me.title}" id="${Me.title}"></h2>
   <div class="${Me["html-container"]}" id="${Me["html-container"]}"></div>
   <input class="${Me.input}" id="${Me.input}" />
   <input type="file" class="${Me.file}" />
   <div class="${Me.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Me.select}" id="${Me.select}"></select>
   <div class="${Me.radio}"></div>
   <label class="${Me.checkbox}">
     <input type="checkbox" id="${Me.checkbox}" />
     <span class="${Me.label}"></span>
   </label>
   <textarea class="${Me.textarea}" id="${Me.textarea}"></textarea>
   <div class="${Me["validation-message"]}" id="${Me["validation-message"]}"></div>
   <div class="${Me.actions}">
     <div class="${Me.loader}"></div>
     <button type="button" class="${Me.confirm}"></button>
     <button type="button" class="${Me.deny}"></button>
     <button type="button" class="${Me.cancel}"></button>
   </div>
   <div class="${Me.footer}"></div>
   <div class="${Me["timer-progress-bar-container"]}">
     <div class="${Me["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),CR=()=>{const e=fr();return e?(e.remove(),Ei([document.documentElement,document.body],[Me["no-backdrop"],Me["toast-shown"],Me["has-column"]]),!0):!1},nu=()=>{bt.currentInstance.resetValidationMessage()},AR=()=>{const e=$t(),t=cl(e,Me.input),n=cl(e,Me.file),a=e.querySelector(`.${Me.range} input`),r=e.querySelector(`.${Me.range} output`),i=cl(e,Me.select),s=e.querySelector(`.${Me.checkbox} input`),o=cl(e,Me.textarea);t.oninput=nu,n.onchange=nu,i.onchange=nu,s.onchange=nu,o.oninput=nu,a.oninput=()=>{nu(),r.value=a.value},a.onchange=()=>{nu(),r.value=a.value}},ER=e=>typeof e=="string"?document.querySelector(e):e,DR=e=>{const t=$t();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},TR=e=>{window.getComputedStyle(e).direction==="rtl"&&Jt(fr(),Me.rtl)},RR=e=>{const t=CR();if(_R()){qu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=Me.container,t&&Jt(n,Me["no-transition"]),ri(n,jR),n.dataset.swal2Theme=e.theme;const a=ER(e.target);a.appendChild(n),e.topLayer&&(n.setAttribute("popover",""),n.showPopover()),DR(e),TR(a),AR()},I2=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?LR(e,t):e&&ri(t,e)},LR=(e,t)=>{e.jquery?PR(t,e):ri(t,e.toString())},PR=(e,t)=>{if(e.textContent="",0 in t)for(let n=0;n in t;n++)e.appendChild(t[n].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},MR=(e,t)=>{const n=mp(),a=eh();!n||!a||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?rr(n):Ea(n),ni(n,t,"actions"),IR(n,a,t),ri(a,t.loaderHtml||""),ni(a,t,"loader"))};function IR(e,t,n){const a=Ls(),r=Hu(),i=Zd();!a||!r||!i||(ib(a,"confirm",n),ib(r,"deny",n),ib(i,"cancel",n),OR(a,r,i,n),n.reverseButtons&&(n.toast?(e.insertBefore(i,a),e.insertBefore(r,a)):(e.insertBefore(i,t),e.insertBefore(r,t),e.insertBefore(a,t))))}function OR(e,t,n,a){if(!a.buttonsStyling){Ei([e,t,n],Me.styled);return}Jt([e,t,n],Me.styled),a.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",a.confirmButtonColor),a.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",a.denyButtonColor),a.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",a.cancelButtonColor),rb(e),rb(t),rb(n)}function rb(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const n=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function ib(e,t,n){const a=j2(t);gp(e,n[`show${a}Button`],"inline-block"),ri(e,n[`${t}ButtonText`]||""),e.setAttribute("aria-label",n[`${t}ButtonAriaLabel`]||""),e.className=Me[t],ni(e,n,`${t}Button`)}const FR=(e,t)=>{const n=T2();n&&(ri(n,t.closeButtonHtml||""),ni(n,t,"closeButton"),gp(n,t.showCloseButton),n.setAttribute("aria-label",t.closeButtonAriaLabel||""))},BR=(e,t)=>{const n=fr();n&&(zR(n,t.backdrop),UR(n,t.position),qR(n,t.grow),ni(n,t,"container"))};function zR(e,t){typeof t=="string"?e.style.background=t:t||Jt([document.documentElement,document.body],Me["no-backdrop"])}function UR(e,t){t&&(t in Me?Jt(e,Me[t]):(dr('The "position" parameter is not valid, defaulting to "center"'),Jt(e,Me.center)))}function qR(e,t){t&&Jt(e,Me[`grow-${t}`])}var yn={innerParams:new WeakMap,domCache:new WeakMap};const HR=["input","file","range","select","radio","checkbox","textarea"],WR=(e,t)=>{const n=$t();if(!n)return;const a=yn.innerParams.get(e),r=!a||t.input!==a.input;HR.forEach(i=>{const s=cl(n,Me[i]);s&&(KR(i,t.inputAttributes),s.className=Me[i],r&&rr(s))}),t.input&&(r&&GR(t),$R(t))},GR=e=>{if(!e.input)return;if(!Kn[e.input]){qu(`Unexpected type of input! Expected ${Object.keys(Kn).join(" | ")}, got "${e.input}"`);return}const t=W_(e.input);if(!t)return;const n=Kn[e.input](t,e);Ea(t),e.inputAutoFocus&&setTimeout(()=>{U_(n)})},VR=e=>{for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;["id","type","value","style"].includes(n)||e.removeAttribute(n)}},KR=(e,t)=>{const n=$t();if(!n)return;const a=ev(n,e);if(a){VR(a);for(const r in t)a.setAttribute(r,t[r])}},$R=e=>{if(!e.input)return;const t=W_(e.input);t&&ni(t,e,"input")},O2=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},vp=(e,t,n)=>{if(n.inputLabel){const a=document.createElement("label"),r=Me["input-label"];a.setAttribute("for",e.id),a.className=r,typeof n.customClass=="object"&&Jt(a,n.customClass.inputLabel),a.innerText=n.inputLabel,t.insertAdjacentElement("beforebegin",a)}},W_=e=>{const t=$t();if(t)return cl(t,Me[e]||Me.input)},Qg=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:A2(t)||dr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},Kn={};Kn.text=Kn.email=Kn.password=Kn.number=Kn.tel=Kn.url=Kn.search=Kn.date=Kn["datetime-local"]=Kn.time=Kn.week=Kn.month=(e,t)=>(Qg(e,t.inputValue),vp(e,e,t),O2(e,t),e.type=t.input,e);Kn.file=(e,t)=>(vp(e,e,t),O2(e,t),e);Kn.range=(e,t)=>{const n=e.querySelector("input"),a=e.querySelector("output");return Qg(n,t.inputValue),n.type=t.input,Qg(a,t.inputValue),vp(n,e,t),e};Kn.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const n=document.createElement("option");ri(n,t.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,e.appendChild(n)}return vp(e,e,t),e};Kn.radio=e=>(e.textContent="",e);Kn.checkbox=(e,t)=>{const n=ev($t(),"checkbox");n.value="1",n.checked=!!t.inputValue;const a=e.querySelector("span");return ri(a,t.inputPlaceholder||t.inputLabel),n};Kn.textarea=(e,t)=>{Qg(e,t.inputValue),O2(e,t),vp(e,e,t);const n=a=>parseInt(window.getComputedStyle(a).marginLeft)+parseInt(window.getComputedStyle(a).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const a=parseInt(window.getComputedStyle($t()).width),r=()=>{if(!document.body.contains(e))return;const i=e.offsetWidth+n(e);i>a?$t().style.width=`${i}px`:Nu($t(),"width",t.width)};new MutationObserver(r).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const YR=(e,t)=>{const n=E2();n&&(P2(n),ni(n,t,"htmlContainer"),t.html?(I2(t.html,n),Ea(n,"block")):t.text?(n.textContent=t.text,Ea(n,"block")):rr(n),WR(e,t))},XR=(e,t)=>{const n=z_();n&&(P2(n),gp(n,t.footer,"block"),t.footer&&I2(t.footer,n),ni(n,t,"footer"))},JR=(e,t)=>{const n=yn.innerParams.get(e),a=Qd();if(!a)return;if(n&&t.icon===n.icon){QN(a,t),JN(a,t);return}if(!t.icon&&!t.iconHtml){rr(a);return}if(t.icon&&Object.keys(Jg).indexOf(t.icon)===-1){qu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),rr(a);return}Ea(a),QN(a,t),JN(a,t),Jt(a,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",G_)},JN=(e,t)=>{for(const[n,a]of Object.entries(Jg))t.icon!==n&&Ei(e,a);Jt(e,t.icon&&Jg[t.icon]),eL(e,t),G_(),ni(e,t,"icon")},G_=()=>{const e=$t();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),n=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let a=0;a<n.length;a++)n[a].style.backgroundColor=t},QR=e=>`
  ${e.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${e.animation?'<div class="swal2-success-fix"></div>':""}
  ${e.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,ZR=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,QN=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let n=e.innerHTML,a="";t.iconHtml?a=ZN(t.iconHtml):t.icon==="success"?(a=QR(t),n=n.replace(/ style=".*?"/g,"")):t.icon==="error"?a=ZR:t.icon&&(a=ZN({question:"?",warning:"!",info:"i"}[t.icon])),n.trim()!==a.trim()&&ri(e,a)},eL=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])XN(e,n,"background-color",t.iconColor);XN(e,".swal2-success-ring","border-color",t.iconColor)}},ZN=e=>`<div class="${Me["icon-content"]}">${e}</div>`,tL=(e,t)=>{const n=B_();if(n){if(!t.imageUrl){rr(n);return}Ea(n,""),n.setAttribute("src",t.imageUrl),n.setAttribute("alt",t.imageAlt||""),Nu(n,"width",t.imageWidth),Nu(n,"height",t.imageHeight),n.className=Me.image,ni(n,t,"image")}};let F2=!1,V_=0,K_=0,$_=0,Y_=0;const nL=e=>{e.addEventListener("mousedown",Zg),document.body.addEventListener("mousemove",e0),e.addEventListener("mouseup",t0),e.addEventListener("touchstart",Zg),document.body.addEventListener("touchmove",e0),e.addEventListener("touchend",t0)},aL=e=>{e.removeEventListener("mousedown",Zg),document.body.removeEventListener("mousemove",e0),e.removeEventListener("mouseup",t0),e.removeEventListener("touchstart",Zg),document.body.removeEventListener("touchmove",e0),e.removeEventListener("touchend",t0)},Zg=e=>{const t=$t();if(e.target===t||Qd().contains(e.target)){F2=!0;const n=X_(e);V_=n.clientX,K_=n.clientY,$_=parseInt(t.style.insetInlineStart)||0,Y_=parseInt(t.style.insetBlockStart)||0,Jt(t,"swal2-dragging")}},e0=e=>{const t=$t();if(F2){let{clientX:n,clientY:a}=X_(e);t.style.insetInlineStart=`${$_+(n-V_)}px`,t.style.insetBlockStart=`${Y_+(a-K_)}px`}},t0=()=>{const e=$t();F2=!1,Ei(e,"swal2-dragging")},X_=e=>{let t=0,n=0;return e.type.startsWith("mouse")?(t=e.clientX,n=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,n=e.touches[0].clientY),{clientX:t,clientY:n}},rL=(e,t)=>{const n=fr(),a=$t();if(!(!n||!a)){if(t.toast){Nu(n,"width",t.width),a.style.width="100%";const r=eh();r&&a.insertBefore(r,Qd())}else Nu(a,"width",t.width);Nu(a,"padding",t.padding),t.color&&(a.style.color=t.color),t.background&&(a.style.background=t.background),rr(J0()),iL(a,t),t.draggable&&!t.toast?(Jt(a,Me.draggable),nL(a)):(Ei(a,Me.draggable),aL(a))}},iL=(e,t)=>{const n=t.showClass||{};e.className=`${Me.popup} ${jr(e)?n.popup:""}`,t.toast?(Jt([document.documentElement,document.body],Me["toast-shown"]),Jt(e,Me.toast)):Jt(e,Me.modal),ni(e,t,"popup"),typeof t.customClass=="string"&&Jt(e,t.customClass),t.icon&&Jt(e,Me[`icon-${t.icon}`])},sL=(e,t)=>{const n=D2();if(!n)return;const{progressSteps:a,currentProgressStep:r}=t;if(!a||a.length===0||r===void 0){rr(n);return}Ea(n),n.textContent="",r>=a.length&&dr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),a.forEach((i,s)=>{const o=oL(i);if(n.appendChild(o),s===r&&Jt(o,Me["active-progress-step"]),s!==a.length-1){const u=lL(t);n.appendChild(u)}})},oL=e=>{const t=document.createElement("li");return Jt(t,Me["progress-step"]),ri(t,e),t},lL=e=>{const t=document.createElement("li");return Jt(t,Me["progress-step-line"]),e.progressStepsDistance&&Nu(t,"width",e.progressStepsDistance),t},uL=(e,t)=>{const n=F_();n&&(P2(n),gp(n,t.title||t.titleText,"block"),t.title&&I2(t.title,n),t.titleText&&(n.innerText=t.titleText),ni(n,t,"title"))},J_=(e,t)=>{rL(e,t),BR(e,t),sL(e,t),JR(e,t),tL(e,t),uL(e,t),FR(e,t),YR(e,t),MR(e,t),XR(e,t);const n=$t();typeof t.didRender=="function"&&n&&t.didRender(n),bt.eventEmitter.emit("didRender",n)},cL=()=>jr($t()),Q_=()=>{var e;return(e=Ls())===null||e===void 0?void 0:e.click()},dL=()=>{var e;return(e=Hu())===null||e===void 0?void 0:e.click()},hL=()=>{var e;return(e=Zd())===null||e===void 0?void 0:e.click()},th=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Z_=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},fL=(e,t,n)=>{Z_(e),t.toast||(e.keydownHandler=a=>mL(t,a,n),e.keydownTarget=t.keydownListenerCapture?window:$t(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},H1=(e,t)=>{var n;const a=R2();if(a.length){e=e+t,e===-2&&(e=a.length-1),e===a.length?e=0:e===-1&&(e=a.length-1),a[e].focus();return}(n=$t())===null||n===void 0||n.focus()},ej=["ArrowRight","ArrowDown"],pL=["ArrowLeft","ArrowUp"],mL=(e,t,n)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?gL(t,e):t.key==="Tab"?vL(t):[...ej,...pL].includes(t.key)?xL(t.key):t.key==="Escape"&&bL(t,e,n)))},gL=(e,t)=>{if(!X0(t.allowEnterKey))return;const n=ev($t(),t.input);if(e.target&&n&&e.target instanceof HTMLElement&&e.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(t.input))return;Q_(),e.preventDefault()}},vL=e=>{const t=e.target,n=R2();let a=-1;for(let r=0;r<n.length;r++)if(t===n[r]){a=r;break}e.shiftKey?H1(a,-1):H1(a,1),e.stopPropagation(),e.preventDefault()},xL=e=>{const t=mp(),n=Ls(),a=Hu(),r=Zd();if(!t||!n||!a||!r)return;const i=[n,a,r];if(document.activeElement instanceof HTMLElement&&!i.includes(document.activeElement))return;const s=ej.includes(e)?"nextElementSibling":"previousElementSibling";let o=document.activeElement;if(o){for(let u=0;u<t.children.length;u++){if(o=o[s],!o)return;if(o instanceof HTMLButtonElement&&jr(o))break}o instanceof HTMLButtonElement&&o.focus()}},bL=(e,t,n)=>{e.preventDefault(),X0(t.allowEscapeKey)&&n(th.esc)};var Od={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const yL=()=>{const e=fr();Array.from(document.body.children).forEach(n=>{n.contains(e)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},tj=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},nj=typeof window<"u"&&!!window.GestureEvent,wL=()=>{if(nj&&!vo(document.body,Me.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,Jt(document.body,Me.iosfix),NL()}},NL=()=>{const e=fr();if(!e)return;let t;e.ontouchstart=n=>{t=kL(n)},e.ontouchmove=n=>{t&&(n.preventDefault(),n.stopPropagation())}},kL=e=>{const t=e.target,n=fr(),a=E2();return!n||!a||SL(e)||_L(e)?!1:t===n||!q1(n)&&t instanceof HTMLElement&&!kR(t,a)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(q1(a)&&a.contains(t))},SL=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",_L=e=>e.touches&&e.touches.length>1,jL=()=>{if(vo(document.body,Me.iosfix)){const e=parseInt(document.body.style.top,10);Ei(document.body,Me.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},CL=()=>{const e=document.createElement("div");e.className=Me["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let hd=null;const AL=e=>{hd===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(hd=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${hd+CL()}px`)},EL=()=>{hd!==null&&(document.body.style.paddingRight=`${hd}px`,hd=null)};function aj(e,t,n,a){Z0()?e3(e,a):(fR(n).then(()=>e3(e,a)),Z_(bt)),nj?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),L2()&&(EL(),jL(),tj()),DL()}function DL(){Ei([document.documentElement,document.body],[Me.shown,Me["height-auto"],Me["no-backdrop"],Me["toast-shown"]])}function dl(e){e=RL(e);const t=Od.swalPromiseResolve.get(this),n=TL(this);this.isAwaitingPromise?e.isDismissed||(xp(this),t(e)):n&&t(e)}const TL=e=>{const t=$t();if(!t)return!1;const n=yn.innerParams.get(e);if(!n||vo(t,n.hideClass.popup))return!1;Ei(t,n.showClass.popup),Jt(t,n.hideClass.popup);const a=fr();return Ei(a,n.showClass.backdrop),Jt(a,n.hideClass.backdrop),LL(e,t,n),!0};function rj(e){const t=Od.swalPromiseReject.get(this);xp(this),t&&t(e)}const xp=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,yn.innerParams.get(e)||e._destroy())},RL=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),LL=(e,t,n)=>{var a;const r=fr(),i=H_(t);typeof n.willClose=="function"&&n.willClose(t),(a=bt.eventEmitter)===null||a===void 0||a.emit("willClose",t),i?PL(e,t,r,n.returnFocus,n.didClose):aj(e,r,n.returnFocus,n.didClose)},PL=(e,t,n,a,r)=>{bt.swalCloseEventFinishedCallback=aj.bind(null,e,n,a,r);const i=function(s){if(s.target===t){var o;(o=bt.swalCloseEventFinishedCallback)===null||o===void 0||o.call(bt),delete bt.swalCloseEventFinishedCallback,t.removeEventListener("animationend",i),t.removeEventListener("transitionend",i)}};t.addEventListener("animationend",i),t.addEventListener("transitionend",i)},e3=(e,t)=>{setTimeout(()=>{var n;typeof t=="function"&&t.bind(e.params)(),(n=bt.eventEmitter)===null||n===void 0||n.emit("didClose"),e._destroy&&e._destroy()})},Fd=e=>{let t=$t();if(t||new ct,t=$t(),!t)return;const n=eh();Z0()?rr(Qd()):ML(t,e),Ea(n),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},ML=(e,t)=>{const n=mp(),a=eh();!n||!a||(!t&&jr(Ls())&&(t=Ls()),Ea(n),t&&(rr(t),a.setAttribute("data-button-to-replace",t.className),n.insertBefore(a,t)),Jt([e,n],Me.loading))},IL=(e,t)=>{t.input==="select"||t.input==="radio"?UL(e,t):["text","email","number","tel","textarea"].some(n=>n===t.input)&&(C2(t.inputValue)||A2(t.inputValue))&&(Fd(Ls()),qL(e,t))},OL=(e,t)=>{const n=e.getInput();if(!n)return null;switch(t.input){case"checkbox":return FL(n);case"radio":return BL(n);case"file":return zL(n);default:return t.inputAutoTrim?n.value.trim():n.value}},FL=e=>e.checked?1:0,BL=e=>e.checked?e.value:null,zL=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,UL=(e,t)=>{const n=$t();if(!n)return;const a=r=>{t.input==="select"?HL(n,n0(r),t):t.input==="radio"&&WL(n,n0(r),t)};C2(t.inputOptions)||A2(t.inputOptions)?(Fd(Ls()),fp(t.inputOptions).then(r=>{e.hideLoading(),a(r)})):typeof t.inputOptions=="object"?a(t.inputOptions):qu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},qL=(e,t)=>{const n=e.getInput();n&&(rr(n),fp(t.inputValue).then(a=>{n.value=t.input==="number"?`${parseFloat(a)||0}`:`${a}`,Ea(n),n.focus(),e.hideLoading()}).catch(a=>{qu(`Error in inputValue promise: ${a}`),n.value="",Ea(n),n.focus(),e.hideLoading()}))};function HL(e,t,n){const a=cl(e,Me.select);if(!a)return;const r=(i,s,o)=>{const u=document.createElement("option");u.value=o,ri(u,s),u.selected=ij(o,n.inputValue),i.appendChild(u)};t.forEach(i=>{const s=i[0],o=i[1];if(Array.isArray(o)){const u=document.createElement("optgroup");u.label=s,u.disabled=!1,a.appendChild(u),o.forEach(c=>r(u,c[1],c[0]))}else r(a,o,s)}),a.focus()}function WL(e,t,n){const a=cl(e,Me.radio);if(!a)return;t.forEach(i=>{const s=i[0],o=i[1],u=document.createElement("input"),c=document.createElement("label");u.type="radio",u.name=Me.radio,u.value=s,ij(s,n.inputValue)&&(u.checked=!0);const d=document.createElement("span");ri(d,o),d.className=Me.label,c.appendChild(u),c.appendChild(d),a.appendChild(c)});const r=a.querySelectorAll("input");r.length&&r[0].focus()}const n0=e=>{const t=[];return e instanceof Map?e.forEach((n,a)=>{let r=n;typeof r=="object"&&(r=n0(r)),t.push([a,r])}):Object.keys(e).forEach(n=>{let a=e[n];typeof a=="object"&&(a=n0(a)),t.push([n,a])}),t},ij=(e,t)=>!!t&&t.toString()===e.toString(),GL=e=>{const t=yn.innerParams.get(e);e.disableButtons(),t.input?sj(e,"confirm"):z2(e,!0)},VL=e=>{const t=yn.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?sj(e,"deny"):B2(e,!1)},KL=(e,t)=>{e.disableButtons(),t(th.cancel)},sj=(e,t)=>{const n=yn.innerParams.get(e);if(!n.input){qu(`The "input" parameter is needed to be set when using returnInputValueOn${j2(t)}`);return}const a=e.getInput(),r=OL(e,n);n.inputValidator?$L(e,r,t):a&&!a.checkValidity()?(e.enableButtons(),e.showValidationMessage(n.validationMessage||a.validationMessage)):t==="deny"?B2(e,r):z2(e,r)},$L=(e,t,n)=>{const a=yn.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>fp(a.inputValidator(t,a.validationMessage))).then(i=>{e.enableButtons(),e.enableInput(),i?e.showValidationMessage(i):n==="deny"?B2(e,t):z2(e,t)})},B2=(e,t)=>{const n=yn.innerParams.get(e||void 0);n.showLoaderOnDeny&&Fd(Hu()),n.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>fp(n.preDeny(t,n.validationMessage))).then(r=>{r===!1?(e.hideLoading(),xp(e)):e.close({isDenied:!0,value:typeof r>"u"?t:r})}).catch(r=>oj(e||void 0,r))):e.close({isDenied:!0,value:t})},t3=(e,t)=>{e.close({isConfirmed:!0,value:t})},oj=(e,t)=>{e.rejectPromise(t)},z2=(e,t)=>{const n=yn.innerParams.get(e||void 0);n.showLoaderOnConfirm&&Fd(),n.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>fp(n.preConfirm(t,n.validationMessage))).then(r=>{jr(J0())||r===!1?(e.hideLoading(),xp(e)):t3(e,typeof r>"u"?t:r)}).catch(r=>oj(e||void 0,r))):t3(e,t)};function a0(){const e=yn.innerParams.get(this);if(!e)return;const t=yn.domCache.get(this);rr(t.loader),Z0()?e.icon&&Ea(Qd()):YL(t),Ei([t.popup,t.actions],Me.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const YL=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?Ea(t[0],"inline-block"):NR()&&rr(e.actions)};function lj(){const e=yn.innerParams.get(this),t=yn.domCache.get(this);return t?ev(t.popup,e.input):null}function uj(e,t,n){const a=yn.domCache.get(e);t.forEach(r=>{a[r].disabled=n})}function cj(e,t){const n=$t();if(!(!n||!e))if(e.type==="radio"){const a=n.querySelectorAll(`[name="${Me.radio}"]`);for(let r=0;r<a.length;r++)a[r].disabled=t}else e.disabled=t}function dj(){uj(this,["confirmButton","denyButton","cancelButton"],!1)}function hj(){uj(this,["confirmButton","denyButton","cancelButton"],!0)}function fj(){cj(this.getInput(),!1)}function pj(){cj(this.getInput(),!0)}function mj(e){const t=yn.domCache.get(this),n=yn.innerParams.get(this);ri(t.validationMessage,e),t.validationMessage.className=Me["validation-message"],n.customClass&&n.customClass.validationMessage&&Jt(t.validationMessage,n.customClass.validationMessage),Ea(t.validationMessage);const a=this.getInput();a&&(a.setAttribute("aria-invalid","true"),a.setAttribute("aria-describedby",Me["validation-message"]),U_(a),Jt(a,Me.inputerror))}function gj(){const e=yn.domCache.get(this);e.validationMessage&&rr(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),Ei(t,Me.inputerror))}const fd={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},XL=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],JL={allowEnterKey:void 0},QL=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],vj=e=>Object.prototype.hasOwnProperty.call(fd,e),xj=e=>XL.indexOf(e)!==-1,bj=e=>JL[e],ZL=e=>{vj(e)||dr(`Unknown parameter "${e}"`)},eP=e=>{QL.includes(e)&&dr(`The parameter "${e}" is incompatible with toasts`)},tP=e=>{const t=bj(e);t&&O_(e,t)},yj=e=>{e.backdrop===!1&&e.allowOutsideClick&&dr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&dr(`Invalid theme "${e.theme}"`);for(const t in e)ZL(t),e.toast&&eP(t),tP(t)};function wj(e){const t=fr(),n=$t(),a=yn.innerParams.get(this);if(!n||vo(n,a.hideClass.popup)){dr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const r=nP(e),i=Object.assign({},a,r);yj(i),t.dataset.swal2Theme=i.theme,J_(this,i),yn.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const nP=e=>{const t={};return Object.keys(e).forEach(n=>{xj(n)?t[n]=e[n]:dr(`Invalid parameter to update: ${n}`)}),t};function Nj(){const e=yn.domCache.get(this),t=yn.innerParams.get(this);if(!t){kj(this);return}e.popup&&bt.swalCloseEventFinishedCallback&&(bt.swalCloseEventFinishedCallback(),delete bt.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),bt.eventEmitter.emit("didDestroy"),aP(this)}const aP=e=>{kj(e),delete e.params,delete bt.keydownHandler,delete bt.keydownTarget,delete bt.currentInstance},kj=e=>{e.isAwaitingPromise?(sb(yn,e),e.isAwaitingPromise=!0):(sb(Od,e),sb(yn,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},sb=(e,t)=>{for(const n in e)e[n].delete(t)};var rP=Object.freeze({__proto__:null,_destroy:Nj,close:dl,closeModal:dl,closePopup:dl,closeToast:dl,disableButtons:hj,disableInput:pj,disableLoading:a0,enableButtons:dj,enableInput:fj,getInput:lj,handleAwaitingPromise:xp,hideLoading:a0,rejectPromise:rj,resetValidationMessage:gj,showValidationMessage:mj,update:wj});const iP=(e,t,n)=>{e.toast?sP(e,t,n):(lP(t),uP(t),cP(e,t,n))},sP=(e,t,n)=>{t.popup.onclick=()=>{e&&(oP(e)||e.timer||e.input)||n(th.close)}},oP=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let r0=!1;const lP=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(r0=!0)}}},uP=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(n){e.popup.onmouseup=()=>{},(n.target===e.popup||n.target instanceof HTMLElement&&e.popup.contains(n.target))&&(r0=!0)}}},cP=(e,t,n)=>{t.container.onclick=a=>{if(r0){r0=!1;return}a.target===t.container&&X0(e.allowOutsideClick)&&n(th.backdrop)}},dP=e=>typeof e=="object"&&e.jquery,n3=e=>e instanceof Element||dP(e),hP=e=>{const t={};return typeof e[0]=="object"&&!n3(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((n,a)=>{const r=e[a];typeof r=="string"||n3(r)?t[n]=r:r!==void 0&&qu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof r}`)}),t};function fP(...e){return new this(...e)}function pP(e){class t extends this{_main(a,r){return super._main(a,Object.assign({},e,r))}}return t}const mP=()=>bt.timeout&&bt.timeout.getTimerLeft(),Sj=()=>{if(bt.timeout)return SR(),bt.timeout.stop()},_j=()=>{if(bt.timeout){const e=bt.timeout.start();return M2(e),e}},gP=()=>{const e=bt.timeout;return e&&(e.running?Sj():_j())},vP=e=>{if(bt.timeout){const t=bt.timeout.increase(e);return M2(t,!0),t}},xP=()=>!!(bt.timeout&&bt.timeout.isRunning());let a3=!1;const W1={};function bP(e="data-swal-template"){W1[e]=this,a3||(document.body.addEventListener("click",yP),a3=!0)}const yP=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const n in W1){const a=t.getAttribute(n);if(a){W1[n].fire({template:a});return}}};class wP{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,n){const a=this._getHandlersByEventName(t);a.includes(n)||a.push(n)}once(t,n){const a=(...r)=>{this.removeListener(t,a),n.apply(this,r)};this.on(t,a)}emit(t,...n){this._getHandlersByEventName(t).forEach(a=>{try{a.apply(this,n)}catch(r){console.error(r)}})}removeListener(t,n){const a=this._getHandlersByEventName(t),r=a.indexOf(n);r>-1&&a.splice(r,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}bt.eventEmitter=new wP;const NP=(e,t)=>{bt.eventEmitter.on(e,t)},kP=(e,t)=>{bt.eventEmitter.once(e,t)},SP=(e,t)=>{if(!e){bt.eventEmitter.reset();return}t?bt.eventEmitter.removeListener(e,t):bt.eventEmitter.removeAllListeners(e)};var _P=Object.freeze({__proto__:null,argsToParams:hP,bindClickHandler:bP,clickCancel:hL,clickConfirm:Q_,clickDeny:dL,enableLoading:Fd,fire:fP,getActions:mp,getCancelButton:Zd,getCloseButton:T2,getConfirmButton:Ls,getContainer:fr,getDenyButton:Hu,getFocusableElements:R2,getFooter:z_,getHtmlContainer:E2,getIcon:Qd,getIconContent:vR,getImage:B_,getInputLabel:xR,getLoader:eh,getPopup:$t,getProgressSteps:D2,getTimerLeft:mP,getTimerProgressBar:Q0,getTitle:F_,getValidationMessage:J0,increaseTimer:vP,isDeprecatedParameter:bj,isLoading:yR,isTimerRunning:xP,isUpdatableParameter:xj,isValidParameter:vj,isVisible:cL,mixin:pP,off:SP,on:NP,once:kP,resumeTimer:_j,showLoading:Fd,stopTimer:Sj,toggleTimer:gP});class jP{constructor(t,n){this.callback=t,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const n=this.running;return n&&this.stop(),this.remaining+=t,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const jj=["swal-title","swal-html","swal-footer"],CP=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const n=t.content;return MP(n),Object.assign(AP(n),EP(n),DP(n),TP(n),RP(n),LP(n),PP(n,jj))},AP=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(a=>{Mu(a,["name","value"]);const r=a.getAttribute("name"),i=a.getAttribute("value");!r||!i||(typeof fd[r]=="boolean"?t[r]=i!=="false":typeof fd[r]=="object"?t[r]=JSON.parse(i):t[r]=i)}),t},EP=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(a=>{const r=a.getAttribute("name"),i=a.getAttribute("value");!r||!i||(t[r]=new Function(`return ${i}`)())}),t},DP=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(a=>{Mu(a,["type","color","aria-label"]);const r=a.getAttribute("type");!r||!["confirm","cancel","deny"].includes(r)||(t[`${r}ButtonText`]=a.innerHTML,t[`show${j2(r)}Button`]=!0,a.hasAttribute("color")&&(t[`${r}ButtonColor`]=a.getAttribute("color")),a.hasAttribute("aria-label")&&(t[`${r}ButtonAriaLabel`]=a.getAttribute("aria-label")))}),t},TP=e=>{const t={},n=e.querySelector("swal-image");return n&&(Mu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(t.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(t.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(t.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(t.imageAlt=n.getAttribute("alt")||void 0)),t},RP=e=>{const t={},n=e.querySelector("swal-icon");return n&&(Mu(n,["type","color"]),n.hasAttribute("type")&&(t.icon=n.getAttribute("type")),n.hasAttribute("color")&&(t.iconColor=n.getAttribute("color")),t.iconHtml=n.innerHTML),t},LP=e=>{const t={},n=e.querySelector("swal-input");n&&(Mu(n,["type","label","placeholder","value"]),t.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(t.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(t.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(t.inputValue=n.getAttribute("value")));const a=Array.from(e.querySelectorAll("swal-input-option"));return a.length&&(t.inputOptions={},a.forEach(r=>{Mu(r,["value"]);const i=r.getAttribute("value");if(!i)return;const s=r.innerHTML;t.inputOptions[i]=s})),t},PP=(e,t)=>{const n={};for(const a in t){const r=t[a],i=e.querySelector(r);i&&(Mu(i,[]),n[r.replace(/^swal-/,"")]=i.innerHTML.trim())}return n},MP=e=>{const t=jj.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(n=>{const a=n.tagName.toLowerCase();t.includes(a)||dr(`Unrecognized element <${a}>`)})},Mu=(e,t)=>{Array.from(e.attributes).forEach(n=>{t.indexOf(n.name)===-1&&dr([`Unrecognized attribute "${n.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},Cj=10,IP=e=>{const t=fr(),n=$t();typeof e.willOpen=="function"&&e.willOpen(n),bt.eventEmitter.emit("willOpen",n);const r=window.getComputedStyle(document.body).overflowY;BP(t,n,e),setTimeout(()=>{OP(t,n)},Cj),L2()&&(FP(t,e.scrollbarPadding,r),yL()),!Z0()&&!bt.previousActiveElement&&(bt.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(n)),bt.eventEmitter.emit("didOpen",n),Ei(t,Me["no-transition"])},i0=e=>{const t=$t();if(e.target!==t)return;const n=fr();t.removeEventListener("animationend",i0),t.removeEventListener("transitionend",i0),n.style.overflowY="auto"},OP=(e,t)=>{H_(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",i0),t.addEventListener("transitionend",i0)):e.style.overflowY="auto"},FP=(e,t,n)=>{wL(),t&&n!=="hidden"&&AL(n),setTimeout(()=>{e.scrollTop=0})},BP=(e,t,n)=>{Jt(e,n.showClass.backdrop),n.animation?(t.style.setProperty("opacity","0","important"),Ea(t,"grid"),setTimeout(()=>{Jt(t,n.showClass.popup),t.style.removeProperty("opacity")},Cj)):Ea(t,"grid"),Jt([document.documentElement,document.body],Me.shown),n.heightAuto&&n.backdrop&&!n.toast&&Jt([document.documentElement,document.body],Me["height-auto"])};var r3={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function zP(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=r3.email),e.input==="url"&&(e.inputValidator=r3.url))}function UP(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(dr('Target parameter is not valid, defaulting to "body"'),e.target="body")}function qP(e){zP(e),e.showLoaderOnConfirm&&!e.preConfirm&&dr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),UP(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),RR(e)}let gs;var Lm=new WeakMap;class Zn{constructor(...t){if(uR(this,Lm,void 0),typeof window>"u")return;gs=this;const n=Object.freeze(this.constructor.argsToParams(t));this.params=n,this.isAwaitingPromise=!1,cR(Lm,this,this._main(gs.params))}_main(t,n={}){if(yj(Object.assign({},n,t)),bt.currentInstance){const i=Od.swalPromiseResolve.get(bt.currentInstance),{isAwaitingPromise:s}=bt.currentInstance;bt.currentInstance._destroy(),s||i({isDismissed:!0}),L2()&&tj()}bt.currentInstance=gs;const a=WP(t,n);qP(a),Object.freeze(a),bt.timeout&&(bt.timeout.stop(),delete bt.timeout),clearTimeout(bt.restoreFocusTimeout);const r=GP(gs);return J_(gs,a),yn.innerParams.set(gs,a),HP(gs,r,a)}then(t){return $N(Lm,this).then(t)}finally(t){return $N(Lm,this).finally(t)}}const HP=(e,t,n)=>new Promise((a,r)=>{const i=s=>{e.close({isDismissed:!0,dismiss:s})};Od.swalPromiseResolve.set(e,a),Od.swalPromiseReject.set(e,r),t.confirmButton.onclick=()=>{GL(e)},t.denyButton.onclick=()=>{VL(e)},t.cancelButton.onclick=()=>{KL(e,i)},t.closeButton.onclick=()=>{i(th.close)},iP(n,t,i),fL(bt,n,i),IL(e,n),IP(n),VP(bt,n,i),KP(t,n),setTimeout(()=>{t.container.scrollTop=0})}),WP=(e,t)=>{const n=CP(e),a=Object.assign({},fd,t,n,e);return a.showClass=Object.assign({},fd.showClass,a.showClass),a.hideClass=Object.assign({},fd.hideClass,a.hideClass),a.animation===!1&&(a.showClass={backdrop:"swal2-noanimation"},a.hideClass={}),a},GP=e=>{const t={popup:$t(),container:fr(),actions:mp(),confirmButton:Ls(),denyButton:Hu(),cancelButton:Zd(),loader:eh(),closeButton:T2(),validationMessage:J0(),progressSteps:D2()};return yn.domCache.set(e,t),t},VP=(e,t,n)=>{const a=Q0();rr(a),t.timer&&(e.timeout=new jP(()=>{n("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(Ea(a),ni(a,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&M2(t.timer)})))},KP=(e,t)=>{if(!t.toast){if(!X0(t.allowEnterKey)){O_("allowEnterKey"),XP();return}$P(e)||YP(e,t)||H1(-1,1)}},$P=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const n of t)if(n instanceof HTMLElement&&jr(n))return n.focus(),!0;return!1},YP=(e,t)=>t.focusDeny&&jr(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&jr(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&jr(e.confirmButton)?(e.confirmButton.focus(),!0):!1,XP=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}Zn.prototype.disableButtons=hj;Zn.prototype.enableButtons=dj;Zn.prototype.getInput=lj;Zn.prototype.disableInput=pj;Zn.prototype.enableInput=fj;Zn.prototype.hideLoading=a0;Zn.prototype.disableLoading=a0;Zn.prototype.showValidationMessage=mj;Zn.prototype.resetValidationMessage=gj;Zn.prototype.close=dl;Zn.prototype.closePopup=dl;Zn.prototype.closeModal=dl;Zn.prototype.closeToast=dl;Zn.prototype.rejectPromise=rj;Zn.prototype.update=wj;Zn.prototype._destroy=Nj;Object.assign(Zn,_P);Object.keys(rP).forEach(e=>{Zn[e]=function(...t){return gs&&gs[e]?gs[e](...t):null}});Zn.DismissReason=th;Zn.version="11.22.2";const ct=Zn;ct.default=ct;typeof document<"u"&&function(e,t){var n=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=t);else try{n.innerHTML=t}catch{n.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const JP=()=>l.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:l.jsx("div",{className:"flex items-start space-x-3",children:l.jsx(Hb,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"})})}),QP=ae.lazy(()=>gg(()=>import("./index-DjDS4oXJ.js"),__vite__mapDeps([0,1,2,3,4]))),ZP=()=>{const e=hr(),t=Dy(),[n,a]=ae.useState({email:"",password:""}),[r,i]=ae.useState(!1),[s,o]=ae.useState(null),[u,c]=ae.useState(null),[d,h]=ae.useState(!1),[p,f]=ae.useState(null),[g,b]=ae.useState(!1),w=Nd.createRef();ae.useEffect(()=>{var A,R;(A=t.state)!=null&&A.message&&(c(t.state.message),(R=t.state)!=null&&R.email&&a(L=>({...L,email:t.state.email})),window.history.replaceState({},document.title))},[t.state]);const m=A=>{a({...n,[A.target.name]:A.target.value})},x=()=>!n.email||!n.password?(ct.fire({icon:"warning",title:"Form Tidak Lengkap",text:"Silakan isi email dan password"}),!1):p?!0:(ct.fire({icon:"warning",title:"Verifikasi Diperlukan",html:`
          <div class="text-left">
            <p>Silakan verifikasi bahwa Anda bukan robot dengan mencentang reCAPTCHA</p>
            <p class="mt-2 text-sm text-gray-600">Ini membantu kami mencegah akses tidak sah ke sistem.</p>
          </div>
        `}),!1),y=()=>{var A;i(!1),o(null),(A=w.current)==null||A.reset(),f(null)},N=async A=>{if(A.preventDefault(),!!x()){i(!0),o(null),c(null);try{if(!ul())throw new Error("Sistem belum dikonfigurasi. Silakan hubungi administrator untuk mengatur koneksi database.");const{data:R,error:L}=await Te.auth.signInWithPassword({email:n.email,password:n.password});if(L)throw L;if(R.user){const{data:j,error:D}=await Te.from("profiles").select("role, name, is_face_registered, status").eq("id",R.user.id).single();if(D)console.error("Error fetching profile:",D);else if(j.status!=="active")throw await Te.auth.signOut(),new Error("Akun Anda tidak aktif. Silakan hubungi administrator.");try{await Te.from("activity_logs").insert([{user_id:R.user.id,action_type:"login",action_details:{email:R.user.email,role:(j==null?void 0:j.role)||"unknown",timestamp:new Date().toISOString()},ip_address:"unknown",user_agent:navigator.userAgent}])}catch(z){console.error("Error logging activity:",z)}try{await Te.from("profiles").update({last_login:new Date().toISOString(),device_info:{user_agent:navigator.userAgent,timestamp:new Date().toISOString()}}).eq("id",R.user.id)}catch(z){console.error("Error updating last login:",z)}let B=(j==null?void 0:j.name)||R.user.email||"";await ct.fire({icon:"success",title:"Login Berhasil",html:`
            <div class="text-center">
              <h3 class="text-xl font-bold text-gray-800">Selamat datang, <span class="text-blue-600">${B}</span>!</h3>
              <p class="mt-2 text-gray-600">Anda akan diarahkan ke dashboard</p>
            </div>
          `,showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:()=>{ct.showLoading()}}),(j==null?void 0:j.role)==="admin"?e("/admin/dashboard"):e("/dashboard")}}catch(R){let L="Terjadi kesalahan saat login";L={"Invalid login credentials":"Email atau password salah","Email not confirmed":"Email belum dikonfirmasi. Silakan cek email Anda.","Too many requests":"Terlalu banyak percobaan login. Silakan coba lagi nanti.","Sistem belum dikonfigurasi":"Sistem belum dikonfigurasi. Silakan hubungi administrator.","Akun Anda tidak aktif":R.message}[R.message]||R.message||L,await ct.fire({icon:"error",title:"Login Gagal",html:`
          <div class="text-left">
            <p class="font-medium">${L}</p>
            ${R.message.includes("credentials")?'<p class="mt-2 text-sm text-gray-600">Pastikan email dan password yang Anda masukkan benar.</p>':""}
          </div>
        `,confirmButtonColor:"#3b82f6"}),y(),o(L)}finally{i(!1)}}},S=A=>{f(A),o(null)},T=()=>{f(null),ct.fire({icon:"info",title:"Verifikasi Kadaluarsa",text:"Silakan verifikasi ulang bahwa Anda bukan robot",timer:3e3,showConfirmButton:!1})},C=()=>{f(null),ct.fire({icon:"error",title:"Verifikasi Gagal",text:"Terjadi kesalahan saat memverifikasi reCAPTCHA. Silakan coba lagi.",confirmButtonColor:"#3b82f6"})};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 flex items-center justify-center px-4 py-8 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"w-full max-w-sm sm:max-w-md lg:max-w-lg xl:max-w-xl",children:[l.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-white rounded-full mb-4 sm:mb-6 shadow-lg transform transition-transform hover:scale-105",children:l.jsx(z4,{className:"h-8 w-8 sm:h-10 sm:w-10 text-blue-600"})}),l.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-white mb-2",children:"Portal Karyawan"}),l.jsx("p",{className:"text-sm sm:text-base text-blue-100 px-4",children:"Masuk untuk mengakses sistem absensi"})]}),l.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl p-6 sm:p-8 lg:p-10 backdrop-blur-sm transition-all hover:shadow-3xl",children:[l.jsxs("div",{className:"mb-6 sm:mb-8 text-center",children:[l.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 tracking-tight",children:"Masuk ke Akun Anda"}),l.jsx("p",{className:"text-sm sm:text-base text-gray-500 mt-1 px-2",children:"Silakan login menggunakan email dan password"})]}),!ul()&&l.jsxs("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-yellow-50 rounded-lg flex items-start space-x-3 animate-pulse",children:[l.jsx(Eu,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm sm:text-base",children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Sistem Belum Dikonfigurasi"}),l.jsx("p",{className:"text-yellow-700 text-xs sm:text-sm mt-1",children:"Database belum terhubung. Silakan hubungi administrator untuk mengatur koneksi Supabase."})]})]}),u&&l.jsxs("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}),l.jsx("div",{className:"text-sm sm:text-base",children:l.jsx("p",{className:"text-green-800 font-medium",children:u})})]}),l.jsxs("form",{onSubmit:N,className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"w-full",children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Alamat Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(T0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"}),l.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:m,required:!0,className:`w-full pl-10 sm:pl-10 pr-4 py-3 sm:py-3 border border-gray-200 rounded-lg sm:rounded-xl 
                           focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 
                           shadow-sm hover:shadow-md focus:shadow-md bg-gray-50 text-sm sm:text-base
                           placeholder-gray-400`,placeholder:"Masukkan email Anda"})]})]}),l.jsxs("div",{className:"w-full",children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(ml,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"}),l.jsx("input",{type:d?"text":"password",id:"password",name:"password",value:n.password,onChange:m,required:!0,className:`w-full pl-10 sm:pl-10 pr-10 py-3 sm:py-3 border border-gray-200 rounded-lg sm:rounded-xl 
                           focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 
                           shadow-sm hover:shadow-md focus:shadow-md bg-gray-50 text-sm sm:text-base
                           placeholder-gray-400`,placeholder:"Masukkan password Anda"}),l.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors p-1",onClick:()=>h(!d),"aria-label":d?"Sembunyikan password":"Tampilkan password",children:d?l.jsx(wE,{className:"h-4 w-4 sm:h-5 sm:w-5"}):l.jsx(Wb,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})]}),l.jsx("div",{className:"mt-4 sm:mt-6 flex justify-center",children:l.jsx("div",{className:"w-full max-w-xs sm:max-w-sm",children:l.jsx(ae.Suspense,{fallback:l.jsxs("div",{className:"h-16 sm:h-20 w-full flex items-center justify-center bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 sm:h-8 sm:w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Memuat verifikasi..."})]}),children:l.jsx(QP,{ref:w,sitekey:"6LdVU1srAAAAAHHTvpZWAe6SDWNUgXw80Gh1t8ea",onChange:S,onExpired:T,onErrored:C,theme:"light",size:"normal",className:"transform transition-transform hover:scale-[1.01] mx-auto",onLoad:()=>b(!0)})})})}),l.jsx("button",{type:"submit",disabled:r||!ul()||!p,className:`w-full py-3 sm:py-4 px-4 sm:px-6 rounded-lg sm:rounded-xl font-semibold text-sm sm:text-base
                         focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200
                         ${r?"bg-blue-400 text-white cursor-wait transform scale-[0.98]":"bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800"}
                         ${!ul()||!p?"opacity-70 cursor-not-allowed":"shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98]"}`,"aria-busy":r,children:r?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsxs("svg",{className:"animate-spin h-4 w-4 sm:h-5 sm:w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V8H4z"})]}),l.jsx("span",{children:"Memproses Login..."})]}):"Masuk ke Sistem"}),l.jsx("div",{className:"mt-4 sm:mt-6 text-center",children:l.jsxs("p",{className:"text-xs sm:text-sm text-gray-500",children:["Butuh bantuan?",l.jsx("a",{href:"#",className:"text-blue-600 hover:text-blue-700 font-medium ml-1 transition-colors",children:"Hubungi Administrator"})]})})]})]}),l.jsx("div",{className:"mt-6 sm:mt-8 text-center",children:l.jsx("p",{className:"text-xs sm:text-sm text-blue-100 opacity-75",children:"© 2024 Portal Karyawan. Sistem Absensi Terintegrasi."})})]})})};var Aj={exports:{}},e8="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",t8=e8,n8=t8;function Ej(){}function Dj(){}Dj.resetWarningCache=Ej;var a8=function(){function e(a,r,i,s,o,u){if(u!==n8){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Dj,resetWarningCache:Ej};return n.PropTypes=n,n};Aj.exports=a8();var r8=Aj.exports;const yr=B4(r8);var i8=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function G1(){return G1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},G1.apply(this,arguments)}function s8(e,t){if(e==null)return{};var n={},a=Object.keys(e),r,i;for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Pm(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o8(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,V1(e,t)}function V1(e,t){return V1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,r){return a.__proto__=r,a},V1(e,t)}var tv=function(e){o8(t,e);function t(){var a;return a=e.call(this)||this,a.handleExpired=a.handleExpired.bind(Pm(a)),a.handleErrored=a.handleErrored.bind(Pm(a)),a.handleChange=a.handleChange.bind(Pm(a)),a.handleRecaptchaRef=a.handleRecaptchaRef.bind(Pm(a)),a}var n=t.prototype;return n.getCaptchaFunction=function(r){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[r]:this.props.grecaptcha[r]:null},n.getValue=function(){var r=this.getCaptchaFunction("getResponse");return r&&this._widgetId!==void 0?r(this._widgetId):null},n.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},n.execute=function(){var r=this.getCaptchaFunction("execute");if(r&&this._widgetId!==void 0)return r(this._widgetId);this._executeRequested=!0},n.executeAsync=function(){var r=this;return new Promise(function(i,s){r.executionResolve=i,r.executionReject=s,r.execute()})},n.reset=function(){var r=this.getCaptchaFunction("reset");r&&this._widgetId!==void 0&&r(this._widgetId)},n.forceReset=function(){var r=this.getCaptchaFunction("reset");r&&r()},n.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},n.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},n.handleChange=function(r){this.props.onChange&&this.props.onChange(r),this.executionResolve&&(this.executionResolve(r),delete this.executionReject,delete this.executionResolve)},n.explicitRender=function(){var r=this.getCaptchaFunction("render");if(r&&this._widgetId===void 0){var i=document.createElement("div");this._widgetId=r(i,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(i)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},n.componentDidMount=function(){this.explicitRender()},n.componentDidUpdate=function(){this.explicitRender()},n.handleRecaptchaRef=function(r){this.captcha=r},n.render=function(){var r=this.props;r.sitekey,r.onChange,r.theme,r.type,r.tabindex,r.onExpired,r.onErrored,r.size,r.stoken,r.grecaptcha,r.badge,r.hl,r.isolated;var i=s8(r,i8);return ae.createElement("div",G1({},i,{ref:this.handleRecaptchaRef}))},t}(ae.Component);tv.displayName="ReCAPTCHA";tv.propTypes={sitekey:yr.string.isRequired,onChange:yr.func,grecaptcha:yr.object,theme:yr.oneOf(["dark","light"]),type:yr.oneOf(["image","audio"]),tabindex:yr.number,onExpired:yr.func,onErrored:yr.func,size:yr.oneOf(["compact","normal","invisible"]),stoken:yr.string,hl:yr.string,badge:yr.oneOf(["bottomright","bottomleft","inline"]),isolated:yr.bool};tv.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var Tj={exports:{}},un={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ta=typeof Symbol=="function"&&Symbol.for,U2=Ta?Symbol.for("react.element"):60103,q2=Ta?Symbol.for("react.portal"):60106,nv=Ta?Symbol.for("react.fragment"):60107,av=Ta?Symbol.for("react.strict_mode"):60108,rv=Ta?Symbol.for("react.profiler"):60114,iv=Ta?Symbol.for("react.provider"):60109,sv=Ta?Symbol.for("react.context"):60110,H2=Ta?Symbol.for("react.async_mode"):60111,ov=Ta?Symbol.for("react.concurrent_mode"):60111,lv=Ta?Symbol.for("react.forward_ref"):60112,uv=Ta?Symbol.for("react.suspense"):60113,l8=Ta?Symbol.for("react.suspense_list"):60120,cv=Ta?Symbol.for("react.memo"):60115,dv=Ta?Symbol.for("react.lazy"):60116,u8=Ta?Symbol.for("react.block"):60121,c8=Ta?Symbol.for("react.fundamental"):60117,d8=Ta?Symbol.for("react.responder"):60118,h8=Ta?Symbol.for("react.scope"):60119;function ii(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case U2:switch(e=e.type,e){case H2:case ov:case nv:case rv:case av:case uv:return e;default:switch(e=e&&e.$$typeof,e){case sv:case lv:case dv:case cv:case iv:return e;default:return t}}case q2:return t}}}function Rj(e){return ii(e)===ov}un.AsyncMode=H2;un.ConcurrentMode=ov;un.ContextConsumer=sv;un.ContextProvider=iv;un.Element=U2;un.ForwardRef=lv;un.Fragment=nv;un.Lazy=dv;un.Memo=cv;un.Portal=q2;un.Profiler=rv;un.StrictMode=av;un.Suspense=uv;un.isAsyncMode=function(e){return Rj(e)||ii(e)===H2};un.isConcurrentMode=Rj;un.isContextConsumer=function(e){return ii(e)===sv};un.isContextProvider=function(e){return ii(e)===iv};un.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===U2};un.isForwardRef=function(e){return ii(e)===lv};un.isFragment=function(e){return ii(e)===nv};un.isLazy=function(e){return ii(e)===dv};un.isMemo=function(e){return ii(e)===cv};un.isPortal=function(e){return ii(e)===q2};un.isProfiler=function(e){return ii(e)===rv};un.isStrictMode=function(e){return ii(e)===av};un.isSuspense=function(e){return ii(e)===uv};un.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===nv||e===ov||e===rv||e===av||e===uv||e===l8||typeof e=="object"&&e!==null&&(e.$$typeof===dv||e.$$typeof===cv||e.$$typeof===iv||e.$$typeof===sv||e.$$typeof===lv||e.$$typeof===c8||e.$$typeof===d8||e.$$typeof===h8||e.$$typeof===u8)};un.typeOf=ii;Tj.exports=un;var f8=Tj.exports,W2=f8,p8={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},m8={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},g8={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Lj={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},G2={};G2[W2.ForwardRef]=g8;G2[W2.Memo]=Lj;function i3(e){return W2.isMemo(e)?Lj:G2[e.$$typeof]||p8}var v8=Object.defineProperty,x8=Object.getOwnPropertyNames,s3=Object.getOwnPropertySymbols,b8=Object.getOwnPropertyDescriptor,y8=Object.getPrototypeOf,o3=Object.prototype;function Pj(e,t,n){if(typeof t!="string"){if(o3){var a=y8(t);a&&a!==o3&&Pj(e,a,n)}var r=x8(t);s3&&(r=r.concat(s3(t)));for(var i=i3(e),s=i3(t),o=0;o<r.length;++o){var u=r[o];if(!m8[u]&&!(n&&n[u])&&!(s&&s[u])&&!(i&&i[u])){var c=b8(t,u);try{v8(e,u,c)}catch{}}}}return e}var w8=Pj;const N8=B4(w8);function K1(){return K1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},K1.apply(this,arguments)}function k8(e,t){if(e==null)return{};var n={},a=Object.keys(e),r,i;for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function S8(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ui={},_8=0;function j8(e,t){return t=t||{},function(a){var r=a.displayName||a.name||"Component",i=function(o){S8(u,o);function u(d,h){var p;return p=o.call(this,d,h)||this,p.state={},p.__scriptURL="",p}var c=u.prototype;return c.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+_8++),this.__scriptLoaderID},c.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},c.asyncScriptLoaderHandleLoad=function(h){var p=this;this.setState(h,function(){return p.props.asyncScriptOnLoad&&p.props.asyncScriptOnLoad(p.state)})},c.asyncScriptLoaderTriggerOnScriptLoaded=function(){var h=Ui[this.__scriptURL];if(!h||!h.loaded)throw new Error("Script is not loaded.");for(var p in h.observers)h.observers[p](h);delete window[t.callbackName]},c.componentDidMount=function(){var h=this,p=this.setupScriptURL(),f=this.asyncScriptLoaderGetScriptLoaderID(),g=t,b=g.globalName,w=g.callbackName,m=g.scriptId;if(b&&typeof window[b]<"u"&&(Ui[p]={loaded:!0,observers:{}}),Ui[p]){var x=Ui[p];if(x&&(x.loaded||x.errored)){this.asyncScriptLoaderHandleLoad(x);return}x.observers[f]=function(C){return h.asyncScriptLoaderHandleLoad(C)};return}var y={};y[f]=function(C){return h.asyncScriptLoaderHandleLoad(C)},Ui[p]={loaded:!1,observers:y};var N=document.createElement("script");N.src=p,N.async=!0;for(var S in t.attributes)N.setAttribute(S,t.attributes[S]);m&&(N.id=m);var T=function(A){if(Ui[p]){var R=Ui[p],L=R.observers;for(var j in L)A(L[j])&&delete L[j]}};w&&typeof window<"u"&&(window[w]=function(){return h.asyncScriptLoaderTriggerOnScriptLoaded()}),N.onload=function(){var C=Ui[p];C&&(C.loaded=!0,T(function(A){return w?!1:(A(C),!0)}))},N.onerror=function(){var C=Ui[p];C&&(C.errored=!0,T(function(A){return A(C),!0}))},document.body.appendChild(N)},c.componentWillUnmount=function(){var h=this.__scriptURL;if(t.removeOnUnmount===!0)for(var p=document.getElementsByTagName("script"),f=0;f<p.length;f+=1)p[f].src.indexOf(h)>-1&&p[f].parentNode&&p[f].parentNode.removeChild(p[f]);var g=Ui[h];g&&(delete g.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete Ui[h])},c.render=function(){var h=t.globalName,p=this.props;p.asyncScriptOnLoad;var f=p.forwardedRef,g=k8(p,["asyncScriptOnLoad","forwardedRef"]);return h&&typeof window<"u"&&(g[h]=typeof window[h]<"u"?window[h]:void 0),g.ref=f,ae.createElement(a,g)},u}(ae.Component),s=ae.forwardRef(function(o,u){return ae.createElement(i,K1({},o,{forwardedRef:u}))});return s.displayName="AsyncScriptLoader("+r+")",s.propTypes={asyncScriptOnLoad:yr.func},N8(s,a)}}var $1="onloadcallback",C8="grecaptcha";function Y1(){return typeof window<"u"&&window.recaptchaOptions||{}}function A8(){var e=Y1(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+$1+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+$1+"&render=explicit"}const E8=j8(A8,{callbackName:$1,globalName:C8,attributes:Y1().nonce?{nonce:Y1().nonce}:{}})(tv);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Mj=function(e,t){return(Mj=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)a.hasOwnProperty(r)&&(n[r]=a[r])})(e,t)};function Qi(e,t){function n(){this.constructor=e}Mj(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function lt(e,t,n,a){return new(n||(n=Promise))(function(r,i){function s(c){try{u(a.next(c))}catch(d){i(d)}}function o(c){try{u(a.throw(c))}catch(d){i(d)}}function u(c){c.done?r(c.value):new n(function(d){d(c.value)}).then(s,o)}u((a=a.apply(e,[])).next())})}function ut(e,t){var n,a,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(c){return function(d){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&d[0]?a.return:d[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,d[1])).done)return r;switch(a=0,r&&(d=[2&d[0],r.value]),d[0]){case 0:case 1:r=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,a=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){s.label=d[1];break}if(d[0]===6&&s.label<r[1]){s.label=r[1],r=d;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(d);break}r[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(e,s)}catch(h){d=[6,h],a=0}finally{n=r=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([u,c])}}}var D8=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,a){if(this.flagRegistry[t]={evaluationFn:n,setHook:a},this.urlFlags[t]!=null){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,a,r=(n=this.global.location.search,a={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return T8(a,s[0],s[1]),s.join("=")}),a);"tfjsflags"in r&&r.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),o=s[0],u=s[1];t.urlFlags[o]=function(c,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+c+".")}(o,u)})}},e}();function T8(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Oe(){return Ij}var Ij=null,s0=new Map,X1=new Map;function Oj(e,t){var n=Bj(e,t);return s0.get(n)}function R8(e){return X1.get(e)}function l3(e){for(var t=s0.entries(),n=[];;){var a=t.next(),r=a.done,i=a.value;if(r)break;var s=i[0],o=i[1];s.split("_")[0]===e&&n.push(o)}return n}function Fj(e){var t=e.kernelName,n=e.backendName,a=Bj(t,n);if(s0.has(a))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");s0.set(a,e)}function L8(e){var t=e.kernelName;X1.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),X1.set(t,e)}function Bj(e,t){return t+"_"+e}function J1(e,t,n){return Math.max(e,Math.min(t,n))}function zj(e){return e%2==0?e:e+1}function P8(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function se(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function tn(e,t,n){n===void 0&&(n=""),se(Aa(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function nh(e){se(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Bd(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Es(e)&&!n)for(var a=0;a<e.length;++a)Bd(e[a],t,n);else t.push(e);return t}function ht(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Aa(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Qn(e){return e%1==0}function M8(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Q1(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function pd(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function u3(e,t,n){return t===void 0&&(t=function(a){return 0}),new Promise(function(a,r){var i=0,s=function(){if(e())a();else{i++;var o=t(i);n!=null&&i>=n?r():setTimeout(s,o)}};s()})}function I8(e,t){for(var n=1,a=-1,r=0;r<e.length;++r)if(e[r]>=0)n*=e[r];else if(e[r]===-1){if(a!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+a+" and dim "+r);a=r}else if(e[r]<0)throw Error("Shapes can not be < 0. Found "+e[r]+" at dim "+r);if(a===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[a]=t/n,i}function ba(e,t){var n=t.length;return se((e=e==null?t.map(function(a,r){return r}):[].concat(e)).every(function(a){return a>=-n&&a<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),se(e.every(function(a){return Qn(a)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(a){return a<0?n+a:a})}function du(e,t){for(var n=[],a=[],r=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||r?null:ba(t,e).sort(),s=0,o=0;o<e.length;++o){if(i!=null){if(i[s]===o&&e[o]!==1)throw new Error("Can't squeeze axis "+o+" since its dim '"+e[o]+"' is not 1");(i[s]==null||i[s]>o)&&e[o]===1&&(n.push(e[o]),a.push(o)),i[s]<=o&&s++}e[o]!==1&&(n.push(e[o]),a.push(o))}return{newShape:n,keptDims:a}}function Ff(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function o0(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function O8(e,t){for(var n=0;n<e.length;n++){var a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type "+t+" being uploaded contains "+a+".")}}function F8(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function B8(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Es(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function Uj(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function z8(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function V2(e){return typeof e=="string"||e instanceof String}function U8(e){return typeof e=="boolean"}function q8(e){return typeof e=="number"}function bp(e){return Array.isArray(e)?bp(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":q8(e)?"float32":V2(e)?"string":U8(e)?"bool":"float32"}function Z1(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ey(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Ds(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var a=t-3;a>=0;--a)n[a]=n[a+1]*e[a+1];return n}function qj(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Bd(e)),n&&O8(e,t),function(i,s){return i instanceof Float32Array&&s==="float32"||i instanceof Int32Array&&s==="int32"||i instanceof Uint8Array&&s==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var a=new Uint8Array(e.length),r=0;r<a.length;++r)Math.round(e[r])!==0&&(a[r]=1);return a}throw new Error("Unknown data type "+t)}function c3(e,t){if(e.length===0)return t[0];var n=e.reduce(function(a,r){return a*r});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function a(r,i,s){var o=new Array;if(i.length===1)for(var u=i[0],c=0;c<u;c++)o[c]=s[r+c];else{u=i[0];var d=i.slice(1),h=d.reduce(function(p,f){return p*f});for(c=0;c<u;c++)o[c]=a(r+c*h,d,s)}return o}(0,e,t)}function Hj(e,t){for(var n=yp(e,t),a=0;a<n.length;a++)n[a]=1;return n}function yp(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function vs(){return Oe().platform.now()}function Wj(e){e.forEach(function(t){se(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function H8(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Oe().platform.encode(e,t)}function l0(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Oe().platform.decode(e,t)}function d3(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var a=e[e.length-1],r=0;r<e.length-1;++r)a+=n[r]*e[r];return a}function W8(e,t,n){if(t===0)return[];if(t===1)return[e];for(var a=new Array(t),r=0;r<a.length-1;++r)a[r]=Math.floor(e/n[r]),e-=a[r]*n[r];return a[a.length-1]=e,a}var G8=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new V8)}return e.prototype.profileKernel=function(t,n,a){var r,i=this,s=this.backendTimer.time(function(){r=a()});return r.forEach(function(o){o.data().then(function(u){(function(c,d,h){if(d!=="float32")return!1;for(var p=0;p<c.length;p++){var f=c[p];if(isNaN(f)||!isFinite(f))return console.warn("Found "+f+" in the result of '"+h+"'"),!0}})(u,o.dtype,t),s.then(function(c){var d="";c.getExtraProfileInfo!=null&&(d=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,o,u,c.kernelMs,n,d)})})}),r},e}(),V8=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,a,r,i,s){var o=typeof r=="number"?pd(r+"ms",9):r.error,u=pd(t,25),c=n.rank,d=n.size,h=pd(n.shape.toString(),14),p="";for(var f in i){var g=i[f].shape||n.shape,b=g.length;p+=f+": "+b+"D "+(b>0?g:"")+" "}console.log("%c"+u+"	%c"+o+"	%c"+c+"D "+h+"	%c"+d+"	%c"+p+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),h3=20,qh=3,ob=7;function K8(e,t,n,a){var r=Ds(t),i=function(c,d,h,p){var f=ht(d),g=p[p.length-1],b=new Array(g).fill(0),w=d.length,m=h==="complex64"?Wh(c):c;if(w>1)for(var x=0;x<f/g;x++)for(var y=x*g,N=0;N<g;N++)b[N]=Math.max(b[N],Hh(m[y+N],0,h).length);return b}(e,t,n,r),s=t.length,o=function c(d,h,p,f,g,b){b===void 0&&(b=!0);var w=p==="complex64"?2:1,m=h[0],x=h.length;if(x===0)return p==="complex64"?[Hh(Wh(d)[0],0,p)]:p==="bool"?[Gj(d[0])]:[d[0].toString()];if(x===1){if(m>h3){var y=qh*w,N=Array.from(d.slice(0,y)),S=Array.from(d.slice((m-qh)*w,m*w));return p==="complex64"&&(N=Wh(N),S=Wh(S)),["["+N.map(function(U,I){return Hh(U,g[I],p)}).join(", ")+", ..., "+S.map(function(U,I){return Hh(U,g[m-qh+I],p)}).join(", ")+"]"]}return["["+(p==="complex64"?Wh(d):Array.from(d)).map(function(U,I){return Hh(U,g[I],p)}).join(", ")+"]"]}var T=h.slice(1),C=f.slice(1),A=f[0]*w,R=[];if(m>h3){for(var L=0;L<qh;L++){var j=(D=L*A)+A;R.push.apply(R,c(d.slice(D,j),T,p,C,g,!1))}for(R.push("..."),L=m-qh;L<m;L++)j=(D=L*A)+A,R.push.apply(R,c(d.slice(D,j),T,p,C,g,L===m-1))}else for(L=0;L<m;L++){var D;j=(D=L*A)+A,R.push.apply(R,c(d.slice(D,j),T,p,C,g,L===m-1))}var B=x===2?",":"";for(R[0]="["+R[0]+B,L=1;L<R.length-1;L++)R[L]=" "+R[L]+B;var z=`,
`;for(L=2;L<x;L++)z+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(b?"":z),R}(e,t,n,r,i),u=["Tensor"];return a&&(u.push("  dtype: "+n),u.push("  rank: "+s),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(o.map(function(c){return"    "+c}).join(`
`)),u.join(`
`)}function Hh(e,t,n){return pd(Array.isArray(e)?parseFloat(e[0].toFixed(ob))+" + "+parseFloat(e[1].toFixed(ob))+"j":V2(e)?"'"+e+"'":n==="bool"?Gj(e):parseFloat(e.toFixed(ob)).toString(),t)}function Gj(e){return e===0?"false":"true"}function Wh(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Bf=function(){function e(t,n,a){var r=this;if(this.dtype=n,this.shape=t.slice(),this.size=ht(t),a!=null){var i=a.length;se(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=a||o0(n,this.size),this.strides=Ds(t)}return e.prototype.set=function(t){for(var n=this,a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];a.length===0&&(a=[0]),se(a.length===this.rank,function(){return"The number of provided coordinates ("+a.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(a);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var a=0,r=0,i=t;r<i.length;r++){var s=i[r];if(s<0||s>=this.shape[a]){var o="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(o)}a++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],a=0;a<t.length-1;++a)n+=this.strides[a]*t[a];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),a=0;a<n.length-1;++a)n[a]=Math.floor(t/this.strides[a]),t-=n[a]*this.strides[a];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return bs().makeTensor(this.values,this.shape,this.dtype)},e}(),bs=null,Le=null,Vj=null,Dn=function(){function e(t,n,a,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ht(t),this.strides=Ds(t),this.dataId=a,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),se(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,a){return this.throwIfDisposed(),this.reshape([t,n,a])},e.prototype.as4D=function(t,n,a,r){return this.throwIfDisposed(),this.reshape([t,n,a,r])},e.prototype.as5D=function(t,n,a,r,i){return this.throwIfDisposed(),this.reshape([t,n,a,r,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),Le.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Le.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return Le.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,c3(this.shape,t)]}})})},e.prototype.arraySync=function(){return c3(this.shape,this.dataSync())},e.prototype.data=function(){return lt(this,void 0,void 0,function(){var t,n;return ut(this,function(a){switch(a.label){case 0:return this.throwIfDisposed(),t=bs().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=a.sent();try{return[2,n.map(function(r){return l0(r)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}a.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=bs().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return l0(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,bs().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(bs().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),Le.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),Le.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),Le.expandDims(this,t)},e.prototype.cumsum=function(t,n,a){return t===void 0&&(t=0),n===void 0&&(n=!1),a===void 0&&(a=!1),Le.cumsum(this,t,n,a)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),Le.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),Le.clone(this)},e.prototype.oneHot=function(t,n,a){return this.throwIfDisposed(),Le.oneHot(this,t,n,a)},e.prototype.toString=function(t){return t===void 0&&(t=!1),K8(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),Le.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Le.gather(this,t,n)},e.prototype.matMul=function(t,n,a){return n===void 0&&(n=!1),a===void 0&&(a=!1),this.throwIfDisposed(),Le.matMul(this,t,n,a)},e.prototype.dot=function(t){return this.throwIfDisposed(),Le.dot(this,t)},e.prototype.norm=function(t,n,a){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),a===void 0&&(a=!1),this.throwIfDisposed(),Le.norm(this,t,n,a)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),Le.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),Le.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Le.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Le.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),Le.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),Le.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),Le.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,a,r,i){return a===void 0&&(a=.001),Vj("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,r,a)},e.prototype.batchNorm=function(t,n,a,r,i){return i===void 0&&(i=.001),this.throwIfDisposed(),Le.batchNorm(this,t,n,a,r,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Le.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Le.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Le.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),Le.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),Le.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),Le.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),Le.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),Le.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),Le.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),Le.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),Le.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),Le.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),Le.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),Le.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),Le.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),Le.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),Le.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),Le.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Le.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),Le.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Le.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),Le.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),Le.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Le.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),Le.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),Le.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Le.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),Le.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),Le.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),Le.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),Le.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),Le.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Le.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),Le.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Le.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Le.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Le.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Le.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),Le.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Le.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),Le.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),Le.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),Le.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Le.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Le.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Le.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Le.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Le.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Le.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Le.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Le.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Le.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Le.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Le.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Le.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Le.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Le.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Le.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),Le.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),Le.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Le.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Le.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Le.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),Le.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),Le.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Le.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Le.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Le.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Le.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Le.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Le.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Le.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Le.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Le.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Le.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Le.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Le.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Le.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Le.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Le.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Le.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Le.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Le.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Le.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),Le.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Le.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Le.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Le.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Le.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,a,r,i,s){return r===void 0&&(r="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),Le.conv1d(this,t,n,a,r,i,s)},e.prototype.conv2d=function(t,n,a,r,i,s){return r===void 0&&(r="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Le.conv2d(this,t,n,a,r,i,s)},e.prototype.conv2dTranspose=function(t,n,a,r,i){return this.throwIfDisposed(),Le.conv2dTranspose(this,t,n,a,r,i)},e.prototype.depthwiseConv2D=function(t,n,a,r,i,s){return r===void 0&&(r="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Le.depthwiseConv2d(this,t,n,a,r,i,s)},e.prototype.separableConv2d=function(t,n,a,r,i,s){return i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),Le.separableConv2d(this,t,n,a,r,i,s)},e.prototype.avgPool=function(t,n,a,r){return this.throwIfDisposed(),Le.avgPool(this,t,n,a,r)},e.prototype.maxPool=function(t,n,a,r){return this.throwIfDisposed(),Le.maxPool(this,t,n,a,r)},e.prototype.localResponseNormalization=function(t,n,a,r){return t===void 0&&(t=5),n===void 0&&(n=1),a===void 0&&(a=1),r===void 0&&(r=.5),Le.localResponseNormalization(this,t,n,a,r)},e.prototype.pool=function(t,n,a,r,i){return this.throwIfDisposed(),Le.pool(this,t,n,a,r,i)},e.prototype.variable=function(t,n,a){return t===void 0&&(t=!0),this.throwIfDisposed(),bs().makeVariable(this,t,n,a)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),Le.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),Le.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Le.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),Le.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,a,r,i,s,o,u){return r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),this.throwIfDisposed(),Le.stridedSlice(this,t,n,a,r,i,s,o,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),Le.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),Le.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Le.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Le.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Le.spectral.irfft(this)},e}();Object.defineProperty(Dn,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var f3,ty,ny,ay,ry,zd=function(e){function t(n,a,r,i){var s=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return s.trainable=a,s.name=r,s}return Qi(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Aa(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");bs().disposeTensor(this),this.dataId=n.dataId,bs().incRef(this,null)},t.prototype.dispose=function(){bs().disposeVariable(this),this.isDisposedInternal=!0},t}(Dn);Object.defineProperty(zd,Symbol.hasInstance,{value:function(e){return e instanceof Dn&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(f3||(f3={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ty||(ty={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(ny||(ny={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(ay||(ay={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(ry||(ry={}));var $8={float32:ay,int32:ty,bool:ny,complex64:ry};function Oa(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return $8[e][t]}function lb(e){return Oa(e,"int32")}function Pn(e,t){if(e.dtype===t.dtype)return[e,t];var n=Oa(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Y8(e,t){se(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function Kj(e){var t=[];return function n(a,r,i){if(a!=null){if(a instanceof Dn)return void r.push(a);if(s=a,!(!Array.isArray(s)&&typeof s!="object")){var s,o=a;for(var u in o){var c=o[u];i.has(c)||(i.add(c),n(c,r,i))}}}}(e,t,new Set),t}var ub,p3=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),X8=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new p3}return e.prototype.ready=function(){return lt(this,void 0,void 0,function(){var t,n,a;return ut(this,function(r){switch(r.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,r.label=1;case 1:return n<t.length?(a=t[n],[4,this.initializeBackend(a).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(a)]:[3,4];case 3:return r.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,a){return a===void 0&&(a=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:a},!0)},e.prototype.setBackend=function(t){return lt(this,void 0,void 0,function(){var n,a,r;return ut(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),a=n.success,n.asyncInit?[4,a]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=a,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new G8(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;l3(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;l3(t).forEach(function(a){a.disposeFunc!=null&&a.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,a=this.registryFactory[t];if(a==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=a.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,s=r.then(function(o){return!(i<n.pendingBackendInitId)&&(n.registry[t]=o,n.pendingBackendInit=null,!0)}).catch(function(o){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(o.stack||o.message),!1)});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(o){return console.warn("Initialization of backend "+t+" failed"),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,a){return t.registryFactory[a].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var a=t[n],r=this.initializeBackend(a),i=r.success,s=r.asyncInit;if(s||i)return{name:a,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var a=this.state.tensorInfo.get(n),r=a.backend,i=this.readSync(n);r.disposeData(n),a.backend=t,t.move(n,i,a.shape,a.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var a,r=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return r.startScope(i)},function(){return r.endScope(a)},function(){return(a=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a})},e.prototype.scopedRun=function(t,n,a){t();try{var r=a();return n(),r}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),a={x:t};return this.addTapeNode(this.state.activeScope.name,a,[n],function(r){return{x:function(){return r.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,a,r,i){return this.runKernelFunc(null,n,null,t,a,r,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,a){var r=this.backend.numDataIds(),i=0;a.forEach(function(u){i+=u.dtype==="complex64"?3:1});var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-n-i-s;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,a,r,i,s,o){var u,c=this;s===void 0&&(s=[]),o===void 0&&(o=[]);var d=[],h=this.isTapeOn();r==null&&(r=this.state.activeScope!=null?this.state.activeScope.name:"");var p,f=function(x){h&&(d=x.map(function(y){return c.keep(c.clone(y))}))},g=this.state.numBytes,b=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var w,m=Oj(r,this.backendName);return p=m!=null?function(){var x=c.backend.numDataIds();w=m.kernelFunc({inputs:n,attrs:i,backend:c.backend});var y=Array.isArray(w)?w:[w];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(r,x,y);var N=y.map(function(T){var C=T.dataId,A=T.shape,R=T.dtype;return c.makeTensorFromDataId(C,A,R)}),S=N.filter(function(T,C){return o[C]});return f((s||[]).slice().concat(S)),N}:function(){var x=c.backend.numDataIds();w=c.tidy(function(){return t(c.backend,f)});var y=Array.isArray(w)?w:[w];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(r,x,y),y},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(r,n,function(){return p()}):p()}),h&&this.addTapeNode(r,n,u,a,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-g,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-b,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(x){return n[x].shape}),outputShapes:u.map(function(x){return x.shape})}),Array.isArray(w)?u:u[0]},e.prototype.makeTensor=function(t,n,a,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");a=a||"float32",r=r||this.backend;var i=t;a==="string"&&V2(t[0])&&(i=t.map(function(d){return H8(d)}));var s=r.write(i,n,a),o=new Dn(n,a,s,this.nextTensorId());if(this.incRef(o,r),a==="string"){var u=this.state.tensorInfo.get(s),c=z8(i);this.state.numBytes+=c-u.bytes,u.bytes=c}return o},e.prototype.makeTensorFromDataId=function(t,n,a,r){var i=new Dn(n,a=a||"float32",t,this.nextTensorId());return this.incRef(i,r),i},e.prototype.makeVariable=function(t,n,a,r){n===void 0&&(n=!0),a=a||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.asType(r));var i=new zd(t,n,a,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var a=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,a===0){this.state.numDataBuffers++;var r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*Uj(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof zd||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return lt(this,void 0,void 0,function(){var n,a;return ut(this,function(r){return this.state.profiling=!0,n=this.state.numBytes,a=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-a,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,a,r,i){var s=this,o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:a,saved:i},u=R8(t);u!=null&&(r=u.gradFunc),r!=null&&(o.gradient=function(c){return c=c.map(function(d,h){if(d==null){var p=a[h],f=yp(p.size,p.dtype);return s.makeTensor(f,p.shape,p.dtype)}return d}),r(c.length>1?c:c[0],i)}),this.state.activeTape.push(o)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,a=Kj(t),r=new Set(a.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||r.has(s.id)||s.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],a.forEach(function(u){u.kept||u.scopeId!==o.id||n.track(u)})},e.prototype.gradients=function(t,n,a,r){var i=this;if(r===void 0&&(r=!1),se(n.length>0,function(){return"gradients() received an empty list of xs."}),a!=null&&a.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+a.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});se(s instanceof Dn,function(){return"The result y returned by f() must be a tensor."});var o=function(u,c,d){for(var h={},p={},f=0;f<c.length;f++)h[c[f].id]=!0;for(f=0;f<u.length;f++){var g=(T=u[f]).inputs;for(var b in g){for(var w=g[b],m=!1,x=0;x<c.length;x++)if(h[w.id]){T.outputs.forEach(function(L){return h[L.id]=!0}),m=!0,p[T.id]=!0;break}if(m)break}}var y={};y[d.id]=!0;var N={};for(f=u.length-1;f>=0;f--)for(g=(T=u[f]).inputs,x=0;x<T.outputs.length;x++)if(y[T.outputs[x].id]){for(var b in g)y[g[b].id]=!0,N[T.id]=!0;break}var S=[];for(f=0;f<u.length;f++){var T;if(p[(T=u[f]).id]&&N[T.id]){var C={};for(var b in T.inputs){var A=T.inputs[b];h[A.id]&&(C[b]=A)}var R=Object.assign({},T);R.inputs=C,R.outputs=T.outputs,S.push(R)}}return S}(this.state.activeTape,n,s);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,d={};d[s.id]=a??(u=s.shape,c=Hj(ht(u),"float32"),be.makeTensor(c,u,"float32")),function(p,f,g){for(var b=function(m){var x=f[m],y=[];if(x.outputs.forEach(function(C){var A=p[C.id];A!=null?y.push(A):y.push(null)}),x.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+x.kernelName+".");var N=x.gradient(y),S=function(C){if(!(C in N))throw new Error("Cannot backprop through input "+C+". Available gradients found: "+Object.keys(N)+".");var A=g(function(){return N[C]()});if(A.dtype!=="float32")throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input "+C+" must have 'float32' dtype, but has '"+A.dtype+"'");var R=x.inputs[C];if(!Aa(A.shape,R.shape))throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input '"+C+"' has shape '"+A.shape+"', which does not match the shape of the input '"+R.shape+"'");if(p[R.id]==null)p[R.id]=A;else{var L=p[R.id];p[R.id]=L.add(A),L.dispose()}};for(var T in x.inputs)S(T)},w=f.length-1;w>=0;w--)b(w)}(d,o,function(p){return i.tidy(p)});var h=n.map(function(p){return d[p.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(p){for(var f=0,g=p.saved;f<g.length;f++)g[f].dispose()}),i.state.activeTape=null),{value:s,grads:h}})},e.prototype.customGrad=function(t){var n=this;return se(Z1(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var a,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];se(r.every(function(o){return o instanceof Dn}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return r.forEach(function(o,u){s[u]=o}),n.runKernelFunc(function(o,u){return se((a=t.apply(void 0,r.concat([u]))).value instanceof Dn,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),se(Z1(a.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),a.value},s,function(o,u){var c=a.gradFunc(o,u),d=Array.isArray(c)?c:[c];se(d.length===r.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),se(d.every(function(p){return p instanceof Dn}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return d.forEach(function(p,f){h[f]=function(){return p}}),h})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return lt(this,void 0,void 0,function(){var n,a;return ut(this,function(r){switch(r.label){case 0:return n=vs(),[4,this.backend.time(t)];case 1:return(a=r.sent()).wallMs=vs()-n,[2,a]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new p3,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),be=function(){var e=function(){if(ub==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}ub=n}return ub}();if(e._tfengine==null){var t=new D8(e);e._tfengine=new X8(t)}return function(n){Ij=n}(e._tfengine.ENV),bs=function(){return e._tfengine},e._tfengine}();function $j(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var no=Oe();no.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),no.registerFlag("IS_BROWSER",function(){return $j()}),no.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),no.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),no.registerFlag("PROD",function(){return!1}),no.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return no.getBool("DEBUG")}),no.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),no.registerFlag("IS_TEST",function(){return!1});var zf,Gr,Hr,ou={},cb={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function J8(e,t){ou[e]=t}function Fs(e){e in ou||(ou[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var a=function(r){if(typeof OffscreenCanvas<"u"&&r===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return a.addEventListener("webglcontextlost",function(r){r.preventDefault(),delete ou[n]},!1),n===1?a.getContext("webgl",cb)||a.getContext("experimental-webgl",cb):a.getContext("webgl2",cb)}(e));var t=ou[e];return t.isContextLost()?(delete ou[e],Fs(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ou[e])}function hv(e,t){return[t,e]}function mf(e){var t=ht(e);return Q1(Math.ceil(t/4))}function wp(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function K2(e,t){var n,a,r,i,s,o,u,c,d,h=e;return Oe().getNumber("WEBGL_VERSION")===2?(n=h.R32F,a=h.R16F,r=h.RGBA16F,i=h.RGBA32F,s=h.RED,o=4,u=1,c=h.HALF_FLOAT,d=h.FLOAT):(n=e.RGBA,a=e.RGBA,r=e.RGBA,i=h.RGBA,s=e.RGBA,o=4,u=4,c=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:o,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:d}}function ft(e,t,n){var a=n();return t&&function(r){var i=r.getError();if(i!==r.NO_ERROR)throw new Error("WebGL Error: "+tM(r,i))}(e),a}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(zf||(zf={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Gr||(Gr={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Hr||(Hr={}));var Q8=596e-10,Z8=65504;function eM(e){return!!(Oe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||Q8<Math.abs(e)&&Math.abs(e)<Z8)}function tM(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Mm(e,t,n){return So(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function nM(e,t,n){var a=So(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ft(e,t,function(){return e.shaderSource(a,n)}),ft(e,t,function(){return e.compileShader(a)}),e.getShaderParameter(a,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(a)),new Error("Failed to compile vertex shader.");return a}function aM(e,t,n){var a=So(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ft(e,t,function(){return e.shaderSource(a,n)}),ft(e,t,function(){return e.compileShader(a)}),e.getShaderParameter(a,e.COMPILE_STATUS)===!1)throw function(r,i){var s=rM.exec(i);if(s==null)return console.log("Couldn't parse line number in error: "+i),void console.log(r);for(var o=+s[1],u=r.split(`
`),c=u.length.toString().length+2,d=u.map(function(w,m){return pd((m+1).toString(),c)+w}),h=0,p=0;p<d.length;p++)h=Math.max(d[p].length,h);var f=d.slice(0,o-1),g=d.slice(o-1,o),b=d.slice(o);console.log(f.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+pd(g[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(b.join(`
`))}(n,e.getShaderInfoLog(a)),new Error("Failed to compile fragment shader.");return a}var db,hb,rM=/ERROR: [0-9]+:([0-9]+):/g;function iM(e,t){return So(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function sM(e,t,n){if(ft(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function fb(e,t,n){if(ft(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function oM(e,t,n){var a=So(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ft(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),ft(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),a}function lM(e,t,n){var a=So(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ft(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a)}),ft(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),a}function uM(e,t){return So(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function cM(e,t){var n=Oe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var a="["+e+"x"+t+"]";throw new Error("Requested texture size "+a+" is invalid.")}if(e>n||t>n)throw a="["+e+"x"+t+"]",new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function dM(e,t){return So(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function m3(e,t,n,a,r,i,s,o){var u=e.getAttribLocation(n,a);return u!==-1&&(ft(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ft(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,s,o)}),ft(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function hM(e,t,n,a){vM(e,a),ft(e,t,function(){return e.activeTexture(e.TEXTURE0+a)}),ft(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function fM(e,t,n,a){return So(e,t,function(){return e.getUniformLocation(n,a)},'uniform "'+a+'" not present in program.')}function pM(e,t,n){return e.getUniformLocation(t,n)}function mM(e,t,n,a,r,i){ft(e,t,function(){return hM(e,t,a,i)}),ft(e,t,function(){return e.uniform1i(r,i)})}function pb(e,t,n,a){ft(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,a)}),ft(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function g3(e,t,n){ft(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ft(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Im(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+gM(e,t))}function gM(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function So(e,t,n,a){var r=ft(e,t,function(){return n()});if(r==null)throw new Error(a);return r}function vM(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||a>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function u0(e,t){return t===void 0&&(t=2),ht(e.slice(0,e.length-t))}function c0(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function mb(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[u0(e)].concat(c0(e))),t}function xM(e,t){var n;t===void 0&&(t=!1);var a=Oe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(a*=2,(e=e.map(function(c,d){return d>=e.length-2?zj(e[d]):e[d]})).length===1&&(e=[2,e[0]])),e.length!==2){var r=du(e);e=r.newShape}var i=ht(e);if(e.length<=1&&i<=a)return[1,i];if(e.length===2&&e[0]<=a&&e[1]<=a)return e;if(e.length===3&&e[0]*e[1]<=a&&e[2]<=a)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=a&&e[1]*e[2]<=a)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=a&&e[3]<=a)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=a&&e[1]*e[2]*e[3]<=a)return[e[0],e[1]*e[2]*e[3]];if(t){var s=u0(e),o=2,u=2;return e.length&&(o=(n=c0(e))[0],u=n[1]),Q1(i=s*(o/2)*(u/2)).map(function(c){return 2*c})}return Q1(i)}function Om(e){return e%2==0}function Fm(e,t){if(Aa(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],a=t.slice(-1)[0];if(n===a||Om(n)&&Om(a)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&Om(e[0])&&Om(t[0])}function bM(e){if(db==null){var t=Fs(e);db=t.getParameter(t.MAX_TEXTURE_SIZE)}return db}function yM(e){if(hb==null){var t=Fs(e);hb=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,hb)}function wM(e){if(e===0)return 0;var t=Fs(e);return ki(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:ki(t,"EXT_disjoint_timer_query")?1:0}function ki(e,t){return e.getExtension(t)!=null}function v3(e){try{if(Fs(e)!=null)return!0}catch{return!1}return!1}function NM(e){if(e===0)return!1;var t=Fs(e);if(e===1){if(!ki(t,"OES_texture_float"))return!1}else if(!ki(t,"EXT_color_buffer_float"))return!1;return iy(t)}function kM(e){if(e===0)return!1;var t=Fs(e);if(e!==1){if(ki(t,"EXT_color_buffer_float"))return iy(t);if(ki(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(a,r){var i=K2(a,r),s=a.createTexture();a.bindTexture(a.TEXTURE_2D,s),a.texImage2D(a.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var o=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,o),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,s,0);var u=a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE;return a.bindTexture(a.TEXTURE_2D,null),a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteTexture(s),a.deleteFramebuffer(o),u}(t,n)}return!1}return!!ki(t,"OES_texture_float")&&!!ki(t,"WEBGL_color_buffer_float")&&iy(t)}function iy(e){var t=K2(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var r=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),r}function SM(e){return e===2&&Fs(e).fenceSync!=null}var St=Oe();function Yj(e){Oe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function st(e,t){return be.tidy(e,t)}function Cr(e){Kj(e).forEach(function(t){return t.dispose()})}function _M(e){return be.keep(e)}function d0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Oe().getBool("IS_TEST")||console.warn.apply(console,e)}function Bl(e,t){var n=e;if(Es(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||Es(n)&&t!=="string";)a.push(n.length),n=n[0];return Array.isArray(e)&&Oe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function r(i,s,o){if(o=o||[],!Array.isArray(i)&&!Es(i))return void se(s.length===0,function(){return"Element arr["+o.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"});se(s.length>0,function(){return"Element arr["+o.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),se(i.length===s[0],function(){return"Element arr["+o.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var u=s.slice(1),c=0;c<i.length;++c)r(i[c],u,o.concat(c))}(e,a,[]),a}function x3(e,t,n,a){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+a+"' must be "+e+" tensor, but got "+t+" tensor")}function te(e,t,n,a){if(a===void 0&&(a="numeric"),e instanceof Dn)return x3(a,e.dtype,t,n),e;var r=bp(e);if(r!=="string"&&["bool","int32","float32"].indexOf(a)>=0&&(r=a),x3(a,r,t,n),e==null||!Es(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var s=Bl(e,r);Es(e)||Array.isArray(e)||(e=[e]);var o=r!=="string"?qj(e,r,Oe().getBool("DEBUG")):Bd(e,[],!0);return be.makeTensor(o,s,r)}function h0(e,t,n,a){if(a===void 0&&(a="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(r,i){return te(r,t+"["+i+"]",n)},a)}function Xj(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function jM(e,t,n){for(var a=e.length+t.length,r=[],i=0,s=0,o=0;o<a;o++)n.indexOf(o)===-1?r.push(e[i++]):r.push(t[s++]);return r}function $a(e,t){for(var n=[],a=e.length,r=0;r<a;r++)t.indexOf(r)===-1&&n.push(e[r]);return[n,t.map(function(i){return e[i]})]}function Er(e,t){return jM(e,t.map(function(n){return 1}),t)}function qr(e,t,n){se(Xj(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Bs(e,t){if(Xj(e,t))return null;for(var n=[],a=0;a<t;++a)e.indexOf(a)===-1&&n.push(a);return e.forEach(function(r){return n.push(r)}),n}function $2(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function zs(e,t){for(var n=[],a=t-e;a<t;++a)n.push(a);return n}function CM(e,t){var n=e[0].length;e.forEach(function(r,i){se(r.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),se(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var a=e[0];e.forEach(function(r,i){for(var s=0;s<n;s++)se(s===t||r[s]===a[s],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+r+") does not match the shape of the rest ("+a+") along the non-concatenated axis "+i+"."})})}function Ud(e,t){for(var n=e[0].slice(),a=1;a<e.length;a++)n[t]+=e[a][t];return n}function he(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var r=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];be.startScope(n);try{var o=a.apply(void 0,i);return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),be.endScope(o),o}catch(u){throw be.endScope(null),u}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}St.registerFlag("HAS_WEBGL",function(){return St.getNumber("WEBGL_VERSION")>0}),St.registerFlag("WEBGL_VERSION",function(){return v3(2)?2:v3(1)?1:0}),St.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return St.get("WEBGL_VERSION")===2}),St.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),St.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),St.registerFlag("WEBGL_PACK",function(){return St.getBool("HAS_WEBGL")}),St.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_PACK_CLIP",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),St.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_PACK_REDUCE",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_LAZILY_UNPACK",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_CONV_IM2COL",function(){return St.getBool("WEBGL_PACK")}),St.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return bM(St.getNumber("WEBGL_VERSION"))}),St.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return yM(St.getNumber("WEBGL_VERSION"))}),St.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=St.getNumber("WEBGL_VERSION");return e===0?0:wM(e)}),St.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return St.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),St.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return NM(St.getNumber("WEBGL_VERSION"))}),St.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!St.getBool("WEBGL_FORCE_F16_TEXTURES")&&St.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),St.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return kM(St.getNumber("WEBGL_VERSION"))}),St.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return SM(St.getNumber("WEBGL_VERSION"))}),St.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return St.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),Vj=Yj;var Ia=he({complex_:function(e,t){var n=te(e,"real","complex"),a=te(t,"imag","complex");return tn(n.shape,a.shape,"real and imag shapes, "+n.shape+" and "+a.shape+", must match in call to tf.complex()."),be.runKernelFunc(function(r){return r.complex(n,a)},{$real:n,$imag:a})}}),wi=he({real_:function(e){var t=te(e,"input","real");return be.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),ys=he({imag_:function(e){var t=te(e,"input","imag");return be.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Fa(e,t,n){return zl(e,t,Bl(e,n),n)}function zl(e,t,n,a){if(a==null&&(a=bp(e)),a==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Es(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Wj(t);var r=ht(t),i=ht(n);se(r===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+r+" values but has "+i});for(var s=0;s<n.length;++s){var o=n[s],u=s!==n.length-1||o!==ht(t.slice(s));se(n[s]===t[s]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Es(e)||Array.isArray(e)||(e=[e]),t=t||n,e=a!=="string"?qj(e,a,Oe().getBool("DEBUG")):Bd(e,[],!0),be.makeTensor(e,t,a)}function at(e,t){if((Es(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Es(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return zl(e,[],[],t)}function ia(e,t){nh(e);var n=Bl(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return zl(e,null,n,t)}function Sl(e,t,n){if(nh(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var a=Bl(e,n);if(a.length!==2&&a.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return zl(e,t,a,n)}function Y2(e,t,n){if(nh(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var a=Bl(e,n);if(a.length!==3&&a.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return zl(e,t,a,n)}function Sr(e,t,n){if(nh(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var a=Bl(e,n);if(a.length!==4&&a.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return zl(e,t,a,n)}function AM(e,t,n){if(nh(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var a=Bl(e,n);if(a.length!==5&&a.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return zl(e,t,a,n)}function EM(e,t,n){if(nh(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var a=Bl(e,n);if(a.length!==6&&a.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return zl(e,t=t||a,a,n)}function DM(e,t,n,a){return t===void 0&&(t=!0),be.makeVariable(e,t,n,a)}function ah(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=ah(e,"float32"),a=Nn(e,"float32");return Ia(n,a)}var r=Hj(ht(e),t);return be.makeTensor(r,e,t)}function Nn(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Nn(e,"float32"),a=Nn(e,"float32");return Ia(n,a)}var r=yp(ht(e),t);return be.makeTensor(r,e,t)}function Ts(e,t,n){return be.runKernelFunc(function(a){return a.fill(e,t,n)},{})}function TM(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return be.runKernelFunc(function(a){return a.linspace(e,t,n)},{})}function f0(e,t,n,a){if(n===void 0&&(n=1),a===void 0&&(a="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Nn([0],a);var r=yp(Math.abs(Math.ceil((t-e)/n)),a);t<e&&n===1&&(n=-1),r[0]=e;for(var i=1;i<r.length;i++)r[i]=r[i-1]+n;return ia(r,a)}var Jj=he({onesLike_:function(e){var t=te(e,"x","onesLike");if(t.dtype==="complex64"){var n=Jj(wi(t)),a=Wt(ys(t));return Ia(n,a)}return be.runKernelFunc(function(r){return r.onesLike(t)},{$x:t},function(r,i){return{$x:function(){return Wt(r)}}})}}),Wt=he({zerosLike_:function(e){var t=te(e,"x","zerosLike");return be.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,a){return{$x:function(){return Wt(n)}}})}}),pa=he({concat_:function(e,t){t===void 0&&(t=0),se(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=h0(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(o){if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+o.dtype+". ")}),t=ba(t,n[0].shape)[0];var a=Ud(n.map(function(o){return o.shape}),t);if(ht(a)===0)return Fa([],a);if((n=n.filter(function(o){return o.size>0})).length===1)return n[0];var r=n.map(function(o){return o.shape});CM(r,t);var i=n,s={axis:t};return be.runKernelFunc(function(o){return o.concat(n,t)},i,function(o){var u=r.map(function(c){return c[t]});return X2(o,u,t).map(function(c){return function(){return c}})},"Concat",s)}}),RM=he({concat1d_:function(e){return pa(e,0)}}),LM=he({concat2d_:function(e,t){return pa(e,t)}}),PM=he({concat3d_:function(e,t){return pa(e,t)}}),MM=he({concat4d_:function(e,t){return pa(e,t)}}),X2=he({split_:function(e,t,n){n===void 0&&(n=0);var a,r=te(e,"x","split");return n=ba(n,r.shape)[0],typeof t=="number"?(se(r.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),a=new Array(t).fill(r.shape[n]/t)):(se(r.shape[n]===t.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),a=t),be.runKernelFunc(function(i){return i.split(r,a,n)},{$x:r},function(i){return{$x:function(){return pa(i,n)}}})}});function Wu(e,t){return e(t={exports:{}},t.exports),t.exports}var IM=Wu(function(e){(function(t,n,a){function r(o){var u,c=this,d=(u=4022871197,function(h){h=h.toString();for(var p=0;p<h.length;p++){var f=.02519603282416938*(u+=h.charCodeAt(p));f-=u=f>>>0,u=(f*=u)>>>0,u+=4294967296*(f-=u)}return 23283064365386963e-26*(u>>>0)});c.next=function(){var h=2091639*c.s0+23283064365386963e-26*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=0|h)},c.c=1,c.s0=d(" "),c.s1=d(" "),c.s2=d(" "),c.s0-=d(o),c.s0<0&&(c.s0+=1),c.s1-=d(o),c.s1<0&&(c.s1+=1),c.s2-=d(o),c.s2<0&&(c.s2+=1),d=null}function i(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function s(o,u){var c=new r(o),d=u&&u.state,h=c.next;return h.int32=function(){return 4294967296*c.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.alea=s})(0,e)}),OM=Wu(function(e){(function(t,n,a){function r(o){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var h=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^h^h>>>8},o===(0|o)?u.x=o:c+=o;for(var d=0;d<c.length+64;d++)u.x^=0|c.charCodeAt(d),u.next()}function i(o,u){return u.x=o.x,u.y=o.y,u.z=o.z,u.w=o.w,u}function s(o,u){var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xor128=s})(0,e)}),FM=Wu(function(e){(function(t,n,a){function r(o){var u=this,c="";u.next=function(){var h=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^h^h<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,o===(0|o)?u.x=o:c+=o;for(var d=0;d<c.length+64;d++)u.x^=0|c.charCodeAt(d),d==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(o,u){return u.x=o.x,u.y=o.y,u.z=o.z,u.w=o.w,u.v=o.v,u.d=o.d,u}function s(o,u){var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xorwow=s})(0,e)}),BM=Wu(function(e){(function(t,n,a){function r(o){var u=this;u.next=function(){var c,d,h=u.x,p=u.i;return c=h[p],d=(c^=c>>>7)^c<<24,d^=(c=h[p+1&7])^c>>>10,d^=(c=h[p+3&7])^c>>>3,d^=(c=h[p+4&7])^c<<7,c=h[p+7&7],d^=(c^=c<<13)^c<<9,h[p]=d,u.i=p+1&7,d},function(c,d){var h,p=[];if(d===(0|d))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[7&h]=p[7&h]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],c.x=p,c.i=0,h=256;h>0;--h)c.next()}(u,o)}function i(o,u){return u.x=o.x.slice(),u.i=o.i,u}function s(o,u){o==null&&(o=+new Date);var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(d.x&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xorshift7=s})(0,e)}),zM=Wu(function(e){(function(t,n,a){function r(o){var u=this;u.next=function(){var c,d,h=u.w,p=u.X,f=u.i;return u.w=h=h+1640531527|0,d=p[f+34&127],c=p[f=f+1&127],d^=d<<13,c^=c<<17,d^=d>>>15,c^=c>>>12,d=p[f]=d^c,u.i=f,d+(h^h>>>16)|0},function(c,d){var h,p,f,g,b,w=[],m=128;for(d===(0|d)?(p=d,d=null):(d+="\0",p=0,m=Math.max(m,d.length)),f=0,g=-32;g<m;++g)d&&(p^=d.charCodeAt((g+32)%d.length)),g===0&&(b=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,g>=0&&(b=b+1640531527|0,f=(h=w[127&g]^=p+b)==0?f+1:0);for(f>=128&&(w[127&(d&&d.length||0)]=-1),f=127,g=512;g>0;--g)p=w[f+34&127],h=w[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,w[f]=p^h;c.w=b,c.X=w,c.i=f}(u,o)}function i(o,u){return u.i=o.i,u.w=o.w,u.X=o.X.slice(),u}function s(o,u){o==null&&(o=+new Date);var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(d.X&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xor4096=s})(0,e)}),UM=Wu(function(e){(function(t,n,a){function r(o){var u=this,c="";u.next=function(){var h=u.b,p=u.c,f=u.d,g=u.a;return h=h<<25^h>>>7^p,p=p-f|0,f=f<<24^f>>>8^g,g=g-h|0,u.b=h=h<<20^h>>>12^p,u.c=p=p-f|0,u.d=f<<16^p>>>16^g,u.a=g-h|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,o===Math.floor(o)?(u.a=o/4294967296|0,u.b=0|o):c+=o;for(var d=0;d<c.length+20;d++)u.b^=0|c.charCodeAt(d),u.next()}function i(o,u){return u.a=o.a,u.b=o.b,u.c=o.c,u.d=o.d,u}function s(o,u){var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.tychei=s})(0,e)}),lu=Wu(function(e){(function(t,n){var a,r=this,i=256,s=6,o="random",u=n.pow(i,s),c=n.pow(2,52),d=2*c,h=i-1;function p(m,x,y){var N=[],S=b(function A(R,L){var j,D=[],B=typeof R;if(L&&B=="object")for(j in R)try{D.push(A(R[j],L-1))}catch{}return D.length?D:B=="string"?R:R+"\0"}((x=x==1?{entropy:!0}:x||{}).entropy?[m,w(t)]:m??function(){try{var A;return a&&(A=a.randomBytes)?A=A(i):(A=new Uint8Array(i),(r.crypto||r.msCrypto).getRandomValues(A)),w(A)}catch{var R=r.navigator,L=R&&R.plugins;return[+new Date,r,L,r.screen,w(t)]}}(),3),N),T=new f(N),C=function(){for(var A=T.g(s),R=u,L=0;A<c;)A=(A+L)*i,R*=i,L=T.g(1);for(;A>=d;)A/=2,R/=2,L>>>=1;return(A+L)/R};return C.int32=function(){return 0|T.g(4)},C.quick=function(){return T.g(4)/4294967296},C.double=C,b(w(T.S),t),(x.pass||y||function(A,R,L,j){return j&&(j.S&&g(j,T),A.state=function(){return g(T,{})}),L?(n[o]=A,R):A})(C,S,"global"in x?x.global:this==n,x.state)}function f(m){var x,y=m.length,N=this,S=0,T=N.i=N.j=0,C=N.S=[];for(y||(m=[y++]);S<i;)C[S]=S++;for(S=0;S<i;S++)C[S]=C[T=h&T+m[S%y]+(x=C[S])],C[T]=x;(N.g=function(A){for(var R,L=0,j=N.i,D=N.j,B=N.S;A--;)R=B[j=h&j+1],L=L*i+B[h&(B[j]=B[D=h&D+R])+(B[D]=R)];return N.i=j,N.j=D,L})(i)}function g(m,x){return x.i=m.i,x.j=m.j,x.S=m.S.slice(),x}function b(m,x){for(var y,N=m+"",S=0;S<N.length;)x[h&S]=h&(y^=19*x[h&S])+N.charCodeAt(S++);return w(x)}function w(m){return String.fromCharCode.apply(0,m)}if(n["seed"+o]=p,b(n.random(),t),e.exports){e.exports=p;try{a=require("crypto")}catch{}}})([],Math)});lu.alea=IM,lu.xor128=OM,lu.xorwow=FM,lu.xorshift7=BM,lu.xor4096=zM,lu.tychei=UM;var fv=lu.alea,J2=function(){function e(t,n,a,r,i){this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=fv(s.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,a,r=!1;!r;){var i=void 0,s=void 0,o=void 0;do o=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s;while(o>=1||o===0);var u=Math.sqrt(-2*Math.log(o)/o);n=this.mean+this.stdDev*i*u,a=this.mean+this.stdDev*s*u,this.truncated&&!this.isValidTruncated(n)||(r=!0)}return this.truncated&&!this.isValidTruncated(a)||(this.nextVal=this.convertValue(a)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),qM=function(){function e(t,n,a,r){this.alpha=t,this.beta=1/n,this.dtype=a;var i=r||Math.random();this.randu=fv(i.toString()),this.randn=new J2(0,1,a,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,a,r,i,s;;){do r=this.randn.nextValue(),s=1+this.c*r;while(s<=0);if(s*=s*s,n=1-.331*(t=r*r)*t,a=.5*t+this.d*(1-s+Math.log(s)),(i=this.randu())<n||Math.log(i)<a)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),HM=function(){function e(t,n,a,r){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=a,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=fv(r)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Et(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",Wj(e),new Bf(e,t,n)}function WM(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var Qj=he({batchToSpaceND_:function(e,t,n){var a=te(e,"x","batchToSpaceND"),r=t.reduce(function(i,s){return i*s});return se(a.rank>=1+t.length,function(){return"input rank is "+a.rank+" but should be > than blockShape.length "+t.length}),se(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),se(a.shape[0]%r==0,function(){return"input tensor batch is "+a.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+r}),be.runKernelFunc(function(i){return i.batchToSpaceND(a,t,n)},{$x:a},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),GM=he({broadcastTo_:function(e,t){var n=te(e,"broadcastTo","x"),a=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var r=n.shape.slice();r.length<t.length;)r.unshift(1);n=n.reshape(r)}for(var i=Array.from(t),s=t.length-1;s>=0;s--)if(n.shape[s]===t[s])i[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+a+"] cannot be broadcast to ["+t+"].");var o=i.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return o.length===0?n.clone():be.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(o,!0)}}})}}),VM=he({cast_:function(e,t){var n=te(e,"x","cast");if(!F8(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var a={dtype:t};return be.runKernelFunc(function(r){return r.cast(n,t)},{x:n},function(r){return{x:function(){return r.clone()}}},"Cast",a)}}),KM=he({clone_:function(e){var t=te(e,"x","clone",null);return be.runKernelFunc(function(){return be.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),$M=he({cumsum_:function(e,t,n,a){t===void 0&&(t=0),n===void 0&&(n=!1),a===void 0&&(a=!1);var r=te(e,"x","cumsum"),i=Bs([t|=0],r.rank),s=r;i!=null&&(s=r.transpose(i));var o=zs(1,r.rank)[0],u=be.runKernelFunc(function(c){return c.cumsum(s,o,n,a)},{permutedX:s},function(c){return{permutedX:function(){return c.cumsum(t,n,!a)}}});return i!=null&&(u=u.transpose(i)),u}}),YM=he({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var a=te(e,"x","depthToSpace"),r=n==="NHWC"?a.shape[1]:a.shape[2],i=n==="NHWC"?a.shape[2]:a.shape[3],s=n==="NHWC"?a.shape[3]:a.shape[1];return se(r*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+r+" and "+t+`  for depthToSpace with input shape
      `+a.shape}),se(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+a.shape}),se(s%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+a.shape}),be.runKernelFunc(function(o){return o.depthToSpace(a,t,n)},{$x:a})}}),xi=he({expandDims_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","expandDims",null);se(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var a=n.shape.slice();return t<0&&(se(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),a.splice(t,0,1),Ki(n,a)}}),Zj=he({eye_:function(e,t,n,a){a===void 0&&(a="float32"),t==null&&(t=e);for(var r=Et([e,t],a),i=e<=t?e:t,s=0;s<i;++s)r.set(1,s,s);var o=r.toTensor().as2D(e,t);if(n==null)return o;if(n.length===1)return md(xi(o,0),[n[0],1,1]);if(n.length===2)return md(xi(xi(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return md(xi(xi(xi(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),XM=he({multinomial_:function(e,t,n,a){a===void 0&&(a=!1);var r=te(e,"logits","multinomial"),i=r.size,s=r.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);n=n||Math.random();var o=s===1?r.as2D(1,-1):r,u=be.runKernelFunc(function(c){return c.multinomial(o,a,t,n)},{logits2D:o});return s===1?u.as1D():u}}),sy=he({oneHot_:function(e,t,n,a){if(n===void 0&&(n=1),a===void 0&&(a=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var r=te(e,"indices","oneHot","int32"),i=r.shape.concat([t]);return r=r.flatten(),be.runKernelFunc(function(s){return s.oneHot(r,t,n,a)},{$indices:r},function(s){return{$indices:function(){return Nn(r.shape,"float32")}}}).reshape(i)}}),Gu=he({pad_:function(e,t,n){n===void 0&&(n=0);var a=te(e,"x","pad");if(a.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var r={paddings:t,constantValue:n};return be.runKernelFunc(function(i){return i.pad(a,t,n)},{x:a},function(i){var s=t.map(function(o){return o[0]});return{x:function(){return i.slice(s,a.shape)}}},"PadV2",r)}}),JM=he({pad1d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Gu(e,[t],n)}}),QM=he({pad2d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),ZM=he({pad3d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),e7=he({pad4d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),t7=he({rand_:function(e,t,n){var a=ht(e),r=null;if(n==null||n==="float32")r=new Float32Array(a);else if(n==="int32")r=new Int32Array(a);else{if(n!=="bool")throw new Error("Unknown data type "+n);r=new Uint8Array(a)}for(var i=0;i<a;i++)r[i]=t();return be.makeTensor(r,e,n)}}),n7=he({randomNormal_:function(e,t,n,a,r){if(t===void 0&&(t=0),n===void 0&&(n=1),a!=null&&a==="bool")throw new Error("Unsupported data type "+a);for(var i=new J2(t,n,a,!1,r),s=Et(e,a),o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),a7=he({randomGamma_:function(e,t,n,a,r){if(n===void 0&&(n=1),a===void 0&&(a="float32"),n==null&&(n=1),a==null&&(a="float32"),a!=="float32"&&a!=="int32")throw new Error("Unsupported data type "+a);for(var i=new qM(t,n,a,r),s=Et(e,a),o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),e6=he({randomUniform_:function(e,t,n,a,r){t===void 0&&(t=0),n===void 0&&(n=1),a===void 0&&(a="float32");for(var i=Et(e,a),s=new HM(t,n,null,r),o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}}),Ki=he({reshape_:function(e,t){var n=te(e,"x","reshape",null);t=I8(t,n.size),se(n.size===ht(t),function(){return"new shape and old shape must have the same number of elements."});var a={shape:t};return be.runKernelFunc(function(r){return r.reshape(n,t)},{x:n},function(r){return{x:function(){return r.reshape(n.shape)}}},"Reshape",a)}}),t6=he({spaceToBatchND_:function(e,t,n){var a=te(e,"x","spaceToBatchND");return se(a.rank>=1+t.length,function(){return"input rank "+a.rank+" should be > than [blockShape] "+t.length}),se(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),se(a.shape.reduce(function(r,i,s){return s>0&&s<=t.length?r&&(i+n[s-1][0]+n[s-1][1])%t[s-1]==0:r},!0),function(){return"input spatial dimensions "+a.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),be.runKernelFunc(function(r){return r.spaceToBatchND(a,t,n)},{$x:a},function(r){return{$x:function(){return r.batchToSpaceND(t,n)}}})}}),n6=he({squeeze_:function(e,t){var n=te(e,"x","squeeze");return Ki(n,du(n.shape,t).newShape)}}),ei=he({stack_:function(e,t){t===void 0&&(t=0);var n=h0(e,"tensors","stack");if(se(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var a=n[0].rank,r=n[0].shape,i=n[0].dtype;se(t<=a,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(o){tn(r,o.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(o){se(i===o.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=n.map(function(o){return o.expandDims(t)});return pa(s,t)}}),md=he({tile_:function(e,t){var n=te(e,"x","tile",null);se(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var a=[n],r={reps:t};return be.runKernelFunc(function(i,s){var o=i.tile(n,t);return s([n]),o},{x:n},function(i,s){var o=s[0];return{x:function(){var u=Wt(o);if(o.rank===1)for(var c=0;c<t[0];++c)u=u.add(i.slice([c*o.shape[0]],[o.shape[0]]));else if(o.rank===2)for(c=0;c<t[0];++c)for(var d=0;d<t[1];++d)u=u.add(i.slice([c*o.shape[0],d*o.shape[1]],[o.shape[0],o.shape[1]]));else if(o.rank===3)for(c=0;c<t[0];++c)for(d=0;d<t[1];++d)for(var h=0;h<t[2];++h)u=u.add(i.slice([c*o.shape[0],d*o.shape[1],h*o.shape[2]],[o.shape[0],o.shape[1],o.shape[2]]));else{if(o.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+o.rank+" tensors yet.");for(c=0;c<t[0];++c)for(d=0;d<t[1];++d)for(h=0;h<t[2];++h)for(var p=0;p<t[3];++p)u=u.add(i.slice([c*o.shape[0],d*o.shape[1],h*o.shape[2],p*o.shape[3]],[o.shape[0],o.shape[1],o.shape[2],o.shape[3]]))}return u}}},"Tile",r,a)}}),r7=he({truncatedNormal_:function(e,t,n,a,r){if(t===void 0&&(t=0),n===void 0&&(n=1),a!=null&&a==="bool")throw new Error("Unsupported data type "+a);for(var i=new J2(t,n,a,!0,r),s=Et(e,a),o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),ma=he({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=te(e,"x","unstack");se(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var a={axis:t};return be.runKernelFunc(function(r){return r.unstack(n,t)},{x:n},function(r){return{x:function(){return ei(r,t)}}},"Unpack",a)}}),i7=function(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h;return ut(this,function(p){switch(p.label){case 0:return n=te(e,"x","setdiff1d"),a=te(t,"y","setdiff1d"),se(n.dtype===a.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+a.dtype+")."}),se(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),se(a.rank===1,function(){return"y should be 1D tensor, but got y ("+a.shape+")."}),[4,n.data()];case 1:return r=p.sent(),[4,a.data()];case 2:for(i=p.sent(),s=new Set(i),o=0,d=0;d<r.length;d++)s.has(r[d])||o++;for(u=new Bf([o],n.dtype),c=new Bf([o],"int32"),d=0,h=0;d<r.length;d++)s.has(r[d])||(u.values[h]=r[d],c.values[h]=d,h++);return[2,[u.toTensor(),c.toTensor()]]}})})};function p0(e,t,n,a){a===void 0&&(a=!0);var r=[];if(a)(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);for(var i=t.length,s=0;s<i;++s)r=r.concat([e[s+1]/t[s],t[s]]);r=r.concat(e.slice(i+1))}return r}function m0(e,t,n){n===void 0&&(n=!0);var a=[];if(n){a.push(t);for(var r=t+1;r<e;++r)r<=2*t?(a.push(r),a.push(r-(t+1))):a.push(r)}else{var i=[],s=[];for(r=1;r<e;++r)r>=2*t+1||r%2==1?s.push(r):i.push(r);a.push.apply(a,i),a.push(0),a.push.apply(a,s)}return a}function g0(e,t,n,a){a===void 0&&(a=!0);var r=[];a?r.push(e[0]/n):r.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?a?r.push(t[i-1]*e[i]):r.push(e[i]/t[i-1]):r.push(e[i]);return r}function a6(e,t){for(var n=[0],a=0;a<t;++a)n.push(e[a][0]);return n}function r6(e,t,n){for(var a=e.slice(0,1),r=0;r<n;++r)a.push(e[r+1]-t[r][0]-t[r][1]);return a}function i6(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,a=n[n.length-1],r=1,i=0;i<n.length-1;++i)r*=n[i];var s=e.shape,o=n.slice();o.pop();var u=1;for(i=a;i<e.rank;++i)u*=s[i],o.push(s[i]);var c=Ds(e.shape).map(function(d){return d/u}).concat([1]).slice(0,a);return[o,r,u,c]}var s6=30;function gb(e){return e<=s6?e:ey(e,Math.floor(Math.sqrt(e)))}function s7(e,t,n){var a=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+a+", and batchDim: "+r+".";if(n.rank<r)throw new Error(i+" update.rank < "+r+". ");if(e.length<a+(n.rank-r))throw new Error(i+" Output shape length < "+(a+(n.rank-r)));if(n.rank!==r+e.length-a)throw new Error(i+" update.rank != "+(r+e.length-a));for(var s=0;s<r;++s)if(n.shape[s]!==t.shape[s])throw new Error(i+" updates.shape["+s+"] ("+n.shape[s]+") != indices.shape["+s+"] ("+t.shape[s]+").");for(s=0;s<n.rank-r;++s)if(n.shape[s+r]!==e[s+a])throw new Error(i+" updates.shape["+(s+r)+"] ("+n.shape[s+r]+") != shape["+(s+r)+"] ("+e[s+r]+")")}function o7(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}s7(n,t,e)}function v0(e,t,n){for(var a=t.shape.length,r=a>1?t.shape[a-1]:1,i=n.length,s=1,o=r;o<i;++o)s*=n[o];var u=r<1?1:r;return{sliceRank:r,numUpdates:ht(t.shape)/u,sliceSize:s,strides:Ds(n.slice(0,r)).concat([1]),outputSize:ht(n)}}function l7(e,t,n){se(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),se(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var a=function(i){se(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},r=0;r<e.rank;++r)a(r)}function b3(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Q2(e,t,n){for(var a=[],r=0;r<e.length;r++)a[r]=Math.ceil((t[r]-e[r])/n[r]);return a}function u7(e,t,n,a,r){var i=t[r],s=n[r]||1;(e&1<<r||i==null)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var o=a[r];return i<0&&(i+=o),i=J1(0,i,o-1)}function c7(e,t,n,a,r){var i=t[r],s=n[r]||1;(e&1<<r||i==null)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var o=a[r];return i<0&&(i+=o),i=s>0?J1(0,i,o):J1(-1,i,o-1)}function o6(e,t,n){for(var a=n.length,r=0;r<n.length;r++)if(n[r]>1){a=r;break}for(r=a+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function l6(e,t){for(var n=e.length>0?e[e.length-1]:1,a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}function d7(e,t){se(Z1(e),function(){return"The f passed in variableGrads(f) must be a function"}),se(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof zd}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var a in t=[],be.registeredVariables)t.push(be.registeredVariables[a]);var r=n?t.filter(function(d){return!d.trainable}):null,i=t.length;se((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=be.gradients(e,t,null,!0),o=s.value,u=s.grads;se(u.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),se(o.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+o.rank+" tensor"});var c={};return t.forEach(function(d,h){u[h]!=null&&(c[d.name]=u[h])}),r!=null&&r.forEach(function(d){return c[d.name]=null}),{value:o,grads:c}}function pv(e){return be.customGrad(e)}var _o=he({softmax_:function(e,t){t===void 0&&(t=-1);var n=te(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return be.runKernelFunc(function(a,r){var i=a.softmax(n,t);return r([i]),i},{logits:n},function(a,r){var i=r[0],s=a.mul(i);return{logits:function(){return s.sub(s.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),h7=he({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=te(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return pv(function(a,r){var i=a.max(t,!0),s=a.sub(i),o=s.toFloat().sub(s.exp().sum(t,!0).log());return r([o]),{value:o,gradFunc:function(u,c){var d=c[0].exp();return u.sub(u.sum(t,!0).mul(d))}}})(n)}}),u6=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),c6=function(){function e(){}return e.prototype.time=function(t){return Ee("time")},e.prototype.read=function(t){return Ee("read")},e.prototype.readSync=function(t){return Ee("readSync")},e.prototype.numDataIds=function(){return Ee("numDataIds")},e.prototype.disposeData=function(t){return Ee("disposeData")},e.prototype.write=function(t,n,a){return Ee("write")},e.prototype.move=function(t,n,a,r){return Ee("move")},e.prototype.memory=function(){return Ee("memory")},e.prototype.floatPrecision=function(){return Ee("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,a,r){return Ee("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,Ee("fusedBatchMatMul")},e.prototype.slice=function(t,n,a){return Ee("slice")},e.prototype.stridedSlice=function(t,n,a,r){return Ee("stridedSlice")},e.prototype.unstack=function(t,n){return Ee("unstack")},e.prototype.reverse=function(t,n){return Ee("reverse")},e.prototype.concat=function(t,n){return Ee("concat")},e.prototype.neg=function(t){return Ee("neg")},e.prototype.add=function(t,n){return Ee("add")},e.prototype.addN=function(t){return Ee("addN")},e.prototype.subtract=function(t,n){return Ee("subtract")},e.prototype.multiply=function(t,n){return Ee("multiply")},e.prototype.realDivide=function(t,n){return Ee("realDivide")},e.prototype.floorDiv=function(t,n){return Ee("floorDiv")},e.prototype.sum=function(t,n){return Ee("sum")},e.prototype.prod=function(t,n){return Ee("prod")},e.prototype.unsortedSegmentSum=function(t,n,a){return Ee("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return Ee("argMin")},e.prototype.argMax=function(t,n){return Ee("argMax")},e.prototype.equal=function(t,n){return Ee("equal")},e.prototype.notEqual=function(t,n){return Ee("notEqual")},e.prototype.less=function(t,n){return Ee("less")},e.prototype.lessEqual=function(t,n){return Ee("lessEqual")},e.prototype.greater=function(t,n){return Ee("greater")},e.prototype.greaterEqual=function(t,n){return Ee("greaterEqual")},e.prototype.logicalNot=function(t){return Ee("logicalNot")},e.prototype.logicalAnd=function(t,n){return Ee("logicalAnd")},e.prototype.logicalOr=function(t,n){return Ee("logicalOr")},e.prototype.where=function(t){return Ee("where")},e.prototype.select=function(t,n,a){return Ee("select")},e.prototype.topk=function(t,n,a){return Ee("topk")},e.prototype.min=function(t,n){return Ee("min")},e.prototype.minimum=function(t,n){return Ee("minimum")},e.prototype.mod=function(t,n){return Ee("mod")},e.prototype.max=function(t,n){return Ee("max")},e.prototype.maximum=function(t,n){return Ee("maximum")},e.prototype.all=function(t,n){return Ee("all")},e.prototype.any=function(t,n){return Ee("any")},e.prototype.squaredDifference=function(t,n){return Ee("squaredDifference")},e.prototype.ceil=function(t){return Ee("ceil")},e.prototype.floor=function(t){return Ee("floor")},e.prototype.round=function(t){return Ee("round")},e.prototype.sign=function(t){return Ee("sign")},e.prototype.isNaN=function(t){return Ee("isNaN")},e.prototype.isInf=function(t){return Ee("isInf")},e.prototype.isFinite=function(t){return Ee("isFinite")},e.prototype.pow=function(t,n){return Ee("pow")},e.prototype.exp=function(t){return Ee("exp")},e.prototype.expm1=function(t){return Ee("expm1")},e.prototype.softmax=function(t,n){return Ee("softmax")},e.prototype.log=function(t){return Ee("log")},e.prototype.log1p=function(t){return Ee("log1p")},e.prototype.sqrt=function(t){return Ee("sqrt")},e.prototype.rsqrt=function(t){return Ee("rsqrt")},e.prototype.square=function(t){return Ee("square")},e.prototype.reciprocal=function(t){return Ee("reciprocal")},e.prototype.relu=function(t){return Ee("relu")},e.prototype.relu6=function(t){return Ee("relu6")},e.prototype.prelu=function(t,n){return Ee("prelu")},e.prototype.elu=function(t){return Ee("elu")},e.prototype.eluDer=function(t,n){return Ee("eluDer")},e.prototype.selu=function(t){return Ee("selu")},e.prototype.int=function(t){return Ee("int")},e.prototype.clip=function(t,n,a){return Ee("clip")},e.prototype.abs=function(t){return Ee("abs")},e.prototype.complexAbs=function(t){return Ee("complexAbs")},e.prototype.sigmoid=function(t){return Ee("sigmoid")},e.prototype.softplus=function(t){return Ee("softplus")},e.prototype.sin=function(t){return Ee("sin")},e.prototype.cos=function(t){return Ee("cos")},e.prototype.tan=function(t){return Ee("tan")},e.prototype.asin=function(t){return Ee("asin")},e.prototype.acos=function(t){return Ee("acos")},e.prototype.atan=function(t){return Ee("atan")},e.prototype.atan2=function(t,n){return Ee("atan2")},e.prototype.sinh=function(t){return Ee("sinh")},e.prototype.cosh=function(t){return Ee("cosh")},e.prototype.tanh=function(t){return Ee("tanh")},e.prototype.asinh=function(t){return Ee("asinh")},e.prototype.acosh=function(t){return Ee("acosh")},e.prototype.atanh=function(t){return Ee("atanh")},e.prototype.erf=function(t){return Ee("erf")},e.prototype.step=function(t,n){return Ee("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Ee("fusedConv2d")},e.prototype.conv2d=function(t,n,a){return Ee("conv2d")},e.prototype.conv2dDerInput=function(t,n,a){return Ee("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,a){return Ee("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Ee("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,a){return Ee("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,a){return Ee("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,a){return Ee("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,a){return Ee("conv3d")},e.prototype.conv3dDerInput=function(t,n,a){return Ee("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,a){return Ee("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return Ee("maxPool")},e.prototype.maxPoolBackprop=function(t,n,a,r){return Ee("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return Ee("avgPool")},e.prototype.avgPoolBackprop=function(t,n,a){return Ee("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return Ee("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,a){return Ee("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return Ee("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,a,r){return Ee("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return Ee("reshape")},e.prototype.cast=function(t,n){return Ee("cast")},e.prototype.tile=function(t,n){return Ee("tile")},e.prototype.pad=function(t,n,a){return Ee("pad")},e.prototype.transpose=function(t,n){return Ee("transpose")},e.prototype.gather=function(t,n,a){return Ee("gather")},e.prototype.gatherND=function(t,n){return Ee("gatherND")},e.prototype.scatterND=function(t,n,a){return Ee("scatterND")},e.prototype.batchToSpaceND=function(t,n,a){return Ee("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,a){return Ee("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,a,r){return Ee("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,a){return Ee("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,a,r){return Ee("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,a){return Ee("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,a,r,i,s){return Ee("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,a,r,i){return Ee("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,a,r,i,s,o){return Ee("LRNGrad")},e.prototype.multinomial=function(t,n,a,r){return Ee("multinomial")},e.prototype.oneHot=function(t,n,a,r){return Ee("oneHot")},e.prototype.cumsum=function(t,n,a,r){return Ee("cumsum")},e.prototype.nonMaxSuppression=function(t,n,a,r,i){return Ee("nonMaxSuppression")},e.prototype.fft=function(t){return Ee("fft")},e.prototype.ifft=function(t){return Ee("ifft")},e.prototype.complex=function(t,n){return Ee("complex")},e.prototype.real=function(t){return Ee("real")},e.prototype.imag=function(t){return Ee("imag")},e.prototype.cropAndResize=function(t,n,a,r,i,s){return Ee("cropAndResize")},e.prototype.depthToSpace=function(t,n,a){return Ee("depthToSpace")},e.prototype.split=function(t,n,a){return Ee("split")},e.prototype.sparseToDense=function(t,n,a,r){return Ee("sparseToDense")},e.prototype.diag=function(t){return Ee("diag")},e.prototype.fill=function(t,n,a){return Ee("fill")},e.prototype.onesLike=function(t){return Ee("onesLike")},e.prototype.zerosLike=function(t){return Ee("zerosLike")},e.prototype.linspace=function(t,n,a){return Ee("linspace")},e.prototype.dispose=function(){return Ee("dispose")},e}();function Ee(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function hl(e,t){for(var n=e.length,a=[],r=0;r<n;r++){var i=n-1-r,s=e[i]||1;(t[t.length-1-r]||1)>1&&s===1&&a.unshift(i)}return a}function va(e,t){for(var n=[],a=0;a<t.length;a++){var r=e[e.length-a-1],i=t.length-a-1,s=t[i];(r==null||r===1&&s>1)&&n.unshift(i)}return n}function zt(e,t){for(var n=[],a=Math.max(e.length,t.length),r=0;r<a;r++){var i=e[e.length-r-1];i==null&&(i=1);var s=t[t.length-r-1];if(s==null&&(s=1),i===1)n.unshift(s);else if(s===1)n.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Uf(e,t,n,a,r,i,s){s===void 0&&(s="channelsLast");var o,u=y0(t),c=u[0],d=u[1];if(s==="channelsLast")o=[c,d,e[3],e[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);o=[c,d,e[1],e[1]]}return Vu(e,o,n,a,r,i,!1,s)}function x0(e,t,n,a,r,i,s){s===void 0&&(s="NDHWC");var o,u,c=oy(t),d=c[0],h=c[1],p=c[2];if(s==="NDHWC")u="channelsLast",o=[d,h,p,e[4],e[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);u="channelsFirst",o=[d,h,p,e[1],e[1]]}return b0(e,o,n,a,r,!1,u,i)}function Vu(e,t,n,a,r,i,s,o){s===void 0&&(s=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1],c=u[0],d=u[1],h=u[2],p=u[3];if(o==="channelsLast")c=e[0],d=e[1],h=e[2],p=e[3];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);c=e[0],p=e[1],d=e[2],h=e[3]}var f,g=t[0],b=t[1],w=t[3],m=y0(n),x=m[0],y=m[1],N=y0(a),S=N[0],T=N[1],C=gd(g,S),A=gd(b,T),R=function(z,U,I,F,q,O,$,Z){var P,W,K;if(typeof z=="number"){P={top:z,bottom:z,left:z,right:z,type:z===0?"VALID":"NUMBER"};var J=function(ve,De,Re,we,xe){we==null&&(we=d6(ve,De,Re));var ne=ve[0],Qe=ve[1],Je=gf((ne-De+2*we)/Re+1,xe);se(Qn(Je),function(){return"The output # of rows ("+Je+") must be an integer. Change the stride and/or zero pad parameters"});var Ae=gf((Qe-De+2*we)/Re+1,xe);return se(Qn(Ae),function(){return"The output # of columns ("+Ae+") must be an integer. Change the stride and/or zero pad parameters"}),[Je,Ae]}([U,I],O,F,z,Z);W=J[0],K=J[1]}else if(z==="same"){W=Math.ceil(U/F),K=Math.ceil(I/q);var H=Math.max(0,(W-1)*F+O-U),ie=Math.max(0,(K-1)*q+$-I),ue=Math.floor(H/2),ce=H-ue,pe=Math.floor(ie/2);P={top:ue,bottom:ce,left:pe,right:ie-pe,type:"SAME"}}else{if(z!=="valid")throw Error("Unknown padding parameter: "+z);P={top:0,bottom:0,left:0,right:0,type:"VALID"},W=Math.ceil((U-O+1)/F),K=Math.ceil((I-$+1)/q)}return{padInfo:P,outHeight:W,outWidth:K}}(r,d,h,x,y,C,A,i),L=R.padInfo,j=R.outHeight,D=R.outWidth,B=s?w*p:w;return o==="channelsFirst"?f=[c,B,j,D]:o==="channelsLast"&&(f=[c,j,D,B]),{batchSize:c,dataFormat:o,inHeight:d,inWidth:h,inChannels:p,outHeight:j,outWidth:D,outChannels:B,padInfo:L,strideHeight:x,strideWidth:y,filterHeight:g,filterWidth:b,effectiveFilterHeight:C,effectiveFilterWidth:A,dilationHeight:S,dilationWidth:T,inShape:e,outShape:f,filterShape:t}}function b0(e,t,n,a,r,i,s,o){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],d=u[1],h=u[2],p=u[3],f=u[4];if(s==="channelsLast")c=e[0],d=e[1],h=e[2],p=e[3],f=e[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);c=e[0],f=e[1],d=e[2],h=e[3],p=e[4]}var g,b=t[0],w=t[1],m=t[2],x=t[4],y=oy(n),N=y[0],S=y[1],T=y[2],C=oy(a),A=C[0],R=C[1],L=C[2],j=gd(b,A),D=gd(w,R),B=gd(m,L),z=function($,Z,P,W,K,J,H,ie,ue,ce,pe){var ve,De,Re,we;if(typeof $=="number"){ve={top:$,bottom:$,left:$,right:$,front:$,back:$,type:$===0?"VALID":"NUMBER"};var xe=function(Fe,Ze,Xe,oe,Be,Ke){Be==null&&(Be=d6(Fe,Ze,oe));var et=Fe[0],He=Fe[1],wt=Fe[2],dt=gf((et-Ze+2*Be)/oe+1,Ke);se(Qn(dt),function(){return"The output # of depths ("+dt+") must be an integer. Change the stride and/or zero pad parameters"});var _n=gf((He-Ze+2*Be)/oe+1,Ke);se(Qn(_n),function(){return"The output # of rows ("+_n+") must be an integer. Change the stride and/or zero pad parameters"});var Rt=gf((wt-Ze+2*Be)/oe+1,Ke);return se(Qn(Rt),function(){return"The output # of columns ("+Rt+") must be an integer. Change the stride and/or zero pad parameters"}),[dt,_n,Rt,Xe]}([Z,P,W,1],ie,1,K,$,pe);De=xe[0],Re=xe[1],we=xe[2]}else if($==="same"){De=Math.ceil(Z/K),Re=Math.ceil(P/J),we=Math.ceil(W/H);var ne=(De-1)*K+ie-Z,Qe=(Re-1)*J+ue-P,Je=(we-1)*H+ce-W,Ae=Math.floor(ne/2),Ge=ne-Ae,_e=Math.floor(Qe/2),de=Qe-_e,ke=Math.floor(Je/2);ve={top:_e,bottom:de,left:ke,right:Je-ke,front:Ae,back:Ge,type:"SAME"}}else{if($!=="valid")throw Error("Unknown padding parameter: "+$);ve={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},De=Math.ceil((Z-ie+1)/K),Re=Math.ceil((P-ue+1)/J),we=Math.ceil((W-ce+1)/H)}return{padInfo:ve,outDepth:De,outHeight:Re,outWidth:we}}(r,d,h,p,N,S,T,j,D,B,o),U=z.padInfo,I=z.outDepth,F=z.outHeight,q=z.outWidth,O=i?x*f:x;return s==="channelsFirst"?g=[c,O,I,F,q]:s==="channelsLast"&&(g=[c,I,F,q,O]),{batchSize:c,dataFormat:s,inDepth:d,inHeight:h,inWidth:p,inChannels:f,outDepth:I,outHeight:F,outWidth:q,outChannels:O,padInfo:U,strideDepth:N,strideHeight:S,strideWidth:T,filterDepth:b,filterHeight:w,filterWidth:m,effectiveFilterDepth:j,effectiveFilterHeight:D,effectiveFilterWidth:B,dilationDepth:A,dilationHeight:R,dilationWidth:L,inShape:e,outShape:g,filterShape:t}}function d6(e,t,n,a){a===void 0&&(a=1);var r=gd(t,a);return Math.floor((e[0]*(n-1)-n+r)/2)}function y0(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function oy(e){return typeof e=="number"?[e,e,e]:e}function gd(e,t){return t<=1?e:e+(e-1)*(t-1)}function gf(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function qd(e){var t=y0(e),n=t[0],a=t[1],r=t[2];return n===1&&a===1&&r===1}function Dr(e,t){return qd(e)||qd(t)}function Z2(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function h6(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var a=Nn(e.shape),r=e.toFloat(),i=n.complex(r,a);return a.dispose(),r.dispose(),i}if(!B8(e.dtype,t))return be.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var s=n.real(e);return i=s.cast(t),s.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var o=at(0,e.dtype);return i=n.notEqual(e,o),o.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function ly(e,t){return be.makeTensorFromDataId(e.dataId,t,e.dtype)}function f6(e,t,n){var a=(t-e)/(n-1),r=yp(n,"float32");r[0]=e;for(var i=1;i<r.length;i++)r[i]=r[i-1]+a;return ia(r,"float32")}function uy(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function y3(e,t){return{real:e[2*t],imag:e[2*t+1]}}function f7(e,t,n,a){e[2*a]=t,e[2*a+1]=n}function p7(e,t,n){var a=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(a),imag:Math.sin(a)}}function m7(e,t,n){var a=function(i,s,o){return function(u,c,d){for(var h=0,p=u.length,f=0,g=!1;h<p;){var b=d(c,u[f=h+(p-h>>>1)]);b>0?h=f+1:(p=f,g=!b)}return g?h:-h-1}(i,s,o||g7)}(e,t,n),r=a<0?-(a+1):a;e.splice(r,0,t)}function g7(e,t){return e>t?1:e<t?-1:0}function ew(e,t,n,a,r){return p6(e,t,n,a,r,0).selectedIndices}function tw(e,t,n,a,r,i){var s=p6(e,t,n,a,r,i);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function p6(e,t,n,a,r,i,s,o){o===void 0&&(o=!1);for(var u=Array.from(t).map(function(N,S){return{score:N,boxIndex:S,suppressBeginIndex:0}}).filter(function(N){return N.score>r}).sort(w3),c=i>0?-.5/i:0,d=[],h=[];d.length<n&&u.length>0;){var p=u.pop(),f=p.score,g=p.boxIndex,b=p.suppressBeginIndex;if(f<r)break;for(var w=!1,m=d.length-1;m>=b;--m){var x=v7(e,g,d[m]);if(x>=a){w=!0;break}if(p.score=p.score*x7(a,c,x),p.score<=r)break}p.suppressBeginIndex=d.length,w||(p.score===f?(d.push(g),h.push(p.score)):p.score>r&&m7(u,p,w3))}var y=d.length;return o&&(d.fill(0,y),h.fill(0,y)),{selectedIndices:ia(d,"int32"),selectedScores:ia(h,"float32"),numValidOutputs:at(y,"int32")}}function v7(e,t,n){var a=e.subarray(4*t,4*t+4),r=e.subarray(4*n,4*n+4),i=Math.min(a[0],a[2]),s=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),u=Math.max(a[1],a[3]),c=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),f=(o-i)*(u-s),g=(h-c)*(p-d);if(f<=0||g<=0)return 0;var b=Math.max(i,c),w=Math.max(s,d),m=Math.min(o,h),x=Math.min(u,p),y=Math.max(m-b,0)*Math.max(x-w,0);return y/(f+g-y)}function x7(e,t,n){var a=Math.exp(t*n*n);return n<=e?a:0}function w3(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function m6(e,t,n){var a=new Array(e.rank).fill(0),r=e.shape.slice();return t.map(function(i){r[n]=i;var s=e.slice(a,r);return a[n]+=i,s})}function g6(e,t){for(var n=new Array(e.rank),a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];var r=Et(n,e.dtype);for(a=0;a<r.values.length;++a){for(var i=r.indexToLoc(a),s=new Array(e.rank),o=0;o<s.length;o++)s[o]=i[o]%e.shape[o];var u=e.locToIndex(s);r.values[a]=e.values[u]}return r.toTensor()}function v6(e,t,n,a,r){for(var i=t[t.length-1],s=[e.length/i,i],o=s[0],u=s[1],c=Ff(n,o*a),d=Ff("int32",o*a),h=0;h<o;h++){for(var p=h*u,f=e.subarray(p,p+u),g=[],b=0;b<f.length;b++)g.push({value:f[b],index:b});g.sort(function(N,S){return S.value-N.value});var w=h*a,m=c.subarray(w,w+a),x=d.subarray(w,w+a);for(b=0;b<a;b++)m[b]=g[b].value,x[b]=g[b].index}var y=t.slice();return y[y.length-1]=a,[Fa(c,y,n),Fa(d,y,"int32")]}function nw(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);var r=Et(e,"int32"),i=Et([n.length,e.length],"int32");for(a=0;a<n.length;a++){var s=r.indexToLoc(n[a]),o=a*e.length;i.values.set(s,o)}return i.toTensor()}var b7=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(r,i){return"T"+i});var n=[];this.variableNames.forEach(function(r){n.push("float v"+r+" = get"+r+"AtOutCoords();")});var a=this.variableNames.map(function(r){return"v"+r}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+a+`;
        setOutput(result);
      }
    `},y7=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(r,i){return"T"+i});var n=[];this.variableNames.forEach(function(r){n.push("vec4 v"+r+" = get"+r+"AtOutCoords();")});var a=this.variableNames.map(function(r){return"v"+r}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+a+`;
        setOutput(result);
      }
    `},w7=function(e,t,n){this.variableNames=["A"];var a=e.windowSize,r=e.batchSize,i=e.inSize,s=Math.ceil(i/a);n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,s];var o=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+a+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+a+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+o+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function x6(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function _r(e,t){return t===1?[e]:x6(e,t)}function Xa(){var e,t,n,a,r,i,s,o,u,c;return Oe().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",a="in",r="texture",i="outputColor",s="out vec4 outputColor;",o=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",a="varying",r="texture2D",i="gl_FragColor",s="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:r,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:u,defineRound:c}}function hu(e,t,n){n===void 0&&(n="index");var a=Ds(t);return a.map(function(r,i){return"int "+e[i]+" = "+n+" / "+r+"; "+(i===a.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+r:"index -= "+e[i]+" * "+r)+";"}).join("")}function aw(e){var t=Ds(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var b6=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function N7(e,t,n,a){var r=[];e.forEach(function(f){var g=ht(f.shapeInfo.logicalShape);f.shapeInfo.isUniform?r.push("uniform float "+f.name+(g>1?"["+g+"]":"")+";"):(r.push("uniform sampler2D "+f.name+";"),r.push("uniform int offset"+f.name+";"))});var i,s,o=r.join(`
`),u=e.map(function(f){return function(g,b,w){w===void 0&&(w=!1);var m="";m+=w?y6(g):Fc(g);var x=g.shapeInfo.logicalShape,y=b.logicalShape;return x.length<=y.length&&(m+=w?function(N,S){var T,C=N.name,A=C.charAt(0).toUpperCase()+C.slice(1),R="get"+A+"AtOutCoords",L=N.shapeInfo.logicalShape.length,j=S.logicalShape.length,D=hl(N.shapeInfo.logicalShape,S.logicalShape),B=wn(j),z=j-L,U=["x","y","z","w","u","v"];T=L===0?"":j<2&&D.length>=1?"coords = 0;":D.map(function(P){return"coords."+U[P+z]+" = 0;"}).join(`
`);var I="";I=j<2&&L>0?"coords":N.shapeInfo.logicalShape.map(function(P,W){return"coords."+U[W+z]}).join(", ");var F="return outputValue;",q=ht(N.shapeInfo.logicalShape)===1,O=ht(S.logicalShape)===1;if(L!==1||q||O){if(q&&!O)F=j===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(D.length){var $=L-2,Z=L-1;D.indexOf($)>-1&&D.indexOf(Z)>-1?F="return vec4(outputValue.x);":D.indexOf($)>-1?F="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":D.indexOf(Z)>-1&&(F="return vec4(outputValue.xx, outputValue.zz);")}}else F=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+R+`() {
      `+B+` coords = getOutputCoords();
      `+T+`
      vec4 outputValue = get`+A+"("+I+`);
      `+F+`
    }
  `}(g,b):function(N,S){var T=N.name,C=T.charAt(0).toUpperCase()+T.slice(1),A="get"+C+"AtOutCoords",R=S.texShape,L=N.shapeInfo.texShape,j=N.shapeInfo.logicalShape.length,D=S.logicalShape.length;if(!N.shapeInfo.isUniform&&j===D&&N.shapeInfo.flatOffset==null&&Aa(L,R))return`
      float `+A+`() {
        return sampleTexture(`+T+`, resultUV);
      }
    `;var B,z=wn(D),U=hl(N.shapeInfo.logicalShape,S.logicalShape),I=D-j,F=["x","y","z","w","u","v"];B=j===0?"":D<2&&U.length>=1?"coords = 0;":U.map(function(O){return"coords."+F[O+I]+" = 0;"}).join(`
`);var q="";return q=D<2&&j>0?"coords":N.shapeInfo.logicalShape.map(function(O,$){return"coords."+F[$+I]}).join(", "),`
    float `+A+`() {
      `+z+` coords = getOutputCoords();
      `+B+`
      return get`+C+"("+q+`);
    }
  `}(g,b)),m}(f,t,a)}).join(`
`),c=t.texShape,d=Xa(),h=function(f){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+f.texture2D+`(textureSampler, uv).r;
    }
  `}(d),p=function(f){return f.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+f.varyingFs+` vec2 resultUV;
    `+f.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+f.defineSpecialNaN+`
    `+f.defineSpecialInf+`
    `+f.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+k7+`
    `+S7+`
    `+_7+`
  `}(d);return t.isPacked?(i=function(f,g){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(N,S){var T=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];return T[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+T[1]+`.0);
      }
    `:T[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+T[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      return 2 * (resTexRC.x * `+T[1]+` + resTexRC.y);
    }
  `}(0,g);case 2:return function(N,S){var T=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];if(Aa(N,S))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+T[0]+", "+T[1]+`));
      }
    `;var C=Math.ceil(N[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));

      int index = resTexRC.x * `+T[1]+` + resTexRC.y;
      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec2(r, c);
    }
  `}(f,g);case 3:return b=f,w=g,m=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],x=Math.ceil(b[2]/2),y=x*Math.ceil(b[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+y+`;
      index -= b * `+y+`;

      int r = 2 * (index / `+x+`);
      int c = imod(index, `+x+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(N,S){for(var T=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],C=Math.ceil(N[N.length-1]/2),A=C*Math.ceil(N[N.length-2]/2),R=A,L="",j="b, r, c",D=2;D<N.length-1;D++)R*=N[N.length-D-1],L=`
      int b`+D+" = index / "+R+`;
      index -= b`+D+" * "+R+`;
    `+L,j="b"+D+", "+j;return`
    ivec`+N.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;

      `+L+`

      int b = index / `+A+`;
      index -= b * `+A+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec`+N.length+"("+j+`);
    }
  `}(f,g)}var b,w,m,x,y}(t.logicalShape,c),s=function(f){return`
    void setOutput(vec4 val) {
      `+f.output+` = val;
    }
  `}(d)):(i=function(f,g){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,x){return x[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+x[1]+`.0);
      }
    `:x[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+x[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      return resTexRC.x * `+x[1]+` + resTexRC.y;
    }
  `}(0,g);case 2:return function(m,x){return Aa(m,x)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+x[0]+", "+x[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(f,g);case 3:return b=g,w=hu(["r","c","d"],f),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      `+w+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,x){var y=hu(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      `+y+`
      return ivec4(r, c, d, d2);
    }
  `}(f,g);case 5:return function(m,x){var y=hu(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+x[0]+`,
                             `+x[1]+`));

      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+y+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(f,g);case 6:return function(m,x){var y=hu(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+y+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(f,g);default:throw new Error(f.length+"-D output sampling is not yet supported")}var b,w}(t.logicalShape,c),s=function(f){return`
    void setOutput(float val) {
      `+f.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),a&&(p+=j7),[p,h,s,o,i,u,n].join(`
`)}function Fc(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var a=n.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1);if(n.shapeInfo.isUniform)return"float "+r+"() {return "+a+";}";var i=n.shapeInfo.texShape,s=i[0],o=i[1];if(s===1&&o===1)return`
      float `+r+`() {
        return sampleTexture(`+a+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,c=u[0],d=u[1],h=au(a);return`
    float `+r+`() {
      vec2 uv = uvFromFlat(`+c+", "+d+", "+h+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 1:return function(n){var a=n.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1);if(n.shapeInfo.isUniform)return`
      float `+r+`(int index) {
        `+Ac(n)+`
      }
    `;var i=n.shapeInfo.texShape,s=i[0],o=i[1];if(o===1&&s===1)return`
      float `+r+`(int index) {
        return sampleTexture(`+a+`, halfCR);
      }
    `;var u=au(a);return o===1?`
      float `+r+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+s+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `:s===1?`
      float `+r+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+o+`.0, 0.5);
        return sampleTexture(`+a+`, uv);
      }
    `:`
    float `+r+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+o+", index + "+u+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 2:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape;if(s!=null&&Aa(a,s)){var o=s[0],u=s[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+o+`.0);
      return sampleTexture(`+r+`, uv);
    }
  `}var c=du(a),d=c.newShape,h=c.keptDims,p=d;if(p.length<a.length){var f=Bc(n,p);return`
      `+Fc(f)+`
      float `+i+`(int row, int col) {
        return `+i+"("+zc(["row","col"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+a[1]+`, 1)));
        `+Ac(n)+`
      }
    `;var g=s[0],b=s[1],w=au(r);return b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+a[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+g+`.0);
      return sampleTexture(`+r+`, uv);
    }
  `:g===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+a[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+b+`.0, 0.5);
      return sampleTexture(`+r+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+a[1]+" + col + "+w+`;
    vec2 uv = uvFromFlat(`+g+", "+b+`, index);
    return sampleTexture(`+r+`, uv);
  }
`}(e);case 3:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[1]*a[2],o=a[2],u=du(a),c=u.newShape,d=u.keptDims,h=c;if(h.length<a.length){var p=Bc(n,h);return`
        `+Fc(p)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+zc(["row","col","depth"],d)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+o+`, 1)));
        `+Ac(n)+`
      }
    `;var f=n.shapeInfo.texShape,g=f[0],b=f[1],w=n.shapeInfo.flatOffset;if(b===s&&w==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+o+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+b+".0, "+g+`.0);
          return sampleTexture(`+r+`, uv);
        }
      `;if(b===o&&w==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+a[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+b+".0, "+g+`.0);
      return sampleTexture(`+r+`, uv);
    }
  `;var m=au(r);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+o+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+g+", "+b+`, index);
        return sampleTexture(`+r+`, uv);
      }
  `}(e);case 4:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[3],o=a[2]*s,u=a[1]*o,c=du(a),d=c.newShape,h=c.keptDims;if(d.length<a.length){var p=Bc(n,d);return`
      `+Fc(p)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+zc(["row","col","depth","depth2"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+o+", "+s+`, 1)));
        `+Ac(n)+`
      }
    `;var f=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,b=g[0],w=g[1];if(w===u&&f==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+o+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+b+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;if(w===s&&f==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+a[1]*a[2]+", "+a[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+b+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;var m=au(r);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+o+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+b+", "+w+", index + "+m+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 5:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[4],o=a[3]*s,u=a[2]*o,c=a[1]*u,d=du(a),h=d.newShape,p=d.keptDims;if(h.length<a.length){var f=Bc(n,h);return`
      `+Fc(f)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+zc(["row","col","depth","depth2","depth3"],p)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+c+", "+u+", "+o+", "+s+`)) +
          depth3;
        `+Ac(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,b=n.shapeInfo.texShape,w=b[0],m=b[1];if(m===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+o+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+w+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;if(m===s&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+a[1]*a[2]*a[3]+`,
               `+a[2]*a[3]+", "+a[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+w+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;var x=au(r);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+u+" + depth * "+o+` +
          depth2 * `+s+" + depth3 + "+x+`;
      vec2 uv = uvFromFlat(`+w+", "+m+`, index);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 6:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=du(a),o=s.newShape,u=s.keptDims;if(o.length<a.length){var c=Bc(n,o);return`
      `+Fc(c)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+zc(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var d=a[5],h=a[4]*d,p=a[3]*h,f=a[2]*p,g=a[1]*f;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+g+", "+f+", "+p+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+Ac(n)+`
      }
    `;var b=n.shapeInfo.flatOffset,w=n.shapeInfo.texShape,m=w[0],x=w[1];if(x===g&&b==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+f+", "+p+", "+h+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;if(x===d&&b==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+a[1]*a[2]*a[3]*a[4]+`,
               `+a[2]*a[3]*a[4]+`,
               `+a[3]*a[4]+`,
               `+a[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;var y=au(r);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+g+" + col * "+f+" + depth * "+p+` +
          depth2 * `+h+" + depth3 * "+d+" + depth4 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+x+`, index);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function y6(e){var t,n,a;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=Xa(),`
    vec4 `+n+`() {
      return `+a.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(r){var i=r.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r.shapeInfo.texShape,u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Xa();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+c.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(r){var i=r.shapeInfo.logicalShape,s=r.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),u=r.shapeInfo.texShape,c=u[0],d=u[1],h=Xa();if(u!=null&&Aa(i,u))return`
      vec4 `+o+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+c+`.0);

        return `+h.texture2D+"("+s+`, uv);
      }
    `;var p=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],f=Math.ceil(i[1]/2);return`
    vec4 `+o+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+f+", "+p[0]+", "+p[1]+`, row, col);
      return `+h.texture2D+"("+s+`, uv);
    }
  `}(e);case 3:return function(r){var i=r.shapeInfo.logicalShape,s=r.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),u=r.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var d=i.slice(1),h=Bc(r,d);return`
        `+y6(h)+`
        vec4 `+o+`(int b, int row, int col) {
          return `+o+"("+zc(["b","row","col"],[1,2])+`);
        }
      `}var p=c[0],f=c[1],g=Math.ceil(i[2]/2),b=g*Math.ceil(i[1]/2),w=Xa();return`
    vec4 `+o+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+p+", "+f+", "+b+", "+g+`, b, row, col);
      return `+w.texture2D+"("+s+`, uv);
    }
  `}(e);default:return function(r){for(var i=r.shapeInfo.logicalShape,s=i.length,o=r.name,u="get"+o.charAt(0).toUpperCase()+o.slice(1),c=r.shapeInfo.texShape,d=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],h=d[0],p=d[1],f=Math.ceil(i[s-1]/2),g=f*Math.ceil(i[s-2]/2),b="int b, int row, int col",w="b * "+g+" + (row / 2) * "+f+" + (col / 2)",m=2;m<s-1;m++)b="int b"+m+", "+b,g*=i[s-m-1],w="b"+m+" * "+g+" + "+w;var x=Xa();return`
    vec4 `+u+"("+b+`) {
      int index = `+w+`;
      int texR = index / `+p+`;
      int texC = index - texR * `+p+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+", "+h+`);
      return `+x.texture2D+"("+o+`, uv);
    }
  `}(e)}}var k7=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,S7=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_7=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,j7=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function au(e){return"offset"+e}function Ac(e){var t=e.name,n=ht(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function wn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Bc(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function zc(e,t){return t.map(function(n){return e[n]}).join(", ")}var C7=function(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,se(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var r=e[e.length-1],i=Math.ceil(r/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");var s,o,u=this.outputShape,c=u.length,d=wn(c),h=_r("coords",c);if(i===1){var p=wn(o=c+1);s=`
        `+p+" sourceLocR = "+p+"("+h.join()+`, 0);
        ++`+h[c-1]+`;
        `+p+" sourceLocG = "+p+"("+h.join()+`, 0);
        ++`+h[c-2]+`;
        `+p+" sourceLocA = "+p+"("+h.join()+`, 0);
        --`+h[c-1]+`;
        `+p+" sourceLocB = "+p+"("+h.join()+`, 0);
        --`+h[c-2]+";"}else o=c,s=`
        `+d+` sourceLocR = coords;
        ++`+h[c-1]+`;
        `+d+` sourceLocG = coords;
        ++`+h[c-2]+`;
        `+d+` sourceLocA = coords;
        --`+h[c-1]+`;
        `+d+` sourceLocB = coords;
        --`+h[c-2]+";";var f=["x","y","z","w","u","v"].slice(0,o),g="."+f[o-1],b=f.map(function(A){return"int "+A}),w=_r("sourceLocR",o-1).concat("inIdx.r"),m=_r("sourceLocG",o-1).concat("inIdx.g"),x=_r("sourceLocB",o-1).concat("inIdx.b"),y=_r("sourceLocA",o-1).concat("inIdx.a"),N=n==="max"?"greaterThan":"lessThan",S=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+y.join()+")));",T=`vec4(
            getAChannel(`+w.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+y.join()+") : 0.)",C=a?"":`
      float getBestIndicesAChannel(`+b.join()+`) {
        return getChannel(getBestIndicesA(`+f.join()+`),
                                          vec2(`+f.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+b.join()+`) {
        return getChannel(getA(`+f.join()+`),
                               vec2(`+f.slice(-2).join()+`));
      }
      `+C+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+h[c-1]+" < "+(u[c-1]-1)+`;
        bool hasNextRow = `+h[c-2]+" < "+(u[c-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+g+", sourceLocG"+g+`,
          sourceLocB`+g+", sourceLocA"+g+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+T+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+S+`
          vec4 candidate = `+T+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+N+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},A7=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=o-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+a+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},E7=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=d-1-e.padInfo.front,g=h-1-e.padInfo.top,b=p-1-e.padInfo.left,w=1/(t*n*a);this.userCode=`
      const ivec3 pads = ivec3(`+f+", "+g+", "+b+`);
      const float avgMultiplier = float(`+w+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+r+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+p+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},D7=function(e,t,n,a,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],zt(e,t),zt(e,n);var s="0.0";a!=null&&(zt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var o="1.0";r!=null&&(zt(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+o+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},T7=function(e,t,n,a,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],zt(e,t),zt(e,n);var s="vec4(0.0)";a!=null&&(zt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var o="vec4(1.0)";r!=null&&(zt(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+o+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},R7="return areal * breal - aimag * bimag;",L7="return areal * bimag + aimag * breal;",N3=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=zt(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},vb="return a + b;",xb="return a - b;",k3="return a * b;",w6="return (a < 0.) ? b * a : a;",Bn=function(e,t,n){this.variableNames=["A","B"],this.outputShape=zt(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},N6=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ro=function(e,t,n,a){a===void 0&&(a=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=zt(t,n);var r=this.outputShape.length,i="";if(a)if(r===0||ht(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+wn(r)+` coords = getOutputCoords();
        `,r===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=_r("coords",r);i+=`
            bool nextRowOutOfBounds =
              (`+s[r-2]+" + 1) >= "+this.outputShape[r-2]+`;
            bool nextColOutOfBounds =
              (`+s[r-1]+" + 1) >= "+this.outputShape[r-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},P7=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var a=this;return function(r,i){a.minLoc==null&&(a.minLoc=r.getUniformLocationNoThrow(i,"minVal"),a.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(a.minLoc,t),r.gl.uniform1f(a.maxLoc,n)}},e}(),M7=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var a=this;return function(r,i){a.minLoc==null&&(a.minLoc=r.getUniformLocationNoThrow(i,"minVal"),a.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(a.minLoc,t),r.gl.uniform1f(a.maxLoc,n)}},e}(),I7=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},O7=function(e){this.outputShape=[],this.outputShape=Ud(e,1),this.variableNames=e.map(function(o,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var a=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var r=t[n-1];a.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+r+"));")}var i=t.length,s=t[t.length-1];a.push("else setOutput(getT"+i+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+a.join(`
        `)+`
      }
    `},F7=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ud(e,t);var n=this.outputShape,a=n.length,r=wn(a),i=_r("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map(function(w,m){return"T"+m});var o=new Array(e.length-1);o[0]=e[0][t];for(var u=1;u<o.length;u++)o[u]=o[u-1]+e[u][t];var c=s[t],d=s.slice(-2),h=s.join(),p="if ("+c+" < "+o[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+d.join()+`));
        }`;for(u=1;u<o.length;u++){var f=o[u-1];p+=`
        if (`+c+" < "+o[u]+"  && "+c+" >= "+o[u-1]+`) {
          return getChannel(
            getT`+u+"("+Bm(s,c,f)+`),
            vec2(`+Bm(d,c,f)+`));
        }`}var g=o.length,b=o[o.length-1];p+=`
        return getChannel(
          getT`+g+"("+Bm(s,c,b)+`),
          vec2(`+Bm(d,c,b)+"));",this.userCode=`
      float getValue(`+s.map(function(w){return"int "+w})+`) {
        `+p+`
      }

      void main() {
        `+r+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[a-1]+" = "+i[a-1]+` + 1;
        if (`+i[a-1]+" < "+n[a-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[a-2]+" = "+i[a-2]+` + 1;
        if (`+i[a-2]+" < "+n[a-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[a-1]+" = "+i[a-1]+` - 1;
        if (`+i[a-2]+" < "+n[a-2]+` &&
            `+i[a-1]+" < "+n[a-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Bm(e,t,n){var a=e.indexOf(t);return e.map(function(r,i){return i===a?r+" - "+n:r}).join()}var B7=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+a+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+r+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},z7=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dataFormat==="channelsLast",s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+c+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+a+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},U7=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+r+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+a+" - "+s+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},q7=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+o+", "+u+", "+c+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+r+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+a+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+a+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},H7=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+a+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+r+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},W7=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+a+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+o+`; dm++) {
              int d2 = d1 * `+o+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},S3=function(e,t,n,a){t===void 0&&(t=!1),n===void 0&&(n=null),a===void 0&&(a=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var r=e.padInfo.top,i=e.padInfo.left,s=e.strideHeight,o=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,g=e.dataFormat==="channelsLast",b=g?1:2,w=g?2:3,m=g?3:1,x="",y="";n&&(x=a?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,y="result = activation(result);");var N=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+s+", "+o+`);
      const ivec2 pads = ivec2(`+r+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+b+"], coords["+w+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+c+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+p+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+g+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(f===1)+`) {

              if (`+g+`) {
                dotProd +=
                    getX(batch, xR, xC, `+p+`) *
                    getW(wR, wC, `+p+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+p+`, xR, xC) *
                    getW(wR, wC, `+p+`, d2);
              }

            } else if (`+(f===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2)
              );

              if (`+g+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(f===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2),
                getW(wR, wC, `+p+` + 2, d2)
              );

              if (`+g+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1),
                  getX(batch, xR, xC, `+p+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC),
                  getX(batch, `+p+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+N+`
        `+y+`
        setOutput(result);
      }
    `},G7=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=4*Math.floor(e.inChannels/4),g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+r+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+a+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+o+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+p+`; wC++) {
              int xC = xCCorner + wC * `+c+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+f+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(g===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+f+`) *
                  getW(wF, wR, wC, `+f+`, d2);
              } else if (`+(g===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(g===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1),
                  getX(batch, xF, xR, xC, `+f+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2),
                  getW(wF, wR, wC, `+f+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},_3=function(e,t,n,a){t===void 0&&(t=!1),n===void 0&&(n=null),a===void 0&&(a=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var r=e.inHeight,i=e.inWidth,s=e.padInfo.top,o=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=e.outChannels/e.inChannels,b="",w="";n&&(b=a?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,w="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+g+`;
        int q = d2 - d1 * `+g+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+p+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+r+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+w+`
        setOutput(result);
      }
    `},j3=function(e,t,n,a){t===void 0&&(t=!1),n===void 0&&(n=null),a===void 0&&(a=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var r=e.inHeight,i=e.inWidth,s=e.padInfo.top,o=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=f,b="int xR; int xC; int xCOffset;",w=0;w<p;w++)for(var m=0;m<f;m++)b+=`
          vec4 xTexelR`+w+"C"+2*m+` = vec4(0.);
          vec4 wR`+w+"C"+m+` = vec4(0.);
          vec4 xR`+w+"C"+m+" = vec4(0.);";for(w=0;w<p;w++)for(var x=0;x<g;x++){if(b+=`
          xR = xRCorner + `+w*d+`;
          xC = xCCorner + `+(m=2*x)*h+`;
        `,c===1){if(m<f&&(b+=o%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+r+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+w+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+r+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+w+"C"+m+" = vec4(previous.zw, xTexelR"+w+"C"+m+`.xy);
                } else {
                  xR`+w+"C"+m+" = vec4(0, 0, xTexelR"+w+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+r+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                xR`+w+"C"+m+" = xTexelR"+w+"C"+m+`;
              `,m+1<f)){var y=o%2==0?zj(h):h;h%2==0&&o%2==1||h%2!=0&&o%2!=1?(b+=`
                  xCOffset = xC + `+o%2+" + "+y+`;

                  if(xR >= 0 && xR < `+r+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(b+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+r+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+w+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+w+"C"+m+` = vec4(0.);
                    }
                  `),b+=`
                  xR`+w+"C"+(m+1)+` = vec4(
                    xTexelR`+w+"C"+m+".zw, xTexelR"+w+"C"+(m+2)+`.xy);
                `):b+=`
                  xCOffset = xC + `+y+`;

                  if(xR >= 0 && xR < `+r+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+w+"C"+(m+1)+" = xTexelR"+w+"C"+(m+2)+`;
                `}}else m<f&&(b+=`
              if(xR >= 0 && xR < `+r+`) {
            `,o%2==1?(b+=`
                xCOffset = xC + 1 - `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+w+"C"+(m+2)+` = vec4(0.);
                }

                xR`+w+"C"+m+` = vec4(
                  xTexelR`+w+"C"+m+".zw, xTexelR"+w+"C"+(m+2)+`.zw);
              `,m+1<f&&(b+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+c+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+w+"C"+(m+1)+" = vec4(xTexelR"+w+"C"+(m+2)+`.xy, final.xy);
                `)):(b+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+(m+2)+` = vec4(0.);
                }

                xR`+w+"C"+m+` = vec4(
                  xTexelR`+w+"C"+m+".xy, xTexelR"+w+"C"+(m+2)+`.xy);
              `,m+1<f&&(b+=`
                  xR`+w+"C"+(m+1)+` = vec4(
                    xTexelR`+w+"C"+m+".zw, xTexelR"+w+"C"+(m+2)+`.zw);
                `)),b+="}");m<f&&(b+=`
            vec4 wTexelR`+w+"C"+m+" = getW("+w+", "+m+`, d1, q);
            wR`+w+"C"+m+" = vec4(wTexelR"+w+"C"+m+".xz, wTexelR"+w+"C"+m+`.xz);
          `,m+1<f&&(b+=`
              vec4 wTexelR`+w+"C"+(m+1)+" = getW("+w+", "+(m+1)+`, d1, q);
              wR`+w+"C"+(m+1)+` =
                vec4(wTexelR`+w+"C"+(m+1)+".xz, wTexelR"+w+"C"+(m+1)+".xz);"))}for(w=0;w<p;w++)for(m=0;m<f;m++)b+="dotProd += xR"+w+"C"+m+" * wR"+w+"C"+m+";";var N="",S="";n&&(N=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,S="result = activation(result);");var T=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+N+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+b+`

        vec4 result = dotProd;
        `+T+`
        `+S+`
        setOutput(result);
      }
    `},V7=function(e,t,n,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],s=e[1],o=e[2],u=e[3],c=t[0],d=n[0],h=n[1];this.outputShape=[c,d,h,u];var p=a==="bilinear"?1:0,f=[s-1+".0",o-1+".0"],g=f[0],b=f[1],w=d>1?[""+(s-1)/(d-1),"(y2-y1) * height_ratio","y1*"+g+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+g],m=w[0],x=w[1],y=w[2],N=h>1?[""+(o-1)/(h-1),"(x2-x1) * width_ratio","x1*"+b+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+b],S=N[0],T=N[1],C=N[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+S+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+x+`;
        float width_scale = `+T+`;

        float in_y = `+y+`;
        if( in_y < 0.0 || in_y > `+g+` ) {
          setOutput(float(`+r+`));
          return;
        }
        float in_x = `+C+`;
        if( in_x < 0.0 || in_x > `+b+` ) {
          setOutput(float(`+r+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+p+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},K7=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var a=e.length,r=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+r+" -i - 1;":"return i;")+`
      }

      void main() {
        `+wn(a)+` coords = getOutputCoords();
        int end = `+C3(a,"coords")+`;
        float val = 0.0;
        for (int i = `+r+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+C3(a,"coords")+` = idx;
          val += getX(`+function(s,o){if(s===1)return""+o;if(s===2)return o+".x, "+o+".y";if(s===3)return o+".x, "+o+".y, "+o+".z";if(s===4)return o+".x, "+o+".y, "+o+".z, "+o+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}(a,"coords")+`);
        }
        setOutput(val);
      }
    `};function C3(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var $7=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=zf.DENSE;var t=mf(e),n=Xa();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+hu(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},Y7=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=zf.DENSE;var t=mf(e),n=Xa();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+hu(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},X7=function(){function e(t,n,a){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=a,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),J7=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},Q7=function(e){this.variableNames=["A"],this.outTexUsage=Gr.DOWNLOAD;var t=Xa();this.outputShape=e,this.userCode=`
      `+b6+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},Z7=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Gr.DOWNLOAD;var t=Xa();this.outputShape=e,this.userCode=`
      `+b6+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},eI=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var a=Xa(),r=t[0],i=t[1];this.outputShape=e;var s="result";n&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+aw(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+r+`.0);
        vec4 values = `+a.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+a.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},tI=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=Xa(),r=t[0],i=t[1];this.outputShape=e;var s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var d=2*u+c;s+=`
          localCoords = coords;
          if(localCoords[2] + `+c+" < "+e[2]+`) {
            localCoords[2] += `+c+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+r+`.0);
              values = `+a.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+aw(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+a.output+" = "+o+`;
      }
    `},nI="return real * expR - imag * expI;",aI="return real * expI + imag * expR;",A3=function(e,t,n){this.variableNames=["real","imag"];var a=t[1];this.outputShape=t;var r=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?a+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+r+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+a+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+a+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},rI=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(a,r){n.valueLoc==null&&(n.valueLoc=a.getUniformLocationNoThrow(r,"value")),a.gl.uniform1f(n.valueLoc,t)}},e}(),iI=function(e,t,n){this.variableNames=["A","indices"];var a=e.slice();a[n]=t,this.outputShape=a,this.rank=a.length;var r=wn(this.rank),i=function(s,o){var u=s.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],h=0;h<s.length;h++)h===o?d.push("int(getIndices("+c[h]+"))"):d.push(""+c[h]);return d.join()}(e,n);this.userCode=`
      void main() {
        `+r+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},sI=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var a=wn(t.length),r=wn(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+a+" strides = "+a+"("+this.strides+`);
         void main() {
          `+r+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function oI(e,t){var n=Xa();return nM(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function lI(e,t){return oM(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function uI(e,t){return lM(e,t,new Uint16Array([0,1,2,2,1,3]))}function Np(e,t,n,a,r,i,s){cM(n,a);var o=uM(e,t),u=e.TEXTURE_2D;return ft(e,t,function(){return e.bindTexture(u,o)}),ft(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ft(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ft(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ft(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ft(e,t,function(){return e.texImage2D(u,0,r,n,a,0,i,s,null)}),ft(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),o}function cI(e,t,n,a,r){var i=hv(n,a);return Np(e,t,i[0],i[1],r.internalFormatFloat,r.textureFormatFloat,e.FLOAT)}function dI(e,t,n,a,r){var i=hv(n,a);return Np(e,t,i[0],i[1],r.internalFormatHalfFloat,r.textureFormatFloat,r.textureTypeHalfFloat)}function hI(e,t,n,a,r){var i=hv(n,a);return Np(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function fI(e,t,n,a,r){var i=wp(n,a);return Np(e,t,i[0],i[1],r.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function pI(e,t,n,a,r){var i=wp(n,a);return Np(e,t,i[0],i[1],r.internalFormatPackedHalfFloat,e.RGBA,r.textureTypeHalfFloat)}function mI(e,t,n,a){return ft(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),m3(e,t,n,"clipSpacePos",a,3,20,0)&&m3(e,t,n,"uv",a,2,20,12)}function gI(e,t,n,a,r,i,s){var o,u,c;ft(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(o=new Uint8Array(a*r*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(o=new Float32Array(a*r*4),u=e.FLOAT,c=s.internalFormatPackedFloat),o.set(i),ft(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,c,a,r,0,e.RGBA,u,o)}),ft(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function vI(e,t,n,a){ft(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a.data instanceof Uint8Array?ft(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,a.width,a.height,0,e.RGBA,e.UNSIGNED_BYTE,a.data)}):ft(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a)}),ft(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function xI(e,t,n,a,r){var i=e.createBuffer();ft(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var s=16*n*a;return ft(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ)}),ft(e,t,function(){return e.readPixels(0,0,a,n,e.RGBA,e.FLOAT,0)}),ft(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function bI(e,t,n){var a=e,r=new Float32Array(n);return a.bindBuffer(a.PIXEL_PACK_BUFFER,t),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,r),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),r}function yI(e,t,n,a,r){var i=hv(n,a),s=i[0],o=i[1],u=new Uint8Array(n*a*4);return ft(e,t,function(){return e.readPixels(0,0,s,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function wI(e,t,n,a,r,i,s,o){var u=e,c=new Float32Array(function(d,h){var p=wp(d,h);return p[0]*p[1]*4}(i,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function NI(e,t,n,a){var r=new Float32Array(n*a*4);return ft(e,t,function(){return e.readPixels(0,0,a,n,e.RGBA,e.FLOAT,r)}),r}var kI=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Oe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,J8(n,t)):this.gl=Fs(n);var a="WEBGL_color_buffer_float";if(Oe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Mm(this.gl,this.debug,"OES_texture_float"),ki(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Mm(this.gl,this.debug,"OES_texture_half_float");else if(Oe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(a),ki(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Mm(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Oe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(a="EXT_color_buffer_float",ki(this.gl,a))this.colorBufferFloatExtension=this.gl.getExtension(a);else{if(!ki(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=lI(this.gl,this.debug),this.indexBuffer=uI(this.gl,this.debug),this.framebuffer=dM(this.gl,this.debug),this.textureConfig=K2(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return Oe().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ft(n,this.debug,function(){return n.finish()}),ft(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ft(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ft(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ft(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ft(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),cI(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),dI(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),hI(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),vI(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,a,r){this.throwIfDisposed(),gI(this.gl,this.debug,t,n,a,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),pI(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),fI(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(g3(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ft(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,a){var r=this;return this.downloadMatrixDriver(t,function(){return yI(r.gl,r.debug,n,a,r.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,a,r,i,s){return wI(this.gl,t,0,0,0,i,s,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return bI(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,a){this.bindTextureToFrameBuffer(t);var r=xI(this.gl,this.debug,n,a,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,a,r=this;if(Oe().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),a=function(){var o=i.clientWaitSync(s,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},n=s}else Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),a=function(){return r.isQueryAvailable(n,Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):a=function(){return!0};return{query:n,isFencePassed:a}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,a){var r=this;return this.downloadMatrixDriver(t,function(){return NI(r.gl,r.debug,n,a)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,a=aM(n,this.debug,t),r=oI(n,this.debug),i=iM(n,this.debug);return ft(n,this.debug,function(){return n.attachShader(i,r)}),ft(n,this.debug,function(){return n.attachShader(i,a)}),sM(n,this.debug,i),this.debug&&fb(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=mI(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ft(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&fb(this.gl,this.debug,this.program),ft(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,a){return a===void 0&&(a=!0),this.throwIfDisposed(),a?fM(this.gl,this.debug,t,n):pM(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var a=this;return this.throwIfDisposed(),ft(this.gl,this.debug,function(){return a.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,a){this.throwIfDisposed(),this.throwIfNoProgram(),mM(this.gl,this.debug,this.program,t,n,a)},e.prototype.setOutputMatrixTexture=function(t,n,a){this.setOutputMatrixTextureDriver(t,a,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,a){this.throwIfDisposed();var r=wp(n,a),i=r[0],s=r[1];this.setOutputMatrixTextureDriver(t,i,s)},e.prototype.setOutputMatrixWriteRegion=function(t,n,a,r){this.setOutputMatrixWriteRegionDriver(a,t,r,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,a,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&fb(this.gl,this.debug,this.program),Im(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ft(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ft(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Mm(this.gl,this.debug,Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,a),a}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,a=this.getQueryTimerExtensionWebGL2();n.endQuery(a.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return lt(this,void 0,void 0,function(){var n=this;return ut(this,function(a){switch(a.label){case 0:return[4,u3(function(){return n.disposed||n.isQueryAvailable(t,Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return a.sent(),[2,this.getQueryTime(t,Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var a=this.gl;return a.getQueryParameter(t,a.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var a=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=a.getQueryParameter(t,a.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(a){n.addItemToPoll(function(){return t.isFencePassed()},function(){return a()})})},e.prototype.pollItems=function(){for(var t=function(a){for(var r=0;r<a.length&&a[r]();++r);return r-1}(this.itemsToPoll.map(function(a){return a.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var a=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||u3(function(){return a.pollItems(),a.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),pb(this.gl,this.debug,t,this.framebuffer),this.debug&&Im(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(pb(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Im(this.gl)):g3(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var a=n();return this.unbindTextureToFrameBuffer(),a},e.prototype.setOutputMatrixTextureDriver=function(t,n,a){this.throwIfDisposed();var r=this.gl;pb(r,this.debug,t,this.framebuffer),this.debug&&Im(r),this.outputTexture=t,ft(r,this.debug,function(){return r.viewport(0,0,n,a)}),ft(r,this.debug,function(){return r.scissor(0,0,n,a)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,a,r){var i=this;this.throwIfDisposed(),ft(this.gl,this.debug,function(){return i.gl.scissor(t,n,a,r)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function E3(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,a){var r=n.logicalShape,i=t[a],s=i.shape;if(!Aa(r,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+s+" must match");if(!n.isUniform||!i.isUniform){var o=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!Aa(o,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+u+" must match")}})}var SI=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var a=n.filterWidth,r=n.inChannels,i=n.strideWidth,s=n.strideHeight,o=n.padInfo,u=n.outWidth,c=n.dilationWidth,d=n.dilationHeight,h=n.dataFormat,p=o.left,f=o.top,g=r*a,b=Xa(),w=h==="channelsLast",m=w?0:1,x=w?1:2,y="",N=0;N<=1;N++)for(var S=0;S<=1;S++)y+=`
          blockIndex = rc.y + `+S+`;
          pos = rc.x + `+N+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+s+" - "+f+`;
            d0 = offsetY + `+d+" * (pos / "+g+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+p+`.);
              d1 = offsetX + `+c+" * (int(mod(float(pos), "+g+".) / "+r+`.));

              if(d1 < `+t[x]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+r+`.));

                if (`+w+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*N+S)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*N+S)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+y+`

        `+b.output+` = result;
      }
    `},_I=function(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[];var i,s=t,o=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+a+") * sum";i=r===.5?"inversesqrt("+u+")":r===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+r+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+o+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},jI=function(e,t,n,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+a+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+a+`)
                * float(`+r+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+r+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},CI=function(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,s=t,o=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+a+") * sum";i=r===.5?"inversesqrt("+u+")":r===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+r+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+o+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},AI=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=r-1-e.padInfo.top,o=i-1-e.padInfo.left,u=r*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+r+`;
          wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},EI=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=o-1-e.padInfo.front,h=u-1-e.padInfo.top,p=c-1-e.padInfo.left,f=o*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+h+", "+p+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+o+`;
           wD += `+r+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+c+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+f+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+c+` +
                  wR * `+c+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},bb=function(e,t,n,a,r,i,s){n===void 0&&(n=!1),a===void 0&&(a=!1),r===void 0&&(r=!1),i===void 0&&(i=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var o=n?e[1]:e[2],u=Math.ceil(o/2),c=n?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",g="";i&&(f=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,g="result = activation(result);");var b=r?"result += getBiasAtOutCoords();":"";r&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+f+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+c+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+p[0]+`);
          result += (`+h[1]+" * "+p[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+b+`

        `+g+`

        setOutput(result);
      }
    `},DI=function(){function e(t,n,a){this.variableNames=["probs"],this.outputShape=[t,a],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(a,r){n.seedLoc==null&&(n.seedLoc=a.getUniformLocation(r,"seed")),a.gl.uniform1f(n.seedLoc,t)}},e}(),TI=function(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+a+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},RI=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=_r("rc",t),a=wn(t),r=function(o,u,c){if(o===1)return"rc > "+u[0];for(var d="",h=o-2;h<o;h++)d+=c[h]+" >= "+u[h],h<o-1&&(d+="||");return d}(t,e,n),i=function(o,u,c,d){if(o===1)return"";var h=d.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+c+`;
  `}(t,e[e.length-1],e[e.length-2],n),s=function(o,u){var c=o.length,d=function(h,p){for(var f=[],g=0;g<=1;g++)for(var b=0;b<=1;b++){for(var w=(g===0?"r":"rp1")+", "+(b===0?"c":"cp1"),m=2;m<h;m++)w=p[p.length-1-m]+","+w;f.push(w)}return f}(c,u);return c===1?`getA(rc),
            rc + 1 >= `+o[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(e,n);this.userCode=`
        void main() {
          `+a+` rc = getOutputCoords();

          if(`+r+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},LI=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,c){return u[0]+e[c]+u[1]});var a=e.length,r=wn(a),i=t.map(function(u){return u[0]}).join(","),s=t.map(function(u,c){return u[0]+e[c]}).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=a!==1?`
      `+r+" start = "+r+"("+i+`);
      `+r+" end = "+r+"("+s+`);

      void main() {
        `+r+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+r+` coords = outC - start;
          setOutput(getX(`+o+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},PI=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(w,m){return w[0]+e[m]+w[1]});for(var a=e.length,r=wn(a),i=t.map(function(w){return w[0]}).join(","),s=t.map(function(w,m){return w[0]+e[m]}).join(","),o=_r("rc",a),u=_r("source",a),c=o[a-1]+" < "+this.outputShape[a-1],d=a===1?"source":"vec2("+u.slice(-2).join()+")",h=[r+" rc = outputLoc;",o[a-1]+` += 1;
       if(`+c+`) {
      `,a===1?"":`}
       rc = outputLoc;
       `+o[a-2]+` += 1;
       if(`+o[a-2]+" < "+this.outputShape[a-2]+") {",a===1?"":"  "+o[a-1]+` += 1;
         if(`+c+") {"],p=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",g=0,b=a===1?2:4;g<b;g++)f+=`
        `+h[g]+`
        if (`+p+`) {
          result[`+g+"] = float("+n+`);
        } else {
          `+r+` source = rc - start;
          result[`+g+"] = getChannel(getX("+u.join()+"), "+d+`);
        }
      `;f+=a===1?"} ":"}}",this.userCode=`
      const `+r+" start = "+r+"("+i+`);
      const `+r+" end = "+r+"("+s+`);

      void main() {
        `+r+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+f+`
        setOutput(result);
      }
    `},yb=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,r=e.strideHeight,i=e.strideWidth,s=e.dilationHeight,o=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",f="0.0";if(p||(f="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+r+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+c+`;
                wC += `+o+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+c+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var g=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(g="avgValue / count");var b=4*Math.floor(a/4),w=a%4,m=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+r+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+f+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+f+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+o+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+o+`, d),
              getValue(batch, xR, xC + 2 * `+o+`, d),
              getValue(batch, xR, xC + 3 * `+o+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(w===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(w===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+o+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(w===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+o+`, d),
              getValue(batch, xR, xC + 2 * `+o+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+g+`);
      }
    `}},wb=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,g=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;var w=t==="avg",m="0.0";if(w||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+r+", "+i+", "+s+`);
        const ivec3 pads = ivec3(`+f+", "+g+", "+b+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+o+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+c+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+p+` +
                      wR * `+p+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var y=4*Math.floor(a/4),N=a%4,S=`
      if (`+w+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+r+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+f+", "+g+", "+b+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+o+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+y+`; wC += 4) {
              int xC = xCCorner + wC * `+c+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+c+`, ch)
              );

              `+S+`
            }

            int xC = xCCorner + `+y+`;
            if (`+(N===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(N===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(N===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                initializationValue
              );

              `+S+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},MI=function(e,t){this.variableNames=["x"];var n=e.windowSize,a=e.batchSize,r=e.inSize,i=Math.ceil(r/n);this.outputShape=[a,i];var s="0.0",o="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",o="min"):t==="max"&&(s="-1.0 / 1e-20",o="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var c=4*Math.floor(n/4),d=n%4,h=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+o+`(values, minMaxValue);
      }
    `,p="vec4";t==="all"?(s="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(s="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");var f="";r%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+r+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+f+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+c+`; i += 4) {
          int inIdx = inOffset + i;
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+c+`;
        if (`+(d===1)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===2)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===3)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+u+`);
      }
    `},II=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",a=0;a<4;a++){var r="thisRC = rc;";a%2==1&&(r+="thisRC.z += 1;"),a>1&&(r+="thisRC.y += 1;"),n+=`
        `+r+`
        `+(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+a+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(a>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+hu(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+aw(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},OI=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var a=t.shape,r=a[1],i=a[2],s=e.shape,o=s[1],u=s[2],c=[n&&o>1?r-1:r,n&&u>1?i-1:i],d=[n&&o>1?o-1:o,n&&u>1?u-1:u],h=c[0]/d[0],p=c[1]/d[1],f=1/h,g=1/p,b=2*Math.ceil(f)+2,w=2*Math.ceil(g)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+g+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+o+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(r-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},FI=function(e,t,n,a){this.variableNames=["A"],this.outputShape=[];var r=e[0],i=e[1],s=e[2],o=e[3];this.outputShape=[r,t,n,o];var u=[a&&t>1?i-1:i,a&&n>1?s-1:s],c=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},BI=function(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var r=e[0],i=e[1],s=e[2],o=e[3];this.outputShape=[r,t,n,o];var u=[a&&t>1?i-1:i,a&&n>1?s-1:s],c=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`,
          `+u[1]/c[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(o-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},zI=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var a=t.shape,r=a[1],i=a[2],s=e.shape,o=s[1],u=s[2],c=[n&&o>1?r-1:r,n&&u>1?i-1:i],d=[n&&o>1?o-1:o,n&&u>1?u-1:u],h=c[0]/d[0],p=c[1]/d[1],f=1/h,g=1/p,b=2*Math.ceil(f)+2,w=2*Math.ceil(g)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+g+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+o+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+c[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+c[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+r+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},UI=function(e,t,n,a){this.variableNames=["A"],this.outputShape=[];var r=e[0],i=e[1],s=e[2],o=e[3];this.outputShape=[r,t,n,o];var u=[a&&t>1?i-1:i,a&&n>1?s-1:s],c=[a&&t>1?t-1:t,a&&n>1?n-1:n],d=a?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},qI=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var a=e.map(function(i,s){return function(o){return t.indexOf(o)!==-1&&e[o]!==1?e[o]+" - coords["+o+"] - 1":"coords["+o+"]"}(s)}).join(","),r=wn(n);this.userCode=`
      void main() {
        `+r+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},HI=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var a=_r("rc",n),r=a[n-1]+" + 1 < "+this.outputShape[n-1],i=a[n-2]+" + 1 < "+this.outputShape[n-2],s=wn(n);function o(u){var c=e.map(function(d,h){return function(p,f){return t.indexOf(p)!==-1&&e[p]!==1?e[p]+" - "+f[p]+" - 1":""+f[p]}(h,u)});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+r+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return o(u)}(a.slice())+`;
          if(`+r+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",o(u)}(a.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",o(u)}(a.slice())+`;
            if(`+r+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",o(u)}(a.slice())+`;
            }
          }
          setOutput(result);
        }
    `},D3=function(e,t,n,a,r,i,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var o=wn(r.length),u=wn(i.length),c="";n===1?c="i":n===2&&(c="i, j");var d="getIndices("+c+")",h="";a===1?h="i":a===2&&(h="i, coords[1]");var p="getUpdates("+h+")",f=t>1?"strides[j]":"strides";this.userCode=`
        `+o+" strides = "+o+"("+r+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+f+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+p+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},WI=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,a=e.batchSize,r=e.inSize,i=e.numSegments,s=i*Math.ceil(r/n);this.outputShape=[a,s];var o=4*Math.floor(n/4),u=n%4,c=`
        sumValue += dot(values, segFilter);
    `,d="";r%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+r+`) {
          return initializationValue;
        }
      `);var h="";r%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+r+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+o+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+c+`
        }

        int inIdx = inOffset + `+o+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+c+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+c+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+c+`
        }
        setOutput(sumValue);
      }
    `},GI=function(e,t,n){var a,r;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)r="resRC",a="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[],u=0;u<t.length;u++)o.push(""+i[u]),u<e&&s.push(""+i[u]);a=s.join(),r=o.join()}var c=wn(n);this.userCode=`
      void main() {
        `+c+` resRC = getOutputCoords();
        float cVal = getC(`+a+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+r+`));
        } else {
          setOutput(getB(`+r+`));
        }
      }
    `},VI=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,a=wn(this.rank),r="uniform int start["+this.rank+"];",i=function(s){if(s===1)return"sourceLoc";if(s<=6)return Nb.slice(0,s).map(function(o){return"sourceLoc."+o}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")}(this.rank);n=`
        `+a+` sourceLoc;
        `+a+` coords = getOutputCoords();
        `+t.map(function(s,o){return"sourceLoc."+Nb[o]+" = start["+o+"] + coords."+Nb[o]+";"}).join(`
`)+`
      `,this.userCode=`
      `+r+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(a,r){n.startLoc==null&&(n.startLoc=a.getUniformLocationNoThrow(r,"start"),n.startLoc==null)||a.gl.uniform1iv(n.startLoc,t)}},e}(),Nb=["x","y","z","w","u","v"],KI=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=wn(this.rank),a=_r("coords",this.rank),r=_r("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+r.slice(-2).join()+")",s="getChannel(getSource("+r.join()+"), "+i+")",o=`
      result.x = `+s+`;
      if (++`+a[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+r[this.rank-1]+`;
        result.y = `+s+`;
        --`+r[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+a[this.rank-1]+`;
      if (++`+a[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+r[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+a[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+r[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(d,h){return"start["+h+"]"}).join()+");":t.map(function(d,h){return r[h]+" = "+a[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+c+`
        vec4 result = vec4(0.);
        `+o+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(a,r){n.startLoc==null&&(n.startLoc=a.getUniformLocationNoThrow(r,"start"),n.startLoc==null)||a.gl.uniform1iv(n.startLoc,t)}},e}(),$I=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var a=n.length,r=wn(n.length),i=wn(n.length),s="";if(a===1)s="coords * strides + begin";else{var o=0;s=n.map(function(u,c){return o++,n.length===1?"coords * strides["+c+"] + begin["+c+"]":"coords["+(o-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode=`
      `+r+" begin = "+r+"("+e+`);
      `+r+" strides = "+r+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},YI=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,a){var r,i=T3(n,a),s=R3(t,i,a);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[s].shift();return this.usedTextures[s].push(o),o}return this.numUsedTextures++,this.log(),i===Hr.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Hr.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Hr.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Hr.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Hr.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(r),r},e.prototype.releaseTexture=function(t,n,a,r){if(this.freeTextures!=null){var i=R3(n,T3(a,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],o=s.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function T3(e,t){if(e===Gr.UPLOAD)return Hr.PACKED_2X2_FLOAT32;if(e===Gr.RENDER||e==null)return function(n){return Oe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Hr.PACKED_2X2_FLOAT32:Hr.UNPACKED_FLOAT32:n?Hr.PACKED_2X2_FLOAT16:Hr.UNPACKED_FLOAT16}(t);if(e===Gr.DOWNLOAD||e===Gr.PIXELS)return Hr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function R3(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var XI=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;var r=wn(this.rank),i=function(s){var o=s.length;if(o>5)throw Error("Tile for rank "+o+" is not yet supported");if(o===1)return"imod(resRC, "+s[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],d=0;d<s.length;d++)c.push("imod("+u[d]+", "+s[d]+")");return c.join()}(e);this.userCode=`
      void main() {
        `+r+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},JI=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;var r=wn(this.rank),i=function(s){var o=s.length;if(o>6)throw Error("Transpose for rank "+o+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(o),d=0;d<s.length;d++)c[s[d]]=u[d];return c.join()}(t);this.userCode=`
    void main() {
      `+r+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},QI=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[t[a]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var r=wn(this.rank),i=x6("rc",this.rank),s=new Array(this.rank);for(a=0;a<t.length;a++)s[t[a]]=i[a];var o="vec2("+s.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+s.join()+"), "+o+")";this.userCode=`
    void main() {
      `+r+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+c+`;
      if(`+u+`) {
        result[1] = `+c+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+c+`;
        if(`+u+`) {
          result[3] = `+c+`;
        }
      }
      setOutput(result);
    }
    `},rw=1.7580993408473768,iw=1.0507009873554805,Pt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Zi="if (isnan(x)) return x;",ZI="return x;",L3="return abs(x);",k6=Zi+`
  return (x < 0.0) ? 0.0 : x;
`,S6=Zi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_6="return (x >= 0.0) ? x : (exp(x) - 1.0);",eO=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+rw+`;
  float scale = `+iw+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,P3="return -x;",M3="return ceil(x);",I3="return floor(x);",O3="return exp(x);",F3="return exp(x) - 1.0;",tO=Zi+`
  return sin(x);
`,nO=Zi+`
  return cos(x);
`,aO=Zi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,rO=Zi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,iO=Zi+`
  return atan(x);
`,sO=Zi+"return log(x + sqrt(x * x + 1.0));",oO=Zi+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,lO=Zi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,zm="return x;",uO="return x;",j6=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,C6=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,A6=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Gh=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},cO=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=_r("rc",t),a=wn(t),r=function(o,u){if(o===1)return"rc";for(var c="",d=0;d<o;d++)c+=u[d],d<o-1&&(c+=",");return c}(t,n),i=n.slice(-2),s=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+a+` rc = getOutputCoords();
        vec4 packedInput = getA(`+r+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},Um={};function qm(e,t){if(t===void 0&&(t=!1),e==="linear")return t?uO:ZI;if(e==="relu")return t?j6:k6;if(e==="elu")return t?A6:_6;if(e==="relu6")return t?C6:S6;if(e==="prelu")return t?N6:w6;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var dO=600,hO=function(e){function t(n){var a,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!Oe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Fs(Oe().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Oe().getNumber("WEBGL_VERSION"))in Um||(Um[a]={}),Um[a]),r.gpgpu=new kI(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=n,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=n.gl.canvas;return r.textureManager=new YI(r.gpgpu),r.numMBBeforeWarning=Oe().global.screen==null?1024:Oe().global.screen.height*Oe().global.screen.width*window.devicePixelRatio*dO/1024/1024,r.texData=new u6(r,be),r}return Qi(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,a,r){if(Oe().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:a,dtype:r,values:n,usage:Gr.UPLOAD}),i},t.prototype.move=function(n,a,r,i){if(Oe().getBool("DEBUG")&&this.checkNumericalProblems(a),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:r,dtype:i,values:a,usage:Gr.UPLOAD})},t.prototype.readSync=function(n){var a=this.texData.get(n),r=a.values,i=a.dtype,s=a.complexTensors,o=a.slice,u=a.shape,c=a.isPacked;if(o!=null){var d=void 0;d=c?new Gh(u,zm):new Pt(u,zm);var h=this.runWebGLProgram(d,[{dataId:n,shape:u,dtype:i}],i),p=this.readSync(h.dataId);return this.disposeData(h.dataId),p}if(r!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return r;var f,g,b=this.activeTimers!=null;return b&&(f=vs()),i==="complex64"?g=uy(s.real.dataSync(),s.imag.dataSync()):g=this.getValuesFromTexture(n),b&&(this.downloadWaitMs+=vs()-f),this.convertAndCacheOnCPU(n,g)},t.prototype.read=function(n){return lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,T,C,A;return ut(this,function(R){switch(R.label){case 0:if(this.pendingRead.has(n))return a=this.pendingRead.get(n),[2,new Promise(function(L){return a.push(L)})];if(r=this.texData.get(n),i=r.values,s=r.shape,o=r.slice,u=r.dtype,c=r.complexTensors,d=r.isPacked,o!=null)return h=void 0,h=d?new Gh(s,zm):new Pt(s,zm),p=this.runWebGLProgram(h,[{dataId:n,shape:s,dtype:u}],u),f=this.read(p.dataId),this.disposeData(p.dataId),[2,f];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!Oe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Oe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return g=null,u!=="complex64"&&Oe().get("WEBGL_BUFFER_SUPPORTED")&&(b=this.decode(n),w=this.texData.get(b.dataId),g=(A=this.gpgpu).createBufferFromTexture.apply(A,[w.texture].concat(mf(s)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:R.sent(),R.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return x=R.sent(),y=x[0],N=x[1],m=uy(y,N),[3,5];case 4:g==null?m=this.getValuesFromTexture(n):(S=ht(s),m=this.gpgpu.downloadFloat32MatrixFromBuffer(g,S)),R.label=5;case 5:return b!=null&&this.disposeData(b.dataId),T=this.convertAndCacheOnCPU(n,m),C=this.pendingRead.get(n),this.pendingRead.delete(n),C.forEach(function(L){return L(T)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,T]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var a=0;a<n.length;a++){var r=n[a];if(!eM(r))throw Oe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+r+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+r+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var a,r=this.texData.get(n),i=r.shape,s=r.dtype,o=r.isPacked,u=ht(i);if(Oe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(n),d=this.texData.get(c.dataId),h=(a=this.gpgpu).downloadMatrixFromPackedTexture.apply(a,[d.texture].concat(mf(i))).subarray(0,u);return this.disposeData(c.dataId),h}var p=Oe().getBool("WEBGL_PACK")&&o===!0,f=p?mb(i):i,g=p?new Z7(f):new Q7(f),b=this.runWebGLProgram(g,[{shape:f,dtype:s,dataId:n}],"float32"),w=this.texData.get(b.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(w.texture,w.texShape[0],w.texShape[1]).subarray(0,u);return this.disposeData(b.dataId),m},t.prototype.time=function(n){return lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c;return ut(this,function(d){switch(d.label){case 0:return a=this.activeTimers,r=[],i=!1,this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,n(),s=Bd(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),o=Bd(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=a,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return c=d.sent(),u.kernelMs=P8(c),u.getExtraProfileInfo=function(){return c.map(function(h,p){return{name:o[p],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:vs(),endMs:null}},t.prototype.endTimer=function(n){return Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=vs(),n)},t.prototype.getQueryTime=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){return Oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(a=n).endMs-a.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var a=this.texData.get(n).complexTensors;a!=null&&(a.real.dispose(),a.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var a=this.texData.get(n),r=a.texture,i=a.dtype,s=a.texShape,o=a.usage,u=a.isPacked,c=a.slice,d=c&&c.origDataId||n,h=this.dataRefCount.get(d);h>1?this.dataRefCount.set(d,h-1):(this.dataRefCount.delete(d),r!=null&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(r,s,o,u)));var p=this.texData.get(n);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return Oe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=be.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,a){var r=this;return a===void 0&&(a=128),this.getCPUBackend()!=null&&n.every(function(i){return r.texData.get(i.dataId).texture==null&&i.size<a})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,a){var r=this.makeOutput(n.shape,"complex64");return this.texData.get(r.dataId).complexTensors={real:be.keep(n.clone()),imag:be.keep(a.clone())},r},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,a,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,a,r);if(ht(r)===0)return Fa([],r,n.dtype);var i=this.texData.get(n.dataId).isPacked,s=o6(n.shape,a,r);if(i||!s){var o=Oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new KI(r):new VI(r),u=o.getCustomSetupFunc(a);return this.compileAndRun(o,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,a,r)},t.prototype.shallowSlice=function(n,a,r){var i=this.texData.get(n.dataId),s=this.makeOutput(r,n.dtype),o=this.texData.get(s.dataId);Object.assign(o,i),o.shape=r,o.dtype=n.dtype;var u=l6(a,n.strides);i.slice&&(u+=i.slice.flatOffset),o.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var c=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,c+1),s},t.prototype.stridedSlice=function(n,a,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,a,r,i);var s=Q2(a,r,i);if(s.some(function(u){return u===0}))return Fa([],s);var o=new $I(a,i,s);return this.compileAndRun(o,[n])},t.prototype.reverse=function(n,a){var r=Oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HI(n.shape,a):new qI(n.shape,a);return this.compileAndRun(r,[n])},t.prototype.concat=function(n,a){if(n[0].dtype==="complex64"){var r=n.map(function(f){return wi(f)}),i=n.map(function(f){return ys(f)});return Ia(this.concat(r,a),this.concat(i,a))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,a);if(n.length===1)return n[0];if(n.length>Oe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(n.length/2),o=this.concat(n.slice(0,s),a),u=this.concat(n.slice(s),a);return this.concat([o,u],a)}if(Oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var c=new F7(n.map(function(f){return f.shape}),a);return this.compileAndRun(c,n)}var d=Ud(n.map(function(f){return f.shape}),a),h=n.map(function(f){return f.as2D(-1,ht(f.shape.slice(a)))}),p=new O7(h.map(function(f){return f.shape}));return this.compileAndRun(p,h).reshape(d)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,P3,n.dtype);var a=new Pt(n.shape,P3);return this.compileAndRun(a,[n])},t.prototype.batchMatMul=function(n,a,r,i){var s=r?n.shape[2]:n.shape[1],o=i?a.shape[1]:a.shape[2],u=r?n.shape[1]:n.shape[2],c=n.shape[0];if((s===1||o===1)&&u>1e3){r&&(n=n.transpose([0,2,1])),i&&(a=a.transpose([0,2,1]));var d=o===1?n:n.as3D(c,u,1),h=o===1?2:1,p=o===1?a.as3D(c,1,u):a;return this.multiply(d,p).sum(h,!0)}var f=Oa(n.dtype,a.dtype),g=new bb(n.shape,[c,s,o],r,i);return this.compileAndRun(g,[n,a],f)},t.prototype.fusedBatchMatMul=function(n){var a=n.a,r=n.b,i=n.transposeA,s=n.transposeB,o=n.bias,u=n.activation,c=n.preluActivationWeights,d=i?a.shape[2]:a.shape[1],h=s?r.shape[1]:r.shape[2],p=a.shape[0],f=Oa(a.dtype,r.dtype),g=o!=null,b=c!=null,w=u?qm(u,!0):null,m=new bb(a.shape,[p,d,h],i,s,g,w,b),x=[a,r];return o&&x.push(o),c&&x.push(c),this.compileAndRun(m,x,f)},t.prototype.multiply=function(n,a){if(n.dtype==="complex64"){var r=this.texData.get(n.dataId),i=this.texData.get(a.dataId),s=new N3(R7,n.shape,a.shape),o=new N3(L7,n.shape,a.shape),u=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag),this.makeComplexComponentTensorInfo(a,i.complexTensors.real),this.makeComplexComponentTensorInfo(a,i.complexTensors.imag)],c=this.compileAndRun(s,u),d=this.compileAndRun(o,u),h=this.complex(c,d);return c.dispose(),d.dispose(),h}if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.multiply(n,a);if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,k3,n.dtype);var p=new Bn(k3,n.shape,a.shape);return this.compileAndRun(p,[n,a],n.dtype)},t.prototype.batchNormalization=function(n,a,r,i,s,o){var u=[n,a,r],c=null;o!=null&&(c=o.shape,u.push(o));var d=null;if(s!=null&&(d=s.shape,u.push(s)),Oe().getBool("WEBGL_PACK_NORMALIZATION")){var h=new T7(n.shape,a.shape,r.shape,c,d,i);return this.compileAndRun(h,u)}var p=new D7(n.shape,a.shape,r.shape,c,d,i);return this.compileAndRun(p,u)},t.prototype.localResponseNormalization4D=function(n,a,r,i,s){var o=Oe().getBool("WEBGL_PACK_NORMALIZATION")?new CI(n.shape,a,r,i,s):new _I(n.shape,a,r,i,s);return this.compileAndRun(o,[n])},t.prototype.LRNGrad=function(n,a,r,i,s,o,u){var c=new jI(a.shape,i,s,o,u);return this.compileAndRun(c,[a,r,n])},t.prototype.tile=function(n,a){if(n.dtype==="string"){var r=this.readSync(n.dataId).map(function(s){return l0(s)});return g6(Et(n.shape,n.dtype,r),a)}var i=new XI(n.shape,a);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,a,r){var i=Oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new PI(n.shape,a,r):new LI(n.shape,a,r);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,a);var r=Oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new QI(n.shape,a):new JI(n.shape,a);return this.compileAndRun(r,[n])},t.prototype.gather=function(n,a,r){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.gather(n,a,r);var i=new iI(n.shape,a.size,r);return this.compileAndRun(i,[n,a])},t.prototype.batchToSpaceND=function(n,a,r){se(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=a.reduce(function(h,p){return h*p}),s=p0(n.shape,a,i),o=m0(s.length,a.length),u=g0(n.shape,a,i),c=a6(r,a.length),d=r6(u,r,a.length);return n.reshape(s).transpose(o).reshape(u).slice(c,d)},t.prototype.spaceToBatchND=function(n,a,r){se(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=a.reduce(function(p,f){return p*f}),s=[[0,0]];s.push.apply(s,r);for(var o=1+a.length;o<n.shape.length;++o)s.push([0,0]);var u=n.pad(s),c=p0(u.shape,a,i,!1),d=m0(c.length,a.length,!1),h=g0(u.shape,a,i,!1);return u.reshape(c).transpose(d).reshape(h)},t.prototype.reduce=function(n,a,r){var i=n.shape[0],s=n.shape[1],o=gb(s),u=new MI({windowSize:o,inSize:s,batchSize:i},a),c=this.compileAndRun(u,[n],r);return c.shape[1]===1?c:this.reduce(c,a,r)},t.prototype.argReduce=function(n,a,r){r===void 0&&(r=null);var i=n.shape[0],s=n.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);var o=gb(s),u=new w7({windowSize:o,inSize:s,batchSize:i},a,r==null),c=[n];r!=null&&c.push(r);var d=this.compileAndRun(u,c,"int32");return d.shape[1]===1?d:this.argReduce(n,a,d)},t.prototype.argReducePacked=function(n,a,r){r===void 0&&(r=null);var i=r!=null?r.shape:n.shape,s=gb(i[i.length-1]),o=new C7(i,s,a,r==null),u=r==null?[n]:[n,r],c=this.compileAndRun(o,u,"int32");return c.rank===n.rank?this.argReducePacked(n,a,c):c},t.prototype.sum=function(n,a){qr("sum",a,n.rank);var r=$a(n.shape,a),i=r[0],s=ht(r[1]),o=n.as2D(-1,s),u=lb(n.dtype);return this.reduce(o,"sum",u).reshape(i)},t.prototype.prod=function(n,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,a);var r=$a(n.shape,a),i=r[0],s=ht(r[1]),o=n.as2D(-1,s),u=lb(n.dtype);return this.reduce(o,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,a,r){var i=0,s=Bs([i],n.rank),o=n;s!=null&&(o=n.transpose(s),i=zs(1,n.rank)[0]);var u=function(f,g,b){for(var w=[],m=f.length,x=0;x<m;x++)x!==g?w.push(f[x]):w.push(b);return w}(o.shape,i,r),c=ht([o.shape[i]]),d=o.as2D(-1,c),h=lb(n.dtype),p=this.segOpCompute(d,"unsortedSegmentSum",a,h,r).reshape(u);return s!=null&&(p=p.transpose($2(s))),p},t.prototype.segOpCompute=function(n,a,r,i,s){var o=n.shape[0],u=n.shape[1],c=function(p,f){var g,b=!1;for(p<=s6?(g=p,b=!0):g=ey(p,Math.floor(Math.sqrt(p)));!b;)g>f||g===p?b=!0:g=ey(p,g+1);return g}(u,s),d=new WI({windowSize:c,inSize:u,batchSize:o,numSegments:s}),h=this.compileAndRun(d,[n,r],i);return h.shape[1]===s?h:(r=f0(0,s).tile([u/c]),this.segOpCompute(h,a,r,i,s))},t.prototype.argMinMaxReduce=function(n,a,r){var i=[a];if(qr("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,n.rank),!Oe().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var s=$a(n.shape,i),o=s[0],u=ht(s[1]),c=n.as2D(-1,u);return this.argReduce(c,r).reshape(o)}return this.argReducePacked(n,r)},t.prototype.argMin=function(n,a){return this.argMinMaxReduce(n,a,"min")},t.prototype.argMax=function(n,a){return this.argMinMaxReduce(n,a,"max")},t.prototype.cumsum=function(n,a,r,i){if(a!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+a);var s=new K7(n.shape,r,i);return this.compileAndRun(s,[n])},t.prototype.equal=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(equal(a, b));
`,"bool");var r=new Bn("return float(a == b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.notEqual=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(notEqual(a, b));
`,"bool");var r=new Bn("return float(a != b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.less=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.less(n,a);if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(lessThan(a, b));
`,"bool");var r=new Bn("return float(a < b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.lessEqual=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(lessThanEqual(a, b));
`,"bool");var r=new Bn("return float(a <= b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.greater=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.greater(n,a);if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(greaterThan(a, b));
`,"bool");var r=new Bn("return float(a > b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.greaterEqual=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var r=new Bn("return float(a >= b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.logicalNot=function(n){var a=new Pt(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(a,[n])},t.prototype.logicalAnd=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var r=new Bn("return float(a >= 1.0 && b >= 1.0);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.logicalOr=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var r=new Bn("return float(a >= 1.0 || b >= 1.0);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.select=function(n,a,r){var i=new GI(n.rank,a.shape,a.rank);return this.compileAndRun(i,[n,a,r],Oa(a.dtype,r.dtype))},t.prototype.where=function(n){d0("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var a=n.dataSync();return nw(n.shape,a)},t.prototype.topk=function(n,a,r){return v6(n.dataSync(),n.shape,n.dtype,a)},t.prototype.min=function(n,a){qr("min",a,n.rank);var r=$a(n.shape,a),i=r[0],s=ht(r[1]),o=n.as2D(-1,s);return this.reduce(o,"min",o.dtype).reshape(i)},t.prototype.minimum=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.minimum(n,a);var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Bn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.mod=function(n,a){var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Bn(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.max=function(n,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,a);qr("max",a,n.rank);var r=$a(n.shape,a),i=r[0],s=ht(r[1]),o=n.as2D(-1,s);return this.reduce(o,"max",o.dtype).reshape(i)},t.prototype.maximum=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.maximum(n,a);var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Bn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.all=function(n,a){qr("all",a,n.rank);var r=$a(n.shape,a),i=r[0],s=ht(r[1]),o=n.as2D(-1,s);return this.reduce(o,"all",o.dtype).reshape(i)},t.prototype.any=function(n,a){qr("any",a,n.rank);var r=$a(n.shape,a),i=r[0],s=ht(r[1]),o=n.as2D(-1,s);return this.reduce(o,"any",o.dtype).reshape(i)},t.prototype.realDivide=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var r=new Bn(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,a.shape);return this.compileAndRun(r,[n,a],"float32")},t.prototype.floorDiv=function(n,a){if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var r=new Bn(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,a.shape);return this.compileAndRun(r,[n,a],"int32")},t.prototype.add=function(n,a){if(n.dtype==="complex64"&&a.dtype==="complex64")return this.complexSeparableBinaryOp(n,a,vb);if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.add(n,a);var r=Oa(n.dtype,a.dtype);if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,vb,r);var i=new Bn(vb,n.shape,a.shape);return this.compileAndRun(i,[n,a],r)},t.prototype.packedUnaryOp=function(n,a,r){var i=new Gh(n.shape,a);return this.compileAndRun(i,[n],r)},t.prototype.packedBinaryOp=function(n,a,r,i,s){s===void 0&&(s=!1);var o=new ro(r,n.shape,a.shape,s);return this.compileAndRun(o,[n,a],i)},t.prototype.complexSeparableBinaryOp=function(n,a,r){var i=this,s=this.texData.get(n.dataId),o=this.texData.get(a.dataId),u=[[s.complexTensors.real,o.complexTensors.real],[s.complexTensors.imag,o.complexTensors.imag]].map(function(p){var f=p[0],g=p[1],b=i.makeComplexComponentTensorInfo(n,f),w=i.makeComplexComponentTensorInfo(a,g),m=new Bn(r,n.shape,a.shape);return i.compileAndRun(m,[b,w],Oa(f.dtype,g.dtype))}),c=u[0],d=u[1],h=this.complex(c,d);return c.dispose(),d.dispose(),h},t.prototype.makeComplexComponentTensorInfo=function(n,a){return{dataId:a.dataId,dtype:a.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>Oe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),r=this.addN(n.slice(0,a)),i=this.addN(n.slice(a));return this.addN([r,i])}var s=n.map(function(c){return c.dtype}).reduce(function(c,d){return Oa(c,d)}),o=n.map(function(c){return c.shape}),u=Oe().getBool("WEBGL_PACK")?new y7(n[0].shape,o):new b7(n[0].shape,o);return this.compileAndRun(u,n,s)},t.prototype.subtract=function(n,a){if(n.dtype==="complex64"&&a.dtype==="complex64")return this.complexSeparableBinaryOp(n,a,xb);if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.subtract(n,a);var r=Oa(n.dtype,a.dtype);if(Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,xb,n.dtype);var i=new Bn(xb,n.shape,a.shape);return this.compileAndRun(i,[n,a],r)},t.prototype.pow=function(n,a){var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Bn(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,a.shape),i=Oa(n.dtype,a.dtype);return this.compileAndRun(r,[n,a],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,M3,n.dtype);var a=new Pt(n.shape,M3);return this.compileAndRun(a,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,I3,n.dtype);var a=new Pt(n.shape,I3);return this.compileAndRun(a,[n])},t.prototype.sign=function(n){var a=new Pt(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(a,[n])},t.prototype.isNaN=function(n){var a=new Pt(n.shape,"return float(isnan(x));");return this.compileAndRun(a,[n],"bool")},t.prototype.isInf=function(n){var a=new Pt(n.shape,"return float(isinf(x));");return this.compileAndRun(a,[n],"bool")},t.prototype.isFinite=function(n){var a=new Pt(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(a,[n],"bool")},t.prototype.round=function(n){var a=new Pt(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(a,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,O3,n.dtype);var a=new Pt(n.shape,O3);return this.compileAndRun(a,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,F3,n.dtype);var a=new Pt(n.shape,F3);return this.compileAndRun(a,[n])},t.prototype.softmax=function(n,a){var r=ba([a],n.shape),i=this.max(n,r),s=Er(i.shape,r),o=this.subtract(n,i.reshape(s)),u=this.exp(o),c=this.sum(u,r).reshape(s);return this.realDivide(u,c)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var a=new Pt(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(a,[n])},t.prototype.log1p=function(n){var a=new Pt(n.shape,"return log(1.0 + x);");return this.compileAndRun(a,[n])},t.prototype.sqrt=function(n){var a=new Pt(n.shape,"return sqrt(x);");return this.compileAndRun(a,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var a=new Pt(n.shape,"return inversesqrt(x);");return this.compileAndRun(a,[n])},t.prototype.reciprocal=function(n){var a=new Pt(n.shape,"return 1.0 / x;");return this.compileAndRun(a,[n])},t.prototype.relu=function(n){var a;return a=Oe().getBool("WEBGL_PACK")?new Gh(n.shape,j6):new Pt(n.shape,k6),this.compileAndRun(a,[n])},t.prototype.relu6=function(n){var a;return a=Oe().getBool("WEBGL_PACK")?new Gh(n.shape,C6):new Pt(n.shape,S6),this.compileAndRun(a,[n])},t.prototype.prelu=function(n,a){var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(N6,n.shape,a.shape):new Bn(w6,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.elu=function(n){if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,A6,n.dtype);var a=new Pt(n.shape,_6);return this.compileAndRun(a,[n])},t.prototype.eluDer=function(n,a){var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,a.shape):new Bn("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.selu=function(n){var a=new Pt(n.shape,eO);return this.compileAndRun(a,[n])},t.prototype.int=function(n){var a=new Pt(n.shape,"return float(int(x));");return this.compileAndRun(a,[n],"int32")},t.prototype.clip=function(n,a,r){var i,s=(i=Oe().getBool("WEBGL_PACK_CLIP")?new M7(n.shape):new P7(n.shape)).getCustomSetupFunc(a,r);return this.compileAndRun(i,[n],null,s)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(Oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,L3,n.dtype);var a=new Pt(n.shape,L3);return this.compileAndRun(a,[n])},t.prototype.complexAbs=function(n){var a=this.texData.get(n.dataId),r=new I7(n.shape),i=[this.makeComplexComponentTensorInfo(n,a.complexTensors.real),this.makeComplexComponentTensorInfo(n,a.complexTensors.imag)];return this.compileAndRun(r,i)},t.prototype.sigmoid=function(n){var a=new Pt(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(a,[n])},t.prototype.softplus=function(n){var a=new Pt(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(a,[n])},t.prototype.sin=function(n){var a=new Pt(n.shape,tO);return this.compileAndRun(a,[n])},t.prototype.cos=function(n){var a=new Pt(n.shape,nO);return this.compileAndRun(a,[n])},t.prototype.tan=function(n){var a=new Pt(n.shape,"return tan(x);");return this.compileAndRun(a,[n])},t.prototype.asin=function(n){var a=new Pt(n.shape,aO);return this.compileAndRun(a,[n])},t.prototype.acos=function(n){var a=new Pt(n.shape,rO);return this.compileAndRun(a,[n])},t.prototype.atan=function(n){var a=new Pt(n.shape,iO);return this.compileAndRun(a,[n])},t.prototype.atan2=function(n,a){var r=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Bn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.sinh=function(n){var a=new Pt(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(a,[n])},t.prototype.cosh=function(n){var a=new Pt(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(a,[n])},t.prototype.tanh=function(n){var a=new Pt(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(a,[n])},t.prototype.asinh=function(n){var a=new Pt(n.shape,sO);return this.compileAndRun(a,[n])},t.prototype.acosh=function(n){var a=new Pt(n.shape,oO);return this.compileAndRun(a,[n])},t.prototype.atanh=function(n){var a=new Pt(n.shape,lO);return this.compileAndRun(a,[n])},t.prototype.erf=function(n){var a=new Pt(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(a,[n])},t.prototype.step=function(n,a){var r=new Pt(n.shape,function(i){return i===void 0&&(i=0),Zi+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(a));return this.compileAndRun(r,[n])},t.prototype.conv2dByMatMul=function(n,a,r,i,s,o){var u=n.shape,c=this.texData.get(n.dataId),d=r.inChannels,h=u[0]*u[1]*u[2],p=r.outChannels,f=r.dataFormat==="channelsLast",g=(h===1||p===1)&&d>1e3,b=u[2]%2!=0&&!!c.isPacked;if(g||!Oe().getBool("WEBGL_LAZILY_UNPACK")||!Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){var w=f?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],m=this.reshape(n,[1,w,r.inChannels]),x=this.reshape(a,[1,r.inChannels,r.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:x,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o}),r.outShape)}var y=f?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),N={dataId:n.dataId,shape:[1,y,r.inChannels],dtype:n.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,se(Fm(c.shape,N.shape),function(){return"packed reshape "+c.shape+" to "+N.shape+" isn't free"});var T=this.reshape(a,[1,r.inChannels,r.outChannels]),C=this.fusedBatchMatMul({a:N,b:T,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o}),A=this.texData.get(C.dataId);return se(A.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=S,A.shape=r.outShape,be.makeTensorFromDataId(C.dataId,r.outShape,C.dtype)},t.prototype.conv2dWithIm2Row=function(n,a,r,i,s,o){var u=r.filterWidth,c=r.filterHeight,d=r.inChannels,h=r.outWidth,p=r.outHeight,f=r.dataFormat==="channelsLast",g=u*c*d,b=p*h,w=[g,b],m=n.squeeze([0]),x=a.reshape([1,g,-1]),y=new SI(w,m.shape,r),N=this.compileAndRun(y,[m]).reshape([1,w[0],w[1]]),S=i!=null,T=o!=null,C=s?qm(s,!0):null,A=new bb(N.shape,[1,b,r.outChannels],!0,!1,S,C,T),R=[N,x];i&&R.push(i),T&&R.push(o);var L=this.compileAndRun(A,R);return f?L.reshape([1,p,h,r.outChannels]):L.reshape([1,r.outChannels,p,h])},t.prototype.fusedConv2d=function(n){var a=n.input,r=n.filter,i=n.convInfo,s=n.bias,o=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(a,r,i,s,o,u);if(Oe().getBool("WEBGL_CONV_IM2COL")&&a.shape[0]===1)return this.conv2dWithIm2Row(a,r,i,s,o,u);var c=s!=null,d=u!=null,h=o?qm(o,!1):null,p=new S3(i,c,h,d),f=[a,r];return s&&f.push(s),u&&f.push(u),this.compileAndRun(p,f)},t.prototype.conv2d=function(n,a,r){if(r.filterHeight===1&&r.filterWidth===1&&r.dilationHeight===1&&r.dilationWidth===1&&r.strideHeight===1&&r.strideWidth===1&&(r.padInfo.type==="SAME"||r.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,r);if(Oe().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,r);var i=new S3(r);return this.compileAndRun(i,[n,a])},t.prototype.conv2dDerInput=function(n,a,r){var i=new z7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv2dDerFilter=function(n,a,r){var i=new B7(r);return this.compileAndRun(i,[n,a])},t.prototype.fusedDepthwiseConv2D=function(n){var a,r=n.input,i=n.filter,s=n.convInfo,o=n.bias,u=n.activation,c=n.preluActivationWeights,d=Oe().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,h=u?qm(u,d):null,p=[r,i],f=o!=null,g=c!=null;return f&&p.push(o),g&&p.push(c),d?(a=new j3(s,f,h,g),this.compileAndRun(a,p)):(a=new _3(s,f,h,g),this.compileAndRun(a,p))},t.prototype.depthwiseConv2D=function(n,a,r){var i;return Oe().getBool("WEBGL_PACK_DEPTHWISECONV")&&r.strideWidth<=2&&r.outChannels/r.inChannels==1?(i=new j3(r),this.compileAndRun(i,[n,a])):(i=new _3(r),this.compileAndRun(i,[n,a]))},t.prototype.depthwiseConv2DDerInput=function(n,a,r){var i=new W7(r);return this.compileAndRun(i,[n,a])},t.prototype.depthwiseConv2DDerFilter=function(n,a,r){var i=new H7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv3d=function(n,a,r){var i=new G7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv3dDerInput=function(n,a,r){var i=new q7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv3dDerFilter=function(n,a,r){var i=new U7(r);return this.compileAndRun(i,[n,a])},t.prototype.maxPool=function(n,a){var r=new yb(a,"max",!1);return this.compileAndRun(r,[n])},t.prototype.avgPool=function(n,a){var r=new yb(a,"avg",!1);return this.compileAndRun(r,[n],"float32")},t.prototype.maxPoolBackprop=function(n,a,r,i){var s=new yb(i,"max",!0),o=this.compileAndRun(s,[a]),u=new AI(i),c=this.compileAndRun(u,[n,o],a.dtype);return o.dispose(),c},t.prototype.avgPoolBackprop=function(n,a,r){var i=new A7(r);return this.compileAndRun(i,[n],a.dtype)},t.prototype.cast=function(n,a){return h6(n,a,this)},t.prototype.unstack=function(n,a){for(var r=n.shape[a],i=new Array(n.rank-1),s=0,o=0;o<n.rank;o++)o!==a&&(i[s++]=n.shape[o]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[a]=1;var d=new Array(r);for(o=0;o<d.length;o++)u[a]=o,d[o]=this.slice(n,u,c).reshape(i);return d},t.prototype.avgPool3d=function(n,a){var r=new wb(a,"avg",!1);return this.compileAndRun(r,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,a,r){var i=new E7(r);return this.compileAndRun(i,[n],a.dtype)},t.prototype.maxPool3d=function(n,a){var r=new wb(a,"max",!1);return this.compileAndRun(r,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,a,r,i){var s=new wb(i,"max",!0),o=this.compileAndRun(s,[a]),u=new EI(i),c=this.compileAndRun(u,[n,o],a.dtype);return o.dispose(),c},t.prototype.reshape=function(n,a){var r=this.texData.get(n.dataId);if(r.isPacked&&!Fm(n.shape,a)&&(r.texture===null||!Fm(r.shape,a))){var i=this.packedReshape(n,a);return be.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return ly(n,a)},t.prototype.resizeBilinear=function(n,a,r,i){var s=Oe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new BI(n.shape,a,r,i):new FI(n.shape,a,r,i);return this.compileAndRun(s,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,a,r){var i=new OI(n,a,r);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,a,r,i){var s=new UI(n.shape,a,r,i);return this.compileAndRun(s,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,a,r){var i=new zI(n,a,r);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,a,r,i){var s=a?n:_o(n),o=s.shape[0],u=s.shape[1],c=new DI(o,u,r),d=c.getCustomSetupFunc(i);return this.compileAndRun(c,[s],"int32",d)},t.prototype.oneHot=function(n,a,r,i){var s=new TI(n.size,a,r,i);return this.compileAndRun(s,[n])},t.prototype.diag=function(n){var a=new J7(n.size);return this.compileAndRun(a,[n])},t.prototype.nonMaxSuppression=function(n,a,r,i,s){return d0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),ew(n.dataSync(),a.dataSync(),r,i,s)},t.prototype.cropAndResize=function(n,a,r,i,s,o){var u=new V7(n.shape,a.shape,i,s,o);return this.compileAndRun(u,[n,a,r],"float32")},t.prototype.depthToSpace=function(n,a,r){se(a>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+a});var i=n.shape[0],s=r==="NHWC"?n.shape[1]:n.shape[2],o=r==="NHWC"?n.shape[2]:n.shape[3],u=r==="NHWC"?n.shape[3]:n.shape[1],c=s*a,d=o*a,h=u/(a*a),p=new X7(r==="NHWC"?[i,c,d,h]:[i,h,c,d],a,r);return this.compileAndRun(p,[n])},t.prototype.split=function(n,a,r){return m6(n,a,r)},t.prototype.scatterND=function(n,a,r){var i=v0(0,n,r),s=i.sliceRank,o=i.numUpdates,u=i.sliceSize,c=i.strides,d=i.outputSize,h=[d/u,u],p=n.reshape([o,s]),f=a.reshape([o,u]);if(d===0)return ly(Fa([]),r);var g=at(0),b=new D3(o,s,p.rank,f.rank,c,h);return this.compileAndRun(b,[f,p,g]).reshape(r)},t.prototype.sparseToDense=function(n,a,r,i){var s=v0(0,n,r),o=s.sliceRank,u=s.numUpdates,c=s.strides,d=s.outputSize,h=new D3(u,o,n.rank,a.rank,c,[d,1]);return this.compileAndRun(h,[a,n,i]).reshape(r)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,a){var r=this.texData.get(n.dataId),i=new A3(nI,n.shape,a),s=new A3(aI,n.shape,a),o=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)],u=this.compileAndRun(i,o),c=this.compileAndRun(s,o),d=this.complex(u,c).as2D(n.shape[0],n.shape[1]);return u.dispose(),c.dispose(),d},t.prototype.gatherND=function(n,a){var r=a.shape,i=r[r.length-1],s=i6(n,a),o=s[0],u=s[1],c=s[2],d=s[3],h=a.reshape([u,i]),p=n.reshape([n.size/c,c]),f=new sI(i,d,[u,c]);return this.compileAndRun(f,[p,h]).reshape(o)},t.prototype.fill=function(n,a,r){if((r=r||bp(a))==="string"){var i=o0(r,ht(n));return i.fill(a),be.makeTensor(i,n,r,this)}var s=new rI(n,a),o=s.getCustomSetupFunc(a);return this.compileAndRun(s,[],r,o)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,a,r){return f6(n,a,r)},t.prototype.makeTensorInfo=function(n,a){var r=this.write(null,n,a);return this.texData.get(r).usage=null,{dataId:r,shape:n,dtype:a}},t.prototype.makeOutput=function(n,a){var r=this.makeTensorInfo(n,a).dataId;return be.makeTensorFromDataId(r,n,a,this)},t.prototype.unpackTensor=function(n){var a=new cO(n.shape);return this.runWebGLProgram(a,[n],n.dtype)},t.prototype.packTensor=function(n){var a=new RI(n.shape);return this.runWebGLProgram(a,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,a){var r=[u0(n.shape)].concat(c0(n.shape)),i={dtype:n.dtype,shape:r,dataId:n.dataId},s=[u0(a)].concat(c0(a)),o=new II(s,r),u=this.runWebGLProgram(o,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:a,dtype:u.dtype}},t.prototype.decode=function(n){var a,r=this.texData.get(n),i=r.isPacked,s=r.shape,o=r.dtype,u=mb(s);return a=i?new Y7(u):new $7(u),{dtype:o,shape:s,dataId:this.runWebGLProgram(a,[{shape:u,dtype:o,dataId:n}],o,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,a,r,i,s){var o=this;s===void 0&&(s=!1);var u=this.makeTensorInfo(n.outputShape,r),c=this.texData.get(u.dataId);if(n.packedOutput&&(c.isPacked=!0),n.outPackingScheme===zf.DENSE){var d=mf(n.outputShape);c.texShape=d.map(function(y){return 2*y})}if(n.outTexUsage!=null&&(c.usage=n.outTexUsage),ht(u.shape)===0)return c.values=Ff(u.dtype,0),u;var h=[],p=a.map(function(y){if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var N=o.texData.get(y.dataId);if(N.texture==null){if(!n.packedInputs&&ht(y.shape)<=Oe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:N.values};n.packedInputs&&(N.isPacked=!0,N.shape=y.shape)}else if(!!N.isPacked!=!!n.packedInputs)y=N.isPacked?o.unpackTensor(y):o.packTensor(y),h.push(y),N=o.texData.get(y.dataId);else if(N.isPacked&&!Fm(N.shape,y.shape)){var S=y,T=y.shape;y.shape=N.shape,y=o.packedReshape(y,T),h.push(y),N=o.texData.get(y.dataId),S.shape=T}return o.uploadToGPU(y.dataId),{shape:y.shape,texData:N,isUniform:!1}});this.uploadToGPU(u.dataId);var f,g={shape:u.shape,texData:c,isUniform:!1},b=function(y,N,S){var T="";N.concat(S).forEach(function(R){var L=R.texData!=null&&R.texData.slice!=null&&R.texData.slice.flatOffset>0,j=R.isUniform?"uniform":R.texData.texShape;T+=R.shape+"_"+j+"_"+L});var C=y.userCode,A=y.constructor.name;return A+="_"+T+"_"+C}(n,p,g),w=this.getAndSaveBinary(b,function(){return function(y,N,S,T){var C=N.userCode,A=S.map(function(q,O){var $={logicalShape:q.shape,texShape:q.isUniform?null:q.texData.texShape,isUniform:q.isUniform,isPacked:!q.isUniform&&q.texData.isPacked,flatOffset:null};return q.texData!=null&&q.texData.slice!=null&&q.texData.slice.flatOffset>0&&($.flatOffset=q.texData.slice.flatOffset),{name:N.variableNames[O],shapeInfo:$}}),R=A.map(function(q){return q.shapeInfo}),L={logicalShape:T.shape,texShape:T.texData.texShape,isUniform:!1,isPacked:T.texData.isPacked,flatOffset:null},j=N7(A,L,C,N.packedInputs),D=y.createProgram(j),B=null,z=y.getUniformLocation(D,"NAN",!1);Oe().getNumber("WEBGL_VERSION")===1&&(B=y.getUniformLocation(D,"INFINITY",!1));for(var U={},I=0;I<N.variableNames.length;I++){var F=N.variableNames[I];U[F]=y.getUniformLocation(D,F,!1),U["offset"+F]=y.getUniformLocation(D,"offset"+F,!1)}return{program:N,source:j,webGLProgram:D,uniformLocations:U,inShapeInfos:R,outShapeInfo:L,infLoc:B,nanLoc:z}}(o.gpgpu,n,p,g)}),m=this.activeTimers!=null;if(m&&(f=this.startTimer()),function(y,N,S,T,C){E3(N.inShapeInfos,S),E3([N.outShapeInfo],[T]);var A=T.texData.texture,R=T.texData.texShape;T.texData.isPacked?y.setOutputPackedMatrixTexture(A,R[0],R[1]):y.setOutputMatrixTexture(A,R[0],R[1]),y.setProgram(N.webGLProgram),Oe().getNumber("WEBGL_VERSION")===1&&N.infLoc!==null&&y.gl.uniform1f(N.infLoc,1/0),N.nanLoc!==null&&y.gl.uniform1f(N.nanLoc,NaN),S.forEach(function(L,j){var D=N.program.variableNames[j],B=N.uniformLocations[D],z=N.uniformLocations["offset"+D];if(B!=null)if(L.isUniform)if(ht(L.shape)<2)y.gl.uniform1f(B,L.uniformValues[0]);else{var U=L.uniformValues;U instanceof Float32Array||(U=new Float32Array(U)),y.gl.uniform1fv(B,U)}else L.texData.slice!=null&&z!=null&&y.gl.uniform1i(z,L.texData.slice.flatOffset),y.setInputMatrixTexture(L.texData.texture,B,j)}),C!=null&&C(y,N.webGLProgram),y.executeProgram()}(this.gpgpu,w,p,g,i),h.forEach(function(y){return o.disposeData(y.dataId)}),m&&(f=this.endTimer(f),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(f)})),!Oe().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&s===!1){var x=this.unpackTensor(u);return this.disposeData(u.dataId),x}return u},t.prototype.compileAndRun=function(n,a,r,i,s){s===void 0&&(s=!1),r=r||a[0].dtype;var o=this.runWebGLProgram(n,a,r,i,s);return be.makeTensorFromDataId(o.dataId,o.shape,o.dtype)},t.prototype.getAndSaveBinary=function(n,a){return n in this.binaryCache||(this.binaryCache[n]=a()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(Oe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(a){n.gpgpu.deleteProgram(n.binaryCache[a].webGLProgram),delete n.binaryCache[a]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=st(function(){if(!Oe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var a=Oe().getBool("DEBUG");Oe().set("DEBUG",!1);var r=n.abs(at(1e-8)).dataSync()[0];if(Oe().set("DEBUG",a),r>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var a,r=this.texData.get(n),i=r.shape,s=r.dtype,o=r.values,u=r.texture,c=r.usage,d=r.isPacked;if(u==null){var h,p=this.activeTimers!=null;p&&(h=vs());var f=r.texShape;if(f==null&&(f=xM(i,d),r.texShape=f),o!=null){var g=mb(i),b=void 0,w=f[1],m=f[0],x=o instanceof Uint8Array;d?(w=(a=wp(f[0],f[1]))[0],m=a[1],b=new tI(g,[m,w],x)):b=new eI(g,[m,w],x);var y=this.makeTensorInfo([m,w],s);this.texData.get(y.dataId).usage=x?Gr.PIXELS:Gr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),w,m,o);var N=this.runWebGLProgram(b,[y],s,null,!0),S=this.texData.get(N.dataId);r.texture=S.texture,r.texShape=S.texShape,r.isPacked=S.isPacked,r.usage=S.usage,this.disposeData(y.dataId),this.texData.delete(N.dataId),r.values=null,p&&(this.uploadWaitMs+=vs()-h)}else{var T=this.acquireTexture(f,c,s,d);r.texture=T}}},t.prototype.convertAndCacheOnCPU=function(n,a){var r=this.texData.get(n),i=r.dtype;return this.releaseGPUData(n),a!=null&&(r.values=function(s,o){if(o==="float32"||o==="complex64")return s;if(o==="int32"||o==="bool"){for(var u=o==="int32"?new Int32Array(s.length):new Uint8Array(s.length),c=0;c<u.length;++c)u[c]=Math.round(s[c]);return u}throw new Error("Unknown dtype "+o)}(a,i)),r.values},t.prototype.acquireTexture=function(n,a,r,i){if(this.numBytesInGPU+=this.computeBytes(n,r),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,a,i)},t.prototype.computeBytes=function(n,a){return n[0]*n[1]*Uj(a)},t}(c6);$j()&&be.registerBackend("webgl",function(){return new hO},2);var fO=he({square_:function(e){var t=te(e,"x","square"),n=[t];return be.runKernelFunc(function(a,r){return r([t]),a.square(t)},{x:t},null,"Square",{},n,[])}}),qf="SquaredDifference",E6=he({squaredDifference_:function(e,t){var n,a=te(e,"a","squaredDifference"),r=te(t,"b","squaredDifference");n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape);var i={a,b:r},s=[a,r];return be.runKernelFunc(function(o,u){var c=o.squaredDifference(a,r);return u([a,r]),c},i,function(o,u){var c=u[0],d=u[1],h=at(2);return{a:function(){return o.mul(c.sub(d).mul(h))},b:function(){return o.mul(d.sub(c).mul(h))}}},qf,{},s,[])}}),pO=he({abs_:function(e){var t=te(e,"x","abs");return t.dtype==="complex64"?be.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):be.runKernelFunc(function(n,a){var r=n.abs(t);return a([t]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return n.mul(r.toFloat().step(-1))}}},"Abs")}}),mO=he({acos_:function(e){var t=te(e,"x","acos");return be.runKernelFunc(function(n,a){var r=n.acos(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(at(1).sub(r.toFloat().square()).sqrt()).neg()}}})}}),gO=he({acosh_:function(e){var t=te(e,"x","acosh");return be.runKernelFunc(function(n,a){var r=n.acosh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(r.toFloat().square().sub(1).sqrt())}}})}}),vO=he({asin_:function(e){var t=te(e,"x","asin");return be.runKernelFunc(function(n,a){var r=n.asin(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(at(1).sub(r.toFloat().square()).sqrt())}}})}}),xO=he({asinh_:function(e){var t=te(e,"x","asinh");return be.runKernelFunc(function(n,a){var r=n.asinh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(at(1).add(r.toFloat().square()).sqrt())}}})}}),bO=he({atan_:function(e){var t=te(e,"x","atan");return be.runKernelFunc(function(n,a){var r=n.atan(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.toFloat().square().add(1))}}})}}),yO=he({atanh_:function(e){var t=te(e,"x","atanh");return be.runKernelFunc(function(n,a){var r=n.atanh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(at(1).sub(r.toFloat().square()))}}})}}),wO=he({ceil_:function(e){var t=te(e,"x","ceil");return be.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),sw=he({clipByValue_:function(e,t,n){var a=te(e,"x","clipByValue");se(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var r=[a],i={min:t,max:n};return be.runKernelFunc(function(s,o){var u=s.clip(a,t,n);return o([a]),u},{x:a},function(s,o){var u=o[0];return{x:function(){return s.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),Wt(s))}}},"ClipByValue",i,r)}}),NO=he({cos_:function(e){var t=te(e,"x","cos"),n=[t];return be.runKernelFunc(function(a,r){var i=a.cos(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return i.toFloat().sin().neg().mul(a)}}},"Cos",{},n)}}),kO=he({cosh_:function(e){var t=te(e,"x","cosh");return be.runKernelFunc(function(n,a){var r=n.cosh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return r.toFloat().sinh().mulStrict(n)}}})}}),SO=he({erf_:function(e){var t=te(e,"x","erf");return se(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),be.runKernelFunc(function(n,a){var r=n.erf(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),cy=he({exp_:function(e){var t=te(e,"x","exp");return be.runKernelFunc(function(n,a){var r=n.exp(t);return a([r]),r},{x:t},function(n,a){return{x:function(){return n.mulStrict(a[0])}}},"Exp",{},[],[!0])}}),_O=he({expm1_:function(e){var t=te(e,"x","expm1");return be.runKernelFunc(function(n,a){var r=n.expm1(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.exp())}}})}}),jO=he({floor_:function(e){var t=te(e,"x","floor");return be.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),CO=he({log_:function(e){var t=te(e,"x","log"),n=[t];return be.runKernelFunc(function(a,r){var i=a.log(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return a.div(i.toFloat())}}},"Log",{},n)}}),AO=he({log1p_:function(e){var t=te(e,"x","log1p");return be.runKernelFunc(function(n,a){var r=n.log1p(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.add(1))}}})}}),EO=he({logSigmoid_:function(e){var t=te(e,"x","logSigmoid");return be.runKernelFunc(function(n,a){var r=n.softplus(t.neg()).neg();return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.neg().sigmoid())}}})}}),w0=he({neg_:function(e){var t=te(e,"x","neg"),n=[t];return be.runKernelFunc(function(a){return a.neg(t)},{x:t},function(a){return{x:function(){return a.neg()}}},"Neg",{},n)}}),DO=he({reciprocal_:function(e){var t=te(e,"x","reciprocal");return be.runKernelFunc(function(n,a){var r=n.reciprocal(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.square().neg())}}})}}),TO=he({round_:function(e){var t=te(e,"x","round");return be.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),D6=he({rsqrt_:function(e){var t=te(e,"x","rsqrt"),n=[t];return be.runKernelFunc(function(a,r){var i=a.rsqrt(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return a.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),T6=he({sigmoid_:function(e){var t=te(e,"x","sigmoid");return be.runKernelFunc(function(n,a){var r=n.sigmoid(t);return a([r]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return n.mul(r.mul(at(1).sub(r)))}}},"Sigmoid")}}),RO=he({sign_:function(e){var t=te(e,"x","sign");return be.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),LO=he({isNaN_:function(e){var t=te(e,"x","isNaN");return be.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),PO=he({isInf_:function(e){var t=te(e,"x","isInf");return be.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),MO=he({isFinite_:function(e){var t=te(e,"x","isFinite");return be.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Wt(n)}}})}}),IO=he({sin_:function(e){var t=te(e,"x","sin"),n=[t];return be.runKernelFunc(function(a,r){var i=a.sin(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return i.toFloat().cos().mul(a)}}},"Sin",{},n)}}),OO=he({sinh_:function(e){var t=te(e,"x","sinh");return be.runKernelFunc(function(n,a){var r=n.sinh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return r.toFloat().cosh().mulStrict(n)}}})}}),FO=he({softplus_:function(e){var t=te(e,"x","softplus");return be.runKernelFunc(function(n,a){var r=n.softplus(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.sigmoid())}}})}}),BO=he({sqrt_:function(e){var t=te(e,"x","sqrt");return be.runKernelFunc(function(n,a){var r=n.sqrt(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.toFloat().sqrt().mul(2))}}})}}),zO=he({step_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","step");return be.runKernelFunc(function(a){return a.step(n,t)},{$x:n},function(a){return{$x:function(){return Wt(a)}}})}}),UO=he({tan_:function(e){var t=te(e,"x","tan");return be.runKernelFunc(function(n,a){var r=n.tan(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.cos().square())}}})}}),qO=he({tanh_:function(e){var t=te(e,"x","tanh");return be.runKernelFunc(function(n,a){var r=n.tanh(t);return a([r]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return at(1).sub(r.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function R6(e,t,n,a,r,i){var s,o,u=te(e,"x","batchNorm"),c=te(t,"mean","batchNorm"),d=te(n,"variance","batchNorm");return r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),se(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),se(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),s!=null&&se(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),o!=null&&se(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+o.rank+"."}),kp(u,c,d,o,s,i)}function L6(e,t,n,a,r,i){var s,o,u=te(e,"x","batchNorm"),c=te(t,"mean","batchNorm"),d=te(n,"variance","batchNorm");return r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),se(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),se(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),s!=null&&se(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),o!=null&&se(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+o.rank+"."}),kp(u,c,d,o,s,i)}function P6(e,t,n,a,r,i){var s,o,u=te(e,"x","batchNorm"),c=te(t,"mean","batchNorm"),d=te(n,"variance","batchNorm");return r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),se(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),se(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),s!=null&&se(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),o!=null&&se(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+o.rank+"."}),kp(u,c,d,o,s,i)}function kp(e,t,n,a,r,i){i==null&&(i=.001);var s,o,u,c=te(e,"x","batchNorm"),d=te(t,"mean","batchNorm"),h=te(n,"variance","batchNorm");r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(d.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),se(o==null||d.rank===o.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),se(s==null||d.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=c.rank===0||c.rank===1?c.as4D(1,1,1,c.size):c.rank===2?c.as4D(1,1,c.shape[0],c.shape[1]):c.rank===3?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var p=[c,d,h,s];return be.runKernelFunc(function(f,g){var b=f.batchNormalization(u,Hm(d),Hm(h),i,Hm(s),Hm(o));return g([c,d,h,s]),b},{x:c,mean:d,variance:h,scale:s,offset:o},function(f,g){var b=g,w=b[0],m=b[1],x=b[2],y=b[3],N=y??at(1),S=va(m.shape,u.shape),T=[];if(m.rank===1){for(var C=0;C<u.shape.length-1;++C)T.push(u.shape[C]);T.push(1)}var A=w.sub(m),R=f.mul(N),L=D6(x.add(at(i))),j=L.mul(L).mul(L).mul(at(-.5));return{x:function(){return m.rank===1?f.mul(md(L.as4D(1,1,1,m.shape[0]),T)).mul(N).reshape(w.shape):f.mul(L).mul(N).reshape(w.shape)},mean:function(){var D=L.mul(at(-1)).mul(R);return m.rank===1&&(D=D.sum(S)),D.reshape(m.shape)},variance:function(){var D=j.mul(A).mul(R);return m.rank===1&&(D=D.sum(S)),D.reshape(m.shape)},scale:function(){var D=A.mul(L),B=f.mul(D);return m.rank===1&&(B=B.sum(S)),B.reshape(m.shape)},offset:function(){var D=f;return m.rank===1&&(D=D.sum(S)),D.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:i},p).reshape(c.shape)}function Hm(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function mv(){Yj("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var HO=he({batchNormalization2d_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),mv(),R6(e,t,n,i,r,a)}}),WO=he({batchNormalization3d_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),mv(),L6(e,t,n,i,r,a)}}),GO=he({batchNormalization4d_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),mv(),P6(e,t,n,i,r,a)}}),VO=he({batchNormalization_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),mv(),kp(e,t,n,i,r,a)}}),M6=he({batchNorm_:kp}),KO=he({batchNorm2d_:R6}),$O=he({batchNorm3d_:L6}),YO=he({batchNorm4d_:P6}),gv=he({logicalAnd_:function(e,t){var n=te(e,"a","logicalAnd","bool"),a=te(t,"b","logicalAnd","bool");return zt(n.shape,a.shape),be.runKernelFunc(function(r){return r.logicalAnd(n,a)},{a:n,b:a},null,"LogicalAnd")}}),XO=he({logicalNot_:function(e){var t=te(e,"x","logicalNot","bool");return be.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),I6=he({logicalOr_:function(e,t){var n=te(e,"a","logicalOr","bool"),a=te(t,"b","logicalOr","bool");return zt(n.shape,a.shape),be.runKernelFunc(function(r){return r.logicalOr(n,a)},{$a:n,$b:a})}}),JO=he({logicalXor_:function(e,t){var n=te(e,"a","logicalXor","bool"),a=te(t,"b","logicalXor","bool");return zt(n.shape,a.shape),I6(e,t).logicalAnd(gv(e,t).logicalNot())}}),Iu=he({where_:function(e,t,n){var a=te(t,"a","where"),r=te(n,"b","where"),i=te(e,"condition","where","bool");return tn(a.shape,r.shape,"Error in where: "),i.rank===1?se(i.shape[0]===a.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):tn(i.shape,r.shape,"Error in where: "),be.runKernelFunc(function(s,o){var u=s.select(i,a,r);return o([i]),u},{$condition:i,$a:a,$b:r},function(s,o){var u=o[0];return{$condition:function(){return Wt(u).toFloat()},$a:function(){return s.mul(u.cast(s.dtype))},$b:function(){return s.mul(u.logicalNot().cast(s.dtype))}}})}}),O6=function(e){return lt(this,void 0,void 0,function(){var t,n,a;return ut(this,function(r){switch(r.label){case 0:return[4,(t=te(e,"condition","whereAsync","bool")).data()];case 1:return n=r.sent(),a=nw(t.shape,n),e!==t&&t.dispose(),[2,a]}})})},Ot=he({add_:function(e,t){var n,a=te(e,"a","add"),r=te(t,"b","add");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s){return s.add(a,r)},{a,b:r},function(s){return{a:function(){var o=s,u=va(a.shape,i);return u.length>0&&(o=o.sum(u)),o.reshape(a.shape)},b:function(){var o=s,u=va(r.shape,i);return u.length>0&&(o=o.sum(u)),o.reshape(r.shape)}}},"Add")}}),QO=he({addN_:function(e){se(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),se(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(r,i){return te(r,"tensors"+i,"addN")}),n=t[0];t.forEach(function(r){if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(r){if(!Aa(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var a=t;return be.runKernelFunc(function(r){return r.addN(t)},a,function(r){var i={};return t.forEach(function(s,o){i[o]=function(){return r.clone()}}),i},"AddN")}}),ZO=he({addStrict_:function(e,t){var n=te(e,"a","addStrict"),a=te(t,"b","addStrict");return tn(n.shape,a.shape,"Error in addStrict: "),n.add(a)}}),eF=he({atan2_:function(e,t){var n,a=te(e,"a","atan2"),r=te(t,"b","atan2");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s,o){var u=s.atan2(a,r);return o([a,r]),u},{$a:a,$b:r},function(s,o){var u=o[0],c=o[1];return{$a:function(){var d=Ot(u.square(),c.square()),h=s.mul(c.div(d)),p=va(u.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(u.shape)},$b:function(){var d=Ot(u.square(),c.square()),h=w0(s.mul(u.div(d))),p=va(c.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(c.shape)}}})}}),Vi=he({div_:function(e,t){var n,a=te(e,"a","div"),r=te(t,"b","div");if(n=Pn(a,r),a=n[0],r=n[1],a.dtype==="int32"&&r.dtype==="int32")return F6(a,r);var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s,o){var u=s.realDivide(a,r);return o([a,r]),u},{a,b:r},function(s,o){var u=o[0],c=o[1];return{a:function(){var d=s.div(c.toFloat()),h=va(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d},b:function(){var d=s.mul(u.toFloat()),h=va(c.shape,i);h.length>0&&(d=d.sum(h).reshape(c.shape));var p=c.square();return d.div(p.toFloat()).neg()}}},"Div")}}),tF=he({divNoNan_:function(e,t){var n,a=te(e,"a","div"),r=te(t,"b","div");a=(n=Pn(a,r))[0],r=n[1];var i=Vi(a,r),s=Wt(i),o=r.equal(s);return Iu(o,s,i)}}),nF=he({divStrict_:function(e,t){var n=te(e,"a","div"),a=te(t,"b","div");return tn(n.shape,a.shape,"Error in divideStrict: "),n.div(a)}}),F6=he({floorDiv_:function(e,t){var n,a=te(e,"a","floorDiv"),r=te(t,"b","floorDiv");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s,o){var u=s.floorDiv(a,r);return o([a,r]),u},{a,b:r},function(s,o){var u=o[0],c=o[1];return{a:function(){var d=s.div(c.toFloat()),h=va(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d},b:function(){var d=s.mul(u.toFloat()),h=va(c.shape,i);h.length>0&&(d=d.sum(h).reshape(c.shape));var p=c.square();return d.div(p.toFloat()).neg()}}},"FloorDiv")}}),ow=he({maximum_:function(e,t){var n,a=te(e,"a","maximum"),r=te(t,"b","maximum");return n=Pn(a,r),a=n[0],r=n[1],a.dtype==="bool"&&(a=a.toInt(),r=r.toInt()),zt(a.shape,r.shape),be.runKernelFunc(function(i,s){var o=i.maximum(a,r);return s([a,r]),o},{a,b:r},function(i,s){var o=s[0],u=s[1];return{a:function(){return i.mul(o.greaterEqual(u).toFloat())},b:function(){return i.mul(o.less(u).toFloat())}}},"Maximum")}}),aF=he({maximumStrict_:function(e,t){var n=te(e,"a","maximumStrict"),a=te(t,"b","maximumStrict");return tn(n.shape,a.shape,"Error in maximumStrict: "),n.maximum(a)}}),B6=he({minimum_:function(e,t){var n,a=te(e,"a","minimum"),r=te(t,"b","minimum");return n=Pn(a,r),a=n[0],r=n[1],a.dtype==="bool"&&(a=a.toInt(),r=r.toInt()),zt(a.shape,r.shape),be.runKernelFunc(function(i,s){var o=i.minimum(a,r);return s([a,r]),o},{a,b:r},function(i,s){var o=s[0],u=s[1];return{a:function(){return i.mul(o.lessEqual(u).toFloat())},b:function(){return i.mul(o.greater(u).toFloat())}}},"Minimum")}}),rF=he({minimumStrict_:function(e,t){var n=te(e,"a","minimumStrict"),a=te(t,"b","minimumStrict");return tn(n.shape,a.shape,"Error in minimumStrict: "),n.minimum(a)}}),iF=he({mod_:function(e,t){var n,a=te(e,"a","mod"),r=te(t,"b","mod");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s,o){var u=s.mod(a,r);return o([a,r]),u},{$a:a,$b:r},function(s,o){var u=o[0],c=o[1];return{$a:function(){var d=va(u.shape,i);return d.length>0?s.sum(d).reshape(u.shape):s},$b:function(){var d=s.mul(u.div(c).floor().neg()),h=va(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d}}})}}),sF=he({modStrict_:function(e,t){var n=te(e,"a","modStrict"),a=te(t,"b","modStrict");return tn(n.shape,a.shape,"Error in modStrict: "),n.mod(a)}}),tr=he({mul_:function(e,t){var n,a=te(e,"a","mul"),r=te(t,"b","mul");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s,o){var u=s.multiply(a,r);return o([a,r]),u},{a,b:r},function(s,o){var u=o[0],c=o[1];return{a:function(){var d=s.mul(c.toFloat()),h=va(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d},b:function(){var d=s.mul(u.toFloat()),h=va(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d}}},"Mul")}}),oF=he({mulStrict_:function(e,t){var n=te(e,"a","mul"),a=te(t,"b","mul");return tn(n.shape,a.shape,"Error in multiplyStrict: "),n.mul(a)}}),N0=he({pow_:function(e,t){var n,a=te(e,"base","pow"),r=te(t,"exp","pow");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape),s=[a,r];return be.runKernelFunc(function(o,u){var c=o.pow(a,r);return u([a,r,c]),c},{a,b:r},function(o,u){var c=u[0],d=u[1],h=u[2];return{a:function(){var p=d.toFloat(),f=o.mul(p.mul(c.pow(p.sub(at(1))))),g=va(c.shape,i);return g.length>0&&(f=f.sum(g)),f.reshape(c.shape)},b:function(){var p=c.greater(0),f=c.log().where(p,Wt(c)),g=o.mul(h.mul(f)),b=va(d.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(d.shape)}}},"Pow",{},s,[!0])}}),lF=he({powStrict_:function(e,t){return tn(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),uF=he({squaredDifferenceStrict_:function(e,t){var n=te(e,"a","squaredDifferenceStrict"),a=te(t,"b","squaredDifferenceStrict");return tn(n.shape,a.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(a)}}),xa=he({sub_:function(e,t){var n,a=te(e,"a","sub"),r=te(t,"b","sub");n=Pn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return be.runKernelFunc(function(s){return s.subtract(a,r)},{a,b:r},function(s){return{a:function(){var o=s,u=va(a.shape,i);return u.length>0&&(o=o.sum(u)),o.reshape(a.shape)},b:function(){var o=s,u=va(r.shape,i);return u.length>0&&(o=o.sum(u)),o.neg().reshape(r.shape)}}},"Sub")}}),cF=he({subStrict_:function(e,t){var n=te(e,"a","subStrict"),a=te(t,"b","subStrict");return tn(n.shape,a.shape,"Error in subStrict: "),n.sub(a)}}),z6=he({equal_:function(e,t){var n,a=te(e,"a","equal"),r=te(t,"b","equal");return n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),be.runKernelFunc(function(i){return i.equal(a,r)},{$a:a,$b:r})}}),dF=he({equalStrict_:function(e,t){var n=te(e,"a","equalStrict"),a=te(t,"b","equalStrict");return tn(n.shape,a.shape,"Error in equalStrict: "),n.equal(a)}}),hF=he({greater_:function(e,t){var n,a=te(e,"a","greater"),r=te(t,"b","greater");return n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),be.runKernelFunc(function(i){return i.greater(a,r)},{a,b:r},null,"Greater")}}),U6=he({greaterEqual_:function(e,t){var n,a=te(e,"a","greaterEqual"),r=te(t,"b","greaterEqual");return n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),be.runKernelFunc(function(i,s){var o=i.greaterEqual(a,r);return s([a,r]),o},{a,b:r},function(i,s){var o=s[0],u=s[1];return{a:function(){return Wt(o)},b:function(){return Wt(u)}}},"GreaterEqual")}}),fF=he({greaterEqualStrict_:function(e,t){var n=te(e,"a","greaterEqualStrict"),a=te(t,"b","greaterEqualStrict");return tn(n.shape,a.shape,"Error in greaterEqualStrict: "),n.greaterEqual(a)}}),pF=he({greaterStrict_:function(e,t){var n=te(e,"a","greaterStrict"),a=te(t,"b","greaterStrict");return tn(n.shape,a.shape,"Error in greaterStrict: "),n.greater(a)}}),mF=he({less_:function(e,t){var n,a=te(e,"a","less"),r=te(t,"b","less");return n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),be.runKernelFunc(function(i){return i.less(a,r)},{a,b:r},null,"Less")}}),gF=he({lessEqual_:function(e,t){var n,a=te(e,"a","lessEqual"),r=te(t,"b","lessEqual");return n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),be.runKernelFunc(function(i,s){var o=i.lessEqual(a,r);return s([a,r]),o},{a,b:r},null,"LessEqual")}}),vF=he({lessEqualStrict_:function(e,t){var n=te(e,"a","lessEqualStrict"),a=te(t,"b","lessEqualStrict");return tn(n.shape,a.shape,"Error in lessEqualStrict: "),n.lessEqual(a)}}),xF=he({lessStrict_:function(e,t){var n=te(e,"a","lessStrict"),a=te(t,"b","lessStrict");return tn(n.shape,a.shape,"Error in lessStrict: "),n.less(a)}}),bF=he({notEqual_:function(e,t){var n,a=te(e,"a","notEqual"),r=te(t,"b","notEqual");return n=Pn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),be.runKernelFunc(function(i){return i.notEqual(a,r)},{a,b:r},null,"NotEqual")}}),yF=he({notEqualStrict_:function(e,t){var n=te(e,"a","notEqualStrict"),a=te(t,"b","notEqualStrict");return tn(n.shape,a.shape,"Error in notEqualStrict: "),n.notEqual(a)}});function B3(e,t){for(var n=[],a=e;a<t;++a)n.push(a);return n}function z3(e){for(var t=[],n=0;n<e.length;++n)for(var a=0;a<e[n].length;++a)t.push(e[n][a]);return t}var lw=he({gather_:function(e,t,n){n===void 0&&(n=0);var a=te(e,"x","gather"),r=te(t,"indices","gather","int32");n=ba(n,a.shape)[0];var i=function(s,o,u){for(var c=s.shape[u],d=[],h=1,p=1,f=0;f<u;f++)d.push(s.shape[f]),h*=s.shape[f];for(f=0;f<o.rank;f++)d.push(o.shape[f]);for(f=u+1;f<s.rank;f++)d.push(s.shape[f]),p*=s.shape[f];return{batchSize:h,sliceSize:p,dimSize:c,outputShape:d}}(a,r,n);return be.runKernelFunc(function(s,o){var u=s.gather(a,r.flatten(),n);return o([r]),u},{x:a,indices:r},function(s,o){var u=o[0];return{x:function(){var c=a.shape,d=u.size,h=c.slice(0,n),p=h.length,f=c.slice(n,c.length).slice(1),g=f.length,b=B3(0,p),w=B3(p+1,p+1+g),m=z3([h,[d],f]),x=s.reshape(m),y=u.reshape([d]),N=z3([[p],b,w]),S=x.transpose(N),T=q6(S,y,a.shape[n]),C=$2(N);return T=T.transpose(C)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),q6=he({unsortedSegmentSum_:function(e,t,n){var a=te(e,"x","unsortedSegmentSum"),r=te(t,"segmentIds","unsortedSegmentSum","int32");return se(Qn(n),function(){return"numSegments must be of dtype int"}),be.runKernelFunc(function(i,s){var o=i.unsortedSegmentSum(a,r,n);return s([r]),o},{$x:a},function(i,s){var o=s[0];return{$x:function(){return function(u,c){for(var d=ow(c,Wt(c)),h=lw(u,d),p=U6(c,at(0,"int32")),f=h.rank-p.rank,g=0;g<f;++g)p=xi(p,g+1);p=gv(p,ah(h.shape,"bool"));var b=Wt(h);return Iu(p,h,b)}(i,o)}}})}}),wF=function(e,t,n){return lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h,p,f,g,b;return ut(this,function(w){switch(w.label){case 0:for(a=te(e,"tensor","boolMask"),r=te(t,"mask","boolMask","bool"),i=n??0,s=r.rank,o=a.shape,se(s>0,function(){return"mask cannot be scalar"}),tn(o.slice(i,i+s),r.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+s;c++)u*=o[c];return d=o.slice(0,i).concat([u],o.slice(i+s)),h=a.reshape(d),p=r.reshape([-1]),[4,O6(p)];case 1:return f=w.sent(),g=f.squeeze([1]),b=lw(h,g,i),e!==a&&a.dispose(),t!==r&&r.dispose(),g.dispose(),h.dispose(),p.dispose(),f.dispose(),[2,b]}})})};function H6(e,t,n,a,r,i,s){i===void 0&&(i="NHWC"),se(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var o=e,u=t,c=!1;t.rank===3&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),o=[1,e[0],e[1],e[2]]),se(o.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+o.length+"."}),se(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),se(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var d=i==="NHWC"?o[3]:o[1],h=i==="NHWC"?u.shape[3]:u.shape[1];se(d===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+n.shape[2]+"."}),se(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),s!=null&&se(Qn(r),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var p=Z2(i),f=Vu(o,n.shape,a,1,r,s,!1,p),g=be.runKernelFunc(function(b,w){var m=b.conv2dDerInput(u,n,f);return w([n,u]),m},{dy4D:u,filter:n},function(b,w){var m=w[0],x=w[1];return{dy4D:function(){return Di(b,m,a,r,i,1,s)},filter:function(){return uw(b,x,m.shape,a,r,i,s)}}});return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}function kb(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],a=t[1],r=t[2];return n===1&&a===1&&r===1}function W6(e,t,n,a,r){se(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,s=t,o=!1;t.rank===4&&(o=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=s.shape[4];se(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),se(s.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),se(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),se(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),se(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var d=b0(i,n.shape,a,1,r),h=be.runKernelFunc(function(p){return p.conv3dDerInput(s,n,d)},{dy5D:s});return o?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var NF=he({conv1d_:function(e,t,n,a,r,i,s){r===void 0&&(r="NWC"),i===void 0&&(i=1);var o=te(e,"x","conv1d"),u=te(t,"filter","conv1d"),c=o,d=!1;o.rank===2&&(d=!0,c=o.as3D(1,o.shape[0],o.shape[1])),se(c.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),se(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),s!=null&&se(Qn(a),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}),se(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),se(Dr(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),se(r==="NWC",function(){return"Error in conv1d: got dataFormat of "+r+" but only NWC is currently supported."});var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=Di(p,h,[1,n],a,"NHWC",[1,i],s);return d?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),Di=he({conv2d_:function(e,t,n,a,r,i,s){r===void 0&&(r="NHWC"),i===void 0&&(i=[1,1]);var o=te(e,"x","conv2d"),u=te(t,"filter","conv2d"),c=o,d=!1;o.rank===3&&(d=!0,c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),se(c.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),se(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),s!=null&&se(Qn(a),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var h=r==="NHWC"?c.shape[3]:c.shape[1];se(h===u.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."}),se(Dr(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var p=Z2(r),f=Vu(c.shape,u.shape,n,i,a,s,!1,p),g=[u,c],b=be.runKernelFunc(function(w,m){var x=w.conv2d(c,u,f);return m([u,c]),x},{x:c,filter:u},function(w,m){var x=m,y=x[0],N=x[1];return se(qd(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return G6(N.shape,w,y,n,a,r)},filter:function(){return uw(N,w,y.shape,n,a,r)}}},"Conv2D",f,g);return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),kF=he({conv3d_:function(e,t,n,a,r,i){r===void 0&&(r="NDHWC"),i===void 0&&(i=[1,1,1]);var s=te(e,"x","conv3d"),o=te(t,"filter","conv3d"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),se(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),se(o.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+o.rank+"."}),se(u.shape[4]===o.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+o.shape[3]+"."}),se(function(p,f){return kb(p)||kb(f)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),se(r==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+r+" but only NDHWC is currently supported."});var d=b0(u.shape,o.shape,n,i,a),h=be.runKernelFunc(function(p,f){var g=p.conv3d(u,o,d);return f([u,o]),g},{x:u,$filter:o},function(p,f){se(kb(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var g=f[0],b=f[1];return{x:function(){return W6(g.shape,p,b,n,a)},$filter:function(){return function(w,m,x,y,N){var S=w;w.rank===4&&(S=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]));var T=m;T.rank===4&&(T=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),se(S.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+S.shape+"."}),se(T.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+T.shape+"."}),se(x.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+x+"."}),se(S.shape[4]===x[3],function(){return"Error in conv3dDerFilter: depth of input "+S.shape[4]+") must match input depth in filter ("+x[3]+"."}),se(T.shape[4]===x[4],function(){return"Error in conv3dDerFilter: depth of dy ("+T.shape[4]+") must match output depth for filter ("+x[4]+")."});var C=b0(S.shape,x,y,1,N);return be.runKernelFunc(function(A){return A.conv3dDerFilter(S,T,C)},{x5D:S,dy5D:T})}(g,p,b.shape,n,a)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),uw=he({conv2dDerFilter_:function(e,t,n,a,r,i,s){i===void 0&&(i="NHWC");var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),se(o.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+o.shape+"."}),se(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),se(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c=i==="NHWC"?o.shape[3]:o.shape[1],d=i==="NHWC"?u.shape[3]:u.shape[1];se(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),se(d===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+n[3]+")."}),s!=null&&se(Qn(r),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var h=Z2(i),p=Vu(o.shape,n,a,1,r,s,!1,h);return be.runKernelFunc(function(f){return f.conv2dDerFilter(o,u,p)},{x4D:o,dy4D:u})}}),G6=he({conv2dDerInput_:H6}),vv=he({depthwiseConv2d_:function(e,t,n,a,r,i,s){i===void 0&&(i=[1,1]);var o=te(e,"x","depthwiseConv2d"),u=te(t,"filter","depthwiseConv2d"),c=o,d=!1;o.rank===3&&(d=!0,c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),se(c.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),se(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),se(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),se(Dr(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),s!=null&&se(Qn(a),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var h=Vu(c.shape,u.shape,n,i,a,s,!0),p=[c,u],f=be.runKernelFunc(function(g,b){var w=g.depthwiseConv2D(c,u,h);return b([c,u]),w},{x:c,filter:u},function(g,b){se(qd(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var w=b[0],m=b[1];return{x:function(){return V6(w.shape,g,m,h)},filter:function(){return K6(w,g,m.shape,h)}}},"DepthwiseConv2dNative",h,p);return d?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),V6=he({depthwiseConv2dDerInput_:function(e,t,n,a){var r=t,i=!1;t.rank===3&&(i=!0,r=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=be.runKernelFunc(function(o){return o.depthwiseConv2DDerInput(r,n,a)},{dy4D:r});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),K6=he({depthwiseConv2dDerFilter_:function(e,t,n,a){var r=e;e.rank===3&&(r=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),be.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(r,i,a)},{x4D:r,dy4D:i})}}),cw=he({separableConv2d_:function(e,t,n,a,r,i,s){i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC");var o=te(e,"x","separableConv2d"),u=te(t,"depthwiseFilter","separableConv2d"),c=te(n,"pointwiseFilter","separableConv2d"),d=o,h=!1;if(o.rank===3&&(h=!0,d=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");se(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),se(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),se(c.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),se(c.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),se(c.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var p=u.shape[2],f=u.shape[3];se(c.shape[2]===p*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*f+", but got "+c.shape[2]+"."});var g=vv(d,u,a,r,s,i),b=Di(g,c,1,"valid",s);return h?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),SF=he({conv2dTranspose_:function(e,t,n,a,r,i){return H6(n,te(e,"x","conv2dTranspose"),te(t,"filter","conv2dTranspose"),a,r,"NHWC",i)}}),_F=he({conv3dTranspose_:function(e,t,n,a,r){return W6(n,te(e,"x","conv3dTranspose"),te(t,"filter","conv3dTranspose"),a,r)}}),xv=he({matMul_:function(e,t,n,a){var r;n===void 0&&(n=!1),a===void 0&&(a=!1);var i=te(e,"a","matMul"),s=te(t,"b","matMul");r=Pn(i,s),i=r[0],s=r[1];var o=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=a?s.shape[s.rank-1]:s.shape[s.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],d=a?s.shape[s.rank-2]:s.shape[s.rank-1],h=i.shape.slice(0,-2),p=s.shape.slice(0,-2),f=ht(h),g=ht(p);se(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),se(Aa(h,p),function(){return"Error in matMul: outer dimensions ("+h+") and ("+p+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),se(o===u,function(){return"Error in matMul: inner shapes ("+o+") and ("+u+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+n+" and transposeB="+a+" must match."});var b=i.shape.slice(0,-2).concat([c,d]),w=n?i.as3D(f,o,c):i.as3D(f,c,o),m=a?s.as3D(g,d,u):s.as3D(g,u,d),x={transposeA:n,transposeB:a};return be.runKernelFunc(function(y,N){var S=y.batchMatMul(w,m,n,a);return N([w,m]),S},{a:w,b:m},function(y,N){var S=N,T=S[0],C=S[1];return n||a?!n&&a?{a:function(){return y.matMul(C,!1,!1)},b:function(){return y.matMul(T,!0,!1)}}:n&&!a?{a:function(){return C.matMul(y,!1,!0)},b:function(){return T.matMul(y,!1,!1)}}:{a:function(){return C.matMul(y,!0,!0)},b:function(){return y.matMul(T,!0,!0)}}:{a:function(){return y.matMul(C,!1,!0)},b:function(){return T.matMul(y,!0,!1)}}},"BatchMatMul",x).reshape(b)}}),jF=he({dot_:function(e,t){var n=te(e,"t1","dot"),a=te(t,"t2","dot");se(!(n.rank!==1&&n.rank!==2||a.rank!==1&&a.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+a.rank+"."});var r=n.rank===1?n.size:n.shape[1],i=a.rank===1?a.size:a.shape[0];return se(r===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+r+" and "+i+"."}),n.rank===1&&a.rank===1?n.as2D(1,-1).matMul(a.as2D(-1,1)).asScalar():n.rank===1&&a.rank===2?n.as2D(1,-1).matMul(a.as2D(a.shape[0],a.shape[1])).as1D():n.rank===2&&a.rank===1?n.matMul(a.as2D(-1,1)).as1D():n.matMul(a.as2D(a.shape[0],a.shape[1]))}}),CF=he({outerProduct_:function(e,t){var n=te(e,"v1","outerProduct"),a=te(t,"v2","outerProduct");return se(n.rank===1&&a.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+a.rank+"."}),n.as2D(-1,1).matMul(a.as2D(1,-1))}}),Sp=he({reverse_:function(e,t){var n=te(e,"x","reverse");if(n.rank===0)return n.clone();var a=ba(t,n.shape);return be.runKernelFunc(function(r){return r.reverse(n,a)},{$x:n},function(r){return{$x:function(){return r.reverse(a)}}}).reshapeAs(n)}}),AF=he({reverse1d_:function(e){var t=te(e,"x","reverse");return se(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Sp(t,0)}}),EF=he({reverse2d_:function(e,t){var n=te(e,"x","reverse");return se(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Sp(n,t)}}),DF=he({reverse3d_:function(e,t){var n=te(e,"x","reverse");return se(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Sp(n,t)}}),TF=he({reverse4d_:function(e,t){var n=te(e,"x","reverse");return se(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Sp(n,t)}});function $6(e,t,n,a,r,i){var s=te(e,"x","maxPool"),o=s,u=!1;s.rank===3&&(u=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),se(o.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+o.rank+"."}),se(Dr(n,a),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),i!=null&&se(Qn(r),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=Uf(o.shape,t,n,a,r,i);if(c.filterWidth===1&&c.filterHeight===1&&Aa(c.inShape,c.outShape))return s.clone();var d=[o],h=be.runKernelFunc(function(p,f){var g=p.maxPool(o,c);return f([o,g]),g},{x:o},function(p,f){var g=f[0],b=f[1];return{x:function(){return function(w,m,x,y,N,S,T,C){var A=te(w,"dy","maxPoolBackprop"),R=te(m,"input","maxPoolBackprop"),L=te(x,"output","maxPoolBackprop");se(R.rank===A.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+A.rank+")"}),se(Dr(N,S),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+S+"'"}),se(A.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+A.rank+"."}),se(R.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var j=Uf(R.shape,y,N,S,T,C);return be.runKernelFunc(function(D){return D.maxPoolBackprop(A,R,L,j)},{$dy:A,$input:R})}(p,g,b,t,n,a,r)}}},"MaxPool",c,d);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function Y6(e,t,n,a,r,i){var s=te(e,"x","avgPool","float32");se(Dr(n,a),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var o=s,u=!1;s.rank===3&&(u=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),se(o.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+o.rank+"."}),i!=null&&se(Qn(r),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=Uf(o.shape,t,n,a,r,i);if(c.filterWidth===1&&c.filterHeight===1&&Aa(c.inShape,c.outShape))return s.clone();var d=be.runKernelFunc(function(h){return h.avgPool(o,c)},{x:o},function(h){return{x:function(){return function(p,f,g,b,w,m){var x=te(p,"dy","avgPoolBackprop"),y=te(f,"input","avgPoolBackprop");se(y.rank===x.rank,function(){return"Rank of input ("+y.rank+") does not match rank of dy ("+x.rank+")"}),se(Dr(b,w),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+w+"'"});var N=y,S=x,T=!1;y.rank===3&&(T=!0,N=y.as4D(1,y.shape[0],y.shape[1],y.shape[2]),S=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),se(S.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+S.rank+"."}),se(N.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var C=Uf(N.shape,g,b,w,m),A=be.runKernelFunc(function(R){return R.avgPoolBackprop(S,N,C)},{dy4D:S,input4D:N});return T?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}(h,o,t,n,a,r)}}},"AvgPool",c);return d=d.cast(s.dtype),u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var ka=he({maxPool_:function(e,t,n,a,r){return $6(e,t,n,1,a,r)}}),_p=he({avgPool_:function(e,t,n,a,r){return Y6(e,t,n,1,a,r)}}),RF=he({pool_:function(e,t,n,a,r,i){r==null&&(r=[1,1]),i==null&&(i=1),a===0&&(a="valid");var s=te(e,"x","maxPool"),o=s,u=!1;s.rank===3&&(u=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),se(Dr(i,r),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+r+"'"});var c,d=Uf(o.shape,t,i,r,a),h=[d.dilationHeight,d.dilationWidth];c=a==="same"?function(N,S){var T=N.map(function(R,L){return R+(R-1)*(S[L]-1)}).map(function(R){return R-1}),C=T.map(function(R){return Math.floor(R/2)}),A=T.map(function(R,L){return R-C[L]});return T.map(function(R,L){return[C[L],A[L]]})}([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];var p=h[0]===1&&h[1]===1,f=function(N,S,T){var C=T.map(function(z){return z[0]}),A=T.map(function(z){return z[1]}),R=N.concat(C,A),L=S.map(function(z,U){return(z-R[U]%z)%z}),j=A.map(function(z,U){return z+L[U]}),D=S.map(function(z,U){return[C[U],j[U]]}),B=S.map(function(z,U){return[0,L[U]]});return[D,B]}([d.inHeight,d.inWidth],h,c),g=f[0],b=f[1],w=p?a:"valid",m=p?o:t6(o,h,g),x=(n==="avg"?function(){return Y6(m,t,i,1,w)}:function(){return $6(m,t,i,1,w)})(),y=p?x:Qj(x,h,b);return u?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),LF=he({maxPool3d_:function(e,t,n,a,r,i,s){i===void 0&&(i="NDHWC");var o=te(e,"x","maxPool3d"),u=o,c=!1;o.rank===4&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),s==null&&(s=[1,1,1]),se(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),se(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),se(Dr(n,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"}),r!=null&&se(Qn(a),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+r+" but got pad "+a+"."});var d=x0(u.shape,t,n,s,a,r,i),h=be.runKernelFunc(function(p,f){var g=p.maxPool3d(u,d);return f([u,g]),g},{x:u},function(p,f){var g=f[0],b=f[1];return{x:function(){return function(w,m,x,y,N,S,T,C){var A=te(w,"dy","maxPool3dBackprop"),R=te(m,"input","maxPool3dBackprop"),L=te(x,"output","maxPool3dBackprop"),j=A,D=R,B=L,z=!1;R.rank===4&&(z=!0,j=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3]),D=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),B=L.as5D(1,L.shape[0],L.shape[1],L.shape[2],L.shape[3])),se(j.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+j.rank+"."}),se(D.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+D.rank+"."}),se(B.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+B.rank+"."}),S==null&&(S=[1,1,1]),se(Dr(N,S),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+S+"'"}),C!=null&&se(Qn(T),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+T+"."});var U=x0(D.shape,y,N,S,T,C),I=be.runKernelFunc(function(F){return F.maxPool3dBackprop(j,D,B,U)},{dy5D:j,input5D:D});return z?I.as4D(I.shape[1],I.shape[2],I.shape[3],I.shape[4]):I}(p,g,b,t,n,s,a,r)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),PF=he({avgPool3d_:function(e,t,n,a,r,i,s){i===void 0&&(i="NDHWC");var o=te(e,"x","avgPool3d","float32"),u=o,c=!1;o.rank===4&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),s==null&&(s=[1,1,1]),se(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),se(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),se(Dr(n,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"}),r!=null&&se(Qn(a),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+r+" but got pad "+a+"."});var d=x0(u.shape,t,n,s,a,r,i),h=be.runKernelFunc(function(p){return p.avgPool3d(u,d)},{x:u},function(p){return{x:function(){return function(f,g,b,w,m,x,y){var N=te(f,"dy","avgPool3dBackprop"),S=te(g,"input","avgPool3dBackprop"),T=N,C=S,A=!1;S.rank===4&&(A=!0,T=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),C=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),se(T.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+T.rank+"."}),se(C.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+C.rank+"."}),m==null&&(m=[1,1,1]),se(Dr(w,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+m+"'"}),y!=null&&se(Qn(x),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+y+" but got pad "+x+"."});var R=x0(C.shape,b,w,m,x,y),L=be.runKernelFunc(function(j){return j.avgPool3dBackprop(T,C,R)},{dy5D:T,input5D:C});return A?L.as4D(L.shape[1],L.shape[2],L.shape[3],L.shape[4]):L}(p,u,t,n,s,a,r)}}});return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Ps=he({slice_:function(e,t,n){var a,r,i=te(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(a=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){se(u!==-1,function(){return"slice() does not support negative begin indexing."})}),r=(r=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,c){return u>=0?u:(se(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),i.shape[c]-a[c])}),l7(i,a,r);var s=i.shape,o={begin:a,size:r};return be.runKernelFunc(function(u){return u.slice(i,a,r)},{x:i},function(u){for(var c=[],d=0;d<u.rank;d++)c.push([a[d],s[d]-a[d]-r[d]]);return{x:function(){return u.pad(c)}}},"Slice",o)}}),MF=he({slice1d_:function(e,t,n){var a=te(e,"x","slice1d");return se(a.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+a.rank+" tensor"}),Ps(a,[t],[n])}}),IF=he({slice2d_:function(e,t,n){var a=te(e,"x","slice2d");return se(a.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+a.rank+" tensor"}),Ps(a,t,n)}}),X6=he({slice3d_:function(e,t,n){var a=te(e,"x","slice3d");return se(a.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+a.rank+" tensor"}),Ps(a,t,n)}}),OF=he({slice4d_:function(e,t,n){var a=te(e,"x","slice4d");return se(a.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+a.rank+" tensor"}),Ps(a,t,n)}});function J6(e,t,n,a,r){return t.rank<n.rank&&(t=t.reshape(Er(t.shape,a))),e.rank<n.rank&&(e=e.reshape(Er(e.shape,a))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return r==null?i:i.transpose(r)}}}var FF=he({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","all","bool"),r=ba(t,a.shape),i=r,s=Bs(i,a.rank);s!=null&&(a=a.transpose(s),i=zs(i.length,a.rank));var o=be.runKernelFunc(function(c){return c.all(a,i)},{$x:a});if(n){var u=Er(o.shape,r);return o.reshape(u)}return o}}),BF=he({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","any","bool"),r=ba(t,a.shape),i=r,s=Bs(i,a.rank);s!=null&&(a=a.transpose(s),i=zs(i.length,a.rank));var o=be.runKernelFunc(function(c){return c.any(a,i)},{$x:a});if(n){var u=Er(o.shape,r);return o.reshape(u)}return o}}),zF=he({argMax_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","argMax");t==null&&(t=0);var a=ba(t,n.shape),r=Bs(a,n.rank);r!=null&&(n=n.transpose(r),a=zs(a.length,n.rank));var i={axis:a[0]},s=[n];return be.runKernelFunc(function(o,u){var c=o.argMax(n,a[0]);return u([n]),c},{x:n},function(o,u){var c=u[0];return{x:function(){return Wt(c)}}},"ArgMax",i,s)}}),UF=he({argMin_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","argMin");t==null&&(t=0);var a=ba(t,n.shape),r=Bs(a,n.rank);return r!=null&&(n=n.transpose(r),a=zs(a.length,n.rank)),be.runKernelFunc(function(i,s){var o=i.argMin(n,a[0]);return s([n]),o},{$x:n},function(i,s){var o=s[0];return{$x:function(){return Wt(o)}}})}}),qF=he({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","logSumExp"),r=ba(t,a.shape),i=a.max(r,!0),s=a.sub(i).exp().sum(r).log(),o=i.reshape(s.shape).add(s);if(n){var u=Er(o.shape,r);return o.reshape(u)}return o}}),bv=he({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","max"),r=a,i=ba(t,a.shape),s=i,o=Bs(s,a.rank);o!=null&&(a=a.transpose(o),s=zs(s.length,a.rank));var u=[a],c=be.runKernelFunc(function(h,p){var f=h.max(a,s);return p([r,f]),f},{x:a},function(h,p){return J6(h,p[1],p[0],i,o)},"Max",{axes:s},u,[!0]);if(n){var d=Er(c.shape,i);c=c.reshape(d)}return c}}),HF=he({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","mean"),r=ba(t,a.shape),i=ht($a(a.shape,r)[1]);return pv(function(s){var o=at(i);return{value:(o.dtype===s.dtype?s:s.cast(o.dtype)).div(o).sum(t,n),gradFunc:function(u){var c=s.shape.slice();return r.forEach(function(d){c[d]=1}),u.reshape(c).mul(ah(s.shape,"float32")).div(i)}}})(a)}}),WF=he({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","min"),r=a,i=ba(t,a.shape),s=i,o=Bs(s,a.rank);o!=null&&(a=a.transpose(o),s=zs(s.length,a.rank));var u=[a],c=be.runKernelFunc(function(h,p){var f=h.min(a,s);return p([r,f]),f},{x:a},function(h,p){return J6(h,p[1],p[0],i,o)},"Min",{axes:s},u,[!0]);if(n){var d=Er(c.shape,i);c=c.reshape(d)}return c}}),GF=he({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=ba(t,(e=te(e,"x","moments")).shape),r=e.mean(a,n),i=r.shape;n||(i=Er(r.shape,a));var s=e.toFloat().sub(r.reshape(i)).square();return{mean:r,variance:s.mean(a,n)}}}),Q6=he({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","sum");a.dtype==="bool"&&(a=a.toInt());var r=ba(t,a.shape);return pv(function(i){var s=Bs(r,i.rank),o=r,u=i;s!=null&&(u=i.transpose(s),o=zs(o.length,i.rank));var c=function(f){var g=i.shape.slice();return r.forEach(function(b){g[b]=1}),f.reshape(g).mul(ah(i.shape,"float32"))},d={axes:o},h=be.runKernelFunc(function(f){return f.sum(u,o)},{x:u},function(f){return{x:function(){return c(f)}}},"Sum",d);if(n){var p=Er(h.shape,r);h=h.reshape(p)}return{value:h,gradFunc:c}})(a)}}),VF=he({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","prod");a.dtype==="bool"&&(a=a.toInt());var r=ba(t,a.shape),i=Bs(r,a.rank),s=r,o=a;i!=null&&(o=a.transpose(i),s=zs(s.length,a.rank));var u=be.runKernelFunc(function(d){return d.prod(o,s)},{permutedX:o});if(n){var c=Er(u.shape,r);u=u.reshape(c)}return u}}),Z6=he({elu_:function(e){var t=te(e,"x","elu");return be.runKernelFunc(function(n,a){var r=n.elu(t);return a([r]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return be.runKernelFunc(function(i){return i.eluDer(n,r)},{dy:n,y:r})}}})}}),KF=he({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=te(e,"x","leakyRelu");return ow(at(t).mul(n),n)}}),eC=he({prelu_:function(e,t){var n=te(e,"x","prelu"),a=te(t,"alpha","prelu");return be.runKernelFunc(function(r,i){var s=r.prelu(n,a);return i([n,a]),s},{x:n,alpha:a},function(r,i){var s=i[0],o=i[1],u=s.greater(0);return{x:function(){return Iu(u,r,r.mul(o))},alpha:function(){var c=Iu(u,Wt(r),r.mul(s)),d=va(o.shape,r.shape);return d.length>0&&(c=c.sum(d)),c.reshape(o.shape)}}},"Prelu")}}),Tn=he({relu_:function(e){var t=te(e,"x","relu");return t.dtype==="bool"?t.toInt():be.runKernelFunc(function(n,a){var r=n.relu(t);return a([t]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return n.mulStrict(r.step().toFloat())}}},"Relu")}}),tC=he({relu6_:function(e){var t=te(e,"x","relu6");return t.dtype==="bool"?t.toInt():be.runKernelFunc(function(n,a){var r=n.relu6(t);return a([t]),r},{x:t},function(n,a){var r=a[0],i=r.lessEqual(6).mul(r.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),$F=he({selu_:function(e){var t=te(e,"x","selu");return be.runKernelFunc(function(n,a){var r=n.selu(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){var i=r.greater(at(0)),s=at(rw),o=at(iw),u=n.mul(o),c=n.mul(s).mul(r.toFloat().exp());return Iu(i,u,c)}}})}}),Ll=he({transpose_:function(e,t){var n=te(e,"x","transpose");if(t==null&&(t=n.shape.map(function(r,i){return i}).reverse()),se(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(r){se(r>=0&&r<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var a={perm:t};return be.runKernelFunc(function(r){return r.transpose(n,t)},{x:n},function(r){var i=$2(t);return{x:function(){return r.transpose(i)}}},"Transpose",a)}}),YF=he({localResponseNormalization_:function(e,t,n,a,r){t===void 0&&(t=5),n===void 0&&(n=1),a===void 0&&(a=1),r===void 0&&(r=.5);var i=te(e,"x","localResponseNormalization");se(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),se(Qn(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var s=i,o=!1;i.rank===3&&(o=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=be.runKernelFunc(function(c,d){var h=c.localResponseNormalization4D(s,t,n,a,r);return d([s,h]),h},{x4D:s},function(c,d){var h=d[0],p=d[1];return{x4D:function(){return be.runKernelFunc(function(f){return f.LRNGrad(c,h,p,t,n,a,r)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),nC=he({norm_:function(e,t,n,a){t===void 0&&(t="euclidean"),n===void 0&&(n=null),a===void 0&&(a=!1);var r=function o(u,c,d){if(d===void 0&&(d=null),u.rank===0)return u.abs();if(u.rank!==1&&d===null)return o(u.reshape([-1]),c,d);if(u.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(c===1)return u.abs().sum(d);if(c===1/0)return u.abs().max(d);if(c===-1/0)return u.abs().min(d);if(c==="euclidean"||c===2)return u.abs().pow(at(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(d)&&d.length===2){if(c===1)return u.abs().sum(d[0]).max(d[1]-1);if(c===1/0)return u.abs().sum(d[1]).max(d[0]);if(c===-1/0)return u.abs().sum(d[1]).min(d[0]);if(c==="fro"||c==="euclidean")return u.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+d)}(e=te(e,"x","norm"),t,n),i=r.shape;if(a){var s=ba(n,e.shape);i=Er(r.shape,s)}return r.reshape(i)}}),XF=he({basicLSTMCell_:function(e,t,n,a,r,i){var s=te(e,"forgetBias","basicLSTMCell"),o=te(t,"lstmKernel","basicLSTMCell"),u=te(n,"lstmBias","basicLSTMCell"),c=te(a,"data","basicLSTMCell"),d=te(r,"c","basicLSTMCell"),h=te(i,"h","basicLSTMCell"),p=c.concat(h,1).matMul(o).add(u),f=p.shape[0],g=p.shape[1]/4,b=[f,g],w=p.slice([0,0],b),m=p.slice([0,g],b),x=p.slice([0,2*g],b),y=p.slice([0,3*g],b),N=w.sigmoid().mulStrict(m.tanh()).addStrict(d.mulStrict(s.add(x).sigmoid())),S=N.tanh().mulStrict(y.sigmoid());return[N,S]}}),JF=he({multiRNNCell_:function(e,t,n,a){for(var r=te(t,"data","multiRNNCell"),i=h0(n,"c","multiRNNCell"),s=h0(a,"h","multiRNNCell"),o=r,u=[],c=0;c<e.length;c++){var d=e[c](o,i[c],s[c]);u.push(d[0]),u.push(d[1]),o=d[1]}var h=[],p=[];for(c=0;c<u.length;c+=2)h.push(u[c]),p.push(u[c+1]);return[h,p]}}),QF=he({movingAverage_:function(e,t,n,a,r){r===void 0&&(r=!0);var i=te(e,"v","movingAverage"),s=te(t,"x","movingAverage"),o=te(n,"decay","movingAverage");Y8(i,s),se(Aa(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var u=at(1),c=u.sub(o),d=s.sub(i).mul(c);if(r){se(a!=null,function(){return"When using zeroDebias: true, step is required."});var h=te(a,"step","movingAverage");d=d.div(u.sub(N0(o,h)))}return i.add(d)}}),ZF=he({stridedSlice_:function(e,t,n,a,r,i,s,o,u){if(r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),a==null&&(a=new Array(t.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var c=te(e,"x","stridedSlice"),d=b3(o),h=c.shape.slice();d.forEach(function(w){t[w]=0,n[w]=1,h.splice(w,0,1)}),c=c.reshape(h);for(var p=0;p<c.rank;p++)t[p]=u7(r,t,a,c.shape,p),n[p]=c7(i,n,a,c.shape,p),a[p]=a[p]||1;var f=b3(u);f.forEach(function(w){n[w]=t[w]+1,a[w]=1});var g=Q2(t,n,a),b=g.filter(function(w,m){return f.indexOf(m)===-1});return a.every(function(w){return w===1})?Ps(c,t,g).reshape(b):be.runKernelFunc(function(w){return w.stridedSlice(c,t,n,a)},{$x:c}).reshape(b)}}),eB=he({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var a=te(e,"x","topk");if(a.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var r=a.shape[a.shape.length-1];if(t>r)throw new Error("'k' passed to topk() must be <= the last dimension ("+r+") but got "+t);var i=be.runKernelFunc(function(s){return s.topk(a,t,n)},{$x:a});return{values:i[0],indices:i[1]}}}),tB=he({scatterND_:function(e,t,n){var a=te(e,"indices","scatterND","int32"),r=te(t,"updates","scatterND");return o7(r,a,n),be.runKernelFunc(function(i){return i.scatterND(a,r,n)},{indices:a,updates:r},null,"ScatterNd",{shape:n})}}),dw=he({fft_:function(e){se(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,a=e.as2D(n,t);return be.runKernelFunc(function(r){return r.fft(a)},{input:e}).reshape(e.shape)}}),k0=he({ifft_:function(e){se(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,a=e.as2D(n,t);return be.runKernelFunc(function(r){return r.ifft(a)},{input:e}).reshape(e.shape)}}),hw=he({rfft_:function(e,t){se(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,a=e.shape[e.shape.length-1],r=e.size/a;if(t!=null&&t<a){var i=e.shape.map(function(m){return 0}),s=e.shape.map(function(m){return m});s[e.shape.length-1]=t,n=e.slice(i,s),a=t}else if(t!=null&&t>a){var o=e.shape.map(function(m){return m});o[e.shape.length-1]=t-a,n=e.concat(Nn(o),e.shape.length-1),a=t}else n=e;var u=n.zerosLike(),c=Ia(n,u).as2D(r,a),d=dw(c),h=Math.floor(a/2)+1,p=wi(d),f=ys(d),g=p.split([h,a-h],p.shape.length-1),b=f.split([h,a-h],f.shape.length-1),w=n.shape.slice();return w[n.shape.length-1]=h,Ia(g[0],b[0]).reshape(w)}}),aC=he({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var a=e.as2D(n,t),r=k0(a);return wi(r)}var i=[n,2*(t-1)],s=wi(e).as2D(n,t),o=ys(e).as2D(n,t),u=s.slice([0,1],[n,t-2]).reverse(1),c=o.slice([0,1],[n,t-2]).reverse(1).mul(at(-1)),d=s.concat(u,1),h=o.concat(c,1);return a=Ia(d,h).as2D(i[0],i[1]),r=k0(a),wi(r)}}),nB=Object.freeze({fft:dw,ifft:k0,rfft:hw,irfft:aC}),aB=he({sparseToDense_:function(e,t,n,a){a===void 0&&(a=0);var r=te(e,"sparseIndices","sparseToDense","int32"),i=te(t,"sparseValues","sparseToDense"),s=te(a,"defaultValue","sparseToDense",i.dtype);return function(o,u,c,d){if(o.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+o.dtype+".");if(o.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+o.shape+".");var h=o.rank>0?o.shape[0]:1,p=o.rank>1?o.shape[1]:1;if(c.length!==p)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+p+".");var f=u.size;if(u.rank!==0&&(u.rank!==1||f!==h))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+h+"]");if(u.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(r,i,n,s),be.runKernelFunc(function(o){return o.sparseToDense(r,i,n,s)},{$sparseIndices:r,$sparseValues:i,$defaultValue:s})}}),rB=he({gatherND_:function(e,t){var n=te(t,"indices","gatherND","int32"),a=te(e,"x","gatherND");return be.runKernelFunc(function(r){return r.gatherND(a,n)},{x:a,indices:n},null,"GatherNd")}}),iB=he({diag_:function(e){var t=te(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return be.runKernelFunc(function(a){return a.diag(t)},{$x:t}).reshape(n)}}),sB=he({dropout_:function(e,t,n,a){var r=te(e,"x","dropout");if(se(r.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+r.dtype+" tensor instead."}),se(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Dn?r.clone():r;var i=function(u,c){if(c==null)return u.shape.slice();if(Aa(u.shape,c))return c;if(u.shape.length===c.length){for(var d=[],h=0;h<u.shape.length;h++)c[h]==null&&u.shape[h]!=null?d.push(u.shape[h]):d.push(c[h]);return d}return c}(r,n),s=1-t,o=e6(i,0,1,"float32",a).add(s).floor().div(s);return r.mul(o)}});function rC(e,t,n){for(var a=1-e%2,r=new Float32Array(e),i=0;i<e;++i){var s=2*Math.PI*i/(e+a-1);r[i]=t-n*Math.cos(s)}return ia(r,"float32")}var fw=he({hannWindow_:function(e){return rC(e,.5,.5)}}),iC=he({hammingWindow_:function(e){return rC(e,.54,.46)}}),pw=he({frame_:function(e,t,n,a,r){a===void 0&&(a=!1),r===void 0&&(r=0);for(var i=0,s=[];i+t<=e.size;)s.push(Ps(e,i,t)),i+=n;if(a)for(;i<e.size;){var o=i+t-e.size,u=pa([Ps(e,i,t-o),Ts([o],r)]);s.push(u),i+=n}return s.length===0?Sl([],[0,t]):pa(s).as2D(s.length,t)}}),sC=he({stft_:function(e,t,n,a,r){var i;r===void 0&&(r=fw),a==null&&(i=t,a=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var s=pw(e,t,n),o=tr(s,r(t)),u=[],c=0;c<s.shape[0];c++)u.push(hw(o.slice([c,0],[1,t]),a));return pa(u)}}),oB=Object.freeze({hannWindow:fw,hammingWindow:iC,frame:pw,stft:sC}),Ja,lB=function(e,t,n){return n===void 0&&(n=1),lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h,p,f,g,b,w;return ut(this,function(m){switch(m.label){case 0:return a=te(e,"predictions","inTopK"),r=te(t,"targets","inTopK"),se(a.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+a.rank}),se(a.rank-1===r.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+a.rank+" and targets rank "+r.rank}),tn(a.shape.slice(0,a.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=a.shape[a.shape.length-1],se(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,a.data()];case 1:return s=m.sent(),[4,r.data()];case 2:for(o=m.sent(),u=[s.length/i,i],d=u[1],h=Ff("bool",c=u[0]),p=0;p<c;p++){for(f=p*d,g=s.subarray(f,f+d),b=[],w=0;w<g.length;w++)b.push({value:g[w],index:w});for(b.sort(function(x,y){return y.value-x.value}),h[p]=0,w=0;w<n;w++)if(b[w].index===o[p]){h[p]=1;break}}return e!==a&&a.dispose(),t!==r&&r.dispose(),[2,Fa(h,r.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ja||(Ja={}));var uB=he({absoluteDifference_:function(e,t,n,a){a===void 0&&(a=Ja.SUM_BY_NONZERO_WEIGHTS);var r=te(e,"labels","absoluteDifference"),i=te(t,"predictions","absoluteDifference"),s=null;n!=null&&(s=te(n,"weights","absoluteDifference")),tn(r.shape,i.shape,"Error in absoluteDifference: ");var o=r.sub(i).abs();return jo(o,s,a)}}),jo=he({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Ja.SUM_BY_NONZERO_WEIGHTS);var a=te(e,"losses","computeWeightedLoss"),r=null;t!=null&&(r=te(t,"weights","computeWeightedLoss"));var i=r==null?a:a.mul(r);if(n===Ja.NONE)return i;if(n===Ja.SUM)return i.sum();if(n===Ja.MEAN){if(r==null)return i.mean();var s=a.size/r.size,o=i.sum().div(r.sum());return s>1?o.div(at(s)):o}if(n===Ja.SUM_BY_NONZERO_WEIGHTS){if(r==null)return i.sum().div(at(a.size));var u=r.mul(ah(a.shape)).notEqual(at(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),cB=he({cosineDistance_:function(e,t,n,a,r){r===void 0&&(r=Ja.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"labels","cosineDistance"),s=te(t,"predictions","cosineDistance"),o=null;a!=null&&(o=te(a,"weights","cosineDistance")),tn(i.shape,s.shape,"Error in cosineDistance: ");var u=at(1).sub(i.mul(s).sum(n,!0));return jo(u,o,r)}}),dB=he({hingeLoss_:function(e,t,n,a){a===void 0&&(a=Ja.SUM_BY_NONZERO_WEIGHTS);var r=te(e,"labels","hingeLoss"),i=te(t,"predictions","hingeLoss"),s=null;n!=null&&(s=te(n,"weights","hingeLoss")),tn(r.shape,i.shape,"Error in hingeLoss: ");var o=at(1);r=at(2).mul(r).sub(o);var u=o.sub(r.mul(i)).relu();return jo(u,s,a)}}),hB=he({huberLoss_:function(e,t,n,a,r){a===void 0&&(a=1),r===void 0&&(r=Ja.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"labels","huberLoss"),s=te(t,"predictions","huberLoss"),o=null;n!=null&&(o=te(n,"weights","huberLoss")),tn(i.shape,s.shape,"Error in huberLoss: ");var u=at(a),c=s.sub(i).abs(),d=B6(c,u),h=c.sub(d),p=at(.5).mul(d.square()).add(u.mul(h));return jo(p,o,r)}}),fB=he({logLoss_:function(e,t,n,a,r){a===void 0&&(a=1e-7),r===void 0&&(r=Ja.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"labels","logLoss"),s=te(t,"predictions","logLoss"),o=null;n!=null&&(o=te(n,"weights","logLoss")),tn(i.shape,s.shape,"Error in logLoss: ");var u=at(1),c=at(a),d=i.mul(s.add(c).log()).neg().sub(u.sub(i).mul(u.sub(s).add(c).log()));return jo(d,o,r)}}),pB=he({meanSquaredError_:function(e,t,n,a){a===void 0&&(a=Ja.SUM_BY_NONZERO_WEIGHTS);var r=te(e,"labels","meanSquaredError"),i=te(t,"predictions","meanSquaredError"),s=null;n!=null&&(s=te(n,"weights","meanSquaredError")),tn(r.shape,i.shape,"Error in meanSquaredError: ");var o=r.squaredDifference(i);return jo(o,s,a)}}),mB=he({sigmoidCrossEntropy_:function(e,t,n,a,r){a===void 0&&(a=0),r===void 0&&(r=Ja.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"multiClassLabels","sigmoidCrossEntropy"),s=te(t,"logits","sigmoidCrossEntropy"),o=null;if(n!=null&&(o=te(n,"weights","sigmoidCrossEntropy")),tn(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),a>0){var u=at(a),c=at(1),d=at(.5);i=i.mul(c.sub(u)).add(d.mul(u))}var h=function(p,f){var g=te(p,"labels","sigmoidCrossEntropyWithLogits"),b=te(f,"logits","sigmoidCrossEntropyWithLogits");tn(g.shape,b.shape,"Error in sigmoidCrossEntropyWithLogits: ");var w=b.relu(),m=b.mul(g),x=b.abs().neg().exp().log1p();return w.sub(m).add(x)}(i,s);return jo(h,o,r)}}),gB=he({softmaxCrossEntropy_:function(e,t,n,a,r){a===void 0&&(a=0),r===void 0&&(r=Ja.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"onehotLabels","softmaxCrossEntropy"),s=te(t,"logits","softmaxCrossEntropy"),o=null;if(n!=null&&(o=te(n,"weights","softmaxCrossEntropy")),tn(i.shape,s.shape,"Error in softmaxCrossEntropy: "),a>0){var u=at(a),c=at(1),d=at(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(d))}var h=function(p,f,g){if(g===void 0&&(g=-1),g===-1&&(g=f.rank-1),g!==f.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+f.rank+" and dim was "+g);return pv(function(b,w,m){var x=w.logSumExp([g],!0),y=w.toFloat().sub(x);return m([b,y]),{value:y.mul(b).neg().sum([g]),gradFunc:function(N,S){var T=S[0],C=S[1],A=Er(N.shape,[g]);return[N.reshape(A).mul(T.toFloat().sub(C.exp())),N.reshape(A).mul(C.exp().sub(T.toFloat()))]}}})(p,f)}(i,s);return jo(h,o,r)}}),vB=Object.freeze({get Reduction(){return Ja},absoluteDifference:uB,computeWeightedLoss:jo,cosineDistance:cB,hingeLoss:dB,huberLoss:hB,logLoss:fB,meanSquaredError:pB,sigmoidCrossEntropy:mB,softmaxCrossEntropy:gB});function U3(e,t){return t===void 0&&(t=!1),be.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],a=e.shape[1],r=Zj(n),i=e.clone(),s=Sl([[1]],[1,1]),o=s.clone(),u=n>=a?a:n,c=function(h){var p,f=i,g=o,b=r;p=be.tidy(function(){var w=i.slice([h,h],[n-h,1]),m=w.norm(),x=i.slice([h,h],[1,1]),y=Sl([[-1]]).where(x.greater(0),Sl([[1]])),N=x.sub(y.mul(m)),S=w.div(N);o=S.shape[0]===1?s.clone():s.concat(S.slice([1,0],[S.shape[0]-1,S.shape[1]]),0);var T=y.matMul(N).div(m).neg(),C=i.slice([h,0],[n-h,a]),A=T.mul(o);if(h===0)i=C.sub(A.matMul(o.transpose().matMul(C)));else{var R=C.sub(A.matMul(o.transpose().matMul(C)));i=i.slice([0,0],[h,a]).concat(R,0)}var L=r.slice([0,h],[n,r.shape[1]-h]);if(h===0)r=L.sub(L.matMul(o).matMul(A.transpose()));else{var j=L.sub(L.matMul(o).matMul(A.transpose()));r=r.slice([0,0],[n,h]).concat(j,1)}return[o,i,r]}),o=p[0],i=p[1],r=p[2],Cr([f,g,b])},d=0;d<u;++d)c(d);return!t&&n>a&&(r=r.slice([0,0],[n,a]),i=i.slice([0,0],[a,a])),[r,i]})}var xB=he({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var a=te(e,"a","bandPart");if(a.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+a.rank+".");var r=a.shape,i=a.shape.slice(-2),s=i[0],o=i[1];if(!(t<=s))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+s+").");if(!(n<=o))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+o+").");t<0&&(t=s),n<0&&(n=o);var u=f0(0,s,1,"int32").reshape([-1,1]),c=f0(0,o,1,"int32"),d=xa(u,c),h=gv(d.lessEqual(at(+t,"int32")),d.greaterEqual(at(-n,"int32"))),p=Nn([s,o],a.dtype);return ei(ma(a.reshape([-1,s,o])).map(function(f){return Iu(h,f,p)})).reshape(r)}}),bB=he({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,se(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],a=function(u){se(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},r=1;r<e.length;++r)a(r)}else t=!0,e=X2(e,e.shape[0],0).map(function(u){return n6(u,[0])});se(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],s=e,o=function(u){i.push(be.tidy(function(){var c=s[u];if(u>0)for(var d=0;d<u;++d){var h=Q6(i[d].mulStrict(c)).mul(i[d]);c=c.sub(h)}return c.div(nC(c,"euclidean"))}))};for(r=0;r<e.length;++r)o(r);return t?ei(i,0):i}}),yB=he({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return U3(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(s,o){return s*o}),a=ma(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],i=[];return a.forEach(function(s){var o=U3(s,t),u=o[0],c=o[1];r.push(u),i.push(c)}),[ei(r,0).reshape(e.shape),ei(i,0).reshape(e.shape)]}}),wB=Object.freeze({bandPart:xB,gramSchmidt:bB,qr:yB});function yv(e,t,n,a,r,i){a==null&&(a=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);var s=e.shape[0];return n=Math.min(n,s),se(0<=a&&a<=1,function(){return"iouThreshold must be in [0, 1], but was '"+a+"'"}),se(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),se(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),se(t.rank===1,function(){return"scores must be a 1D tensor"}),se(t.shape[0]===s,function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+t.shape[0]}),se(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:i}}var NB=he({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var a=te(e,"images","resizeBilinear");se(a.rank===3||a.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+a.rank+"."}),se(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var r=a,i=!1;a.rank===3&&(i=!0,r=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var s=t[0],o=t[1],u=be.runKernelFunc(function(c,d){return d([r]),c.resizeBilinear(r,s,o,n)},{x:r},function(c,d){return{x:function(){return be.runKernelFunc(function(h){return h.resizeBilinearBackprop(c,d[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:s,newWidth:o});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),kB=he({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var a=te(e,"images","resizeNearestNeighbor");se(a.rank===3||a.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+a.rank+"."}),se(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),se(a.dtype==="float32"||a.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var r=a,i=!1;a.rank===3&&(i=!0,r=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var s=t[0],o=t[1],u=be.runKernelFunc(function(c,d){return d([r]),c.resizeNearestNeighbor(r,s,o,n)},{batchImages:r},function(c,d){return{batchImages:function(){return be.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(c,d[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),SB=he({nonMaxSuppression_:function(e,t,n,a,r){a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY);var i=te(e,"boxes","nonMaxSuppression"),s=te(t,"scores","nonMaxSuppression"),o=yv(i,s,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;var u={maxOutputSize:n,iouThreshold:a,scoreThreshold:r};return be.runKernelFunc(function(c){return c.nonMaxSuppression(i,s,n,a,r)},{boxes:i,scores:s},null,"NonMaxSuppressionV3",u)}}),_B=function(e,t,n,a,r){return a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY),lt(this,void 0,void 0,function(){var i,s,o,u,c,d,h;return ut(this,function(p){switch(p.label){case 0:return i=te(e,"boxes","nonMaxSuppressionAsync"),s=te(t,"scores","nonMaxSuppressionAsync"),o=yv(i,s,n,a,r),n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return u=p.sent(),c=u[0],d=u[1],h=ew(c,d,n,a,r),i!==e&&i.dispose(),s!==t&&s.dispose(),[2,h]}})})},jB=he({nonMaxSuppressionWithScore_:function(e,t,n,a,r,i){a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var s=te(e,"boxes","nonMaxSuppression"),o=te(t,"scores","nonMaxSuppression"),u=yv(s,o,n,a,r,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:a=u.iouThreshold,scoreThreshold:r=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},d=be.runKernel("NonMaxSuppressionV5",{boxes:s,scores:o},c);return{selectedIndices:d[0],selectedScores:d[1]}}}),CB=function(e,t,n,a,r,i){return a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),lt(this,void 0,void 0,function(){var s,o,u,c,d,h,p;return ut(this,function(f){switch(f.label){case 0:return s=te(e,"boxes","nonMaxSuppressionAsync"),o=te(t,"scores","nonMaxSuppressionAsync"),u=yv(s,o,n,a,r,i),n=u.maxOutputSize,a=u.iouThreshold,r=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([s.data(),o.data()])];case 1:return c=f.sent(),d=c[0],h=c[1],p=tw(d,h,n,a,r,i),s!==e&&s.dispose(),o!==t&&o.dispose(),[2,p]}})})},AB=he({cropAndResize_:function(e,t,n,a,r,i){var s=te(e,"image","cropAndResize"),o=te(t,"boxes","cropAndResize","float32"),u=te(n,"boxInd","cropAndResize","int32");r=r||"bilinear",i=i||0;var c=o.shape[0];return se(s.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),se(o.rank===2&&o.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+o.shape+"."}),se(u.rank===1&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+o.shape+"."}),se(a.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+a.length+"."}),se(a[0]>=1&&a[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+a}),se(r==="bilinear"||r==="nearest",function(){return"method must be bilinear or nearest, but was "+r}),be.runKernelFunc(function(d,h){return d.cropAndResize(s,o,u,a,r,i)},{images:s,boxes:o,boxInd:u},null,"CropAndResize",{method:r,extrapolationValue:i,cropSize:a})}}),mw=Object.freeze({resizeBilinear:NB,resizeNearestNeighbor:kB,nonMaxSuppression:SB,nonMaxSuppressionAsync:_B,nonMaxSuppressionWithScore:jB,nonMaxSuppressionWithScoreAsync:CB,cropAndResize:AB}),gw=function(e,t){return!(e>0)||t==="linear"},vw=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},xw=function(e,t){var n=t,a=va(e.shape,t.shape);return a.length>0&&(n=n.sum(a)),n.reshape(e.shape)},bw=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Tn(e);if(t==="elu")return Z6(e);if(t==="relu6")return tC(e);if(t==="prelu")return eC(e,n);throw new Error("Unknown fused activation "+t+".")},EB=he({fusedMatMul_:function(e){var t,n=e.a,a=e.b,r=e.transposeA,i=r!==void 0&&r,s=e.transposeB,o=s!==void 0&&s,u=e.bias,c=e.activation,d=c===void 0?"linear":c,h=e.preluActivationWeights;if(gw(be.state.gradientDepth,d)===!1){var p=xv(n,a,i,o);return u!=null&&(p=Ot(p,u)),bw(p,d,h)}var f=te(n,"a","fused matMul"),g=te(a,"b","fused matMul");t=Pn(f,g),f=t[0],g=t[1];var b=i?f.shape[f.rank-2]:f.shape[f.rank-1],w=o?g.shape[g.rank-1]:g.shape[g.rank-2],m=i?f.shape[f.rank-1]:f.shape[f.rank-2],x=o?g.shape[g.rank-2]:g.shape[g.rank-1],y=f.shape.slice(0,-2),N=g.shape.slice(0,-2),S=ht(y),T=ht(N);se(f.rank>=2&&g.rank>=2&&f.rank===g.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+g.rank+"."}),se(Aa(y,N),function(){return"Error in fused matMul: outer dimensions ("+y+") and ("+N+") of Tensors with shapes "+f.shape+" and "+g.shape+" must match."}),se(b===w,function(){return"Error in fused matMul: inner shapes ("+b+") and ("+w+") of Tensors with shapes "+f.shape+" and "+g.shape+" and transposeA="+i+" and transposeB="+o+" must match."});var C,A,R=f.shape.slice(0,-2).concat([m,x]),L=i?f.as3D(S,b,m):f.as3D(S,m,b),j=o?g.as3D(T,x,w):g.as3D(T,w,x);u!=null&&zt(R,(C=Pn(C=te(u,"bias","fused matMul"),f)[0]).shape),h!=null&&(A=te(h,"prelu weights","fused matMul"));var D={a:L,b:j};u!=null&&(D.bias=C),h!=null&&(D.preluActivationWeights=A);var B=[L,j];return be.runKernelFunc(function(z,U){var I=z.fusedBatchMatMul({a:L,b:j,transposeA:i,transposeB:o,bias:C,activation:d,preluActivationWeights:A});return U([L,j,I]),I},D,function(z,U){var I=U[0],F=U[1],q=U[2],O=vw(z,q,d),$={};return u!=null&&($={bias:function(){return xw(C,O)}}),Object.assign(i||o?!i&&o?{a:function(){return O.matMul(F,!1,!1)},b:function(){return O.matMul(I,!0,!1)}}:i&&!o?{a:function(){return F.matMul(O,!1,!0)},b:function(){return I.matMul(O,!1,!1)}}:{a:function(){return F.matMul(O,!0,!0)},b:function(){return O.matMul(I,!0,!0)}}:{a:function(){return O.matMul(F,!1,!0)},b:function(){return I.matMul(O,!0,!1)}},$)},"_FusedMatMul",{transposeA:i,transposeB:o,activation:d},B,[!0]).reshape(R)}}),DB=he({fusedConv2d_:function(e){var t=e.x,n=e.filter,a=e.strides,r=e.pad,i=e.dataFormat,s=i===void 0?"NHWC":i,o=e.dilations,u=o===void 0?[1,1]:o,c=e.dimRoundingMode,d=e.bias,h=e.activation,p=h===void 0?"linear":h,f=e.preluActivationWeights;if(p=p||"linear",gw(be.state.gradientDepth,p)===!1){var g=Di(t,n,a,r,s,u,c);return d!=null&&(g=Ot(g,d)),bw(g,p,f)}var b=te(t,"x","conv2d"),w=te(n,"filter","conv2d"),m=b,x=!1;b.rank===3&&(x=!0,m=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),se(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),se(w.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+w.rank+"."}),c!=null&&se(Qn(r),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+r+"."}),se(m.shape[3]===w.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+w.shape[2]+"."}),se(Dr(a,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+u+"'"}),se(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var y,N,S=Vu(m.shape,w.shape,a,u,r,c);d!=null&&(y=Pn(y=te(d,"bias","fused conv2d"),b)[0],zt(S.outShape,y.shape)),f!=null&&(N=te(f,"prelu weights","fused conv2d"));var T={x:m,filter:w};d!=null&&(T.bias=y),f!=null&&(T.preluActivationWeights=N);var C=[w,m],A=be.runKernelFunc(function(R,L){var j=R.fusedConv2d({input:m,filter:w,convInfo:S,bias:y,activation:p,preluActivationWeights:N});return L([w,m,j]),j},T,function(R,L){var j=L,D=j[0],B=j[1],z=j[2],U=vw(R,z,p);se(qd(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var I={};return d!=null&&(I={bias:function(){return xw(y,U)}}),Object.assign({x:function(){return G6(B.shape,U,D,a,r)},filter:function(){return uw(B,U,D.shape,a,r)}},I)},"FusedConv2D",{convInfo:S,activation:p},C,[!0]);return x?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}}),TB=he({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,a=e.strides,r=e.pad,i=e.dataFormat,s=i===void 0?"NHWC":i,o=e.dilations,u=o===void 0?[1,1]:o,c=e.dimRoundingMode,d=e.bias,h=e.activation,p=h===void 0?"linear":h,f=e.preluActivationWeights;if(gw(be.state.gradientDepth,p)===!1){var g=vv(t,n,a,r,s,u,c);return d!=null&&(g=Ot(g,d)),bw(g,p,f)}var b=te(t,"x","depthwiseConv2d"),w=te(n,"filter","depthwiseConv2d"),m=b,x=!1;b.rank===3&&(x=!0,m=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),se(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),se(w.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+w.rank+"."}),se(m.shape[3]===w.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+w.shape[2]+"."}),u==null&&(u=[1,1]),se(Dr(a,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+u+"'"}),c!=null&&se(Qn(r),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+r+"."});var y,N,S=Vu(m.shape,w.shape,a,u,r,c,!0);d!=null&&(y=Pn(y=te(d,"bias","fused conv2d"),b)[0],zt(S.outShape,y.shape)),f!=null&&(N=te(f,"prelu weights","fused depthwiseConv2d"));var T={x:m,filter:w};d!=null&&(T.bias=y),f!=null&&(T.preluActivationWeights=N);var C=[w,m],A=be.runKernelFunc(function(R,L){var j=R.fusedDepthwiseConv2D({input:m,filter:w,convInfo:S,bias:y,activation:p,preluActivationWeights:N});return L([w,m,j]),j},T,function(R,L){se(qd(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var j=L[0],D=L[1],B=L[2],z=vw(R,B,p),U={};return d!=null&&(U={bias:function(){return xw(y,z)}}),Object.assign({x:function(){return V6(D.shape,z,j,S)},filter:function(){return K6(D,z,j.shape,S)}},U)},"FusedDepthwiseConv2D",{convInfo:S,activation:p},C,[!0]);return x?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}}),RB=Object.freeze({matMul:EB,conv2d:DB,depthwiseConv2d:TB}),LB=Object.freeze({image:mw,linalg:wB,losses:vB,spectral:nB,fused:RB,signal:oB,square:fO,squaredDifference:E6,conv1d:NF,conv2d:Di,conv3d:kF,depthwiseConv2d:vv,separableConv2d:cw,conv2dTranspose:SF,conv3dTranspose:_F,op:he,batchNormalization2d:HO,batchNormalization3d:WO,batchNormalization4d:GO,batchNormalization:VO,batchNorm:M6,batchNorm2d:KO,batchNorm3d:$O,batchNorm4d:YO,booleanMaskAsync:wF,complex:Ia,real:wi,imag:ys,concat:pa,concat1d:RM,concat2d:LM,concat3d:PM,concat4d:MM,split:X2,matMul:xv,dot:jF,outerProduct:CF,reverse:Sp,reverse1d:AF,reverse2d:EF,reverse3d:DF,reverse4d:TF,maxPool:ka,avgPool:_p,pool:RF,maxPool3d:LF,avgPool3d:PF,slice:Ps,slice1d:MF,slice2d:IF,slice3d:X6,slice4d:OF,abs:pO,acos:mO,acosh:gO,asin:vO,asinh:xO,atan:bO,atanh:yO,ceil:wO,clipByValue:sw,cos:NO,cosh:kO,erf:SO,exp:cy,expm1:_O,floor:jO,log:CO,log1p:AO,logSigmoid:EO,neg:w0,reciprocal:DO,round:TO,rsqrt:D6,sigmoid:T6,sign:RO,isNaN:LO,isInf:PO,isFinite:MO,sin:IO,sinh:OO,softplus:FO,sqrt:BO,step:zO,tan:UO,tanh:qO,all:FF,any:BF,argMax:zF,argMin:UF,logSumExp:qF,max:bv,mean:HF,min:WF,moments:GF,sum:Q6,prod:VF,equal:z6,equalStrict:dF,greater:hF,greaterEqual:U6,greaterEqualStrict:fF,greaterStrict:pF,less:mF,lessEqual:gF,lessEqualStrict:vF,lessStrict:xF,notEqual:bF,notEqualStrict:yF,add:Ot,addN:QO,addStrict:ZO,atan2:eF,div:Vi,divNoNan:tF,divStrict:nF,floorDiv:F6,maximum:ow,maximumStrict:aF,minimum:B6,minimumStrict:rF,mod:iF,modStrict:sF,mul:tr,mulStrict:oF,pow:N0,powStrict:lF,squaredDifferenceStrict:uF,sub:xa,subStrict:cF,elu:Z6,leakyRelu:KF,prelu:eC,relu:Tn,relu6:tC,selu:$F,logicalAnd:gv,logicalNot:XO,logicalOr:I6,logicalXor:JO,where:Iu,whereAsync:O6,buffer:Et,print:WM,batchToSpaceND:Qj,broadcastTo:GM,cast:VM,clone:KM,cumsum:$M,depthToSpace:YM,expandDims:xi,eye:Zj,multinomial:XM,oneHot:sy,pad:Gu,pad1d:JM,pad2d:QM,pad3d:ZM,pad4d:e7,rand:t7,randomNormal:n7,randomGamma:a7,randomUniform:e6,reshape:Ki,spaceToBatchND:t6,squeeze:n6,stack:ei,tile:md,truncatedNormal:r7,unstack:ma,setdiff1dAsync:i7,fill:Ts,linspace:TM,ones:ah,range:f0,scalar:at,tensor:Fa,tensor1d:ia,tensor2d:Sl,tensor3d:Y2,tensor4d:Sr,tensor5d:AM,tensor6d:EM,variable:DM,zeros:Nn,onesLike:Jj,zerosLike:Wt,transpose:Ll,softmax:_o,logSoftmax:h7,localResponseNormalization:YF,norm:nC,gather:lw,unsortedSegmentSum:q6,basicLSTMCell:XF,multiRNNCell:JF,movingAverage:QF,stridedSlice:ZF,topk:eB,scatterND:tB,fft:dw,ifft:k0,rfft:hw,irfft:aC,sparseToDense:aB,gatherND:rB,diag:iB,dropout:sB,hannWindow:fw,hammingWindow:iC,frame:pw,stft:sC,inTopKAsync:lB});function Ve(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&se(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Sb(e,t,n,a){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,a);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var PB=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new u6(n,be),n}return Qi(t,e),t.prototype.write=function(n,a,r){this.firstUse&&(this.firstUse=!1,Oe().get("IS_NODE")&&d0(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:r}),i},t.prototype.move=function(n,a,r,i){this.data.set(n,{values:a,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var a=this.data.get(n),r=a.dtype,i=a.complexTensors;return r==="complex64"?uy(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var a=this.readSync(n.dataId),r=a;if(n.dtype==="string")try{r=a.map(function(i){return l0(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Et(n.shape,n.dtype,r)},t.prototype.makeOutput=function(n,a,r){var i=this.write(n,a,r);return be.makeTensorFromDataId(i,a,r,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var a=this.data.get(n).complexTensors;a!=null&&(a.real.dispose(),a.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){return a=vs(),n(),[2,{kernelMs:vs()-a}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,a){var r=this.makeOutput(null,n.shape,"complex64");return this.data.get(r.dataId).complexTensors={real:be.keep(n.clone()),imag:be.keep(a.clone())},r},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,a,r){if(Ve(n,"slice"),o6(n.shape,a,r)){var i=l6(a,n.strides),s=ht(r);return Fa(this.readSync(n.dataId).subarray(i,i+s),r,n.dtype)}for(var o=Et(r,n.dtype),u=this.bufferSync(n),c=0;c<o.size;++c){var d=o.indexToLoc(c).map(function(h,p){return h+a[p]});o.values[c]=u.get.apply(u,d)}return o.toTensor()},t.prototype.stridedSlice=function(n,a,r,i){Ve(n,"stridedSlice");var s=Q2(a,r,i);if(s.some(function(f){return f===0}))return Fa([],s);for(var o=Et(s,n.dtype),u=this.bufferSync(n),c=0;c<o.size;c++){for(var d=o.indexToLoc(c),h=new Array(d.length),p=0;p<h.length;p++)h[p]=d[p]*i[p]+a[p];o.set.apply(o,[u.get.apply(u,h)].concat(d))}return o.toTensor()},t.prototype.diag=function(n){for(var a=this.readSync(n.dataId),r=Et([n.size,n.size],n.dtype),i=r.values,s=0;s<a.length;s++)i[s*n.size+s]=a[s];return r.toTensor()},t.prototype.unstack=function(n,a){for(var r=n.shape[a],i=new Array(n.rank-1),s=0,o=0;o<n.rank;o++)o!==a&&(i[s++]=n.shape[o]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[a]=1;var d=new Array(r);for(o=0;o<d.length;o++)u[a]=o,d[o]=this.slice(n,u,c).reshape(i);return d},t.prototype.reverse=function(n,a){Ve(n,"reverse");for(var r=Et(n.shape,n.dtype),i=this.bufferSync(n),s=function(u){var c=r.indexToLoc(u),d=c.slice();a.forEach(function(h){return d[h]=n.shape[h]-1-d[h]}),r.set.apply(r,[i.get.apply(i,d)].concat(c))},o=0;o<r.size;o++)s(o);return r.toTensor()},t.prototype.concat=function(n,a){var r=this;if(n[0].dtype==="complex64"){var i=n.map(function(f){return wi(f)}),s=n.map(function(f){return ys(f)});return Ia(this.concat(i,a),this.concat(s,a))}var o=n.map(function(f){var g=ht(f.shape.slice(a));return f.as2D(-1,g)}),u=Ud(o.map(function(f){return f.shape}),1),c=Et(u,n[0].dtype).values;if(o[0].shape[0]===1){var d=0;o.forEach(function(f){c.set(r.readSync(f.dataId),d),d+=f.size})}else{var h=0;o.forEach(function(f){for(var g=r.readSync(f.dataId),b=0,w=0;w<f.shape[0];++w)for(var m=w*u[1]+h,x=0;x<f.shape[1];++x)c[m+x]=g[b++];h+=f.shape[1]})}var p=Ud(n.map(function(f){return f.shape}),a);return Fa(c,p,n[0].dtype)},t.prototype.neg=function(n){return Ve(n,"neg"),this.multiply(at(-1),n)},t.prototype.add=function(n,a){return n.dtype==="complex64"||a.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),a.cast("complex64"),function(r,i,s,o){return{real:r+s,imag:i+o}}):this.broadcastedBinaryOp(n,a,Oa(n.dtype,a.dtype),function(r,i){return r+i})},t.prototype.addN=function(n){var a=this;Ve(n,"addN");for(var r=n.map(function(d){return a.readSync(d.dataId)}),i=Et(n[0].shape,n[0].dtype),s=i.values,o=0;o<n.length;o++)for(var u=r[o],c=0;c<s.length;c++)s[c]+=u[c];return i.toTensor()},t.prototype.softmax=function(n,a){var r=ba([a],n.shape),i=this.max(n,r),s=Er(i.shape,r),o=this.subtract(n,i.reshape(s)),u=this.exp(o),c=this.sum(u,r).reshape(s);return this.realDivide(u,c)},t.prototype.subtract=function(n,a){return n.dtype==="complex64"||a.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),a.cast("complex64"),function(r,i,s,o){return{real:r-s,imag:i-o}}):this.broadcastedBinaryOp(n,a,Oa(n.dtype,a.dtype),function(r,i){return r-i})},t.prototype.pow=function(n,a){return Ve([n,a],"pow"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.pow(r,i)})},t.prototype.batchMatMul=function(n,a,r,i){Ve([n,a],"matMul");for(var s=r?n.shape[1]:n.shape[2],o=r?n.shape[2]:n.shape[1],u=i?a.shape[1]:a.shape[2],c=n.shape[0],d=this.readSync(n.dataId),h=this.readSync(a.dataId),p=r?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],f=p[0],g=p[1],b=p[2],w=i?[1,a.strides[1],a.strides[0]]:[a.strides[1],1,a.strides[0]],m=w[0],x=w[1],y=w[2],N=o*u,S=Et([c,o,u],n.dtype),T=S.values,C=this.blockSize,A=0;A<c;A++)for(var R=0;R<o;R+=C)for(var L=0;L<u;L+=C)for(var j=0;j<s;j+=C)for(var D=Math.min(R+C,o),B=Math.min(L+C,u),z=Math.min(j+C,s),U=R;U<D;U++)for(var I=L;I<B;I++){for(var F=0,q=j;q<z;q++)F+=d[A*f+U*g+q*b]*h[q*m+I*x+A*y];T[A*N+(U*u+I)]+=F}return S.toTensor()},t.prototype.fusedBatchMatMul=function(n){var a=n.a,r=n.b,i=n.transposeA,s=n.transposeB,o=n.bias,u=n.activation,c=n.preluActivationWeights,d=this.batchMatMul(a,r,i,s);return o&&(d=this.add(d,o)),u&&(d=Sb(this,d,u,c)),d},t.prototype.multiply=function(n,a){return n.dtype==="complex64"||a.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),a.cast("complex64"),function(r,i,s,o){return{real:r*s-i*o,imag:r*o+i*s}}):this.broadcastedBinaryOp(n,a,Oa(n.dtype,a.dtype),function(r,i){return r*i})},t.prototype.realDivide=function(n,a){return Ve([n,a],"realDivide"),this.broadcastedBinaryOp(n,a,"float32",function(r,i){return r/i})},t.prototype.floorDiv=function(n,a){return Ve([n,a],"floorDiv"),this.broadcastedBinaryOp(n,a,"int32",function(r,i){return Math.floor(r/i)})},t.prototype.sum=function(n,a){Ve(n,"sum"),qr("sum",a,n.rank);for(var r=$a(n.shape,a),i=r[0],s=r[1],o=Nn(i,Oa(n.dtype,"int32")),u=ht(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=0,g=0;g<u;++g)f+=d[p+g];c[h]=f}return o},t.prototype.prod=function(n,a){Ve(n,"sum");for(var r=$a(n.shape,a),i=r[0],s=r[1],o=Nn(i,Oa(n.dtype,"int32")),u=ht(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=1,g=0;g<u;++g)f*=d[p+g];c[h]=f}return o},t.prototype.unsortedSegmentSum=function(n,a,r){Ve(n,"unsortedSegmentSum");for(var i=[],s=n.rank-a.rank,o=0;o<s;++o)a=a.expandDims(o+1);for(o=0;o<r;++o){var u=at(o,"int32"),c=z6(u,a).asType("float32").mul(n).sum(0);i.push(c)}return ei(i)},t.prototype.argMin=function(n,a){Ve(n,"argMin");var r=[a];qr("argMin",r,n.rank);for(var i=$a(n.shape,r),s=i[0],o=i[1],u=Nn(s,"int32"),c=ht(o),d=this.readSync(u.dataId),h=this.readSync(n.dataId),p=0;p<d.length;++p){for(var f=p*c,g=h[f],b=0,w=0;w<c;++w){var m=h[f+w];m<g&&(g=m,b=w)}d[p]=b}return u},t.prototype.argMax=function(n,a){Ve(n,"argMax");var r=[a];qr("argMax",r,n.rank);for(var i=$a(n.shape,r),s=i[0],o=i[1],u=Nn(s,"int32"),c=ht(o),d=this.readSync(u.dataId),h=this.readSync(n.dataId),p=0;p<d.length;++p){for(var f=p*c,g=h[f],b=0,w=0;w<c;++w){var m=h[f+w];m>g&&(g=m,b=w)}d[p]=b}return u},t.prototype.cumsum=function(n,a,r,i){if(Ve(n,"cumsum"),a!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+a);for(var s=Oa(n.dtype,"int32"),o=Nn(n.shape,s),u=this.readSync(o.dataId),c=this.readSync(n.dataId),d=n.shape[n.rank-1],h=i?function(w,m){return w+d-m-1}:function(w,m){return w+m},p=0;p<c.length;p+=d)for(var f=0;f<d;f++){var g=h(p,f);if(f===0)u[g]=r?0:c[g];else{var b=h(p,f-1);u[g]=r?c[b]+u[b]:c[g]+u[b]}}return o},t.prototype.equal=function(n,a){return Ve([n,a],"equal"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r===i?1:0})},t.prototype.notEqual=function(n,a){return Ve([n,a],"notEqual"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r!==i?1:0})},t.prototype.less=function(n,a){return Ve([n,a],"less"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r<i?1:0})},t.prototype.lessEqual=function(n,a){return Ve([n,a],"lessEqual"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r<=i?1:0})},t.prototype.greater=function(n,a){return Ve([n,a],"greater"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r>i?1:0})},t.prototype.greaterEqual=function(n,a){return Ve([n,a],"greaterEqual"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r>=i?1:0})},t.prototype.logicalNot=function(n){Ve(n,"logicalNot");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)r[i]=a[i]?0:1;return this.makeOutput(r,n.shape,"bool")},t.prototype.logicalAnd=function(n,a){return Ve([n,a],"logicalAnd"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r&&i})},t.prototype.logicalOr=function(n,a){return Ve([n,a],"logicalOr"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r||i})},t.prototype.select=function(n,a,r){Ve([n,a,r],"select");for(var i=this.readSync(n.dataId),s=this.readSync(a.dataId),o=this.readSync(r.dataId),u=Nn(a.shape,Oa(a.dtype,r.dtype)),c=this.readSync(u.dataId),d=0,h=n.rank===0||n.rank>1||a.rank===1?1:ht(a.shape.slice(1)),p=0;p<i.length;p++)for(var f=0;f<h;f++)i[p]===1?c[d++]=s[p]:c[d++]=o[p];return u},t.prototype.where=function(n){Ve([n],"where");var a=this.readSync(n.dataId);return nw(n.shape,a)},t.prototype.topk=function(n,a,r){return Ve(n,"topk"),v6(this.readSync(n.dataId),n.shape,n.dtype,a)},t.prototype.min=function(n,a){Ve(n,"min"),qr("min",a,n.rank);for(var r=$a(n.shape,a),i=r[0],s=r[1],o=Nn(i,n.dtype),u=ht(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];b<f&&(f=b)}c[h]=f}return o},t.prototype.minimum=function(n,a){return Ve([n,a],"minimum"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.min(r,i)})},t.prototype.mod=function(n,a){return Ve([n,a],"mod"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){var s=r%i;return r<0&&i<0||r>=0&&i>=0?s:(s+i)%i})},t.prototype.max=function(n,a){Ve(n,"max"),qr("max",a,n.rank);for(var r=$a(n.shape,a),i=r[0],s=r[1],o=Nn(i,n.dtype),u=ht(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];b>f&&(f=b)}c[h]=f}return o},t.prototype.maximum=function(n,a){return Ve([n,a],"maximum"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.max(r,i)})},t.prototype.all=function(n,a){Ve(n,"all"),qr("all",a,n.rank);for(var r=$a(n.shape,a),i=r[0],s=r[1],o=Nn(i,n.dtype),u=ht(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];f=f&&b}c[h]=f}return o},t.prototype.any=function(n,a){Ve(n,"any"),qr("any",a,n.rank);for(var r=$a(n.shape,a),i=r[0],s=r[1],o=Nn(i,n.dtype),u=ht(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];f=f||b}c[h]=f}return o},t.prototype.squaredDifference=function(n,a){return Ve([n,a],"squaredDifference"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){var s=r-i;return s*s})},t.prototype.ceil=function(n){Ve(n,"ceil");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.ceil(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.floor=function(n){Ve(n,"floor");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.floor(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.sign=function(n){Ve(n,"x");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)a[i]<0?r[i]=-1:a[i]>0?r[i]=1:r[i]=0;return this.makeOutput(r,n.shape,"float32")},t.prototype.isNaN=function(n){Ve(n,"x");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)Number.isNaN(a[i])&&(r[i]=1);return this.makeOutput(r,n.shape,"bool")},t.prototype.isInf=function(n){Ve(n,"x");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)Math.abs(a[i])===1/0&&(r[i]=1);return this.makeOutput(r,n.shape,"bool")},t.prototype.isFinite=function(n){Ve(n,"x");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)Number.isFinite(a[i])&&(r[i]=1);return this.makeOutput(r,n.shape,"bool")},t.prototype.round=function(n){Ve(n,"round");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=Math.floor(a[i]);a[i]-s<.5?r[i]=Math.floor(a[i]):a[i]-s>.5?r[i]=Math.ceil(a[i]):r[i]=s%2==0?s:s+1}return this.makeOutput(r,n.shape,"float32")},t.prototype.exp=function(n){Ve(n,"exp");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.exp(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.expm1=function(n){Ve(n,"expm1");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.expm1(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.log=function(n){Ve(n,"log");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=Math.log(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.log1p=function(n){Ve(n,"log1p");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=Math.log1p(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.sqrt=function(n){Ve(n,"sqrt");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=Math.sqrt(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.rsqrt=function(n){Ve(n,"rsqrt");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=1/Math.sqrt(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.reciprocal=function(n){Ve(n,"reciprocal");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=1/a[i];return this.makeOutput(r,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){Ve(n,"relu");for(var a=Nn(n.shape,n.dtype),r=this.readSync(a.dataId),i=this.readSync(n.dataId),s=0;s<i.length;++s)r[s]=Math.max(0,i[s]);return a},t.prototype.relu6=function(n){Ve(n,"relu");for(var a=Nn(n.shape,n.dtype),r=this.readSync(a.dataId),i=this.readSync(n.dataId),s=0;s<i.length;++s)r[s]=Math.min(Math.max(0,i[s]),6);return a},t.prototype.prelu=function(n,a){return Ve([n,a],"prelu"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return r<0?i*r:r})},t.prototype.elu=function(n){Ve(n,"elu");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i){var s=r[i];a[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(a,n.shape,"float32")},t.prototype.eluDer=function(n,a){Ve([n,a],"eluDer");for(var r=new Float32Array(a.size),i=this.readSync(a.dataId),s=this.readSync(n.dataId),o=0;o<i.length;++o){var u=i[o];r[o]=u>=1?s[o]:s[o]*(u+1)}return this.makeOutput(r,a.shape,"float32")},t.prototype.selu=function(n){Ve(n,"selu");for(var a=rw,r=iw,i=new Float32Array(n.size),s=this.readSync(n.dataId),o=0;o<s.length;++o){var u=s[o];i[o]=u>=0?r*u:a*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,a,r){Ve(n,"clip");for(var i=new Float32Array(n.size),s=this.readSync(n.dataId),o=0;o<s.length;++o){var u=s[o];i[o]=u>r?r:u<a?a:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.abs(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<n.size;++i){var s=r[2*i],o=r[2*i+1];a[i]=Math.hypot(s,o)}return this.makeOutput(a,n.shape,"float32")},t.prototype.int=function(n){Ve(n,"int");for(var a=new Int32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=r[i];return this.makeOutput(a,n.shape,"int32")},t.prototype.sigmoid=function(n){Ve(n,"sigmoid");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=1/(1+Math.exp(-r[i]));return this.makeOutput(a,n.shape,"float32")},t.prototype.softplus=function(n){Ve(n,"softplus");for(var a=Math.log(11920928955078125e-23)+2,r=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var o=i[s]>-a,u=i[s]<a,c=Math.exp(i[s]),d=void 0;d=u?c:o?i[s]:Math.log(1+c),r[s]=d}return this.makeOutput(r,n.shape,"float32")},t.prototype.sin=function(n){Ve(n,"sin");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.sin(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.cos=function(n){Ve(n,"cos");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.cos(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.tan=function(n){Ve(n,"tan");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.tan(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.asin=function(n){Ve(n,"asin");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.asin(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.acos=function(n){Ve(n,"acos");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.acos(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.atan=function(n){Ve(n,"atan");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.atan(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.atan2=function(n,a){return Ve([n,a],"atan2"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.atan2(r,i)})},t.prototype.sinh=function(n){Ve(n,"sinh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.sinh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.cosh=function(n){Ve(n,"cosh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.cosh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.tanh=function(n){Ve(n,"tanh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=M8(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.asinh=function(n){Ve(n,"asinh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.asinh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.acosh=function(n){Ve(n,"acosh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.acosh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.atanh=function(n){Ve(n,"atanh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.atanh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.erf=function(n){Ve(n,"erf");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i){var s=Math.sign(r[i]),o=Math.abs(r[i]),u=1/(1+.3275911*o);a[i]=s*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-o*o))}return this.makeOutput(a,n.shape,"float32")},t.prototype.step=function(n,a){a===void 0&&(a=0),Ve(n,"step");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var o=i[s];isNaN(o)?r[s]=NaN:r[s]=o>0?1:a}return this.makeOutput(r,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var a=n.input,r=n.filter,i=n.convInfo,s=n.bias,o=n.activation,u=n.preluActivationWeights,c=this.conv2d(a,r,i);return s&&(c=this.add(c,s)),o&&(c=Sb(this,c,o,u)),c},t.prototype.conv2d=function(n,a,r){Ve([n,a],"conv2d");for(var i=r.filterHeight,s=r.filterWidth,o=r.dilationHeight,u=r.dilationWidth,c=r.padInfo.left,d=r.padInfo.top,h=r.dataFormat==="channelsLast",p=Et(r.outShape,n.dtype),f=n.strides[0],g=h?n.strides[1]:n.strides[2],b=h?n.strides[2]:1,w=h?1:n.strides[1],m=p.strides[0],x=h?p.strides[1]:p.strides[2],y=h?p.strides[2]:1,N=h?1:p.strides[1],S=this.readSync(n.dataId),T=this.readSync(a.dataId),C=p.values,A=0;A<r.batchSize;++A)for(var R=A*f,L=A*m,j=0;j<r.outHeight;++j)for(var D=L+j*x,B=j*r.strideHeight-d,z=0;z<i;z++){var U=B+z*o;if(!(U<0||U>=r.inHeight))for(var I=z*a.strides[0],F=R+U*g,q=0;q<r.outWidth;++q)for(var O=D+q*y,$=q*r.strideWidth-c,Z=0;Z<s;Z++){var P=$+Z*u;if(!(P<0||P>=r.inWidth))for(var W=F+P*b,K=I+Z*a.strides[1],J=0;J<r.inChannels;++J){for(var H=S[W+J*w],ie=0;ie<r.outChannels;++ie)C[O+ie*N]+=H*T[K+ie];K+=r.outChannels}}}return p.toTensor()},t.prototype.conv3d=function(n,a,r){for(var i=r.filterDepth,s=r.filterHeight,o=r.filterWidth,u=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,h=r.padInfo.front,p=r.padInfo.left,f=r.padInfo.top,g=Et(r.outShape,n.dtype),b=this.readSync(n.dataId),w=this.readSync(a.dataId),m=g.values,x=0;x<r.batchSize;++x)for(var y=x*n.strides[0],N=x*g.strides[0],S=0;S<r.outDepth;++S)for(var T=N+S*g.strides[1],C=S*r.strideDepth-h,A=0;A<i;A++){var R=C+A*u;if(!(R<0||R>=r.inDepth))for(var L=A*a.strides[0],j=y+R*n.strides[1],D=0;D<r.outHeight;++D)for(var B=T+D*g.strides[2],z=D*r.strideHeight-f,U=0;U<s;U++){var I=z+U*c;if(!(I<0||I>=r.inHeight))for(var F=L+U*a.strides[1],q=j+I*n.strides[2],O=0;O<r.outWidth;++O)for(var $=B+O*r.outChannels,Z=O*r.strideWidth-p,P=0;P<o;P++){var W=Z+P*d;if(!(W<0||W>=r.inWidth))for(var K=F+P*a.strides[2],J=q+W*r.inChannels,H=K,ie=0;ie<r.inChannels;++ie){for(var ue=b[J+ie],ce=0;ce<r.outChannels;++ce)m[$+ce]+=ue*w[H+ce];H+=r.outChannels}}}}return g.toTensor()},t.prototype.conv2dDerInput=function(n,a,r){Ve([n,a],"conv2dDerInput");for(var i=Et(r.inShape,"float32"),s=i.values,o=this.readSync(n.dataId),u=this.readSync(a.dataId),c=a.strides,d=c[0],h=c[1],p=c[2],f=r.batchSize,g=r.filterHeight,b=r.filterWidth,w=r.inChannels,m=r.inHeight,x=r.inWidth,y=r.outChannels,N=r.outHeight,S=r.outWidth,T=r.strideHeight,C=r.strideWidth,A=r.dataFormat,R=g-1-r.padInfo.top,L=b-1-r.padInfo.left,j=A==="channelsLast",D=i.strides[0],B=j?i.strides[1]:i.strides[2],z=j?i.strides[2]:1,U=j?1:i.strides[1],I=n.strides[0],F=j?n.strides[1]:n.strides[2],q=j?n.strides[2]:1,O=j?1:n.strides[1],$=0;$<f;++$)for(var Z=0;Z<w;++Z)for(var P=0;P<m;++P)for(var W=P-R,K=Math.max(0,Math.ceil(W/T)),J=Math.min(N,(g+W)/T),H=0;H<x;++H){for(var ie=H-L,ue=Math.max(0,Math.ceil(ie/C)),ce=Math.min(S,(b+ie)/C),pe=0,ve=K;ve<J;++ve)for(var De=ve*T-W,Re=ue;Re<ce;++Re)for(var we=I*$+F*ve+q*Re,xe=d*(g-1-De)+h*(b-1-(Re*C-ie))+p*Z,ne=0;ne<y;++ne)pe+=o[we+O*ne]*u[xe+ne];s[D*$+B*P+z*H+U*Z]=pe}return i.toTensor()},t.prototype.conv3dDerInput=function(n,a,r){for(var i=Et(r.inShape,"float32"),s=i.values,o=i.strides,u=o[0],c=o[1],d=o[2],h=o[3],p=this.readSync(n.dataId),f=n.strides,g=f[0],b=f[1],w=f[2],m=f[3],x=this.readSync(a.dataId),y=a.strides,N=y[0],S=y[1],T=y[2],C=y[3],A=r.batchSize,R=r.filterDepth,L=r.filterHeight,j=r.filterWidth,D=r.inChannels,B=r.inDepth,z=r.inHeight,U=r.inWidth,I=r.outChannels,F=r.outDepth,q=r.outHeight,O=r.outWidth,$=r.strideDepth,Z=r.strideHeight,P=r.strideWidth,W=R-1-r.padInfo.front,K=L-1-r.padInfo.top,J=j-1-r.padInfo.left,H=0;H<A;++H)for(var ie=0;ie<D;++ie)for(var ue=0;ue<B;++ue)for(var ce=ue-W,pe=Math.max(0,Math.ceil(ce/$)),ve=Math.min(F,(R+ce)/$),De=0;De<z;++De)for(var Re=De-K,we=Math.max(0,Math.ceil(Re/Z)),xe=Math.min(q,(L+Re)/Z),ne=0;ne<U;++ne){for(var Qe=ne-J,Je=Math.max(0,Math.ceil(Qe/P)),Ae=Math.min(O,(j+Qe)/P),Ge=0,_e=pe;_e<ve;++_e)for(var de=_e*$-ce,ke=we;ke<xe;++ke)for(var Fe=ke*Z-Re,Ze=Je;Ze<Ae;++Ze)for(var Xe=g*H+b*_e+w*ke+m*Ze,oe=N*(R-1-de)+S*(L-1-Fe)+T*(j-1-(Ze*P-Qe))+C*ie,Be=0;Be<I;++Be)Ge+=p[Xe+Be]*x[oe+Be];s[u*H+c*ue+d*De+h*ne+ie]=Ge}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,a,r){Ve([n,a],"conv2dDerFilter");for(var i=r.strideHeight,s=r.strideWidth,o=r.filterHeight,u=r.filterWidth,c=r.dataFormat==="channelsLast",d=Et(r.filterShape,"float32"),h=r.padInfo.left,p=r.padInfo.top,f=this.bufferSync(n),g=this.bufferSync(a),b=0;b<o;++b)for(var w=Math.max(0,Math.ceil((p-b)/i)),m=Math.min(r.outHeight,(r.inHeight+p-b)/i),x=0;x<u;++x)for(var y=Math.max(0,Math.ceil((h-x)/s)),N=Math.min(r.outWidth,(r.inWidth+h-x)/s),S=0;S<r.inChannels;++S)for(var T=0;T<r.outChannels;++T){for(var C=0,A=0;A<r.batchSize;++A)for(var R=w;R<m;++R)for(var L=b+R*i-p,j=y;j<N;++j){var D=x+j*s-h;C+=c?f.get(A,L,D,S)*g.get(A,R,j,T):f.get(A,S,L,D)*g.get(A,T,R,j)}d.set(C,b,x,S,T)}return d.toTensor()},t.prototype.conv3dDerFilter=function(n,a,r){for(var i=r.strideDepth,s=r.strideHeight,o=r.strideWidth,u=r.filterDepth,c=r.filterHeight,d=r.filterWidth,h=Et(r.filterShape,"float32"),p=h.values,f=h.strides,g=f[0],b=f[1],w=f[2],m=f[3],x=this.readSync(a.dataId),y=a.strides,N=y[0],S=y[1],T=y[2],C=y[3],A=this.readSync(n.dataId),R=n.strides,L=R[0],j=R[1],D=R[2],B=R[3],z=r.padInfo.front,U=r.padInfo.left,I=r.padInfo.top,F=0;F<u;++F)for(var q=Math.max(0,Math.ceil((z-F)/i)),O=Math.min(r.outDepth,(r.inDepth+z-F)/i),$=F*g,Z=0;Z<c;++Z)for(var P=Math.max(0,Math.ceil((I-Z)/s)),W=Math.min(r.outHeight,(r.inHeight+I-Z)/s),K=Z*b+$,J=0;J<d;++J)for(var H=Math.max(0,Math.ceil((U-J)/o)),ie=Math.min(r.outWidth,(r.inWidth+U-J)/o),ue=J*w+K,ce=0;ce<r.inChannels;++ce)for(var pe=ce*m+ue,ve=0;ve<r.outChannels;++ve){for(var De=0,Re=0;Re<r.batchSize;++Re)for(var we=Re*L,xe=Re*N,ne=q;ne<O;++ne)for(var Qe=(F+ne*i-z)*j+we,Je=ne*S+xe,Ae=P;Ae<W;++Ae)for(var Ge=(Z+Ae*s-I)*D+Qe,_e=Ae*T+Je,de=H;de<ie;++de){var ke=de*C+_e;De+=A[(J+de*o-U)*B+Ge+ce]*x[ke+ve]}p[pe+ve]=De}return h.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var a=n.input,r=n.filter,i=n.convInfo,s=n.bias,o=n.activation,u=n.preluActivationWeights,c=this.depthwiseConv2D(a,r,i);return s&&(c=this.add(c,s)),o&&(c=Sb(this,c,o,u)),c},t.prototype.depthwiseConv2D=function(n,a,r){Ve([n,a],"depthwiseConv2D");for(var i=r.filterHeight,s=r.filterWidth,o=r.dilationHeight,u=r.dilationWidth,c=r.padInfo.left,d=r.padInfo.top,h=r.outChannels/r.inChannels,p=Et(r.outShape,n.dtype),f=this.readSync(n.dataId),g=this.readSync(a.dataId),b=p.values,w=0;w<r.batchSize;++w)for(var m=w*n.strides[0],x=w*p.strides[0],y=0;y<r.outHeight;++y)for(var N=x+y*p.strides[1],S=y*r.strideHeight-c,T=0;T<i;++T){var C=S+T*o;if(!(C<0||C>=r.inHeight))for(var A=T*a.strides[0],R=m+C*n.strides[1],L=0;L<r.outWidth;++L)for(var j=N+L*p.strides[2],D=L*r.strideWidth-d,B=0;B<s;++B){var z=D+B*u;if(!(z<0||z>=r.inWidth))for(var U=A+B*a.strides[1],I=R+z*r.inChannels,F=j,q=U,O=0;O<r.inChannels;++O){for(var $=f[I+O],Z=0;Z<h;++Z)b[F+Z]+=$*g[q+Z];F+=h,q+=h}}}return p.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,a,r){Ve([n,a],"depthwiseConv2DDerInput");for(var i=Et(r.inShape,"float32"),s=i.values,o=i.strides,u=o[0],c=o[1],d=o[2],h=this.readSync(n.dataId),p=n.strides,f=p[0],g=p[1],b=p[2],w=this.readSync(a.dataId),m=a.strides,x=m[0],y=m[1],N=m[2],S=r.batchSize,T=r.filterHeight,C=r.filterWidth,A=r.inChannels,R=r.inHeight,L=r.inWidth,j=r.outChannels,D=r.outHeight,B=r.outWidth,z=r.strideHeight,U=r.strideWidth,I=T-1-r.padInfo.top,F=C-1-r.padInfo.left,q=j/A,O=0;O<S;++O)for(var $=0;$<A;++$)for(var Z=0;Z<R;++Z)for(var P=Z-I,W=Math.max(0,Math.ceil(P/z)),K=Math.min(D,(T+P)/z),J=0;J<L;++J){for(var H=J-F,ie=Math.max(0,Math.ceil(H/U)),ue=Math.min(B,(C+H)/U),ce=0,pe=W;pe<K;++pe)for(var ve=pe*z-P,De=ie;De<ue;++De)for(var Re=f*O+g*pe+b*De,we=x*(T-1-ve)+y*(C-1-(De*U-H))+N*$,xe=0;xe<q;++xe)ce+=h[Re+($*q+xe)]*w[we+xe];s[u*O+c*Z+d*J+$]=ce}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,a,r){Ve([n,a],"depthwiseConv2DDerFilter");for(var i=r.strideHeight,s=r.strideWidth,o=r.filterHeight,u=r.filterWidth,c=Et(r.filterShape,"float32"),d=r.padInfo.left,h=r.padInfo.top,p=r.outChannels/r.inChannels,f=this.bufferSync(n),g=this.bufferSync(a),b=0;b<o;++b)for(var w=Math.max(0,Math.ceil((h-b)/i)),m=Math.min(r.outHeight,(r.inHeight+h-b)/i),x=0;x<u;++x)for(var y=Math.max(0,Math.ceil((d-x)/s)),N=Math.min(r.outWidth,(r.inWidth+d-x)/s),S=0;S<r.outChannels;++S){for(var T=Math.trunc(S/p),C=S%p,A=0,R=0;R<r.batchSize;++R)for(var L=w;L<m;++L)for(var j=b+L*i-h,D=y;D<N;++D){var B=x+D*s-d;A+=f.get(R,j,B,T)*g.get(R,L,D,S)}c.set(A,b,x,T,C)}return c.toTensor()},t.prototype.tile=function(n,a){return Ve(n,"tile"),g6(this.bufferSync(n),a)},t.prototype.pad=function(n,a,r){Ve(n,"pad");var i=a.map(function(p,f){return p[0]+n.shape[f]+p[1]}),s=a.map(function(p){return p[0]}),o=this.bufferSync(n),u=Et(i,n.dtype);r!==0&&u.values.fill(r);for(var c=0;c<n.size;c++){var d=o.indexToLoc(c),h=d.map(function(p,f){return p+s[f]});u.set.apply(u,[o.get.apply(o,d)].concat(h))}return u.toTensor()},t.prototype.transpose=function(n,a){Ve(n,"transpose");for(var r=new Array(n.rank),i=0;i<r.length;i++)r[i]=n.shape[a[i]];var s=this.readSync(n.dataId),o=Et(r,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var c=u.indexToLoc(i),d=new Array(c.length),h=0;h<d.length;h++)d[h]=c[a[h]];var p=o.locToIndex(d);o.values[p]=s[i]}return o.toTensor()},t.prototype.gather=function(n,a,r){Ve([n,a],"gather");var i=n.shape.slice(),s=this.readSync(a.dataId);i[r]=s.length;for(var o=Et(i,n.dtype),u=this.bufferSync(n),c=0;c<o.size;++c){var d=o.indexToLoc(c),h=d.slice();h[r]=s[d[r]];var p=u.locToIndex(h);o.values[c]=u.values[p]}return o.toTensor()},t.prototype.batchToSpaceND=function(n,a,r){Ve([n],"batchToSpaceND");var i=a.reduce(function(h,p){return h*p}),s=p0(n.shape,a,i),o=m0(s.length,a.length),u=g0(n.shape,a,i),c=a6(r,a.length),d=r6(u,r,a.length);return n.reshape(s).transpose(o).reshape(u).slice(c,d)},t.prototype.spaceToBatchND=function(n,a,r){Ve([n],"spaceToBatchND");var i=a.reduce(function(p,f){return p*f}),s=[[0,0]];s.push.apply(s,r);for(var o=1+a.length;o<n.shape.length;++o)s.push([0,0]);var u=n.pad(s),c=p0(u.shape,a,i,!1),d=m0(c.length,a.length,!1),h=g0(u.shape,a,i,!1);return u.reshape(c).transpose(d).reshape(h)},t.prototype.pool=function(n,a,r){Ve(n,"pool");for(var i=a.strideHeight,s=a.strideWidth,o=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,h=a.padInfo.top,p=a.padInfo.left,f=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(n.dataId),b=Et(a.outShape,n.dtype),w=b.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],x=a.outShape[2]*a.outShape[3],y=a.outShape[3],N=0;N<a.batchSize;++N)for(var S=N*m,T=N*n.strides[0],C=0;C<a.inChannels;++C)for(var A=0;A<a.outHeight;++A)for(var R=A*i-h,L=Math.max(0,R),j=Math.min(a.inHeight,c+R),D=S+A*x,B=0;B<a.outWidth;++B){for(var z=B*s-p,U=Math.max(0,z),I=Math.min(a.inWidth,d+z),F=f,q=0,O=0,$=L;$<j;$+=o){for(var Z=T+$*n.strides[1],P=U;P<I;P+=u){var W=g[Z+P*n.strides[2]+C];r==="max"&&W>F?F=W:r==="avg"&&(q+=W,O++)}if(isNaN(F))break}w[D+B*y+C]=r==="avg"?q/O:F}return b.toTensor()},t.prototype.maxPool=function(n,a){return this.pool(n,a,"max")},t.prototype.maxPoolPositions=function(n,a){for(var r=Et(a.outShape,"int32"),i=a.strideHeight,s=a.strideWidth,o=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,h=a.padInfo.top,p=a.padInfo.left,f=this.bufferSync(n),g=0;g<a.batchSize;++g)for(var b=0;b<a.inChannels;++b)for(var w=0;w<a.outHeight;++w){for(var m=w*i-h,x=m;x<0;)x+=o;for(var y=Math.min(a.inHeight,c+m),N=0;N<a.outWidth;++N){for(var S=N*s-p,T=S;T<0;)T+=u;for(var C=Math.min(a.inWidth,d+S),A=Number.NEGATIVE_INFINITY,R=-1,L=x;L<y;L+=o)for(var j=L-m,D=T;D<C;D+=u){var B=D-S,z=f.get(g,L,D,b);z>A&&(A=z,R=j*d+B)}r.set(R,g,w,N,b)}}return r.toTensor()},t.prototype.maxPoolBackprop=function(n,a,r,i){Ve([a,r],"maxPoolBackprop");for(var s=this.maxPoolPositions(a,i),o=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterHeight,p=i.effectiveFilterWidth,f=p-1-i.padInfo.left,g=h-1-i.padInfo.top,b=Et(a.shape,"float32"),w=this.bufferSync(s),m=this.bufferSync(n),x=0;x<i.batchSize;++x)for(var y=0;y<i.inChannels;++y)for(var N=0;N<i.inHeight;++N)for(var S=0;S<i.inWidth;++S){for(var T=N-g,C=S-f,A=0,R=0;R<h;R+=c){var L=(T+R)/o;if(!(L<0||L>=i.outHeight||Math.floor(L)!==L))for(var j=0;j<p;j+=d){var D=(C+j)/u;if(!(D<0||D>=i.outWidth||Math.floor(D)!==D)){var B=h*p-1-w.get(x,L,D,y)===R*p+j?1:0;B!==0&&(A+=m.get(x,L,D,y)*B)}}}b.set(A,x,N,S,y)}return b.toTensor()},t.prototype.avgPoolBackprop=function(n,a,r){Ve([n,a],"avgPoolBackprop");for(var i=r.strideHeight,s=r.strideWidth,o=r.filterHeight,u=r.filterWidth,c=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=p-1-r.padInfo.left,g=h-1-r.padInfo.top,b=Et(a.shape,"float32"),w=1/(o*u),m=this.bufferSync(n),x=0;x<r.batchSize;++x)for(var y=0;y<r.inChannels;++y)for(var N=0;N<r.inHeight;++N)for(var S=0;S<r.inWidth;++S){for(var T=N-g,C=S-f,A=0,R=0;R<h;R+=c){var L=(T+R)/i;if(!(L<0||L>=r.outHeight||Math.floor(L)!==L))for(var j=0;j<p;j+=d){var D=(C+j)/s;D<0||D>=r.outWidth||Math.floor(D)!==D||(A+=m.get(x,L,D,y))}}b.set(A*w,x,N,S,y)}return b.toTensor()},t.prototype.pool3d=function(n,a,r){Ve(n,"pool3d");for(var i=a.strideDepth,s=a.strideHeight,o=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.front,b=a.padInfo.top,w=a.padInfo.left,m=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=this.readSync(n.dataId),y=Et(a.outShape,n.dtype),N=y.values,S=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],T=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],A=a.outShape[4],R=0;R<a.batchSize;++R)for(var L=R*S,j=R*n.strides[0],D=0;D<a.inChannels;++D)for(var B=0;B<a.outDepth;++B){for(var z=B*i-g,U=z;U<0;)U+=u;for(var I=Math.min(a.inDepth,h+z),F=L+B*T,q=0;q<a.outHeight;++q){for(var O=q*s-b,$=O;$<0;)$+=c;for(var Z=Math.min(a.inHeight,p+O),P=F+q*C,W=0;W<a.outWidth;++W){for(var K=W*o-w,J=K;J<0;)J+=d;for(var H=Math.min(a.inWidth,f+K),ie=P+W*A,ue=m,ce=0,pe=0,ve=U;ve<I;ve+=u){for(var De=j+ve*n.strides[1],Re=$;Re<Z;Re+=c){for(var we=De+Re*n.strides[2],xe=J;xe<H;xe+=d){var ne=x[we+xe*n.strides[3]+D];if(r==="max"&&ne>ue?ue=ne:r==="avg"&&(ce+=ne,pe++),isNaN(ue))break}if(isNaN(ue))break}if(isNaN(ue))break}N[ie+D]=r==="avg"?ce/pe:ue}}}return y.toTensor()},t.prototype.avgPool3d=function(n,a){return Ve(n,"avgPool3d"),this.pool3d(n,a,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,a,r){Ve([n,a],"avgPool3dBackprop");for(var i=r.strideDepth,s=r.strideHeight,o=r.strideWidth,u=r.filterDepth,c=r.filterHeight,d=r.filterWidth,h=r.dilationDepth,p=r.dilationHeight,f=r.dilationWidth,g=r.effectiveFilterDepth,b=r.effectiveFilterHeight,w=r.effectiveFilterWidth,m=g-1-r.padInfo.front,x=w-1-r.padInfo.left,y=b-1-r.padInfo.top,N=Et(a.shape,"float32"),S=1/(u*c*d),T=this.bufferSync(n),C=0;C<r.batchSize;++C)for(var A=0;A<r.inChannels;++A)for(var R=0;R<r.inDepth;++R)for(var L=0;L<r.inHeight;++L)for(var j=0;j<r.inWidth;++j){for(var D=R-m,B=L-y,z=j-x,U=0,I=0;I<g;I+=h){var F=(D+I)/i;if(!(F<0||F>=r.outDepth||Math.floor(F)!==F))for(var q=0;q<b;q+=p){var O=(B+q)/s;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var $=0;$<w;$+=f){var Z=(z+$)/o;Z<0||Z>=r.outWidth||Math.floor(Z)!==Z||(U+=T.get(C,F,O,Z,A))}}}N.set(U*S,C,R,L,j,A)}return N.toTensor()},t.prototype.maxPool3d=function(n,a){return Ve(n,"maxPool3d"),this.pool3d(n,a,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,a){for(var r=Et(a.outShape,"int32"),i=a.strideDepth,s=a.strideHeight,o=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.front,b=a.padInfo.top,w=a.padInfo.left,m=this.bufferSync(n),x=0;x<a.batchSize;++x)for(var y=0;y<a.inChannels;++y)for(var N=0;N<a.outDepth;++N){for(var S=N*i-g,T=S;T<0;)T+=u;for(var C=Math.min(a.inDepth,h+S),A=0;A<a.outHeight;++A){for(var R=A*s-b,L=R;L<0;)L+=c;for(var j=Math.min(a.inHeight,p+R),D=0;D<a.outWidth;++D){for(var B=D*o-w,z=B;z<0;)z+=d;for(var U=Math.min(a.inWidth,f+B),I=Number.NEGATIVE_INFINITY,F=-1,q=T;q<C;q+=u)for(var O=q-S,$=L;$<j;$+=c)for(var Z=$-R,P=z;P<U;P+=d){var W=P-B,K=m.get(x,q,$,P,y);K>=I&&(I=K,F=O*p*f+Z*p+W)}r.set(F,x,N,A,D,y)}}}return r.toTensor()},t.prototype.maxPool3dBackprop=function(n,a,r,i){Ve([a,r],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(a,i),o=i.strideDepth,u=i.strideHeight,c=i.strideWidth,d=i.dilationDepth,h=i.dilationHeight,p=i.dilationWidth,f=i.effectiveFilterDepth,g=i.effectiveFilterHeight,b=i.effectiveFilterWidth,w=f-1-i.padInfo.front,m=b-1-i.padInfo.left,x=g-1-i.padInfo.top,y=Et(a.shape,"float32"),N=this.bufferSync(s),S=this.bufferSync(n),T=0;T<i.batchSize;++T)for(var C=0;C<i.inChannels;++C)for(var A=0;A<i.inDepth;++A)for(var R=0;R<i.inHeight;++R)for(var L=0;L<i.inWidth;++L){for(var j=A-w,D=R-x,B=L-m,z=0,U=0;U<f;U+=d){var I=(j+U)/o;if(!(I<0||I>=i.outDepth||Math.floor(I)!==I))for(var F=0;F<g;F+=h){var q=(D+F)/u;if(!(q<0||q>=i.outHeight||Math.floor(q)!==q))for(var O=0;O<b;O+=p){var $=(B+O)/c;if(!($<0||$>=i.outWidth||Math.floor($)!==$)){var Z=f*g*b-1-N.get(T,I,q,$,C)===U*g*b+F*b+O?1:0;Z!==0&&(z+=S.get(T,I,q,$,C)*Z)}}}}y.set(z,T,A,R,L,C)}return y.toTensor()},t.prototype.cast=function(n,a){return h6(n,a,this)},t.prototype.reshape=function(n,a){return ly(n,a)},t.prototype.avgPool=function(n,a){return Ve(n,"avgPool"),this.pool(n,a,"avg").toFloat()},t.prototype.resizeBilinear=function(n,a,r,i){Ve(n,"resizeBilinear");for(var s=n.shape,o=s[0],u=s[1],c=s[2],d=s[3],h=this.readSync(n.dataId),p=new Float32Array(ht([o,a,r,d])),f=[i&&a>1?u-1:u,i&&r>1?c-1:c],g=[i&&a>1?a-1:a,i&&r>1?r-1:r],b=0,w=f[0]/g[0],m=f[1]/g[1],x=0;x<o;x++)for(var y=0;y<a;y++)for(var N=w*y,S=Math.floor(N),T=N-S,C=Math.min(u-1,Math.ceil(N)),A=x*n.strides[0]+S*n.strides[1],R=x*n.strides[0]+C*n.strides[1],L=0;L<r;L++)for(var j=m*L,D=Math.floor(j),B=j-D,z=Math.min(c-1,Math.ceil(j)),U=A+D*n.strides[2],I=R+D*n.strides[2],F=A+z*n.strides[2],q=R+z*n.strides[2],O=0;O<d;O++){var $=h[U+O],Z=h[I+O],P=$+(h[F+O]-$)*B,W=P+(Z+(h[q+O]-Z)*B-P)*T;p[b++]=W}return Fa(p,[o,a,r,d])},t.prototype.resizeBilinearBackprop=function(n,a,r){Ve([n,a],"resizeBilinearBackprop");for(var i=a.shape,s=i[0],o=i[1],u=i[2],c=i[3],d=n.shape,h=d[1],p=d[2],f=new Float32Array(s*o*u*c),g=[r&&h>1?o-1:o,r&&p>1?u-1:u],b=[r&&h>1?h-1:h,r&&p>1?p-1:p],w=g[0]/b[0],m=g[1]/b[1],x=this.readSync(n.dataId),y=0,N=0;N<s;N++)for(var S=N*a.strides[0],T=0;T<h;T++)for(var C=T*w,A=Math.floor(C),R=Math.min(Math.ceil(C),o-1),L=S+A*a.strides[1],j=S+R*a.strides[1],D=C-A,B=1-D,z=0;z<p;z++)for(var U=z*m,I=Math.floor(U),F=Math.min(Math.ceil(U),u-1),q=U-I,O=1-q,$=L+I*a.strides[2],Z=L+F*a.strides[2],P=j+I*a.strides[2],W=j+F*a.strides[2],K=B*O,J=B*q,H=D*O,ie=D*q,ue=0;ue<c;ue++){var ce=x[y++];f[$+ue]+=ce*K,f[Z+ue]+=ce*J,f[P+ue]+=ce*H,f[W+ue]+=ce*ie}return Sr(f,[s,u,o,c],a.dtype)},t.prototype.resizeNearestNeighbor=function(n,a,r,i){Ve(n,"resizeNearestNeighbor");for(var s=n.shape,o=s[0],u=s[1],c=s[2],d=s[3],h=this.readSync(n.dataId),p=new Float32Array(o*a*r*d),f=[i&&a>1?u-1:u,i&&r>1?c-1:c],g=[i&&a>1?a-1:a,i&&r>1?r-1:r],b=f[0]/g[0],w=f[1]/g[1],m=0,x=0;x<o;x++)for(var y=x*n.strides[0],N=0;N<a;N++)for(var S=b*N,T=y+Math.min(u-1,i?Math.round(S):Math.floor(S))*n.strides[1],C=0;C<r;C++)for(var A=w*C,R=T+Math.min(c-1,i?Math.round(A):Math.floor(A))*n.strides[2],L=0;L<d;L++){var j=h[R+L];p[m++]=j}return Fa(p,[o,a,r,d],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,a,r){Ve([n,a],"resizeNearestNeighborBackprop");for(var i=a.shape,s=i[0],o=i[1],u=i[2],c=i[3],d=n.shape,h=d[1],p=d[2],f=new Float32Array(s*o*u*c),g=this.readSync(n.dataId),b=[r&&h>1?o-1:o,r&&p>1?u-1:u],w=[r&&h>1?h-1:h,r&&p>1?p-1:p],m=b[0]/w[0],x=b[1]/w[1],y=1/m,N=1/x,S=2*Math.ceil(y)+2,T=2*Math.ceil(N)+2,C=0;C<s;C++)for(var A=C*a.strides[0],R=0;R<o;R++)for(var L=A+R*a.strides[1],j=Math.floor(R*y),D=Math.floor(j-S/2),B=0;B<u;B++)for(var z=L+B*a.strides[2],U=Math.floor(B*N),I=Math.floor(U-T/2),F=0;F<c;F++){for(var q=0,O=0;O<S;O++){var $=O+D;if(!($<0||$>=h)){var Z=A+$*n.strides[1],P=$*m;if(R===Math.min(o-1,r?Math.round(P):Math.floor(P)))for(var W=0;W<T;W++){var K=W+I;if(!(K<0||K>=p)){var J=Z+K*n.strides[2],H=K*x;B===Math.min(u-1,r?Math.round(H):Math.floor(H))&&(q+=g[J+F])}}}}f[z+F]=q}return Sr(f,a.shape,a.dtype)},t.prototype.batchNormalization=function(n,a,r,i,s,o){Ve([n,a,r,s,o],"batchNorm");for(var u=this.readSync(n.dataId),c=this.readSync(a.dataId),d=this.readSync(r.dataId),h=s?this.readSync(s.dataId):new Float32Array([1]),p=o?this.readSync(o.dataId):new Float32Array([0]),f=new Float32Array(u.length),g=p.length,b=h.length,w=d.length,m=c.length,x=0,y=0,N=0,S=0,T=0;T<u.length;++T)f[T]=p[x++]+(u[T]-c[y++])*h[N++]/Math.sqrt(d[S++]+i),x>=g&&(x=0),y>=m&&(y=0),N>=b&&(N=0),S>=w&&(S=0);return Sr(f,n.shape)},t.prototype.localResponseNormalization4D=function(n,a,r,i,s){Ve(n,"localResponseNormalization4D");var o=n.shape[3],u=o-1,c=this.readSync(n.dataId),d=n.size,h=new Float32Array(d);function p(w){for(var m=w%o,x=w-m+Math.max(0,m-a),y=w-m+Math.min(m+a,u),N=0;x<=y;x++){var S=c[x];N+=S*S}return N}for(var f=0;f<d;f++){var g=p(f),b=c[f]*Math.pow(r+i*g,-s);h[f]=b}return Sr(h,n.shape)},t.prototype.LRNGrad=function(n,a,r,i,s,o,u){Ve(n,"LRNGrad");for(var c=n.shape[3],d=this.readSync(n.dataId),h=this.readSync(a.dataId),p=this.readSync(r.dataId),f=new Float32Array(n.size),g=n.size,b=0;b<g;b++){for(var w=b%c,m=b-w+Math.max(0,w-i),x=b-w+Math.min(c,w+i+1),y=0,N=m;N<x;N++)y+=Math.pow(h[N],2);for(y=o*y+s,N=m;N<x;N++){var S=-2*o*u*h[N]*p[b]/y;b===N&&(S+=Math.pow(y,-u)),S*=d[b],f[N]+=S}}return Sr(f,n.shape)},t.prototype.multinomial=function(n,a,r,i){Ve(n,"multinomial");for(var s=a?n:_o(n),o=s.shape[0],u=s.shape[1],c=Nn([o,r],"int32"),d=this.readSync(c.dataId),h=this.readSync(s.dataId),p=0;p<o;++p){var f=p*u,g=new Float32Array(u-1);g[0]=h[f];for(var b=1;b<g.length;++b)g[b]=g[b-1]+h[f+b];for(var w=fv(i.toString()),m=p*r,x=0;x<r;++x){var y=w();d[m+x]=g.length;for(var N=0;N<g.length;N++)if(y<g[N]){d[m+x]=N;break}}}return c},t.prototype.oneHot=function(n,a,r,i){Ve(n,"oneHot");var s=new Float32Array(n.size*a);s.fill(i);for(var o=this.readSync(n.dataId),u=0;u<n.size;++u)o[u]>=0&&o[u]<a&&(s[u*a+o[u]]=r);return Sl(s,[n.size,a],"int32")},t.prototype.nonMaxSuppression=function(n,a,r,i,s){return Ve(n,"nonMaxSuppression"),ew(this.readSync(n.dataId),this.readSync(a.dataId),r,i,s)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,a){for(var r=n.shape[0],i=n.shape[1],s=Et(n.shape,"float32"),o=Et(n.shape,"float32"),u=wi(n).as2D(r,i),c=ys(n).as2D(r,i),d=0;d<r;d++)for(var h=u.slice([d,0],[1,i]),p=c.slice([d,0],[1,i]),f=Ia(h,p),g=this.readSync(this.fftImpl(f,a).dataId),b=0;b<i;b++){var w=y3(g,b);s.values[d*i+b]=w.real,o.values[d*i+b]=w.imag}return Ia(s.toTensor(),o.toTensor()).as2D(r,i)},t.prototype.fftImpl=function(n,a){var r=n.as1D(),i=r.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(r,i,a).as2D(n.shape[0],n.shape[1]);return a&&(s=Ia(wi(s).div(at(i)),ys(s).div(at(i)))),s}var o=this.readSync(n.dataId),u=function(c){for(var d=new Float32Array(c.length/2),h=new Float32Array(c.length/2),p=0;p<c.length;p+=2)d[p/2]=c[p],h[p/2]=c[p+1];return{real:d,imag:h}}(this.fourierTransformByMatmul(o,i,a));return Ia(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,a,r){if(a===1)return n;var i=this.readSync(n.dataId),s=a/2,o=function(m){for(var x=Math.ceil(m.length/4),y=new Float32Array(x),N=new Float32Array(x),S=0;S<m.length;S+=4)y[Math.floor(S/4)]=m[S],N[Math.floor(S/4)]=m[S+1];return{real:y,imag:N}}(i),u=Ia(o.real,o.imag).as1D(),c=function(m){for(var x=Math.floor(m.length/4),y=new Float32Array(x),N=new Float32Array(x),S=2;S<m.length;S+=4)y[Math.floor(S/4)]=m[S],N[Math.floor(S/4)]=m[S+1];return{real:y,imag:N}}(i),d=Ia(c.real,c.imag).as1D();u=this.fftRadix2(u,s,r),d=this.fftRadix2(d,s,r);var h=function(m,x){for(var y=new Float32Array(m/2),N=new Float32Array(m/2),S=0;S<Math.ceil(m/2);S++){var T=(x?2:-2)*Math.PI*(S/m);y[S]=Math.cos(T),N[S]=Math.sin(T)}return{real:y,imag:N}}(a,r),p=Ia(h.real,h.imag).mul(d),f=u.add(p),g=u.sub(p),b=wi(f).concat(wi(g)),w=ys(f).concat(ys(g));return Ia(b,w).as1D()},t.prototype.fourierTransformByMatmul=function(n,a,r){for(var i=new Float32Array(2*a),s=0;s<a;s++){for(var o=0,u=0,c=0;c<a;c++){var d=p7(s*c,a,r),h=y3(n,c);o+=h.real*d.real-h.imag*d.imag,u+=h.real*d.imag+h.imag*d.real}r&&(o/=a,u/=a),f7(i,o,u,s)}return i},t.prototype.depthToSpace=function(n,a,r){se(r==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+r}),se(a>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+a});for(var i=n.shape[0],s=n.shape[1],o=n.shape[2],u=n.shape[3],c=s*a,d=o*a,h=u/(a*a),p=this.readSync(n.dataId),f=new Float32Array(i*c*d*h),g=0,b=0;b<i;++b)for(var w=0;w<c;++w)for(var m=Math.floor(w/a),x=w%a,y=0;y<d;++y)for(var N=Math.floor(y/a),S=(x*a+y%a)*h,T=0;T<h;++T){var C=T+S+u*(N+o*(m+s*b));f[g++]=p[C]}return Sr(f,[i,c,d,h])},t.prototype.broadcastedBinaryOp=function(n,a,r,i){var s=zt(n.shape,a.shape),o=Et(s,r),u=this.readSync(n.dataId),c=this.readSync(a.dataId),d=hl(n.shape,s),h=hl(a.shape,s),p=o.values;if(d.length+h.length===0)for(var f=0;f<p.length;++f)p[f]=i(u[f%u.length],c[f%c.length]);else{var g=this.bufferSync(n),b=this.bufferSync(a),w=function(m){var x=o.indexToLoc(m),y=x.slice(-n.rank);d.forEach(function(C){return y[C]=0});var N=g.locToIndex(y),S=x.slice(-a.rank);h.forEach(function(C){return S[C]=0});var T=b.locToIndex(S);p[m]=i(u[N],c[T])};for(f=0;f<p.length;++f)w(f)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,a,r){var i=zt(n.shape,a.shape),s=Et(i,"float32"),o=Et(i,"float32"),u=this.readSync(n.dataId),c=this.readSync(a.dataId),d=hl(n.shape,i),h=hl(a.shape,i),p=s.values,f=o.values;if(d.length+h.length===0)for(var g=0;g<p.length;g++){var b=g%u.length,w=g%c.length,m=r(u[2*b],u[2*b+1],c[2*w],c[2*w+1]);p[g]=m.real,f[g]=m.imag}else{var x=this.bufferSync(this.data.get(n.dataId).complexTensors.real),y=this.bufferSync(this.data.get(a.dataId).complexTensors.real),N=function(S){var T=s.indexToLoc(S),C=T.slice(-n.rank);d.forEach(function(D){return C[D]=0});var A=x.locToIndex(C),R=T.slice(-a.rank);h.forEach(function(D){return R[D]=0});var L=y.locToIndex(R),j=r(u[2*A],u[2*A+1],c[2*L],c[2*L+1]);p[S]=j.real,f[S]=j.imag};for(g=0;g<p.length;g++)N(g)}return this.complex(s.toTensor(),o.toTensor())},t.prototype.split=function(n,a,r){return m6(n,a,r)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,a,r,i,s,o){for(var u=n.shape,c=u[0],d=u[1],h=u[2],p=u[3],f=a.shape[0],g=i[0],b=i[1],w=Et([f,g,b,p],"float32"),m=this.readSync(a.dataId),x=this.readSync(r.dataId),y=this.readSync(n.dataId),N=n.strides,S=w.strides,T=0;T<f;T++){var C=4*T,A=m[C],R=m[C+1],L=m[C+2],j=m[C+3],D=x[T];if(!(D>=c))for(var B=g>1?(L-A)*(d-1)/(g-1):0,z=b>1?(j-R)*(h-1)/(b-1):0,U=0;U<g;U++){var I=g>1?A*(d-1)+U*B:.5*(A+L)*(d-1);if(I<0||I>d-1)for(var F=0;F<b;F++)for(var q=0;q<p;q++){var O=q+F*S[2]+U*S[1]+T*S[0];w.values[O]=o}else if(s==="bilinear"){var $=Math.floor(I),Z=Math.ceil(I),P=I-$;for(F=0;F<b;F++)if((ve=b>1?R*(h-1)+F*z:.5*(R+j)*(h-1))<0||ve>h-1)for(q=0;q<p;q++)O=q+F*S[2]+U*S[1]+T*S[0],w.values[O]=o;else{var W=Math.floor(ve),K=Math.ceil(ve),J=ve-W;for(q=0;q<p;q++){var H=y[O=q+W*N[2]+$*N[1]+D*N[0]],ie=y[O=q+K*N[2]+$*N[1]+D*N[0]],ue=y[O=q+W*N[2]+Z*N[1]+D*N[0]],ce=H+(ie-H)*J,pe=ue+(y[O=q+K*N[2]+Z*N[1]+D*N[0]]-ue)*J;O=q+F*S[2]+U*S[1]+T*S[0],w.values[O]=ce+(pe-ce)*P}}}else for(F=0;F<b;++F){var ve;if((ve=b>1?R*(h-1)+F*z:.5*(R+j)*(h-1))<0||ve>h-1)for(q=0;q<p;q++)O=q+F*S[2]+U*S[1]+T*S[0],w.values[O]=o;else{var De=Math.round(ve),Re=Math.round(I);for(q=0;q<p;q++){var we=q+De*N[2]+Re*N[1]+D*N[0],xe=q+F*S[2]+U*S[1]+T*S[0];w.values[xe]=y[we]}}}}}return w.toTensor()},t.prototype.sparseToDense=function(n,a,r,i){var s=v0(0,n,r),o=s.sliceRank,u=s.numUpdates,c=s.sliceSize,d=s.strides,h=s.outputSize;return this.scatter(n,a,r,h,c,u,o,d,i,!1)},t.prototype.gatherND=function(n,a){var r=a.shape,i=r[r.length-1],s=i6(n,a),o=s[0],u=s[1],c=s[2],d=s[3];if(u===0)return Fa([],o,n.dtype);for(var h=new Bf([u,c],n.dtype),p=this.readSync(a.dataId),f=this.readSync(n.dataId),g=0;g<u;g++){for(var b=[],w=0,m=0;m<i;m++){var x=p[g*i+m];w+=x*d[m],b.push(x)}if(w<0||w>=n.size/c)throw new Error("Invalid indices: "+b+" does not index into "+n.shape);for(var y=0;y<c;y++)h.values[g*c+y]=f[w*c+y]}return h.toTensor().reshape(o)},t.prototype.scatterND=function(n,a,r){var i=v0(0,n,r),s=i.sliceRank,o=i.numUpdates,u=i.sliceSize,c=i.strides,d=i.outputSize,h=at(0);return this.scatter(n,a,r,d,u,o,s,c,h,!0)},t.prototype.fill=function(n,a,r){var i=o0(r=r||bp(a),ht(n));return i.fill(a),be.makeTensor(i,n,r,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var a=o0(n.dtype,ht(n.shape));return this.makeOutput(a,n.shape,n.dtype)},t.prototype.linspace=function(n,a,r){return f6(n,a,r)},t.prototype.scatter=function(n,a,r,i,s,o,u,c,d,h){var p=[i/s,s],f=this.readSync(n.dataId),g=this.readSync(a.dataId);if(i===0)return Fa([],r,a.dtype);var b=new Bf(p,a.dtype);b.values.fill(this.readSync(d.dataId)[0]);for(var w=0;w<o;w++){for(var m=[],x=0,y=0;y<u;y++){var N=f[w*u+y];m.push(N),x+=N*c[y]}if(x<0||x>=i/s)throw new Error("Invalid indices: "+m+" does not index into "+r);for(var S=0;S<s;S++)h?b.values[x*s+S]+=g[w*s+S]:b.values[x*s+S]=a.rank===0?g[0]:g[w*s+S]}return b.toTensor().reshape(r)},t}(c6);be.registerBackend("cpu",function(){return new PB},1);for(var _b=0,q3=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs,r=t,i=r.boxes,s=r.scores,o=a,u=o.maxOutputSize,c=o.iouThreshold,d=o.scoreThreshold,h=o.softNmsSigma,p=n;Ve(i,"NonMaxSuppressionWithScore");var f=tw(p.data.get(i.dataId).values,p.data.get(s.dataId).values,u,c,d,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t.x,r=n;Ve(a,"square");for(var i=r.data.get(a.dataId).values,s=new Float32Array(i.length),o=0;o<i.length;++o){var u=i[o];s[o]=u*u}return{dataId:r.write(s,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},{kernelName:qf,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t,r=a.a,i=a.b,s=n;Ve([r,i],qf);var o=s.data.get(r.dataId).values,u=s.data.get(i.dataId).values,c=function(p,f,g,b,w,m){var x=zt(p,f),y=x.length,N=Ds(x),S=Ff(w,ht(x)),T=p.length,C=f.length,A=Ds(p),R=Ds(f),L=hl(p,x),j=hl(f,x);if(L.length+j.length===0)for(var D=0;D<S.length;++D)S[D]=m(g[D%g.length],b[D%b.length]);else{var B=function(z){var U=W8(z,y,N),I=U.slice(-T);L.forEach(function($){return I[$]=0});var F=d3(I,T,A),q=U.slice(-C);j.forEach(function($){return q[$]=0});var O=d3(q,C,R);S[z]=m(g[F],b[O])};for(D=0;D<S.length;++D)B(D)}return[S,x]}(r.shape,i.shape,o,u,r.dtype,function(p,f){var g=p-f;return g*g}),d=c[0],h=c[1];return{dataId:s.write(d,h,r.dtype),shape:h,dtype:r.dtype}}}];_b<q3.length;_b++)Fj(q3[_b]);var Ec,MB=function(e){this.variableNames=["A"];var t=Xa(),n=e[0],a=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+a+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},IB=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Xa(),n=e[0],a=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+a+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var jb=0,H3=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs,r=t.pixels,i=a.numChannels,s=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,u=s?[r.videoWidth,r.videoHeight]:[r.width,r.height],c=u[0],d=u[1],h=[d,c],p=[d,c,i];(o||s)&&(Ec==null&&(Ec=document.createElement("canvas").getContext("2d")),Ec.canvas.width=c,Ec.canvas.height=d,Ec.drawImage(r,0,0,c,d),r=Ec.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=Gr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),r);var g=Oe().getBool("WEBGL_PACK")?new IB(p):new MB(p),b=n.runWebGLProgram(g,[f],"int32");return n.disposeData(f.dataId),b}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs;d0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var r=t,i=r.boxes,s=r.scores,o=a,u=o.maxOutputSize,c=o.iouThreshold,d=o.scoreThreshold,h=o.softNmsSigma,p=n,f=tw(p.readSync(i.dataId),p.readSync(s.dataId),u,c,d,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t.x,r=n,i=new Pt(a.shape,"return x * x;");return r.runWebGLProgram(i,[a],a.dtype)}},{kernelName:qf,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t,r=a.a,i=a.b,s=n,o=Oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro("return (a - b) * (a - b);",r.shape,i.shape):new Bn("return (a - b) * (a - b);",r.shape,i.shape);return s.compileAndRun(o,[r,i])}}];jb<H3.length;jb++)Fj(H3[jb]);for(var Cb=0,W3=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:qf,gradFunc:function(e,t){var n=t[0],a=t[1],r=at(2);return{a:function(){return tr(e,tr(r,xa(n,a)))},b:function(){return tr(e,tr(r,xa(a,n)))}}}}];Cb<W3.length;Cb++)L8(W3[Cb]);var OB=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();Oe().get("IS_BROWSER")&&Oe().setPlatform("browser",new OB);var Ab,FB=function(){return require("node-fetch")},BB=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return Oe().global.fetch!=null?Oe().global.fetch(t,n):(Ab==null&&(Ab=FB()),Ab(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();Oe().get("IS_NODE")&&Oe().setPlatform("node",new BB);var dy={float32:4,int32:4,uint16:2,uint8:1,bool:1},S0=4;function oC(e,t){for(var n={},a=0,r=function(o){var u=o.name,c=o.dtype,d=o.shape,h=ht(d),p=void 0;if("quantization"in o){var f=o.quantization;if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error("Weight "+o.name+" has unknown quantization dtype "+f.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var g=dy[f.dtype],b=e.slice(a,a+h*g),w=f.dtype==="uint8"?new Uint8Array(b):new Uint16Array(b);if(c==="float32")p=Float32Array.from(w,function(T){return T*f.scale+f.min});else{if(c!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+c);p=Int32Array.from(w,function(T){return Math.round(T*f.scale+f.min)})}a+=h*g}else if(c==="string"){var m=ht(o.shape);p=[];for(var x=0;x<m;x++){var y=new Uint32Array(e.slice(a,a+S0))[0];a+=S0;var N=new Uint8Array(e.slice(a,a+y));p.push(N),a+=y}}else{var S=dy[c];if(b=e.slice(a,a+h*S),c==="float32")p=new Float32Array(b);else if(c==="int32")p=new Int32Array(b);else{if(c!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+c);p=new Uint8Array(b)}a+=h*S}n[u]=Fa(p,d,c)},i=0,s=t;i<s.length;i++)r(s[i]);return n}function zB(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var a=new Uint8Array(t),r=0;return n.forEach(function(i){a.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),a.buffer}var hy=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function G3(e){return hy?Buffer.byteLength(e):new Blob([e]).size}function yw(e){var t=0;e.forEach(function(r){t+=r.byteLength});var n=new Uint8Array(t),a=0;return e.forEach(function(r){n.set(new Uint8Array(r),a),a+=r.byteLength}),n.buffer}function V3(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function jp(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:G3(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:G3(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Vr=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,a){var r=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var s=i(t,a);s!==null&&r.push(s)}),r},e}(),vd="://",_l=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){se(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(vd)&&(t=t.slice(0,t.indexOf(vd))),se(t.length>0,function(){return"scheme must not be an empty string."});var a=e.getInstance();se(a.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),a.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function mg(e){if(e.indexOf(vd)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+_l.getSchemes().join(","));return{scheme:e.split(vd)[0],path:e.split(vd)[1]}}function K3(e,t,n){return n===void 0&&(n=!1),lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h;return ut(this,function(p){switch(p.label){case 0:return se(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),se((a=Vr.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),se(a.length<2,function(){return"Copying failed because more than one ("+a.length+") load handlers for source URL "+e+"."}),r=a[0],se((i=Vr.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),se(i.length<2,function(){return"Copying failed because more than one ("+a.length+") save handlers for destination URL "+t+"."}),s=i[0],o=mg(e).scheme,u=mg(e).path,c=o===mg(e).scheme,[4,r.load()];case 1:return d=p.sent(),n&&c?[4,_l.getManager(o).removeModel(u)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,s.save(d)];case 4:return h=p.sent(),!n||c?[3,6]:[4,_l.getManager(o).removeModel(u)];case 5:p.sent(),p.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var fu="models_store",fl="model_info_store";function lC(){if(!Oe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function fy(e){var t=e.result;t.createObjectStore(fu,{keyPath:"modelPath"}),t.createObjectStore(fl,{keyPath:"modelPath"})}var xd=function(){function e(t){if(this.indexedDB=lC(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){return ut(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return lt(this,void 0,void 0,function(){return ut(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var a=this;return new Promise(function(r,i){var s=a.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return fy(s)},s.onsuccess=function(){var o=s.result;if(n==null){var u=o.transaction(fu,"readonly"),c=u.objectStore(fu).get(a.modelPath);c.onsuccess=function(){if(c.result==null)return o.close(),i(new Error("Cannot find model with path '"+a.modelPath+"' in IndexedDB."));r(c.result.modelArtifacts)},c.onerror=function(b){return o.close(),i(c.error)},u.oncomplete=function(){return o.close()}}else{var d,h=jp(n),p=o.transaction(fl,"readwrite"),f=p.objectStore(fl),g=f.put({modelPath:a.modelPath,modelArtifactsInfo:h});g.onsuccess=function(){var b=(d=o.transaction(fu,"readwrite")).objectStore(fu).put({modelPath:a.modelPath,modelArtifacts:n,modelArtifactsInfo:h});b.onsuccess=function(){return r({modelArtifactsInfo:h})},b.onerror=function(w){var m=(f=p.objectStore(fl)).delete(a.modelPath);m.onsuccess=function(){return o.close(),i(b.error)},m.onerror=function(x){return o.close(),i(b.error)}}},g.onerror=function(b){return o.close(),i(g.error)},p.oncomplete=function(){d==null?o.close():d.oncomplete=function(){return o.close()}}}},s.onerror=function(o){return i(s.error)}})},e.URL_SCHEME="indexeddb://",e}(),$3=function(e){return Oe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(xd.URL_SCHEME)?(t=e.slice(xd.URL_SCHEME.length),new xd(t)):null;var t};Vr.registerSaveRouter($3),Vr.registerLoadRouter($3);var UB=function(){function e(){this.indexedDB=lC()}return e.prototype.listModels=function(){return lt(this,void 0,void 0,function(){var t=this;return ut(this,function(n){return[2,new Promise(function(a,r){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return fy(i)},i.onsuccess=function(){var s=i.result,o=s.transaction(fl,"readonly"),u=o.objectStore(fl).getAll();u.onsuccess=function(){for(var c={},d=0,h=u.result;d<h.length;d++){var p=h[d];c[p.modelPath]=p.modelArtifactsInfo}a(c)},u.onerror=function(c){return s.close(),r(u.error)},o.oncomplete=function(){return s.close()}},i.onerror=function(s){return r(i.error)}})]})})},e.prototype.removeModel=function(t){return lt(this,void 0,void 0,function(){var n=this;return ut(this,function(a){var r;return t=(r=t).startsWith(xd.URL_SCHEME)?r.slice(xd.URL_SCHEME.length):r,[2,new Promise(function(i,s){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return fy(o)},o.onsuccess=function(){var u,c=o.result,d=c.transaction(fl,"readwrite"),h=d.objectStore(fl),p=h.get(t);p.onsuccess=function(){if(p.result==null)return c.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var f=h.delete(t),g=function(){var b=(u=c.transaction(fu,"readwrite")).objectStore(fu).delete(t);b.onsuccess=function(){return i(p.result.modelArtifactsInfo)},b.onerror=function(w){return s(p.error)}};f.onsuccess=g,f.onerror=function(b){return g(),c.close(),s(p.error)}},p.onerror=function(f){return c.close(),s(p.error)},d.oncomplete=function(){u==null?c.close():u.oncomplete=function(){return c.close()}}},o.onerror=function(u){return s(o.error)}})]})})},e}();if(Oe().getBool("IS_BROWSER"))try{_l.registerManager(xd.URL_SCHEME,new UB)}catch{}var oo="/",Uc="tensorflowjs_models",uC="info",qB="model_topology",HB="weight_specs",WB="weight_data",GB="model_metadata";function cC(e){return{info:[Uc,e,uC].join(oo),topology:[Uc,e,qB].join(oo),weightSpecs:[Uc,e,HB].join(oo),weightData:[Uc,e,WB].join(oo),modelMetadata:[Uc,e,GB].join(oo)}}function VB(e){var t=e.split(oo);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(oo)}var bd=function(){function e(t){if(!Oe().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=cC(this.modelPath)}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){var n,a,r;return ut(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),a=JSON.stringify(t.weightSpecs),r=jp(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,a),this.LS.setItem(this.keys.weightData,function(s){if(hy)return Buffer.from(s).toString("base64");for(var o=new Uint8Array(s),u="",c=0,d=o.length;c<d;c++)u+=String.fromCharCode(o[c]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return lt(this,void 0,void 0,function(){var t,n,a,r,i,s,o;return ut(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(a=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=a,(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=r,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(i),n.format=s.format,n.generatedBy=s.generatedBy,n.convertedBy=s.convertedBy,n.userDefinedMetadata=s.userDefinedMetadata),(o=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(c){if(hy){var d=Buffer.from(c,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var h=atob(c),p=new Uint8Array(h.length),f=0;f<h.length;++f)p.set([h.charCodeAt(f)],f);return p.buffer}(o),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),Y3=function(e){return Oe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(bd.URL_SCHEME)?(t=e.slice(bd.URL_SCHEME.length),new bd(t)):null;var t};Vr.registerSaveRouter(Y3),Vr.registerLoadRouter(Y3);var KB=function(){function e(){se(Oe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),se(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return lt(this,void 0,void 0,function(){var t,n,a,r,i,s;return ut(this,function(o){for(t={},n=Uc+oo,a=oo+uC,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(n)&&i.endsWith(a)&&(s=VB(i),t[s]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return lt(this,void 0,void 0,function(){var n,a;return ut(this,function(r){var i;if(t=(i=t).startsWith(bd.URL_SCHEME)?i.slice(bd.URL_SCHEME.length):i,n=cC(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return a=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,a]})})},e}();if(Oe().getBool("IS_BROWSER"))try{_l.registerManager(bd.URL_SCHEME,new KB)}catch{}var $B="model",YB=".json",XB=".weights.bin";function X3(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var Eb=function(){function e(t){if(!Oe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=$B),this.modelTopologyFileName=t+YB,this.weightDataFileName=t+XB}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o;return ut(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:a},i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=i,[4,X3(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=n,[4,X3(function(){return o.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:jp(t)}]}})})},e.URL_SCHEME="downloads://",e}(),JB=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return lt(this,void 0,void 0,function(){var t,n,a=this;return ut(this,function(r){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,s){var o=new FileReader;o.onload=function(u){var c=JSON.parse(u.target.result),d=c.modelTopology;if(d!=null){n.length===0&&i({modelTopology:d});var h=c.weightsManifest;if(h!=null){var p;try{p=a.checkManifestAndWeightFiles(h,n)}catch(w){return void s(w)}var f=[],g=[],b=[];h.forEach(function(w){w.paths.forEach(function(m){g.push(m),b.push(null)}),f.push.apply(f,w.weights)}),h.forEach(function(w){w.paths.forEach(function(m){var x=new FileReader;x.onload=function(y){var N=y.target.result,S=g.indexOf(m);b[S]=N,b.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:f,weightData:yw(b),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},x.onerror=function(y){return s("Failed to weights data from file of path '"+m+"'.")},x.readAsArrayBuffer(p[m])})})}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(u){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var a=[],r=n.map(function(u){return V3(u.name)}),i={},s=0,o=t;s<o.length;s++)o[s].paths.forEach(function(u){var c=V3(u);if(a.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(a.push(c),r.indexOf(c)===-1)throw new Error("Weight file with basename '"+c+"' is not provided.");i[u]=n[r.indexOf(c)]});if(a.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+a.length+") and the number of weight files provided ("+n.length+").");return i},e}();function J3(e,t,n,a){(function(i){se(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,s){se(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),se(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),se(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})}(n=n??0,a=a??1);var r=0;return Promise.all(e.map(function(i){return i.then(function(s){var o=n+ ++r/e.length*(a-n);return t(o),s}),i}))}function dC(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d;return ut(this,function(h){switch(h.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?Oe().platform.fetch:t.fetchFunc,a=e.map(function(p){return n(p,t.requestInit,{isBinary:!0})}),r=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(a)];case 1:return s=h.sent(),[3,4];case 2:return[4,J3(a,t.onProgress,r,i)];case 3:s=h.sent(),h.label=4;case 4:return o=s.map(function(p){return p.arrayBuffer()}),u=.5,c=1,t.onProgress!=null?[3,6]:[4,Promise.all(o)];case 5:return d=h.sent(),[3,8];case 6:return[4,J3(o,t.onProgress,u,c)];case 7:d=h.sent(),h.label=8;case 8:return[2,d]}})})}function Q3(e){var t=this;return function(n,a,r){return a===void 0&&(a=""),lt(t,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g;return ut(this,function(b){switch(b.label){case 0:if(i=n.map(function(){return!1}),s={},o=r!=null?r.map(function(){return!1}):[],u=[],n.forEach(function(w,m){var x=0;w.weights.forEach(function(y){var N="quantization"in y?y.quantization.dtype:y.dtype,S=dy[N]*ht(y.shape),T=function(){i[m]=!0,s[m]==null&&(s[m]=[]),s[m].push({manifestEntry:y,groupOffset:x,sizeBytes:S})};r!=null?r.forEach(function(C,A){C===y.name&&(T(),o[A]=!0)}):T(),u.push(y.name),x+=S})}),!o.every(function(w){return w}))throw c=r.filter(function(w,m){return!o[m]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return d=i.reduce(function(w,m,x){return m&&w.push(x),w},[]),h=[],d.forEach(function(w){n[w].paths.forEach(function(m){var x=a+(a.endsWith("/")?"":"/")+m;h.push(x)})}),[4,e(h)];case 1:return p=b.sent(),f={},g=0,d.forEach(function(w){for(var m=n[w].paths.length,x=0,y=0;y<m;y++)x+=p[g+y].byteLength;for(var N=new ArrayBuffer(x),S=new Uint8Array(N),T=0,C=0;C<m;C++){var A=new Uint8Array(p[g+C]);S.set(A,T),T+=A.byteLength}s[w].forEach(function(R){var L=oC(N.slice(R.groupOffset,R.groupOffset+R.sizeBytes),[R.manifestEntry]);for(var j in L)f[j]=L[j]}),g+=m}),[2,f]}})})}}Vr.registerSaveRouter(function(e){return Oe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Eb.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Eb(t)}(e.slice(Eb.URL_SCHEME.length)):null});var hC=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(se(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=Oe().platform.fetch,se(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&se(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){var n,a,r,i;return ut(this,function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,a=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:a},n.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:jp(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return lt(this,void 0,void 0,function(){var t,n,a,r,i,s,o,u,c,d,h,p;return ut(this,function(f){switch(f.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=f.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,t.json()];case 3:return n=f.sent(),[3,5];case 4:throw f.sent(),a="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a);case 5:if(r=n.modelTopology,i=n.weightsManifest,s=n.generatedBy,o=n.convertedBy,u=n.format,c=n.userDefinedMetadata,r==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:p=f.sent(),d=p[0],h=p[1],f.label=7;case 7:return[2,{modelTopology:r,weightSpecs:d,weightData:h,userDefinedMetadata:c,generatedBy:s,convertedBy:o,format:u}]}})})},e.prototype.loadWeights=function(t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h,p;return ut(this,function(f){switch(f.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,a=function(g){var b=g.lastIndexOf("/"),w=g.lastIndexOf("?"),m=g.substring(0,b),x=w>b?g.substring(w):"";return[m+"/",x]}(n),r=a[0],i=a[1],s=this.weightPathPrefix||r,o=[],u=0,c=t;u<c.length;u++)d=c[u],o.push.apply(o,d.weights);return h=[],t.forEach(function(g){g.paths.forEach(function(b){h.push(s+b+i)})}),[4,dC(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=f.sent(),[2,[o,yw(p)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function py(e){return e.match(hC.URL_SCHEME_REGEX)!=null}var Z3=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return py(n)}):py(e))?my(e,{onProgress:t}):null};function my(e,t){return new hC(e,t)}Vr.registerSaveRouter(Z3),Vr.registerLoadRouter(Z3);var Db=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return lt(this,void 0,void 0,function(){return ut(this,function(t){return[2,this.modelArtifacts]})})},e}(),QB=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){return ut(this,function(n){return[2,this.saveHandler(t)]})})},e}(),fC=Object.freeze({browserFiles:function(e){return new JB(e)},browserHTTPRequest:function(e,t){return my(e,t)},concatenateArrayBuffers:yw,decodeWeights:oC,encodeWeights:function(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o=this;return ut(this,function(u){switch(u.label){case 0:for(n=[],a=[],r=Array.isArray(e)?e.map(function(c){return c.name}):Object.keys(e),i=function(c){var d=r[c],h=Array.isArray(e)?e[c].tensor:e[d];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+h.dtype);var p={name:d,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var f=new Promise(function(g){return lt(o,void 0,void 0,function(){var b,w,m,x,y,N,S;return ut(this,function(T){switch(T.label){case 0:return[4,h.bytes()];case 1:for(b=T.sent(),w=b.reduce(function(C,A){return C+A.length},0)+S0*b.length,m=new Uint8Array(w),x=0,y=0;y<b.length;y++)N=b[y],S=new Uint8Array(new Uint32Array([N.length]).buffer),m.set(S,x),x+=S0,m.set(N,x),x+=N.length;return g(m),[2]}})})});a.push(f)}else a.push(h.data());t!=null&&(p.group=t),n.push(p)},s=0;s<r.length;++s)i(s);return[4,Promise.all(a)];case 1:return[2,{data:zB(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,a){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new Db(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Db({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Db({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a}))},getLoadHandlers:function(e,t){return Vr.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:jp,getSaveHandlers:function(e){return Vr.getSaveHandlers(e)},http:my,isHTTPScheme:py,loadWeights:function(e,t,n,a){return t===void 0&&(t=""),lt(this,void 0,void 0,function(){return ut(this,function(r){return[2,Q3(function(i){return dC(i,{requestInit:a})})(e,t,n)]})})},registerLoadRouter:function(e){return Vr.registerLoadRouter(e)},registerSaveRouter:function(e){return Vr.registerSaveRouter(e)},weightsLoaderFactory:Q3,withSaveHandler:function(e){return new QB(e)},copyModel:function(e,t){return lt(this,void 0,void 0,function(){return ut(this,function(n){return[2,K3(e,t,!1)]})})},listModels:function(){return lt(this,void 0,void 0,function(){var e,t,n,a,r,i,s;return ut(this,function(o){switch(o.label){case 0:e=_l.getSchemes(),t={},n=0,a=e,o.label=1;case 1:return n<a.length?(r=a[n],[4,_l.getManager(r).listModels()]):[3,4];case 2:for(s in i=o.sent())t[r+vd+s]=i[s];o.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return lt(this,void 0,void 0,function(){return ut(this,function(n){return[2,K3(e,t,!0)]})})},removeModel:function(e){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){return t=mg(e),[2,_l.getManager(t.scheme).removeModel(t.path)]})})}}),Dc;he({confusionMatrix_:function(e,t,n){var a=te(e,"labels","confusionMatrix"),r=te(t,"predictions","confusionMatrix");se(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),se(a.rank===1,function(){return"Expected the rank of labels to be 1, but got "+a.rank}),se(r.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+r.rank}),se(a.shape[0]===r.shape[0],function(){return"Mismatch in the number of examples: "+a.shape[0]+" vs. "+r.shape[0]+". Labels and predictions should have the same number of elements."}),se(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=sy(a.asType("int32"),n),s=sy(r.asType("int32"),n);return i.transpose().matMul(s).asType("int32")}});var ZB=he({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,a=!1,r=!1,i=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)a=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);s=!0}if(r&&r&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(Oj("FromPixels",be.backendName)!=null)return be.runKernel("FromPixels",{pixels:e},{numChannels:t});var o,u,c=r?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=c[0],h=c[1];if(s?o=e.getContext("2d").getImageData(0,0,d,h).data:a||n?o=e.data:(i||r)&&(Dc==null&&(Dc=document.createElement("canvas").getContext("2d")),Dc.canvas.width=d,Dc.canvas.height=h,Dc.drawImage(e,0,0,d,h),o=Dc.getImageData(0,0,d,h).data),t===4)u=new Int32Array(o);else{var p=d*h;u=new Int32Array(p*t);for(var f=0;f<p;f++)for(var g=0;g<t;++g)u[f*t+g]=o[4*f+g]}return Y2(u,[h,d,t],"int32")}}),ww=Object.freeze({toPixels:function(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,T,C,A;return ut(this,function(R){switch(R.label){case 0:if(n=te(e,"img","toPixels"),e instanceof Dn||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(a=n.shape.slice(0,2),r=a[0],i=a[1],(s=n.rank===2?1:n.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return o=R.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(d=R.sent(),h=d[0],p=d[1],f=h[0],g=p[0],u.dispose(),c.dispose(),n.dtype==="float32"){if(f<0||g>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+g+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||g>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+g+"].")}for(b=n.dtype==="float32"?255:1,w=new Uint8ClampedArray(i*r*4),m=0;m<r*i;++m)x=void 0,y=void 0,N=void 0,S=void 0,s===1?(x=o[m]*b,y=o[m]*b,N=o[m]*b,S=255):s===3?(x=o[3*m]*b,y=o[3*m+1]*b,N=o[3*m+2]*b,S=255):s===4&&(x=o[4*m]*b,y=o[4*m+1]*b,N=o[4*m+2]*b,S=o[4*m+3]*b),w[(T=4*m)+0]=Math.round(x),w[T+1]=Math.round(y),w[T+2]=Math.round(N),w[T+3]=Math.round(S);return t!=null&&(t.width=i,t.height=r,C=t.getContext("2d"),A=new ImageData(w,i,r),C.putImageData(A,0,0)),n!==e&&n.dispose(),[2,w]}})})},fromPixels:ZB}),e9=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),t9=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Ku(e){se(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),se(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),se(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),t9.register(e)}var $u=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Qi(t,e),t.prototype.minimize=function(n,a,r){a===void 0&&(a=!1);var i=this.computeGradients(n,r),s=i.value,o=i.grads;if(r!=null){var u=r.map(function(c){return{name:c.name,tensor:o[c.name]}});this.applyGradients(u)}else this.applyGradients(o);return Cr(o),a?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,a){return d7(n,a)},t.prototype.dispose=function(){this.iterations_!=null&&Cr(this.iterations_)},t.prototype.saveIterations=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:at(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){switch(r.label){case 0:return a=this,[4,n[0].tensor.data()];case 1:return a.iterations_=r.sent()[0],[2,n.slice(1)]}})})},t}(e9);Object.defineProperty($u,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var n9=function(e){function t(n,a,r){r===void 0&&(r=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=a,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],r==null&&(i.epsilon=be.backend.epsilon()),i}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=be.registeredVariables[r];a.accumulatedGrads[i]==null&&(a.accumulatedGrads[i]={originalName:r+"/accum_grad",variable:st(function(){return Wt(s).variable(!1)})}),a.accumulatedUpdates[i]==null&&(a.accumulatedUpdates[i]={originalName:r+"/accum_var",variable:st(function(){return Wt(s).variable(!1)})});var o=Array.isArray(n)?n[i].tensor:n[r];if(o!=null){var u=a.accumulatedGrads[i].variable,c=a.accumulatedUpdates[i].variable;st(function(){var d=u.mul(a.rho).add(o.square().mul(1-a.rho)),h=c.add(a.epsilon).sqrt().div(u.add(a.epsilon).sqrt()).mul(o),p=c.mul(a.rho).add(h.square().mul(1-a.rho));u.assign(d),c.assign(p);var f=h.mul(-a.learningRate).add(s);s.assign(f)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Cr(this.accumulatedGrads.map(function(n){return n.variable})),Cr(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){var n;return ut(this,function(a){switch(a.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(n.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),a=n.length/2,this.accumulatedGrads=n.slice(0,a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(a,2*a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,a){return new n(a.learningRate,a.rho,a.epsilon)},t.className="Adadelta",t}($u);Ku(n9);var a9=function(e){function t(n,a){a===void 0&&(a=.1);var r=e.call(this)||this;return r.learningRate=n,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=be.registeredVariables[r];a.accumulatedGrads[i]==null&&(a.accumulatedGrads[i]={originalName:r+"/accumulator",variable:st(function(){return Ts(s.shape,a.initialAccumulatorValue).variable(!1)})});var o=Array.isArray(n)?n[i].tensor:n[r];if(o!=null){var u=a.accumulatedGrads[i].variable;st(function(){var c=u.add(o.square());u.assign(c);var d=o.div(c.add(be.backend.epsilon()).sqrt()).mul(-a.learningRate).add(s);s.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Cr(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),this.accumulatedGrads=n.map(function(r){return{originalName:r.name,variable:r.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,a){return new n(a.learningRate,a.initialAccumulatorValue)},t.className="Adagrad",t}($u);Ku(a9);var r9=function(e){function t(n,a,r,i){i===void 0&&(i=null);var s=e.call(this)||this;return s.learningRate=n,s.beta1=a,s.beta2=r,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],st(function(){s.accBeta1=at(a).variable(),s.accBeta2=at(r).variable()}),i==null&&(s.epsilon=be.backend.epsilon()),s}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this,r=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);st(function(){var i=xa(1,a.accBeta1),s=xa(1,a.accBeta2);r.forEach(function(o,u){var c=be.registeredVariables[o];a.accumulatedFirstMoment[u]==null&&(a.accumulatedFirstMoment[u]={originalName:o+"/m",variable:st(function(){return Wt(c).variable(!1)})}),a.accumulatedSecondMoment[u]==null&&(a.accumulatedSecondMoment[u]={originalName:o+"/v",variable:st(function(){return Wt(c).variable(!1)})});var d=Array.isArray(n)?n[u].tensor:n[o];if(d!=null){var h=a.accumulatedFirstMoment[u].variable,p=a.accumulatedSecondMoment[u].variable,f=h.mul(a.beta1).add(d.mul(1-a.beta1)),g=p.mul(a.beta2).add(d.square().mul(1-a.beta2)),b=f.div(i),w=g.div(s);h.assign(f),p.assign(g);var m=b.div(w.sqrt().add(a.epsilon)).mul(-a.learningRate).add(c);c.assign(m)}}),a.accBeta1.assign(a.accBeta1.mul(a.beta1)),a.accBeta2.assign(a.accBeta2.mul(a.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Cr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Cr(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){var n;return ut(this,function(a){switch(a.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(n.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){var a,r=this;return ut(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),st(function(){r.accBeta1.assign(N0(r.beta1,r.iterations_+1)),r.accBeta2.assign(N0(r.beta2,r.iterations_+1))}),a=n.length/2,this.accumulatedFirstMoment=n.slice(0,a).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(a,2*a).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,a){return new n(a.learningRate,a.beta1,a.beta2,a.epsilon)},t.className="Adam",t}($u);Ku(r9);var i9=function(e){function t(n,a,r,i,s){i===void 0&&(i=null),s===void 0&&(s=0);var o=e.call(this)||this;return o.learningRate=n,o.beta1=a,o.beta2=r,o.epsilon=i,o.decay=s,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],st(function(){o.iteration=at(0).variable(),o.accBeta1=at(a).variable()}),i==null&&(o.epsilon=be.backend.epsilon()),o}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this,r=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);st(function(){var i=xa(1,a.accBeta1),s=Vi(-a.learningRate,a.iteration.mul(a.decay).add(1));r.forEach(function(o,u){var c=be.registeredVariables[o];a.accumulatedFirstMoment[u]==null&&(a.accumulatedFirstMoment[u]={originalName:o+"/m",variable:Wt(c).variable(!1)}),a.accumulatedWeightedInfNorm[u]==null&&(a.accumulatedWeightedInfNorm[u]={originalName:o+"/v",variable:Wt(c).variable(!1)});var d=Array.isArray(n)?n[u].tensor:n[o];if(d!=null){var h=a.accumulatedFirstMoment[u].variable,p=a.accumulatedWeightedInfNorm[u].variable,f=h.mul(a.beta1).add(d.mul(1-a.beta1)),g=p.mul(a.beta2),b=d.abs(),w=g.maximum(b);h.assign(f),p.assign(w);var m=s.div(i).mul(f.div(w.add(a.epsilon))).add(c);c.assign(m)}}),a.iteration.assign(a.iteration.add(1)),a.accBeta1.assign(a.accBeta1.mul(a.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Cr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Cr(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,a){return new n(a.learningRate,a.beta1,a.beta2,a.epsilon,a.decay)},t.className="Adamax",t}($u);Ku(i9);var pC=function(e){function t(n){var a=e.call(this)||this;return a.learningRate=n,a.setLearningRate(n),a}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=Array.isArray(n)?n[i].tensor:n[r];if(s!=null){var o=be.registeredVariables[r];st(function(){var u=a.c.mul(s).add(o);o.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=_M(at(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=a.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,a){return new n(a.learningRate)},t.className="SGD",t}($u);Ku(pC);var s9=function(e){function t(n,a,r){r===void 0&&(r=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=a,i.useNesterov=r,i.accumulations=[],i.m=at(i.momentum),i}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=be.registeredVariables[r];a.accumulations[i]==null&&(a.accumulations[i]={originalName:r+"/momentum",variable:st(function(){return Wt(s).variable(!1)})});var o=a.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[r];u!=null&&st(function(){var c,d=a.m.mul(o).add(u);c=a.useNesterov?a.c.mul(u.add(d.mul(a.m))).add(s):a.c.mul(d).add(s),o.assign(d),s.assign(c)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Cr(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),this.accumulations=n.map(function(r){return{originalName:r.name,variable:r.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,a){return new n(a.learningRate,a.momentum,a.useNesterov)},t.className="Momentum",t}(pC);Ku(s9);var o9=function(e){function t(n,a,r,i,s){a===void 0&&(a=.9),r===void 0&&(r=0),i===void 0&&(i=null),s===void 0&&(s=!1);var o=e.call(this)||this;if(o.learningRate=n,o.decay=a,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=s,i==null&&(o.epsilon=be.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return Qi(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=be.registeredVariables[r];a.accumulatedMeanSquares[i]==null&&(a.accumulatedMeanSquares[i]={originalName:r+"/rms",variable:st(function(){return Wt(s).variable(!1)})}),a.accumulatedMoments[i]==null&&(a.accumulatedMoments[i]={originalName:r+"/momentum",variable:st(function(){return Wt(s).variable(!1)})}),a.accumulatedMeanGrads[i]==null&&a.centered&&(a.accumulatedMeanGrads[i]={originalName:r+"/mg",variable:st(function(){return Wt(s).variable(!1)})});var o=Array.isArray(n)?n[i].tensor:n[r];if(o!=null){var u=a.accumulatedMeanSquares[i].variable,c=a.accumulatedMoments[i].variable;st(function(){var d=u.mul(a.decay).add(o.square().mul(1-a.decay));if(a.centered){var h=a.accumulatedMeanGrads[i].variable,p=h.mul(a.decay).add(o.mul(1-a.decay)),f=c.mul(a.momentum).add(o.mul(a.learningRate).div(d.sub(p.square().add(a.epsilon)).sqrt()));u.assign(d),h.assign(p),c.assign(f);var g=s.sub(f);s.assign(g)}else{var b=u.mul(a.decay).add(o.square().mul(1-a.decay));f=c.mul(a.momentum).add(o.mul(a.learningRate).div(b.add(a.epsilon).sqrt())),u.assign(b),c.assign(f),g=s.sub(f),s.assign(g)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Cr(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Cr(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Cr(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){var n;return ut(this,function(a){switch(a.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(n.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),a=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(a,2*a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*a,3*a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,a){return new n(a.learningRate,a.decay,a.momentum,a.epsilon,a.centered)},t.className="RMSProp",t}($u);Ku(o9);Dn.prototype.squaredDifference=function(e){return E6(this,e)},Le=LB;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gy=function(e,t){return gy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)a.hasOwnProperty(r)&&(n[r]=a[r])},gy(e,t)};function jt(e,t){gy(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ya=function(){return Ya=Object.assign||function(t){for(var n,a=1,r=arguments.length;a<r;a++){n=arguments[a];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ya.apply(this,arguments)};function pt(e,t,n,a){function r(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function o(d){try{c(a.next(d))}catch(h){s(h)}}function u(d){try{c(a.throw(d))}catch(h){s(h)}}function c(d){d.done?i(d.value):r(d.value).then(o,u)}c((a=a.apply(e,[])).next())})}function mt(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,r,i,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(c){return function(d){return u([c,d])}}function u(c){if(a)throw new TypeError("Generator is already executing.");for(;n;)try{if(a=1,r&&(i=c[0]&2?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(d){c=[6,d],r=0}finally{a=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function vf(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var a=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],s=0,o=i.length;s<o;s++,r++)a[r]=i[s];return a}var ku=function(){function e(t,n){if(!Su(t)||!Su(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function wv(e,t){return e instanceof Dn&&e.shape.length===t}function l9(e){return wv(e,2)}function Nv(e){return wv(e,3)}function jl(e){return wv(e,4)}function u9(e){return e%1!==0}function e4(e){return e%2===0}function c9(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function t4(e){return e&&e.width&&e.height}function d9(e,t){var n=e.width,a=e.height,r=t/Math.max(a,n);return new ku(Math.round(n*r),Math.round(a*r))}function Nw(e){return e.reduce(function(t,n){return t.add(n)},new Qt(0,0)).div(new Qt(e.length,e.length))}function Hf(e,t,n){return Array(e).fill(0).map(function(a,r){return t+r*n})}function Su(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function n4(e){return Su(e)&&0<=e&&e<=1}var Qt=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Pl=function(){function e(t,n){n===void 0&&(n=!0);var a=t||{},r=[a.left,a.top,a.right,a.bottom].every(Su),i=[a.x,a.y,a.width,a.height].every(Su);if(!i&&!r)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(a));var s=i?[a.x,a.y,a.width,a.height]:[a.left,a.top,a.right-a.left,a.bottom-a.top],o=s[0],u=s[1],c=s[2],d=s[3];e.assertIsValidBox({x:o,y:u,width:c,height:d},"Box.constructor",n),this._x=o,this._y=u,this._width=c,this._height=d}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Su)},e.assertIsValidBox=function(t,n,a){if(a===void 0&&(a=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!a&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Qt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Qt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Qt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Qt(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),n=t[0],a=t[1],r=t[2],i=t[3];return new e({x:n,y:a,width:r,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),n=t[0],a=t[1],r=t[2],i=t[3];return new e({x:n,y:a,width:r,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,a=t.y,r=t.width,i=t.height,s=Math.abs(r-i);return r<i&&(n-=s/2,r+=s),i<r&&(a-=s/2,i+=s),new e({x:n,y:a,width:r,height:i})},e.prototype.rescale=function(t){var n=t4(t)?t.width:t,a=t4(t)?t.height:t;return new e({x:this.x*n,y:this.y*a,width:this.width*n,height:this.height*a})},e.prototype.pad=function(t,n){var a=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],r=a[0],i=a[1],s=a[2],o=a[3];return new e({x:r,y:i,width:s,height:o})},e.prototype.clipAtImageBorders=function(t,n){var a=this,r=a.x,i=a.y,s=a.right,o=a.bottom,u=Math.max(r,0),c=Math.max(i,0),d=s-u,h=o-c,p=Math.min(d,t-u),f=Math.min(h,n-c);return new e({x:u,y:c,width:p,height:f}).floor()},e.prototype.shift=function(t,n){var a=this,r=a.width,i=a.height,s=this.x+t,o=this.y+n;return new e({x:s,y:o,width:r,height:i})},e.prototype.padAtBorders=function(t,n){var a=this.width+1,r=this.height+1,i=1,s=1,o=a,u=r,c=this.left,d=this.top,h=this.right,p=this.bottom;return h>n&&(o=-h+n+a,h=n),p>t&&(u=-p+t+r,p=t),c<1&&(u=2-c,c=1),d<1&&(u=2-d,d=1),{dy:s,edy:u,dx:i,edx:o,y:d,ey:p,x:c,ex:h,w:a,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),kv=function(e){jt(t,e);function t(n,a,r,i,s){return s===void 0&&(s=!1),e.call(this,{left:n,top:a,right:r,bottom:i},s)||this}return t}(Pl),mC=function(){function e(t,n,a,r,i){this._imageDims=new ku(i.width,i.height),this._score=t,this._classScore=n,this._className=a,this._box=new Pl(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Pl(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),es=function(e){jt(t,e);function t(n,a,r){return e.call(this,n,n,"",a,r)||this}return t.prototype.forSize=function(n,a){var r=e.prototype.forSize.call(this,n,a),i=r.score,s=r.relativeBox,o=r.imageDims;return new t(i,s,o)},t}(mC);function h9(e,t,n){n===void 0&&(n=!0);var a=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),r=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=a*r;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function f9(e){var t=e.map(function(o){return o.x}),n=e.map(function(o){return o.y}),a=t.reduce(function(o,u){return u<o?u:o},1/0),r=n.reduce(function(o,u){return u<o?u:o},1/0),i=t.reduce(function(o,u){return o<u?u:o},0),s=n.reduce(function(o,u){return o<u?u:o},0);return new kv(a,r,i,s)}function Wf(e,t,n,a){a===void 0&&(a=!0);for(var r=t.map(function(o,u){return{score:o,boxIndex:u}}).sort(function(o,u){return o.score-u.score}).map(function(o){return o.boxIndex}),i=[],s=function(){var o=r.pop();i.push(o);for(var u=r,c=[],d=0;d<u.length;d++){var h=u[d],p=e[o],f=e[h];c.push(h9(p,f,a))}r=r.filter(function(g,b){return c[b]<=n})};r.length>0;)s();return i}function Cp(e,t){return st(function(){var n=t[0],a=t[1],r=t[2],i=Ts(vf(e.shape.slice(0,3),[1]),n),s=Ts(vf(e.shape.slice(0,3),[1]),a),o=Ts(vf(e.shape.slice(0,3),[1]),r),u=pa([i,s,o],3);return xa(e,u)})}function p9(e,t){return t===void 0&&(t=!1),st(function(){var n=e.shape.slice(1),a=n[0],r=n[1];if(a===r)return e;var i=Math.abs(a-r),s=Math.round(i*(t?.5:1)),o=a>r?2:1,u=function(f){var g=e.shape.slice();return g[o]=f,Ts(g,0)},c=u(s),d=i-c.shape[o],h=t&&d?u(d):null,p=[h,e,c].filter(function(f){return!!f}).map(function(f){return f.toFloat()});return pa(p,o)})}function Tb(e){return 1/(1+Math.exp(-e))}var kw=function(e){jt(t,e);function t(n,a,r,i,s){return s===void 0&&(s=!1),e.call(this,{x:n,y:a,width:r,height:i},s)||this}return t}(Pl),m9=.5,g9=.43,v9=.45,Gf=function(){function e(t,n,a){a===void 0&&(a=new Qt(0,0));var r=n.width,i=n.height;this._imgDims=new ku(r,i),this._shift=a,this._positions=t.map(function(s){return s.mul(new Qt(r,i)).add(a)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Qt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new Qt(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new Qt(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var a=t instanceof es?t.box.floor():new Pl(t);return this.shiftBy(a.x,a.y).align(null,n)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=r.useDlibAlignment,s=r.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(s)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],a=t[1],r=t[2],i=function(h){return r.sub(h).magnitude()},s=(i(n)+i(a))/2,o=Math.floor(s/v9),u=Nw(t),c=Math.floor(Math.max(0,u.x-m9*o)),d=Math.floor(Math.max(0,u.y-g9*o));return new kw(c,d,Math.min(o,this.imageWidth+c),Math.min(o,this.imageHeight+d))},e.prototype.alignMinBbox=function(t){var n=f9(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),x9=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],Nw([n[3],n[4]])]},t}(Gf),b9=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Nw)},t}(Gf),a4=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+c9(this.distance)+")":"")},e}(),r4=function(e){jt(t,e);function t(n,a){var r=e.call(this,n)||this;return r._label=a,r}return t.assertIsValidLabeledBox=function(n,a){if(Pl.assertIsValidBox(n,a),!Su(n.label))throw new Error(a+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Pl),Wm=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(a){return!(a instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(a){return new Float32Array(a)});return new e(t.label,n)},e}();(function(e){jt(t,e);function t(n,a,r,i){var s=e.call(this,n,a)||this;return s._score=r,s._classScore=i,s}return t.assertIsValidPredictedBox=function(n,a){if(r4.assertIsValidLabeledBox(n,a),!n4(n.score)||!n4(n.classScore))throw new Error(a+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(r4);function gC(e){return e.detection instanceof es}function Vf(e,t){var n={detection:t};return Object.assign({},e,n)}function vC(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function xC(e){var t="";if(!e)try{e=require("fs")}catch(a){t=a.toString()}var n=e?function(a){return new Promise(function(r,i){e.readFile(a,function(s,o){return s?i(s):r(o)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function bC(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},r=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=xC();return Ya({Canvas:e||function(){function s(){}return s}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function s(){}return s}(),Image:t||function(){function s(){}return s}(),ImageData:global.ImageData||function(){function s(){}return s}(),Video:global.HTMLVideoElement||function(){function s(){}return s}(),createCanvasElement:n,createImageElement:a,fetch:r},i)}function yC(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function wC(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var ua;function y9(){if(!ua)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return ua}function vy(e){ua=e}function Sw(){yC()&&vy(vC()),wC()&&vy(bC())}function w9(e){if(ua||Sw(),!ua)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?ua.Canvas:t,a=e.Image,r=a===void 0?ua.Image:a;ua.Canvas=n,ua.Image=r,ua.createCanvasElement=e.createCanvasElement||function(){return new n},ua.createImageElement=e.createImageElement||function(){return new r},ua.ImageData=e.ImageData||ua.ImageData,ua.Video=e.Video||ua.Video,ua.fetch=e.fetch||ua.fetch,ua.readFile=e.readFile||ua.readFile}var ir={getEnv:y9,setEnv:vy,initialize:Sw,createBrowserEnv:vC,createFileSystem:xC,createNodejsEnv:bC,monkeyPatch:w9,isBrowser:yC,isNodejs:wC};Sw();function NC(e){return!ir.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Ou(e){var t=ir.getEnv(),n=t.Canvas,a=t.CanvasRenderingContext2D;if(e instanceof a)return e;var r=NC(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=r.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var i4;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(i4||(i4={}));function kC(e){var t=ir.getEnv(),n=t.Image,a=t.Video;return e instanceof n&&e.complete||e instanceof a&&e.readyState>=3}function N9(e){return new Promise(function(t,n){if(e instanceof ir.getEnv().Canvas||kC(e))return t();function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),t(i))}function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),n(i))}e.addEventListener("load",a),e.addEventListener("error",r)})}function _w(e){var t=ir.getEnv(),n=t.Image,a=t.Video;return e instanceof n?new ku(e.naturalWidth,e.naturalHeight):e instanceof a?new ku(e.videoWidth,e.videoHeight):new ku(e.width,e.height)}function Sv(e){var t=e.width,n=e.height,a=ir.getEnv().createCanvasElement,r=a();return r.width=t,r.height=n,r}function jw(e,t){var n=ir.getEnv().ImageData;if(!(e instanceof n)&&!kC(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var a=_w(e),r=a.width,i=a.height,s=Sv({width:r,height:i});return e instanceof n?Ou(s).putImageData(e,0,0):Ou(s).drawImage(e,0,0,r,i),s}function k9(e,t){return pt(this,void 0,void 0,function(){var n,a,r,i,s,o;return mt(this,function(u){switch(u.label){case 0:return n=ir.getEnv().createCanvasElement(),a=e.shape.slice(jl(e)?1:0),r=a[0],i=a[1],s=a[2],o=st(function(){return e.as3D(r,i,s).toInt()}),[4,ww.toPixels(o,n)];case 1:return u.sent(),o.dispose(),[2,n]}})})}function s4(e){var t=ir.getEnv(),n=t.Image,a=t.Canvas,r=t.Video;return e instanceof n||e instanceof a||e instanceof r}function S9(e,t,n){n===void 0&&(n=!1);var a=ir.getEnv(),r=a.Image,i=a.Canvas;if(!(e instanceof r||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=_w(e),o=t/Math.max(s.height,s.width),u=o*s.width,c=o*s.height,d=Sv({width:t,height:t}),h=e instanceof i?e:jw(e),p=Math.abs(u-c)/2,f=n&&u<c?p:0,g=n&&c<u?p:0;return Ou(d).drawImage(h,f,g,u,c),d}var _0=function(){function e(t,n){var a=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(r,i){if(Nv(r)){a._imageTensors[i]=r,a._inputDimensions[i]=r.shape;return}if(jl(r)){var s=r.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");a._imageTensors[i]=r,a._inputDimensions[i]=r.shape.slice(1);return}var o=r instanceof ir.getEnv().Canvas?r:jw(r);a._canvases[i]=o,a._inputDimensions[i]=[o.height,o.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Hf(this.batchSize,0,1).map(function(n,a){return t.getReshapedInputDimensions(a)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),a=this.getInputHeight(t);return d9({width:n,height:a},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var a=this;return n===void 0&&(n=!0),this._inputSize=t,st(function(){var r=Hf(a.batchSize,0,1).map(function(s){var o=a.getInput(s);if(o instanceof Dn){var u=jl(o)?o:o.expandDims();return u=p9(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=mw.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(o instanceof ir.getEnv().Canvas)return ww.fromPixels(S9(o,t,n));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)}),i=ei(r.map(function(s){return s.toFloat()})).as4D(a.batchSize,t,t,3);return i})},e}();function Da(e){return pt(this,void 0,void 0,function(){var t,n,a;return mt(this,function(r){switch(r.label){case 0:if(e instanceof _0)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},a=t.map(NC),a.forEach(function(i,s){if(!s4(i)&&!Nv(i)&&!jl(i))throw typeof t[s]=="string"?new Error("toNetInput -"+n(s)+" string passed, but could not resolve HTMLElement for element id "+t[s]):new Error("toNetInput -"+n(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(jl(i)){var o=i.shape[0];if(o!==1)throw new Error("toNetInput -"+n(s)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}}),[4,Promise.all(a.map(function(i){return s4(i)&&N9(i)}))];case 1:return r.sent(),[2,new _0(a,Array.isArray(e))]}})})}function Cw(e,t){return pt(this,void 0,void 0,function(){var n,a,r,i,s,o,u;return mt(this,function(c){switch(c.label){case 0:return n=ir.getEnv().Canvas,a=e,e instanceof n?[3,5]:[4,Da(e)];case 1:if(r=c.sent(),r.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=r.getInput(0),i instanceof n?(s=i,[3,4]):[3,2];case 2:return[4,k9(i)];case 3:s=c.sent(),c.label=4;case 4:a=s,c.label=5;case 5:return o=Ou(a),u=t.map(function(d){return d instanceof es?d.forSize(a.width,a.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(a.width,a.height)}),[2,u.map(function(d){var h=d.x,p=d.y,f=d.width,g=d.height,b=Sv({width:f,height:g});return Ou(b).putImageData(o.getImageData(h,p,f,g),0,0),b})]}})})}function Aw(e,t){return pt(this,void 0,void 0,function(){return mt(this,function(n){if(!Nv(e)&&!jl(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(jl(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,st(function(){var a=e.shape.slice(jl(e)?1:0),r=a[0],i=a[1],s=a[2],o=t.map(function(c){return c instanceof es?c.forSize(i,r).box:c}).map(function(c){return c.clipAtImageBorders(i,r)}),u=o.map(function(c){var d=c.x,h=c.y,p=c.width,f=c.height;return X6(e.as3D(r,i,s),[h,d,0],[f,p,s])});return u})]})})}function _9(e,t){return pt(this,void 0,void 0,function(){var n,a;return mt(this,function(r){switch(r.label){case 0:return n=ir.getEnv().fetch,[4,n(e,t)];case 1:if(a=r.sent(),!(a.status<400))throw new Error("failed to fetch: ("+a.status+") "+a.statusText+", from url: "+a.url);return[2,a]}})})}function j9(e){return pt(this,void 0,void 0,function(){return mt(this,function(t){switch(t.label){case 0:return[4,_9(e)];case 1:return[2,t.sent().json()]}})})}function SC(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var a=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(a,"");var r=e.split("/").filter(function(o){return o}),i=e.endsWith(".json")?r[r.length-1]:n,s=a+(e.endsWith(".json")?r.slice(0,r.length-1):r).join("/");return s=e.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+i:s+"/"+i}}function C9(e,t){return pt(this,void 0,void 0,function(){var n,a,r,i;return mt(this,function(s){switch(s.label){case 0:return n=SC(e,t),a=n.manifestUri,r=n.modelBaseUri,[4,j9(a)];case 1:return i=s.sent(),[2,fC.loadWeights(i,r)]}})})}function A9(e,t,n){n===void 0&&(n=!1);var a=n?_w(t):t,r=a.width,i=a.height;return e.width=r,e.height=i,{width:r,height:i}}var Co=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),a=n.obj,r=n.objProp;return a[r]},e.prototype.reassignParamFromPath=function(t,n){var a=this.traversePropertyPath(t),r=a.obj,i=a.objProp;r[i].dispose(),r[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var a=n.paramPath;return{path:a,tensor:t.getParamFromPath(a)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof zd})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof zd)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var a=n.path,r=n.tensor;t.reassignParamFromPath(a,r.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var a=n.path,r=n.tensor,i=Fa(r.dataSync());r.dispose(),t.reassignParamFromPath(a,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return pt(this,void 0,void 0,function(){return mt(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return pt(this,void 0,void 0,function(){var n;return mt(this,function(a){switch(a.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,C9(t,this.getDefaultModelName())];case 1:return n=a.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return pt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h;return mt(this,function(p){switch(p.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=ir.getEnv().readFile,a=SC(t,this.getDefaultModelName()),r=a.manifestUri,i=a.modelBaseUri,s=function(f){return Promise.all(f.map(function(g){return n(g).then(function(b){return b.buffer})}))},o=fC.weightsLoaderFactory(s),d=(c=JSON).parse,[4,n(r)];case 1:return u=d.apply(c,[p.sent().toString()]),[4,o(u,i)];case 2:return h=p.sent(),this.loadFromWeightMap(h),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),a=n.paramMappings,r=n.params;this._paramMappings=a,this._params=r},e.prototype.extractWeights=function(t){var n=this.extractParams(t),a=n.paramMappings,r=n.params;this._paramMappings=a,this._params=r},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,s){if(!i.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+t);return{obj:i.nextObj,objProp:s,nextObj:i.nextObj[s]}},{nextObj:this.params}),a=n.obj,r=n.objProp;if(!a||!r||!(a[r]instanceof Dn))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:a,objProp:r}},e}();function Kr(e,t,n){return st(function(){var a=cw(e,t.depthwise_filter,t.pointwise_filter,n,"same");return a=Ot(a,t.bias),a})}function Rb(e,t,n){return n===void 0&&(n=!1),st(function(){var a=Tn(n?Ot(Di(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Kr(e,t.conv0,[2,2])),r=Kr(a,t.conv1,[1,1]),i=Tn(Ot(a,r)),s=Kr(i,t.conv2,[1,1]);return Tn(Ot(a,Ot(r,s)))})}function Gm(e,t,n,a){return n===void 0&&(n=!1),a===void 0&&(a=!0),st(function(){var r=Tn(n?Ot(Di(e,t.conv0.filters,a?[2,2]:[1,1],"same"),t.conv0.bias):Kr(e,t.conv0,a?[2,2]:[1,1])),i=Kr(r,t.conv1,[1,1]),s=Tn(Ot(r,i)),o=Kr(s,t.conv2,[1,1]),u=Tn(Ot(r,Ot(i,o))),c=Kr(u,t.conv3,[1,1]);return Tn(Ot(r,Ot(i,Ot(o,c))))})}function Yi(e,t,n,a){return n===void 0&&(n="same"),a===void 0&&(a=!1),st(function(){var r=Ot(Di(e,t.filters,[1,1],n),t.bias);return a?Tn(r):r})}function Ao(e,t){Object.keys(e).forEach(function(n){t.some(function(a){return a.originalPath===n})||e[n].dispose()})}function _v(e,t){return function(n,a,r,i){var s=Sr(e(n*a*r*r),[r,r,n,a]),o=ia(e(a));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:s,bias:o}}}function Ew(e,t){return function(n,a,r){var i=Sl(e(n*a),[n,a]),s=ia(e(a));return t.push({paramPath:r+"/weights"},{paramPath:r+"/bias"}),{weights:i,bias:s}}}var _C=function(){function e(t,n,a){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=a}return e}();function Dw(e,t){return function(n,a,r){var i=Sr(e(9*n),[3,3,n,1]),s=Sr(e(n*a),[1,1,n,a]),o=ia(e(a));return t.push({paramPath:r+"/depthwise_filter"},{paramPath:r+"/pointwise_filter"},{paramPath:r+"/bias"}),new _C(i,s,o)}}function Tw(e){return function(t){var n=e(t+"/depthwise_filter",4),a=e(t+"/pointwise_filter",4),r=e(t+"/bias",1);return new _C(n,a,r)}}function Ul(e,t){return function(n,a,r){var i=e[n];if(!wv(i,a))throw new Error("expected weightMap["+n+"] to be a Tensor"+a+"D, instead have "+i);return t.push({originalPath:n,paramPath:r||n}),i}}function Eo(e){var t=e;function n(r){var i=t.slice(0,r);return t=t.slice(r),i}function a(){return t}return{extractWeights:n,getRemainingWeights:a}}function jC(e,t){var n=_v(e,t),a=Dw(e,t);function r(s,o,u,c){c===void 0&&(c=!1);var d=c?n(s,o,3,u+"/conv0"):a(s,o,u+"/conv0"),h=a(o,o,u+"/conv1"),p=a(o,o,u+"/conv2");return{conv0:d,conv1:h,conv2:p}}function i(s,o,u,c){c===void 0&&(c=!1);var d=r(s,o,u,c),h=d.conv0,p=d.conv1,f=d.conv2,g=a(o,o,u+"/conv3");return{conv0:h,conv1:p,conv2:f,conv3:g}}return{extractDenseBlock3Params:r,extractDenseBlock4Params:i}}function E9(e){var t=[],n=Eo(e),a=n.extractWeights,r=n.getRemainingWeights,i=jC(a,t).extractDenseBlock4Params,s=i(3,32,"dense0",!0),o=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:t,params:{dense0:s,dense1:o,dense2:u,dense3:c}}}function CC(e){return function(t){var n=e(t+"/filters",4),a=e(t+"/bias",1);return{filters:n,bias:a}}}function AC(e,t){var n=Ul(e,t),a=CC(n),r=Tw(n);function i(o,u){u===void 0&&(u=!1);var c=u?a(o+"/conv0"):r(o+"/conv0"),d=r(o+"/conv1"),h=r(o+"/conv2");return{conv0:c,conv1:d,conv2:h}}function s(o,u){u===void 0&&(u=!1);var c=u?a(o+"/conv0"):r(o+"/conv0"),d=r(o+"/conv1"),h=r(o+"/conv2"),p=r(o+"/conv3");return{conv0:c,conv1:d,conv2:h,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function D9(e){var t=[],n=AC(e,t).extractDenseBlock4Params,a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Ao(e,t),{params:a,paramMappings:t}}var EC=function(e){jt(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("FaceFeatureExtractor - load model before inference");return st(function(){var r=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Cp(r,i).div(at(255)),o=Gm(s,a.dense0,!0);return o=Gm(o,a.dense1),o=Gm(o,a.dense2),o=Gm(o,a.dense3),o=_p(o,[7,7],[2,2],"valid"),o})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return D9(n)},t.prototype.extractParams=function(n){return E9(n)},t}(Co);function Ss(e,t){return st(function(){return Ot(xv(e,t.weights),t.bias)})}function T9(e,t,n){var a=[],r=Eo(e),i=r.extractWeights,s=r.getRemainingWeights,o=Ew(i,a),u=o(t,n,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:a,params:{fc:u}}}function R9(e){var t=[],n=Ul(e,t);function a(i){var s=n(i+"/weights",2),o=n(i+"/bias",1);return{weights:s,bias:o}}var r={fc:a("fc")};return Ao(e,t),{params:r,paramMappings:t}}function DC(e){var t={},n={};return Object.keys(e).forEach(function(a){var r=a.startsWith("fc")?n:t;r[a]=e[a]}),{featureExtractorMap:t,classifierMap:n}}var TC=function(e){jt(t,e);function t(n,a){var r=e.call(this,n)||this;return r._faceFeatureExtractor=a,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var a=this,r=this.params;if(!r)throw new Error(this._name+" - load model before inference");return st(function(){var i=n instanceof _0?a.faceFeatureExtractor.forwardInput(n):n;return Ss(i.as2D(i.shape[0],-1),r.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var a=this.extractClassifierParams(n),r=a.params,i=a.paramMappings;this._params=r,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return T9(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var a=DC(n),r=a.featureExtractorMap,i=a.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r),R9(i)},t.prototype.extractParams=function(n){var a=this.getClassifierChannelsIn(),r=this.getClassifierChannelsOut(),i=r*a+r,s=n.slice(0,n.length-i),o=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(o)},t}(Co),o4=["neutral","happy","sad","angry","fearful","disgusted","surprised"],L9=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);o4.forEach(function(a,r){n[a]=t[r]})}return e.prototype.asSortedArray=function(){var t=this;return o4.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,a){return a.probability-n.probability})},e}(),P9=function(e){jt(t,e);function t(n){return n===void 0&&(n=new EC),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var a=this;return st(function(){return _o(a.runNet(n))})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.predictExpressions=function(n){return pt(this,void 0,void 0,function(){var a,r,i,s,o=this;return mt(this,function(u){switch(u.label){case 0:return[4,Da(n)];case 1:return a=u.sent(),[4,this.forwardInput(a)];case 2:return r=u.sent(),[4,Promise.all(ma(r).map(function(c){return pt(o,void 0,void 0,function(){var d;return mt(this,function(h){switch(h.label){case 0:return[4,c.data()];case 1:return d=h.sent(),c.dispose(),[2,d]}})})}))];case 3:return i=u.sent(),r.dispose(),s=i.map(function(c){return new L9(c)}),[2,a.isBatchInput?s:s[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(TC);function RC(e,t){var n={expressions:t};return Object.assign({},e,n)}function LC(e){return gC(e)&&e.landmarks instanceof Gf&&e.unshiftedLandmarks instanceof Gf&&e.alignedRect instanceof es}function jv(e,t){var n=e.detection.box,a=t.shiftBy(n.x,n.y),r=a.align(),i=e.detection.imageDims,s=new es(e.detection.score,r.rescale(i.reverse()),i),o={landmarks:a,unshiftedLandmarks:t,alignedRect:s};return Object.assign({},e,o)}function M9(e,t){var n=_v(e,t),a=Dw(e,t);function r(s,o,u){var c=a(s,o,u+"/separable_conv0"),d=a(o,o,u+"/separable_conv1"),h=n(s,o,1,u+"/expansion_conv");return{separable_conv0:c,separable_conv1:d,expansion_conv:h}}function i(s,o){var u=a(s,s,o+"/separable_conv0"),c=a(s,s,o+"/separable_conv1"),d=a(s,s,o+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:r,extractMainBlockParams:i}}function I9(e,t){var n=[],a=Eo(e),r=a.extractWeights,i=a.getRemainingWeights,s=M9(r,n),o=s.extractConvParams,u=s.extractSeparableConvParams,c=s.extractReductionBlockParams,d=s.extractMainBlockParams,h=o(3,32,3,"entry_flow/conv_in"),p=c(32,64,"entry_flow/reduction_block_0"),f=c(64,128,"entry_flow/reduction_block_1"),g={conv_in:h,reduction_block_0:p,reduction_block_1:f},b={};Hf(t,0,1).forEach(function(y){b["main_block_"+y]=d(128,"middle_flow/main_block_"+y)});var w=c(128,256,"exit_flow/reduction_block"),m=u(256,512,"exit_flow/separable_conv"),x={reduction_block:w,separable_conv:m};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:g,middle_flow:b,exit_flow:x}}}function O9(e,t){var n=Ul(e,t),a=CC(n),r=Tw(n);function i(o){var u=r(o+"/separable_conv0"),c=r(o+"/separable_conv1"),d=a(o+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:d}}function s(o){var u=r(o+"/separable_conv0"),c=r(o+"/separable_conv1"),d=r(o+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:d}}return{extractConvParams:a,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:s}}function F9(e,t){var n=[],a=O9(e,n),r=a.extractConvParams,i=a.extractSeparableConvParams,s=a.extractReductionBlockParams,o=a.extractMainBlockParams,u=r("entry_flow/conv_in"),c=s("entry_flow/reduction_block_0"),d=s("entry_flow/reduction_block_1"),h={conv_in:u,reduction_block_0:c,reduction_block_1:d},p={};Hf(t,0,1).forEach(function(w){p["main_block_"+w]=o("middle_flow/main_block_"+w)});var f=s("exit_flow/reduction_block"),g=i("exit_flow/separable_conv"),b={reduction_block:f,separable_conv:g};return Ao(e,n),{params:{entry_flow:h,middle_flow:p,exit_flow:b},paramMappings:n}}function PC(e,t,n){return Ot(Di(e,t.filters,n,"same"),t.bias)}function Lb(e,t,n){n===void 0&&(n=!0);var a=n?Tn(e):e;return a=Kr(a,t.separable_conv0,[1,1]),a=Kr(Tn(a),t.separable_conv1,[1,1]),a=ka(a,[3,3],[2,2],"same"),a=Ot(a,PC(e,t.expansion_conv,[2,2])),a}function B9(e,t){var n=Kr(Tn(e),t.separable_conv0,[1,1]);return n=Kr(Tn(n),t.separable_conv1,[1,1]),n=Kr(Tn(n),t.separable_conv2,[1,1]),n=Ot(n,e),n}var z9=function(e){jt(t,e);function t(n){var a=e.call(this,"TinyXception")||this;return a._numMainBlocks=n,a}return t.prototype.forwardInput=function(n){var a=this,r=this.params;if(!r)throw new Error("TinyXception - load model before inference");return st(function(){var i=n.toBatchTensor(112,!0),s=[122.782,117.001,104.298],o=Cp(i,s).div(at(256)),u=Tn(PC(o,r.entry_flow.conv_in,[2,2]));return u=Lb(u,r.entry_flow.reduction_block_0,!1),u=Lb(u,r.entry_flow.reduction_block_1),Hf(a._numMainBlocks,0,1).forEach(function(c){u=B9(u,r.middle_flow["main_block_"+c])}),u=Lb(u,r.exit_flow.reduction_block),u=Tn(Kr(u,r.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return F9(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return I9(n,this._numMainBlocks)},t}(Co);function U9(e){var t=[],n=Eo(e),a=n.extractWeights,r=n.getRemainingWeights,i=Ew(a,t),s=i(512,1,"fc/age"),o=i(512,2,"fc/gender");if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:t,params:{fc:{age:s,gender:o}}}}function q9(e){var t=[],n=Ul(e,t);function a(i){var s=n(i+"/weights",2),o=n(i+"/bias",1);return{weights:s,bias:o}}var r={fc:{age:a("fc/age"),gender:a("fc/gender")}};return Ao(e,t),{params:r,paramMappings:t}}var j0;(function(e){e.FEMALE="female",e.MALE="male"})(j0||(j0={}));var H9=function(e){jt(t,e);function t(n){n===void 0&&(n=new z9(2));var a=e.call(this,"AgeGenderNet")||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var a=this,r=this.params;if(!r)throw new Error(this._name+" - load model before inference");return st(function(){var i=n instanceof _0?a.faceFeatureExtractor.forwardInput(n):n,s=_p(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),o=Ss(s,r.fc.age).as1D(),u=Ss(s,r.fc.gender);return{age:o,gender:u}})},t.prototype.forwardInput=function(n){var a=this;return st(function(){var r=a.runNet(n),i=r.age,s=r.gender;return{age:i,gender:_o(s)}})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return pt(this,void 0,void 0,function(){var a,r,i,s,o,u,c=this;return mt(this,function(d){switch(d.label){case 0:return[4,Da(n)];case 1:return a=d.sent(),[4,this.forwardInput(a)];case 2:return r=d.sent(),i=ma(r.age),s=ma(r.gender),o=i.map(function(h,p){return{ageTensor:h,genderTensor:s[p]}}),[4,Promise.all(o.map(function(h){var p=h.ageTensor,f=h.genderTensor;return pt(c,void 0,void 0,function(){var g,b,w,m,x;return mt(this,function(y){switch(y.label){case 0:return[4,p.data()];case 1:return g=y.sent()[0],[4,f.data()];case 2:return b=y.sent()[0],w=b>.5,m=w?j0.MALE:j0.FEMALE,x=w?b:1-b,p.dispose(),f.dispose(),[2,{age:g,gender:m,genderProbability:x}]}})})}))];case 3:return u=d.sent(),r.age.dispose(),r.gender.dispose(),[2,a.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var a=this.extractClassifierParams(n),r=a.params,i=a.paramMappings;this._params=r,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return U9(n)},t.prototype.extractParamsFromWeigthMap=function(n){var a=DC(n),r=a.featureExtractorMap,i=a.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r),q9(i)},t.prototype.extractParams=function(n){var a=1539,r=n.slice(0,n.length-a),i=n.slice(n.length-a);return this.faceFeatureExtractor.extractWeights(r),this.extractClassifierParams(i)},t}(Co),MC=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,a,r){var i=r.map(function(o){var u=o.width,c=o.height,d=a/Math.max(c,u);return{width:u*d,height:c*d}}),s=i.length;return st(function(){var o=function(p,f){return ei([Ts([68],p),Ts([68],f)],1).as2D(1,136).as1D()},u=function(p,f){var g=i[p],b=g.width,w=g.height;return f(b,w)?Math.abs(b-w)/2:0},c=function(p){return u(p,function(f,g){return f<g})},d=function(p){return u(p,function(f,g){return g<f})},h=n.mul(Ts([s,136],a)).sub(ei(Array.from(Array(s),function(p,f){return o(c(f),d(f))}))).div(ei(Array.from(Array(s),function(p,f){return o(i[f].width,i[f].height)})));return h})},t.prototype.forwardInput=function(n){var a=this;return st(function(){var r=a.runNet(n);return a.postProcess(r,n.inputSize,n.inputDimensions.map(function(i){var s=i[0],o=i[1];return{height:s,width:o}}))})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.detectLandmarks=function(n){return pt(this,void 0,void 0,function(){var a,r,i,s=this;return mt(this,function(o){switch(o.label){case 0:return[4,Da(n)];case 1:return a=o.sent(),r=st(function(){return ma(s.forwardInput(a))}),[4,Promise.all(r.map(function(u,c){return pt(s,void 0,void 0,function(){var d,h,p,f,g;return mt(this,function(b){switch(b.label){case 0:return p=(h=Array).from,[4,u.data()];case 1:return d=p.apply(h,[b.sent()]),f=d.filter(function(w,m){return e4(m)}),g=d.filter(function(w,m){return!e4(m)}),[2,new b9(Array(68).fill(0).map(function(w,m){return new Qt(f[m],g[m])}),{height:a.getInputHeight(c),width:a.getInputWidth(c)})]}})})}))];case 2:return i=o.sent(),r.forEach(function(u){return u.dispose()}),[2,a.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(TC),IC=function(e){jt(t,e);function t(n){return n===void 0&&(n=new EC),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(MC);function W9(e){var t=[],n=AC(e,t).extractDenseBlock3Params,a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Ao(e,t),{params:a,paramMappings:t}}function G9(e){var t=[],n=Eo(e),a=n.extractWeights,r=n.getRemainingWeights,i=jC(a,t).extractDenseBlock3Params,s=i(3,32,"dense0",!0),o=i(32,64,"dense1"),u=i(64,128,"dense2");if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:t,params:{dense0:s,dense1:o,dense2:u}}}var V9=function(e){jt(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("TinyFaceFeatureExtractor - load model before inference");return st(function(){var r=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Cp(r,i).div(at(255)),o=Rb(s,a.dense0,!0);return o=Rb(o,a.dense1),o=Rb(o,a.dense2),o=_p(o,[14,14],[2,2],"valid"),o})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return W9(n)},t.prototype.extractParams=function(n){return G9(n)},t}(Co),K9=function(e){jt(t,e);function t(n){return n===void 0&&(n=new V9),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(MC);(function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(IC);function $9(e,t){return Ot(tr(e,t.weights),t.biases)}function Rw(e,t,n,a,r){r===void 0&&(r="same");var i=t.conv,s=i.filters,o=i.bias,u=Di(e,s,n,r);return u=Ot(u,o),u=$9(u,t.scale),a?Tn(u):u}function Y9(e,t){return Rw(e,t,[1,1],!0)}function OC(e,t){return Rw(e,t,[1,1],!1)}function FC(e,t){return Rw(e,t,[2,2],!0,"valid")}function X9(e,t){function n(o,u,c){var d=e(o),h=d.length/(u*c*c);if(u9(h))throw new Error("depth has to be an integer: "+h+", weights.length: "+d.length+", numFilters: "+u+", filterSize: "+c);return st(function(){return Ll(Sr(d,[u,h,c,c]),[2,3,1,0])})}function a(o,u,c,d){var h=n(o,u,c),p=ia(e(u));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:h,bias:p}}function r(o,u){var c=ia(e(o)),d=ia(e(o));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:d}}function i(o,u,c,d){var h=a(o,u,c,d+"/conv"),p=r(u,d+"/scale");return{conv:h,scale:p}}function s(o,u,c,d,h){h===void 0&&(h=!1);var p=i((h?.5:1)*o,u,c,d+"/conv1"),f=i(o,u,c,d+"/conv2");return{conv1:p,conv2:f}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function J9(e){var t=Eo(e),n=t.extractWeights,a=t.getRemainingWeights,r=[],i=X9(n,r),s=i.extractConvLayerParams,o=i.extractResidualLayerParams,u=s(4704,32,7,"conv32_down"),c=o(9216,32,3,"conv32_1"),d=o(9216,32,3,"conv32_2"),h=o(9216,32,3,"conv32_3"),p=o(36864,64,3,"conv64_down",!0),f=o(36864,64,3,"conv64_1"),g=o(36864,64,3,"conv64_2"),b=o(36864,64,3,"conv64_3"),w=o(147456,128,3,"conv128_down",!0),m=o(147456,128,3,"conv128_1"),x=o(147456,128,3,"conv128_2"),y=o(589824,256,3,"conv256_down",!0),N=o(589824,256,3,"conv256_1"),S=o(589824,256,3,"conv256_2"),T=o(589824,256,3,"conv256_down_out"),C=st(function(){return Ll(Sl(n(256*128),[128,256]),[1,0])});if(r.push({paramPath:"fc"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);var A={conv32_down:u,conv32_1:c,conv32_2:d,conv32_3:h,conv64_down:p,conv64_1:f,conv64_2:g,conv64_3:b,conv128_down:w,conv128_1:m,conv128_2:x,conv256_down:y,conv256_1:N,conv256_2:S,conv256_down_out:T,fc:C};return{params:A,paramMappings:r}}function Q9(e,t){var n=Ul(e,t);function a(s){var o=n(s+"/scale/weights",1),u=n(s+"/scale/biases",1);return{weights:o,biases:u}}function r(s){var o=n(s+"/conv/filters",4),u=n(s+"/conv/bias",1),c=a(s);return{conv:{filters:o,bias:u},scale:c}}function i(s){return{conv1:r(s+"/conv1"),conv2:r(s+"/conv2")}}return{extractConvLayerParams:r,extractResidualLayerParams:i}}function Z9(e){var t=[],n=Q9(e,t),a=n.extractConvLayerParams,r=n.extractResidualLayerParams,i=a("conv32_down"),s=r("conv32_1"),o=r("conv32_2"),u=r("conv32_3"),c=r("conv64_down"),d=r("conv64_1"),h=r("conv64_2"),p=r("conv64_3"),f=r("conv128_down"),g=r("conv128_1"),b=r("conv128_2"),w=r("conv256_down"),m=r("conv256_1"),x=r("conv256_2"),y=r("conv256_down_out"),N=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!l9(N))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+N);var S={conv32_down:i,conv32_1:s,conv32_2:o,conv32_3:u,conv64_down:c,conv64_1:d,conv64_2:h,conv64_3:p,conv128_down:f,conv128_1:g,conv128_2:b,conv256_down:w,conv256_1:m,conv256_2:x,conv256_down_out:y,fc:N};return Ao(e,t),{params:S,paramMappings:t}}function fs(e,t){var n=Y9(e,t.conv1);return n=OC(n,t.conv2),n=Ot(n,e),n=Tn(n),n}function Vm(e,t){var n=FC(e,t.conv1);n=OC(n,t.conv2);var a=_p(e,2,2,"valid"),r=Nn(a.shape),i=a.shape[3]!==n.shape[3],s=a.shape[1]!==n.shape[1]||a.shape[2]!==n.shape[2];if(s){var o=vf(n.shape);o[1]=1;var u=Nn(o);n=pa([n,u],1);var c=vf(n.shape);c[2]=1;var d=Nn(c);n=pa([n,d],2)}return a=i?pa([a,r],3):a,n=Ot(a,n),n=Tn(n),n}var ez=function(e){jt(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("FaceRecognitionNet - load model before inference");return st(function(){var r=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],s=Cp(r,i).div(at(256)),o=FC(s,a.conv32_down);o=ka(o,3,2,"valid"),o=fs(o,a.conv32_1),o=fs(o,a.conv32_2),o=fs(o,a.conv32_3),o=Vm(o,a.conv64_down),o=fs(o,a.conv64_1),o=fs(o,a.conv64_2),o=fs(o,a.conv64_3),o=Vm(o,a.conv128_down),o=fs(o,a.conv128_1),o=fs(o,a.conv128_2),o=Vm(o,a.conv256_down),o=fs(o,a.conv256_1),o=fs(o,a.conv256_2),o=Vm(o,a.conv256_down_out);var u=o.mean([1,2]),c=xv(u,a.fc);return c})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return pt(this,void 0,void 0,function(){var a,r,i,s=this;return mt(this,function(o){switch(o.label){case 0:return[4,Da(n)];case 1:return a=o.sent(),r=st(function(){return ma(s.forwardInput(a))}),[4,Promise.all(r.map(function(u){return u.data()}))];case 2:return i=o.sent(),r.forEach(function(u){return u.dispose()}),[2,a.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Z9(n)},t.prototype.extractParams=function(n){return J9(n)},t}(Co);function BC(e,t){var n={descriptor:t};return Object.assign({},e,n)}function zC(e,t){var n={age:t};return Object.assign({},e,n)}function UC(e,t,n){var a={gender:t,genderProbability:n};return Object.assign({},e,a)}var qC=function(){function e(t){var n=t===void 0?{}:t,a=n.minFaceSize,r=n.scaleFactor,i=n.maxNumScales,s=n.scoreThresholds,o=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=a||20,this._scaleFactor=r||.709,this._maxNumScales=i||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=o,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function tz(e,t){function n(u,c){var d=Sr(e(9*u),[3,3,u,1]),h=ia(e(u)),p=ia(e(u)),f=ia(e(u)),g=ia(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:d,batch_norm_scale:h,batch_norm_offset:p,batch_norm_mean:f,batch_norm_variance:g}}function a(u,c,d,h,p){var f=Sr(e(u*c*d*d),[d,d,u,c]),g=ia(e(c));return t.push({paramPath:h+"/filters"},{paramPath:h+"/"+(p?"batch_norm_offset":"bias")}),{filters:f,bias:g}}function r(u,c,d,h){var p=a(u,c,d,h,!0),f=p.filters,g=p.bias;return{filters:f,batch_norm_offset:g}}function i(u,c,d){var h=n(u,d+"/depthwise_conv"),p=r(u,c,1,d+"/pointwise_conv");return{depthwise_conv:h,pointwise_conv:p}}function s(){var u=r(3,32,3,"mobilenetv1/conv_0"),c=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),h=i(128,128,"mobilenetv1/conv_3"),p=i(128,256,"mobilenetv1/conv_4"),f=i(256,256,"mobilenetv1/conv_5"),g=i(256,512,"mobilenetv1/conv_6"),b=i(512,512,"mobilenetv1/conv_7"),w=i(512,512,"mobilenetv1/conv_8"),m=i(512,512,"mobilenetv1/conv_9"),x=i(512,512,"mobilenetv1/conv_10"),y=i(512,512,"mobilenetv1/conv_11"),N=i(512,1024,"mobilenetv1/conv_12"),S=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:c,conv_2:d,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:b,conv_8:w,conv_9:m,conv_10:x,conv_11:y,conv_12:N,conv_13:S}}function o(){var u=r(1024,256,1,"prediction_layer/conv_0"),c=r(256,512,3,"prediction_layer/conv_1"),d=r(512,128,1,"prediction_layer/conv_2"),h=r(128,256,3,"prediction_layer/conv_3"),p=r(256,128,1,"prediction_layer/conv_4"),f=r(128,256,3,"prediction_layer/conv_5"),g=r(256,64,1,"prediction_layer/conv_6"),b=r(64,128,3,"prediction_layer/conv_7"),w=a(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=a(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),x=a(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),y=a(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),N=a(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),S=a(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),T=a(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=a(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),A=a(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),R=a(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),L=a(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),j=a(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),D={box_encoding_predictor:w,class_predictor:m},B={box_encoding_predictor:x,class_predictor:y},z={box_encoding_predictor:N,class_predictor:S},U={box_encoding_predictor:T,class_predictor:C},I={box_encoding_predictor:A,class_predictor:R},F={box_encoding_predictor:L,class_predictor:j};return{conv_0:u,conv_1:c,conv_2:d,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:b,box_predictor_0:D,box_predictor_1:B,box_predictor_2:z,box_predictor_3:U,box_predictor_4:I,box_predictor_5:F}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:o}}function nz(e){var t=[],n=Eo(e),a=n.extractWeights,r=n.getRemainingWeights,i=tz(a,t),s=i.extractMobilenetV1Params,o=i.extractPredictionLayerParams,u=s(),c=o(),d=Y2(a(5118*4),[1,5118,4]),h={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:h},paramMappings:t}}function az(e,t){var n=Ul(e,t);function a(c,d,h){var p=n(c+"/Conv2d_"+d+"_pointwise/weights",4,h+"/filters"),f=n(c+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,h+"/batch_norm_offset");return{filters:p,batch_norm_offset:f}}function r(c){var d="mobilenetv1/conv_"+c,h="MobilenetV1/Conv2d_"+c+"_depthwise",p=d+"/depthwise_conv",f=d+"/pointwise_conv",g=n(h+"/depthwise_weights",4,p+"/filters"),b=n(h+"/BatchNorm/gamma",1,p+"/batch_norm_scale"),w=n(h+"/BatchNorm/beta",1,p+"/batch_norm_offset"),m=n(h+"/BatchNorm/moving_mean",1,p+"/batch_norm_mean"),x=n(h+"/BatchNorm/moving_variance",1,p+"/batch_norm_variance");return{depthwise_conv:{filters:g,batch_norm_scale:b,batch_norm_offset:w,batch_norm_mean:m,batch_norm_variance:x},pointwise_conv:a("MobilenetV1",c,f)}}function i(){return{conv_0:a("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:r(1),conv_2:r(2),conv_3:r(3),conv_4:r(4),conv_5:r(5),conv_6:r(6),conv_7:r(7),conv_8:r(8),conv_9:r(9),conv_10:r(10),conv_11:r(11),conv_12:r(12),conv_13:r(13)}}function s(c,d){var h=n(c+"/weights",4,d+"/filters"),p=n(c+"/biases",1,d+"/bias");return{filters:h,bias:p}}function o(c){var d=s("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),h=s("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor");return{box_encoding_predictor:d,class_predictor:h}}function u(){return{conv_0:a("Prediction",0,"prediction_layer/conv_0"),conv_1:a("Prediction",1,"prediction_layer/conv_1"),conv_2:a("Prediction",2,"prediction_layer/conv_2"),conv_3:a("Prediction",3,"prediction_layer/conv_3"),conv_4:a("Prediction",4,"prediction_layer/conv_4"),conv_5:a("Prediction",5,"prediction_layer/conv_5"),conv_6:a("Prediction",6,"prediction_layer/conv_6"),conv_7:a("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function rz(e){var t=[],n=az(e,t),a=n.extractMobilenetV1Params,r=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Nv(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var s={mobilenetv1:a(),prediction_layer:r(),output_layer:{extra_dim:i}};return Ao(e,t),{params:s,paramMappings:t}}function ms(e,t,n){return st(function(){var a=Di(e,t.filters,n,"same");return a=Ot(a,t.batch_norm_offset),sw(a,0,6)})}var iz=.0010000000474974513;function sz(e,t,n){return st(function(){var a=vv(e,t.filters,n,"same");return a=M6(a,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,iz),sw(a,0,6)})}function oz(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function lz(e,t){return st(function(){var n=null,a=ms(e,t.conv_0,[2,2]),r=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(r.forEach(function(i,s){var o=s+1,u=oz(o);a=sz(a,i.depthwise_conv,u),a=ms(a,i.pointwise_conv,[1,1]),o===11&&(n=a)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:a,conv11:n}})}function uz(e,t,n,a,r){var i=e.shape[0],s=Math.min(n,i),o=t.map(function(d,h){return{score:d,boxIndex:h}}).filter(function(d){return d.score>r}).sort(function(d,h){return h.score-d.score}),u=function(d){return d<=a?1:0},c=[];return o.forEach(function(d){if(!(c.length>=s)){for(var h=d.score,p=c.length-1;p>=0;--p){var f=cz(e,d.boxIndex,c[p]);if(f!==0&&(d.score*=u(f),d.score<=r))break}h===d.score&&c.push(d.boxIndex)}}),c}function cz(e,t,n){var a=e.arraySync(),r=Math.min(a[t][0],a[t][2]),i=Math.min(a[t][1],a[t][3]),s=Math.max(a[t][0],a[t][2]),o=Math.max(a[t][1],a[t][3]),u=Math.min(a[n][0],a[n][2]),c=Math.min(a[n][1],a[n][3]),d=Math.max(a[n][0],a[n][2]),h=Math.max(a[n][1],a[n][3]),p=(s-r)*(o-i),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;var g=Math.max(r,u),b=Math.max(i,c),w=Math.min(s,d),m=Math.min(o,h),x=Math.max(w-g,0)*Math.max(m-b,0);return x/(p+f-x)}function dz(e){var t=ma(Ll(e,[1,0])),n=[xa(t[2],t[0]),xa(t[3],t[1])],a=[Ot(t[0],Vi(n[0],at(2))),Ot(t[1],Vi(n[1],at(2)))];return{sizes:n,centers:a}}function hz(e,t){var n=dz(e),a=n.sizes,r=n.centers,i=ma(Ll(t,[1,0])),s=Vi(tr(cy(Vi(i[2],at(5))),a[0]),at(2)),o=Ot(tr(Vi(i[0],at(10)),a[0]),r[0]),u=Vi(tr(cy(Vi(i[3],at(5))),a[1]),at(2)),c=Ot(tr(Vi(i[1],at(10)),a[1]),r[1]);return Ll(ei([xa(o,s),xa(c,u),Ot(o,s),Ot(c,u)]),[1,0])}function fz(e,t,n){return st(function(){var a=e.shape[0],r=hz(Ki(md(n.extra_dim,[a,1,1]),[-1,4]),Ki(e,[-1,4]));r=Ki(r,[a,r.shape[0]/a,4]);var i=T6(Ps(t,[0,0,1],[-1,-1,-1])),s=Ps(i,[0,0,0],[-1,-1,1]);s=Ki(s,[a,s.shape[1]]);var o=ma(r),u=ma(s);return{boxes:o,scores:u}})}function Tc(e,t){return st(function(){var n=e.shape[0],a=Ki(Yi(e,t.box_encoding_predictor),[n,-1,1,4]),r=Ki(Yi(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:a,classPrediction:r}})}function pz(e,t,n){return st(function(){var a=ms(e,n.conv_0,[1,1]),r=ms(a,n.conv_1,[2,2]),i=ms(r,n.conv_2,[1,1]),s=ms(i,n.conv_3,[2,2]),o=ms(s,n.conv_4,[1,1]),u=ms(o,n.conv_5,[2,2]),c=ms(u,n.conv_6,[1,1]),d=ms(c,n.conv_7,[2,2]),h=Tc(t,n.box_predictor_0),p=Tc(e,n.box_predictor_1),f=Tc(r,n.box_predictor_2),g=Tc(s,n.box_predictor_3),b=Tc(u,n.box_predictor_4),w=Tc(d,n.box_predictor_5),m=pa([h.boxPredictionEncoding,p.boxPredictionEncoding,f.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,w.boxPredictionEncoding],1),x=pa([h.classPrediction,p.classPrediction,f.classPrediction,g.classPrediction,b.classPrediction,w.classPrediction],1);return{boxPredictions:m,classPredictions:x}})}var Cv=function(){function e(t){var n=t===void 0?{}:t,a=n.minConfidence,r=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=a||.5,this._maxResults=r||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),HC=function(e){jt(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("SsdMobilenetv1 - load model before inference");return st(function(){var r=n.toBatchTensor(512,!1).toFloat(),i=xa(tr(r,at(.007843137718737125)),at(1)),s=lz(i,a.mobilenetv1),o=pz(s.out,s.conv11,a.prediction_layer),u=o.boxPredictions,c=o.classPredictions;return fz(u,c,a.output_layer)})},t.prototype.forward=function(n){return pt(this,void 0,void 0,function(){var a;return mt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Da(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.locateFaces=function(n,a){return a===void 0&&(a={}),pt(this,void 0,void 0,function(){var r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,T,C,A;return mt(this,function(R){switch(R.label){case 0:return r=new Cv(a),i=r.maxResults,s=r.minConfidence,[4,Da(n)];case 1:for(o=R.sent(),u=this.forwardInput(o),c=u.boxes,d=u.scores,h=c[0],p=d[0],f=1;f<c.length;f++)c[f].dispose(),d[f].dispose();return w=(b=Array).from,[4,p.data()];case 2:return g=w.apply(b,[R.sent()]),m=.5,x=uz(h,g,i,m,s),y=o.getReshapedInputDimensions(0),N=o.inputSize,S=N/y.width,T=N/y.height,C=h.arraySync(),A=x.map(function(L){var j=[Math.max(0,C[L][0]),Math.min(1,C[L][2])].map(function(F){return F*T}),D=j[0],B=j[1],z=[Math.max(0,C[L][1]),Math.min(1,C[L][3])].map(function(F){return F*S}),U=z[0],I=z[1];return new es(g[L],new kw(U,D,I-U,B-D),{height:o.getInputHeight(0),width:o.getInputWidth(0)})}),h.dispose(),p.dispose(),[2,A]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return rz(n)},t.prototype.extractParams=function(n){return nz(n)},t}(Co);(function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(HC);var mz=.4,gz=[new Qt(.738768,.874946),new Qt(2.42204,2.65704),new Qt(4.30971,7.04493),new Qt(10.246,4.59428),new Qt(12.6868,11.8741)],vz=[new Qt(1.603231,2.094468),new Qt(6.041143,7.080126),new Qt(2.882459,3.518061),new Qt(4.266906,5.178857),new Qt(9.041765,10.66308)],xz=[117.001,114.697,97.404],bz="tiny_yolov2_model",yz="tiny_yolov2_separable_conv_model",Km=function(e){return typeof e=="number"};function wz(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Km(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return Km(t.x)&&Km(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(Km)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function Lw(e){return st(function(){var t=tr(e,at(.10000000149011612));return Ot(Tn(xa(e,t)),t)})}function Vo(e,t){return st(function(){var n=Gu(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Di(n,t.conv.filters,[1,1],"valid"),n=xa(n,t.bn.sub),n=tr(n,t.bn.truediv),n=Ot(n,t.conv.bias),Lw(n)})}function Ko(e,t){return st(function(){var n=Gu(e,[[0,0],[1,1],[1,1],[0,0]]);return n=cw(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ot(n,t.bias),Lw(n)})}function Nz(e,t){var n=_v(e,t);function a(s,o){var u=ia(e(s)),c=ia(e(s));return t.push({paramPath:o+"/sub"},{paramPath:o+"/truediv"}),{sub:u,truediv:c}}function r(s,o,u){var c=n(s,o,3,u+"/conv"),d=a(o,u+"/bn");return{conv:c,bn:d}}var i=Dw(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:r,extractSeparableConvParams:i}}function kz(e,t,n,a){var r=Eo(e),i=r.extractWeights,s=r.getRemainingWeights,o=[],u=Nz(i,o),c=u.extractConvParams,d=u.extractConvWithBatchNormParams,h=u.extractSeparableConvParams,p;if(t.withSeparableConvs){var f=a[0],g=a[1],b=a[2],w=a[3],m=a[4],x=a[5],y=a[6],N=a[7],S=a[8],T=t.isFirstLayerConv2d?c(f,g,3,"conv0"):h(f,g,"conv0"),C=h(g,b,"conv1"),A=h(b,w,"conv2"),R=h(w,m,"conv3"),L=h(m,x,"conv4"),j=h(x,y,"conv5"),D=N?h(y,N,"conv6"):void 0,B=S?h(N,S,"conv7"):void 0,z=c(S||N||y,5*n,1,"conv8");p={conv0:T,conv1:C,conv2:A,conv3:R,conv4:L,conv5:j,conv6:D,conv7:B,conv8:z}}else{var f=a[0],g=a[1],b=a[2],w=a[3],m=a[4],x=a[5],y=a[6],N=a[7],S=a[8],T=d(f,g,"conv0"),C=d(g,b,"conv1"),A=d(b,w,"conv2"),R=d(w,m,"conv3"),L=d(m,x,"conv4"),j=d(x,y,"conv5"),D=d(y,N,"conv6"),B=d(N,S,"conv7"),z=c(S,5*n,1,"conv8");p={conv0:T,conv1:C,conv2:A,conv3:R,conv4:L,conv5:j,conv6:D,conv7:B,conv8:z}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:p,paramMappings:o}}function Sz(e,t){var n=Ul(e,t);function a(o){var u=n(o+"/sub",1),c=n(o+"/truediv",1);return{sub:u,truediv:c}}function r(o){var u=n(o+"/filters",4),c=n(o+"/bias",1);return{filters:u,bias:c}}function i(o){var u=r(o+"/conv"),c=a(o+"/bn");return{conv:u,bn:c}}var s=Tw(n);return{extractConvParams:r,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function _z(e,t){var n=[],a=Sz(e,n),r=a.extractConvParams,i=a.extractConvWithBatchNormParams,s=a.extractSeparableConvParams,o;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;o={conv0:t.isFirstLayerConv2d?r("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:r("conv8")}}else o={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:r("conv8")};return Ao(e,n),{params:o,paramMappings:n}}var l4;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(l4||(l4={}));var Pw=function(){function e(t){var n=t===void 0?{}:t,a=n.inputSize,r=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=a||416,this._scoreThreshold=r||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),WC=function(e){jt(t,e);function t(n){var a=e.call(this,"TinyYolov2")||this;return wz(n),a._config=n,a}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,a){var r=Vo(n,a.conv0);return r=ka(r,[2,2],[2,2],"same"),r=Vo(r,a.conv1),r=ka(r,[2,2],[2,2],"same"),r=Vo(r,a.conv2),r=ka(r,[2,2],[2,2],"same"),r=Vo(r,a.conv3),r=ka(r,[2,2],[2,2],"same"),r=Vo(r,a.conv4),r=ka(r,[2,2],[2,2],"same"),r=Vo(r,a.conv5),r=ka(r,[2,2],[1,1],"same"),r=Vo(r,a.conv6),r=Vo(r,a.conv7),Yi(r,a.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,a){var r=this.config.isFirstLayerConv2d?Lw(Yi(n,a.conv0,"valid",!1)):Ko(n,a.conv0);return r=ka(r,[2,2],[2,2],"same"),r=Ko(r,a.conv1),r=ka(r,[2,2],[2,2],"same"),r=Ko(r,a.conv2),r=ka(r,[2,2],[2,2],"same"),r=Ko(r,a.conv3),r=ka(r,[2,2],[2,2],"same"),r=Ko(r,a.conv4),r=ka(r,[2,2],[2,2],"same"),r=Ko(r,a.conv5),r=ka(r,[2,2],[1,1],"same"),r=a.conv6?Ko(r,a.conv6):r,r=a.conv7?Ko(r,a.conv7):r,Yi(r,a.conv8,"valid",!1)},t.prototype.forwardInput=function(n,a){var r=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return st(function(){var s=n.toBatchTensor(a,!1).toFloat();return s=r.config.meanRgb?Cp(s,r.config.meanRgb):s,s=s.div(at(256)),r.config.withSeparableConvs?r.runMobilenet(s,i):r.runTinyYolov2(s,i)})},t.prototype.forward=function(n,a){return pt(this,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Da(n)];case 1:return[4,r.apply(this,[i.sent(),a])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,a){return a===void 0&&(a={}),pt(this,void 0,void 0,function(){var r,i,s,o,u,c,d,h,p,f,g,b,w,m,x=this;return mt(this,function(y){switch(y.label){case 0:return r=new Pw(a),i=r.inputSize,s=r.scoreThreshold,[4,Da(n)];case 1:return o=y.sent(),[4,this.forwardInput(o,i)];case 2:return u=y.sent(),c=st(function(){return ma(u)[0].expandDims()}),d={width:o.getInputWidth(0),height:o.getInputHeight(0)},[4,this.extractBoxes(c,o.getReshapedInputDimensions(0),s)];case 3:return h=y.sent(),u.dispose(),c.dispose(),p=h.map(function(N){return N.box}),f=h.map(function(N){return N.score}),g=h.map(function(N){return N.classScore}),b=h.map(function(N){return x.config.classes[N.label]}),w=Wf(p.map(function(N){return N.rescale(i)}),f,this.config.iouThreshold,!0),m=w.map(function(N){return new mC(f[N],g[N],b[N],p[N],d)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return _z(n,this.config)},t.prototype.extractParams=function(n){var a=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=a?a.length:void 0;if(r!==7&&r!==8&&r!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return kz(n,this.config,this.boxEncodingSize,a)},t.prototype.extractBoxes=function(n,a,r){return pt(this,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,T,C,A,R,L,j,D,B,z,U,I,F,q=this;return mt(this,function(O){switch(O.label){case 0:return i=a.width,s=a.height,o=Math.max(i,s),u=o/i,c=o/s,d=n.shape[1],h=this.config.anchors.length,p=st(function(){var $=n.reshape([d,d,h,q.boxEncodingSize]),Z=$.slice([0,0,0,0],[d,d,h,4]),P=$.slice([0,0,0,4],[d,d,h,1]),W=q.withClassScores?_o($.slice([0,0,0,5],[d,d,h,q.config.classes.length]),3):at(0);return[Z,P,W]}),f=p[0],g=p[1],b=p[2],w=[],[4,g.array()];case 1:return m=O.sent(),[4,f.array()];case 2:x=O.sent(),y=0,O.label=3;case 3:if(!(y<d))return[3,12];N=0,O.label=4;case 4:if(!(N<d))return[3,11];S=0,O.label=5;case 5:return S<h?(T=Tb(m[y][N][S][0]),!r||T>r?(C=(N+Tb(x[y][N][S][0]))/d*u,A=(y+Tb(x[y][N][S][1]))/d*c,R=Math.exp(x[y][N][S][2])*this.config.anchors[S].x/d*u,L=Math.exp(x[y][N][S][3])*this.config.anchors[S].y/d*c,j=C-R/2,D=A-L/2,B={row:y,col:N,anchor:S},this.withClassScores?[4,this.extractPredictedClass(b,B)]:[3,7]):[3,9]):[3,10];case 6:return F=O.sent(),[3,8];case 7:F={classScore:1,label:0},O.label=8;case 8:z=F,U=z.classScore,I=z.label,w.push(Ya({box:new kv(j,D,j+R,D+L),score:T,classScore:T*U,label:I},B)),O.label=9;case 9:return S++,[3,5];case 10:return N++,[3,4];case 11:return y++,[3,3];case 12:return f.dispose(),g.dispose(),b.dispose(),[2,w]}})})},t.prototype.extractPredictedClass=function(n,a){return pt(this,void 0,void 0,function(){var r,i,s,o;return mt(this,function(u){switch(u.label){case 0:return r=a.row,i=a.col,s=a.anchor,[4,n.array()];case 1:return o=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,d){return o[r][i][s][d]}).map(function(c,d){return{classScore:c,label:d}}).reduce(function(c,d){return c.classScore>d.classScore?c:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Co),jz=function(e){jt(t,e);function t(n){n===void 0&&(n=!0);var a=this,r=Object.assign({},{withSeparableConvs:n,iouThreshold:mz,classes:["face"]},n?{anchors:vz,meanRgb:xz}:{anchors:gz,withClassScores:!0});return a=e.call(this,r)||this,a}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,a){return pt(this,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return[4,this.detect(n,a)];case 1:return r=i.sent(),[2,r.map(function(s){return new es(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?yz:bz},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(WC),GC=function(e){jt(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(Pw),Ap=function(){function e(){}return e.prototype.then=function(t){return pt(this,void 0,void 0,function(){var n;return mt(this,function(a){switch(a.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[a.sent()])]}})})},e.prototype.run=function(){return pt(this,void 0,void 0,function(){return mt(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Av(e,t,n,a,r){return r===void 0&&(r=function(i){var s=i.alignedRect;return s}),pt(this,void 0,void 0,function(){var i,s,o,u,c;return mt(this,function(d){switch(d.label){case 0:return i=e.map(function(h){return LC(h)?r(h):h.detection}),o=a,o?[3,5]:t instanceof Dn?[4,Aw(t,i)]:[3,2];case 1:return u=d.sent(),[3,4];case 2:return[4,Cw(t,i)];case 3:u=d.sent(),d.label=4;case 4:o=u,d.label=5;case 5:return s=o,[4,n(s)];case 6:return c=d.sent(),s.forEach(function(h){return h instanceof Dn&&h.dispose()}),[2,c]}})})}function Mw(e,t,n,a,r){return pt(this,void 0,void 0,function(){var i=this;return mt(this,function(s){return[2,Av([e],t,function(o){return pt(i,void 0,void 0,function(){return mt(this,function(u){return[2,n(o[0])]})})},a,r)]})})}function Cz(e){return st(function(){return ei(ma(e,3).reverse(),3)})}var $m=2,C0=12;function Az(e,t){var n=_v(e,t),a=Ew(e,t);function r(c,d){var h=ia(e(c));return t.push({paramPath:d}),h}function i(c,d,h){h===void 0&&(h=!1);var p=n(c[0],c[1],3,d+"/conv1"),f=r(c[1],d+"/prelu1_alpha"),g=n(c[1],c[2],3,d+"/conv2"),b=r(c[2],d+"/prelu2_alpha"),w=n(c[2],c[3],h?2:3,d+"/conv3"),m=r(c[3],d+"/prelu3_alpha");return{conv1:p,prelu1_alpha:f,conv2:g,prelu2_alpha:b,conv3:w,prelu3_alpha:m}}function s(){var c=i([3,10,16,32],"pnet"),d=n(32,2,1,"pnet/conv4_1"),h=n(32,4,1,"pnet/conv4_2");return Ya(Ya({},c),{conv4_1:d,conv4_2:h})}function o(){var c=i([3,28,48,64],"rnet",!0),d=a(576,128,"rnet/fc1"),h=r(128,"rnet/prelu4_alpha"),p=a(128,2,"rnet/fc2_1"),f=a(128,4,"rnet/fc2_2");return Ya(Ya({},c),{fc1:d,prelu4_alpha:h,fc2_1:p,fc2_2:f})}function u(){var c=i([3,32,64,64],"onet"),d=n(64,128,2,"onet/conv4"),h=r(128,"onet/prelu4_alpha"),p=a(1152,256,"onet/fc1"),f=r(256,"onet/prelu5_alpha"),g=a(256,2,"onet/fc2_1"),b=a(256,4,"onet/fc2_2"),w=a(256,10,"onet/fc2_3");return Ya(Ya({},c),{conv4:d,prelu4_alpha:h,fc1:p,prelu5_alpha:f,fc2_1:g,fc2_2:b,fc2_3:w})}return{extractPNetParams:s,extractRNetParams:o,extractONetParams:u}}function Ez(e){var t=Eo(e),n=t.extractWeights,a=t.getRemainingWeights,r=[],i=Az(n,r),s=i.extractPNetParams,o=i.extractRNetParams,u=i.extractONetParams,c=s(),d=o(),h=u();if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{pnet:c,rnet:d,onet:h},paramMappings:r}}function Dz(e,t){var n=Ul(e,t);function a(d){var h=n(d+"/weights",4,d+"/filters"),p=n(d+"/bias",1);return{filters:h,bias:p}}function r(d){var h=n(d+"/weights",2),p=n(d+"/bias",1);return{weights:h,bias:p}}function i(d){return n(d,1)}function s(d){var h=a(d+"/conv1"),p=i(d+"/prelu1_alpha"),f=a(d+"/conv2"),g=i(d+"/prelu2_alpha"),b=a(d+"/conv3"),w=i(d+"/prelu3_alpha");return{conv1:h,prelu1_alpha:p,conv2:f,prelu2_alpha:g,conv3:b,prelu3_alpha:w}}function o(){var d=s("pnet"),h=a("pnet/conv4_1"),p=a("pnet/conv4_2");return Ya(Ya({},d),{conv4_1:h,conv4_2:p})}function u(){var d=s("rnet"),h=r("rnet/fc1"),p=i("rnet/prelu4_alpha"),f=r("rnet/fc2_1"),g=r("rnet/fc2_2");return Ya(Ya({},d),{fc1:h,prelu4_alpha:p,fc2_1:f,fc2_2:g})}function c(){var d=s("onet"),h=a("onet/conv4"),p=i("onet/prelu4_alpha"),f=r("onet/fc1"),g=i("onet/prelu5_alpha"),b=r("onet/fc2_1"),w=r("onet/fc2_2"),m=r("onet/fc2_3");return Ya(Ya({},d),{conv4:h,prelu4_alpha:p,fc1:f,prelu5_alpha:g,fc2_1:b,fc2_2:w,fc2_3:m})}return{extractPNetParams:o,extractRNetParams:u,extractONetParams:c}}function Tz(e){var t=[],n=Dz(e,t),a=n.extractPNetParams,r=n.extractRNetParams,i=n.extractONetParams,s=a(),o=r(),u=i();return Ao(e,t),{params:{pnet:s,rnet:o,onet:u},paramMappings:t}}function xy(e,t){var n=t[0],a=t[1];return{height:Math.floor(n*e),width:Math.floor(a*e)}}function Rz(e,t,n){for(var a=n[0],r=n[1],i=C0/e,s=[],o=Math.min(a,r)*i,u=0;o>=12;)s.push(i*Math.pow(t,u)),o=o*t,u+=1;return s}var Iw=function(e){jt(t,e);function t(n,a,r,i){return e.call(this,{left:n,top:a,right:r,bottom:i},!0)||this}return t}(Pl);function VC(e){return st(function(){return tr(xa(e,at(127.5)),at(.0078125))})}function yd(e,t){return st(function(){return Ot(Tn(e),tr(t,w0(Tn(w0(e)))))})}function Ow(e,t,n){return n===void 0&&(n=!1),st(function(){var a=Yi(e,t.conv1,"valid");return a=yd(a,t.prelu1_alpha),a=ka(a,n?[2,2]:[3,3],[2,2],"same"),a=Yi(a,t.conv2,"valid"),a=yd(a,t.prelu2_alpha),a=n?a:ka(a,[3,3],[2,2],"valid"),a=Yi(a,t.conv3,"valid"),a=yd(a,t.prelu3_alpha),a})}function Lz(e,t){return st(function(){var n=Ow(e,t,!0),a=Yi(n,t.conv4_1,"valid"),r=xi(bv(a,3),3),i=_o(xa(a,r),3),s=Yi(n,t.conv4_2,"valid");return{prob:i,regions:s}})}function Pz(e,t){return st(function(){var n=xy(t,e.shape.slice(1)),a=n.height,r=n.width,i=mw.resizeBilinear(e,[a,r]),s=VC(i);return Ll(s,[0,2,1,3])})}function Mz(e,t,n,a){for(var r=[],i=e.arraySync(),s=0;s<e.shape[0];s++)for(var o=0;o<e.shape[1];o++)i[s][o]>=a&&r.push(new Qt(o,s));var u=r.map(function(c){var d=new kv(Math.round((c.y*$m+1)/n),Math.round((c.x*$m+1)/n),Math.round((c.y*$m+C0)/n),Math.round((c.x*$m+C0)/n)),h=i[c.y][c.x],p=t.arraySync(),f=new Iw(p[c.y][c.x][0],p[c.y][c.x][1],p[c.y][c.x][2],p[c.y][c.x][3]);return{cell:d,score:h,region:f}});return u}function Iz(e,t,n,a,r){r.stage1=[];var i=t.map(function(p){return st(function(){var f={scale:p},g=Pz(e,p),b=Date.now(),w=Lz(g,a),m=w.prob,x=w.regions;f.pnet=Date.now()-b;var y=ma(ma(m,3)[1])[0],N=ma(x)[0];return{scoresTensor:y,regionsTensor:N,scale:p,statsForScale:f}})}),s=i.map(function(p){var f=p.scoresTensor,g=p.regionsTensor,b=p.scale,w=p.statsForScale,m=Mz(f,g,b,n);if(f.dispose(),g.dispose(),!m.length)return r.stage1.push(w),[];var x=Date.now(),y=Wf(m.map(function(N){return N.cell}),m.map(function(N){return N.score}),.5);return w.nms=Date.now()-x,w.numBoxes=y.length,r.stage1.push(w),y.map(function(N){return m[N]})}),o=s.reduce(function(p,f){return p.concat(f)},[]),u=[],c=[];if(o.length>0){var d=Date.now(),h=Wf(o.map(function(p){return p.cell}),o.map(function(p){return p.score}),.7);r.stage1_nms=Date.now()-d,c=h.map(function(p){return o[p].score}),u=h.map(function(p){return o[p]}).map(function(p){var f=p.cell,g=p.region;return new kv(f.left+g.left*f.width,f.top+g.top*f.height,f.right+g.right*f.width,f.bottom+g.bottom*f.height).toSquare().round()})}return{boxes:u,scores:c}}function KC(e,t,n){var a=n.width,r=n.height;return pt(this,void 0,void 0,function(){var i,s,o,u=this;return mt(this,function(c){switch(c.label){case 0:return i=Ou(e),[4,Promise.all(t.map(function(d){return pt(u,void 0,void 0,function(){var h,p,f,g,b,w,m,x;return mt(this,function(y){return h=d.padAtBorders(e.height,e.width),p=h.y,f=h.ey,g=h.x,b=h.ex,w=g-1,m=p-1,x=i.getImageData(w,m,b-w,f-m),[2,ir.isNodejs()?jw(x):createImageBitmap(x)]})})}))];case 1:return s=c.sent(),o=[],s.forEach(function(d){var h=Sv({width:a,height:r}),p=Ou(h);p.drawImage(d,0,0,a,r);for(var f=p.getImageData(0,0,a,r).data,g=[],b=0;b<f.length;b+=4)g.push(f[b+2]),g.push(f[b+1]),g.push(f[b]);o.push(g)}),[2,o.map(function(d){var h=st(function(){var p=Ll(Sr(d,[1,a,r,3]),[0,2,1,3]).toFloat();return VC(p)});return h})]}})})}function Oz(e,t){return st(function(){var n=Ow(e,t),a=Ki(n,[n.shape[0],t.fc1.weights.shape[0]]),r=Ss(a,t.fc1),i=yd(r,t.prelu4_alpha),s=Ss(i,t.fc2_1),o=xi(bv(s,1),1),u=_o(xa(s,o),1),c=Ss(i,t.fc2_2),d=ma(u,1)[1];return{scores:d,regions:c}})}function Fz(e,t,n,a,r){return pt(this,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g,b,w,m,x;return mt(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,KC(e,t,{width:24,height:24})];case 1:return s=y.sent(),r.stage2_extractImagePatches=Date.now()-i,i=Date.now(),o=s.map(function(N){var S=Oz(N,a);return N.dispose(),S}),r.stage2_rnet=Date.now()-i,u=o.length>1?pa(o.map(function(N){return N.scores})):o[0].scores,h=(d=Array).from,[4,u.data()];case 2:return c=h.apply(d,[y.sent()]),u.dispose(),p=c.map(function(N,S){return{score:N,idx:S}}).filter(function(N){return N.score>n}).map(function(N){var S=N.idx;return S}),f=p.map(function(N){return t[N]}),g=p.map(function(N){return c[N]}),b=[],w=[],f.length>0&&(i=Date.now(),m=Wf(f,g,.7),r.stage2_nms=Date.now()-i,x=m.map(function(N){var S=o[p[N]].regions.arraySync();return new Iw(S[0][0],S[0][1],S[0][2],S[0][3])}),w=m.map(function(N){return g[N]}),b=m.map(function(N,S){return f[N].calibrate(x[S])})),o.forEach(function(N){N.regions.dispose(),N.scores.dispose()}),[2,{boxes:b,scores:w}]}})})}function Bz(e,t){return st(function(){var n=Ow(e,t);n=ka(n,[2,2],[2,2],"same"),n=Yi(n,t.conv4,"valid"),n=yd(n,t.prelu4_alpha);var a=Ki(n,[n.shape[0],t.fc1.weights.shape[0]]),r=Ss(a,t.fc1),i=yd(r,t.prelu5_alpha),s=Ss(i,t.fc2_1),o=xi(bv(s,1),1),u=_o(xa(s,o),1),c=Ss(i,t.fc2_2),d=Ss(i,t.fc2_3),h=ma(u,1)[1];return{scores:h,regions:c,points:d}})}function zz(e,t,n,a,r){return pt(this,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g,b,w,m,x,y;return mt(this,function(N){switch(N.label){case 0:return i=Date.now(),[4,KC(e,t,{width:48,height:48})];case 1:return s=N.sent(),r.stage3_extractImagePatches=Date.now()-i,i=Date.now(),o=s.map(function(S){var T=Bz(S,a);return S.dispose(),T}),r.stage3_onet=Date.now()-i,u=o.length>1?pa(o.map(function(S){return S.scores})):o[0].scores,h=(d=Array).from,[4,u.data()];case 2:return c=h.apply(d,[N.sent()]),u.dispose(),p=c.map(function(S,T){return{score:S,idx:T}}).filter(function(S){return S.score>n}).map(function(S){var T=S.idx;return T}),f=p.map(function(S){var T=o[S].regions.arraySync();return new Iw(T[0][0],T[0][1],T[0][2],T[0][3])}),g=p.map(function(S,T){return t[S].calibrate(f[T])}),b=p.map(function(S){return c[S]}),w=[],m=[],x=[],g.length>0&&(i=Date.now(),y=Wf(g,b,.7,!1),r.stage3_nms=Date.now()-i,w=y.map(function(S){return g[S]}),m=y.map(function(S){return b[S]}),x=y.map(function(S,T){return Array(5).fill(0).map(function(C,A){var R=o[S].points.arraySync();return new Qt(R[0][A]*(w[T].width+1)+w[T].left,R[0][A+5]*(w[T].height+1)+w[T].top)})})),o.forEach(function(S){S.regions.dispose(),S.scores.dispose(),S.points.dispose()}),[2,{boxes:w,scores:m,points:x}]}})})}var Uz=function(e){jt(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return pt(this,void 0,void 0,function(){return mt(this,function(a){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return pt(this,void 0,void 0,function(){return mt(this,function(a){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,a){return a===void 0&&(a={}),pt(this,void 0,void 0,function(){var r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,T,C,A;return mt(this,function(R){switch(R.label){case 0:if(r=this.params,!r)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},o=Date.now(),u=st(function(){return Cz(xi(ww.fromPixels(i)).toFloat())}),c=function(L){return u.dispose(),s.total=Date.now()-o,L},d=u.shape.slice(1),h=d[0],p=d[1],f=new qC(a),g=f.minFaceSize,b=f.scaleFactor,w=f.maxNumScales,m=f.scoreThresholds,x=f.scaleSteps,y=(x||Rz(g,b,[h,p])).filter(function(L){var j=xy(L,[h,p]);return Math.min(j.width,j.height)>C0}).slice(0,w),s.scales=y,s.pyramid=y.map(function(L){return xy(L,[h,p])}),N=Date.now(),[4,Iz(u,y,m[0],r.pnet,s)];case 1:return S=R.sent(),s.total_stage1=Date.now()-N,S.boxes.length?(s.stage2_numInputBoxes=S.boxes.length,N=Date.now(),[4,Fz(i,S.boxes,m[1],r.rnet,s)]):[2,c({results:[],stats:s})];case 2:return T=R.sent(),s.total_stage2=Date.now()-N,T.boxes.length?(s.stage3_numInputBoxes=T.boxes.length,N=Date.now(),[4,zz(i,T.boxes,m[2],r.onet,s)]):[2,c({results:[],stats:s})];case 3:return C=R.sent(),s.total_stage3=Date.now()-N,A=C.boxes.map(function(L,j){return jv(Vf({},new es(C.scores[j],new kw(L.left/p,L.top/h,L.width/p,L.height/h),{height:h,width:p})),new x9(C.points[j].map(function(D){return D.sub(new Qt(L.left,L.top)).div(new Qt(L.width,L.height))}),{width:L.width,height:L.height}))}),[2,c({results:A,stats:s})]}})})},t.prototype.forward=function(n,a){return a===void 0&&(a={}),pt(this,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Da(n)];case 1:return[4,r.apply(this,[i.sent(),a])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,a){return a===void 0&&(a={}),pt(this,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Da(n)];case 1:return[2,r.apply(this,[i.sent(),a])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Tz(n)},t.prototype.extractParams=function(n){return Ez(n)},t}(Co),qz=.4,Hz=[new Qt(1.603231,2.094468),new Qt(6.041143,7.080126),new Qt(2.882459,3.518061),new Qt(4.266906,5.178857),new Qt(9.041765,10.66308)],Wz=[117.001,114.697,97.404],Gz=function(e){jt(t,e);function t(){var n=this,a={withSeparableConvs:!0,iouThreshold:qz,classes:["face"],anchors:Hz,meanRgb:Wz,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,a)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,a){return pt(this,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return[4,this.detect(n,a)];case 1:return r=i.sent(),[2,r.map(function(s){return new es(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(WC),nr={ssdMobilenetv1:new HC,tinyFaceDetector:new Gz,tinyYolov2:new jz,mtcnn:new Uz,faceLandmark68Net:new IC,faceLandmark68TinyNet:new K9,faceRecognitionNet:new ez,faceExpressionNet:new P9,ageGenderNet:new H9},$C=function(e){jt(t,e);function t(n,a,r){var i=e.call(this)||this;return i.parentTask=n,i.input=a,i.extractedFaces=r,i}return t}(Ap),Fw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a,r=this;return mt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Av(n,this.input,function(s){return pt(r,void 0,void 0,function(){return mt(this,function(o){switch(o.label){case 0:return[4,Promise.all(s.map(function(u){return nr.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,o.sent()]}})})},this.extractedFaces)];case 2:return a=i.sent(),[2,n.map(function(s,o){return RC(s,a[o])})]}})})},t.prototype.withAgeAndGender=function(){return new qw(this,this.input)},t}($C),Bw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a;return mt(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return n=r.sent(),n?[4,Mw(n,this.input,function(i){return nr.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return a=r.sent(),[2,RC(n,a)]}})})},t.prototype.withAgeAndGender=function(){return new Hw(this,this.input)},t}($C),zw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Ww(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Vw(this,this.input)},t}(Fw),Uw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Gw(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Kw(this,this.input)},t}(Bw),YC=function(e){jt(t,e);function t(n,a,r){var i=e.call(this)||this;return i.parentTask=n,i.input=a,i.extractedFaces=r,i}return t}(Ap),qw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a,r=this;return mt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Av(n,this.input,function(s){return pt(r,void 0,void 0,function(){return mt(this,function(o){switch(o.label){case 0:return[4,Promise.all(s.map(function(u){return nr.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,o.sent()]}})})},this.extractedFaces)];case 2:return a=i.sent(),[2,n.map(function(s,o){var u=a[o],c=u.age,d=u.gender,h=u.genderProbability;return zC(UC(s,d,h),c)})]}})})},t.prototype.withFaceExpressions=function(){return new Fw(this,this.input)},t}(YC),Hw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a,r,i,s;return mt(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,Mw(n,this.input,function(u){return nr.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return a=o.sent(),r=a.age,i=a.gender,s=a.genderProbability,[2,zC(UC(n,i,s),r)]}})})},t.prototype.withFaceExpressions=function(){return new Bw(this,this.input)},t}(YC),Ww=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new zw(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Vw(this,this.input)},t}(qw),Gw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Uw(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Kw(this,this.input)},t}(Hw),XC=function(e){jt(t,e);function t(n,a){var r=e.call(this)||this;return r.parentTask=n,r.input=a,r}return t}(Ap),Vw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a;return mt(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return n=r.sent(),[4,Av(n,this.input,function(i){return Promise.all(i.map(function(s){return nr.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return a=r.sent(),[2,a.map(function(i,s){return BC(n[s],i)})]}})})},t.prototype.withFaceExpressions=function(){return new zw(this,this.input)},t.prototype.withAgeAndGender=function(){return new Ww(this,this.input)},t}(XC),Kw=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a;return mt(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return n=r.sent(),n?[4,Mw(n,this.input,function(i){return nr.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return a=r.sent(),[2,BC(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new Uw(this,this.input)},t.prototype.withAgeAndGender=function(){return new Gw(this,this.input)},t}(XC),JC=function(e){jt(t,e);function t(n,a,r){var i=e.call(this)||this;return i.parentTask=n,i.input=a,i.useTinyLandmarkNet=r,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?nr.faceLandmark68TinyNet:nr.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Ap),Vz=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a,r,i,s,o=this;return mt(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),a=n.map(function(c){return c.detection}),this.input instanceof Dn?[4,Aw(this.input,a)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,Cw(this.input,a)];case 4:i=u.sent(),u.label=5;case 5:return r=i,[4,Promise.all(r.map(function(c){return o.landmarkNet.detectLandmarks(c)}))];case 6:return s=u.sent(),r.forEach(function(c){return c instanceof Dn&&c.dispose()}),[2,n.map(function(c,d){return jv(c,s[d])})]}})})},t.prototype.withFaceExpressions=function(){return new zw(this,this.input)},t.prototype.withAgeAndGender=function(){return new Ww(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Vw(this,this.input)},t}(JC),Kz=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a,r,i,s;return mt(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?(a=n.detection,this.input instanceof Dn?[4,Aw(this.input,[a])]:[3,3]):[2];case 2:return i=o.sent(),[3,5];case 3:return[4,Cw(this.input,[a])];case 4:i=o.sent(),o.label=5;case 5:return r=i,[4,this.landmarkNet.detectLandmarks(r[0])];case 6:return s=o.sent(),r.forEach(function(u){return u instanceof Dn&&u.dispose()}),[2,jv(n,s)]}})})},t.prototype.withFaceExpressions=function(){return new Uw(this,this.input)},t.prototype.withAgeAndGender=function(){return new Gw(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Kw(this,this.input)},t}(JC),QC=function(e){jt(t,e);function t(n,a){a===void 0&&(a=new Cv);var r=e.call(this)||this;return r.input=n,r.options=a,r}return t}(Ap),ZC=function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a,r,i;return mt(this,function(s){switch(s.label){case 0:return n=this,a=n.input,r=n.options,r instanceof qC?[4,nr.mtcnn.forward(a,r)]:[3,2];case 1:return[2,s.sent().map(function(o){return o.detection})];case 2:if(i=r instanceof GC?function(o){return nr.tinyFaceDetector.locateFaces(o,r)}:r instanceof Cv?function(o){return nr.ssdMobilenetv1.locateFaces(o,r)}:r instanceof Pw?function(o){return nr.tinyYolov2.locateFaces(o,r)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(a)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(a){return pt(n,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return r=i.sent(),[2,a(r.map(function(s){return Vf({},s)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new Vz(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Fw(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new qw(this.runAndExtendWithFaceDetections(),this.input)},t}(QC);(function(e){jt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return pt(this,void 0,void 0,function(){var n,a;return mt(this,function(r){switch(r.label){case 0:return[4,new ZC(this.input,this.options)];case 1:return n=r.sent(),a=n[0],n.forEach(function(i){i.score>a.score&&(a=i)}),[2,a]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(a){return pt(n,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return r=i.sent(),[2,a(r?Vf({},r):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new Kz(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Bw(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new Hw(this.runAndExtendWithFaceDetection(),this.input)},t})(QC);function $z(e,t){return t===void 0&&(t=new Cv),new ZC(e,t)}function Yz(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),a=Array.from(t);return Math.sqrt(n.map(function(r,i){return r-a[i]}).reduce(function(r,i){return r+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var a=Array.isArray(t)?t:[t];if(!a.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,i=function(){return"person "+r++};this._labeledDescriptors=a.map(function(s){if(s instanceof Wm)return s;if(s instanceof Float32Array)return new Wm(i(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new Wm(i(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(a){return Yz(a,t)}).reduce(function(a,r){return a+r},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(a){var r=a.descriptors,i=a.label;return new a4(i,n.computeMeanDistance(t,r))}).reduce(function(a,r){return a.distance<r.distance?a:r})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new a4("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(a){return Wm.fromJSON(a)});return new e(n,t.distanceThreshold)},e})();function eA(e,t){var n=new ku(t.width,t.height),a=n.width,r=n.height;if(a<=0||r<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:a,height:r}));if(Array.isArray(e))return e.map(function(o){return eA(o,{width:a,height:r})});if(LC(e)){var i=e.detection.forSize(a,r),s=e.unshiftedLandmarks.forSize(i.box.width,i.box.height);return jv(Vf(e,i),s)}return gC(e)?Vf(e,e.detection.forSize(a,r)):e instanceof Gf||e instanceof es?e.forSize(a,r):e}let u4=!1,Ym=null;const Xz=async(e={})=>{const{detector:t="ssdMobilenetv1"}=e;return Ym||(u4?!0:(Ym=(async()=>{try{const n="/haris/models";console.log(`Loading face-api.js models from ${n}...`);const a=[nr.faceLandmark68Net.loadFromUri(n),nr.faceRecognitionNet.loadFromUri(n)];return t==="ssdMobilenetv1"?a.push(nr.ssdMobilenetv1.loadFromUri(n)):a.push(nr.tinyFaceDetector.loadFromUri(n)),await Promise.all(a),u4=!0,console.log(`✅ Face-api.js models (detector: ${t}) loaded successfully`),!0}catch(n){throw console.error("❌ Error loading face-api.js models:",n),console.error("Make sure model files are downloaded to /public/models/"),console.error("Download from: https://github.com/justadudewhohacks/face-api.js/tree/master/weights"),new Error("Failed to load face recognition models. Please check model files.")}})(),Ym))},tA=e=>{const{data:t,width:n,height:a}=e,r=[];[4,8,16].forEach(o=>{for(let u=0;u<a;u+=o)for(let c=0;c<n;c+=o){let d=0,h=0;for(let p=0;p<o&&u+p<a;p++)for(let f=0;f<o&&c+f<n;f++){const g=((u+p)*n+(c+f))*4,b=t[g]*.299+t[g+1]*.587+t[g+2]*.114;d+=b,h++}h>0&&r.push(Math.round(d/h))}});const s=r.join(",");return btoa(s).substring(0,128)},nA=e=>{const{data:t,width:n,height:a}=e;let r=0,i=0,s=0,o=0;const u=Math.floor(n/2),c=Math.floor(a/2);for(let y=1;y<a-1;y++)for(let N=1;N<n-1;N++){const S=(y*n+N)*4,T=(t[S]+t[S+1]+t[S+2])/3,C=(t[S-4]+t[S-3]+t[S-2])/3,A=(t[S+4]+t[S+5]+t[S+6])/3,R=(t[(y-1)*n*4+N*4]+t[(y-1)*n*4+N*4+1]+t[(y-1)*n*4+N*4+2])/3,L=(t[(y+1)*n*4+N*4]+t[(y+1)*n*4+N*4+1]+t[(y+1)*n*4+N*4+2])/3,j=Math.abs(A-C),D=Math.abs(L-R);Math.sqrt(j*j+D*D)>10&&r++;const z=Math.max(T,C,A,R,L),U=Math.min(T,C,A,R,L);if(s+=z-U,N<u){const O=n-N-1;if(O<n){const $=(y*n+O)*4,Z=(t[$]+t[$+1]+t[$+2])/3;Math.abs(T-Z)<80&&i++}}const I=Math.sqrt((N-u)**2+(y-c)**2),F=Math.sqrt(u**2+c**2),q=I/F;o+=T*(1-q)}const d=n*a,h=r/d,p=i/(d/2),f=s/d,g=o/d,b=h>.01&&h<.5,w=p>.03,m=f>5,x=g>20&&g<230;return b&&w&&m&&x},Jz=(e,t,n=.9)=>{if(console.log("Fingerprint 1 (absensi):",e),console.log("Fingerprint 2 (database):",t),!e||!t)return!1;try{const a=atob(e).split(",").map(Number),r=atob(t).split(",").map(Number);if(a.length!==r.length)return!1;const i=[];let s=0;for(let x=0;x<a.length;x++)s+=Math.pow(a[x]-r[x],2);s=Math.sqrt(s);const o=Math.sqrt(a.length*Math.pow(255,2)),u=1-s/o;i.push(u);let c=0,d=0,h=0;for(let x=0;x<a.length;x++)c+=a[x]*r[x],d+=a[x]*a[x],h+=r[x]*r[x];const p=c/(Math.sqrt(d)*Math.sqrt(h));i.push(Math.max(0,p));let f=0;const g=120;for(let x=0;x<a.length;x++)Math.abs(a[x]-r[x])<=g&&f++;const b=f/a.length;i.push(b);const w=[.05,.05,.9];let m=0;for(let x=0;x<i.length;x++)m+=i[x]*w[x];return m>=n-.15&&m<n&&console.warn("Wajah benar-benar sangat mirip, tapi belum lolos threshold. Nilai:",m.toFixed(3),"Threshold:",n),console.log("Face comparison results:",{euclidean:u.toFixed(3),cosine:p.toFixed(3),tolerance:b.toFixed(3),weighted:m.toFixed(3),threshold:n,match:m>=n}),m>=n}catch(a){return console.error("Error comparing fingerprints:",a),!1}},Qz=e=>new Promise((t,n)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{try{const r=document.createElement("canvas"),i=r.getContext("2d");r.width=400,r.height=300,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(a,0,0,r.width,r.height);const s=Zz(r);if(!s){n(new Error("Gagal memproses gambar wajah"));return}const o=nA(s),u=tA(s);t({fingerprint:u,isValidFace:!0})}catch(r){n(new Error("Gagal memproses gambar: "+r.message))}},a.onerror=()=>{n(new Error("Gagal memuat gambar dari URL"))},a.src=e}),Zz=e=>{const t=e.getContext("2d"),{width:n,height:a}=e,r=Math.min(n*.7,350),i=Math.min(a*.85,420),s=(n-r)/2,o=(a-i)/2;try{return t.getImageData(s,o,r,i)}catch(u){return console.error("Error extracting face region:",u),null}},Ev=({onFaceCapture:e,isCapturing:t=!1})=>{const n=ae.useRef(null),a=ae.useRef(null),[r,i]=ae.useState(null),[s,o]=ae.useState("Posisikan wajah Anda di dalam lingkaran."),[u,c]=ae.useState(!1),d=ae.useRef(!1),h=f=>{try{window.speechSynthesis.cancel();const g=new SpeechSynthesisUtterance(f);g.lang="id-ID",window.speechSynthesis.speak(g)}catch(g){console.error("Speech synthesis failed",g)}},p=async()=>{if(n.current){const f=n.current,g=document.createElement("canvas");g.width=f.videoWidth,g.height=f.videoHeight;const b=g.getContext("2d");b.translate(g.width,0),b.scale(-1,1),b.drawImage(f,0,0,g.width,g.height);try{const w=b.getImageData(0,0,g.width,g.height),m=nA(w);g.toBlob(async x=>{if(m){const y=tA(w);await ct.fire({icon:"success",title:"Foto Berhasil",text:"Foto wajah berhasil diambil dan diverifikasi!"}),e(x,y)}else await ct.fire({icon:"warning",title:"Fingerprint Tidak Terdeteksi",text:"Fingerprint wajah tidak terdeteksi, silakan ulangi pengambilan foto."}),e(x,null)},"image/jpeg",.95)}catch{g.toBlob(async m=>{await ct.fire({icon:"error",title:"Gagal Mengambil Foto",text:"Terjadi kesalahan saat mengambil foto."}),e(m,null)},"image/jpeg",.95)}}};return ae.useEffect(()=>{let f=null,g=null;const b=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Kamera tidak didukung oleh browser ini.");f=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}}),n.current&&(n.current.srcObject=f)}catch(y){console.error("Error accessing camera:",y),i(y.message||"Gagal mengakses kamera. Pastikan izin telah diberikan.")}},w=async()=>{const y=n.current,N=a.current;if(y&&N&&y.readyState===4){const S={width:y.clientWidth,height:y.clientHeight};(N.width!==S.width||N.height!==S.height)&&A9(N,S);const T=await $z(y,new GC({inputSize:320})).withFaceLandmarks(),C=eA(T,S),A=N.getContext("2d");A.clearRect(0,0,N.width,N.height);const R=N.width/2,L=N.height/2,j=N.width/3.5,D=N.height/2.5;if(A.beginPath(),A.ellipse(R,L,j,D,0,0,2*Math.PI),A.lineWidth=5,C.length>0){const B=C[0].detection.box,z=B.x+B.width/2,U=B.y+B.height/2,I=Math.abs(z-R)<30&&Math.abs(U-L)<40,F=B.width>100&&B.height>100;if(I&&F)A.strokeStyle="green",c(!0),d.current||(o("Wajah terdeteksi. Silakan ambil foto."),h("Wajah terdeteksi. Silakan ambil foto."),d.current=!0);else if(A.strokeStyle="yellow",c(!1),d.current){const q=F?"Posisikan wajah di tengah lingkaran.":"Mohon lebih dekat ke kamera.";o(q),h(q),d.current=!1}}else A.strokeStyle="red",c(!1),d.current&&(o("Wajah tidak terdeteksi."),h("Wajah tidak terdeteksi."),d.current=!1);A.stroke()}g=requestAnimationFrame(w)};(async()=>{try{await Xz({detector:"tinyFaceDetector"}),await b(),h("Posisikan wajah Anda di dalam lingkaran.")}catch(y){console.error("Initialization failed:",y),i("Gagal memulai kamera atau memuat model. Coba muat ulang halaman.")}})();const x=n.current;return x&&(x.onplay=()=>{w()}),()=>{f&&f.getTracks().forEach(y=>y.stop()),g&&cancelAnimationFrame(g),window.speechSynthesis.cancel()}},[]),r?l.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg text-center",children:["Error: ",r]}):l.jsxs("div",{className:"relative bg-black rounded-lg w-full max-w-md mx-auto overflow-hidden",children:[l.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",transform:"scaleX(-1)"}}),l.jsx("canvas",{ref:a,className:"absolute top-0 left-0",style:{transform:"scaleX(-1)"}}),l.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-full px-4 flex flex-col items-center",children:[l.jsx("div",{className:"bg-black bg-opacity-60 text-white text-center p-2 rounded-md mb-4",children:s}),u&&l.jsx("button",{onClick:p,disabled:t,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full disabled:bg-gray-500",children:t?"Memproses...":"Ambil Foto"})]})]})},eU=()=>{const e=hr(),[t,n]=ae.useState(1),[a,r]=ae.useState({name:"",email:"",password:"",confirmPassword:"",role:"karyawan"}),[i,s]=ae.useState(null),[o,u]=ae.useState(null),[c,d]=ae.useState(!1),[h,p]=ae.useState(null),[f,g]=ae.useState(null),b=Nd.createRef(),w=L=>{r({...a,[L.target.name]:L.target.value})},m=L=>{if(L.preventDefault(),p(null),!f){p("Silakan verifikasi bahwa Anda bukan robot dengan mencentang reCAPTCHA");return}if(a.password!==a.confirmPassword){p("Password tidak cocok");return}if(a.password.length<6){p("Password minimal 6 karakter");return}if(!ul()){p("Sistem belum dikonfigurasi. Silakan hubungi administrator untuk mengatur koneksi database.");return}a.role==="admin"?S():n(2)},x=L=>{g(L)},y=()=>{g(null)},N=(L,j)=>{s(L),u(j),console.log("✅ Face captured with custom fingerprint for registration")},S=async()=>{if(a.role!=="admin"&&(!i||!o)){p("Silakan ambil foto wajah Anda terlebih dahulu");return}d(!0),p(null);try{if(console.log("Memulai pendaftaran untuk role:",a.role),!ul())throw new Error("Sistem belum dikonfigurasi. Silakan hubungi administrator.");const{data:L,error:j}=await Te.auth.signUp({email:a.email,password:a.password,options:{data:{name:a.name,role:a.role,full_name:a.name}}});if(j)throw console.error("Auth error:",j),j.message.includes("already registered")?new Error("Email sudah terdaftar"):j.message.includes("Email rate limit exceeded")?new Error("Terlalu banyak percobaan pendaftaran. Silakan coba lagi nanti."):j.message.includes("Password should be at least")?new Error("Password minimal 6 karakter"):new Error(j.message||"Gagal mendaftar");if(!L.user)throw new Error("Pendaftaran gagal - tidak ada data user");const D=L.user.id;let B=null;if(console.log("User berhasil dibuat dengan ID:",D,"Role:",a.role),a.role!=="admin"&&i)try{const q=`${D}-face-${Date.now()}.jpg`;await Yg(i,"face-photos",q),B=Xg("face-photos",q),console.log("Foto wajah berhasil diupload:",B)}catch(q){console.error("Error upload foto:",q),console.log("Melanjutkan tanpa foto wajah")}await new Promise(q=>setTimeout(q,2e3));const z={id:D,name:a.name,full_name:a.name,email:a.email,role:a.role,title:T(a.role),bio:`${T(a.role)} di sistem absensi`,avatar_url:B,is_face_registered:a.role==="admin"?!0:!!B,status:"active",join_date:new Date().toISOString().split("T")[0],contract_start_date:new Date().toISOString().split("T")[0],contract_type:"permanent",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Membuat profil dengan data:",z);const{data:U,error:I}=await Te.from("profiles").insert([z]).select().single();if(I){console.error("Error membuat profil:",I);const{data:q,error:O}=await Te.from("profiles").update(z).eq("id",D).select().single();if(O)throw console.error("Error update profil:",O),new Error("Gagal membuat profil user: "+O.message);console.log("Profil berhasil diupdate:",q)}else console.log("Profil berhasil dibuat:",U);if(a.role==="admin"||a.role==="kepala")try{await Te.from("temp_admin_users").insert([{user_id:D,role:a.role}]),console.log("Admin/Kepala berhasil ditambahkan ke temp_admin_users")}catch(q){console.error("Error menambahkan ke temp_admin_users:",q)}await Te.auth.signOut();const F=a.role==="admin"?`Pendaftaran Administrator berhasil! Akun ${a.name} telah dibuat tanpa verifikasi wajah. Silakan masuk untuk mengakses panel admin.`:`Pendaftaran berhasil! Akun ${T(a.role)} ${a.name} telah dibuat dengan verifikasi wajah. Silakan masuk.`;e("/login",{state:{message:F,email:a.email}})}catch(L){console.error("Error pendaftaran:",L);let j="Terjadi kesalahan saat mendaftar";L.message.includes("Email sudah terdaftar")?j="Email sudah terdaftar. Silakan gunakan email lain atau masuk dengan akun yang sudah ada.":L.message.includes("Password minimal")?j="Password minimal 6 karakter":L.message.includes("rate limit")?j="Terlalu banyak percobaan. Silakan coba lagi dalam beberapa menit.":L.message.includes("Sistem belum dikonfigurasi")?j="Sistem belum dikonfigurasi. Silakan hubungi administrator untuk mengatur koneksi database.":j=L.message||"Terjadi kesalahan saat mendaftar",p(j)}finally{d(!1)}},T=L=>{switch(L){case"karyawan":return"Karyawan";case"kepala":return"Kepala Bagian";case"admin":return"Administrator";default:return"Karyawan"}},C=L=>{switch(L){case"karyawan":return"Akses: Absensi pribadi dan riwayat kehadiran";case"kepala":return"Akses: Kelola karyawan dan laporan tim";case"admin":return"Akses: Kelola semua pengguna dan pengaturan sistem (tanpa verifikasi wajah)";default:return"Akses dasar sistem"}},A=L=>{switch(L){case"admin":return l.jsx(Wc,{className:"h-5 w-5"});case"kepala":return l.jsx(NE,{className:"h-5 w-5"});default:return l.jsx(Al,{className:"h-5 w-5"})}},R=L=>{switch(L){case"admin":return"border-purple-300 bg-purple-50 text-purple-700";case"kepala":return"border-blue-300 bg-blue-50 text-blue-700";default:return"border-green-300 bg-green-50 text-green-700"}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-indigo-800 flex items-center justify-center p-4",children:l.jsxs("div",{className:"max-w-md w-full",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-6 shadow-lg",children:l.jsx(z4,{className:"h-10 w-10 text-blue-600"})}),l.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Portal Karyawan"}),l.jsx("p",{className:"text-blue-100",children:a.role==="admin"?"Buat akun Administrator tanpa verifikasi wajah":"Buat akun dengan verifikasi wajah"})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 backdrop-blur-sm",children:[a.role!=="admin"&&l.jsx("div",{className:"flex items-center justify-center mb-6",children:[1,2].map(L=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${t>=L?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:L<t?l.jsx(Vt,{className:"h-4 w-4"}):L}),L<2&&l.jsx("div",{className:`w-12 h-1 mx-2 ${t>L?"bg-blue-600":"bg-gray-200"}`})]},L))}),l.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[l.jsx(U4,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t===1?"Informasi Dasar":"Verifikasi Wajah"})]}),h&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Eu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Kesalahan Pendaftaran"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:h})]})]}),t===1?l.jsxs("form",{onSubmit:m,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),l.jsxs("div",{className:"relative",children:[l.jsx(ar,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Masukkan nama lengkap Anda"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Alamat Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(T0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Masukkan email Anda"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-3",children:"Pilih Jabatan"}),l.jsx("div",{className:"grid grid-cols-1 gap-3",children:["karyawan","kepala","admin"].map(L=>l.jsxs("label",{className:"cursor-pointer",children:[l.jsx("input",{type:"radio",name:"role",value:L,checked:a.role===L,onChange:w,className:"sr-only"}),l.jsx("div",{className:`p-4 rounded-lg border-2 transition-all ${a.role===L?R(L):"border-gray-200 hover:border-gray-300"}`,children:l.jsxs("div",{className:"flex items-center space-x-3",children:[A(L),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium text-lg",children:T(L)}),l.jsx("div",{className:"text-sm opacity-75 mt-1",children:C(L)})]}),a.role===L&&l.jsx(Vt,{className:"h-5 w-5 text-current"})]})})]},L))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(ml,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",id:"password",name:"password",value:a.password,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Masukkan password Anda"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(ml,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Konfirmasi password Anda"})]})]}),a.role==="admin"&&l.jsx("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Wc,{className:"h-5 w-5 text-purple-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-purple-800 font-medium",children:"Administrator"}),l.jsx("p",{className:"text-purple-700 text-sm mt-1",children:"Sebagai Administrator, Anda tidak perlu verifikasi wajah dan dapat langsung mengakses semua fitur sistem manajemen."})]})]})}),!ul()&&l.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Eu,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Sistem Belum Dikonfigurasi"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Database belum terhubung. Silakan hubungi administrator untuk mengatur koneksi Supabase."})]})]})}),l.jsx("div",{className:"mt-6",children:l.jsx("div",{className:"flex justify-center",children:l.jsx(E8,{ref:b,sitekey:"6LdVU1srAAAAAHHTvpZWAe6SDWNUgXw80Gh1t8ea",onChange:x,onExpired:y,theme:"light"})})}),l.jsx(JP,{}),l.jsx("button",{type:"submit",disabled:c||!ul()||!f,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:c?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Membuat Akun..."})]}):a.role==="admin"?"Buat Akun Administrator":"Lanjut ke Verifikasi Wajah"})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx(kd,{className:"h-12 w-12 text-blue-600 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-600",children:"Ambil foto wajah yang jelas untuk verifikasi absensi. Sistem kami menggunakan teknologi pengenalan wajah yang aman dan cepat."})]}),l.jsx(Ev,{onFaceCapture:N,isCapturing:c}),i&&l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 text-green-600 mb-4",children:[l.jsx(Vt,{className:"h-5 w-5"}),l.jsx("span",{children:"Foto wajah berhasil diambil dan diverifikasi!"})]})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:()=>n(1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Kembali"}),l.jsx("button",{onClick:S,disabled:!i||c,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Membuat Akun..."})]}):"Selesaikan Pendaftaran"})]})]}),t===1&&l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-600",children:["Sudah punya akun?"," ",l.jsx(vE,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Masuk di sini"})]})})]}),l.jsxs("div",{className:"mt-6 p-4 bg-white/20 backdrop-blur-sm rounded-lg text-white",children:[l.jsxs("p",{className:"text-sm font-medium mb-2",children:[l.jsx("span",{className:"bg-blue-500 text-white px-2 py-1 rounded text-xs mr-2",children:"INFO"}),"Sistem Verifikasi Berdasarkan Role"]}),l.jsxs("div",{className:"text-xs space-y-1",children:[l.jsxs("p",{children:["• ",l.jsx("strong",{children:"Administrator:"})," Akses penuh tanpa verifikasi wajah"]}),l.jsxs("p",{children:["• ",l.jsx("strong",{children:"Karyawan & Kepala:"})," Verifikasi wajah untuk keamanan absensi"]}),l.jsx("p",{children:"• Data dienkripsi dan tidak dibagikan ke pihak ketiga"}),l.jsx("p",{children:"• Sistem custom yang aman dan cepat"})]})]})]})})},aA=6048e5,tU=864e5,c4=Symbol.for("constructDateFrom");function Ms(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&c4 in e?e[c4](t):e instanceof Date?new e.constructor(t):new Date(t)}function Rr(e,t){return Ms(t||e,e)}function d4(e,t){const n=Rr(e,t==null?void 0:t.in).getDay();return n===0||n===6}let nU={};function Dv(){return nU}function Kf(e,t){var o,u,c,d;const n=Dv(),a=(t==null?void 0:t.weekStartsOn)??((u=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((d=(c=n.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,r=Rr(e,t==null?void 0:t.in),i=r.getDay(),s=(i<a?7:0)+i-a;return r.setDate(r.getDate()-s),r.setHours(0,0,0,0),r}function A0(e,t){return Kf(e,{...t,weekStartsOn:1})}function rA(e,t){const n=Rr(e,t==null?void 0:t.in),a=n.getFullYear(),r=Ms(n,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const i=A0(r),s=Ms(n,0);s.setFullYear(a,0,4),s.setHours(0,0,0,0);const o=A0(s);return n.getTime()>=i.getTime()?a+1:n.getTime()>=o.getTime()?a:a-1}function h4(e){const t=Rr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function iA(e,...t){const n=Ms.bind(null,t.find(a=>typeof a=="object"));return t.map(n)}function E0(e,t){const n=Rr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function aU(e,t,n){const[a,r]=iA(n==null?void 0:n.in,e,t),i=E0(a),s=E0(r),o=+i-h4(i),u=+s-h4(s);return Math.round((o-u)/tU)}function rU(e,t){const n=rA(e,t),a=Ms(e,0);return a.setFullYear(n,0,4),a.setHours(0,0,0,0),A0(a)}function iU(e){return Ms(e,Date.now())}function sU(e,t,n){const[a,r]=iA(n==null?void 0:n.in,e,t);return+E0(a)==+E0(r)}function oU(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function lU(e){return!(!oU(e)&&typeof e!="number"||isNaN(+Rr(e)))}function uU(e,t){const n=Rr(e,t==null?void 0:t.in),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}function cU(e,t){const n=Rr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function dU(e,t){const n=Rr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const hU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fU=(e,t,n)=>{let a;const r=hU[e];return typeof r=="string"?a=r:t===1?a=r.one:a=r.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};function wd(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const pU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vU={date:wd({formats:pU,defaultWidth:"full"}),time:wd({formats:mU,defaultWidth:"full"}),dateTime:wd({formats:gU,defaultWidth:"full"})},xU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},bU=(e,t,n,a)=>xU[e];function ws(e){return(t,n)=>{const a=n!=null&&n.context?String(n.context):"standalone";let r;if(a==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):s;r=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;r=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return r[i]}}const yU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},wU={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},NU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kU={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},SU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_U={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},jU=(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},CU={ordinalNumber:jU,era:ws({values:yU,defaultWidth:"wide"}),quarter:ws({values:wU,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ws({values:NU,defaultWidth:"wide"}),day:ws({values:kU,defaultWidth:"wide"}),dayPeriod:ws({values:SU,defaultWidth:"wide",formattingValues:_U,defaultFormattingWidth:"wide"})};function Ns(e){return(t,n={})=>{const a=n.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(r);if(!i)return null;const s=i[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(o)?EU(o,h=>h.test(s)):AU(o,h=>h.test(s));let c;c=e.valueCallback?e.valueCallback(u):u,c=n.valueCallback?n.valueCallback(c):c;const d=t.slice(s.length);return{value:c,rest:d}}}function AU(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function EU(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function sA(e){return(t,n={})=>{const a=t.match(e.matchPattern);if(!a)return null;const r=a[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=n.valueCallback?n.valueCallback(s):s;const o=t.slice(r.length);return{value:s,rest:o}}}const DU=/^(\d+)(th|st|nd|rd)?/i,TU=/\d+/i,RU={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},LU={any:[/^b/i,/^(a|c)/i]},PU={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},MU={any:[/1/i,/2/i,/3/i,/4/i]},IU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},OU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},FU={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},zU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},UU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},qU={ordinalNumber:sA({matchPattern:DU,parsePattern:TU,valueCallback:e=>parseInt(e,10)}),era:Ns({matchPatterns:RU,defaultMatchWidth:"wide",parsePatterns:LU,defaultParseWidth:"any"}),quarter:Ns({matchPatterns:PU,defaultMatchWidth:"wide",parsePatterns:MU,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ns({matchPatterns:IU,defaultMatchWidth:"wide",parsePatterns:OU,defaultParseWidth:"any"}),day:Ns({matchPatterns:FU,defaultMatchWidth:"wide",parsePatterns:BU,defaultParseWidth:"any"}),dayPeriod:Ns({matchPatterns:zU,defaultMatchWidth:"any",parsePatterns:UU,defaultParseWidth:"any"})},HU={code:"en-US",formatDistance:fU,formatLong:vU,formatRelative:bU,localize:CU,match:qU,options:{weekStartsOn:0,firstWeekContainsDate:1}};function WU(e,t){const n=Rr(e,t==null?void 0:t.in);return aU(n,dU(n))+1}function GU(e,t){const n=Rr(e,t==null?void 0:t.in),a=+A0(n)-+rU(n);return Math.round(a/aA)+1}function oA(e,t){var d,h,p,f;const n=Rr(e,t==null?void 0:t.in),a=n.getFullYear(),r=Dv(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,s=Ms((t==null?void 0:t.in)||e,0);s.setFullYear(a+1,0,i),s.setHours(0,0,0,0);const o=Kf(s,t),u=Ms((t==null?void 0:t.in)||e,0);u.setFullYear(a,0,i),u.setHours(0,0,0,0);const c=Kf(u,t);return+n>=+o?a+1:+n>=+c?a:a-1}function VU(e,t){var o,u,c,d;const n=Dv(),a=(t==null?void 0:t.firstWeekContainsDate)??((u=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(c=n.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,r=oA(e,t),i=Ms((t==null?void 0:t.in)||e,0);return i.setFullYear(r,0,a),i.setHours(0,0,0,0),Kf(i,t)}function KU(e,t){const n=Rr(e,t==null?void 0:t.in),a=+Kf(n,t)-+VU(n,t);return Math.round(a/aA)+1}function rn(e,t){const n=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return n+a}const $o={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return rn(t==="yy"?a%100:a,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):rn(n+1,2)},d(e,t){return rn(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return rn(e.getHours()%12||12,t.length)},H(e,t){return rn(e.getHours(),t.length)},m(e,t){return rn(e.getMinutes(),t.length)},s(e,t){return rn(e.getSeconds(),t.length)},S(e,t){const n=t.length,a=e.getMilliseconds(),r=Math.trunc(a*Math.pow(10,n-3));return rn(r,t.length)}},Rc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},f4={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});case"GGGG":default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const a=e.getFullYear(),r=a>0?a:1-a;return n.ordinalNumber(r,{unit:"year"})}return $o.y(e,t)},Y:function(e,t,n,a){const r=oA(e,a),i=r>0?r:1-r;if(t==="YY"){const s=i%100;return rn(s,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):rn(i,t.length)},R:function(e,t){const n=rA(e);return rn(n,t.length)},u:function(e,t){const n=e.getFullYear();return rn(n,t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return rn(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return rn(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return $o.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return rn(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const r=KU(e,a);return t==="wo"?n.ordinalNumber(r,{unit:"week"}):rn(r,t.length)},I:function(e,t,n){const a=GU(e);return t==="Io"?n.ordinalNumber(a,{unit:"week"}):rn(a,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):$o.d(e,t)},D:function(e,t,n){const a=WU(e);return t==="Do"?n.ordinalNumber(a,{unit:"dayOfYear"}):rn(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});case"EEEE":default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const r=e.getDay(),i=(r-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return rn(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const r=e.getDay(),i=(r-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return rn(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),r=a===0?7:a;switch(t){case"i":return String(r);case"ii":return rn(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});case"iiii":default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let r;switch(a===12?r=Rc.noon:a===0?r=Rc.midnight:r=a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let r;switch(a>=17?r=Rc.evening:a>=12?r=Rc.afternoon:a>=4?r=Rc.morning:r=Rc.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),n.ordinalNumber(a,{unit:"hour"})}return $o.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):$o.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return t==="Ko"?n.ordinalNumber(a,{unit:"hour"}):rn(a,t.length)},k:function(e,t,n){let a=e.getHours();return a===0&&(a=24),t==="ko"?n.ordinalNumber(a,{unit:"hour"}):rn(a,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):$o.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):$o.s(e,t)},S:function(e,t){return $o.S(e,t)},X:function(e,t,n){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return m4(a);case"XXXX":case"XX":return uu(a);case"XXXXX":case"XXX":default:return uu(a,":")}},x:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"x":return m4(a);case"xxxx":case"xx":return uu(a);case"xxxxx":case"xxx":default:return uu(a,":")}},O:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+p4(a,":");case"OOOO":default:return"GMT"+uu(a,":")}},z:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+p4(a,":");case"zzzz":default:return"GMT"+uu(a,":")}},t:function(e,t,n){const a=Math.trunc(+e/1e3);return rn(a,t.length)},T:function(e,t,n){return rn(+e,t.length)}};function p4(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.trunc(a/60),i=a%60;return i===0?n+String(r):n+String(r)+t+rn(i,2)}function m4(e,t){return e%60===0?(e>0?"-":"+")+rn(Math.abs(e)/60,2):uu(e,t)}function uu(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=rn(Math.trunc(a/60),2),i=rn(a%60,2);return n+r+t+i}const g4=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},lA=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},$U=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],r=n[2];if(!r)return g4(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",g4(a,t)).replace("{{time}}",lA(r,t))},YU={p:lA,P:$U},XU=/^D+$/,JU=/^Y+$/,QU=["D","DD","YY","YYYY"];function ZU(e){return XU.test(e)}function eq(e){return JU.test(e)}function tq(e,t,n){const a=nq(e,t,n);if(console.warn(a),QU.includes(e))throw new RangeError(a)}function nq(e,t,n){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const aq=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rq=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,iq=/^'([^]*?)'?$/,sq=/''/g,oq=/[a-zA-Z]/;function Qh(e,t,n){var d,h,p,f,g,b,w,m;const a=Dv(),r=(n==null?void 0:n.locale)??a.locale??HU,i=(n==null?void 0:n.firstWeekContainsDate)??((h=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((f=(p=a.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,s=(n==null?void 0:n.weekStartsOn)??((b=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:b.weekStartsOn)??a.weekStartsOn??((m=(w=a.locale)==null?void 0:w.options)==null?void 0:m.weekStartsOn)??0,o=Rr(e,n==null?void 0:n.in);if(!lU(o))throw new RangeError("Invalid time value");let u=t.match(rq).map(x=>{const y=x[0];if(y==="p"||y==="P"){const N=YU[y];return N(x,r.formatLong)}return x}).join("").match(aq).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:lq(x)};if(f4[y])return{isToken:!0,value:x};if(y.match(oq))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});r.localize.preprocessor&&(u=r.localize.preprocessor(o,u));const c={firstWeekContainsDate:i,weekStartsOn:s,locale:r};return u.map(x=>{if(!x.isToken)return x.value;const y=x.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&eq(y)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&ZU(y))&&tq(y,t,String(e));const N=f4[y[0]];return N(o,y,r.localize,c)}).join("")}function lq(e){const t=e.match(iq);return t?t[1].replace(sq,"'"):e}function v4(e,t){return sU(Ms(e,e),iU(e))}const uq={lessThanXSeconds:{one:"kurang dari 1 detik",other:"kurang dari {{count}} detik"},xSeconds:{one:"1 detik",other:"{{count}} detik"},halfAMinute:"setengah menit",lessThanXMinutes:{one:"kurang dari 1 menit",other:"kurang dari {{count}} menit"},xMinutes:{one:"1 menit",other:"{{count}} menit"},aboutXHours:{one:"sekitar 1 jam",other:"sekitar {{count}} jam"},xHours:{one:"1 jam",other:"{{count}} jam"},xDays:{one:"1 hari",other:"{{count}} hari"},aboutXWeeks:{one:"sekitar 1 minggu",other:"sekitar {{count}} minggu"},xWeeks:{one:"1 minggu",other:"{{count}} minggu"},aboutXMonths:{one:"sekitar 1 bulan",other:"sekitar {{count}} bulan"},xMonths:{one:"1 bulan",other:"{{count}} bulan"},aboutXYears:{one:"sekitar 1 tahun",other:"sekitar {{count}} tahun"},xYears:{one:"1 tahun",other:"{{count}} tahun"},overXYears:{one:"lebih dari 1 tahun",other:"lebih dari {{count}} tahun"},almostXYears:{one:"hampir 1 tahun",other:"hampir {{count}} tahun"}},cq=(e,t,n)=>{let a;const r=uq[e];return typeof r=="string"?a=r:t===1?a=r.one:a=r.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"dalam waktu "+a:a+" yang lalu":a},dq={full:"EEEE, d MMMM yyyy",long:"d MMMM yyyy",medium:"d MMM yyyy",short:"d/M/yyyy"},hq={full:"HH.mm.ss",long:"HH.mm.ss",medium:"HH.mm",short:"HH.mm"},fq={full:"{{date}} 'pukul' {{time}}",long:"{{date}} 'pukul' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pq={date:wd({formats:dq,defaultWidth:"full"}),time:wd({formats:hq,defaultWidth:"full"}),dateTime:wd({formats:fq,defaultWidth:"full"})},mq={lastWeek:"eeee 'lalu pukul' p",yesterday:"'Kemarin pukul' p",today:"'Hari ini pukul' p",tomorrow:"'Besok pukul' p",nextWeek:"eeee 'pukul' p",other:"P"},gq=(e,t,n,a)=>mq[e],vq={narrow:["SM","M"],abbreviated:["SM","M"],wide:["Sebelum Masehi","Masehi"]},xq={narrow:["1","2","3","4"],abbreviated:["K1","K2","K3","K4"],wide:["Kuartal ke-1","Kuartal ke-2","Kuartal ke-3","Kuartal ke-4"]},bq={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"],wide:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]},yq={narrow:["M","S","S","R","K","J","S"],short:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],abbreviated:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],wide:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},wq={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},Nq={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},kq=(e,t)=>"ke-"+Number(e),Sq={ordinalNumber:kq,era:ws({values:vq,defaultWidth:"wide"}),quarter:ws({values:xq,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ws({values:bq,defaultWidth:"wide"}),day:ws({values:yq,defaultWidth:"wide"}),dayPeriod:ws({values:wq,defaultWidth:"wide",formattingValues:Nq,defaultFormattingWidth:"wide"})},_q=/^ke-(\d+)?/i,jq=/\d+/i,Cq={narrow:/^(sm|m)/i,abbreviated:/^(s\.?\s?m\.?|s\.?\s?e\.?\s?u\.?|m\.?|e\.?\s?u\.?)/i,wide:/^(sebelum masehi|sebelum era umum|masehi|era umum)/i},Aq={any:[/^s/i,/^(m|e)/i]},Eq={narrow:/^[1234]/i,abbreviated:/^K-?\s[1234]/i,wide:/^Kuartal ke-?\s?[1234]/i},Dq={any:[/1/i,/2/i,/3/i,/4/i]},Tq={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|mei|jun|jul|agt|sep|okt|nov|des)/i,wide:/^(januari|februari|maret|april|mei|juni|juli|agustus|september|oktober|november|desember)/i},Rq={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^ma/i,/^ap/i,/^me/i,/^jun/i,/^jul/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},Lq={narrow:/^[srkjm]/i,short:/^(min|sen|sel|rab|kam|jum|sab)/i,abbreviated:/^(min|sen|sel|rab|kam|jum|sab)/i,wide:/^(minggu|senin|selasa|rabu|kamis|jumat|sabtu)/i},Pq={narrow:[/^m/i,/^s/i,/^s/i,/^r/i,/^k/i,/^j/i,/^s/i],any:[/^m/i,/^sen/i,/^sel/i,/^r/i,/^k/i,/^j/i,/^sa/i]},Mq={narrow:/^(a|p|tengah m|tengah h|(di(\swaktu)?) (pagi|siang|sore|malam))/i,any:/^([ap]\.?\s?m\.?|tengah malam|tengah hari|(di(\swaktu)?) (pagi|siang|sore|malam))/i},Iq={any:{am:/^a/i,pm:/^pm/i,midnight:/^tengah m/i,noon:/^tengah h/i,morning:/pagi/i,afternoon:/siang/i,evening:/sore/i,night:/malam/i}},Oq={ordinalNumber:sA({matchPattern:_q,parsePattern:jq,valueCallback:e=>parseInt(e,10)}),era:Ns({matchPatterns:Cq,defaultMatchWidth:"wide",parsePatterns:Aq,defaultParseWidth:"any"}),quarter:Ns({matchPatterns:Eq,defaultMatchWidth:"wide",parsePatterns:Dq,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ns({matchPatterns:Tq,defaultMatchWidth:"wide",parsePatterns:Rq,defaultParseWidth:"any"}),day:Ns({matchPatterns:Lq,defaultMatchWidth:"wide",parsePatterns:Pq,defaultParseWidth:"any"}),dayPeriod:Ns({matchPatterns:Mq,defaultMatchWidth:"any",parsePatterns:Iq,defaultParseWidth:"any"})},x4={code:"id",formatDistance:cq,formatLong:pq,formatRelative:gq,localize:Sq,match:Oq,options:{weekStartsOn:1,firstWeekContainsDate:1}};function Fq(e,t,n,a){const i=p=>p*Math.PI/180,s=i(e),o=i(n),u=i(n-e),c=i(a-t),d=Math.sin(u/2)**2+Math.cos(s)*Math.cos(o)*Math.sin(c/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}function Bq(e,t,n,a,r){return Fq(e,t,n,a)<=r}function zq(){return new Promise((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(n=>{e({latitude:n.coords.latitude,longitude:n.coords.longitude})},n=>{let a="Unknown location error";switch(n.code){case n.PERMISSION_DENIED:a="Location access denied by user";break;case n.POSITION_UNAVAILABLE:a="Location information unavailable";break;case n.TIMEOUT:a="Location request timed out";break}t(new Error(a))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})}const Uq=({onLocationValidated:e})=>{const[t,n]=ae.useState(null),[a,r]=ae.useState(!1),[i,s]=ae.useState(!1),[o,u]=ae.useState(null),[c,d]=ae.useState(null);ae.useEffect(()=>{h()},[]);const h=async()=>{s(!0),u(null);try{const g=await L_();d(g);const b=await zq();n(b);const w=Bq(b.latitude,b.longitude,g.latitude,g.longitude,g.radius);r(w),e&&e(w,b)}catch(g){console.error("Location validation error:",g);let b=g.message;b.includes("denied")?b="Akses lokasi ditolak. Silakan izinkan akses lokasi.":b.includes("unavailable")?b="Informasi lokasi tidak tersedia.":b.includes("timeout")?b="Permintaan lokasi timeout.":b.includes("not supported")&&(b="Geolokasi tidak didukung oleh browser ini."),u(b),e&&e(!1,null)}finally{s(!1)}},p=async()=>{await h()},f=g=>g?g.toFixed(6):"Tidak diketahui";return i?l.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-3"}),l.jsx("p",{className:"text-blue-700 font-medium",children:"Mendapatkan lokasi Anda..."}),l.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"Silakan izinkan akses lokasi"})]}):o?l.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-red-50 rounded-lg",children:[l.jsx(Eu,{className:"h-8 w-8 text-red-500 mb-3"}),l.jsx("p",{className:"text-red-700 font-medium mb-2",children:"Kesalahan Akses Lokasi"}),l.jsx("p",{className:"text-red-600 text-sm text-center mb-4",children:o}),l.jsx("button",{onClick:p,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Coba Lagi"})]}):l.jsx("div",{className:`p-6 rounded-lg ${a?"bg-green-50":"bg-red-50"}`,children:l.jsxs("div",{className:"flex items-start space-x-4",children:[a?l.jsx(Vt,{className:"h-8 w-8 text-green-500 flex-shrink-0 mt-1"}):l.jsx(Rn,{className:"h-8 w-8 text-red-500 flex-shrink-0 mt-1"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(_i,{className:"h-5 w-5 text-gray-600"}),l.jsx("h3",{className:`font-semibold ${a?"text-green-700":"text-red-700"}`,children:a?"Lokasi Terverifikasi":"Lokasi Tidak Valid"})]}),l.jsx("p",{className:`text-sm mb-3 ${a?"text-green-600":"text-red-600"}`,children:a?"Anda berada dalam radius yang diizinkan dari kantor.":`Anda harus berada dalam radius ${(c==null?void 0:c.radius)||100} meter dari kantor untuk absen.`}),t&&c&&l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[l.jsxs("div",{className:"bg-white/70 p-3 rounded",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Lokasi Anda"}),l.jsxs("p",{className:"text-gray-600",children:[f(t.latitude),", ",f(t.longitude)]})]}),l.jsxs("div",{className:"bg-white/70 p-3 rounded",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Lokasi Kantor"}),l.jsxs("p",{className:"text-gray-600",children:[f(c.latitude),", ",f(c.longitude)]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:c.address})]})]}),l.jsx("button",{onClick:p,className:`mt-4 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"}`,children:"Perbarui Lokasi"})]})]})})},qq=({user:e,onAttendanceSubmitted:t,todayAttendance:n=[]})=>{const[a,r]=ae.useState("masuk"),[i,s]=ae.useState(!1),[o,u]=ae.useState(!1),[c,d]=ae.useState(null),[h,p]=ae.useState(null),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(1),[y,N]=ae.useState(null),[S,T]=ae.useState(null),[C,A]=ae.useState(null),[R,L]=ae.useState(!1),[j,D]=ae.useState(!0),[B,z]=ae.useState(null),[U,I]=ae.useState(null),[F,q]=ae.useState(!1),[O,$]=ae.useState({startTime:"08:00",endTime:"17:00",lateThreshold:15,earlyLeaveThreshold:15,breakDuration:60});ae.useEffect(()=>{const _e=()=>{q(window.innerWidth<768)};return _e(),window.addEventListener("resize",_e),()=>window.removeEventListener("resize",_e)},[]),ae.useEffect(()=>{J(),H(),K(),W(),Z(),P()},[e,n]);const Z=async()=>{try{const _e=await L_();z(_e)}catch(_e){console.error("Error fetching office location:",_e)}},P=async()=>{try{const{data:_e,error:de}=await Te.from("system_settings").select("setting_value").eq("setting_key","work_hours").single();if(de&&de.code!=="PGRST116")throw de;_e!=null&&_e.setting_value&&$(ke=>({...ke,..._e.setting_value}))}catch(_e){console.error("Error fetching work hours settings:",_e)}},W=async()=>{try{const _e=await oR();D(_e.enabled)}catch(_e){console.error("Error fetching camera settings:",_e),D(!0)}},K=()=>{const _e=n.some(ke=>ke.type==="masuk"&&ke.status==="berhasil"),de=n.some(ke=>ke.type==="keluar"&&ke.status==="berhasil");_e?_e&&!de&&r("keluar"):r("masuk")},J=async()=>{try{const{data:_e,error:de}=await Te.from("profiles").select("*").eq("id",e.id).single();if(de)throw de;if(A(_e),_e.avatar_url&&j)try{const ke=await Qz(_e.avatar_url);w(ke.fingerprint)}catch(ke){console.error("Error loading stored face fingerprint:",ke),N("Gagal memuat data wajah tersimpan. Silakan hubungi administrator.")}else j&&N("Foto profil belum tersedia. Silakan lengkapi profil Anda terlebih dahulu.")}catch(_e){console.error("Error fetching user profile:",_e),N("Gagal memuat profil pengguna.")}},H=async()=>{try{const{data:_e,error:de}=await Te.from("attendance").select("*").eq("user_id",e.id).eq("status","berhasil").order("timestamp",{ascending:!1}).limit(1);if(de)throw de;_e&&_e.length>0&&T(_e[0])}catch(_e){console.error("Error fetching last attendance:",_e)}},ie=_e=>{let de="";_e>1e3?de=`Anda berada ${(_e/1e3).toFixed(1)} km dari lokasi kantor.`:de="",de+="<br/><br/>Silakan datang ke lokasi kantor untuk melakukan absensi.",ct.fire({icon:"error",title:"Hmm, Sistem mendeteksi kamu di luar lokasi kantor",html:de,confirmButtonText:"Mengerti",confirmButtonColor:"#3085d6"})},ue=(_e,de,ke)=>{if(I(ke),!_e){ie(ke),u(!1);return}u(!0),d(de),ct.fire({icon:"success",title:"Lokasi Valid",text:"Anda berada di lokasi kantor yang ditentukan",timer:2e3,showConfirmButton:!1}),x(j?2:3)},ce=(_e,de)=>{p(_e),g(de),ct.fire({icon:"success",title:"Wajah Terverifikasi",text:"Wajah Anda berhasil dikenali",timer:2e3,showConfirmButton:!1}),x(3)},pe=async()=>{if(!j)return!0;if(!f||!b)throw new Error("Data wajah tidak tersedia untuk verifikasi");try{if(!Jz(f,b,.7))throw new Error("Wajah tidak cocok dengan data yang tersimpan. Pastikan Anda adalah orang yang benar dengan pencahayaan yang baik.");return!0}catch(_e){throw console.error("Face verification error:",_e),_e}},ve=()=>{const _e=new Date,de=_e.toTimeString().slice(0,5),ke=O.startTime,Fe=O.endTime,Ze=O.lateThreshold||15;let Xe=!1,oe=0,Be=0,Ke=0;if(a==="masuk"){const[et,He]=ke.split(":").map(Number),wt=new Date;wt.setHours(et,He+Ze,0,0);const dt=wt.toTimeString().slice(0,5);if(Xe=de>dt,Xe){const _n=new Date(`1970-01-01T${ke}:00`),Rt=new Date(`1970-01-01T${de}:00`);oe=Math.floor((Rt-_n)/6e4)}}else if(a==="keluar"&&S&&S.type==="masuk"){const et=new Date(S.timestamp),wt=Math.floor((_e-et)/6e4),dt=O.breakDuration||60,_n=Math.max(0,wt-dt);Be=Math.max(0,_n/60);const[Rt,Mt]=ke.split(":").map(Number),[Ua,Kt]=Fe.split(":").map(Number),gn=(Ua*60+Kt-(Rt*60+Mt)-dt)/60;Be>gn&&(Ke=Be-gn,Be=gn)}return{isLate:Xe,lateMinutes:oe,workHours:Be,overtimeHours:Ke}},De=()=>{const de=new Date().toTimeString().slice(0,5),ke=O.startTime,Fe=O.endTime,[Ze,Xe]=ke.split(":").map(Number),oe=new Date;oe.setHours(Ze,Xe-30,0,0);const Be=oe.toTimeString().slice(0,5),[Ke,et]=Fe.split(":").map(Number),He=new Date;He.setHours(Ke,et+30,0,0);const wt=He.toTimeString().slice(0,5);return a==="masuk"?de>=Be&&de<=wt:a==="keluar"?de>=ke&&de<=wt:!0},Re=async()=>{if(!o||!c){N("Silakan selesaikan verifikasi lokasi");return}if(j&&!f){N("Silakan selesaikan verifikasi wajah");return}if(!De()){const de=O.startTime,ke=O.endTime;ct.fire({icon:"warning",title:"Di Luar Jam Kerja",html:`
          <div class="text-left">
            <p class="mb-2">Absensi ${a} hanya dapat dilakukan pada jam kerja:</p>
            <p class="mb-2"><strong>Jam Kerja:</strong> ${de} - ${ke}</p>
            <p class="text-sm text-gray-600">Jika Anda perlu melakukan absensi di luar jam kerja, silakan hubungi HRD.</p>
          </div>
        `,confirmButtonText:"Mengerti",confirmButtonColor:"#3085d6"});return}if(n.some(de=>de.type===a&&de.status==="berhasil")){ct.fire({icon:"warning",title:"Absensi Sudah Dilakukan",text:`Anda sudah melakukan absensi ${a} hari ini.`,confirmButtonText:"OK"});return}s(!0),N(null);try{j&&await pe();const de=new Date,{isLate:ke,lateMinutes:Fe,workHours:Ze,overtimeHours:Xe}=ve(),oe=C!=null&&C.salary?C.salary/22:0;let Be=0;if(a==="masuk")if(ke&&Fe>15){const wt=Math.min(Fe/60*.1,.5);Be=oe*(1-wt)}else Be=oe;const Ke={user_id:e.id,type:a,timestamp:de.toISOString(),latitude:c.latitude,longitude:c.longitude,status:"berhasil",is_late:ke,late_minutes:Fe,work_hours:Ze,overtime_hours:Xe,daily_salary_earned:Be,notes:`Absensi ${a} berhasil dengan verifikasi ${j?"wajah dan ":""}lokasi. ${ke?`Terlambat ${Fe} menit.`:"Tepat waktu."}`};a==="masuk"?Ke.check_in_time=de.toISOString():Ke.check_out_time=de.toISOString();const{data:et,error:He}=await Te.from("attendance").insert([Ke]).select();if(He)throw He;try{await Te.from("activity_logs").insert([{user_id:e.id,action_type:`attendance_${a}`,action_details:Ke,user_agent:navigator.userAgent}])}catch(wt){console.error("Failed to log activity:",wt)}await ct.fire({icon:"success",title:`Absensi ${a==="masuk"?"Masuk":"Keluar"} Berhasil`,html:`
          <div class="text-left">
            <p class="mb-2"><strong>Status:</strong> ${ke?`Terlambat ${Fe} menit`:"Tepat Waktu"}</p>
            ${Ze>0?`<p class="mb-2"><strong>Jam Kerja:</strong> ${Ze.toFixed(1)} jam</p>`:""}
            ${Xe>0?`<p class="mb-2"><strong>Lembur:</strong> ${Xe.toFixed(1)} jam</p>`:""}
            ${Be>0?`<p class="mb-2"><strong>Gaji Harian:</strong> ${ne(Be)}</p>`:""}
            <p class="text-sm text-gray-500 mt-3">${de.toLocaleString("id-ID")}</p>
          </div>
        `,confirmButtonText:"Selesai",confirmButtonColor:"#10b981",timer:5e3,timerProgressBar:!0,willClose:()=>{t&&t(et[0]),we()}})}catch(de){console.error("Attendance submission error:",de);let ke="gagal";de.message.includes("wajah")||de.message.includes("Verifikasi wajah")?ke=j?"wajah_tidak_valid":"gagal":de.message.includes("lokasi")&&(ke="lokasi_tidak_valid");const Fe={user_id:e.id,type:a,timestamp:new Date().toISOString(),latitude:(c==null?void 0:c.latitude)||null,longitude:(c==null?void 0:c.longitude)||null,status:ke,notes:`Absensi gagal: ${de.message}`};await Te.from("attendance").insert([Fe]),await ct.fire({icon:"error",title:`Absensi ${a==="masuk"?"Masuk":"Keluar"} Gagal`,text:de.message||"Terjadi kesalahan saat absensi",confirmButtonText:"OK",confirmButtonColor:"#3085d6"}),N(de.message)}finally{s(!1)}},we=()=>{x(1),u(!1),d(null),p(null),g(null),N(null),L(!1),H()},xe=()=>new Date().toLocaleString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),ne=_e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(_e),Qe=n.some(_e=>_e.type==="masuk"&&_e.status==="berhasil"),Je=n.some(_e=>_e.type==="keluar"&&_e.status==="berhasil"),Ae=!Qe,Ge=Qe&&!Je;return j&&!b?y&&y.includes("Foto profil")?l.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-3xl",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Absensi Karyawan"}),l.jsx("p",{className:"opacity-90",children:"Setup diperlukan untuk melanjutkan"})]}),l.jsxs("div",{className:"p-6 text-center",children:[l.jsx("div",{className:"bg-red-100 p-4 rounded-full inline-flex mb-4",children:l.jsx(Rn,{className:"h-12 w-12 text-red-600"})}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Verifikasi Wajah Diperlukan"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Untuk keamanan sistem absensi, Anda perlu menambahkan foto wajah ke profil terlebih dahulu."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>window.location.href="/profile",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(ji,{className:"h-4 w-4"}),l.jsx("span",{children:"Lengkapi Profil Sekarang"})]}),l.jsx("button",{onClick:()=>D(!1),className:"w-full bg-gray-200 text-gray-800 py-3 px-4 rounded-lg font-medium hover:bg-gray-300 transition-colors text-sm",children:"Gunakan Mode Tanpa Verifikasi Wajah"})]}),l.jsx("div",{className:"mt-6 p-3 bg-blue-50 rounded-lg text-left",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(Hb,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Informasi Penting"}),l.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Mode tanpa verifikasi wajah hanya dapat digunakan dengan persetujuan HRD dan memiliki batasan tertentu."})]})]})})]})]}):l.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-3xl",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Absensi Karyawan"}),l.jsx("p",{className:"opacity-90",children:"Memuat data verifikasi..."})]}),l.jsxs("div",{className:"p-8 text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Menyiapkan sistem verifikasi..."})]})]}):l.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-3xl",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white",children:[l.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[l.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:l.jsx(ar,{className:"h-6 w-6"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h2",{className:"text-xl md:text-2xl font-bold truncate",children:"Absensi Karyawan"}),l.jsx("p",{className:"text-sm md:text-base opacity-90 truncate",children:(C==null?void 0:C.name)||"Pengguna"})]})]}),l.jsx("p",{className:"text-xs md:text-sm opacity-90",children:xe()}),S&&l.jsx("div",{className:"mt-4 p-3 bg-white/10 rounded-lg",children:l.jsxs("p",{className:"text-xs md:text-sm truncate",children:["Terakhir: ",l.jsx("span",{className:"font-medium",children:S.type==="masuk"?"Masuk":"Keluar"})," ",new Date(S.timestamp).toLocaleString("id-ID",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]})}),l.jsx("div",{className:"mt-4 p-3 bg-white/10 rounded-lg",children:l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs md:text-sm",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Qe?"bg-green-400":"bg-yellow-400"}`}),l.jsx("span",{children:"Masuk:"}),l.jsx("span",{className:"font-medium",children:Qe?"✓":"○"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Je?"bg-green-400":"bg-yellow-400"}`}),l.jsx("span",{children:"Keluar:"}),l.jsx("span",{className:"font-medium",children:Je?"✓":"○"})]})]})})]}),l.jsxs("div",{className:"p-4 md:p-6",children:[(()=>{const _e=[{id:1,name:"Lokasi"},{id:2,name:"Wajah"},{id:3,name:"Kirim"}],de=j?_e:[_e[0],_e[2]];return F?l.jsx("div",{className:"flex items-center justify-between mb-6",children:de.map((ke,Fe)=>l.jsxs(Nd.Fragment,{children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-medium text-sm transition-colors ${m>=ke.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:m>ke.id?l.jsx(Vt,{className:"h-4 w-4"}):ke.id}),l.jsx("span",{className:"text-xs mt-1",children:ke.name})]}),Fe<de.length-1&&l.jsx("div",{className:"flex-1 h-1 mx-2 bg-gray-200 relative",children:l.jsx("div",{className:`absolute top-0 left-0 h-full transition-all duration-300 ${m>ke.id?"bg-blue-600":"bg-gray-200"}`,style:{width:m>ke.id?"100%":"0%"}})})]},ke.id))}):l.jsx("div",{className:"flex items-center mb-8",children:de.map((ke,Fe)=>l.jsxs(Nd.Fragment,{children:[l.jsxs("div",{className:"flex flex-col items-center text-center w-28",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium transition-colors duration-300 ${m>=ke.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:m>ke.id?l.jsx(Vt,{className:"h-5 w-5"}):ke.id}),l.jsx("p",{className:`mt-2 text-sm font-medium transition-colors duration-300 ${m>=ke.id?"text-blue-700":"text-gray-500"}`,children:ke.name})]}),Fe<de.length-1&&l.jsx("div",{className:`flex-1 h-1 mx-4 rounded-full transition-colors duration-300 ${m>ke.id?"bg-blue-600":"bg-gray-200"}`})]},ke.id))})})(),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Jenis Absensi"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{onClick:()=>r("masuk"),disabled:!Ae,className:`p-3 md:p-4 rounded-lg border-2 transition-all flex flex-col items-center ${a==="masuk"?"border-blue-600 bg-blue-50 text-blue-700":Ae?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[l.jsx(Xi,{className:"h-5 w-5 md:h-6 md:w-6 mb-2"}),l.jsx("p",{className:"font-medium text-sm md:text-base",children:"Masuk"}),!Ae&&l.jsx("p",{className:"text-xs mt-1",children:"Sudah dilakukan"})]}),l.jsxs("button",{onClick:()=>r("keluar"),disabled:!Ge,className:`p-3 md:p-4 rounded-lg border-2 transition-all flex flex-col items-center ${a==="keluar"?"border-blue-600 bg-blue-50 text-blue-700":Ge?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[l.jsx(Xi,{className:"h-5 w-5 md:h-6 md:w-6 mb-2"}),l.jsx("p",{className:"font-medium text-sm md:text-base",children:"Keluar"}),!Ge&&l.jsx("p",{className:"text-xs mt-1",children:Qe?"Sudah dilakukan":"Belum masuk"})]})]})]}),m===1&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(_i,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold",children:"Verifikasi Lokasi"})]}),B&&l.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-700",children:[l.jsx("strong",{children:"Lokasi Kantor:"})," ",B.name,l.jsx("br",{}),l.jsx("strong",{children:"Alamat:"})," ",B.address]})}),l.jsx(Uq,{onLocationValidated:ue,officeLocation:B}),l.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:l.jsxs("p",{className:"text-sm text-yellow-700",children:[l.jsx("strong",{children:"Perhatian:"})," Pastikan GPS/Lokasi perangkat Anda aktif dan Anda berada di area kantor."]})})]}),m===2&&j&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(kd,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold",children:"Verifikasi Wajah"})]}),l.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(Hb,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Tips Verifikasi Wajah"}),l.jsxs("ul",{className:"text-xs text-blue-600 mt-1 list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Pastikan pencahayaan cukup terang"}),l.jsx("li",{children:"Hadapkan wajah ke kamera secara lurus"}),l.jsx("li",{children:"Hindari bayangan pada wajah"}),l.jsx("li",{children:"Jangan gunakan masker atau kacamata gelap"})]})]})]})}),l.jsx(Ev,{onFaceCapture:ce,isCapturing:i,isMobile:F}),l.jsxs("button",{onClick:()=>x(1),className:"mt-4 text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali ke verifikasi lokasi"]})]}),m===3&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(Vt,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold",children:"Konfirmasi Absensi"})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Ringkasan Verifikasi"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Lokasi:"}),l.jsxs("div",{className:"flex items-center text-green-600 font-medium",children:[l.jsx(Vt,{className:"h-4 w-4 mr-1"}),l.jsx("span",{children:"Terverifikasi"})]})]}),j&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Wajah:"}),l.jsxs("div",{className:"flex items-center text-green-600 font-medium",children:[l.jsx(Vt,{className:"h-4 w-4 mr-1"}),l.jsx("span",{children:"Terverifikasi"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Jenis Absensi:"}),l.jsx("span",{className:"font-medium",children:a==="masuk"?"Masuk":"Keluar"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Waktu:"}),l.jsx("span",{className:"font-medium",children:new Date().toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})})]}),U&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Jarak dari Kantor:"}),l.jsx("span",{className:"font-medium",children:U>1e3?`${(U/1e3).toFixed(1)} km`:`${Math.round(U)} m`})]})]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:we,className:"flex-1 px-4 py-2 md:py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm md:text-base",children:"Mulai Ulang"}),l.jsx("button",{onClick:Re,disabled:i,className:"flex-1 px-4 py-2 md:py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm md:text-base flex items-center justify-center",children:i?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Mengirim..."]}):"Kirim Absensi"})]})]}),y&&!y.includes("Foto profil")&&l.jsxs("div",{className:"mt-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Eu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Gagal Melakukan Absensi"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:y}),l.jsx("button",{onClick:we,className:"mt-2 text-sm text-red-700 underline hover:text-red-800",children:"Coba Lagi"})]})]})]})]})},uA=({userId:e,userRole:t})=>{const[n,a]=ae.useState([]),[r,i]=ae.useState(!1),[s,o]=ae.useState(0);ae.useEffect(()=>{if(e){u();const g=Te.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e}`},b=>{a(w=>[b.new,...w]),o(w=>w+1)}).subscribe();return()=>{g.unsubscribe()}}},[e]);const u=async()=>{try{const{data:g,error:b}=await Te.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(20);if(b)throw b;a(g||[]),o((g==null?void 0:g.filter(w=>!w.is_read).length)||0)}catch(g){console.error("Error fetching notifications:",g)}},c=async g=>{try{const{error:b}=await Te.from("notifications").update({is_read:!0}).eq("id",g);if(b)throw b;a(w=>w.map(m=>m.id===g?{...m,is_read:!0}:m)),o(w=>Math.max(0,w-1))}catch(b){console.error("Error marking notification as read:",b)}},d=async()=>{try{const{error:g}=await Te.from("notifications").update({is_read:!0}).eq("user_id",e).eq("is_read",!1);if(g)throw g;a(b=>b.map(w=>({...w,is_read:!0}))),o(0)}catch(g){console.error("Error marking all notifications as read:",g)}},h=g=>{switch(g){case"late_warning":return l.jsx(Xi,{className:"h-5 w-5 text-orange-500"});case"absence_warning":return l.jsx(Ln,{className:"h-5 w-5 text-red-500"});case"salary_info":return l.jsx(Vt,{className:"h-5 w-5 text-green-500"});case"system_alert":return l.jsx(El,{className:"h-5 w-5 text-blue-500"});case"general":return l.jsx(ar,{className:"h-5 w-5 text-gray-500"});default:return l.jsx(lo,{className:"h-5 w-5 text-gray-500"})}},p=g=>{switch(g){case"late_warning":return"border-l-orange-400 bg-orange-50";case"absence_warning":return"border-l-red-400 bg-red-50";case"salary_info":return"border-l-green-400 bg-green-50";case"system_alert":return"border-l-blue-400 bg-blue-50";case"general":return"border-l-gray-400 bg-gray-50";default:return"border-l-gray-400 bg-gray-50"}},f=g=>{const b=new Date(g),w=new Date,m=(w-b)/(1e3*60*60);if(m<1){const x=Math.floor((w-b)/6e4);return x<=1?"Baru saja":`${x} menit yang lalu`}else return m<24?`${Math.floor(m)} jam yang lalu`:b.toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})};return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>i(!r),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors group",children:[l.jsx(lo,{className:"h-6 w-6 group-hover:scale-110 transition-transform"}),s>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse",children:s>9?"9+":s})]}),r&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>i(!1)}),l.jsxs("div",{className:"fixed md:absolute right-0 mt-2 w-full md:w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-[80vh] md:max-h-96 overflow-hidden md:top-auto bottom-0 md:bottom-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-blue-100",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(lo,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifikasi"}),s>0&&l.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:s})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[s>0&&l.jsx("button",{onClick:d,className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Tandai semua dibaca"}),l.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded transition-colors",children:l.jsx(Si,{className:"h-4 w-4"})})]})]}),l.jsx("div",{className:"max-h-[calc(80vh-120px)] md:max-h-80 overflow-y-auto",children:n.length>0?n.map(g=>{var b;return l.jsx("div",{className:`p-4 border-l-4 hover:bg-gray-50 cursor-pointer transition-colors ${g.is_read?"border-l-gray-200 bg-white":p(g.type)}`,onClick:()=>!g.is_read&&c(g.id),children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"flex-shrink-0 mt-1",children:h(g.type)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("p",{className:`text-sm font-medium ${g.is_read?"text-gray-700":"text-gray-900"}`,children:g.title}),!g.is_read&&l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:g.message}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[l.jsx(Du,{className:"h-3 w-3 mr-1"}),f(g.created_at)]}),((b=g.data)==null?void 0:b.letter_number)&&l.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:g.data.letter_number})]})]})]})},g.id)}):l.jsxs("div",{className:"p-8 text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(lo,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 font-medium",children:"Tidak ada notifikasi"}),l.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Notifikasi akan muncul di sini"})]})}),n.length>0&&l.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50 text-center",children:l.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Lihat semua notifikasi"})})]})]})]})},cA=()=>{var F,q;const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState([]),[o,u]=ae.useState([]),[c,d]=ae.useState(!0),[h,p]=ae.useState([]),[f,g]=ae.useState(null),[b,w]=ae.useState("all"),[m,x]=ae.useState({startDate:"",endDate:"",type:"",status:"",employeeId:""});ae.useEffect(()=>{y()},[]),ae.useEffect(()=>{C()},[i,m,b]);const y=async()=>{try{const{data:{user:O}}=await Te.auth.getUser();if(!O){e("/login");return}n(O);const{data:$,error:Z}=await Te.from("profiles").select("role").eq("id",O.id).single();if(Z)throw Z;r($.role),$.role==="admin"?(await N(),await S()):await T(O.id)}catch(O){console.error("Error checking user:",O),e("/login")}finally{d(!1)}},N=async()=>{try{const{data:O,error:$}=await Te.from("profiles").select("id, name, email, employee_id, department").order("name");if($)throw $;p(O||[])}catch(O){console.error("Error fetching employees:",O)}},S=async()=>{try{const{data:O,error:$}=await Te.from("attendance").select(`
          *,
          profiles:user_id(id, name, email, employee_id, department)
        `).order("timestamp",{ascending:!1}).limit(500);if($)throw $;s(O||[])}catch(O){console.error("Error fetching all attendance:",O)}},T=async O=>{try{const{data:$,error:Z}=await Te.from("attendance").select("*").eq("user_id",O).order("timestamp",{ascending:!1});if(Z)throw Z;s($||[])}catch($){console.error("Error fetching attendance history:",$)}},C=()=>{let O=[...i];if(O=O.filter($=>$.type==="masuk"||$.type==="keluar"),a==="admin"&&b!=="all"&&(O=O.filter($=>$.user_id===b)),m.startDate&&(O=O.filter($=>new Date($.timestamp)>=new Date(m.startDate))),m.endDate){const $=new Date(m.endDate);$.setHours(23,59,59,999),O=O.filter(Z=>new Date(Z.timestamp)<=$)}m.type&&(O=O.filter($=>$.type===m.type)),m.status&&(O=O.filter($=>$.status===m.status)),u(O)},A=O=>{x({...m,[O.target.name]:O.target.value})},R=O=>{w(O.target.value)},L=()=>{x({startDate:"",endDate:"",type:"",status:""}),w("all")},j=async()=>{d(!0),a==="admin"?await S():await T(t.id),d(!1)},D=()=>{if(o.length===0){ct.fire({icon:"info",title:"Tidak Ada Data",text:"Tidak ada data absensi untuk diexport."});return}try{const $=[a==="admin"?["Tanggal","Waktu","Karyawan","Departemen","Jenis","Status","Terlambat","Menit Terlambat","Jam Kerja","Lembur","Latitude","Longitude"]:["Tanggal","Waktu","Jenis","Status","Terlambat","Menit Terlambat","Jam Kerja","Lembur","Latitude","Longitude"],...o.map(K=>{var ue,ce;const J=new Date(K.timestamp),H=J.toLocaleDateString("id-ID"),ie=J.toLocaleTimeString("id-ID");return a==="admin"?[H,ie,((ue=K.profiles)==null?void 0:ue.name)||"Unknown",((ce=K.profiles)==null?void 0:ce.department)||"-",K.type==="masuk"?"Masuk":K.type==="keluar"?"Keluar":"Tidak Hadir",K.status,K.is_late?"Ya":"Tidak",K.late_minutes||"0",K.work_hours||"0",K.overtime_hours||"0",K.latitude||"",K.longitude||""]:[H,ie,K.type==="masuk"?"Masuk":K.type==="keluar"?"Keluar":"Tidak Hadir",K.status,K.is_late?"Ya":"Tidak",K.late_minutes||"0",K.work_hours||"0",K.overtime_hours||"0",K.latitude||"",K.longitude||""]})].map(K=>K.join(",")).join(`
`),Z=new Blob([$],{type:"text/csv;charset=utf-8;"}),P=document.createElement("a"),W=URL.createObjectURL(Z);P.setAttribute("href",W),P.setAttribute("download",`attendance_report_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(W),ct.fire({icon:"success",title:"Export Berhasil",text:"Data absensi berhasil diexport ke CSV."})}catch{ct.fire({icon:"error",title:"Export Gagal",text:"Terjadi kesalahan saat export data absensi."})}},B=O=>{switch(O){case"berhasil":return"text-green-600 bg-green-100";case"wajah_tidak_valid":return"text-red-600 bg-red-100";case"lokasi_tidak_valid":return"text-yellow-600 bg-yellow-100";case"tidak_hadir":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},z=O=>{switch(O){case"berhasil":return l.jsx(Vt,{className:"h-4 w-4"});case"wajah_tidak_valid":case"lokasi_tidak_valid":return l.jsx(Rn,{className:"h-4 w-4"});case"tidak_hadir":return l.jsx(Rn,{className:"h-4 w-4"});default:return l.jsx(Ln,{className:"h-4 w-4"})}},U=O=>{switch(O){case"berhasil":return"Berhasil";case"wajah_tidak_valid":return"Wajah Invalid";case"lokasi_tidak_valid":return"Lokasi Invalid";case"tidak_hadir":return"Tidak Hadir";default:return"Gagal"}},I=O=>{const $=new Date(O);return{date:$.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}),time:$.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}};return c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data absensi..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between py-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>e(a==="admin"?"/admin":"/dashboard"),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:l.jsx(q4,{className:"h-5 w-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Laporan Absensi"}),l.jsx("p",{className:"text-sm text-blue-100",children:a==="admin"?"Lihat dan export laporan absensi semua karyawan":"Lihat dan export riwayat absensi Anda"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("button",{onClick:j,className:"flex items-center space-x-2 px-3 py-1.5 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-colors",title:"Refresh Data",children:[l.jsx(Ty,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),l.jsxs("button",{onClick:D,disabled:o.length===0,className:"flex items-center space-x-2 px-4 py-2 bg-white text-blue-700 rounded-lg hover:bg-white/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(Xf,{className:"h-4 w-4"}),l.jsx("span",{children:"Export CSV"})]})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-6",children:[l.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(H4,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"}),l.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Filter Laporan"})]})}),l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:hidden",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Jenis"}),l.jsxs("select",{name:"type",value:m.type,onChange:A,className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua"}),l.jsx("option",{value:"masuk",children:"Masuk"}),l.jsx("option",{value:"keluar",children:"Keluar"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),l.jsxs("select",{name:"status",value:m.status,onChange:A,className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua"}),l.jsx("option",{value:"berhasil",children:"Berhasil"}),l.jsx("option",{value:"wajah_tidak_valid",children:"Wajah Invalid"}),l.jsx("option",{value:"lokasi_tidak_valid",children:"Lokasi Invalid"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Dari"}),l.jsx("input",{type:"date",name:"startDate",value:m.startDate,onChange:A,className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sampai"}),l.jsx("input",{type:"date",name:"endDate",value:m.endDate,onChange:A,className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"hidden sm:grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a==="admin"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Karyawan"}),l.jsxs("div",{className:"relative",children:[l.jsx(Al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsxs("select",{value:b,onChange:R,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"Semua Karyawan"}),h.map(O=>l.jsxs("option",{value:O.id,children:[O.name," ",O.employee_id?`(${O.employee_id})`:""]},O.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal Mulai"}),l.jsx("input",{type:"date",name:"startDate",value:m.startDate,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal Akhir"}),l.jsx("input",{type:"date",name:"endDate",value:m.endDate,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Absensi"}),l.jsxs("select",{name:"type",value:m.type,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Jenis"}),l.jsx("option",{value:"masuk",children:"Masuk"}),l.jsx("option",{value:"keluar",children:"Keluar"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),l.jsxs("select",{name:"status",value:m.status,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"berhasil",children:"Berhasil"}),l.jsx("option",{value:"wajah_tidak_valid",children:"Wajah Invalid"}),l.jsx("option",{value:"lokasi_tidak_valid",children:"Lokasi Invalid"})]})]})]}),l.jsxs("div",{className:"mt-3 sm:mt-4 flex justify-between items-center",children:[l.jsxs("div",{className:"text-xs sm:text-sm text-gray-500",children:["Menampilkan ",o.length," dari ",i.length," data"]}),l.jsx("button",{onClick:L,className:"px-3 py-1.5 text-xs sm:text-sm text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:"Reset Filter"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Du,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Data Absensi (",o.length,")"]})]}),a==="admin"&&l.jsx("div",{className:"text-sm text-gray-500",children:b==="all"?"Menampilkan semua karyawan":`Menampilkan ${((F=h.find(O=>O.id===b))==null?void 0:F.name)||"karyawan"}`})]})}),o.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"sm:hidden space-y-3",children:o.map(O=>{var Z,P;const $=I(O.timestamp);return l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${O.type==="masuk"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:O.type==="masuk"?"Masuk":"Keluar"}),l.jsxs("div",{className:`inline-flex items-center space-x-1 px-2 py-0.5 rounded-full text-xs font-medium ${B(O.status)}`,children:[z(O.status),l.jsx("span",{children:U(O.status)})]})]}),l.jsx("div",{className:"text-xs text-gray-500",children:$.time})]}),l.jsx("div",{className:"text-sm font-medium text-gray-900 mb-1",children:$.date}),a==="admin"&&l.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:[((Z=O.profiles)==null?void 0:Z.name)||"Unknown"," • ",((P=O.profiles)==null?void 0:P.department)||"-"]}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[l.jsx("span",{children:O.is_late?l.jsxs("span",{className:"text-red-600",children:["Terlambat ",O.late_minutes," menit"]}):l.jsx("span",{className:"text-green-600",children:"Tepat Waktu"})}),l.jsx("span",{children:O.work_hours>0?`${O.work_hours} jam`:"-"})]})]},O.id)})}),l.jsx("div",{className:"hidden sm:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal & Waktu"}),a==="admin"&&l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jenis"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterlambatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jam Kerja"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lokasi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(O=>{var Z,P;const $=I(O.timestamp);return l.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer transition",onClick:()=>g(O),children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.date}),l.jsx("div",{className:"text-sm text-gray-500",children:$.time})]})}),a==="admin"&&l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Z=O.profiles)==null?void 0:Z.name)||"Unknown"}),l.jsx("div",{className:"text-sm text-gray-500",children:((P=O.profiles)==null?void 0:P.department)||"-"})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize",children:O.type==="masuk"?"Masuk":"Keluar"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:`inline-flex items-center space-x-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${B(O.status)}`,children:[z(O.status),l.jsx("span",{children:U(O.status)})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:O.is_late?l.jsx("div",{className:"text-sm text-red-600",children:l.jsxs("span",{className:"font-medium",children:[O.late_minutes," menit"]})}):l.jsx("div",{className:"text-sm text-green-600",children:l.jsx("span",{className:"font-medium",children:"Tepat Waktu"})})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:O.work_hours>0?l.jsxs("span",{children:[O.work_hours," jam"]}):l.jsx("span",{children:"-"})}),O.overtime_hours>0&&l.jsxs("div",{className:"text-xs text-blue-600",children:["Lembur: ",O.overtime_hours," jam"]})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.latitude&&O.longitude?l.jsxs("div",{className:"flex items-center",children:[l.jsx(_i,{className:"h-4 w-4 mr-1 text-gray-400"}),l.jsxs("span",{children:[O.latitude.toFixed(4),", ",O.longitude.toFixed(4)]})]}):l.jsx("span",{className:"text-gray-400",children:"Tidak ada lokasi"})})]},O.id)})})]})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Du,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada data absensi ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan filter atau periksa kembali nanti"})]})]})]}),f&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-6 relative animate-fade-in",children:[l.jsx("button",{onClick:()=>g(null),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",title:"Tutup",children:l.jsx(Rn,{className:"h-6 w-6"})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Detail Absensi"}),l.jsxs("div",{className:"mb-4 text-sm text-gray-500",children:[I(f.timestamp).date," • ",I(f.timestamp).time]}),l.jsxs("div",{className:"space-y-2",children:[a==="admin"&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Karyawan:"})," ",((q=f.profiles)==null?void 0:q.name)||"Unknown"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Jenis:"})," ",f.type==="masuk"?"Masuk":"Keluar"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),l.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ml-2 ${B(f.status)}`,children:[z(f.status),l.jsx("span",{className:"ml-1",children:U(f.status)})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Keterlambatan:"})," ",f.is_late?`${f.late_minutes} menit`:"Tepat Waktu"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Jam Kerja:"})," ",f.work_hours>0?`${f.work_hours} jam`:"-"]}),f.overtime_hours>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Lembur:"})," ",f.overtime_hours," jam"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Lokasi:"})," ",f.latitude&&f.longitude?`${f.latitude.toFixed(4)}, ${f.longitude.toFixed(4)}`:"Tidak ada lokasi"]})]})]})})]})},Hq=({onChange:e,value:t,tileContent:n,tileClassName:a,locale:r,className:i,prevLabel:s,nextLabel:o,navigationLabel:u})=>{const[c,d]=ae.useState(t||new Date),h=()=>{const w=new Date(c.getFullYear(),c.getMonth()-1,1);d(w),e&&e(w)},p=()=>{const w=new Date(c.getFullYear(),c.getMonth()+1,1);d(w),e&&e(w)},g=(w=>{const m=w.getFullYear(),x=w.getMonth(),y=new Date(m,x,1),S=new Date(m,x+1,0).getDate(),T=y.getDay(),C=[];for(let A=0;A<T;A++)C.push(null);for(let A=1;A<=S;A++)C.push(new Date(m,x,A));return C})(c),b=["Min","Sen","Sel","Rab","Kam","Jum","Sab"];return l.jsxs("div",{className:`react-calendar ${i}`,children:[l.jsxs("div",{className:"react-calendar__navigation flex items-center justify-between mb-4",children:[l.jsx("button",{onClick:h,className:"react-calendar__navigation__arrow p-2",children:s}),l.jsx("div",{className:"react-calendar__navigation__label",children:u?u({date:c}):Qh(c,"MMMM yyyy",{locale:r})}),l.jsx("button",{onClick:p,className:"react-calendar__navigation__arrow p-2",children:o})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:b.map(w=>l.jsx("div",{className:"text-center text-xs font-medium text-gray-500 p-2",children:w},w))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:g.map((w,m)=>{if(!w)return l.jsx("div",{className:"p-2"},m);const x=a?a({date:w,view:"month"}):"",y=n?n({date:w,view:"month"}):null;return l.jsxs("div",{className:`react-calendar__tile p-2 text-center text-sm ${x}`,children:[l.jsx("div",{children:w.getDate()}),y]},w.getTime())})})]})},Wq=()=>{var Ae,Ge,_e;const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState([]),[o,u]=ae.useState(null),[c,d]=ae.useState([]),[h,p]=ae.useState({thisMonth:0,onTime:0,late:0,totalHours:0,expectedSalary:0,currentMonthSalary:0,dailySalaryEarned:0}),[f,g]=ae.useState(!0),[b,w]=ae.useState(!1),[m,x]=ae.useState(!1),[y,N]=ae.useState(!1),[S,T]=ae.useState(!0),[C,A]=ae.useState(new Date),[R,L]=ae.useState({}),[j,D]=ae.useState(!0),[B,z]=ae.useState(null),[U,I]=ae.useState(new Date);ae.useMemo(()=>(a==null?void 0:a.role)==="admin",[a==null?void 0:a.role]);const F=ae.useCallback(async()=>{try{const{data:{user:de}}=await Te.auth.getUser();if(!de){e("/login");return}n(de),await Te.from("profiles").update({last_login:new Date().toISOString(),device_info:{user_agent:navigator.userAgent,timestamp:new Date().toISOString()}}).eq("id",de.id),await Promise.all([q(de.id),P(de.id),O(de.id),Z(de.id),H(),$(de.id)]).then(()=>{de&&ie(de.id,C)})}catch(de){console.error("Error checking user:",de),e("/login")}finally{g(!1)}},[e,C]);ae.useEffect(()=>{F()},[F]),ae.useEffect(()=>{const de=setInterval(()=>{I(new Date)},1e3);return()=>clearInterval(de)},[]);const q=ae.useCallback(async de=>{try{const{data:ke,error:Fe}=await Te.from("profiles").select(`
          *,
          positions(name_id, department, base_salary)
        `).eq("id",de).maybeSingle();if(Fe&&Fe.code!=="PGRST116")throw Fe;if(ke)r(ke),ke.role==="admin"&&e("/admin");else{const{data:Ze}=await Te.auth.getUser();if(Ze.user){const Xe={id:de,name:Ze.user.email.split("@")[0],full_name:Ze.user.email.split("@")[0],email:Ze.user.email,role:"karyawan",title:"Karyawan",bio:"Karyawan sistem absensi",department:"General",employee_id:`EMP${Date.now().toString().slice(-6)}`,status:"active",salary:35e5,join_date:new Date().toISOString().split("T")[0],contract_start_date:new Date().toISOString().split("T")[0],contract_type:"permanent",is_face_registered:!1},{data:oe,error:Be}=await Te.from("profiles").insert([Xe]).select().maybeSingle();!Be&&oe&&r(oe)}}}catch(ke){console.error("Error in fetchUserProfile:",ke)}},[e]),O=ae.useCallback(async de=>{try{const{data:ke,error:Fe}=await Te.from("employee_salaries").select("*").eq("user_id",de).eq("is_active",!0).maybeSingle();Fe&&Fe.code!=="PGRST116"?console.error("Salary fetch error:",Fe):ke&&u(ke)}catch(ke){console.error("Error fetching salary info:",ke)}},[]),$=ae.useCallback(async de=>{try{const{data:ke,error:Fe}=await Te.from("profiles").select(`
          bank_id,
          bank_account_number,
          bank_account_name,
          bank_info(bank_name)
        `).eq("id",de).maybeSingle();if(Fe&&Fe.code!=="PGRST116")throw Fe;z(ke)}catch(ke){console.error("Error fetching bank info:",ke)}},[]),Z=ae.useCallback(async de=>{try{const{data:ke,error:Fe}=await Te.from("attendance_warnings").select("*").eq("user_id",de).eq("is_resolved",!1).order("created_at",{ascending:!1}).limit(5);if(Fe)throw Fe;d(ke||[])}catch(ke){console.error("Error fetching warnings:",ke)}},[]),P=ae.useCallback(async de=>{try{const ke=new Date().toISOString().split("T")[0],{data:Fe,error:Ze}=await Te.from("attendance").select("*").eq("user_id",de).gte("timestamp",`${ke}T00:00:00`).lte("timestamp",`${ke}T23:59:59`).order("timestamp",{ascending:!1});if(Ze)throw Ze;s(Fe||[]),await W(Fe||[])}catch(ke){console.error("Error fetching attendance:",ke)}},[]),W=ae.useCallback(async de=>{try{const ke=new Date,Fe=new Date(ke.getFullYear(),ke.getMonth(),1),Ze=new Date(ke.getFullYear(),ke.getMonth()+1,0),{data:Xe,error:oe}=await Te.from("attendance").select("*").eq("user_id",t==null?void 0:t.id).eq("status","berhasil").gte("timestamp",Fe.toISOString()).lte("timestamp",Ze.toISOString());if(oe)throw oe;const Be=new Set,Ke=[],et=[];let He=0;Xe==null||Xe.forEach(Mt=>{const Ua=new Date(Mt.timestamp).toDateString();Mt.type==="masuk"&&(Be.add(Ua),Mt.is_late?et.push(Mt):Ke.push(Mt)),Mt.work_hours&&(He+=Mt.work_hours)});const wt=Be.size;let dt=o?o.daily_salary*22:(a==null?void 0:a.salary)||0;const _n=a!=null&&a.salary?a.salary/22*wt:0,Rt=de.filter(Mt=>Mt.type==="masuk"&&Mt.status==="berhasil").reduce((Mt,Ua)=>Mt+(Ua.daily_salary_earned||0),0);p({thisMonth:wt,onTime:Ke.length,late:et.length,totalHours:Math.round(He),expectedSalary:dt,currentMonthSalary:_n,dailySalaryEarned:Rt})}catch(ke){console.error("Error calculating stats:",ke);const Fe=de.filter(Ze=>Ze.type==="masuk"&&Ze.status==="berhasil").length;p({thisMonth:Fe,onTime:0,late:0,totalHours:0,expectedSalary:0,currentMonthSalary:0,dailySalaryEarned:0})}},[o,a==null?void 0:a.salary,t==null?void 0:t.id]),K=ae.useCallback(async()=>{try{await Te.auth.signOut(),e("/login")}catch(de){console.error("Failed to log out:",de)}},[e]),J=ae.useCallback(de=>{s(ke=>[de,...ke]),w(!1),t&&P(t.id)},[t,P]),H=ae.useCallback(async()=>{T(!0)},[]),ie=ae.useCallback(async(de,ke)=>{try{const Fe=cU(ke),Ze=uU(ke),{data:Xe,error:oe}=await Te.from("attendance").select("*").eq("user_id",de).eq("status","berhasil").gte("timestamp",Fe.toISOString()).lte("timestamp",Ze.toISOString()).order("timestamp",{ascending:!0});if(oe)throw oe;const Be={};Xe==null||Xe.forEach(Ke=>{const et=Qh(new Date(Ke.timestamp),"yyyy-MM-dd");Be[et]||(Be[et]=[]),Be[et].push(Ke)}),L(Be)}catch(Fe){console.error("Error fetching monthly attendance:",Fe)}},[]),ue=ae.useCallback(de=>{A(de),t&&ie(t.id,de)},[t,ie]),ce=ae.useCallback(()=>{if(S&&!(a!=null&&a.is_face_registered)){x(!0);return}const de=i.some(Fe=>Fe.type==="masuk"&&Fe.status==="berhasil"),ke=i.some(Fe=>Fe.type==="keluar"&&Fe.status==="berhasil");if(de&&ke){ct.fire({icon:"info",title:"Informasi",text:"Anda sudah melakukan absensi masuk dan keluar hari ini."});return}w(!0)},[a==null?void 0:a.is_face_registered,i,S]),pe=({date:de,view:ke})=>{if(ke!=="month")return null;const Fe=Qh(de,"yyyy-MM-dd"),Ze=R[Fe]||[],Xe=Ze.some(Be=>Be.type==="masuk"),oe=Ze.some(Be=>Be.type==="keluar");return d4(de)?l.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full mx-auto mt-1"}):Xe&&oe?l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mx-auto mt-1"}):Xe?l.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mx-auto mt-1"}):oe?l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mx-auto mt-1"}):de<new Date&&!v4(de)?l.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mx-auto mt-1"}):null},ve=({date:de,view:ke})=>{if(ke!=="month")return"";const Fe=Qh(de,"yyyy-MM-dd"),Ze=R[Fe]||[],Xe=Ze.some(Be=>Be.type==="masuk"),oe=Ze.some(Be=>Be.type==="keluar");return d4(de)?"bg-gray-50":Xe&&oe?"bg-green-50 border border-green-200":Xe?"bg-orange-50 border border-orange-200":de<new Date&&!v4(de)?"bg-red-50 border border-red-200":""},De=ae.useCallback(de=>{switch(de){case"berhasil":return"text-green-600 bg-green-100";case"wajah_tidak_valid":return"text-red-600 bg-red-100";case"lokasi_tidak_valid":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}},[]),Re=ae.useCallback(de=>{switch(de){case"berhasil":return l.jsx(Vt,{className:"h-3 w-3"});case"wajah_tidak_valid":case"lokasi_tidak_valid":return l.jsx(Rn,{className:"h-3 w-3"});default:return l.jsx(Ln,{className:"h-3 w-3"})}},[]),we=ae.useCallback(de=>{switch(de){case"karyawan":return"Karyawan";case"admin":return"Administrator";default:return"Karyawan"}},[]);ae.useCallback(de=>{switch(de){case 1:return"bg-yellow-100 text-yellow-800 border-yellow-200";case 2:return"bg-orange-100 text-orange-800 border-orange-200";case 3:return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},[]);const xe=ae.useCallback(de=>new Date(de).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),[]);ae.useCallback(de=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(de),[]);const ne=i.some(de=>de.type==="masuk"&&de.status==="berhasil"),Qe=i.some(de=>de.type==="keluar"&&de.status==="berhasil"),Je=!ne||ne&&!Qe;return f?l.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-2 text-xs font-medium",children:"Memuat dashboard..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:[l.jsx("div",{className:"bg-white shadow-md border-b sticky top-0 z-10",children:l.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm",children:l.jsx(ar,{className:"h-5 w-5 text-white"})}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h1",{className:"text-base sm:text-lg font-bold text-gray-900 truncate",children:(a==null?void 0:a.full_name)||(a==null?void 0:a.name)||"Karyawan"}),l.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[l.jsx("span",{className:"font-medium",children:we(a==null?void 0:a.role)}),((Ae=a==null?void 0:a.positions)==null?void 0:Ae.name_id)&&l.jsxs("span",{className:"hidden sm:inline",children:["• ",a.positions.name_id]}),(a==null?void 0:a.employee_id)&&l.jsxs("span",{className:"hidden sm:inline",children:["• ID: ",a.employee_id]})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[l.jsxs("div",{className:"text-right hidden sm:block",children:[l.jsx("div",{className:"text-lg font-bold text-gray-900",children:U.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),l.jsx("div",{className:"text-xs text-gray-500",children:U.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),l.jsxs("div",{className:"text-right sm:hidden",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900",children:U.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}),l.jsx("div",{className:"text-[0.65rem] text-gray-500",children:U.toLocaleDateString("id-ID",{day:"numeric",month:"short"})})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"hidden sm:block",children:l.jsx(uA,{userId:t==null?void 0:t.id,userRole:a==null?void 0:a.role})}),l.jsx("button",{onClick:()=>x(!0),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded-full transition-colors duration-200 hover:shadow-sm",title:"Edit Profil",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>N(!0),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded-full transition-colors duration-200 hover:shadow-sm",title:"Riwayat Absensi",children:l.jsx(_5,{className:"h-4 w-4"})}),l.jsx("button",{onClick:K,className:"p-1.5 text-red-600 hover:bg-red-100 rounded-full transition-colors duration-200 hover:shadow-sm",title:"Keluar",children:l.jsx(W4,{className:"h-4 w-4"})})]})]})]})})}),l.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6 flex-1",children:[!(a!=null&&a.is_face_registered)&&l.jsx("div",{className:"mb-3 p-2 bg-yellow-50 rounded-md border border-yellow-200 shadow-sm",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ln,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-yellow-800 font-medium text-[0.7rem]",children:"Profil Belum Lengkap"}),l.jsx("button",{onClick:()=>x(!0),className:"text-[0.65rem] text-yellow-700 underline hover:text-yellow-800",children:"Lengkapi Sekarang"})]})]})}),c.length>0&&l.jsx("div",{className:"mb-3 p-2 bg-red-50 rounded-md border border-red-200 shadow-sm",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(lo,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("p",{className:"text-red-800 font-medium text-[0.7rem]",children:["Peringatan (",c.length,")"]}),l.jsxs("p",{className:"text-red-600 text-[0.65rem]",children:[(Ge=c[0])==null?void 0:Ge.description,c.length>1&&` +${c.length-1} lainnya`]})]})]})}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[l.jsx(Xm,{icon:Du,title:"Hadir",value:`${h.thisMonth} hari`,color:"blue"}),l.jsx(Xm,{icon:Vt,title:"Tepat Waktu",value:h.onTime,color:"green"}),l.jsx(Xm,{icon:Ln,title:"Terlambat",value:h.late,color:"orange"}),l.jsx(Xm,{icon:kf,title:"Jam Kerja",value:`${h.totalHours} jam`,color:"blue"})]}),l.jsxs("div",{className:"mb-4 bg-gradient-to-br from-indigo-600 to-blue-600 text-white rounded-lg shadow-md p-4 transform hover:scale-[1.01] transition-all duration-200",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"bg-white bg-opacity-20 p-2 rounded-full",children:l.jsx(xo,{className:"h-5 w-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-semibold",children:"Informasi Bank"}),l.jsx("p",{className:"text-xs opacity-80",children:((_e=B==null?void 0:B.bank_info)==null?void 0:_e.bank_name)||"Belum ada bank terdaftar"})]})]})}),l.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-[0.65rem] opacity-80",children:"Nomor Rekening"}),l.jsx("p",{className:"text-xs font-medium",children:(B==null?void 0:B.bank_account_number)||"-"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[0.65rem] opacity-80",children:"Nama Pemilik"}),l.jsx("p",{className:"text-xs font-medium",children:(B==null?void 0:B.bank_account_name)||"-"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3 sm:p-4 mb-4 border border-gray-100",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Xi,{className:"h-4 w-4 text-blue-600"}),l.jsx("h2",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Absensi Hari Ini"})]}),l.jsx("button",{onClick:()=>D(!j),className:"text-[0.65rem] sm:text-xs text-blue-600 hover:text-blue-800 font-medium hidden sm:block",children:j?"Sembunyikan Kalender":"Tampilkan Kalender"})]}),l.jsxs("div",{className:"space-y-3",children:[(()=>{const de=i.find(Fe=>Fe.type==="masuk"&&Fe.status==="berhasil"),ke=i.find(Fe=>Fe.type==="keluar"&&Fe.status==="berhasil");return!de&&!ke?l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:l.jsx(Xi,{className:"h-6 w-6 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Belum ada absensi hari ini"})]}):l.jsxs("div",{className:"space-y-2",children:[de&&l.jsx("div",{className:"flex items-center justify-between p-2 sm:p-2 bg-gray-50 rounded-lg shadow-sm hover:bg-gray-100 transition-colors duration-200",children:l.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[l.jsxs("div",{className:`flex items-center space-x-1 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-[0.6rem] sm:text-[0.65rem] font-medium ${De(de.status)}`,children:[Re(de.status),l.jsx("span",{className:"capitalize",children:"Masuk"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-2",children:[l.jsx("span",{className:"text-[0.65rem] sm:text-xs text-gray-600",children:xe(de.timestamp)}),de.is_late&&l.jsxs("span",{className:"text-[0.6rem] sm:text-[0.65rem] text-red-600 bg-red-100 px-1 sm:px-1.5 py-0.5 rounded mt-0.5 sm:mt-0 sm:ml-2",children:["Terlambat ",de.late_minutes," menit"]})]})]})}),ke&&l.jsx("div",{className:"flex items-center justify-between p-2 sm:p-2 bg-gray-50 rounded-lg shadow-sm hover:bg-gray-100 transition-colors duration-200",children:l.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[l.jsxs("div",{className:`flex items-center space-x-1 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-[0.6rem] sm:text-[0.65rem] font-medium ${De(ke.status)}`,children:[Re(ke.status),l.jsx("span",{className:"capitalize",children:"Keluar"})]}),l.jsx("div",{children:l.jsx("span",{className:"text-[0.65rem] sm:text-xs text-gray-600",children:xe(ke.timestamp)})})]})}),l.jsx("div",{className:"mt-2 sm:mt-3 p-2 bg-blue-50 rounded-lg shadow-sm",children:l.jsxs("div",{className:"text-[0.65rem] sm:text-xs grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Masuk:"}),l.jsx("span",{className:ne?"text-green-600":"text-gray-600",children:ne?"✓ Sudah":"○ Belum"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Keluar:"}),l.jsx("span",{className:Qe?"text-green-600":"text-gray-600",children:Qe?"✓ Sudah":"○ Belum"})]})]})})]})})(),Je&&l.jsx("button",{onClick:ce,className:"w-full mt-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-2 px-4 rounded-lg font-medium hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02] shadow-sm",children:ne?"Absen Keluar":"Absen Masuk"}),!Je&&l.jsx("div",{className:"w-full mt-3 bg-gray-100 text-gray-500 py-2 px-4 rounded-lg font-medium text-center shadow-sm text-xs",children:"Absensi hari ini sudah selesai"})]})]}),j&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border border-gray-100 hidden sm:block",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[l.jsx(_5,{className:"h-4 w-4 text-blue-600"}),l.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Kalender Absensi"})]}),l.jsx(Hq,{onChange:ue,value:C,tileContent:pe,tileClassName:ve,locale:x4,className:"w-full border-0 text-xs",prevLabel:l.jsx(Gb,{className:"h-4 w-4 text-gray-600"}),nextLabel:l.jsx(kE,{className:"h-4 w-4 text-gray-600"}),navigationLabel:({date:de})=>l.jsx("span",{className:"text-sm font-semibold",children:Qh(de,"MMMM yyyy",{locale:x4})})}),l.jsxs("div",{className:"mt-3 p-2 bg-gray-50 rounded-lg shadow-sm",children:[l.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Keterangan:"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[0.65rem]",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),l.jsx("span",{children:"Lengkap"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mr-2"}),l.jsx("span",{children:"Masuk Saja"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mr-2"}),l.jsx("span",{children:"Tidak Hadir"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full mr-2"}),l.jsx("span",{children:"Libur"})]})]})]})]})]}),m&&l.jsx(Gq,{user:t,profile:a,onClose:()=>{x(!1),q(t.id),$(t.id)}}),b&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg max-h-[85vh] overflow-y-auto animate-fade-in",children:[l.jsx("button",{onClick:()=>w(!1),className:"absolute top-2 right-2 bg-white rounded-full p-1 shadow-sm hover:bg-gray-50",children:l.jsx(Rn,{className:"h-5 w-5 text-gray-600"})}),l.jsx(qq,{user:{id:t.id,avatar_url:a==null?void 0:a.avatar_url},onAttendanceSubmitted:J,todayAttendance:i})]})}),y&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"max-w-4xl w-full bg-white rounded-lg shadow-lg max-h-[85vh] overflow-y-auto animate-fade-in",children:[l.jsx("button",{onClick:()=>N(!1),className:"absolute top-2 right-2 bg-white rounded-full p-1 shadow-sm hover:bg-gray-50",children:l.jsx(Rn,{className:"h-5 w-5 text-gray-600"})}),l.jsx(cA,{})]})})]})},Xm=({icon:e,title:t,value:n,color:a})=>{const r={blue:{bg:"bg-blue-100",text:"text-blue-600",gradient:"bg-gradient-to-r from-blue-500 to-indigo-600"},green:{bg:"bg-green-100",text:"text-green-600",gradient:"bg-gradient-to-r from-green-500 to-emerald-600"},orange:{bg:"bg-orange-100",text:"text-orange-600",gradient:"bg-gradient-to-r from-orange-500 to-amber-600"},purple:{bg:"bg-purple-100",text:"text-purple-600",gradient:"bg-gradient-to-r from-purple-500 to-indigo-600"}},i=r[a]||r.blue;return l.jsx("div",{className:"bg-white rounded-lg shadow-sm p-3 hover:shadow-md transition-all duration-200 transform hover:scale-[1.02]",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-8 h-8 ${i.gradient} rounded-md flex items-center justify-center flex-shrink-0 shadow-sm`,children:l.jsx(e,{className:"h-4 w-4 text-white"})}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("p",{className:"text-[0.65rem] font-medium text-gray-600 truncate",children:t}),l.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:n})]})]})})},Gq=({user:e,profile:t,onClose:n})=>{const[a,r]=ae.useState("profile"),[i,s]=ae.useState(!1),[o,u]=ae.useState([]),[c,d]=ae.useState({name:(t==null?void 0:t.name)||"",full_name:(t==null?void 0:t.full_name)||"",phone:(t==null?void 0:t.phone)||"",location:(t==null?void 0:t.location)||"",bio:(t==null?void 0:t.bio)||""}),[h,p]=ae.useState({bank_id:(t==null?void 0:t.bank_id)||"",bank_account_number:(t==null?void 0:t.bank_account_number)||"",bank_account_name:(t==null?void 0:t.bank_account_name)||(t==null?void 0:t.full_name)||""}),[f,g]=ae.useState(null),[b,w]=ae.useState({newPassword:"",confirmPassword:""});ae.useEffect(()=>{(async()=>{try{const{data:N,error:S}=await Te.from("bank_info").select("*").eq("is_active",!0).order("bank_name");if(S)throw S;u(N||[])}catch(N){console.error("Error fetching banks:",N)}})()},[]),ae.useEffect(()=>{if(o.length>0&&h.bank_id){const y=o.find(N=>N.id===h.bank_id);g(y)}},[o,h.bank_id]);const m=async y=>{y.preventDefault(),s(!0);try{const{error:N}=await Te.from("profiles").update({full_name:c.full_name,phone:c.phone,updated_at:new Date().toISOString()}).eq("id",e.id);if(N)throw N;await ct.fire({icon:"success",title:"Berhasil",text:"Profil berhasil diperbarui!"}),n()}catch(N){await ct.fire({icon:"error",title:"Gagal",text:N.message||"Gagal memperbarui profil."})}finally{s(!1)}},x=async y=>{if(y.preventDefault(),s(!0),b.newPassword!==b.confirmPassword){await ct.fire({icon:"error",title:"Gagal",text:"Password dan konfirmasi tidak sama."}),s(!1);return}try{const{error:N}=await Te.auth.updateUser({password:b.newPassword});if(N)throw N;await ct.fire({icon:"success",title:"Berhasil",text:"Password berhasil diubah!"}),w({newPassword:"",confirmPassword:""}),n()}catch(N){await ct.fire({icon:"error",title:"Gagal",text:N.message||"Gagal mengubah password."})}finally{s(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] flex flex-col animate-fade-in",children:[l.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-xl",children:[l.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Kelola Profil"}),l.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-white/50 transition-colors duration-200","aria-label":"Tutup",children:l.jsx(Rn,{className:"h-5 w-5 text-gray-600"})})]}),l.jsx("div",{className:"flex border-b border-gray-100",children:[{key:"profile",label:"Profil",icon:ar},{key:"bank",label:"Bank",icon:xo},{key:"password",label:"Password",icon:vg}].map(({key:y,label:N,icon:S})=>l.jsxs("button",{className:`flex-1 px-3 py-3 text-xs font-medium transition-all duration-200 flex items-center justify-center space-x-1 ${a===y?"border-b-2 border-blue-500 text-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,onClick:()=>r(y),children:[l.jsx(S,{className:"h-3 w-3"}),l.jsx("span",{children:N})]},y))}),l.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[a==="profile"&&l.jsxs("form",{onSubmit:m,className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 text-sm",value:c.full_name,onChange:y=>d({...c,full_name:y.target.value}),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),l.jsx("input",{type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-500 cursor-not-allowed text-sm",value:(t==null?void 0:t.email)||"",disabled:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"No. Telepon"}),l.jsx("input",{type:"tel",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 text-sm",value:c.phone,onChange:y=>d({...c,phone:y.target.value}),placeholder:"Masukkan nomor telepon"})]})]}),a==="bank"&&l.jsxs("div",{className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(xo,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"font-semibold text-blue-800",children:"Informasi Bank"})]}),l.jsx("p",{className:"text-sm text-blue-600",children:"Data bank hanya dapat di ubah, silahkan hubungi pihak kantor"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank"}),l.jsxs("div",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-500 text-sm flex items-center space-x-2",children:[f&&l.jsx("img",{src:"/default-bank.png",alt:f.bank_name,className:"w-6 h-6 object-contain",onError:y=>{y.target.style.display="none"}}),l.jsx("span",{children:(f==null?void 0:f.bank_name)||"Belum ada bank terdaftar"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nomor Rekening"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-500 cursor-not-allowed text-sm",value:h.bank_account_number||"-",disabled:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Pemilik Rekening"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-500 cursor-not-allowed text-sm",value:h.bank_account_name||"-",disabled:!0})]}),l.jsx("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(Ln,{className:"h-4 w-4 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"Informasi Penting"}),l.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Data bank hanya dapat diubah oleh bagian HRD untuk keamanan. Hubungi HRD jika perlu mengubah data bank."})]})]})})]})]}),a==="password"&&l.jsxs("form",{onSubmit:x,className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(vg,{className:"h-5 w-5 text-yellow-600"}),l.jsx("h3",{className:"font-semibold text-yellow-800",children:"Keamanan Akun"})]}),l.jsx("p",{className:"text-sm text-yellow-600",children:"Ubah password untuk menjaga keamanan akun Anda"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Baru"}),l.jsx("input",{type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 text-sm",value:b.newPassword,onChange:y=>w({...b,newPassword:y.target.value}),placeholder:"Masukkan password baru",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Password"}),l.jsx("input",{type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 text-sm",value:b.confirmPassword,onChange:y=>w({...b,confirmPassword:y.target.value}),placeholder:"Ulangi password baru",required:!0})]})]})]}),l.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end gap-3 rounded-b-xl",children:[l.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors duration-200 text-sm font-medium",children:a==="bank"?"Tutup":"Batal"}),a==="profile"&&l.jsx("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02] text-sm font-medium shadow-md",disabled:i,children:i?"Menyimpan...":"Simpan"}),a==="password"&&l.jsx("button",{onClick:x,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02] text-sm font-medium shadow-md",disabled:i,children:i?"Menyimpan...":"Ubah Password"})]})]})})};function ln(e){"@babel/helpers - typeof";return ln=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ln(e)}var Qa=Uint8Array,$r=Uint16Array,$w=Int32Array,Tv=new Qa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Rv=new Qa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),by=new Qa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dA=function(e,t){for(var n=new $r(31),a=0;a<31;++a)n[a]=t+=1<<e[a-1];for(var r=new $w(n[30]),a=1;a<30;++a)for(var i=n[a];i<n[a+1];++i)r[i]=i-n[a]<<5|a;return{b:n,r}},hA=dA(Tv,2),fA=hA.b,yy=hA.r;fA[28]=258,yy[258]=28;var pA=dA(Rv,0),Vq=pA.b,b4=pA.r,wy=new $r(32768);for(var kn=0;kn<32768;++kn){var Yo=(kn&43690)>>1|(kn&21845)<<1;Yo=(Yo&52428)>>2|(Yo&13107)<<2,Yo=(Yo&61680)>>4|(Yo&3855)<<4,wy[kn]=((Yo&65280)>>8|(Yo&255)<<8)>>1}var Rs=function(e,t,n){for(var a=e.length,r=0,i=new $r(t);r<a;++r)e[r]&&++i[e[r]-1];var s=new $r(t);for(r=1;r<t;++r)s[r]=s[r-1]+i[r-1]<<1;var o;if(n){o=new $r(1<<t);var u=15-t;for(r=0;r<a;++r)if(e[r])for(var c=r<<4|e[r],d=t-e[r],h=s[e[r]-1]++<<d,p=h|(1<<d)-1;h<=p;++h)o[wy[h]>>u]=c}else for(o=new $r(a),r=0;r<a;++r)e[r]&&(o[r]=wy[s[e[r]-1]++]>>15-e[r]);return o},Ml=new Qa(288);for(var kn=0;kn<144;++kn)Ml[kn]=8;for(var kn=144;kn<256;++kn)Ml[kn]=9;for(var kn=256;kn<280;++kn)Ml[kn]=7;for(var kn=280;kn<288;++kn)Ml[kn]=8;var $f=new Qa(32);for(var kn=0;kn<32;++kn)$f[kn]=5;var Kq=Rs(Ml,9,0),$q=Rs(Ml,9,1),Yq=Rs($f,5,0),Xq=Rs($f,5,1),Pb=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},qi=function(e,t,n){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&n},Mb=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},Yw=function(e){return(e+7)/8|0},mA=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new Qa(e.subarray(t,n))},Jq=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Wi=function(e,t,n){var a=new Error(t||Jq[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,Wi),!n)throw a;return a},Qq=function(e,t,n,a){var r=e.length,i=0;if(!r||t.f&&!t.l)return n||new Qa(0);var s=!n,o=s||t.i!=2,u=t.i;s&&(n=new Qa(r*3));var c=function(ve){var De=n.length;if(ve>De){var Re=new Qa(Math.max(De*2,ve));Re.set(n),n=Re}},d=t.f||0,h=t.p||0,p=t.b||0,f=t.l,g=t.d,b=t.m,w=t.n,m=r*8;do{if(!f){d=qi(e,h,1);var x=qi(e,h+1,3);if(h+=3,x)if(x==1)f=$q,g=Xq,b=9,w=5;else if(x==2){var T=qi(e,h,31)+257,C=qi(e,h+10,15)+4,A=T+qi(e,h+5,31)+1;h+=14;for(var R=new Qa(A),L=new Qa(19),j=0;j<C;++j)L[by[j]]=qi(e,h+j*3,7);h+=C*3;for(var D=Pb(L),B=(1<<D)-1,z=Rs(L,D,1),j=0;j<A;){var U=z[qi(e,h,B)];h+=U&15;var y=U>>4;if(y<16)R[j++]=y;else{var I=0,F=0;for(y==16?(F=3+qi(e,h,3),h+=2,I=R[j-1]):y==17?(F=3+qi(e,h,7),h+=3):y==18&&(F=11+qi(e,h,127),h+=7);F--;)R[j++]=I}}var q=R.subarray(0,T),O=R.subarray(T);b=Pb(q),w=Pb(O),f=Rs(q,b,1),g=Rs(O,w,1)}else Wi(1);else{var y=Yw(h)+4,N=e[y-4]|e[y-3]<<8,S=y+N;if(S>r){u&&Wi(0);break}o&&c(p+N),n.set(e.subarray(y,S),p),t.b=p+=N,t.p=h=S*8,t.f=d;continue}if(h>m){u&&Wi(0);break}}o&&c(p+131072);for(var $=(1<<b)-1,Z=(1<<w)-1,P=h;;P=h){var I=f[Mb(e,h)&$],W=I>>4;if(h+=I&15,h>m){u&&Wi(0);break}if(I||Wi(2),W<256)n[p++]=W;else if(W==256){P=h,f=null;break}else{var K=W-254;if(W>264){var j=W-257,J=Tv[j];K=qi(e,h,(1<<J)-1)+fA[j],h+=J}var H=g[Mb(e,h)&Z],ie=H>>4;H||Wi(3),h+=H&15;var O=Vq[ie];if(ie>3){var J=Rv[ie];O+=Mb(e,h)&(1<<J)-1,h+=J}if(h>m){u&&Wi(0);break}o&&c(p+131072);var ue=p+K;if(p<O){var ce=i-O,pe=Math.min(O,ue);for(ce+p<0&&Wi(3);p<pe;++p)n[p]=a[ce+p]}for(;p<ue;++p)n[p]=n[p-O]}}t.l=f,t.p=P,t.b=p,t.f=d,f&&(d=1,t.m=b,t.d=g,t.n=w)}while(!d);return p!=n.length&&s?mA(n,0,p):n.subarray(0,p)},ao=function(e,t,n){n<<=t&7;var a=t/8|0;e[a]|=n,e[a+1]|=n>>8},Vh=function(e,t,n){n<<=t&7;var a=t/8|0;e[a]|=n,e[a+1]|=n>>8,e[a+2]|=n>>16},Ib=function(e,t){for(var n=[],a=0;a<e.length;++a)e[a]&&n.push({s:a,f:e[a]});var r=n.length,i=n.slice();if(!r)return{t:vA,l:0};if(r==1){var s=new Qa(n[0].s+1);return s[n[0].s]=1,{t:s,l:1}}n.sort(function(S,T){return S.f-T.f}),n.push({s:-1,f:25001});var o=n[0],u=n[1],c=0,d=1,h=2;for(n[0]={s:-1,f:o.f+u.f,l:o,r:u};d!=r-1;)o=n[n[c].f<n[h].f?c++:h++],u=n[c!=d&&n[c].f<n[h].f?c++:h++],n[d++]={s:-1,f:o.f+u.f,l:o,r:u};for(var p=i[0].s,a=1;a<r;++a)i[a].s>p&&(p=i[a].s);var f=new $r(p+1),g=Ny(n[d-1],f,0);if(g>t){var a=0,b=0,w=g-t,m=1<<w;for(i.sort(function(T,C){return f[C.s]-f[T.s]||T.f-C.f});a<r;++a){var x=i[a].s;if(f[x]>t)b+=m-(1<<g-f[x]),f[x]=t;else break}for(b>>=w;b>0;){var y=i[a].s;f[y]<t?b-=1<<t-f[y]++-1:++a}for(;a>=0&&b;--a){var N=i[a].s;f[N]==t&&(--f[N],++b)}g=t}return{t:new Qa(f),l:g}},Ny=function(e,t,n){return e.s==-1?Math.max(Ny(e.l,t,n+1),Ny(e.r,t,n+1)):t[e.s]=n},y4=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new $r(++t),a=0,r=e[0],i=1,s=function(u){n[a++]=u},o=1;o<=t;++o)if(e[o]==r&&o!=t)++i;else{if(!r&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(r),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(r);i=1,r=e[o]}return{c:n.subarray(0,a),n:t}},Kh=function(e,t){for(var n=0,a=0;a<t.length;++a)n+=e[a]*t[a];return n},gA=function(e,t,n){var a=n.length,r=Yw(t+2);e[r]=a&255,e[r+1]=a>>8,e[r+2]=e[r]^255,e[r+3]=e[r+1]^255;for(var i=0;i<a;++i)e[r+i+4]=n[i];return(r+4+a)*8},w4=function(e,t,n,a,r,i,s,o,u,c,d){ao(t,d++,n),++r[256];for(var h=Ib(r,15),p=h.t,f=h.l,g=Ib(i,15),b=g.t,w=g.l,m=y4(p),x=m.c,y=m.n,N=y4(b),S=N.c,T=N.n,C=new $r(19),A=0;A<x.length;++A)++C[x[A]&31];for(var A=0;A<S.length;++A)++C[S[A]&31];for(var R=Ib(C,7),L=R.t,j=R.l,D=19;D>4&&!L[by[D-1]];--D);var B=c+5<<3,z=Kh(r,Ml)+Kh(i,$f)+s,U=Kh(r,p)+Kh(i,b)+s+14+3*D+Kh(C,L)+2*C[16]+3*C[17]+7*C[18];if(u>=0&&B<=z&&B<=U)return gA(t,d,e.subarray(u,u+c));var I,F,q,O;if(ao(t,d,1+(U<z)),d+=2,U<z){I=Rs(p,f,0),F=p,q=Rs(b,w,0),O=b;var $=Rs(L,j,0);ao(t,d,y-257),ao(t,d+5,T-1),ao(t,d+10,D-4),d+=14;for(var A=0;A<D;++A)ao(t,d+3*A,L[by[A]]);d+=3*D;for(var Z=[x,S],P=0;P<2;++P)for(var W=Z[P],A=0;A<W.length;++A){var K=W[A]&31;ao(t,d,$[K]),d+=L[K],K>15&&(ao(t,d,W[A]>>5&127),d+=W[A]>>12)}}else I=Kq,F=Ml,q=Yq,O=$f;for(var A=0;A<o;++A){var J=a[A];if(J>255){var K=J>>18&31;Vh(t,d,I[K+257]),d+=F[K+257],K>7&&(ao(t,d,J>>23&31),d+=Tv[K]);var H=J&31;Vh(t,d,q[H]),d+=O[H],H>3&&(Vh(t,d,J>>5&8191),d+=Rv[H])}else Vh(t,d,I[J]),d+=F[J]}return Vh(t,d,I[256]),d+F[256]},Zq=new $w([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vA=new Qa(0),eH=function(e,t,n,a,r,i){var s=i.z||e.length,o=new Qa(a+s+5*(1+Math.ceil(s/7e3))+r),u=o.subarray(a,o.length-r),c=i.l,d=(i.r||0)&7;if(t){d&&(u[0]=i.r>>3);for(var h=Zq[t-1],p=h>>13,f=h&8191,g=(1<<n)-1,b=i.p||new $r(32768),w=i.h||new $r(g+1),m=Math.ceil(n/3),x=2*m,y=function(we){return(e[we]^e[we+1]<<m^e[we+2]<<x)&g},N=new $w(25e3),S=new $r(288),T=new $r(32),C=0,A=0,R=i.i||0,L=0,j=i.w||0,D=0;R+2<s;++R){var B=y(R),z=R&32767,U=w[B];if(b[z]=U,w[B]=z,j<=R){var I=s-R;if((C>7e3||L>24576)&&(I>423||!c)){d=w4(e,u,0,N,S,T,A,L,D,R-D,d),L=C=A=0,D=R;for(var F=0;F<286;++F)S[F]=0;for(var F=0;F<30;++F)T[F]=0}var q=2,O=0,$=f,Z=z-U&32767;if(I>2&&B==y(R-Z))for(var P=Math.min(p,I)-1,W=Math.min(32767,R),K=Math.min(258,I);Z<=W&&--$&&z!=U;){if(e[R+q]==e[R+q-Z]){for(var J=0;J<K&&e[R+J]==e[R+J-Z];++J);if(J>q){if(q=J,O=Z,J>P)break;for(var H=Math.min(Z,J-2),ie=0,F=0;F<H;++F){var ue=R-Z+F&32767,ce=b[ue],pe=ue-ce&32767;pe>ie&&(ie=pe,U=ue)}}}z=U,U=b[z],Z+=z-U&32767}if(O){N[L++]=268435456|yy[q]<<18|b4[O];var ve=yy[q]&31,De=b4[O]&31;A+=Tv[ve]+Rv[De],++S[257+ve],++T[De],j=R+q,++C}else N[L++]=e[R],++S[e[R]]}}for(R=Math.max(R,j);R<s;++R)N[L++]=e[R],++S[e[R]];d=w4(e,u,c,N,S,T,A,L,D,R-D,d),c||(i.r=d&7|u[d/8|0]<<3,d-=7,i.h=w,i.p=b,i.i=R,i.w=j)}else{for(var R=i.w||0;R<s+c;R+=65535){var Re=R+65535;Re>=s&&(u[d/8|0]=c,Re=s),d=gA(u,d+1,e.subarray(R,Re))}i.i=s}return mA(o,0,a+Yw(d)+r)},xA=function(){var e=1,t=0;return{p:function(n){for(var a=e,r=t,i=n.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)r+=a+=n[s];a=(a&65535)+15*(a>>16),r=(r&65535)+15*(r>>16)}e=a,t=r},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},tH=function(e,t,n,a,r){if(!r&&(r={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Qa(i.length+e.length);s.set(i),s.set(e,i.length),e=s,r.w=i.length}return eH(e,t.level==null?6:t.level,t.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,a,r)},bA=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},nH=function(e,t){var n=t.level,a=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var r=xA();r.p(t.dictionary),bA(e,2,r.d())}},aH=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Wi(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Wi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function ky(e,t){t||(t={});var n=xA();n.p(e);var a=tH(e,t,t.dictionary?6:2,4);return nH(a,t),bA(a,a.length-4,n.d()),a}function rH(e,t){return Qq(e.subarray(aH(e,t),-4),{i:2},t,t)}var iH=typeof TextDecoder<"u"&&new TextDecoder,sH=0;try{iH.decode(vA,{stream:!0}),sH=1}catch{}var Nt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Ob(){Nt.console&&typeof Nt.console.log=="function"&&Nt.console.log.apply(Nt.console,arguments)}var pn={log:Ob,warn:function(e){Nt.console&&(typeof Nt.console.warn=="function"?Nt.console.warn.apply(Nt.console,arguments):Ob.call(null,arguments))},error:function(e){Nt.console&&(typeof Nt.console.error=="function"?Nt.console.error.apply(Nt.console,arguments):Ob(e))}};function Fb(e,t,n){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){cu(a.response,t,n)},a.onerror=function(){pn.error("could not download file")},a.send()}function N4(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Jm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var xf,Sy,cu=Nt.saveAs||((typeof window>"u"?"undefined":ln(window))!=="object"||window!==Nt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var a=Nt.URL||Nt.webkitURL,r=document.createElement("a");t=t||e.name||"download",r.download=t,r.rel="noopener",typeof e=="string"?(r.href=e,r.origin!==location.origin?N4(r.href)?Fb(e,t,n):Jm(r,r.target="_blank"):Jm(r)):(r.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(r.href)},4e4),setTimeout(function(){Jm(r)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(N4(e))Fb(e,t,n);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){Jm(a)})}else navigator.msSaveOrOpenBlob(function(r,i){return i===void 0?i={autoBom:!1}:ln(i)!=="object"&&(pn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}(e,n),t)}:function(e,t,n,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return Fb(e,t,n);var r=e.type==="application/octet-stream",i=/constructor/i.test(Nt.HTMLElement)||Nt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||r&&i)&&(typeof FileReader>"u"?"undefined":ln(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=s?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=d:location=d,a=null},o.readAsDataURL(e)}else{var u=Nt.URL||Nt.webkitURL,c=u.createObjectURL(e);a?a.location=c:location.href=c,a=null,setTimeout(function(){u.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function yA(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],a=0;a<n.length;a++){var r=n[a].re,i=n[a].process,s=r.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),c.length==1&&(c="0"+c),"#"+o+u+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Bb(e,t){var n=e[0],a=e[1],r=e[2],i=e[3];n=Wa(n,a,r,i,t[0],7,-680876936),i=Wa(i,n,a,r,t[1],12,-389564586),r=Wa(r,i,n,a,t[2],17,606105819),a=Wa(a,r,i,n,t[3],22,-1044525330),n=Wa(n,a,r,i,t[4],7,-176418897),i=Wa(i,n,a,r,t[5],12,1200080426),r=Wa(r,i,n,a,t[6],17,-1473231341),a=Wa(a,r,i,n,t[7],22,-45705983),n=Wa(n,a,r,i,t[8],7,1770035416),i=Wa(i,n,a,r,t[9],12,-1958414417),r=Wa(r,i,n,a,t[10],17,-42063),a=Wa(a,r,i,n,t[11],22,-1990404162),n=Wa(n,a,r,i,t[12],7,1804603682),i=Wa(i,n,a,r,t[13],12,-40341101),r=Wa(r,i,n,a,t[14],17,-1502002290),n=Ga(n,a=Wa(a,r,i,n,t[15],22,1236535329),r,i,t[1],5,-165796510),i=Ga(i,n,a,r,t[6],9,-1069501632),r=Ga(r,i,n,a,t[11],14,643717713),a=Ga(a,r,i,n,t[0],20,-373897302),n=Ga(n,a,r,i,t[5],5,-701558691),i=Ga(i,n,a,r,t[10],9,38016083),r=Ga(r,i,n,a,t[15],14,-660478335),a=Ga(a,r,i,n,t[4],20,-405537848),n=Ga(n,a,r,i,t[9],5,568446438),i=Ga(i,n,a,r,t[14],9,-1019803690),r=Ga(r,i,n,a,t[3],14,-187363961),a=Ga(a,r,i,n,t[8],20,1163531501),n=Ga(n,a,r,i,t[13],5,-1444681467),i=Ga(i,n,a,r,t[2],9,-51403784),r=Ga(r,i,n,a,t[7],14,1735328473),n=Va(n,a=Ga(a,r,i,n,t[12],20,-1926607734),r,i,t[5],4,-378558),i=Va(i,n,a,r,t[8],11,-2022574463),r=Va(r,i,n,a,t[11],16,1839030562),a=Va(a,r,i,n,t[14],23,-35309556),n=Va(n,a,r,i,t[1],4,-1530992060),i=Va(i,n,a,r,t[4],11,1272893353),r=Va(r,i,n,a,t[7],16,-155497632),a=Va(a,r,i,n,t[10],23,-1094730640),n=Va(n,a,r,i,t[13],4,681279174),i=Va(i,n,a,r,t[0],11,-358537222),r=Va(r,i,n,a,t[3],16,-722521979),a=Va(a,r,i,n,t[6],23,76029189),n=Va(n,a,r,i,t[9],4,-640364487),i=Va(i,n,a,r,t[12],11,-421815835),r=Va(r,i,n,a,t[15],16,530742520),n=Ka(n,a=Va(a,r,i,n,t[2],23,-995338651),r,i,t[0],6,-198630844),i=Ka(i,n,a,r,t[7],10,1126891415),r=Ka(r,i,n,a,t[14],15,-1416354905),a=Ka(a,r,i,n,t[5],21,-57434055),n=Ka(n,a,r,i,t[12],6,1700485571),i=Ka(i,n,a,r,t[3],10,-1894986606),r=Ka(r,i,n,a,t[10],15,-1051523),a=Ka(a,r,i,n,t[1],21,-2054922799),n=Ka(n,a,r,i,t[8],6,1873313359),i=Ka(i,n,a,r,t[15],10,-30611744),r=Ka(r,i,n,a,t[6],15,-1560198380),a=Ka(a,r,i,n,t[13],21,1309151649),n=Ka(n,a,r,i,t[4],6,-145523070),i=Ka(i,n,a,r,t[11],10,-1120210379),r=Ka(r,i,n,a,t[2],15,718787259),a=Ka(a,r,i,n,t[9],21,-343485551),e[0]=pl(n,e[0]),e[1]=pl(a,e[1]),e[2]=pl(r,e[2]),e[3]=pl(i,e[3])}function Lv(e,t,n,a,r,i){return t=pl(pl(t,e),pl(a,i)),pl(t<<r|t>>>32-r,n)}function Wa(e,t,n,a,r,i,s){return Lv(t&n|~t&a,e,t,r,i,s)}function Ga(e,t,n,a,r,i,s){return Lv(t&a|n&~a,e,t,r,i,s)}function Va(e,t,n,a,r,i,s){return Lv(t^n^a,e,t,r,i,s)}function Ka(e,t,n,a,r,i,s){return Lv(n^(t|~a),e,t,r,i,s)}function wA(e){var t,n=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Bb(a,oH(e.substring(t-64,t)));e=e.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(Bb(a,r),t=0;t<16;t++)r[t]=0;return r[14]=8*n,Bb(a,r),a}function oH(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}xf=Nt.atob.bind(Nt),Sy=Nt.btoa.bind(Nt);var k4="0123456789abcdef".split("");function lH(e){for(var t="",n=0;n<4;n++)t+=k4[e>>8*n+4&15]+k4[e>>8*n&15];return t}function uH(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function _y(e){return wA(e).map(uH).join("")}var cH=function(e){for(var t=0;t<e.length;t++)e[t]=lH(e[t]);return e.join("")}(wA("hello"))!="5d41402abc4b2a76b9719d911017c592";function pl(e,t){if(cH){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function jy(e,t){var n,a,r,i;if(e!==n){for(var s=(r=e,i=1+(256/e.length>>0),new Array(i+1).join(r)),o=[],u=0;u<256;u++)o[u]=u;var c=0;for(u=0;u<256;u++){var d=o[u];c=(c+d+s.charCodeAt(u))%256,o[u]=o[c],o[c]=d}n=e,a=o}else o=a;var h=t.length,p=0,f=0,g="";for(u=0;u<h;u++)f=(f+(d=o[p=(p+1)%256]))%256,o[p]=o[f],o[f]=d,s=o[(o[p]+o[f])%256],g+=String.fromCharCode(t.charCodeAt(u)^s);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var S4={print:4,modify:8,copy:16,"annot-forms":32};function qc(e,t,n,a){this.v=1,this.r=2;var r=192;e.forEach(function(o){if(S4.perm!==void 0)throw new Error("Invalid permission: "+o);r+=S4[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),s=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^r)),this.encryptionKey=_y(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=jy(this.encryptionKey,this.padding)}function Hc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,a=0;a<n;a++){var r=e.charCodeAt(a);r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?t+="#"+("0"+r.toString(16)).slice(-2):t+=e[a]}return t}function _4(e){if(ln(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,a,r){if(r=r||!1,typeof n!="string"||typeof a!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var i=Math.random().toString(35);return t[n][i]=[a,!!r],i},this.unsubscribe=function(n){for(var a in t)if(t[a][n])return delete t[a][n],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var a=Array.prototype.slice.call(arguments,1),r=[];for(var i in t[n]){var s=t[n][i];try{s[0].apply(e,a)}catch(o){Nt.console&&pn.error("jsPDF PubSub Error",o.message,o)}s[1]&&r.push(i)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Yf(e){if(!(this instanceof Yf))return new Yf(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function NA(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function rl(e,t,n,a,r){if(!(this instanceof rl))return new rl(e,t,n,a,r);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,NA.call(this,a,r)}function pu(e,t,n,a,r){if(!(this instanceof pu))return new pu(e,t,n,a,r);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,NA.call(this,a,r)}function xt(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],r=arguments[2],i=arguments[3],s=[],o=1,u=16,c="S",d=null;ln(e=e||{})==="object"&&(n=e.orientation,a=e.unit||a,r=e.format||r,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),a=a||"mm",n=(""+(n||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=_4;var g="1.3",b=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(_){g=_};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return w};var m=f.__private__.getPageFormat=function(_){return w[_]};r=r||"a4";var x={COMPAT:"compat",ADVANCED:"advanced"},y=x.COMPAT;function N(){this.saveGraphicsState(),ne(new yt(He,0,0,-He,0,Lo()*He).toString()+" cm"),this.setFontSize(this.getFontSize()/He),c="n",y=x.ADVANCED}function S(){this.restoreGraphicsState(),c="S",y=x.COMPAT}var T=f.__private__.combineFontStyleAndFontWeight=function(_,V){if(_=="bold"&&V=="normal"||_=="bold"&&V==400||_=="normal"&&V=="italic"||_=="bold"&&V=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return V&&(_=V==400||V==="normal"?_==="italic"?"italic":"normal":V!=700&&V!=="bold"||_!=="normal"?(V==700?"bold":V)+""+_:"bold"),_};f.advancedAPI=function(_){var V=y===x.COMPAT;return V&&N.call(this),typeof _!="function"||(_(this),V&&S.call(this)),this},f.compatAPI=function(_){var V=y===x.ADVANCED;return V&&S.call(this),typeof _!="function"||(_(this),V&&N.call(this)),this},f.isAdvancedAPI=function(){return y===x.ADVANCED};var C,A=function(_){if(y!==x.ADVANCED)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=f.roundToPrecision=f.__private__.roundToPrecision=function(_,V){var le=t||V;if(isNaN(_)||isNaN(le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(le).replace(/0+$/,"")};C=f.hpf=f.__private__.hpf=typeof u=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return R(_,u)}:u==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return R(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return R(_,16)};var L=f.f2=f.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return R(_,2)},j=f.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return R(_,3)},D=f.scale=f.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return y===x.COMPAT?_*He:y===x.ADVANCED?_:void 0},B=function(_){return y===x.COMPAT?Lo()-_:y===x.ADVANCED?_:void 0},z=function(_){return D(B(_))};f.__private__.setPrecision=f.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(t=parseInt(_,10))};var U,I="00000000000000000000000000000000",F=f.__private__.getFileId=function(){return I},q=f.__private__.setFileId=function(_){return I=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():I.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(qa=new qc(d.userPermissions,d.userPassword,d.ownerPassword,I)),I};f.setFileId=function(_){return q(_),this},f.getFileId=function(){return F()};var O=f.__private__.convertDateToPDFDate=function(_){var V=_.getTimezoneOffset(),le=V<0?"+":"-",fe=Math.floor(Math.abs(V/60)),Se=Math.abs(V%60),Ie=[le,K(fe),"'",K(Se),"'"].join("");return["D:",_.getFullYear(),K(_.getMonth()+1),K(_.getDate()),K(_.getHours()),K(_.getMinutes()),K(_.getSeconds()),Ie].join("")},$=f.__private__.convertPDFDateToDate=function(_){var V=parseInt(_.substr(2,4),10),le=parseInt(_.substr(6,2),10)-1,fe=parseInt(_.substr(8,2),10),Se=parseInt(_.substr(10,2),10),Ie=parseInt(_.substr(12,2),10),Ye=parseInt(_.substr(14,2),10);return new Date(V,le,fe,Se,Ie,Ye,0)},Z=f.__private__.setCreationDate=function(_){var V;if(_===void 0&&(_=new Date),_ instanceof Date)V=O(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");V=_}return U=V},P=f.__private__.getCreationDate=function(_){var V=U;return _==="jsDate"&&(V=$(U)),V};f.setCreationDate=function(_){return Z(_),this},f.getCreationDate=function(_){return P(_)};var W,K=f.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},J=f.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},H=0,ie=[],ue=[],ce=0,pe=[],ve=[],De=!1,Re=ue,we=function(){H=0,ce=0,ue=[],ie=[],pe=[],Hs=ea(),Li=ea()};f.__private__.setCustomOutputDestination=function(_){De=!0,Re=_};var xe=function(_){De||(Re=_)};f.__private__.resetCustomOutputDestination=function(){De=!1,Re=ue};var ne=f.__private__.out=function(_){return _=_.toString(),ce+=_.length+1,Re.push(_),Re},Qe=f.__private__.write=function(_){return ne(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},Je=f.__private__.getArrayBuffer=function(_){for(var V=_.length,le=new ArrayBuffer(V),fe=new Uint8Array(le);V--;)fe[V]=_.charCodeAt(V);return le},Ae=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Ae};var Ge=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(_){return Ge=y===x.ADVANCED?_/He:_,this};var _e,de=f.__private__.getFontSize=f.getFontSize=function(){return y===x.COMPAT?Ge:Ge*He},ke=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(_){return ke=_,this},f.__private__.getR2L=f.getR2L=function(){return ke};var Fe,Ze=f.__private__.setZoomMode=function(_){var V=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))_e=_;else if(isNaN(_)){if(V.indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');_e=_}else _e=parseInt(_,10)};f.__private__.getZoomMode=function(){return _e};var Xe,oe=f.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');Fe=_};f.__private__.getPageMode=function(){return Fe};var Be=f.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');Xe=_};f.__private__.getLayoutMode=function(){return Xe},f.__private__.setDisplayMode=f.setDisplayMode=function(_,V,le){return Ze(_),Be(V),oe(le),this};var Ke={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(_){if(Object.keys(Ke).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ke[_]},f.__private__.getDocumentProperties=function(){return Ke},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(_){for(var V in Ke)Ke.hasOwnProperty(V)&&_[V]&&(Ke[V]=_[V]);return this},f.__private__.setDocumentProperty=function(_,V){if(Object.keys(Ke).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ke[_]=V};var et,He,wt,dt,_n,Rt={},Mt={},Ua=[],Kt={},Do={},gn={},Ti={},qs=null,Mn=0,Ct=[],en=new _4(f),Hl=e.hotfixes||[],Ra={},as={},rs=[],yt=function _(V,le,fe,Se,Ie,Ye){if(!(this instanceof _))return new _(V,le,fe,Se,Ie,Ye);isNaN(V)&&(V=1),isNaN(le)&&(le=0),isNaN(fe)&&(fe=0),isNaN(Se)&&(Se=1),isNaN(Ie)&&(Ie=0),isNaN(Ye)&&(Ye=0),this._matrix=[V,le,fe,Se,Ie,Ye]};Object.defineProperty(yt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(yt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(yt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(yt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(yt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(yt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(yt.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(yt.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(yt.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(yt.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(yt.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(yt.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(yt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(yt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(yt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(yt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),yt.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(_)},yt.prototype.multiply=function(_){var V=_.sx*this.sx+_.shy*this.shx,le=_.sx*this.shy+_.shy*this.sy,fe=_.shx*this.sx+_.sy*this.shx,Se=_.shx*this.shy+_.sy*this.sy,Ie=_.tx*this.sx+_.ty*this.shx+this.tx,Ye=_.tx*this.shy+_.ty*this.sy+this.ty;return new yt(V,le,fe,Se,Ie,Ye)},yt.prototype.decompose=function(){var _=this.sx,V=this.shy,le=this.shx,fe=this.sy,Se=this.tx,Ie=this.ty,Ye=Math.sqrt(_*_+V*V),rt=(_/=Ye)*le+(V/=Ye)*fe;le-=_*rt,fe-=V*rt;var gt=Math.sqrt(le*le+fe*fe);return rt/=gt,_*(fe/=gt)<V*(le/=gt)&&(_=-_,V=-V,rt=-rt,Ye=-Ye),{scale:new yt(Ye,0,0,gt,0,0),translate:new yt(1,0,0,1,Se,Ie),rotate:new yt(_,V,-V,_,0,0),skew:new yt(1,0,rt,1,0,0)}},yt.prototype.toString=function(_){return this.join(" ")},yt.prototype.inversed=function(){var _=this.sx,V=this.shy,le=this.shx,fe=this.sy,Se=this.tx,Ie=this.ty,Ye=1/(_*fe-V*le),rt=fe*Ye,gt=-V*Ye,Tt=-le*Ye,At=_*Ye;return new yt(rt,gt,Tt,At,-rt*Se-Tt*Ie,-gt*Se-At*Ie)},yt.prototype.applyToPoint=function(_){var V=_.x*this.sx+_.y*this.shx+this.tx,le=_.x*this.shy+_.y*this.sy+this.ty;return new uc(V,le)},yt.prototype.applyToRectangle=function(_){var V=this.applyToPoint(_),le=this.applyToPoint(new uc(_.x+_.w,_.y+_.h));return new ph(V.x,V.y,le.x-V.x,le.y-V.y)},yt.prototype.clone=function(){var _=this.sx,V=this.shy,le=this.shx,fe=this.sy,Se=this.tx,Ie=this.ty;return new yt(_,V,le,fe,Se,Ie)},f.Matrix=yt;var Ri=f.matrixMult=function(_,V){return V.multiply(_)},is=new yt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=is;var pr=function(_,V){if(!Do[_]){var le=(V instanceof rl?"Sh":"P")+(Object.keys(Kt).length+1).toString(10);V.id=le,Do[_]=le,Kt[le]=V,en.publish("addPattern",V)}};f.ShadingPattern=rl,f.TilingPattern=pu,f.addShadingPattern=function(_,V){return A("addShadingPattern()"),pr(_,V),this},f.beginTilingPattern=function(_){A("beginTilingPattern()"),Kp(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},f.endTilingPattern=function(_,V){A("endTilingPattern()"),V.stream=ve[W].join(`
`),pr(_,V),en.publish("endTilingPattern",V),rs.pop().restore()};var oa=f.__private__.newObject=function(){var _=ea();return Pr(_,!0),_},ea=f.__private__.newObjectDeferred=function(){return H++,ie[H]=function(){return ce},H},Pr=function(_,V){return V=typeof V=="boolean"&&V,ie[_]=ce,V&&ne(_+" 0 obj"),_},Xu=f.__private__.newAdditionalObject=function(){var _={objId:ea(),content:""};return pe.push(_),_},Hs=ea(),Li=ea(),Pi=f.__private__.decodeColorString=function(_){var V=_.split(" ");if(V.length!==2||V[1]!=="g"&&V[1]!=="G")V.length===5&&(V[4]==="k"||V[4]==="K")&&(V=[(1-V[0])*(1-V[3]),(1-V[1])*(1-V[3]),(1-V[2])*(1-V[3]),"r"]);else{var le=parseFloat(V[0]);V=[le,le,le,"r"]}for(var fe="#",Se=0;Se<3;Se++)fe+=("0"+Math.floor(255*parseFloat(V[Se])).toString(16)).slice(-2);return fe},Mi=f.__private__.encodeColorString=function(_){var V;typeof _=="string"&&(_={ch1:_});var le=_.ch1,fe=_.ch2,Se=_.ch3,Ie=_.ch4,Ye=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof le=="string"&&le.charAt(0)!=="#"){var rt=new yA(le);if(rt.ok)le=rt.toHex();else if(!/^\d*\.?\d*$/.test(le))throw new Error('Invalid color "'+le+'" passed to jsPDF.encodeColorString.')}if(typeof le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(le)&&(le="#"+le[1]+le[1]+le[2]+le[2]+le[3]+le[3]),typeof le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(le)){var gt=parseInt(le.substr(1),16);le=gt>>16&255,fe=gt>>8&255,Se=255&gt}if(fe===void 0||Ie===void 0&&le===fe&&fe===Se)if(typeof le=="string")V=le+" "+Ye[0];else switch(_.precision){case 2:V=L(le/255)+" "+Ye[0];break;case 3:default:V=j(le/255)+" "+Ye[0]}else if(Ie===void 0||ln(Ie)==="object"){if(Ie&&!isNaN(Ie.a)&&Ie.a===0)return V=["1.","1.","1.",Ye[1]].join(" ");if(typeof le=="string")V=[le,fe,Se,Ye[1]].join(" ");else switch(_.precision){case 2:V=[L(le/255),L(fe/255),L(Se/255),Ye[1]].join(" ");break;default:case 3:V=[j(le/255),j(fe/255),j(Se/255),Ye[1]].join(" ")}}else if(typeof le=="string")V=[le,fe,Se,Ie,Ye[2]].join(" ");else switch(_.precision){case 2:V=[L(le),L(fe),L(Se),L(Ie),Ye[2]].join(" ");break;case 3:default:V=[j(le),j(fe),j(Se),j(Ie),Ye[2]].join(" ")}return V},ss=f.__private__.getFilters=function(){return s},si=f.__private__.putStream=function(_){var V=(_=_||{}).data||"",le=_.filters||ss(),fe=_.alreadyAppliedFilters||[],Se=_.addLength1||!1,Ie=V.length,Ye=_.objectId,rt=function(Ha){return Ha};if(d!==null&&Ye===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(rt=qa.encryptor(Ye,0));var gt={};le===!0&&(le=["FlateEncode"]);var Tt=_.additionalKeyValues||[],At=(gt=xt.API.processDataByFilters!==void 0?xt.API.processDataByFilters(V,le):{data:V,reverseChain:[]}).reverseChain+(Array.isArray(fe)?fe.join(" "):fe.toString());if(gt.data.length!==0&&(Tt.push({key:"Length",value:gt.data.length}),Se===!0&&Tt.push({key:"Length1",value:Ie})),At.length!=0)if(At.split("/").length-1==1)Tt.push({key:"Filter",value:At});else{Tt.push({key:"Filter",value:"["+At+"]"});for(var qt=0;qt<Tt.length;qt+=1)if(Tt[qt].key==="DecodeParms"){for(var An=[],In=0;In<gt.reverseChain.split("/").length-1;In+=1)An.push("null");An.push(Tt[qt].value),Tt[qt].value="["+An.join(" ")+"]"}}ne("<<");for(var ta=0;ta<Tt.length;ta++)ne("/"+Tt[ta].key+" "+Tt[ta].value);ne(">>"),gt.data.length!==0&&(ne("stream"),ne(rt(gt.data)),ne("endstream"))},os=f.__private__.putPage=function(_){var V=_.number,le=_.data,fe=_.objId,Se=_.contentsObjId;Pr(fe,!0),ne("<</Type /Page"),ne("/Parent "+_.rootDictionaryObjId+" 0 R"),ne("/Resources "+_.resourceDictionaryObjId+" 0 R"),ne("/MediaBox ["+parseFloat(C(_.mediaBox.bottomLeftX))+" "+parseFloat(C(_.mediaBox.bottomLeftY))+" "+C(_.mediaBox.topRightX)+" "+C(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&ne("/CropBox ["+C(_.cropBox.bottomLeftX)+" "+C(_.cropBox.bottomLeftY)+" "+C(_.cropBox.topRightX)+" "+C(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&ne("/BleedBox ["+C(_.bleedBox.bottomLeftX)+" "+C(_.bleedBox.bottomLeftY)+" "+C(_.bleedBox.topRightX)+" "+C(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&ne("/TrimBox ["+C(_.trimBox.bottomLeftX)+" "+C(_.trimBox.bottomLeftY)+" "+C(_.trimBox.topRightX)+" "+C(_.trimBox.topRightY)+"]"),_.artBox!==null&&ne("/ArtBox ["+C(_.artBox.bottomLeftX)+" "+C(_.artBox.bottomLeftY)+" "+C(_.artBox.topRightX)+" "+C(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&ne("/UserUnit "+_.userUnit),en.publish("putPage",{objId:fe,pageContext:Ct[V],pageNumber:V,page:le}),ne("/Contents "+Se+" 0 R"),ne(">>"),ne("endobj");var Ie=le.join(`
`);return y===x.ADVANCED&&(Ie+=`
Q`),Pr(Se,!0),si({data:Ie,filters:ss(),objectId:Se}),ne("endobj"),fe},Wl=f.__private__.putPages=function(){var _,V,le=[];for(_=1;_<=Mn;_++)Ct[_].objId=ea(),Ct[_].contentsObjId=ea();for(_=1;_<=Mn;_++)le.push(os({number:_,data:ve[_],objId:Ct[_].objId,contentsObjId:Ct[_].contentsObjId,mediaBox:Ct[_].mediaBox,cropBox:Ct[_].cropBox,bleedBox:Ct[_].bleedBox,trimBox:Ct[_].trimBox,artBox:Ct[_].artBox,userUnit:Ct[_].userUnit,rootDictionaryObjId:Hs,resourceDictionaryObjId:Li}));Pr(Hs,!0),ne("<</Type /Pages");var fe="/Kids [";for(V=0;V<Mn;V++)fe+=le[V]+" 0 R ";ne(fe+"]"),ne("/Count "+Mn),ne(">>"),ne("endobj"),en.publish("postPutPages")},Ju=function(_){en.publish("putFont",{font:_,out:ne,newObject:oa,putStream:si}),_.isAlreadyPutted!==!0&&(_.objectNumber=oa(),ne("<<"),ne("/Type /Font"),ne("/BaseFont /"+Hc(_.postScriptName)),ne("/Subtype /Type1"),typeof _.encoding=="string"&&ne("/Encoding /"+_.encoding),ne("/FirstChar 32"),ne("/LastChar 255"),ne(">>"),ne("endobj"))},Qu=function(){for(var _ in Rt)Rt.hasOwnProperty(_)&&(h===!1||h===!0&&p.hasOwnProperty(_))&&Ju(Rt[_])},Zu=function(_){_.objectNumber=oa();var V=[];V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Form"}),V.push({key:"BBox",value:"["+[C(_.x),C(_.y),C(_.x+_.width),C(_.y+_.height)].join(" ")+"]"}),V.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var le=_.pages[1].join(`
`);si({data:le,additionalKeyValues:V,objectId:_.objectNumber}),ne("endobj")},ec=function(){for(var _ in Ra)Ra.hasOwnProperty(_)&&Zu(Ra[_])},Ep=function(_,V){var le,fe=[],Se=1/(V-1);for(le=0;le<1;le+=Se)fe.push(le);if(fe.push(1),_[0].offset!=0){var Ie={offset:0,color:_[0].color};_.unshift(Ie)}if(_[_.length-1].offset!=1){var Ye={offset:1,color:_[_.length-1].color};_.push(Ye)}for(var rt="",gt=0,Tt=0;Tt<fe.length;Tt++){for(le=fe[Tt];le>_[gt+1].offset;)gt++;var At=_[gt].offset,qt=(le-At)/(_[gt+1].offset-At),An=_[gt].color,In=_[gt+1].color;rt+=J(Math.round((1-qt)*An[0]+qt*In[0]).toString(16))+J(Math.round((1-qt)*An[1]+qt*In[1]).toString(16))+J(Math.round((1-qt)*An[2]+qt*In[2]).toString(16))}return rt.trim()},Pv=function(_,V){V||(V=21);var le=oa(),fe=Ep(_.colors,V),Se=[];Se.push({key:"FunctionType",value:"0"}),Se.push({key:"Domain",value:"[0.0 1.0]"}),Se.push({key:"Size",value:"["+V+"]"}),Se.push({key:"BitsPerSample",value:"8"}),Se.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Se.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),si({data:fe,additionalKeyValues:Se,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:le}),ne("endobj"),_.objectNumber=oa(),ne("<< /ShadingType "+_.type),ne("/ColorSpace /DeviceRGB");var Ie="/Coords ["+C(parseFloat(_.coords[0]))+" "+C(parseFloat(_.coords[1]))+" ";_.type===2?Ie+=C(parseFloat(_.coords[2]))+" "+C(parseFloat(_.coords[3])):Ie+=C(parseFloat(_.coords[2]))+" "+C(parseFloat(_.coords[3]))+" "+C(parseFloat(_.coords[4]))+" "+C(parseFloat(_.coords[5])),ne(Ie+="]"),_.matrix&&ne("/Matrix ["+_.matrix.toString()+"]"),ne("/Function "+le+" 0 R"),ne("/Extend [true true]"),ne(">>"),ne("endobj")},Mv=function(_,V){var le=ea(),fe=oa();V.push({resourcesOid:le,objectOid:fe}),_.objectNumber=fe;var Se=[];Se.push({key:"Type",value:"/Pattern"}),Se.push({key:"PatternType",value:"1"}),Se.push({key:"PaintType",value:"1"}),Se.push({key:"TilingType",value:"1"}),Se.push({key:"BBox",value:"["+_.boundingBox.map(C).join(" ")+"]"}),Se.push({key:"XStep",value:C(_.xStep)}),Se.push({key:"YStep",value:C(_.yStep)}),Se.push({key:"Resources",value:le+" 0 R"}),_.matrix&&Se.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),si({data:_.stream,additionalKeyValues:Se,objectId:_.objectNumber}),ne("endobj")},tc=function(_){var V;for(V in Kt)Kt.hasOwnProperty(V)&&(Kt[V]instanceof rl?Pv(Kt[V]):Kt[V]instanceof pu&&Mv(Kt[V],_))},Dp=function(_){for(var V in _.objectNumber=oa(),ne("<<"),_)switch(V){case"opacity":ne("/ca "+L(_[V]));break;case"stroke-opacity":ne("/CA "+L(_[V]))}ne(">>"),ne("endobj")},Iv=function(){var _;for(_ in gn)gn.hasOwnProperty(_)&&Dp(gn[_])},rh=function(){for(var _ in ne("/XObject <<"),Ra)Ra.hasOwnProperty(_)&&Ra[_].objectNumber>=0&&ne("/"+_+" "+Ra[_].objectNumber+" 0 R");en.publish("putXobjectDict"),ne(">>")},Ov=function(){qa.oid=oa(),ne("<<"),ne("/Filter /Standard"),ne("/V "+qa.v),ne("/R "+qa.r),ne("/U <"+qa.toHexString(qa.U)+">"),ne("/O <"+qa.toHexString(qa.O)+">"),ne("/P "+qa.P),ne(">>"),ne("endobj")},Tp=function(){for(var _ in ne("/Font <<"),Rt)Rt.hasOwnProperty(_)&&(h===!1||h===!0&&p.hasOwnProperty(_))&&ne("/"+_+" "+Rt[_].objectNumber+" 0 R");ne(">>")},Fv=function(){if(Object.keys(Kt).length>0){for(var _ in ne("/Shading <<"),Kt)Kt.hasOwnProperty(_)&&Kt[_]instanceof rl&&Kt[_].objectNumber>=0&&ne("/"+_+" "+Kt[_].objectNumber+" 0 R");en.publish("putShadingPatternDict"),ne(">>")}},nc=function(_){if(Object.keys(Kt).length>0){for(var V in ne("/Pattern <<"),Kt)Kt.hasOwnProperty(V)&&Kt[V]instanceof f.TilingPattern&&Kt[V].objectNumber>=0&&Kt[V].objectNumber<_&&ne("/"+V+" "+Kt[V].objectNumber+" 0 R");en.publish("putTilingPatternDict"),ne(">>")}},Bv=function(){if(Object.keys(gn).length>0){var _;for(_ in ne("/ExtGState <<"),gn)gn.hasOwnProperty(_)&&gn[_].objectNumber>=0&&ne("/"+_+" "+gn[_].objectNumber+" 0 R");en.publish("putGStateDict"),ne(">>")}},Hn=function(_){Pr(_.resourcesOid,!0),ne("<<"),ne("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Tp(),Fv(),nc(_.objectOid),Bv(),rh(),ne(">>"),ne("endobj")},Rp=function(){var _=[];Qu(),Iv(),ec(),tc(_),en.publish("putResources"),_.forEach(Hn),Hn({resourcesOid:Li,objectOid:Number.MAX_SAFE_INTEGER}),en.publish("postPutResources")},Lp=function(){en.publish("putAdditionalObjects");for(var _=0;_<pe.length;_++){var V=pe[_];Pr(V.objId,!0),ne(V.content),ne("endobj")}en.publish("postPutAdditionalObjects")},Pp=function(_){Mt[_.fontName]=Mt[_.fontName]||{},Mt[_.fontName][_.fontStyle]=_.id},ih=function(_,V,le,fe,Se){var Ie={id:"F"+(Object.keys(Rt).length+1).toString(10),postScriptName:_,fontName:V,fontStyle:le,encoding:fe,isStandardFont:Se||!1,metadata:{}};return en.publish("addFont",{font:Ie,instance:this}),Rt[Ie.id]=Ie,Pp(Ie),Ie.id},zv=function(_){for(var V=0,le=Ae.length;V<le;V++){var fe=ih.call(this,_[V][0],_[V][1],_[V][2],Ae[V][3],!0);h===!1&&(p[fe]=!0);var Se=_[V][0].split("-");Pp({id:fe,fontName:Se[0],fontStyle:Se[1]||""})}en.publish("addFonts",{fonts:Rt,dictionary:Mt})},Ii=function(_){return _.foo=function(){try{return _.apply(this,arguments)}catch(fe){var V=fe.stack||"";~V.indexOf(" at ")&&(V=V.split(" at ")[1]);var le="Error in function "+V.split(`
`)[0].split("<")[0]+": "+fe.message;if(!Nt.console)throw new Error(le);Nt.console.error(le,fe),Nt.alert&&alert(le)}},_.foo.bar=_,_.foo},ac=function(_,V){var le,fe,Se,Ie,Ye,rt,gt,Tt,At;if(Se=(V=V||{}).sourceEncoding||"Unicode",Ye=V.outputEncoding,(V.autoencode||Ye)&&Rt[et].metadata&&Rt[et].metadata[Se]&&Rt[et].metadata[Se].encoding&&(Ie=Rt[et].metadata[Se].encoding,!Ye&&Rt[et].encoding&&(Ye=Rt[et].encoding),!Ye&&Ie.codePages&&(Ye=Ie.codePages[0]),typeof Ye=="string"&&(Ye=Ie[Ye]),Ye)){for(gt=!1,rt=[],le=0,fe=_.length;le<fe;le++)(Tt=Ye[_.charCodeAt(le)])?rt.push(String.fromCharCode(Tt)):rt.push(_[le]),rt[le].charCodeAt(0)>>8&&(gt=!0);_=rt.join("")}for(le=_.length;gt===void 0&&le!==0;)_.charCodeAt(le-1)>>8&&(gt=!0),le--;if(!gt)return _;for(rt=V.noBOM?[]:[254,255],le=0,fe=_.length;le<fe;le++){if((At=(Tt=_.charCodeAt(le))>>8)>>8)throw new Error("Character at position "+le+" of string '"+_+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");rt.push(At),rt.push(Tt-(At<<8))}return String.fromCharCode.apply(void 0,rt)},mr=f.__private__.pdfEscape=f.pdfEscape=function(_,V){return ac(_,V).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sh=f.__private__.beginPage=function(_){ve[++Mn]=[],Ct[Mn]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},Ip(Mn),xe(ve[W])},Mp=function(_,V){var le,fe,Se;switch(n=V||n,typeof _=="string"&&(le=m(_.toLowerCase()),Array.isArray(le)&&(fe=le[0],Se=le[1])),Array.isArray(_)&&(fe=_[0]*He,Se=_[1]*He),isNaN(fe)&&(fe=r[0],Se=r[1]),(fe>14400||Se>14400)&&(pn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),fe=Math.min(14400,fe),Se=Math.min(14400,Se)),r=[fe,Se],n.substr(0,1)){case"l":Se>fe&&(r=[Se,fe]);break;case"p":fe>Se&&(r=[Se,fe])}sh(r),qp(ch),ne(Oi),hh!==0&&ne(hh+" J"),fh!==0&&ne(fh+" j"),en.publish("addPage",{pageNumber:Mn})},Uv=function(_){_>0&&_<=Mn&&(ve.splice(_,1),Ct.splice(_,1),Mn--,W>Mn&&(W=Mn),this.setPage(W))},Ip=function(_){_>0&&_<=Mn&&(W=_)},qv=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return ve.length-1},Op=function(_,V,le){var fe,Se=void 0;return le=le||{},_=_!==void 0?_:Rt[et].fontName,V=V!==void 0?V:Rt[et].fontStyle,fe=_.toLowerCase(),Mt[fe]!==void 0&&Mt[fe][V]!==void 0?Se=Mt[fe][V]:Mt[_]!==void 0&&Mt[_][V]!==void 0?Se=Mt[_][V]:le.disableWarning===!1&&pn.warn("Unable to look up font label for font '"+_+"', '"+V+"'. Refer to getFontList() for available fonts."),Se||le.noFallback||(Se=Mt.times[V])==null&&(Se=Mt.times.normal),Se},Hv=f.__private__.putInfo=function(){var _=oa(),V=function(fe){return fe};for(var le in d!==null&&(V=qa.encryptor(_,0)),ne("<<"),ne("/Producer ("+mr(V("jsPDF "+xt.version))+")"),Ke)Ke.hasOwnProperty(le)&&Ke[le]&&ne("/"+le.substr(0,1).toUpperCase()+le.substr(1)+" ("+mr(V(Ke[le]))+")");ne("/CreationDate ("+mr(V(U))+")"),ne(">>"),ne("endobj")},oh=f.__private__.putCatalog=function(_){var V=(_=_||{}).rootDictionaryObjId||Hs;switch(oa(),ne("<<"),ne("/Type /Catalog"),ne("/Pages "+V+" 0 R"),_e||(_e="fullwidth"),_e){case"fullwidth":ne("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ne("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ne("/OpenAction [3 0 R /Fit]");break;case"original":ne("/OpenAction [3 0 R /XYZ null null 1]");break;default:var le=""+_e;le.substr(le.length-1)==="%"&&(_e=parseInt(_e)/100),typeof _e=="number"&&ne("/OpenAction [3 0 R /XYZ null null "+L(_e)+"]")}switch(Xe||(Xe="continuous"),Xe){case"continuous":ne("/PageLayout /OneColumn");break;case"single":ne("/PageLayout /SinglePage");break;case"two":case"twoleft":ne("/PageLayout /TwoColumnLeft");break;case"tworight":ne("/PageLayout /TwoColumnRight")}Fe&&ne("/PageMode /"+Fe),en.publish("putCatalog"),ne(">>"),ne("endobj")},Wv=f.__private__.putTrailer=function(){ne("trailer"),ne("<<"),ne("/Size "+(H+1)),ne("/Root "+H+" 0 R"),ne("/Info "+(H-1)+" 0 R"),d!==null&&ne("/Encrypt "+qa.oid+" 0 R"),ne("/ID [ <"+I+"> <"+I+"> ]"),ne(">>")},Gv=f.__private__.putHeader=function(){ne("%PDF-"+g),ne("%ºß¬à")},Vv=f.__private__.putXRef=function(){var _="0000000000";ne("xref"),ne("0 "+(H+1)),ne("0000000000 65535 f ");for(var V=1;V<=H;V++)typeof ie[V]=="function"?ne((_+ie[V]()).slice(-10)+" 00000 n "):ie[V]!==void 0?ne((_+ie[V]).slice(-10)+" 00000 n "):ne("0000000000 00000 n ")},Ws=f.__private__.buildDocument=function(){we(),xe(ue),en.publish("buildDocument"),Gv(),Wl(),Lp(),Rp(),d!==null&&Ov(),Hv(),oh();var _=ce;return Vv(),Wv(),ne("startxref"),ne(""+_),ne("%%EOF"),xe(ve[W]),ue.join(`
`)},rc=f.__private__.getBlob=function(_){return new Blob([Je(_)],{type:"application/pdf"})},ic=f.output=f.__private__.output=Ii(function(_,V){switch(typeof(V=V||{})=="string"?V={filename:V}:V.filename=V.filename||"generated.pdf",_){case void 0:return Ws();case"save":f.save(V.filename);break;case"arraybuffer":return Je(Ws());case"blob":return rc(Ws());case"bloburi":case"bloburl":if(Nt.URL!==void 0&&typeof Nt.URL.createObjectURL=="function")return Nt.URL&&Nt.URL.createObjectURL(rc(Ws()))||void 0;pn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var le="",fe=Ws();try{le=Sy(fe)}catch{le=Sy(unescape(encodeURIComponent(fe)))}return"data:application/pdf;filename="+V.filename+";base64,"+le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Nt)==="[object Window]"){var Se="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ie=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';V.pdfObjectUrl&&(Se=V.pdfObjectUrl,Ie="");var Ye='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Se+'"'+Ie+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(V)+");<\/script></body></html>",rt=Nt.open();return rt!==null&&rt.document.write(Ye),rt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Nt)==="[object Window]"){var gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(V.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+V.filename+'" width="500px" height="400px" /></body></html>',Tt=Nt.open();if(Tt!==null){Tt.document.write(gt);var At=this;Tt.document.documentElement.querySelector("#pdfViewer").onload=function(){Tt.document.title=V.filename,Tt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(At.output("bloburl"))}}return Tt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Nt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",V)+'"></iframe></body></html>',An=Nt.open();if(An!==null&&(An.document.write(qt),An.document.title=V.filename),An||typeof safari>"u")return An;break;case"datauri":case"dataurl":return Nt.document.location.href=this.output("datauristring",V);default:return null}}),Fp=function(_){return Array.isArray(Hl)===!0&&Hl.indexOf(_)>-1};switch(a){case"pt":He=1;break;case"mm":He=72/25.4;break;case"cm":He=72/2.54;break;case"in":He=72;break;case"px":He=Fp("px_scaling")==1?.75:96/72;break;case"pc":case"em":He=12;break;case"ex":He=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);He=a}var qa=null;Z(),q();var Kv=function(_){return d!==null?qa.encryptor(_,0):function(V){return V}},Bp=f.__private__.getPageInfo=f.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ct[_].objId,pageNumber:_,pageContext:Ct[_]}},_t=f.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var V in Ct)if(Ct[V].objId===_)break;return Bp(V)},$v=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Ct[W].objId,pageNumber:W,pageContext:Ct[W]}};f.addPage=function(){return Mp.apply(this,arguments),this},f.setPage=function(){return Ip.apply(this,arguments),xe.call(this,ve[W]),this},f.insertPage=function(_){return this.addPage(),this.movePage(W,_),this},f.movePage=function(_,V){var le,fe;if(_>V){le=ve[_],fe=Ct[_];for(var Se=_;Se>V;Se--)ve[Se]=ve[Se-1],Ct[Se]=Ct[Se-1];ve[V]=le,Ct[V]=fe,this.setPage(V)}else if(_<V){le=ve[_],fe=Ct[_];for(var Ie=_;Ie<V;Ie++)ve[Ie]=ve[Ie+1],Ct[Ie]=Ct[Ie+1];ve[V]=le,Ct[V]=fe,this.setPage(V)}return this},f.deletePage=function(){return Uv.apply(this,arguments),this},f.__private__.text=f.text=function(_,V,le,fe,Se){var Ie,Ye,rt,gt,Tt,At,qt,An,In,ta=(fe=fe||{}).scope||this;if(typeof _=="number"&&typeof V=="number"&&(typeof le=="string"||Array.isArray(le))){var Ha=le;le=V,V=_,_=Ha}if(arguments[3]instanceof yt?(A("The transform parameter of text() with a Matrix value"),In=Se):(rt=arguments[4],gt=arguments[5],ln(qt=arguments[3])==="object"&&qt!==null||(typeof rt=="string"&&(gt=rt,rt=null),typeof qt=="string"&&(gt=qt,qt=null),typeof qt=="number"&&(rt=qt,qt=null),fe={flags:qt,angle:rt,align:gt})),isNaN(V)||isNaN(le)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return ta;var ya="",Fi=!1,Mr=typeof fe.lineHeightFactor=="number"?fe.lineHeightFactor:Vl,cs=ta.internal.scaleFactor;function $p(vn){return vn=vn.split("	").join(Array(fe.TabLen||9).join(" ")),mr(vn,qt)}function xh(vn){for(var xn,Gn=vn.concat(),la=[],Ys=Gn.length;Ys--;)typeof(xn=Gn.shift())=="string"?la.push(xn):Array.isArray(vn)&&(xn.length===1||xn[1]===void 0&&xn[2]===void 0)?la.push(xn[0]):la.push([xn[0],xn[1],xn[2]]);return la}function bh(vn,xn){var Gn;if(typeof vn=="string")Gn=xn(vn)[0];else if(Array.isArray(vn)){for(var la,Ys,Ch=vn.concat(),yc=[],Zp=Ch.length;Zp--;)typeof(la=Ch.shift())=="string"?yc.push(xn(la)[0]):Array.isArray(la)&&typeof la[0]=="string"&&(Ys=xn(la[0],la[1],la[2]),yc.push([Ys[0],Ys[1],Ys[2]]));Gn=yc}return Gn}var dc=!1,yh=!0;if(typeof _=="string")dc=!0;else if(Array.isArray(_)){var wh=_.concat();Ye=[];for(var hc,La=wh.length;La--;)(typeof(hc=wh.shift())!="string"||Array.isArray(hc)&&typeof hc[0]!="string")&&(yh=!1);dc=yh}if(dc===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var fc=Ge/ta.internal.scaleFactor,pc=fc*(Mr-1);switch(fe.baseline){case"bottom":le-=pc;break;case"top":le+=fc-pc;break;case"hanging":le+=fc-2*pc;break;case"middle":le+=fc/2-pc}if((At=fe.maxWidth||0)>0&&(typeof _=="string"?_=ta.splitTextToSize(_,At):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(vn,xn){return vn.concat(ta.splitTextToSize(xn,At))},[]))),Ie={text:_,x:V,y:le,options:fe,mutex:{pdfEscape:mr,activeFontKey:et,fonts:Rt,activeFontSize:Ge}},en.publish("preProcessText",Ie),_=Ie.text,rt=(fe=Ie.options).angle,!(In instanceof yt)&&rt&&typeof rt=="number"){rt*=Math.PI/180,fe.rotationDirection===0&&(rt=-rt),y===x.ADVANCED&&(rt=-rt);var mc=Math.cos(rt),Nh=Math.sin(rt);In=new yt(mc,Nh,-Nh,mc,0,0)}else rt&&rt instanceof yt&&(In=rt);y!==x.ADVANCED||In||(In=is),(Tt=fe.charSpace||lc)!==void 0&&(ya+=C(D(Tt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(An=fe.horizontalScale)!==void 0&&(ya+=C(100*An)+` Tz
`),fe.lang;var gr=-1,rx=fe.renderingMode!==void 0?fe.renderingMode:fe.stroke,kh=ta.internal.getCurrentPageInfo().pageContext;switch(rx){case 0:case!1:case"fill":gr=0;break;case 1:case!0:case"stroke":gr=1;break;case 2:case"fillThenStroke":gr=2;break;case 3:case"invisible":gr=3;break;case 4:case"fillAndAddForClipping":gr=4;break;case 5:case"strokeAndAddPathForClipping":gr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":gr=6;break;case 7:case"addToPathForClipping":gr=7}var Yp=kh.usedRenderingMode!==void 0?kh.usedRenderingMode:-1;gr!==-1?ya+=gr+` Tr
`:Yp!==-1&&(ya+=`0 Tr
`),gr!==-1&&(kh.usedRenderingMode=gr),gt=fe.align||"left";var oi,gc=Ge*Mr,Xp=ta.internal.pageSize.getWidth(),Jp=Rt[et];Tt=fe.charSpace||lc,At=fe.maxWidth||0,qt=Object.assign({autoencode:!0,noBOM:!0},fe.flags);var Po=[],Yl=function(vn){return ta.getStringUnitWidth(vn,{font:Jp,charSpace:Tt,fontSize:Ge,doKerning:!1})*Ge/cs};if(Object.prototype.toString.call(_)==="[object Array]"){var vr;Ye=xh(_),gt!=="left"&&(oi=Ye.map(Yl));var sr,Mo=0;if(gt==="right"){V-=oi[0],_=[],La=Ye.length;for(var Vs=0;Vs<La;Vs++)Vs===0?(sr=us(V),vr=Gs(le)):(sr=D(Mo-oi[Vs]),vr=-gc),_.push([Ye[Vs],sr,vr]),Mo=oi[Vs]}else if(gt==="center"){V-=oi[0]/2,_=[],La=Ye.length;for(var Ks=0;Ks<La;Ks++)Ks===0?(sr=us(V),vr=Gs(le)):(sr=D((Mo-oi[Ks])/2),vr=-gc),_.push([Ye[Ks],sr,vr]),Mo=oi[Ks]}else if(gt==="left"){_=[],La=Ye.length;for(var vc=0;vc<La;vc++)_.push(Ye[vc])}else if(gt==="justify"&&Jp.encoding==="Identity-H"){_=[],La=Ye.length,At=At!==0?At:Xp;for(var $s=0,Wn=0;Wn<La;Wn++)if(vr=Wn===0?Gs(le):-gc,sr=Wn===0?us(V):$s,Wn<La-1){var Sh=D((At-oi[Wn])/(Ye[Wn].split(" ").length-1)),or=Ye[Wn].split(" ");_.push([or[0]+" ",sr,vr]),$s=0;for(var li=1;li<or.length;li++){var xc=(Yl(or[li-1]+" "+or[li])-Yl(or[li]))*cs+Sh;li==or.length-1?_.push([or[li],xc,0]):_.push([or[li]+" ",xc,0]),$s-=xc}}else _.push([Ye[Wn],sr,vr]);_.push(["",$s,0])}else{if(gt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],La=Ye.length,At=At!==0?At:Xp,Wn=0;Wn<La;Wn++)vr=Wn===0?Gs(le):-gc,sr=Wn===0?us(V):0,Wn<La-1?Po.push(C(D((At-oi[Wn])/(Ye[Wn].split(" ").length-1)))):Po.push(0),_.push([Ye[Wn],sr,vr])}}var Qp=typeof fe.R2L=="boolean"?fe.R2L:ke;Qp===!0&&(_=bh(_,function(vn,xn,Gn){return[vn.split("").reverse().join(""),xn,Gn]})),Ie={text:_,x:V,y:le,options:fe,mutex:{pdfEscape:mr,activeFontKey:et,fonts:Rt,activeFontSize:Ge}},en.publish("postProcessText",Ie),_=Ie.text,Fi=Ie.mutex.isHex||!1;var _h=Rt[et].encoding;_h!=="WinAnsiEncoding"&&_h!=="StandardEncoding"||(_=bh(_,function(vn,xn,Gn){return[$p(vn),xn,Gn]})),Ye=xh(_),_=[];for(var Xl,Jl,Io,Ql=0,bc=1,Zl=Array.isArray(Ye[0])?bc:Ql,Oo="",jh=function(vn,xn,Gn){var la="";return Gn instanceof yt?(Gn=typeof fe.angle=="number"?Ri(Gn,new yt(1,0,0,1,vn,xn)):Ri(new yt(1,0,0,1,vn,xn),Gn),y===x.ADVANCED&&(Gn=Ri(new yt(1,0,0,-1,0,0),Gn)),la=Gn.join(" ")+` Tm
`):la=C(vn)+" "+C(xn)+` Td
`,la},ui=0;ui<Ye.length;ui++){switch(Oo="",Zl){case bc:Io=(Fi?"<":"(")+Ye[ui][0]+(Fi?">":")"),Xl=parseFloat(Ye[ui][1]),Jl=parseFloat(Ye[ui][2]);break;case Ql:Io=(Fi?"<":"(")+Ye[ui]+(Fi?">":")"),Xl=us(V),Jl=Gs(le)}Po!==void 0&&Po[ui]!==void 0&&(Oo=Po[ui]+` Tw
`),ui===0?_.push(Oo+jh(Xl,Jl,In)+Io):Zl===Ql?_.push(Oo+Io):Zl===bc&&_.push(Oo+jh(Xl,Jl,In)+Io)}_=Zl===Ql?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var ci=`BT
/`;return ci+=et+" "+Ge+` Tf
`,ci+=C(Ge*Mr)+` TL
`,ci+=Kl+`
`,ci+=ya,ci+=_,ne(ci+="ET"),p[et]=!0,ta};var Yv=f.__private__.clip=f.clip=function(_){return ne(_==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Yv("evenodd")},f.__private__.discardPath=f.discardPath=function(){return ne("n"),this};var ls=f.__private__.isValidStyle=function(_){var V=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(V=!0),V};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(_){return ls(_)&&(c=_),this};var zp=f.__private__.getStyle=f.getStyle=function(_){var V=c;switch(_){case"D":case"S":V="S";break;case"F":V="f";break;case"FD":case"DF":V="B";break;case"f":case"f*":case"B":case"B*":V=_}return V},Up=f.close=function(){return ne("h"),this};f.stroke=function(){return ne("S"),this},f.fill=function(_){return sc("f",_),this},f.fillEvenOdd=function(_){return sc("f*",_),this},f.fillStroke=function(_){return sc("B",_),this},f.fillStrokeEvenOdd=function(_){return sc("B*",_),this};var sc=function(_,V){ln(V)==="object"?Jv(V,_):ne(_)},lh=function(_){_===null||y===x.ADVANCED&&_===void 0||(_=zp(_),ne(_))};function Xv(_,V,le,fe,Se){var Ie=new pu(V||this.boundingBox,le||this.xStep,fe||this.yStep,this.gState,Se||this.matrix);Ie.stream=this.stream;var Ye=_+"$$"+this.cloneIndex+++"$$";return pr(Ye,Ie),Ie}var Jv=function(_,V){var le=Do[_.key],fe=Kt[le];if(fe instanceof rl)ne("q"),ne(Qv(V)),fe.gState&&f.setGState(fe.gState),ne(_.matrix.toString()+" cm"),ne("/"+le+" sh"),ne("Q");else if(fe instanceof pu){var Se=new yt(1,0,0,-1,0,Lo());_.matrix&&(Se=Se.multiply(_.matrix||is),le=Xv.call(fe,_.key,_.boundingBox,_.xStep,_.yStep,Se).id),ne("q"),ne("/Pattern cs"),ne("/"+le+" scn"),fe.gState&&f.setGState(fe.gState),ne(V),ne("Q")}},Qv=function(_){switch(_){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},uh=f.moveTo=function(_,V){return ne(C(D(_))+" "+C(z(V))+" m"),this},Gl=f.lineTo=function(_,V){return ne(C(D(_))+" "+C(z(V))+" l"),this},To=f.curveTo=function(_,V,le,fe,Se,Ie){return ne([C(D(_)),C(z(V)),C(D(le)),C(z(fe)),C(D(Se)),C(z(Ie)),"c"].join(" ")),this};f.__private__.line=f.line=function(_,V,le,fe,Se){if(isNaN(_)||isNaN(V)||isNaN(le)||isNaN(fe)||!ls(Se))throw new Error("Invalid arguments passed to jsPDF.line");return y===x.COMPAT?this.lines([[le-_,fe-V]],_,V,[1,1],Se||"S"):this.lines([[le-_,fe-V]],_,V,[1,1]).stroke()},f.__private__.lines=f.lines=function(_,V,le,fe,Se,Ie){var Ye,rt,gt,Tt,At,qt,An,In,ta,Ha,ya,Fi;if(typeof _=="number"&&(Fi=le,le=V,V=_,_=Fi),fe=fe||[1,1],Ie=Ie||!1,isNaN(V)||isNaN(le)||!Array.isArray(_)||!Array.isArray(fe)||!ls(Se)||typeof Ie!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(uh(V,le),Ye=fe[0],rt=fe[1],Tt=_.length,Ha=V,ya=le,gt=0;gt<Tt;gt++)(At=_[gt]).length===2?(Ha=At[0]*Ye+Ha,ya=At[1]*rt+ya,Gl(Ha,ya)):(qt=At[0]*Ye+Ha,An=At[1]*rt+ya,In=At[2]*Ye+Ha,ta=At[3]*rt+ya,Ha=At[4]*Ye+Ha,ya=At[5]*rt+ya,To(qt,An,In,ta,Ha,ya));return Ie&&Up(),lh(Se),this},f.path=function(_){for(var V=0;V<_.length;V++){var le=_[V],fe=le.c;switch(le.op){case"m":uh(fe[0],fe[1]);break;case"l":Gl(fe[0],fe[1]);break;case"c":To.apply(this,fe);break;case"h":Up()}}return this},f.__private__.rect=f.rect=function(_,V,le,fe,Se){if(isNaN(_)||isNaN(V)||isNaN(le)||isNaN(fe)||!ls(Se))throw new Error("Invalid arguments passed to jsPDF.rect");return y===x.COMPAT&&(fe=-fe),ne([C(D(_)),C(z(V)),C(D(le)),C(D(fe)),"re"].join(" ")),lh(Se),this},f.__private__.triangle=f.triangle=function(_,V,le,fe,Se,Ie,Ye){if(isNaN(_)||isNaN(V)||isNaN(le)||isNaN(fe)||isNaN(Se)||isNaN(Ie)||!ls(Ye))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[le-_,fe-V],[Se-le,Ie-fe],[_-Se,V-Ie]],_,V,[1,1],Ye,!0),this},f.__private__.roundedRect=f.roundedRect=function(_,V,le,fe,Se,Ie,Ye){if(isNaN(_)||isNaN(V)||isNaN(le)||isNaN(fe)||isNaN(Se)||isNaN(Ie)||!ls(Ye))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var rt=4/3*(Math.SQRT2-1);return Se=Math.min(Se,.5*le),Ie=Math.min(Ie,.5*fe),this.lines([[le-2*Se,0],[Se*rt,0,Se,Ie-Ie*rt,Se,Ie],[0,fe-2*Ie],[0,Ie*rt,-Se*rt,Ie,-Se,Ie],[2*Se-le,0],[-Se*rt,0,-Se,-Ie*rt,-Se,-Ie],[0,2*Ie-fe],[0,-Ie*rt,Se*rt,-Ie,Se,-Ie]],_+Se,V,[1,1],Ye,!0),this},f.__private__.ellipse=f.ellipse=function(_,V,le,fe,Se){if(isNaN(_)||isNaN(V)||isNaN(le)||isNaN(fe)||!ls(Se))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ie=4/3*(Math.SQRT2-1)*le,Ye=4/3*(Math.SQRT2-1)*fe;return uh(_+le,V),To(_+le,V-Ye,_+Ie,V-fe,_,V-fe),To(_-Ie,V-fe,_-le,V-Ye,_-le,V),To(_-le,V+Ye,_-Ie,V+fe,_,V+fe),To(_+Ie,V+fe,_+le,V+Ye,_+le,V),lh(Se),this},f.__private__.circle=f.circle=function(_,V,le,fe){if(isNaN(_)||isNaN(V)||isNaN(le)||!ls(fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,V,le,le,fe)},f.setFont=function(_,V,le){return le&&(V=T(V,le)),et=Op(_,V,{disableWarning:!1}),this};var Zv=f.__private__.getFont=f.getFont=function(){return Rt[Op.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var _,V,le={};for(_ in Mt)if(Mt.hasOwnProperty(_))for(V in le[_]=[],Mt[_])Mt[_].hasOwnProperty(V)&&le[_].push(V);return le},f.addFont=function(_,V,le,fe,Se){var Ie=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ie.indexOf(arguments[3])!==-1?Se=arguments[3]:arguments[3]&&Ie.indexOf(arguments[3])==-1&&(le=T(le,fe)),Se=Se||"Identity-H",ih.call(this,_,V,le,Se)};var Vl,ch=e.lineWidth||.200025,oc=f.__private__.getLineWidth=f.getLineWidth=function(){return ch},qp=f.__private__.setLineWidth=f.setLineWidth=function(_){return ch=_,ne(C(D(_))+" w"),this};f.__private__.setLineDash=xt.API.setLineDash=xt.API.setLineDashPattern=function(_,V){if(_=_||[],V=V||0,isNaN(V)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(le){return C(D(le))}).join(" "),V=C(D(V)),ne("["+_+"] "+V+" d"),this};var Hp=f.__private__.getLineHeight=f.getLineHeight=function(){return Ge*Vl};f.__private__.getLineHeight=f.getLineHeight=function(){return Ge*Vl};var Wp=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(Vl=_),this},Gp=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Vl};Wp(e.lineHeight);var us=f.__private__.getHorizontalCoordinate=function(_){return D(_)},Gs=f.__private__.getVerticalCoordinate=function(_){return y===x.ADVANCED?_:Ct[W].mediaBox.topRightY-Ct[W].mediaBox.bottomLeftY-D(_)},ex=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(_){return C(us(_))},Ro=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(_){return C(Gs(_))},Oi=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Pi(Oi)},f.__private__.setStrokeColor=f.setDrawColor=function(_,V,le,fe){return Oi=Mi({ch1:_,ch2:V,ch3:le,ch4:fe,pdfColorType:"draw",precision:2}),ne(Oi),this};var dh=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Pi(dh)},f.__private__.setFillColor=f.setFillColor=function(_,V,le,fe){return dh=Mi({ch1:_,ch2:V,ch3:le,ch4:fe,pdfColorType:"fill",precision:2}),ne(dh),this};var Kl=e.textColor||"0 g",tx=f.__private__.getTextColor=f.getTextColor=function(){return Pi(Kl)};f.__private__.setTextColor=f.setTextColor=function(_,V,le,fe){return Kl=Mi({ch1:_,ch2:V,ch3:le,ch4:fe,pdfColorType:"text",precision:3}),this};var lc=e.charSpace,nx=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(lc||0)};f.__private__.setCharSpace=f.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return lc=_,this};var hh=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(_){var V=f.CapJoinStyles[_];if(V===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return hh=V,ne(V+" J"),this};var fh=0;f.__private__.setLineJoin=f.setLineJoin=function(_){var V=f.CapJoinStyles[_];if(V===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return fh=V,ne(V+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ne(C(D(_))+" M"),this},f.GState=Yf,f.setGState=function(_){(_=typeof _=="string"?gn[Ti[_]]:Vp(null,_)).equals(qs)||(ne("/"+_.id+" gs"),qs=_)};var Vp=function(_,V){if(!_||!Ti[_]){var le=!1;for(var fe in gn)if(gn.hasOwnProperty(fe)&&gn[fe].equals(V)){le=!0;break}if(le)V=gn[fe];else{var Se="GS"+(Object.keys(gn).length+1).toString(10);gn[Se]=V,V.id=Se}return _&&(Ti[_]=V.id),en.publish("addGState",V),V}};f.addGState=function(_,V){return Vp(_,V),this},f.saveGraphicsState=function(){return ne("q"),Ua.push({key:et,size:Ge,color:Kl}),this},f.restoreGraphicsState=function(){ne("Q");var _=Ua.pop();return et=_.key,Ge=_.size,Kl=_.color,qs=null,this},f.setCurrentTransformationMatrix=function(_){return ne(_.toString()+" cm"),this},f.comment=function(_){return ne("#"+_),this};var uc=function(_,V){var le=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return le},set:function(Ie){isNaN(Ie)||(le=parseFloat(Ie))}});var fe=V||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return fe},set:function(Ie){isNaN(Ie)||(fe=parseFloat(Ie))}});var Se="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Se},set:function(Ie){Se=Ie.toString()}}),this},ph=function(_,V,le,fe){uc.call(this,_,V),this.type="rect";var Se=le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Se},set:function(Ye){isNaN(Ye)||(Se=parseFloat(Ye))}});var Ie=fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ie},set:function(Ye){isNaN(Ye)||(Ie=parseFloat(Ye))}}),this},mh=function(){this.page=Mn,this.currentPage=W,this.pages=ve.slice(0),this.pagesContext=Ct.slice(0),this.x=wt,this.y=dt,this.matrix=_n,this.width=$l(W),this.height=Lo(W),this.outputDestination=Re,this.id="",this.objectNumber=-1};mh.prototype.restore=function(){Mn=this.page,W=this.currentPage,Ct=this.pagesContext,ve=this.pages,wt=this.x,dt=this.y,_n=this.matrix,gh(W,this.width),vh(W,this.height),Re=this.outputDestination};var Kp=function(_,V,le,fe,Se){rs.push(new mh),Mn=W=0,ve=[],wt=_,dt=V,_n=Se,sh([le,fe])},ax=function(_){if(as[_])rs.pop().restore();else{var V=new mh,le="Xo"+(Object.keys(Ra).length+1).toString(10);V.id=le,as[_]=le,Ra[le]=V,en.publish("addFormObject",V),rs.pop().restore()}};for(var cc in f.beginFormObject=function(_,V,le,fe,Se){return Kp(_,V,le,fe,Se),this},f.endFormObject=function(_){return ax(_),this},f.doFormObject=function(_,V){var le=Ra[as[_]];return ne("q"),ne(V.toString()+" cm"),ne("/"+le.id+" Do"),ne("Q"),this},f.getFormObject=function(_){var V=Ra[as[_]];return{x:V.x,y:V.y,width:V.width,height:V.height,matrix:V.matrix}},f.save=function(_,V){return _=_||"generated.pdf",(V=V||{}).returnPromise=V.returnPromise||!1,V.returnPromise===!1?(cu(rc(Ws()),_),typeof cu.unload=="function"&&Nt.setTimeout&&setTimeout(cu.unload,911),this):new Promise(function(le,fe){try{var Se=cu(rc(Ws()),_);typeof cu.unload=="function"&&Nt.setTimeout&&setTimeout(cu.unload,911),le(Se)}catch(Ie){fe(Ie.message)}})},xt.API)xt.API.hasOwnProperty(cc)&&(cc==="events"&&xt.API.events.length?function(_,V){var le,fe,Se;for(Se=V.length-1;Se!==-1;Se--)le=V[Se][0],fe=V[Se][1],_.subscribe.apply(_,[le].concat(typeof fe=="function"?[fe]:fe))}(en,xt.API.events):f[cc]=xt.API[cc]);var $l=f.getPageWidth=function(_){return(Ct[_=_||W].mediaBox.topRightX-Ct[_].mediaBox.bottomLeftX)/He},gh=f.setPageWidth=function(_,V){Ct[_].mediaBox.topRightX=V*He+Ct[_].mediaBox.bottomLeftX},Lo=f.getPageHeight=function(_){return(Ct[_=_||W].mediaBox.topRightY-Ct[_].mediaBox.bottomLeftY)/He},vh=f.setPageHeight=function(_,V){Ct[_].mediaBox.topRightY=V*He+Ct[_].mediaBox.bottomLeftY};return f.internal={pdfEscape:mr,getStyle:zp,getFont:Zv,getFontSize:de,getCharSpace:nx,getTextColor:tx,getLineHeight:Hp,getLineHeightFactor:Gp,getLineWidth:oc,write:Qe,getHorizontalCoordinate:us,getVerticalCoordinate:Gs,getCoordinateString:ex,getVerticalCoordinateString:Ro,collections:{},newObject:oa,newAdditionalObject:Xu,newObjectDeferred:ea,newObjectDeferredBegin:Pr,getFilters:ss,putStream:si,events:en,scaleFactor:He,pageSize:{getWidth:function(){return $l(W)},setWidth:function(_){gh(W,_)},getHeight:function(){return Lo(W)},setHeight:function(_){vh(W,_)}},encryptionOptions:d,encryption:qa,getEncryptor:Kv,output:ic,getNumberOfPages:qv,pages:ve,out:ne,f2:L,f3:j,getPageInfo:Bp,getPageInfoByObjId:_t,getCurrentPageInfo:$v,getPDFVersion:b,Point:uc,Rectangle:ph,Matrix:yt,hasHotfix:Fp},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return $l(W)},set:function(_){gh(W,_)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Lo(W)},set:function(_){vh(W,_)},enumerable:!0,configurable:!0}),zv.call(f,Ae),et="F1",Mp(r,n),en.publish("initialized"),f}qc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},qc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},qc.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},qc.prototype.processOwnerPassword=function(e,t){return jy(_y(t).substr(0,5),e)},qc.prototype.encryptor=function(e,t){var n=_y(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return jy(n,a)}},Yf.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||ln(e)!==ln(this))return!1;var a=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&a--;return a===0},xt.API={events:[]},xt.version="2.5.2";var zn=xt.API,Xw=1,Yu=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Dt=function(e){return e.toFixed(2)},Xo=function(e){return e.toFixed(5)};zn.__acroform__={};var Lr=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},j4=function(e){return e*Xw},ps=function(e){var t=new SA,n=ot.internal.getHeight(e)||0,a=ot.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Dt(a)),Number(Dt(n))],t},dH=zn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},hH=zn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},fH=zn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Yn=zn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return fH(e,t-1)},Xn=zn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return dH(e,t-1)},Jn=zn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return hH(e,t-1)},pH=zn.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,r=e[0],i=e[1],s=e[2],o=e[3],u={};return u.lowerLeft_X=n(r)||0,u.lowerLeft_Y=a(i+o)||0,u.upperRight_X=n(r+s)||0,u.upperRight_Y=a(i)||0,[Number(Dt(u.lowerLeft_X)),Number(Dt(u.lowerLeft_Y)),Number(Dt(u.upperRight_X)),Number(Dt(u.upperRight_Y))]},mH=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,a=Cy(e,n),r=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+r+" "+Dt(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=ps(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},Cy=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},r=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");r=e.multiline?r.map(function(j){return j.split(`
`)}):r.map(function(j){return[j]});var i=n,s=ot.internal.getHeight(e)||0;s=s<0?-s:s;var o=ot.internal.getWidth(e)||0;o=o<0?-o:o;var u=function(j,D,B){if(j+1<r.length){var z=D+" "+r[j+1][0];return Qm(z,e,B).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,d,h=Qm("3",e,i).height,p=e.multiline?s-i:(s-h)/2,f=p+=2,g=0,b=0,w=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+Qm(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var m="",x=0,y=0;y<r.length;y++)if(r.hasOwnProperty(y)){var N=!1;if(r[y].length!==1&&w!==r[y].length-1){if((h+2)*(x+2)+2>s)continue e;m+=r[y][w],N=!0,b=y,y--}else{m=(m+=r[y][w]+" ").substr(m.length-1)==" "?m.substr(0,m.length-1):m;var S=parseInt(y),T=u(S,m,i),C=y>=r.length-1;if(T&&!C){m+=" ",w=0;continue}if(T||C){if(C)b=S;else if(e.multiline&&(h+2)*(x+2)+2>s)continue e}else{if(!e.multiline||(h+2)*(x+2)+2>s)continue e;b=S}}for(var A="",R=g;R<=b;R++){var L=r[R];if(e.multiline){if(R===b){A+=L[w]+" ",w=(w+1)%L.length;continue}if(R===g){A+=L[L.length-1]+" ";continue}}A+=L[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,d=Qm(A,e,i).width,e.textAlign){case"right":c=o-d-2;break;case"center":c=(o-d)/2;break;case"left":default:c=2}t+=Dt(c)+" "+Dt(f)+` Td
`,t+="("+Yu(A)+`) Tj
`,t+=-Dt(c)+` 0 Td
`,f=-(i+2),d=0,g=N?b:b+1,x++,m=""}break}return a.text=t,a.fontSize=i,a},Qm=function(e,t,n){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),r=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},gH={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},vH=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===n.type&&a.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},xH=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var a=n,r=e[n];t.internal.newObjectDeferredBegin(r.objId,!0),ln(r)==="object"&&typeof r.putStream=="function"&&r.putStream(),delete e[a]}},bH=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ts.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(gH)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Xw=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new _A,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in a)if(a.hasOwnProperty(r)){var i=a[r];i.objId=void 0,i.hasAnnotation&&vH(i,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(a,r){var i=!a;for(var s in a||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(s)){var o=a[s],u=[],c=o.Rect;if(o.Rect&&(o.Rect=pH(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ot.createDefaultAppearanceStream(o),ln(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=mH(o);u.push({key:"AP",value:"<</N "+d+">>"}),r.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var f=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var g=f[s];typeof g=="function"&&(g=g.call(r,o)),h+="/"+s+" "+g+" ",r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(r,o)),h+="/"+s+" "+g,r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g);h+=">>"}u.push({key:"AP",value:`<<
`+h+">>"})}r.internal.putStream({additionalKeyValues:u,objectId:o.objId}),r.internal.out("endobj")}i&&xH(r.internal.acroformPlugin.xForms,r)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},kA=zn.__acroform__.arrayToPdfArray=function(e,t,n){var a=function(s){return s};if(Array.isArray(e)){for(var r="[",i=0;i<e.length;i++)switch(i!==0&&(r+=" "),ln(e[i])){case"boolean":case"number":case"object":r+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&n&&(a=n.internal.getEncryptor(t)),r+="("+Yu(a(e[i].toString()))+")"):r+=e[i].toString()}return r+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},zb=function(e,t,n){var a=function(r){return r};return t!==void 0&&n&&(a=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Yu(a(e))+")"},_s=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};_s.prototype.toString=function(){return this.objId+" 0 R"},_s.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},_s.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var a=t[n],r=this[a];r&&(Array.isArray(r)?e.push({key:a,value:kA(r,this.objId,this.scope)}):r instanceof _s?(r.scope=this.scope,e.push({key:a,value:r.objId+" 0 R"})):typeof r!="function"&&e.push({key:a,value:r}))}return e};var SA=function(){_s.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Lr(SA,_s);var _A=function(){_s.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(a){return a};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Yu(n(e))+")"}},set:function(n){e=n}})};Lr(_A,_s);var ts=function e(){_s.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute F supplied.');t=m}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Yn(t,3)},set:function(m){m?this.F=Xn(t,3):this.F=Jn(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute Ff supplied.');n=m}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(m){a=m!==void 0?m:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(m){a[0]=m}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(m){a[1]=m}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(m){a[2]=m}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(m){a[3]=m}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(m){switch(m){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=m;break;default:throw new Error('Invalid value "'+m+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof D0)return;i="FieldObject"+e.FieldNum++}var m=function(x){return x};return this.scope&&(m=this.scope.internal.getEncryptor(this.objId)),"("+Yu(m(i))+")"},set:function(m){i=m.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(m){i=m}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(m){s=m}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(m){o=m}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(m){u=m}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/Xw:c},set:function(m){c=m}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(m){d=m}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof D0||this instanceof Cl))return zb(h,this.objId,this.scope)},set:function(m){m=m.toString(),h=m}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ca?p:zb(p,this.objId,this.scope)},set:function(m){m=m.toString(),p=this instanceof ca?m:m.substr(0,1)==="("?Lc(m.substr(1,m.length-2)):Lc(m)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ca?Lc(p.substr(1,p.length-1)):p},set:function(m){m=m.toString(),p=this instanceof ca?"/"+m:m}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(m){this.V=m}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ca?f:zb(f,this.objId,this.scope)},set:function(m){m=m.toString(),f=this instanceof ca?m:m.substr(0,1)==="("?Lc(m.substr(1,m.length-2)):Lc(m)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ca?Lc(f.substr(1,f.length-1)):f},set:function(m){m=m.toString(),f=this instanceof ca?"/"+m:m}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(m){m=!!m,b=m}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(m){g=m}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,1)},set:function(m){m?this.Ff=Xn(this.Ff,1):this.Ff=Jn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,2)},set:function(m){m?this.Ff=Xn(this.Ff,2):this.Ff=Jn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,3)},set:function(m){m?this.Ff=Xn(this.Ff,3):this.Ff=Jn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(m){if([0,1,2].indexOf(m)===-1)throw new Error('Invalid value "'+m+'" for attribute Q supplied.');w=m}}),Object.defineProperty(this,"textAlign",{get:function(){var m;switch(w){case 0:default:m="left";break;case 1:m="center";break;case 2:m="right"}return m},configurable:!0,enumerable:!0,set:function(m){switch(m){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Lr(ts,_s);var _u=function(){ts.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return kA(t,this.objId,this.scope)},set:function(n){var a,r;r=[],typeof(a=n)=="string"&&(r=function(i,s,o){o||(o=1);for(var u,c=[];u=s.exec(i);)c.push(u[o]);return c}(a,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,a){for(a=a||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,18)},set:function(n){n?this.Ff=Xn(this.Ff,18):this.Ff=Jn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Xn(this.Ff,19):this.Ff=Jn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,20)},set:function(n){n?(this.Ff=Xn(this.Ff,20),t.sort()):this.Ff=Jn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,22)},set:function(n){n?this.Ff=Xn(this.Ff,22):this.Ff=Jn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,23)},set:function(n){n?this.Ff=Xn(this.Ff,23):this.Ff=Jn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,27)},set:function(n){n?this.Ff=Xn(this.Ff,27):this.Ff=Jn(this.Ff,27)}}),this.hasAppearanceStream=!1};Lr(_u,ts);var ju=function(){_u.call(this),this.fontName="helvetica",this.combo=!1};Lr(ju,_u);var Cu=function(){ju.call(this),this.combo=!0};Lr(Cu,ju);var bf=function(){Cu.call(this),this.edit=!0};Lr(bf,Cu);var ca=function(){ts.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,15)},set:function(n){n?this.Ff=Xn(this.Ff,15):this.Ff=Jn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,16)},set:function(n){n?this.Ff=Xn(this.Ff,16):this.Ff=Jn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,17)},set:function(n){n?this.Ff=Xn(this.Ff,17):this.Ff=Jn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,26)},set:function(n){n?this.Ff=Xn(this.Ff,26):this.Ff=Jn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,r=[];for(a in r.push("<<"),t)r.push("/"+a+" ("+Yu(n(t[a]))+")");return r.push(">>"),r.join(`
`)}},set:function(n){ln(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Lr(ca,ts);var yf=function(){ca.call(this),this.pushButton=!0};Lr(yf,ca);var Au=function(){ca.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Lr(Au,ca);var D0=function(){var e,t;ts.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(r){t=r}});var n,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),a)s.push("/"+i+" ("+Yu(r(a[i]))+")");return s.push(">>"),s.join(`
`)},set:function(r){ln(r)==="object"&&(a=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(r){typeof r=="string"&&(a.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ot.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Lr(D0,ts),Au.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Au.prototype.createOption=function(e){var t=new D0;return t.Parent=this,t.optionName=e,this.Kids.push(t),yH.call(this.scope,t),t};var wf=function(){ca.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ot.CheckBox.createAppearanceStream()};Lr(wf,ca);var Cl=function(){ts.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,13)},set:function(t){t?this.Ff=Xn(this.Ff,13):this.Ff=Jn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,21)},set:function(t){t?this.Ff=Xn(this.Ff,21):this.Ff=Jn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,23)},set:function(t){t?this.Ff=Xn(this.Ff,23):this.Ff=Jn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,24)},set:function(t){t?this.Ff=Xn(this.Ff,24):this.Ff=Jn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,25)},set:function(t){t?this.Ff=Xn(this.Ff,25):this.Ff=Jn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,26)},set:function(t){t?this.Ff=Xn(this.Ff,26):this.Ff=Jn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Lr(Cl,ts);var Nf=function(){Cl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,14)},set:function(e){e?this.Ff=Xn(this.Ff,14):this.Ff=Jn(this.Ff,14)}}),this.password=!0};Lr(Nf,Cl);var ot={CheckBox:{createAppearanceStream:function(){return{N:{On:ot.CheckBox.YesNormal},D:{On:ot.CheckBox.YesPushDown,Off:ot.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=ps(e);t.scope=e.scope;var n=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=Cy(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+a+" "+Dt(i.fontSize)+" Tf "+r),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=ps(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),r=[],i=ot.internal.getHeight(e),s=ot.internal.getWidth(e),o=Cy(e,e.caption);return r.push("1 g"),r.push("0 0 "+Dt(s)+" "+Dt(i)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Dt(s-1)+" "+Dt(i-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+Dt(o.fontSize)+" Tf "+a),r.push(o.text),r.push("ET"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=ps(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ot.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ot.RadioButton.Circle.YesNormal,t.D[e]=ot.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=ps(e);t.scope=e.scope;var n=[],a=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var r=ot.internal.Bezier_C,i=Number((a*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Xo(ot.internal.getWidth(e)/2)+" "+Xo(ot.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=ps(e);t.scope=e.scope;var n=[],a=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var r=Number((2*a).toFixed(5)),i=Number((r*ot.internal.Bezier_C).toFixed(5)),s=Number((a*ot.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Xo(ot.internal.getWidth(e)/2)+" "+Xo(ot.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Xo(ot.internal.getWidth(e)/2)+" "+Xo(ot.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),n.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),n.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),n.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=ps(e);t.scope=e.scope;var n=[],a=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var r=Number((2*a).toFixed(5)),i=Number((r*ot.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Xo(ot.internal.getWidth(e)/2)+" "+Xo(ot.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ot.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ot.RadioButton.Cross.YesNormal,t.D[e]=ot.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=ps(e);t.scope=e.scope;var n=[],a=ot.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+Dt(ot.internal.getWidth(e)-2)+" "+Dt(ot.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Dt(a.x1.x)+" "+Dt(a.x1.y)+" m"),n.push(Dt(a.x2.x)+" "+Dt(a.x2.y)+" l"),n.push(Dt(a.x4.x)+" "+Dt(a.x4.y)+" m"),n.push(Dt(a.x3.x)+" "+Dt(a.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=ps(e);t.scope=e.scope;var n=ot.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Dt(ot.internal.getWidth(e)-2)+" "+Dt(ot.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Dt(n.x1.x)+" "+Dt(n.x1.y)+" m"),a.push(Dt(n.x2.x)+" "+Dt(n.x2.y)+" l"),a.push(Dt(n.x4.x)+" "+Dt(n.x4.y)+" m"),a.push(Dt(n.x3.x)+" "+Dt(n.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=ps(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};ot.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ot.internal.getWidth(e),n=ot.internal.getHeight(e),a=Math.min(t,n);return{x1:{x:(t-a)/2,y:(n-a)/2+a},x2:{x:(t-a)/2+a,y:(n-a)/2},x3:{x:(t-a)/2,y:(n-a)/2},x4:{x:(t-a)/2+a,y:(n-a)/2+a}}}},ot.internal.getWidth=function(e){var t=0;return ln(e)==="object"&&(t=j4(e.Rect[2])),t},ot.internal.getHeight=function(e){var t=0;return ln(e)==="object"&&(t=j4(e.Rect[3])),t};var yH=zn.addField=function(e){if(bH(this,e),!(e instanceof ts))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};zn.AcroFormChoiceField=_u,zn.AcroFormListBox=ju,zn.AcroFormComboBox=Cu,zn.AcroFormEditBox=bf,zn.AcroFormButton=ca,zn.AcroFormPushButton=yf,zn.AcroFormRadioButton=Au,zn.AcroFormCheckBox=wf,zn.AcroFormTextField=Cl,zn.AcroFormPasswordField=Nf,zn.AcroFormAppearance=ot,zn.AcroForm={ChoiceField:_u,ListBox:ju,ComboBox:Cu,EditBox:bf,Button:ca,PushButton:yf,RadioButton:Au,CheckBox:wf,TextField:Cl,PasswordField:Nf,Appearance:ot},xt.AcroForm={ChoiceField:_u,ListBox:ju,ComboBox:Cu,EditBox:bf,Button:ca,PushButton:yf,RadioButton:Au,CheckBox:wf,TextField:Cl,PasswordField:Nf,Appearance:ot};var wH=xt.AcroForm;function jA(e){return e.reduce(function(t,n,a){return t[n]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(j,D){var B,z,U,I,F,q=t;if((D=D||t)==="RGBA"||j.data!==void 0&&j.data instanceof Uint8ClampedArray&&"height"in j&&"width"in j)return"RGBA";if(T(j))for(F in n)for(U=n[F],B=0;B<U.length;B+=1){for(I=!0,z=0;z<U[B].length;z+=1)if(U[B][z]!==void 0&&U[B][z]!==j[z]){I=!1;break}if(I===!0){q=F;break}}else for(F in n)for(U=n[F],B=0;B<U.length;B+=1){for(I=!0,z=0;z<U[B].length;z+=1)if(U[B][z]!==void 0&&U[B][z]!==j.charCodeAt(z)){I=!1;break}if(I===!0){q=F;break}}return q===t&&D!==t&&(q=D),q},r=function j(D){for(var B=this.internal.write,z=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var I=[];if(I.push({key:"Type",value:"/XObject"}),I.push({key:"Subtype",value:"/Image"}),I.push({key:"Width",value:D.width}),I.push({key:"Height",value:D.height}),D.colorSpace===w.INDEXED?I.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(I.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===w.DEVICE_CMYK&&I.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),I.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&I.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)){for(var F="",q=0,O=D.transparency.length;q<O;q++)F+=D.transparency[q]+" "+D.transparency[q]+" ";I.push({key:"Mask",value:"["+F+"]"})}D.sMask!==void 0&&I.push({key:"SMask",value:D.objectId+1+" 0 R"});var $=D.filter!==void 0?["/"+D.filter]:void 0;if(z({data:D.data,additionalKeyValues:I,alreadyAppliedFilters:$,objectId:D.objectId}),B("endobj"),"sMask"in D&&D.sMask!==void 0){var Z="/Predictor "+D.predictor+" /Colors 1 /BitsPerComponent "+D.bitsPerComponent+" /Columns "+D.width,P={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:D.bitsPerComponent,decodeParameters:Z,data:D.sMask};"filter"in D&&(P.filter=D.filter),j.call(this,P)}if(D.colorSpace===w.INDEXED){var W=this.internal.newObject();z({data:A(new Uint8Array(D.palette)),objectId:W}),B("endobj")}},i=function(){var j=this.internal.collections.addImage_images;for(var D in j)r.call(this,j[D])},s=function(){var j,D=this.internal.collections.addImage_images,B=this.internal.write;for(var z in D)B("/I"+(j=D[z]).index,j.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},u=function(){var j=this.internal.collections.addImage_images;return o.call(this),j},c=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(j){return typeof e["process"+j.toUpperCase()]=="function"},h=function(j){return ln(j)==="object"&&j.nodeType===1},p=function(j,D){if(j.nodeName==="IMG"&&j.hasAttribute("src")){var B=""+j.getAttribute("src");if(B.indexOf("data:image/")===0)return xf(unescape(B).split("base64,").pop());var z=e.loadFile(B,!0);if(z!==void 0)return z}if(j.nodeName==="CANVAS"){if(j.width===0||j.height===0)throw new Error("Given canvas must have data. Canvas width: "+j.width+", height: "+j.height);var U;switch(D){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;case"JPEG":case"JPG":default:U="image/jpeg"}return xf(j.toDataURL(U,1).split("base64,").pop())}},f=function(j){var D=this.internal.collections.addImage_images;if(D){for(var B in D)if(j===D[B].alias)return D[B]}},g=function(j,D,B){return j||D||(j=-96,D=-96),j<0&&(j=-1*B.width*72/j/this.internal.scaleFactor),D<0&&(D=-1*B.height*72/D/this.internal.scaleFactor),j===0&&(j=D*B.width/B.height),D===0&&(D=j*B.height/B.width),[j,D]},b=function(j,D,B,z,U,I){var F=g.call(this,B,z,U),q=this.internal.getCoordinateString,O=this.internal.getVerticalCoordinateString,$=u.call(this);if(B=F[0],z=F[1],$[U.index]=U,I){I*=Math.PI/180;var Z=Math.cos(I),P=Math.sin(I),W=function(J){return J.toFixed(4)},K=[W(Z),W(P),W(-1*P),W(Z),0,0,"cm"]}this.internal.write("q"),I?(this.internal.write([1,"0","0",1,q(j),O(D+z),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([q(B),"0","0",q(z),"0","0","cm"].join(" "))):this.internal.write([q(B),"0","0",q(z),q(j),O(D+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},w=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var m=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},x=e.__addimage__.sHashCode=function(j){var D,B,z=0;if(typeof j=="string")for(B=j.length,D=0;D<B;D++)z=(z<<5)-z+j.charCodeAt(D),z|=0;else if(T(j))for(B=j.byteLength/2,D=0;D<B;D++)z=(z<<5)-z+j[D],z|=0;return z},y=e.__addimage__.validateStringAsBase64=function(j){(j=j||"").toString().trim();var D=!0;return j.length===0&&(D=!1),j.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(j.substr(0,j.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(j.substr(-2))===!1&&(D=!1),D},N=e.__addimage__.extractImageFromDataUrl=function(j){var D=(j=j||"").split("base64,"),B=null;if(D.length===2){var z=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(D[0]);Array.isArray(z)&&(B={mimeType:z[1],charset:z[2],data:D[1]})}return B},S=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(j){return S()&&j instanceof ArrayBuffer};var T=e.__addimage__.isArrayBufferView=function(j){return S()&&typeof Uint32Array<"u"&&(j instanceof Int8Array||j instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&j instanceof Uint8ClampedArray||j instanceof Int16Array||j instanceof Uint16Array||j instanceof Int32Array||j instanceof Uint32Array||j instanceof Float32Array||j instanceof Float64Array)},C=e.__addimage__.binaryStringToUint8Array=function(j){for(var D=j.length,B=new Uint8Array(D),z=0;z<D;z++)B[z]=j.charCodeAt(z);return B},A=e.__addimage__.arrayBufferToBinaryString=function(j){for(var D="",B=T(j)?j:new Uint8Array(j),z=0;z<B.length;z+=8192)D+=String.fromCharCode.apply(null,B.subarray(z,z+8192));return D};e.addImage=function(){var j,D,B,z,U,I,F,q,O;if(typeof arguments[1]=="number"?(D=t,B=arguments[1],z=arguments[2],U=arguments[3],I=arguments[4],F=arguments[5],q=arguments[6],O=arguments[7]):(D=arguments[1],B=arguments[2],z=arguments[3],U=arguments[4],I=arguments[5],F=arguments[6],q=arguments[7],O=arguments[8]),ln(j=arguments[0])==="object"&&!h(j)&&"imageData"in j){var $=j;j=$.imageData,D=$.format||D||t,B=$.x||B||0,z=$.y||z||0,U=$.w||$.width||U,I=$.h||$.height||I,F=$.alias||F,q=$.compression||q,O=$.rotation||$.angle||O}var Z=this.internal.getFilters();if(q===void 0&&Z.indexOf("FlateEncode")!==-1&&(q="SLOW"),isNaN(B)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var P=R.call(this,j,D,F,q);return b.call(this,B,z,U,I,P,O),this};var R=function(j,D,B,z){var U,I,F;if(typeof j=="string"&&a(j)===t){j=unescape(j);var q=L(j,!1);(q!==""||(q=e.loadFile(j,!0))!==void 0)&&(j=q)}if(h(j)&&(j=p(j,D)),D=a(j,D),!d(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((F=B)==null||F.length===0)&&(B=function(O){return typeof O=="string"||T(O)?x(O):T(O.data)?x(O.data):null}(j)),(U=f.call(this,B))||(S()&&(j instanceof Uint8Array||D==="RGBA"||(I=j,j=C(j))),U=this["process"+D.toUpperCase()](j,c.call(this),B,function(O){return O&&typeof O=="string"&&(O=O.toUpperCase()),O in e.image_compression?O:m.NONE}(z),I)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},L=e.__addimage__.convertBase64ToBinaryString=function(j,D){var B;D=typeof D!="boolean"||D;var z,U="";if(typeof j=="string"){z=(B=N(j))!==null?B.data:j;try{U=xf(z)}catch(I){if(D)throw y(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+I.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return U};e.getImageProperties=function(j){var D,B,z="";if(h(j)&&(j=p(j)),typeof j=="string"&&a(j)===t&&((z=L(j,!1))===""&&(z=e.loadFile(j)||""),j=z),B=a(j),!d(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(!S()||j instanceof Uint8Array||(j=C(j)),!(D=this["process"+B.toUpperCase()](j)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=B,D}})(xt.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};xt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var a,r,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(n.objId),c=n.pageContext.annotations,d=!1,h=0;h<c.length&&!d;h++)switch((a=c[h]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){a=c[p];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(n.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(b.objId),x=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(r="/Rect ["+s(a.bounds.x)+" "+o(a.bounds.y+a.bounds.h)+" "+s(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y)+"] ")+"/Contents ("+f(m(a.contents))+")",i+=" /Popup "+w.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+f(m(x))+") >>",b.content=i;var y=b.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+s(a.bounds.x+30)+" "+o(a.bounds.y+a.bounds.h)+" "+s(a.bounds.x+a.bounds.w+30)+" "+o(a.bounds.y)+"] ")+" /Parent "+y,a.open&&(i+=" /Open true"),i+=" >>",w.content=i,this.internal.write(b.objId,"0 R",w.objId,"0 R");break;case"freetext":r="/Rect ["+s(a.bounds.x)+" "+o(a.bounds.y)+" "+s(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y+a.bounds.h)+"] ";var N=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+f(g(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var S=this.annotations._nameMap[a.options.name];a.options.pageNumber=S.page,a.options.top=S.y}else a.options.top||(a.options.top=0);if(r="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var T=o(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+T+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var a=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":a.pageContext.annotations.push(n)}},e.link=function(n,a,r,i,s){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(n),y:c(a),w:u(n+r),h:c(a+i)},options:s,type:"link"})},e.textWithLink=function(n,a,r,i){var s,o,u=this.getTextWidth(n),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var d=this.splitTextToSize(n,o).length;s=Math.ceil(c*d)}else o=u,s=c;return this.text(n,a,r,i),r+=.2*c,i.align==="center"&&(a-=u/2),i.align==="right"&&(a-=u),this.link(a,r-c,o,s,i),u},e.getTextWidth=function(n){var a=this.internal.getFontSize();return this.getStringUnitWidth(n)*a/this.internal.scaleFactor}}(xt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(b){return t[b.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},o=e.__arabicParser__.isArabicEndLetter=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(b){return s(b)&&r.indexOf(b.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(b){var w=0,m=n,x="",y=0;for(w=0;w<b.length;w+=1)m[b.charCodeAt(w)]!==void 0?(y++,typeof(m=m[b.charCodeAt(w)])=="number"&&(x+=String.fromCharCode(m),m=n,y=0),w===b.length-1&&(m=n,x+=b.charAt(w-(y-1)),w-=y-1,y=0)):(m=n,x+=b.charAt(w-y),w-=y,y=0);return x};e.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&a[b.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(b,w,m){return s(b)?i(b)===!1?-1:!c(b)||!s(w)&&!s(m)||!s(m)&&o(w)||o(b)&&!s(w)||o(b)&&u(w)||o(b)&&o(w)?0:d(b)&&s(w)&&!o(w)&&s(m)&&c(m)?3:o(b)||!s(m)?1:2:-1},f=function(b){var w=0,m=0,x=0,y="",N="",S="",T=(b=b||"").split("\\s+"),C=[];for(w=0;w<T.length;w+=1){for(C.push(""),m=0;m<T[w].length;m+=1)y=T[w][m],N=T[w][m-1],S=T[w][m+1],s(y)?(x=p(y,N,S),C[w]+=x!==-1?String.fromCharCode(t[y.charCodeAt(0)][x]):y):C[w]+=y;C[w]=h(C[w])}return C.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var b,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,m=[];if(Array.isArray(w)){var x=0;for(m=[],x=0;x<w.length;x+=1)Array.isArray(w[x])?m.push([f(w[x][0]),w[x][1],w[x][2]]):m.push([f(w[x])]);b=m}else b=f(w);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};e.events.push(["preProcessText",g])}(xt.API),xt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,a){var r;if((n=n||"2d")!=="2d")return null;for(r in a)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=a[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(xt.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(b){c=b}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(b){f=b}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(b){g=b}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,c){a.call(this);var d=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,f=0,g=0,b=0,w=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var m=c.maxWidth;m>0?typeof u=="string"?u=this.splitTextToSize(u,m):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(y,N){return y.concat(w.splitTextToSize(N,m))},[])):u=Array.isArray(u)?u:[u];for(var x=0;x<u.length;x++)f<(b=this.getStringUnitWidth(u[x],{font:h})*d)&&(f=b);return f!==0&&(g=u.length),{w:f/=p,h:Math.max((g*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var c=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===u.lineNumber?(u.x=(c.x||0)+(c.width||0),u.y=c.y||0):c.y+c.height+u.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=h.top,f&&p&&(this.printHeaderRow(u.lineNumber,!0),u.y+=p[0].height)):u.y=c.y+c.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,n===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-d,u.y+d,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+d,{align:"center",baseline:"top",maxWidth:u.width-d-d}):this.text(u.text,u.x+d,u.y+d,{align:"left",baseline:"top",maxWidth:u.width-d-d})),this.internal.__cell__.lastCell=u,this};e.table=function(u,c,d,h,p){if(a.call(this),!d)throw new Error("No data for PDF table.");var f,g,b,w,m=[],x=[],y=[],N={},S={},T=[],C=[],A=(p=p||{}).autoSize||!1,R=p.printHeaders!==!1,L=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,j=p.margins||Object.assign({width:this.getPageWidth()},t),D=typeof p.padding=="number"?p.padding:3,B=p.headerBackgroundColor||"#c8c8c8",z=p.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=R,this.internal.__cell__.margins=j,this.internal.__cell__.table_font_size=L,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=z,this.setFontSize(L),h==null)x=m=Object.keys(d[0]),y=m.map(function(){return"left"});else if(Array.isArray(h)&&ln(h[0])==="object")for(m=h.map(function($){return $.name}),x=h.map(function($){return $.prompt||$.name||""}),y=h.map(function($){return $.align||"left"}),f=0;f<h.length;f+=1)S[h[f].name]=h[f].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(x=m=h,y=m.map(function(){return"left"}));if(A||Array.isArray(h)&&typeof h[0]=="string")for(f=0;f<m.length;f+=1){for(N[w=m[f]]=d.map(function($){return $[w]}),this.setFont(void 0,"bold"),T.push(this.getTextDimensions(x[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=N[w],this.setFont(void 0,"normal"),b=0;b<g.length;b+=1)T.push(this.getTextDimensions(g[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);S[w]=Math.max.apply(null,T)+D+D,T=[]}if(R){var U={};for(f=0;f<m.length;f+=1)U[m[f]]={},U[m[f]].text=x[f],U[m[f]].align=y[f];var I=o.call(this,U,S);C=m.map(function($){return new i(u,c,S[$],I,U[$].text,void 0,U[$].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var F=h.reduce(function($,Z){return $[Z.name]=Z.align,$},{});for(f=0;f<d.length;f+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:f,data:d[f]},this);var q=o.call(this,d[f],S);for(b=0;b<m.length;b+=1){var O=d[f][m[b]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:f,col:b,data:O},this),s.call(this,new i(u,c,S[m[b]],q,O,f+2,F[m[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=c,this};var o=function(u,c){var d=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(u).map(function(f){var g=u[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,c[f]-d-d)},this).map(function(f){return this.getLineHeightFactor()*f.length*h/p+d+d},this).reduce(function(f,g){return Math.max(f,g)},0)};e.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,c){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){d=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=u;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,d),this.setTextColor(g)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),n=!1}}(xt.API);var CA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},AA=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ay=jA(AA),EA=[100,200,300,400,500,600,700,800,900],NH=jA(EA);function Ey(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(i){return CA[i=i||"normal"]?i:"normal"}(e.style),a=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),r=function(i){return typeof Ay[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:n,weight:a,stretch:r,src:e.src||[],ref:e.ref||{name:t,style:[r,n,a].join(" ")}}}function C4(e,t,n,a){var r;for(r=n;r>=0&&r<t.length;r+=a)if(e[t[r]])return e[t[r]];for(r=n;r>=0&&r<t.length;r-=a)if(e[t[r]])return e[t[r]]}var kH={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},A4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function E4(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function SH(e,t,n){for(var a=(n=n||{}).defaultFontFamily||"times",r=Object.assign({},kH,n.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(r[(i=Ey(t[o])).family]&&(i.family=r[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[a]))throw new Error("Could not find a font-family for the rule '"+E4(i)+"' and default family '"+a+"'.");if(s=function(u,c){if(c[u])return c[u];var d=Ay[u],h=d<=Ay.normal?-1:1,p=C4(c,AA,d,h);if(!p)throw new Error("Could not find a matching font-stretch value for "+u);return p}(i.stretch,s),s=function(u,c){if(c[u])return c[u];for(var d=CA[u],h=0;h<d.length;++h)if(c[d[h]])return c[d[h]];throw new Error("Could not find a matching font-style for "+u)}(i.style,s),!(s=function(u,c){if(c[u])return c[u];if(u===400&&c[500])return c[500];if(u===500&&c[400])return c[400];var d=NH[u],h=C4(c,EA,d,u<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+u);return h}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+E4(i)+"'.");return s}function D4(e){return e.trimLeft()}function _H(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function jH(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Zm,T4,R4,Ub=["times"];(function(e){var t,n,a,r,i,s,o,u,c,d=function(P){return P=P||{},this.isStrokeTransparent=P.isStrokeTransparent||!1,this.strokeOpacity=P.strokeOpacity||1,this.strokeStyle=P.strokeStyle||"#000000",this.fillStyle=P.fillStyle||"#000000",this.isFillTransparent=P.isFillTransparent||!1,this.fillOpacity=P.fillOpacity||1,this.font=P.font||"10px sans-serif",this.textBaseline=P.textBaseline||"alphabetic",this.textAlign=P.textAlign||"left",this.lineWidth=P.lineWidth||1,this.lineJoin=P.lineJoin||"miter",this.lineCap=P.lineCap||"butt",this.path=P.path||[],this.transform=P.transform!==void 0?P.transform.clone():new u,this.globalCompositeOperation=P.globalCompositeOperation||"normal",this.globalAlpha=P.globalAlpha||1,this.clip_path=P.clip_path||[],this.currentPoint=P.currentPoint||new s,this.miterLimit=P.miterLimit||10,this.lastPoint=P.lastPoint||new s,this.lineDashOffset=P.lineDashOffset||0,this.lineDash=P.lineDash||[],this.margin=P.margin||[0,0,0,0],this.prevPageLastElemOffset=P.prevPageLastElemOffset||0,this.ignoreClearRect=typeof P.ignoreClearRect!="boolean"||P.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,n=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,c=new d}]);var h=function(P){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var W=P;Object.defineProperty(this,"pdf",{get:function(){return W}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(xe){K=!!xe}});var J=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return J},set:function(xe){J=!!xe}});var H=0;Object.defineProperty(this,"posX",{get:function(){return H},set:function(xe){isNaN(xe)||(H=xe)}});var ie=0;Object.defineProperty(this,"posY",{get:function(){return ie},set:function(xe){isNaN(xe)||(ie=xe)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(xe){var ne;typeof xe=="number"?ne=[xe,xe,xe,xe]:((ne=new Array(4))[0]=xe[0],ne[1]=xe.length>=2?xe[1]:ne[0],ne[2]=xe.length>=3?xe[2]:ne[0],ne[3]=xe.length>=4?xe[3]:ne[1]),c.margin=ne}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(xe){ue=xe}});var ce=0;Object.defineProperty(this,"lastBreak",{get:function(){return ce},set:function(xe){ce=xe}});var pe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return pe},set:function(xe){pe=xe}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(xe){xe instanceof d&&(c=xe)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(xe){c.path=xe}});var ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return ve},set:function(xe){ve=xe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(xe){var ne;ne=p(xe),this.ctx.fillStyle=ne.style,this.ctx.isFillTransparent=ne.a===0,this.ctx.fillOpacity=ne.a,this.pdf.setFillColor(ne.r,ne.g,ne.b,{a:ne.a}),this.pdf.setTextColor(ne.r,ne.g,ne.b,{a:ne.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(xe){var ne=p(xe);this.ctx.strokeStyle=ne.style,this.ctx.isStrokeTransparent=ne.a===0,this.ctx.strokeOpacity=ne.a,ne.a===0?this.pdf.setDrawColor(255,255,255):(ne.a,this.pdf.setDrawColor(ne.r,ne.g,ne.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(xe){["butt","round","square"].indexOf(xe)!==-1&&(this.ctx.lineCap=xe,this.pdf.setLineCap(xe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(xe){isNaN(xe)||(this.ctx.lineWidth=xe,this.pdf.setLineWidth(xe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(xe){["bevel","round","miter"].indexOf(xe)!==-1&&(this.ctx.lineJoin=xe,this.pdf.setLineJoin(xe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(xe){isNaN(xe)||(this.ctx.miterLimit=xe,this.pdf.setMiterLimit(xe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(xe){this.ctx.textBaseline=xe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(xe){["right","end","center","left","start"].indexOf(xe)!==-1&&(this.ctx.textAlign=xe)}});var De=null;function Re(xe,ne){if(De===null){var Qe=function(Je){var Ae=[];return Object.keys(Je).forEach(function(Ge){Je[Ge].forEach(function(_e){var de=null;switch(_e){case"bold":de={family:Ge,weight:"bold"};break;case"italic":de={family:Ge,style:"italic"};break;case"bolditalic":de={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":de={family:Ge}}de!==null&&(de.ref={name:Ge,style:_e},Ae.push(de))})}),Ae}(xe.getFontList());De=function(Je){for(var Ae={},Ge=0;Ge<Je.length;++Ge){var _e=Ey(Je[Ge]),de=_e.family,ke=_e.stretch,Fe=_e.style,Ze=_e.weight;Ae[de]=Ae[de]||{},Ae[de][ke]=Ae[de][ke]||{},Ae[de][ke][Fe]=Ae[de][ke][Fe]||{},Ae[de][ke][Fe][Ze]=_e}return Ae}(Qe.concat(ne))}return De}var we=null;Object.defineProperty(this,"fontFaces",{get:function(){return we},set:function(xe){De=null,we=xe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(xe){var ne;if(this.ctx.font=xe,(ne=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(xe))!==null){var Qe=ne[1],Je=(ne[2],ne[3]),Ae=ne[4],Ge=(ne[5],ne[6]),_e=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ae)[2];Ae=Math.floor(_e==="px"?parseFloat(Ae)*this.pdf.internal.scaleFactor:_e==="em"?parseFloat(Ae)*this.pdf.getFontSize():parseFloat(Ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ae);var de=function(Ke){var et,He,wt=[],dt=Ke.trim();if(dt==="")return Ub;if(dt in A4)return[A4[dt]];for(;dt!=="";){switch(He=null,et=(dt=D4(dt)).charAt(0)){case'"':case"'":He=_H(dt.substring(1),et);break;default:He=jH(dt)}if(He===null||(wt.push(He[0]),(dt=D4(He[1]))!==""&&dt.charAt(0)!==","))return Ub;dt=dt.replace(/^,/,"")}return wt}(Ge);if(this.fontFaces){var ke=SH(Re(this.pdf,this.fontFaces),de.map(function(Ke){return{family:Ke,stretch:"normal",weight:Je,style:Qe}}));this.pdf.setFont(ke.ref.name,ke.ref.style)}else{var Fe="";(Je==="bold"||parseInt(Je,10)>=700||Qe==="bold")&&(Fe="bold"),Qe==="italic"&&(Fe+="italic"),Fe.length===0&&(Fe="normal");for(var Ze="",Xe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},oe=0;oe<de.length;oe++){if(this.pdf.internal.getFont(de[oe],Fe,{noFallback:!0,disableWarning:!0})!==void 0){Ze=de[oe];break}if(Fe==="bolditalic"&&this.pdf.internal.getFont(de[oe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ze=de[oe],Fe="bold";else if(this.pdf.internal.getFont(de[oe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ze=de[oe],Fe="normal";break}}if(Ze===""){for(var Be=0;Be<de.length;Be++)if(Xe[de[Be]]){Ze=Xe[de[Be]];break}}Ze=Ze===""?"Times":Ze,this.pdf.setFont(Ze,Fe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(xe){this.ctx.globalCompositeOperation=xe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(xe){this.ctx.globalAlpha=xe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(xe){this.ctx.lineDashOffset=xe,Z.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(xe){this.ctx.lineDash=xe,Z.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(xe){this.ctx.ignoreClearRect=!!xe}})};h.prototype.setLineDash=function(P){this.lineDash=P},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){N.call(this,"fill",!1)},h.prototype.stroke=function(){N.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(P,W){if(isNaN(P)||isNaN(W))throw pn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new s(P,W));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new s(P,W)},h.prototype.closePath=function(){var P=new s(0,0),W=0;for(W=this.path.length-1;W!==-1;W--)if(this.path[W].type==="begin"&&ln(this.path[W+1])==="object"&&typeof this.path[W+1].x=="number"){P=new s(this.path[W+1].x,this.path[W+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(P.x,P.y)},h.prototype.lineTo=function(P,W){if(isNaN(P)||isNaN(W))throw pn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new s(P,W));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new s(K.x,K.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},h.prototype.quadraticCurveTo=function(P,W,K,J){if(isNaN(K)||isNaN(J)||isNaN(P)||isNaN(W))throw pn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var H=this.ctx.transform.applyToPoint(new s(K,J)),ie=this.ctx.transform.applyToPoint(new s(P,W));this.path.push({type:"qct",x1:ie.x,y1:ie.y,x:H.x,y:H.y}),this.ctx.lastPoint=new s(H.x,H.y)},h.prototype.bezierCurveTo=function(P,W,K,J,H,ie){if(isNaN(H)||isNaN(ie)||isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J))throw pn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new s(H,ie)),ce=this.ctx.transform.applyToPoint(new s(P,W)),pe=this.ctx.transform.applyToPoint(new s(K,J));this.path.push({type:"bct",x1:ce.x,y1:ce.y,x2:pe.x,y2:pe.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new s(ue.x,ue.y)},h.prototype.arc=function(P,W,K,J,H,ie){if(isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J)||isNaN(H))throw pn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ie=!!ie,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new s(P,W));P=ue.x,W=ue.y;var ce=this.ctx.transform.applyToPoint(new s(0,K)),pe=this.ctx.transform.applyToPoint(new s(0,0));K=Math.sqrt(Math.pow(ce.x-pe.x,2)+Math.pow(ce.y-pe.y,2))}Math.abs(H-J)>=2*Math.PI&&(J=0,H=2*Math.PI),this.path.push({type:"arc",x:P,y:W,radius:K,startAngle:J,endAngle:H,counterclockwise:ie})},h.prototype.arcTo=function(P,W,K,J,H){throw new Error("arcTo not implemented.")},h.prototype.rect=function(P,W,K,J){if(isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J))throw pn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(P,W),this.lineTo(P+K,W),this.lineTo(P+K,W+J),this.lineTo(P,W+J),this.lineTo(P,W),this.lineTo(P+K,W),this.lineTo(P,W)},h.prototype.fillRect=function(P,W,K,J){if(isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J))throw pn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var H={};this.lineCap!=="butt"&&(H.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(H.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(P,W,K,J),this.fill(),H.hasOwnProperty("lineCap")&&(this.lineCap=H.lineCap),H.hasOwnProperty("lineJoin")&&(this.lineJoin=H.lineJoin)}},h.prototype.strokeRect=function(P,W,K,J){if(isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J))throw pn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(P,W,K,J),this.stroke())},h.prototype.clearRect=function(P,W,K,J){if(isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J))throw pn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(P,W,K,J))},h.prototype.save=function(P){P=typeof P!="boolean"||P;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(W),P){this.ctx.fontSize=this.pdf.internal.getFontSize();var J=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=J}},h.prototype.restore=function(P){P=typeof P!="boolean"||P;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(W),P&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(P){var W,K,J,H;if(P.isCanvasGradient===!0&&(P=P.getColor()),!P)return{r:0,g:0,b:0,a:0,style:P};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(P))W=0,K=0,J=0,H=0;else{var ie=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(P);if(ie!==null)W=parseInt(ie[1]),K=parseInt(ie[2]),J=parseInt(ie[3]),H=1;else if((ie=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(P))!==null)W=parseInt(ie[1]),K=parseInt(ie[2]),J=parseInt(ie[3]),H=parseFloat(ie[4]);else{if(H=1,typeof P=="string"&&P.charAt(0)!=="#"){var ue=new yA(P);P=ue.ok?ue.toHex():"#000000"}P.length===4?(W=P.substring(1,2),W+=W,K=P.substring(2,3),K+=K,J=P.substring(3,4),J+=J):(W=P.substring(1,3),K=P.substring(3,5),J=P.substring(5,7)),W=parseInt(W,16),K=parseInt(K,16),J=parseInt(J,16)}}return{r:W,g:K,b:J,a:H,style:P}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(P,W,K,J){if(isNaN(W)||isNaN(K)||typeof P!="string")throw pn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(J=isNaN(J)?void 0:J,!f.call(this)){var H=q(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;D.call(this,{text:P,x:W,y:K,scale:ie,angle:H,align:this.textAlign,maxWidth:J})}},h.prototype.strokeText=function(P,W,K,J){if(isNaN(W)||isNaN(K)||typeof P!="string")throw pn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){J=isNaN(J)?void 0:J;var H=q(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;D.call(this,{text:P,x:W,y:K,scale:ie,renderingMode:"stroke",angle:H,align:this.textAlign,maxWidth:J})}},h.prototype.measureText=function(P){if(typeof P!="string")throw pn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var W=this.pdf,K=this.pdf.internal.scaleFactor,J=W.internal.getFontSize(),H=W.getStringUnitWidth(P)*J/W.internal.scaleFactor,ie=function(ue){var ce=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ce}}),this};return new ie({width:H*=Math.round(96*K/72*1e4)/1e4})},h.prototype.scale=function(P,W){if(isNaN(P)||isNaN(W))throw pn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new u(P,0,0,W,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},h.prototype.rotate=function(P){if(isNaN(P))throw pn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var W=new u(Math.cos(P),Math.sin(P),-Math.sin(P),Math.cos(P),0,0);this.ctx.transform=this.ctx.transform.multiply(W)},h.prototype.translate=function(P,W){if(isNaN(P)||isNaN(W))throw pn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new u(1,0,0,1,P,W);this.ctx.transform=this.ctx.transform.multiply(K)},h.prototype.transform=function(P,W,K,J,H,ie){if(isNaN(P)||isNaN(W)||isNaN(K)||isNaN(J)||isNaN(H)||isNaN(ie))throw pn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new u(P,W,K,J,H,ie);this.ctx.transform=this.ctx.transform.multiply(ue)},h.prototype.setTransform=function(P,W,K,J,H,ie){P=isNaN(P)?1:P,W=isNaN(W)?0:W,K=isNaN(K)?0:K,J=isNaN(J)?1:J,H=isNaN(H)?0:H,ie=isNaN(ie)?0:ie,this.ctx.transform=new u(P,W,K,J,H,ie)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(P,W,K,J,H,ie,ue,ce,pe){var ve=this.pdf.getImageProperties(P),De=1,Re=1,we=1,xe=1;J!==void 0&&ce!==void 0&&(we=ce/J,xe=pe/H,De=ve.width/J*ce/J,Re=ve.height/H*pe/H),ie===void 0&&(ie=W,ue=K,W=0,K=0),J!==void 0&&ce===void 0&&(ce=J,pe=H),J===void 0&&ce===void 0&&(ce=ve.width,pe=ve.height);for(var ne,Qe=this.ctx.transform.decompose(),Je=q(Qe.rotate.shx),Ae=new u,Ge=(Ae=(Ae=(Ae=Ae.multiply(Qe.translate)).multiply(Qe.skew)).multiply(Qe.scale)).applyToRectangle(new o(ie-W*we,ue-K*xe,J*De,H*Re)),_e=w.call(this,Ge),de=[],ke=0;ke<_e.length;ke+=1)de.indexOf(_e[ke])===-1&&de.push(_e[ke]);if(y(de),this.autoPaging)for(var Fe=de[0],Ze=de[de.length-1],Xe=Fe;Xe<Ze+1;Xe++){this.pdf.setPage(Xe);var oe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Xe===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],He=Xe===1?0:Ke+(Xe-2)*et;if(this.ctx.clip_path.length!==0){var wt=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(ne,this.posX+this.margin[3],-He+Be+this.ctx.prevPageLastElemOffset),S.call(this,"fill",!0),this.path=wt}var dt=JSON.parse(JSON.stringify(Ge));dt=x([dt],this.posX+this.margin[3],-He+Be+this.ctx.prevPageLastElemOffset)[0];var _n=(Xe>Fe||Xe<Ze)&&b.call(this);_n&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],oe,et,null).clip().discardPath()),this.pdf.addImage(P,"JPEG",dt.x,dt.y,dt.w,dt.h,null,null,Je),_n&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(P,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,Je)};var w=function(P,W,K){var J=[];W=W||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var H=this.posY+this.ctx.prevPageLastElemOffset;switch(P.type){default:case"mt":case"lt":J.push(Math.floor((P.y+H)/K)+1);break;case"arc":J.push(Math.floor((P.y+H-P.radius)/K)+1),J.push(Math.floor((P.y+H+P.radius)/K)+1);break;case"qct":var ie=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x,P.y);J.push(Math.floor((ie.y+H)/K)+1),J.push(Math.floor((ie.y+ie.h+H)/K)+1);break;case"bct":var ue=$(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x2,P.y2,P.x,P.y);J.push(Math.floor((ue.y+H)/K)+1),J.push(Math.floor((ue.y+ue.h+H)/K)+1);break;case"rect":J.push(Math.floor((P.y+H)/K)+1),J.push(Math.floor((P.y+P.h+H)/K)+1)}for(var ce=0;ce<J.length;ce+=1)for(;this.pdf.internal.getNumberOfPages()<J[ce];)m.call(this);return J},m=function(){var P=this.fillStyle,W=this.strokeStyle,K=this.font,J=this.lineCap,H=this.lineWidth,ie=this.lineJoin;this.pdf.addPage(),this.fillStyle=P,this.strokeStyle=W,this.font=K,this.lineCap=J,this.lineWidth=H,this.lineJoin=ie},x=function(P,W,K){for(var J=0;J<P.length;J++)switch(P[J].type){case"bct":P[J].x2+=W,P[J].y2+=K;case"qct":P[J].x1+=W,P[J].y1+=K;case"mt":case"lt":case"arc":default:P[J].x+=W,P[J].y+=K}return P},y=function(P){return P.sort(function(W,K){return W-K})},N=function(P,W){for(var K,J,H=this.fillStyle,ie=this.strokeStyle,ue=this.lineCap,ce=this.lineWidth,pe=Math.abs(ce*this.ctx.transform.scaleX),ve=this.lineJoin,De=JSON.parse(JSON.stringify(this.path)),Re=JSON.parse(JSON.stringify(this.path)),we=[],xe=0;xe<Re.length;xe++)if(Re[xe].x!==void 0)for(var ne=w.call(this,Re[xe]),Qe=0;Qe<ne.length;Qe+=1)we.indexOf(ne[Qe])===-1&&we.push(ne[Qe]);for(var Je=0;Je<we.length;Je++)for(;this.pdf.internal.getNumberOfPages()<we[Je];)m.call(this);if(y(we),this.autoPaging)for(var Ae=we[0],Ge=we[we.length-1],_e=Ae;_e<Ge+1;_e++){this.pdf.setPage(_e),this.fillStyle=H,this.strokeStyle=ie,this.lineCap=ue,this.lineWidth=pe,this.lineJoin=ve;var de=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ke=_e===1?this.posY+this.margin[0]:this.margin[0],Fe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=_e===1?0:Fe+(_e-2)*Ze;if(this.ctx.clip_path.length!==0){var oe=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(K,this.posX+this.margin[3],-Xe+ke+this.ctx.prevPageLastElemOffset),S.call(this,P,!0),this.path=oe}if(J=JSON.parse(JSON.stringify(De)),this.path=x(J,this.posX+this.margin[3],-Xe+ke+this.ctx.prevPageLastElemOffset),W===!1||_e===0){var Be=(_e>Ae||_e<Ge)&&b.call(this);Be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],de,Ze,null).clip().discardPath()),S.call(this,P,W),Be&&this.pdf.restoreGraphicsState()}this.lineWidth=ce}else this.lineWidth=pe,S.call(this,P,W),this.lineWidth=ce;this.path=De},S=function(P,W){if((P!=="stroke"||W||!g.call(this))&&(P==="stroke"||W||!f.call(this))){for(var K,J,H=[],ie=this.path,ue=0;ue<ie.length;ue++){var ce=ie[ue];switch(ce.type){case"begin":H.push({begin:!0});break;case"close":H.push({close:!0});break;case"mt":H.push({start:ce,deltas:[],abs:[]});break;case"lt":var pe=H.length;if(ie[ue-1]&&!isNaN(ie[ue-1].x)&&(K=[ce.x-ie[ue-1].x,ce.y-ie[ue-1].y],pe>0)){for(;pe>=0;pe--)if(H[pe-1].close!==!0&&H[pe-1].begin!==!0){H[pe-1].deltas.push(K),H[pe-1].abs.push(ce);break}}break;case"bct":K=[ce.x1-ie[ue-1].x,ce.y1-ie[ue-1].y,ce.x2-ie[ue-1].x,ce.y2-ie[ue-1].y,ce.x-ie[ue-1].x,ce.y-ie[ue-1].y],H[H.length-1].deltas.push(K);break;case"qct":var ve=ie[ue-1].x+2/3*(ce.x1-ie[ue-1].x),De=ie[ue-1].y+2/3*(ce.y1-ie[ue-1].y),Re=ce.x+2/3*(ce.x1-ce.x),we=ce.y+2/3*(ce.y1-ce.y),xe=ce.x,ne=ce.y;K=[ve-ie[ue-1].x,De-ie[ue-1].y,Re-ie[ue-1].x,we-ie[ue-1].y,xe-ie[ue-1].x,ne-ie[ue-1].y],H[H.length-1].deltas.push(K);break;case"arc":H.push({deltas:[],abs:[],arc:!0}),Array.isArray(H[H.length-1].abs)&&H[H.length-1].abs.push(ce)}}J=W?null:P==="stroke"?"stroke":"fill";for(var Qe=!1,Je=0;Je<H.length;Je++)if(H[Je].arc)for(var Ae=H[Je].abs,Ge=0;Ge<Ae.length;Ge++){var _e=Ae[Ge];_e.type==="arc"?A.call(this,_e.x,_e.y,_e.radius,_e.startAngle,_e.endAngle,_e.counterclockwise,void 0,W,!Qe):B.call(this,_e.x,_e.y),Qe=!0}else if(H[Je].close===!0)this.pdf.internal.out("h"),Qe=!1;else if(H[Je].begin!==!0){var de=H[Je].start.x,ke=H[Je].start.y;z.call(this,H[Je].deltas,de,ke),Qe=!0}J&&R.call(this,J),W&&L.call(this)}},T=function(P){var W=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=W*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return P-K;case"top":return P+W-K;case"hanging":return P+W-2*K;case"middle":return P+W/2-K;case"ideographic":return P;case"alphabetic":default:return P}},C=function(P){return P+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var P=function(){};return P.colorStops=[],P.addColorStop=function(W,K){this.colorStops.push([W,K])},P.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},P.isCanvasGradient=!0,P},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(P,W,K,J,H,ie,ue,ce,pe){for(var ve=I.call(this,K,J,H,ie),De=0;De<ve.length;De++){var Re=ve[De];De===0&&(pe?j.call(this,Re.x1+P,Re.y1+W):B.call(this,Re.x1+P,Re.y1+W)),U.call(this,P,W,Re.x2,Re.y2,Re.x3,Re.y3,Re.x4,Re.y4)}ce?L.call(this):R.call(this,ue)},R=function(P){switch(P){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},L=function(){this.pdf.clip(),this.pdf.discardPath()},j=function(P,W){this.pdf.internal.out(n(P)+" "+a(W)+" m")},D=function(P){var W;switch(P.align){case"right":case"end":W="right";break;case"center":W="center";break;case"left":case"start":default:W="left"}var K=this.pdf.getTextDimensions(P.text),J=T.call(this,P.y),H=C.call(this,J)-K.h,ie=this.ctx.transform.applyToPoint(new s(P.x,J)),ue=this.ctx.transform.decompose(),ce=new u;ce=(ce=(ce=ce.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var pe,ve,De,Re=this.ctx.transform.applyToRectangle(new o(P.x,J,K.w,K.h)),we=ce.applyToRectangle(new o(P.x,H,K.w,K.h)),xe=w.call(this,we),ne=[],Qe=0;Qe<xe.length;Qe+=1)ne.indexOf(xe[Qe])===-1&&ne.push(xe[Qe]);if(y(ne),this.autoPaging)for(var Je=ne[0],Ae=ne[ne.length-1],Ge=Je;Ge<Ae+1;Ge++){this.pdf.setPage(Ge);var _e=Ge===1?this.posY+this.margin[0]:this.margin[0],de=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ke=this.pdf.internal.pageSize.height-this.margin[2],Fe=ke-this.margin[0],Ze=this.pdf.internal.pageSize.width-this.margin[1],Xe=Ze-this.margin[3],oe=Ge===1?0:de+(Ge-2)*Fe;if(this.ctx.clip_path.length!==0){var Be=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(pe,this.posX+this.margin[3],-1*oe+_e),S.call(this,"fill",!0),this.path=Be}var Ke=x([JSON.parse(JSON.stringify(we))],this.posX+this.margin[3],-oe+_e+this.ctx.prevPageLastElemOffset)[0];P.scale>=.01&&(ve=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ve*P.scale),De=this.lineWidth,this.lineWidth=De*P.scale);var et=this.autoPaging!=="text";if(et||Ke.y+Ke.h<=ke){if(et||Ke.y>=_e&&Ke.x<=Ze){var He=et?P.text:this.pdf.splitTextToSize(P.text,P.maxWidth||Ze-Ke.x)[0],wt=x([JSON.parse(JSON.stringify(Re))],this.posX+this.margin[3],-oe+_e+this.ctx.prevPageLastElemOffset)[0],dt=et&&(Ge>Je||Ge<Ae)&&b.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Fe,null).clip().discardPath()),this.pdf.text(He,wt.x,wt.y,{angle:P.angle,align:W,renderingMode:P.renderingMode}),dt&&this.pdf.restoreGraphicsState()}}else Ke.y<ke&&(this.ctx.prevPageLastElemOffset+=ke-Ke.y);P.scale>=.01&&(this.pdf.setFontSize(ve),this.lineWidth=De)}else P.scale>=.01&&(ve=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ve*P.scale),De=this.lineWidth,this.lineWidth=De*P.scale),this.pdf.text(P.text,ie.x+this.posX,ie.y+this.posY,{angle:P.angle,align:W,renderingMode:P.renderingMode,maxWidth:P.maxWidth}),P.scale>=.01&&(this.pdf.setFontSize(ve),this.lineWidth=De)},B=function(P,W,K,J){K=K||0,J=J||0,this.pdf.internal.out(n(P+K)+" "+a(W+J)+" l")},z=function(P,W,K){return this.pdf.lines(P,W,K,null,null)},U=function(P,W,K,J,H,ie,ue,ce){this.pdf.internal.out([t(r(K+P)),t(i(J+W)),t(r(H+P)),t(i(ie+W)),t(r(ue+P)),t(i(ce+W)),"c"].join(" "))},I=function(P,W,K,J){for(var H=2*Math.PI,ie=Math.PI/2;W>K;)W-=H;var ue=Math.abs(K-W);ue<H&&J&&(ue=H-ue);for(var ce=[],pe=J?-1:1,ve=W;ue>1e-5;){var De=ve+pe*Math.min(ue,ie);ce.push(F.call(this,P,ve,De)),ue-=Math.abs(De-ve),ve=De}return ce},F=function(P,W,K){var J=(K-W)/2,H=P*Math.cos(J),ie=P*Math.sin(J),ue=H,ce=-ie,pe=ue*ue+ce*ce,ve=pe+ue*H+ce*ie,De=4/3*(Math.sqrt(2*pe*ve)-ve)/(ue*ie-ce*H),Re=ue-De*ce,we=ce+De*ue,xe=Re,ne=-we,Qe=J+W,Je=Math.cos(Qe),Ae=Math.sin(Qe);return{x1:P*Math.cos(W),y1:P*Math.sin(W),x2:Re*Je-we*Ae,y2:Re*Ae+we*Je,x3:xe*Je-ne*Ae,y3:xe*Ae+ne*Je,x4:P*Math.cos(K),y4:P*Math.sin(K)}},q=function(P){return 180*P/Math.PI},O=function(P,W,K,J,H,ie){var ue=P+.5*(K-P),ce=W+.5*(J-W),pe=H+.5*(K-H),ve=ie+.5*(J-ie),De=Math.min(P,H,ue,pe),Re=Math.max(P,H,ue,pe),we=Math.min(W,ie,ce,ve),xe=Math.max(W,ie,ce,ve);return new o(De,we,Re-De,xe-we)},$=function(P,W,K,J,H,ie,ue,ce){var pe,ve,De,Re,we,xe,ne,Qe,Je,Ae,Ge,_e,de,ke,Fe=K-P,Ze=J-W,Xe=H-K,oe=ie-J,Be=ue-H,Ke=ce-ie;for(ve=0;ve<41;ve++)Je=(ne=(De=P+(pe=ve/40)*Fe)+pe*((we=K+pe*Xe)-De))+pe*(we+pe*(H+pe*Be-we)-ne),Ae=(Qe=(Re=W+pe*Ze)+pe*((xe=J+pe*oe)-Re))+pe*(xe+pe*(ie+pe*Ke-xe)-Qe),ve==0?(Ge=Je,_e=Ae,de=Je,ke=Ae):(Ge=Math.min(Ge,Je),_e=Math.min(_e,Ae),de=Math.max(de,Je),ke=Math.max(ke,Ae));return new o(Math.round(Ge),Math.round(_e),Math.round(de-Ge),Math.round(ke-_e))},Z=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var P,W,K=(P=this.ctx.lineDash,W=this.ctx.lineDashOffset,JSON.stringify({lineDash:P,lineDashOffset:W}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(xt.API),function(e){var t=function(i){var s,o,u,c,d,h,p,f,g,b;for(o=[],u=0,c=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;c>u;u+=4)(d=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(h=(d=((d=((d=((d=(d-(b=d%85))/85)-(g=d%85))/85)-(f=d%85))/85)-(p=d%85))/85)%85,o.push(h+33,p+33,f+33,g+33,b+33)):o.push(122);return function(w,m){for(var x=m;x>0;x--)w.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},n=function(i){var s,o,u,c,d,h=String,p="length",f=255,g="charCodeAt",b="slice",w="replace";for(i[b](-2),i=i[b](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),u=[],c=0,d=(i+=s="uuuuu"[b](i[p]%5||5))[p];d>c;c+=5)o=52200625*(i[g](c)-33)+614125*(i[g](c+1)-33)+7225*(i[g](c+2)-33)+85*(i[g](c+3)-33)+(i[g](c+4)-33),u.push(f&o>>24,f&o>>16,f&o>>8,f&o);return function(m,x){for(var y=x;y>0;y--)m.pop()}(u,s[p]),h.fromCharCode.apply(h,u)},a=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",u=0;u<i.length;u+=2)o+=String.fromCharCode("0x"+(i[u]+i[u+1]));return o},r=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=ky(s)).reduce(function(u,c){return u+String.fromCharCode(c)},"")};e.processDataByFilters=function(i,s){var o=0,u=i||"",c=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=r(u),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:u,reverseChain:c.reverse().join(" ")}}}(xt.API),function(e){e.loadFile=function(t,n,a){return function(r,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(u,c,d){var h=new XMLHttpRequest,p=0,f=function(g){var b=g.length,w=[],m=String.fromCharCode;for(p=0;p<b;p+=1)w.push(m(255&g.charCodeAt(p)));return w.join("")};if(h.open("GET",u,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?d(f(this.responseText)):d(void 0)}),h.send(null),c&&h.status===200)return f(h.responseText)}(r,i,s)}catch{}return o}(t,n,a)},e.loadImageFile=e.loadFile}(xt.API),function(e){function t(){return(Nt.html2canvas?Promise.resolve(Nt.html2canvas):gg(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function n(){return(Nt.DOMPurify?Promise.resolve(Nt.DOMPurify):gg(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var a=function(s){var o=ln(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},r=function(s,o){var u=document.createElement(s);for(var c in o.className&&(u.className=o.className),o.innerHTML&&o.dompurify&&(u.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)u.style[c]=o.style[c];return u},i=function s(o){var u=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),c=s.convert(Promise.resolve(),u);return c=(c=c.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(u){switch(a(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(n).then(function(u){return this.set({src:r("div",{innerHTML:s,dompurify:u})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function u(c,d){for(var h=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(u(p,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(h.value=c.value),h.addEventListener("load",function(){h.scrollTop=c.scrollTop,h.scrollLeft=c.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,o(this.prop.container,u)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var u=this.opt.jsPDF,c=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var f=c[p],g=f.src.find(function(b){return b.format==="truetype"});g&&u.addFont(g.url,f.ref.name,f.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),o(this.prop.container,h)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(a(s)!=="object")return this;var o=Object.keys(s||{}).map(function(u){if(u in i.template.prop)return function(){this.prop[u]=s[u]};switch(u){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[u]=s[u]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var u=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(u):u})},i.prototype.setMargin=function(s){return this.then(function(){switch(a(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(u,c){return Math.floor(u*c/72*96)}return this.then(function(){(s=s||xt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,u,c){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),u!=null&&(this.progress.n=u),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,u,c){return this.setProgress(s?this.progress.val+s:null,o||null,u?this.progress.n+u:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(s,o){var u=this;return this.thenCore(s,o,function(c,d){return u.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(h){return u.updateProgress(null,c),h}).then(c,d).then(function(h){return u.updateProgress(1),h})})},i.prototype.thenCore=function(s,o,u){u=u||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=u.call(c,s,o);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(u){o=o.thenCore(u)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,xt.getPageSize=function(s,o,u){if(ln(s)==="object"){var c=s;s=c.orientation,o=c.unit||o,u=c.format||u}o=o||"mm",u=u||"a4",s=(""+(s||"P")).toLowerCase();var d,h=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+o}var f,g=0,b=0;if(p.hasOwnProperty(h))g=p[h][1]/d,b=p[h][0]/d;else try{g=u[1],b=u[0]}catch{throw new Error("Invalid format: "+u)}if(s==="p"||s==="portrait")s="p",b>g&&(f=b,b=g,g=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",g>b&&(f=b,b=g,g=f)}return{width:b,height:g,unit:o,k:d,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Ey):null;var u=new i(o);return o.worker?u:u.from(s).doCallback()}}(xt.API),xt.API.addJS=function(e){return R4=e,this.internal.events.subscribe("postPutResources",function(){Zm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Zm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),T4=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+R4+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Zm!==void 0&&T4!==void 0&&this.internal.out("/Names <</JavaScript "+Zm+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=n.outline.render().split(/\r\n/),i=0;i<r.length;i++){var s=r[i],o=a.exec(s);if(o!=null){var u=o[1];n.internal.newObjectDeferredBegin(u,!1)}n.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,d=[];for(i=0;i<c;i++){var h=n.internal.newObject();d.push(h);var p=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var f=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<d.length;i++)n.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+f+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(a,r,i){var s={title:r,options:i,children:[]};return a==null&&(a=this.root),a.children.push(s),s},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(a){a.id=n.internal.newObjectDeferred();for(var r=0;r<a.children.length;r++)this.genIds_r(a.children[r])},n.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},n.outline.renderItems=function(a){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var s=a.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var u=n.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<a.children.length;c++)this.renderItems(a.children[c])},n.outline.line=function(a){this.ctx.val+=a+`\r
`},n.outline.makeRef=function(a){return a.id+" 0 R"},n.outline.makeString=function(a){return"("+n.internal.pdfEscape(a)+")"},n.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(a,r){for(var i=0;i<r.children.length;i++)a.count++,this.count_r(a,r.children[i]);return a.count}}])}(xt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,a,r,i,s,o){var u,c=this.decode.DCT_DECODE,d=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=s||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(u=function(h){for(var p,f=256*h.charCodeAt(4)+h.charCodeAt(5),g=h.length,b={width:0,height:0,numcomponents:1},w=4;w<g;w+=2){if(w+=f,t.indexOf(h.charCodeAt(w+1))!==-1){p=256*h.charCodeAt(w+5)+h.charCodeAt(w+6),b={width:256*h.charCodeAt(w+7)+h.charCodeAt(w+8),height:p,numcomponents:h.charCodeAt(w+9)};break}f=256*h.charCodeAt(w+2)+h.charCodeAt(w+3)}return b}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:n,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:c,index:a,alias:r}}return d}}(xt.API);var Pc,eg,L4,P4,M4,CH=function(){var e,t,n;function a(i){var s,o,u,c,d,h,p,f,g,b,w,m,x,y;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(s=this.readUInt32(),g=(function(){var N,S;for(S=[],N=0;N<4;++N)S.push(String.fromCharCode(this.data[this.pos++]));return S}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),c=this.readUInt16()||100,h.delay=1e3*d/c,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,s-=4),i=(h!=null?h.data:void 0)||this.imgData,m=0;0<=s?m<s:m>s;0<=s?++m:--m)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((b=u-this.transparency.indexed.length)>0)for(x=0;0<=b?x<b:x>b;0<=b?++x:--x)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(w=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,w.slice(0,p)),this.text[f]=String.fromCharCode.apply(String,w.slice(p+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(y=this.colorType)===4||y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),u=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(h,p,f,g){var b,w,m,x,y,N,S,T,C,A,R,L,j,D,B,z,U,I,F,q,O,$=Math.ceil((c.width-h)/f),Z=Math.ceil((c.height-p)/g),P=c.width==$&&c.height==Z;for(D=s*$,L=P?o:new Uint8Array(D*Z),N=i.length,j=0,w=0;j<Z&&u<N;){switch(i[u++]){case 0:for(x=U=0;U<D;x=U+=1)L[w++]=i[u++];break;case 1:for(x=I=0;I<D;x=I+=1)b=i[u++],y=x<s?0:L[w-s],L[w++]=(b+y)%256;break;case 2:for(x=F=0;F<D;x=F+=1)b=i[u++],m=(x-x%s)/s,B=j&&L[(j-1)*D+m*s+x%s],L[w++]=(B+b)%256;break;case 3:for(x=q=0;q<D;x=q+=1)b=i[u++],m=(x-x%s)/s,y=x<s?0:L[w-s],B=j&&L[(j-1)*D+m*s+x%s],L[w++]=(b+Math.floor((y+B)/2))%256;break;case 4:for(x=O=0;O<D;x=O+=1)b=i[u++],m=(x-x%s)/s,y=x<s?0:L[w-s],j===0?B=z=0:(B=L[(j-1)*D+m*s+x%s],z=m&&L[(j-1)*D+(m-1)*s+x%s]),S=y+B-z,T=Math.abs(S-y),A=Math.abs(S-B),R=Math.abs(S-z),C=T<=A&&T<=R?y:A<=R?B:z,L[w++]=(b+C)%256;break;default:throw new Error("Invalid filter algorithm: "+i[u-1])}if(!P){var W=((p+j*g)*c.width+h)*s,K=j*D;for(x=0;x<$;x+=1){for(var J=0;J<s;J+=1)o[W++]=L[K++];W+=(f-1)*s}}j++}}return i=rH(i),c.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),o},a.prototype.decodePalette=function(){var i,s,o,u,c,d,h,p,f;for(o=this.palette,d=this.transparency.indexed||[],c=new Uint8Array((d.length||0)+o.length),u=0,i=0,s=h=0,p=o.length;h<p;s=h+=3)c[u++]=o[s],c[u++]=o[s+1],c[u++]=o[s+2],c[u++]=(f=d[i++])!=null?f:255;return c},a.prototype.copyToImageData=function(i,s){var o,u,c,d,h,p,f,g,b,w,m;if(u=this.colors,b=null,o=this.hasAlphaChannel,this.palette.length&&(b=(m=this._decodedPalette)!=null?m:this._decodedPalette=this.decodePalette(),u=4,o=!0),g=(c=i.data||i).length,h=b||s,d=p=0,u===1)for(;d<g;)f=b?4*s[d/4]:p,w=h[f++],c[d++]=w,c[d++]=w,c[d++]=w,c[d++]=o?h[f++]:255,p=f;else for(;d<g;)f=b?4*s[d/4]:p,c[d++]=h[f++],c[d++]=h[f++],c[d++]=h[f++],c[d++]=o?h[f++]:255,p=f},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var r=function(){if(Object.prototype.toString.call(Nt)==="[object Window]"){try{t=Nt.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return r(),e=function(i){var s;if(r()===!0)return n.width=i.width,n.height=i.height,n.clearRect(0,0,i.width,i.height),n.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var s,o,u,c,d,h,p,f;if(this.animation){for(f=[],o=d=0,h=(p=this.animation.frames).length;d<h;o=++d)s=p[o],u=i.createImageData(s.width,s.height),c=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(u,c),s.imageData=u,f.push(s.image=e(u));return f}},a.prototype.renderFrame=function(i,s){var o,u,c;return o=(u=this.animation.frames)[s],c=u[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},a.prototype.animate=function(i){var s,o,u,c,d,h,p=this;return o=0,h=this.animation,c=h.numFrames,u=h.frames,d=h.numPlays,(s=function(){var f,g;if(f=o++%c,g=u[f],p.renderFrame(i,f),c>1&&o/c<d)return p.animation._timeout=setTimeout(s,g.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function AH(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,r=e[t++],i=r>>7,s=1<<(7&r)+1;e[t++],e[t++];var o=null,u=null;i&&(o=t,u=s,t+=3*s);var c=!0,d=[],h=0,p=null,f=0,g=null;for(this.width=n,this.height=a;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var b=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],!(1&b)&&(p=null),f=b>>2&7,t++;break;case 254:for(;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var w=e[t++]|e[t++]<<8,m=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,N=e[t++],S=N>>6&1,T=1<<(7&N)+1,C=o,A=u,R=!1;N>>7&&(R=!0,C=t,A=T,t+=3*T);var L=t;for(t++;;){var j;if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}d.push({x:w,y:m,width:x,height:y,has_local_palette:R,palette_offset:C,palette_size:A,data_offset:L,data_length:t-L,transparent_index:p,interlaced:!!S,delay:h,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return g},this.frameInfo=function(D){if(D<0||D>=d.length)throw new Error("Frame index out of range.");return d[D]},this.decodeAndBlitFrameBGRA=function(D,B){var z=this.frameInfo(D),U=z.width*z.height,I=new Uint8Array(U);I4(e,z.data_offset,I,U);var F=z.palette_offset,q=z.transparent_index;q===null&&(q=256);var O=z.width,$=n-O,Z=O,P=4*(z.y*n+z.x),W=4*((z.y+z.height)*n+z.x),K=P,J=4*$;z.interlaced===!0&&(J+=4*n*7);for(var H=8,ie=0,ue=I.length;ie<ue;++ie){var ce=I[ie];if(Z===0&&(Z=O,(K+=J)>=W&&(J=4*$+4*n*(H-1),K=P+(O+$)*(H<<1),H>>=1)),ce===q)K+=4;else{var pe=e[F+3*ce],ve=e[F+3*ce+1],De=e[F+3*ce+2];B[K++]=De,B[K++]=ve,B[K++]=pe,B[K++]=255}--Z}},this.decodeAndBlitFrameRGBA=function(D,B){var z=this.frameInfo(D),U=z.width*z.height,I=new Uint8Array(U);I4(e,z.data_offset,I,U);var F=z.palette_offset,q=z.transparent_index;q===null&&(q=256);var O=z.width,$=n-O,Z=O,P=4*(z.y*n+z.x),W=4*((z.y+z.height)*n+z.x),K=P,J=4*$;z.interlaced===!0&&(J+=4*n*7);for(var H=8,ie=0,ue=I.length;ie<ue;++ie){var ce=I[ie];if(Z===0&&(Z=O,(K+=J)>=W&&(J=4*$+4*n*(H-1),K=P+(O+$)*(H<<1),H>>=1)),ce===q)K+=4;else{var pe=e[F+3*ce],ve=e[F+3*ce+1],De=e[F+3*ce+2];B[K++]=pe,B[K++]=ve,B[K++]=De,B[K++]=255}--Z}}}function I4(e,t,n,a){for(var r=e[t++],i=1<<r,s=i+1,o=s+1,u=r+1,c=(1<<u)-1,d=0,h=0,p=0,f=e[t++],g=new Int32Array(4096),b=null;;){for(;d<16&&f!==0;)h|=e[t++]<<d,d+=8,f===1?f=e[t++]:--f;if(d<u)break;var w=h&c;if(h>>=u,d-=u,w!==i){if(w===s)break;for(var m=w<o?w:b,x=0,y=m;y>i;)y=g[y]>>8,++x;var N=y;if(p+x+(m!==w?1:0)>a)return void pn.log("Warning, gif stream longer than expected.");n[p++]=N;var S=p+=x;for(m!==w&&(n[p++]=N),y=m;x--;)y=g[y],n[--S]=255&y,y>>=8;b!==null&&o<4096&&(g[o++]=b<<8|N,o>=c+1&&u<12&&(++u,c=c<<1|1)),b=w}else o=s+1,c=(1<<(u=r+1))-1,b=null}return p!==a&&pn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function qb(e){var t,n,a,r,i,s=Math.floor,o=new Array(64),u=new Array(64),c=new Array(64),d=new Array(64),h=new Array(65535),p=new Array(65535),f=new Array(64),g=new Array(64),b=[],w=0,m=7,x=new Array(64),y=new Array(64),N=new Array(64),S=new Array(256),T=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],L=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],j=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function I(P,W){for(var K=0,J=0,H=new Array,ie=1;ie<=16;ie++){for(var ue=1;ue<=P[ie];ue++)H[W[J]]=[],H[W[J]][0]=K,H[W[J]][1]=ie,J++,K++;K*=2}return H}function F(P){for(var W=P[0],K=P[1]-1;K>=0;)W&1<<K&&(w|=1<<m),K--,--m<0&&(w==255?(q(255),q(0)):q(w),m=7,w=0)}function q(P){b.push(P)}function O(P){q(P>>8&255),q(255&P)}function $(P,W,K,J,H){for(var ie,ue=H[0],ce=H[240],pe=function(Ae,Ge){var _e,de,ke,Fe,Ze,Xe,oe,Be,Ke,et,He=0;for(Ke=0;Ke<8;++Ke){_e=Ae[He],de=Ae[He+1],ke=Ae[He+2],Fe=Ae[He+3],Ze=Ae[He+4],Xe=Ae[He+5],oe=Ae[He+6];var wt=_e+(Be=Ae[He+7]),dt=_e-Be,_n=de+oe,Rt=de-oe,Mt=ke+Xe,Ua=ke-Xe,Kt=Fe+Ze,Do=Fe-Ze,gn=wt+Kt,Ti=wt-Kt,qs=_n+Mt,Mn=_n-Mt;Ae[He]=gn+qs,Ae[He+4]=gn-qs;var Ct=.707106781*(Mn+Ti);Ae[He+2]=Ti+Ct,Ae[He+6]=Ti-Ct;var en=.382683433*((gn=Do+Ua)-(Mn=Rt+dt)),Hl=.5411961*gn+en,Ra=1.306562965*Mn+en,as=.707106781*(qs=Ua+Rt),rs=dt+as,yt=dt-as;Ae[He+5]=yt+Hl,Ae[He+3]=yt-Hl,Ae[He+1]=rs+Ra,Ae[He+7]=rs-Ra,He+=8}for(He=0,Ke=0;Ke<8;++Ke){_e=Ae[He],de=Ae[He+8],ke=Ae[He+16],Fe=Ae[He+24],Ze=Ae[He+32],Xe=Ae[He+40],oe=Ae[He+48];var Ri=_e+(Be=Ae[He+56]),is=_e-Be,pr=de+oe,oa=de-oe,ea=ke+Xe,Pr=ke-Xe,Xu=Fe+Ze,Hs=Fe-Ze,Li=Ri+Xu,Pi=Ri-Xu,Mi=pr+ea,ss=pr-ea;Ae[He]=Li+Mi,Ae[He+32]=Li-Mi;var si=.707106781*(ss+Pi);Ae[He+16]=Pi+si,Ae[He+48]=Pi-si;var os=.382683433*((Li=Hs+Pr)-(ss=oa+is)),Wl=.5411961*Li+os,Ju=1.306562965*ss+os,Qu=.707106781*(Mi=Pr+oa),Zu=is+Qu,ec=is-Qu;Ae[He+40]=ec+Wl,Ae[He+24]=ec-Wl,Ae[He+8]=Zu+Ju,Ae[He+56]=Zu-Ju,He++}for(Ke=0;Ke<64;++Ke)et=Ae[Ke]*Ge[Ke],f[Ke]=et>0?et+.5|0:et-.5|0;return f}(P,W),ve=0;ve<64;++ve)g[C[ve]]=pe[ve];var De=g[0]-K;K=g[0],De==0?F(J[0]):(F(J[p[ie=32767+De]]),F(h[ie]));for(var Re=63;Re>0&&g[Re]==0;)Re--;if(Re==0)return F(ue),K;for(var we,xe=1;xe<=Re;){for(var ne=xe;g[xe]==0&&xe<=Re;)++xe;var Qe=xe-ne;if(Qe>=16){we=Qe>>4;for(var Je=1;Je<=we;++Je)F(ce);Qe&=15}ie=32767+g[xe],F(H[(Qe<<4)+p[ie]]),F(h[ie]),xe++}return Re!=63&&F(ue),K}function Z(P){P=Math.min(Math.max(P,1),100),i!=P&&(function(W){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],J=0;J<64;J++){var H=s((K[J]*W+50)/100);H=Math.min(Math.max(H,1),255),o[C[J]]=H}for(var ie=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var ce=s((ie[ue]*W+50)/100);ce=Math.min(Math.max(ce,1),255),u[C[ue]]=ce}for(var pe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ve=0,De=0;De<8;De++)for(var Re=0;Re<8;Re++)c[ve]=1/(o[C[ve]]*pe[De]*pe[Re]*8),d[ve]=1/(u[C[ve]]*pe[De]*pe[Re]*8),ve++}(P<50?Math.floor(5e3/P):Math.floor(200-2*P)),i=P)}this.encode=function(P,W){W&&Z(W),b=new Array,w=0,m=7,O(65496),O(65504),O(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),O(1),O(1),q(0),q(0),function(){O(65499),O(132),q(0);for(var de=0;de<64;de++)q(o[de]);q(1);for(var ke=0;ke<64;ke++)q(u[ke])}(),function(de,ke){O(65472),O(17),q(8),O(ke),O(de),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(P.width,P.height),function(){O(65476),O(418),q(0);for(var de=0;de<16;de++)q(A[de+1]);for(var ke=0;ke<=11;ke++)q(R[ke]);q(16);for(var Fe=0;Fe<16;Fe++)q(L[Fe+1]);for(var Ze=0;Ze<=161;Ze++)q(j[Ze]);q(1);for(var Xe=0;Xe<16;Xe++)q(D[Xe+1]);for(var oe=0;oe<=11;oe++)q(B[oe]);q(17);for(var Be=0;Be<16;Be++)q(z[Be+1]);for(var Ke=0;Ke<=161;Ke++)q(U[Ke])}(),O(65498),O(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var K=0,J=0,H=0;w=0,m=7,this.encode.displayName="_encode_";for(var ie,ue,ce,pe,ve,De,Re,we,xe,ne=P.data,Qe=P.width,Je=P.height,Ae=4*Qe,Ge=0;Ge<Je;){for(ie=0;ie<Ae;){for(ve=Ae*Ge+ie,Re=-1,we=0,xe=0;xe<64;xe++)De=ve+(we=xe>>3)*Ae+(Re=4*(7&xe)),Ge+we>=Je&&(De-=Ae*(Ge+1+we-Je)),ie+Re>=Ae&&(De-=ie+Re-Ae+4),ue=ne[De++],ce=ne[De++],pe=ne[De++],x[xe]=(T[ue]+T[ce+256>>0]+T[pe+512>>0]>>16)-128,y[xe]=(T[ue+768>>0]+T[ce+1024>>0]+T[pe+1280>>0]>>16)-128,N[xe]=(T[ue+1280>>0]+T[ce+1536>>0]+T[pe+1792>>0]>>16)-128;K=$(x,c,K,t,a),J=$(y,d,J,n,r),H=$(N,d,H,n,r),ie+=32}Ge+=8}if(m>=0){var _e=[];_e[1]=m+1,_e[0]=(1<<m+1)-1,F(_e)}return O(65497),new Uint8Array(b)},e=e||50,function(){for(var P=String.fromCharCode,W=0;W<256;W++)S[W]=P(W)}(),t=I(A,R),n=I(D,B),a=I(L,j),r=I(z,U),function(){for(var P=1,W=2,K=1;K<=15;K++){for(var J=P;J<W;J++)p[32767+J]=K,h[32767+J]=[],h[32767+J][1]=K,h[32767+J][0]=J;for(var H=-(W-1);H<=-P;H++)p[32767+H]=K,h[32767+H]=[],h[32767+H][1]=K,h[32767+H][0]=W-1+H;P<<=1,W<<=1}}(),function(){for(var P=0;P<256;P++)T[P]=19595*P,T[P+256>>0]=38470*P,T[P+512>>0]=7471*P+32768,T[P+768>>0]=-11059*P,T[P+1024>>0]=-21709*P,T[P+1280>>0]=32768*P+8421375,T[P+1536>>0]=-27439*P,T[P+1792>>0]=-5329*P}(),Z(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Hi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function O4(e){function t(A){if(!A)throw Error("assert :P")}function n(A,R,L){for(var j=0;4>j;j++)if(A[R+j]!=L.charCodeAt(j))return!0;return!1}function a(A,R,L,j,D){for(var B=0;B<D;B++)A[R+B]=L[j+B]}function r(A,R,L,j){for(var D=0;D<j;D++)A[R+D]=L}function i(A){return new Int32Array(A)}function s(A,R){for(var L=[],j=0;j<A;j++)L.push(new R);return L}function o(A,R){var L=[];return function j(D,B,z){for(var U=z[B],I=0;I<U&&(D.push(z.length>B+1?[]:new R),!(z.length<B+1));I++)j(D[I],B+1,z)}(L,0,A),L}var u=function(){var A=this;function R(v,k){for(var E=1<<k-1>>>0;v&E;)E>>>=1;return E?(v&E-1)+E:v}function L(v,k,E,M,G){t(!(M%E));do v[k+(M-=E)]=G;while(0<M)}function j(v,k,E,M,G){if(t(2328>=G),512>=G)var Y=i(512);else if((Y=i(G))==null)return 0;return function(X,Q,ee,re,me,je){var Ce,Ne,qe=Q,Pe=1<<ee,ge=i(16),ye=i(16);for(t(me!=0),t(re!=null),t(X!=null),t(0<ee),Ne=0;Ne<me;++Ne){if(15<re[Ne])return 0;++ge[re[Ne]]}if(ge[0]==me)return 0;for(ye[1]=0,Ce=1;15>Ce;++Ce){if(ge[Ce]>1<<Ce)return 0;ye[Ce+1]=ye[Ce]+ge[Ce]}for(Ne=0;Ne<me;++Ne)Ce=re[Ne],0<re[Ne]&&(je[ye[Ce]++]=Ne);if(ye[15]==1)return(re=new D).g=0,re.value=je[0],L(X,qe,1,Pe,re),Pe;var ze,$e=-1,Ue=Pe-1,it=0,tt=1,vt=1,nt=1<<ee;for(Ne=0,Ce=1,me=2;Ce<=ee;++Ce,me<<=1){if(tt+=vt<<=1,0>(vt-=ge[Ce]))return 0;for(;0<ge[Ce];--ge[Ce])(re=new D).g=Ce,re.value=je[Ne++],L(X,qe+it,me,nt,re),it=R(it,Ce)}for(Ce=ee+1,me=2;15>=Ce;++Ce,me<<=1){if(tt+=vt<<=1,0>(vt-=ge[Ce]))return 0;for(;0<ge[Ce];--ge[Ce]){if(re=new D,(it&Ue)!=$e){for(qe+=nt,ze=1<<($e=Ce)-ee;15>$e&&!(0>=(ze-=ge[$e]));)++$e,ze<<=1;Pe+=nt=1<<(ze=$e-ee),X[Q+($e=it&Ue)].g=ze+ee,X[Q+$e].value=qe-Q-$e}re.g=Ce-ee,re.value=je[Ne++],L(X,qe+(it>>ee),me,nt,re),it=R(it,Ce)}}return tt!=2*ye[15]-1?0:Pe}(v,k,E,M,G,Y)}function D(){this.value=this.g=0}function B(){this.value=this.g=0}function z(){this.G=s(5,D),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(La,B)}function U(v,k,E,M){t(v!=null),t(k!=null),t(2147483648>M),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=k,v.pa=E,v.Jd=k,v.Yc=E+M,v.Zc=4<=M?E+M-4+1:E,ie(v)}function I(v,k){for(var E=0;0<k--;)E|=ce(v,128)<<k;return E}function F(v,k){var E=I(v,k);return ue(v)?-E:E}function q(v,k,E,M){var G,Y=0;for(t(v!=null),t(k!=null),t(4294967288>M),v.Sb=M,v.Ra=0,v.u=0,v.h=0,4<M&&(M=4),G=0;G<M;++G)Y+=k[E+G]<<8*G;v.Ra=Y,v.bb=M,v.oa=k,v.pa=E}function O(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<mc-8>>>0,++v.bb,v.u-=8;K(v)&&(v.h=1,v.u=0)}function $(v,k){if(t(0<=k),!v.h&&k<=pc){var E=W(v)&fc[k];return v.u+=k,O(v),E}return v.h=1,v.u=0}function Z(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function P(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(v){return v.Ra>>>(v.u&mc-1)>>>0}function K(v){return t(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>mc}function J(v,k){v.u=k,v.h=K(v)}function H(v){v.u>=Nh&&(t(v.u>=Nh),O(v))}function ie(v){t(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(t(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function ue(v){return I(v,1)}function ce(v,k){var E=v.Ca;0>v.b&&ie(v);var M=v.b,G=E*k>>>8,Y=(v.I>>>M>G)+0;for(Y?(E-=G,v.I-=G+1<<M>>>0):E=G+1,M=E,G=0;256<=M;)G+=8,M>>=8;return M=7^G+gr[M],v.b-=M,v.Ca=(E<<M)-1,Y}function pe(v,k,E){v[k+0]=E>>24&255,v[k+1]=E>>16&255,v[k+2]=E>>8&255,v[k+3]=E>>0&255}function ve(v,k){return v[k+0]<<0|v[k+1]<<8}function De(v,k){return ve(v,k)|v[k+2]<<16}function Re(v,k){return ve(v,k)|ve(v,k+2)<<16}function we(v,k){var E=1<<k;return t(v!=null),t(0<k),v.X=i(E),v.X==null?0:(v.Mb=32-k,v.Xa=k,1)}function xe(v,k){t(v!=null),t(k!=null),t(v.Xa==k.Xa),a(k.X,0,v.X,0,1<<k.Xa)}function ne(){this.X=[],this.Xa=this.Mb=0}function Qe(v,k,E,M){t(E!=null),t(M!=null);var G=E[0],Y=M[0];return G==0&&(G=(v*Y+k/2)/k),Y==0&&(Y=(k*G+v/2)/v),0>=G||0>=Y?0:(E[0]=G,M[0]=Y,1)}function Je(v,k){return v+(1<<k)-1>>>k}function Ae(v,k){return((4278255360&v)+(4278255360&k)>>>0&4278255360)+((16711935&v)+(16711935&k)>>>0&16711935)>>>0}function Ge(v,k){A[k]=function(E,M,G,Y,X,Q,ee){var re;for(re=0;re<X;++re){var me=A[v](Q[ee+re-1],G,Y+re);Q[ee+re]=Ae(E[M+re],me)}}}function _e(){this.ud=this.hd=this.jd=0}function de(v,k){return((4278124286&(v^k))>>>1)+(v&k)>>>0}function ke(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Fe(v,k){return ke(v+(v-k+.5>>1))}function Ze(v,k,E){return Math.abs(k-E)-Math.abs(v-E)}function Xe(v,k,E,M,G,Y,X){for(M=Y[X-1],E=0;E<G;++E)Y[X+E]=M=Ae(v[k+E],M)}function oe(v,k,E,M,G){var Y;for(Y=0;Y<E;++Y){var X=v[k+Y],Q=X>>8&255,ee=16711935&(ee=(ee=16711935&X)+((Q<<16)+Q));M[G+Y]=(4278255360&X)+ee>>>0}}function Be(v,k){k.jd=v>>0&255,k.hd=v>>8&255,k.ud=v>>16&255}function Ke(v,k,E,M,G,Y){var X;for(X=0;X<M;++X){var Q=k[E+X],ee=Q>>>8,re=Q,me=255&(me=(me=Q>>>16)+((v.jd<<24>>24)*(ee<<24>>24)>>>5));re=255&(re=(re=re+((v.hd<<24>>24)*(ee<<24>>24)>>>5))+((v.ud<<24>>24)*(me<<24>>24)>>>5)),G[Y+X]=(4278255360&Q)+(me<<16)+re}}function et(v,k,E,M,G){A[k]=function(Y,X,Q,ee,re,me,je,Ce,Ne){for(ee=je;ee<Ce;++ee)for(je=0;je<Ne;++je)re[me++]=G(Q[M(Y[X++])])},A[v]=function(Y,X,Q,ee,re,me,je){var Ce=8>>Y.b,Ne=Y.Ea,qe=Y.K[0],Pe=Y.w;if(8>Ce)for(Y=(1<<Y.b)-1,Pe=(1<<Ce)-1;X<Q;++X){var ge,ye=0;for(ge=0;ge<Ne;++ge)ge&Y||(ye=M(ee[re++])),me[je++]=G(qe[ye&Pe]),ye>>=Ce}else A["VP8LMapColor"+E](ee,re,qe,Pe,me,je,X,Q,Ne)}}function He(v,k,E,M,G){for(E=k+E;k<E;){var Y=v[k++];M[G++]=Y>>16&255,M[G++]=Y>>8&255,M[G++]=Y>>0&255}}function wt(v,k,E,M,G){for(E=k+E;k<E;){var Y=v[k++];M[G++]=Y>>16&255,M[G++]=Y>>8&255,M[G++]=Y>>0&255,M[G++]=Y>>24&255}}function dt(v,k,E,M,G){for(E=k+E;k<E;){var Y=(X=v[k++])>>16&240|X>>12&15,X=X>>0&240|X>>28&15;M[G++]=Y,M[G++]=X}}function _n(v,k,E,M,G){for(E=k+E;k<E;){var Y=(X=v[k++])>>16&248|X>>13&7,X=X>>5&224|X>>3&31;M[G++]=Y,M[G++]=X}}function Rt(v,k,E,M,G){for(E=k+E;k<E;){var Y=v[k++];M[G++]=Y>>0&255,M[G++]=Y>>8&255,M[G++]=Y>>16&255}}function Mt(v,k,E,M,G,Y){if(Y==0)for(E=k+E;k<E;)pe(M,((Y=v[k++])[0]>>24|Y[1]>>8&65280|Y[2]<<8&16711680|Y[3]<<24)>>>0),G+=32;else a(M,G,v,k,E)}function Ua(v,k){A[k][0]=A[v+"0"],A[k][1]=A[v+"1"],A[k][2]=A[v+"2"],A[k][3]=A[v+"3"],A[k][4]=A[v+"4"],A[k][5]=A[v+"5"],A[k][6]=A[v+"6"],A[k][7]=A[v+"7"],A[k][8]=A[v+"8"],A[k][9]=A[v+"9"],A[k][10]=A[v+"10"],A[k][11]=A[v+"11"],A[k][12]=A[v+"12"],A[k][13]=A[v+"13"],A[k][14]=A[v+"0"],A[k][15]=A[v+"0"]}function Kt(v){return v==ox||v==lx||v==im||v==ux}function Do(){this.eb=[],this.size=this.A=this.fb=0}function gn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ti(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Do,this.f.kb=new gn,this.sd=null}function qs(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Mn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ct(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function en(v,k){var E=v.T,M=k.ba.f.RGBA,G=M.eb,Y=M.fb+v.ka*M.A,X=hi[k.ba.S],Q=v.y,ee=v.O,re=v.f,me=v.N,je=v.ea,Ce=v.W,Ne=k.cc,qe=k.dc,Pe=k.Mc,ge=k.Nc,ye=v.ka,ze=v.ka+v.T,$e=v.U,Ue=$e+1>>1;for(ye==0?X(Q,ee,null,null,re,me,je,Ce,re,me,je,Ce,G,Y,null,null,$e):(X(k.ec,k.fc,Q,ee,Ne,qe,Pe,ge,re,me,je,Ce,G,Y-M.A,G,Y,$e),++E);ye+2<ze;ye+=2)Ne=re,qe=me,Pe=je,ge=Ce,me+=v.Rc,Ce+=v.Rc,Y+=2*M.A,X(Q,(ee+=2*v.fa)-v.fa,Q,ee,Ne,qe,Pe,ge,re,me,je,Ce,G,Y-M.A,G,Y,$e);return ee+=v.fa,v.j+ze<v.o?(a(k.ec,k.fc,Q,ee,$e),a(k.cc,k.dc,re,me,Ue),a(k.Mc,k.Nc,je,Ce,Ue),E--):1&ze||X(Q,ee,null,null,re,me,je,Ce,re,me,je,Ce,G,Y+M.A,null,null,$e),E}function Hl(v,k,E){var M=v.F,G=[v.J];if(M!=null){var Y=v.U,X=k.ba.S,Q=X==rm||X==im;k=k.ba.f.RGBA;var ee=[0],re=v.ka;ee[0]=v.T,v.Kb&&(re==0?--ee[0]:(--re,G[0]-=v.width),v.j+v.ka+v.T==v.o&&(ee[0]=v.o-v.j-re));var me=k.eb;re=k.fb+re*k.A,v=xn(M,G[0],v.width,Y,ee,me,re+(Q?0:3),k.A),t(E==ee),v&&Kt(X)&&ci(me,re,Q,Y,ee,k.A)}return 0}function Ra(v){var k=v.ma,E=k.ba.S,M=11>E,G=E==nm||E==am||E==rm||E==sx||E==12||Kt(E);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!yh(k.Oa,v,G?11:12))return 0;if(G&&Kt(E)&&Ye(),v.da)alert("todo:use_scaling");else{if(M){if(k.Ib=Ct,v.Kb){if(E=v.U+1>>1,k.memory=i(v.U+2*E),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+v.U,k.Mc=k.cc,k.Nc=k.dc+E,k.Ib=en,Ye()}}else alert("todo:EmitYUV");G&&(k.Jb=Hl,M&&Se())}if(M&&!o5){for(v=0;256>v;++v)XA[v]=89858*(v-128)+om>>sm,ZA[v]=-22014*(v-128)+om,QA[v]=-45773*(v-128),JA[v]=113618*(v-128)+om>>sm;for(v=Eh;v<hx;++v)k=76283*(v-16)+om>>sm,eE[v-Eh]=Mr(k,255),tE[v-Eh]=Mr(k+8>>4,15);o5=1}return 1}function as(v){var k=v.ma,E=v.U,M=v.T;return t(!(1&v.ka)),0>=E||0>=M?0:(E=k.Ib(v,k),k.Jb!=null&&k.Jb(v,k,E),k.Dc+=E,1)}function rs(v){v.ma.memory=null}function yt(v,k,E,M){return $(v,8)!=47?0:(k[0]=$(v,14)+1,E[0]=$(v,14)+1,M[0]=$(v,1),$(v,3)!=0?0:!v.h)}function Ri(v,k){if(4>v)return v+1;var E=v-2>>1;return(2+(1&v)<<E)+$(k,E)+1}function is(v,k){return 120<k?k-120:1<=(E=((E=IA[k-1])>>4)*v+(8-(15&E)))?E:1;var E}function pr(v,k,E){var M=W(E),G=v[k+=255&M].g-8;return 0<G&&(J(E,E.u+8),M=W(E),k+=v[k].value,k+=M&(1<<G)-1),J(E,E.u+v[k].g),v[k].value}function oa(v,k,E){return E.g+=v.g,E.value+=v.value<<k>>>0,t(8>=E.g),v.g}function ea(v,k,E){var M=v.xc;return t((k=M==0?0:v.vc[v.md*(E>>M)+(k>>M)])<v.Wb),v.Ya[k]}function Pr(v,k,E,M){var G=v.ab,Y=v.c*k,X=v.C;k=X+k;var Q=E,ee=M;for(M=v.Ta,E=v.Ua;0<G--;){var re=v.gc[G],me=X,je=k,Ce=Q,Ne=ee,qe=(ee=M,Q=E,re.Ea);switch(t(me<je),t(je<=re.nc),re.hc){case 2:Yp(Ce,Ne,(je-me)*qe,ee,Q);break;case 0:var Pe=me,ge=je,ye=ee,ze=Q,$e=(nt=re).Ea;Pe==0&&(rx(Ce,Ne,null,null,1,ye,ze),Xe(Ce,Ne+1,0,0,$e-1,ye,ze+1),Ne+=$e,ze+=$e,++Pe);for(var Ue=1<<nt.b,it=Ue-1,tt=Je($e,nt.b),vt=nt.K,nt=nt.w+(Pe>>nt.b)*tt;Pe<ge;){var Yt=vt,nn=nt,Gt=1;for(kh(Ce,Ne,ye,ze-$e,1,ye,ze);Gt<$e;){var Ut=(Gt&~it)+Ue;Ut>$e&&(Ut=$e),(0,Po[Yt[nn++]>>8&15])(Ce,Ne+ +Gt,ye,ze+Gt-$e,Ut-Gt,ye,ze+Gt),Gt=Ut}Ne+=$e,ze+=$e,++Pe&it||(nt+=tt)}je!=re.nc&&a(ee,Q-qe,ee,Q+(je-me-1)*qe,qe);break;case 1:for(qe=Ce,ge=Ne,$e=(Ce=re.Ea)-(ze=Ce&~(ye=(Ne=1<<re.b)-1)),Pe=Je(Ce,re.b),Ue=re.K,re=re.w+(me>>re.b)*Pe;me<je;){for(it=Ue,tt=re,vt=new _e,nt=ge+ze,Yt=ge+Ce;ge<nt;)Be(it[tt++],vt),Yl(vt,qe,ge,Ne,ee,Q),ge+=Ne,Q+=Ne;ge<Yt&&(Be(it[tt++],vt),Yl(vt,qe,ge,$e,ee,Q),ge+=$e,Q+=$e),++me&ye||(re+=Pe)}break;case 3:if(Ce==ee&&Ne==Q&&0<re.b){for(ge=ee,Ce=qe=Q+(je-me)*qe-(ze=(je-me)*Je(re.Ea,re.b)),Ne=ee,ye=Q,Pe=[],ze=($e=ze)-1;0<=ze;--ze)Pe[ze]=Ne[ye+ze];for(ze=$e-1;0<=ze;--ze)ge[Ce+ze]=Pe[ze];oi(re,me,je,ee,qe,ee,Q)}else oi(re,me,je,Ce,Ne,ee,Q)}Q=M,ee=E}ee!=E&&a(M,E,Q,ee,Y)}function Xu(v,k){var E=v.V,M=v.Ba+v.c*v.C,G=k-v.C;if(t(k<=v.l.o),t(16>=G),0<G){var Y=v.l,X=v.Ta,Q=v.Ua,ee=Y.width;if(Pr(v,G,E,M),G=Q=[Q],t((E=v.C)<(M=k)),t(Y.v<Y.va),M>Y.o&&(M=Y.o),E<Y.j){var re=Y.j-E;E=Y.j,G[0]+=re*ee}if(E>=M?E=0:(G[0]+=4*Y.v,Y.ka=E-Y.j,Y.U=Y.va-Y.v,Y.T=M-E,E=1),E){if(Q=Q[0],11>(E=v.ca).S){var me=E.f.RGBA,je=(M=E.S,G=Y.U,Y=Y.T,re=me.eb,me.A),Ce=Y;for(me=me.fb+v.Ma*me.A;0<Ce--;){var Ne=X,qe=Q,Pe=G,ge=re,ye=me;switch(M){case tm:vr(Ne,qe,Pe,ge,ye);break;case nm:sr(Ne,qe,Pe,ge,ye);break;case ox:sr(Ne,qe,Pe,ge,ye),ci(ge,ye,0,Pe,1,0);break;case Jw:Ks(Ne,qe,Pe,ge,ye);break;case am:Mt(Ne,qe,Pe,ge,ye,1);break;case lx:Mt(Ne,qe,Pe,ge,ye,1),ci(ge,ye,0,Pe,1,0);break;case rm:Mt(Ne,qe,Pe,ge,ye,0);break;case im:Mt(Ne,qe,Pe,ge,ye,0),ci(ge,ye,1,Pe,1,0);break;case sx:Mo(Ne,qe,Pe,ge,ye);break;case ux:Mo(Ne,qe,Pe,ge,ye),vn(ge,ye,Pe,1,0);break;case Qw:Vs(Ne,qe,Pe,ge,ye);break;default:t(0)}Q+=ee,me+=je}v.Ma+=Y}else alert("todo:EmitRescaledRowsYUVA");t(v.Ma<=E.height)}}v.C=k,t(v.C<=v.i)}function Hs(v){var k;if(0<v.ua)return 0;for(k=0;k<v.Wb;++k){var E=v.Ya[k].G,M=v.Ya[k].H;if(0<E[1][M[1]+0].g||0<E[2][M[2]+0].g||0<E[3][M[3]+0].g)return 0}return 1}function Li(v,k,E,M,G,Y){if(v.Z!=0){var X=v.qd,Q=v.rd;for(t(Bo[v.Z]!=null);k<E;++k)Bo[v.Z](X,Q,M,G,M,G,Y),X=M,Q=G,G+=Y;v.qd=X,v.rd=Q}}function Pi(v,k){var E=v.l.ma,M=E.Z==0||E.Z==1?v.l.j:v.C;if(M=v.C<M?M:v.C,t(k<=v.l.o),k>M){var G=v.l.width,Y=E.ca,X=E.tb+G*M,Q=v.V,ee=v.Ba+v.c*M,re=v.gc;t(v.ab==1),t(re[0].hc==3),Xp(re[0],M,k,Q,ee,Y,X),Li(E,M,k,Y,X,G)}v.C=v.Ma=k}function Mi(v,k,E,M,G,Y,X){var Q=v.$/M,ee=v.$%M,re=v.m,me=v.s,je=E+v.$,Ce=je;G=E+M*G;var Ne=E+M*Y,qe=280+me.ua,Pe=v.Pb?Q:16777216,ge=0<me.ua?me.Wa:null,ye=me.wc,ze=je<Ne?ea(me,ee,Q):null;t(v.C<Y),t(Ne<=G);var $e=!1;e:for(;;){for(;$e||je<Ne;){var Ue=0;if(Q>=Pe){var it=je-E;t((Pe=v).Pb),Pe.wd=Pe.m,Pe.xd=it,0<Pe.s.ua&&xe(Pe.s.Wa,Pe.s.vb),Pe=Q+FA}if(ee&ye||(ze=ea(me,ee,Q)),t(ze!=null),ze.Qb&&(k[je]=ze.qb,$e=!0),!$e)if(H(re),ze.jc){Ue=re,it=k;var tt=je,vt=ze.pd[W(Ue)&La-1];t(ze.jc),256>vt.g?(J(Ue,Ue.u+vt.g),it[tt]=vt.value,Ue=0):(J(Ue,Ue.u+vt.g-256),t(256<=vt.value),Ue=vt.value),Ue==0&&($e=!0)}else Ue=pr(ze.G[0],ze.H[0],re);if(re.h)break;if($e||256>Ue){if(!$e)if(ze.nd)k[je]=(ze.qb|Ue<<8)>>>0;else{if(H(re),$e=pr(ze.G[1],ze.H[1],re),H(re),it=pr(ze.G[2],ze.H[2],re),tt=pr(ze.G[3],ze.H[3],re),re.h)break;k[je]=(tt<<24|$e<<16|Ue<<8|it)>>>0}if($e=!1,++je,++ee>=M&&(ee=0,++Q,X!=null&&Q<=Y&&!(Q%16)&&X(v,Q),ge!=null))for(;Ce<je;)Ue=k[Ce++],ge.X[(506832829*Ue&4294967295)>>>ge.Mb]=Ue}else if(280>Ue){if(Ue=Ri(Ue-256,re),it=pr(ze.G[4],ze.H[4],re),H(re),it=is(M,it=Ri(it,re)),re.h)break;if(je-E<it||G-je<Ue)break e;for(tt=0;tt<Ue;++tt)k[je+tt]=k[je+tt-it];for(je+=Ue,ee+=Ue;ee>=M;)ee-=M,++Q,X!=null&&Q<=Y&&!(Q%16)&&X(v,Q);if(t(je<=G),ee&ye&&(ze=ea(me,ee,Q)),ge!=null)for(;Ce<je;)Ue=k[Ce++],ge.X[(506832829*Ue&4294967295)>>>ge.Mb]=Ue}else{if(!(Ue<qe))break e;for($e=Ue-280,t(ge!=null);Ce<je;)Ue=k[Ce++],ge.X[(506832829*Ue&4294967295)>>>ge.Mb]=Ue;Ue=je,t(!($e>>>(it=ge).Xa)),k[Ue]=it.X[$e],$e=!0}$e||t(re.h==K(re))}if(v.Pb&&re.h&&je<G)t(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&xe(v.s.vb,v.s.Wa);else{if(re.h)break e;X!=null&&X(v,Q>Y?Y:Q),v.a=0,v.$=je-E}return 1}return v.a=3,0}function ss(v){t(v!=null),v.vc=null,v.yc=null,v.Ya=null;var k=v.Wa;k!=null&&(k.X=null),v.vb=null,t(v!=null)}function si(){var v=new ax;return v==null?null:(v.a=0,v.xb=t5,Ua("Predictor","VP8LPredictors"),Ua("Predictor","VP8LPredictors_C"),Ua("PredictorAdd","VP8LPredictorsAdd"),Ua("PredictorAdd","VP8LPredictorsAdd_C"),Yp=oe,Yl=Ke,vr=He,sr=wt,Mo=dt,Vs=_n,Ks=Rt,A.VP8LMapColor32b=gc,A.VP8LMapColor8b=Jp,v)}function os(v,k,E,M,G){var Y=1,X=[v],Q=[k],ee=M.m,re=M.s,me=null,je=0;e:for(;;){if(E)for(;Y&&$(ee,1);){var Ce=X,Ne=Q,qe=M,Pe=1,ge=qe.m,ye=qe.gc[qe.ab],ze=$(ge,2);if(qe.Oc&1<<ze)Y=0;else{switch(qe.Oc|=1<<ze,ye.hc=ze,ye.Ea=Ce[0],ye.nc=Ne[0],ye.K=[null],++qe.ab,t(4>=qe.ab),ze){case 0:case 1:ye.b=$(ge,3)+2,Pe=os(Je(ye.Ea,ye.b),Je(ye.nc,ye.b),0,qe,ye.K),ye.K=ye.K[0];break;case 3:var $e,Ue=$(ge,8)+1,it=16<Ue?0:4<Ue?1:2<Ue?2:3;if(Ce[0]=Je(ye.Ea,it),ye.b=it,$e=Pe=os(Ue,1,0,qe,ye.K)){var tt,vt=Ue,nt=ye,Yt=1<<(8>>nt.b),nn=i(Yt);if(nn==null)$e=0;else{var Gt=nt.K[0],Ut=nt.w;for(nn[0]=nt.K[0][0],tt=1;tt<1*vt;++tt)nn[tt]=Ae(Gt[Ut+tt],nn[tt-1]);for(;tt<4*Yt;++tt)nn[tt]=0;nt.K[0]=null,nt.K[0]=nn,$e=1}}Pe=$e;break;case 2:break;default:t(0)}Y=Pe}}if(X=X[0],Q=Q[0],Y&&$(ee,1)&&!(Y=1<=(je=$(ee,4))&&11>=je)){M.a=3;break e}var fn;if(fn=Y)t:{var cn,Lt,na,xr=M,aa=X,br=Q,an=je,Or=E,Fr=xr.m,wa=xr.s,Pa=[null],lr=1,fi=0,ds=OA[an];n:for(;;){if(Or&&$(Fr,1)){var Na=$(Fr,3)+2,Js=Je(aa,Na),eu=Je(br,Na),wc=Js*eu;if(!os(Js,eu,0,xr,Pa))break n;for(Pa=Pa[0],wa.xc=Na,cn=0;cn<wc;++cn){var zo=Pa[cn]>>8&65535;Pa[cn]=zo,zo>=lr&&(lr=zo+1)}}if(Fr.h)break n;for(Lt=0;5>Lt;++Lt){var On=Zw[Lt];!Lt&&0<an&&(On+=1<<an),fi<On&&(fi=On)}var fx=s(lr*ds,D),c5=lr,d5=s(c5,z);if(d5==null)var um=null;else t(65536>=c5),um=d5;var Dh=i(fi);if(um==null||Dh==null||fx==null){xr.a=1;break n}var cm=fx;for(cn=na=0;cn<lr;++cn){var zi=um[cn],Nc=zi.G,kc=zi.H,h5=0,dm=1,f5=0;for(Lt=0;5>Lt;++Lt){On=Zw[Lt],Nc[Lt]=cm,kc[Lt]=na,!Lt&&0<an&&(On+=1<<an);r:{var hm,px=On,fm=xr,Th=Dh,rE=cm,iE=na,mx=0,Uo=fm.m,sE=$(Uo,1);if(r(Th,0,0,px),sE){var oE=$(Uo,1)+1,lE=$(Uo,1),p5=$(Uo,lE==0?1:8);Th[p5]=1,oE==2&&(Th[p5=$(Uo,8)]=1);var pm=1}else{var m5=i(19),g5=$(Uo,4)+4;if(19<g5){fm.a=3;var mm=0;break r}for(hm=0;hm<g5;++hm)m5[MA[hm]]=$(Uo,3);var gx=void 0,Rh=void 0,v5=fm,uE=m5,gm=px,x5=Th,vx=0,qo=v5.m,b5=8,y5=s(128,D);a:for(;j(y5,0,7,uE,19);){if($(qo,1)){var cE=2+2*$(qo,3);if((gx=2+$(qo,cE))>gm)break a}else gx=gm;for(Rh=0;Rh<gm&&gx--;){H(qo);var w5=y5[0+(127&W(qo))];J(qo,qo.u+w5.g);var Sc=w5.value;if(16>Sc)x5[Rh++]=Sc,Sc!=0&&(b5=Sc);else{var dE=Sc==16,N5=Sc-16,hE=LA[N5],k5=$(qo,RA[N5])+hE;if(Rh+k5>gm)break a;for(var fE=dE?b5:0;0<k5--;)x5[Rh++]=fE}}vx=1;break a}vx||(v5.a=3),pm=vx}(pm=pm&&!Uo.h)&&(mx=j(rE,iE,8,Th,px)),pm&&mx!=0?mm=mx:(fm.a=3,mm=0)}if(mm==0)break n;if(dm&&PA[Lt]==1&&(dm=cm[na].g==0),h5+=cm[na].g,na+=mm,3>=Lt){var Lh,xx=Dh[0];for(Lh=1;Lh<On;++Lh)Dh[Lh]>xx&&(xx=Dh[Lh]);f5+=xx}}if(zi.nd=dm,zi.Qb=0,dm&&(zi.qb=(Nc[3][kc[3]+0].value<<24|Nc[1][kc[1]+0].value<<16|Nc[2][kc[2]+0].value)>>>0,h5==0&&256>Nc[0][kc[0]+0].value&&(zi.Qb=1,zi.qb+=Nc[0][kc[0]+0].value<<8)),zi.jc=!zi.Qb&&6>f5,zi.jc){var vm,Qs=zi;for(vm=0;vm<La;++vm){var Ho=vm,Wo=Qs.pd[Ho],xm=Qs.G[0][Qs.H[0]+Ho];256<=xm.value?(Wo.g=xm.g+256,Wo.value=xm.value):(Wo.g=0,Wo.value=0,Ho>>=oa(xm,8,Wo),Ho>>=oa(Qs.G[1][Qs.H[1]+Ho],16,Wo),Ho>>=oa(Qs.G[2][Qs.H[2]+Ho],0,Wo),oa(Qs.G[3][Qs.H[3]+Ho],24,Wo))}}}wa.vc=Pa,wa.Wb=lr,wa.Ya=um,wa.yc=fx,fn=1;break t}fn=0}if(!(Y=fn)){M.a=3;break e}if(0<je){if(re.ua=1<<je,!we(re.Wa,je)){M.a=1,Y=0;break e}}else re.ua=0;var bx=M,S5=X,pE=Q,yx=bx.s,wx=yx.xc;if(bx.c=S5,bx.i=pE,yx.md=Je(S5,wx),yx.wc=wx==0?-1:(1<<wx)-1,E){M.xb=GA;break e}if((me=i(X*Q))==null){M.a=1,Y=0;break e}Y=(Y=Mi(M,me,0,X,Q,Q,null))&&!ee.h;break e}return Y?(G!=null?G[0]=me:(t(me==null),t(E)),M.$=0,E||ss(re)):ss(re),Y}function Wl(v,k){var E=v.c*v.i,M=E+k+16*k;return t(v.c<=k),v.V=i(M),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+E+k,1)}function Ju(v,k){var E=v.C,M=k-E,G=v.V,Y=v.Ba+v.c*E;for(t(k<=v.l.o);0<M;){var X=16<M?16:M,Q=v.l.ma,ee=v.l.width,re=ee*X,me=Q.ca,je=Q.tb+ee*E,Ce=v.Ta,Ne=v.Ua;Pr(v,X,G,Y),Gn(Ce,Ne,me,je,re),Li(Q,E,E+X,me,je,ee),M-=X,G+=X*v.c,E+=X}t(E==k),v.C=v.Ma=k}function Qu(){this.ub=this.yd=this.td=this.Rb=0}function Zu(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ec(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Ep(){this.Yb=function(){var v=[];return function k(E,M,G){for(var Y=G[M],X=0;X<Y&&(E.push(G.length>M+1?[]:0),!(G.length<M+1));X++)k(E[X],M+1,G)}(v,0,[3,11]),v}()}function Pv(){this.jb=i(3),this.Wc=o([4,8],Ep),this.Xc=o([4,17],Ep)}function Mv(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function tc(){this.ld=this.La=this.dd=this.tc=0}function Dp(){this.Na=this.la=0}function Iv(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function rh(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ov(){this.uc=this.M=this.Nb=0,this.wa=Array(new tc),this.Y=0,this.ya=Array(new rh),this.aa=0,this.l=new nc}function Tp(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Fv(){this.cb=this.a=0,this.sc="",this.m=new Z,this.Od=new Qu,this.Kc=new Zu,this.ed=new Mv,this.Qa=new ec,this.Ic=this.$c=this.Aa=0,this.D=new Ov,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,Z),this.ia=0,this.pb=s(4,Iv),this.Pa=new Pv,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Tp),this.Hd=0,this.rb=Array(new Dp),this.sb=0,this.wa=Array(new tc),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new rh),this.L=this.aa=0,this.gd=o([4,2],tc),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function nc(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bv(){var v=new Fv;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Ah||(Ah=Pp)),v}function Hn(v,k,E){return v.a==0&&(v.a=k,v.sc=E,v.cb=0),0}function Rp(v,k,E){return 3<=E&&v[k+0]==157&&v[k+1]==1&&v[k+2]==42}function Lp(v,k){if(v==null)return 0;if(v.a=0,v.sc="OK",k==null)return Hn(v,2,"null VP8Io passed to VP8GetHeaders()");var E=k.data,M=k.w,G=k.ha;if(4>G)return Hn(v,7,"Truncated header.");var Y=E[M+0]|E[M+1]<<8|E[M+2]<<16,X=v.Od;if(X.Rb=!(1&Y),X.td=Y>>1&7,X.yd=Y>>4&1,X.ub=Y>>5,3<X.td)return Hn(v,3,"Incorrect keyframe parameters.");if(!X.yd)return Hn(v,4,"Frame not displayable.");M+=3,G-=3;var Q=v.Kc;if(X.Rb){if(7>G)return Hn(v,7,"cannot parse picture header");if(!Rp(E,M,G))return Hn(v,3,"Bad code word");Q.c=16383&(E[M+4]<<8|E[M+3]),Q.Td=E[M+4]>>6,Q.i=16383&(E[M+6]<<8|E[M+5]),Q.Ud=E[M+6]>>6,M+=7,G-=7,v.za=Q.c+15>>4,v.Ub=Q.i+15>>4,k.width=Q.c,k.height=Q.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,r((Y=v.Pa).jb,0,255,Y.jb.length),t((Y=v.Qa)!=null),Y.Cb=0,Y.Bb=0,Y.Fb=1,r(Y.Zb,0,0,Y.Zb.length),r(Y.Lb,0,0,Y.Lb)}if(X.ub>G)return Hn(v,7,"bad partition length");U(Y=v.m,E,M,X.ub),M+=X.ub,G-=X.ub,X.Rb&&(Q.Ld=ue(Y),Q.Kd=ue(Y)),Q=v.Qa;var ee,re=v.Pa;if(t(Y!=null),t(Q!=null),Q.Cb=ue(Y),Q.Cb){if(Q.Bb=ue(Y),ue(Y)){for(Q.Fb=ue(Y),ee=0;4>ee;++ee)Q.Zb[ee]=ue(Y)?F(Y,7):0;for(ee=0;4>ee;++ee)Q.Lb[ee]=ue(Y)?F(Y,6):0}if(Q.Bb)for(ee=0;3>ee;++ee)re.jb[ee]=ue(Y)?I(Y,8):255}else Q.Bb=0;if(Y.Ka)return Hn(v,3,"cannot parse segment header");if((Q=v.ed).zd=ue(Y),Q.Tb=I(Y,6),Q.wb=I(Y,3),Q.Pc=ue(Y),Q.Pc&&ue(Y)){for(re=0;4>re;++re)ue(Y)&&(Q.vd[re]=F(Y,6));for(re=0;4>re;++re)ue(Y)&&(Q.od[re]=F(Y,6))}if(v.L=Q.Tb==0?0:Q.zd?1:2,Y.Ka)return Hn(v,3,"cannot parse filter header");var me=G;if(G=ee=M,M=ee+me,Q=me,v.Xb=(1<<I(v.m,2))-1,me<3*(re=v.Xb))E=7;else{for(ee+=3*re,Q-=3*re,me=0;me<re;++me){var je=E[G+0]|E[G+1]<<8|E[G+2]<<16;je>Q&&(je=Q),U(v.Jc[+me],E,ee,je),ee+=je,Q-=je,G+=3}U(v.Jc[+re],E,ee,Q),E=ee<M?0:5}if(E!=0)return Hn(v,E,"cannot parse partitions");for(E=I(ee=v.m,7),G=ue(ee)?F(ee,4):0,M=ue(ee)?F(ee,4):0,Q=ue(ee)?F(ee,4):0,re=ue(ee)?F(ee,4):0,ee=ue(ee)?F(ee,4):0,me=v.Qa,je=0;4>je;++je){if(me.Cb){var Ce=me.Zb[je];me.Fb||(Ce+=E)}else{if(0<je){v.pb[je]=v.pb[0];continue}Ce=E}var Ne=v.pb[je];Ne.Sc[0]=cx[Mr(Ce+G,127)],Ne.Sc[1]=dx[Mr(Ce+0,127)],Ne.Eb[0]=2*cx[Mr(Ce+M,127)],Ne.Eb[1]=101581*dx[Mr(Ce+Q,127)]>>16,8>Ne.Eb[1]&&(Ne.Eb[1]=8),Ne.Qc[0]=cx[Mr(Ce+re,117)],Ne.Qc[1]=dx[Mr(Ce+ee,127)],Ne.lc=Ce+ee}if(!X.Rb)return Hn(v,4,"Not a key frame.");for(ue(Y),X=v.Pa,E=0;4>E;++E){for(G=0;8>G;++G)for(M=0;3>M;++M)for(Q=0;11>Q;++Q)re=ce(Y,HA[E][G][M][Q])?I(Y,8):UA[E][G][M][Q],X.Wc[E][G].Yb[M][Q]=re;for(G=0;17>G;++G)X.Xc[E][G]=X.Wc[E][WA[G]]}return v.kc=ue(Y),v.kc&&(v.Bd=I(Y,8)),v.cb=1}function Pp(v,k,E,M,G,Y,X){var Q=k[G].Yb[E];for(E=0;16>G;++G){if(!ce(v,Q[E+0]))return G;for(;!ce(v,Q[E+1]);)if(Q=k[++G].Yb[0],E=0,G==16)return 16;var ee=k[G+1].Yb;if(ce(v,Q[E+2])){var re=v,me=0;if(ce(re,(Ce=Q)[(je=E)+3]))if(ce(re,Ce[je+6])){for(Q=0,je=2*(me=ce(re,Ce[je+8]))+(Ce=ce(re,Ce[je+9+me])),me=0,Ce=BA[je];Ce[Q];++Q)me+=me+ce(re,Ce[Q]);me+=3+(8<<je)}else ce(re,Ce[je+7])?(me=7+2*ce(re,165),me+=ce(re,145)):me=5+ce(re,159);else me=ce(re,Ce[je+4])?3+ce(re,Ce[je+5]):2;Q=ee[2]}else me=1,Q=ee[1];ee=X+zA[G],0>(re=v).b&&ie(re);var je,Ce=re.b,Ne=(je=re.Ca>>1)-(re.I>>Ce)>>31;--re.b,re.Ca+=Ne,re.Ca|=1,re.I-=(je+1&Ne)<<Ce,Y[ee]=((me^Ne)-Ne)*M[(0<G)+0]}return 16}function ih(v){var k=v.rb[v.sb-1];k.la=0,k.Na=0,r(v.zc,0,0,v.zc.length),v.ja=0}function zv(v,k){if(v==null)return 0;if(k==null)return Hn(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!Lp(v,k))return 0;if(t(v.cb),k.ac==null||k.ac(k)){k.ob&&(v.L=0);var E=lm[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=k.v-E>>4,v.zb=k.j-E>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=k.o+15+E>>4,v.Hb=k.va+15+E>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var M=v.ed;for(E=0;4>E;++E){var G;if(v.Qa.Cb){var Y=v.Qa.Lb[E];v.Qa.Fb||(Y+=M.Tb)}else Y=M.Tb;for(G=0;1>=G;++G){var X=v.gd[E][G],Q=Y;if(M.Pc&&(Q+=M.vd[0],G&&(Q+=M.od[0])),0<(Q=0>Q?0:63<Q?63:Q)){var ee=Q;0<M.wb&&(ee=4<M.wb?ee>>2:ee>>1)>9-M.wb&&(ee=9-M.wb),1>ee&&(ee=1),X.dd=ee,X.tc=2*Q+ee,X.ld=40<=Q?2:15<=Q?1:0}else X.tc=0;X.La=G}}}E=0}else Hn(v,6,"Frame setup failed"),E=v.a;if(E=E==0){if(E){v.$c=0,0<v.Aa||(v.Ic=aE);e:{E=v.Ic,M=4*(ee=v.za);var re=32*ee,me=ee+1,je=0<v.L?ee*(0<v.Aa?2:1):0,Ce=(v.Aa==2?2:1)*ee;if((X=M+832+(G=3*(16*E+lm[v.L])/2*re)+(Y=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=X)E=0;else{if(X>v.Vb){if(v.Vb=0,v.Ec=i(X),v.Fc=0,v.Ec==null){E=Hn(v,1,"no memory during frame initialization.");break e}v.Vb=X}X=v.Ec,Q=v.Fc,v.Ac=X,v.Bc=Q,Q+=M,v.Gd=s(re,Tp),v.Hd=0,v.rb=s(me+1,Dp),v.sb=1,v.wa=je?s(je,tc):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=ee),t(!0),v.oc=X,v.pc=Q,Q+=832,v.ya=s(Ce,rh),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=ee),v.R=16*ee,v.B=8*ee,ee=(re=lm[v.L])*v.R,re=re/2*v.B,v.sa=X,v.ta=Q+ee,v.qa=v.sa,v.ra=v.ta+16*E*v.R+re,v.Ha=v.qa,v.Ia=v.ra+8*E*v.B+re,v.$c=0,Q+=G,v.mb=Y?X:null,v.nb=Y?Q:null,t(Q+Y<=v.Fc+v.Vb),ih(v),r(v.Ac,v.Bc,0,M),E=1}}if(E){if(k.ka=0,k.y=v.sa,k.O=v.ta,k.f=v.qa,k.N=v.ra,k.ea=v.Ha,k.Vd=v.Ia,k.fa=v.R,k.Rc=v.B,k.F=null,k.J=0,!Zp){for(E=-255;255>=E;++E)la[255+E]=0>E?-E:E;for(E=-1020;1020>=E;++E)Ys[1020+E]=-128>E?-128:127<E?127:E;for(E=-112;112>=E;++E)Ch[112+E]=-16>E?-16:15<E?15:E;for(E=-255;510>=E;++E)yc[255+E]=0>E?0:255<E?255:E;Zp=1}vc=Hv,$s=Uv,Sh=Ip,or=qv,li=Op,Wn=Mp,xc=dh,Qp=Kl,_h=nx,Xl=hh,Jl=tx,Io=lc,Ql=fh,bc=Vp,Zl=Gp,Oo=us,jh=Gs,ui=ex,Bi[0]=ls,Bi[1]=Wv,Bi[2]=$v,Bi[3]=Yv,Bi[4]=zp,Bi[5]=sc,Bi[6]=Up,Bi[7]=lh,Bi[8]=Jv,Bi[9]=Xv,Fo[0]=Fp,Fo[1]=Vv,Fo[2]=Ws,Fo[3]=rc,Fo[4]=qa,Fo[5]=Kv,Fo[6]=Bp,Xs[0]=To,Xs[1]=Gv,Xs[2]=Qv,Xs[3]=uh,Xs[4]=Vl,Xs[5]=Zv,Xs[6]=ch,E=1}else E=0}E&&(E=function(Ne,qe){for(Ne.M=0;Ne.M<Ne.Va;++Ne.M){var Pe,ge=Ne.Jc[Ne.M&Ne.Xb],ye=Ne.m,ze=Ne;for(Pe=0;Pe<ze.za;++Pe){var $e=ye,Ue=ze,it=Ue.Ac,tt=Ue.Bc+4*Pe,vt=Ue.zc,nt=Ue.ya[Ue.aa+Pe];if(Ue.Qa.Bb?nt.$b=ce($e,Ue.Pa.jb[0])?2+ce($e,Ue.Pa.jb[2]):ce($e,Ue.Pa.jb[1]):nt.$b=0,Ue.kc&&(nt.Ad=ce($e,Ue.Bd)),nt.Za=!ce($e,145)+0,nt.Za){var Yt=nt.Ob,nn=0;for(Ue=0;4>Ue;++Ue){var Gt,Ut=vt[0+Ue];for(Gt=0;4>Gt;++Gt){Ut=qA[it[tt+Gt]][Ut];for(var fn=e5[ce($e,Ut[0])];0<fn;)fn=e5[2*fn+ce($e,Ut[fn])];Ut=-fn,it[tt+Gt]=Ut}a(Yt,nn,it,tt,4),nn+=4,vt[0+Ue]=Ut}}else Ut=ce($e,156)?ce($e,128)?1:3:ce($e,163)?2:0,nt.Ob[0]=Ut,r(it,tt,Ut,4),r(vt,0,Ut,4);nt.Dd=ce($e,142)?ce($e,114)?ce($e,183)?1:3:2:0}if(ze.m.Ka)return Hn(Ne,7,"Premature end-of-partition0 encountered.");for(;Ne.ja<Ne.za;++Ne.ja){if(ze=ge,$e=(ye=Ne).rb[ye.sb-1],it=ye.rb[ye.sb+ye.ja],Pe=ye.ya[ye.aa+ye.ja],tt=ye.kc?Pe.Ad:0)$e.la=it.la=0,Pe.Za||($e.Na=it.Na=0),Pe.Hc=0,Pe.Gc=0,Pe.ia=0;else{var cn,Lt;if($e=it,it=ze,tt=ye.Pa.Xc,vt=ye.ya[ye.aa+ye.ja],nt=ye.pb[vt.$b],Ue=vt.ad,Yt=0,nn=ye.rb[ye.sb-1],Ut=Gt=0,r(Ue,Yt,0,384),vt.Za)var na=0,xr=tt[3];else{fn=i(16);var aa=$e.Na+nn.Na;if(aa=Ah(it,tt[1],aa,nt.Eb,0,fn,0),$e.Na=nn.Na=(0<aa)+0,1<aa)vc(fn,0,Ue,Yt);else{var br=fn[0]+3>>3;for(fn=0;256>fn;fn+=16)Ue[Yt+fn]=br}na=1,xr=tt[0]}var an=15&$e.la,Or=15&nn.la;for(fn=0;4>fn;++fn){var Fr=1&Or;for(br=Lt=0;4>br;++br)an=an>>1|(Fr=(aa=Ah(it,xr,aa=Fr+(1&an),nt.Sc,na,Ue,Yt))>na)<<7,Lt=Lt<<2|(3<aa?3:1<aa?2:Ue[Yt+0]!=0),Yt+=16;an>>=4,Or=Or>>1|Fr<<7,Gt=(Gt<<8|Lt)>>>0}for(xr=an,na=Or>>4,cn=0;4>cn;cn+=2){for(Lt=0,an=$e.la>>4+cn,Or=nn.la>>4+cn,fn=0;2>fn;++fn){for(Fr=1&Or,br=0;2>br;++br)aa=Fr+(1&an),an=an>>1|(Fr=0<(aa=Ah(it,tt[2],aa,nt.Qc,0,Ue,Yt)))<<3,Lt=Lt<<2|(3<aa?3:1<aa?2:Ue[Yt+0]!=0),Yt+=16;an>>=2,Or=Or>>1|Fr<<5}Ut|=Lt<<4*cn,xr|=an<<4<<cn,na|=(240&Or)<<cn}$e.la=xr,nn.la=na,vt.Hc=Gt,vt.Gc=Ut,vt.ia=43690&Ut?0:nt.ia,tt=!(Gt|Ut)}if(0<ye.L&&(ye.wa[ye.Y+ye.ja]=ye.gd[Pe.$b][Pe.Za],ye.wa[ye.Y+ye.ja].La|=!tt),ze.Ka)return Hn(Ne,7,"Premature end-of-file encountered.")}if(ih(Ne),ye=qe,ze=1,Pe=(ge=Ne).D,$e=0<ge.L&&ge.M>=ge.zb&&ge.M<=ge.Va,ge.Aa==0)e:{if(Pe.M=ge.M,Pe.uc=$e,bh(ge,Pe),ze=1,Pe=(Lt=ge.D).Nb,$e=(Ut=lm[ge.L])*ge.R,it=Ut/2*ge.B,fn=16*Pe*ge.R,br=8*Pe*ge.B,tt=ge.sa,vt=ge.ta-$e+fn,nt=ge.qa,Ue=ge.ra-it+br,Yt=ge.Ha,nn=ge.Ia-it+br,Or=(an=Lt.M)==0,Gt=an>=ge.Va-1,ge.Aa==2&&bh(ge,Lt),Lt.uc)for(Fr=(aa=ge).D.M,t(aa.D.uc),Lt=aa.yb;Lt<aa.Hb;++Lt){na=Lt,xr=Fr;var wa=(Pa=(On=aa).D).Nb;cn=On.R;var Pa=Pa.wa[Pa.Y+na],lr=On.sa,fi=On.ta+16*wa*cn+16*na,ds=Pa.dd,Na=Pa.tc;if(Na!=0)if(t(3<=Na),On.L==1)0<na&&Oo(lr,fi,cn,Na+4),Pa.La&&ui(lr,fi,cn,Na),0<xr&&Zl(lr,fi,cn,Na+4),Pa.La&&jh(lr,fi,cn,Na);else{var Js=On.B,eu=On.qa,wc=On.ra+8*wa*Js+8*na,zo=On.Ha,On=On.Ia+8*wa*Js+8*na;wa=Pa.ld,0<na&&(Qp(lr,fi,cn,Na+4,ds,wa),Xl(eu,wc,zo,On,Js,Na+4,ds,wa)),Pa.La&&(Io(lr,fi,cn,Na,ds,wa),bc(eu,wc,zo,On,Js,Na,ds,wa)),0<xr&&(xc(lr,fi,cn,Na+4,ds,wa),_h(eu,wc,zo,On,Js,Na+4,ds,wa)),Pa.La&&(Jl(lr,fi,cn,Na,ds,wa),Ql(eu,wc,zo,On,Js,Na,ds,wa))}}if(ge.ia&&alert("todo:DitherRow"),ye.put!=null){if(Lt=16*an,an=16*(an+1),Or?(ye.y=ge.sa,ye.O=ge.ta+fn,ye.f=ge.qa,ye.N=ge.ra+br,ye.ea=ge.Ha,ye.W=ge.Ia+br):(Lt-=Ut,ye.y=tt,ye.O=vt,ye.f=nt,ye.N=Ue,ye.ea=Yt,ye.W=nn),Gt||(an-=Ut),an>ye.o&&(an=ye.o),ye.F=null,ye.J=null,ge.Fa!=null&&0<ge.Fa.length&&Lt<an&&(ye.J=vh(ge,ye,Lt,an-Lt),ye.F=ge.mb,ye.F==null&&ye.F.length==0)){ze=Hn(ge,3,"Could not decode alpha data.");break e}Lt<ye.j&&(Ut=ye.j-Lt,Lt=ye.j,t(!(1&Ut)),ye.O+=ge.R*Ut,ye.N+=ge.B*(Ut>>1),ye.W+=ge.B*(Ut>>1),ye.F!=null&&(ye.J+=ye.width*Ut)),Lt<an&&(ye.O+=ye.v,ye.N+=ye.v>>1,ye.W+=ye.v>>1,ye.F!=null&&(ye.J+=ye.v),ye.ka=Lt-ye.j,ye.U=ye.va-ye.v,ye.T=an-Lt,ze=ye.put(ye))}Pe+1!=ge.Ic||Gt||(a(ge.sa,ge.ta-$e,tt,vt+16*ge.R,$e),a(ge.qa,ge.ra-it,nt,Ue+8*ge.B,it),a(ge.Ha,ge.Ia-it,Yt,nn+8*ge.B,it))}if(!ze)return Hn(Ne,6,"Output aborted.")}return 1}(v,k)),k.bc!=null&&k.bc(k),E&=1}return E?(v.cb=0,E):0}function Ii(v,k,E,M,G){G=v[k+E+32*M]+(G>>3),v[k+E+32*M]=-256&G?0>G?0:255:G}function ac(v,k,E,M,G,Y){Ii(v,k,0,E,M+G),Ii(v,k,1,E,M+Y),Ii(v,k,2,E,M-Y),Ii(v,k,3,E,M-G)}function mr(v){return(20091*v>>16)+v}function sh(v,k,E,M){var G,Y=0,X=i(16);for(G=0;4>G;++G){var Q=v[k+0]+v[k+8],ee=v[k+0]-v[k+8],re=(35468*v[k+4]>>16)-mr(v[k+12]),me=mr(v[k+4])+(35468*v[k+12]>>16);X[Y+0]=Q+me,X[Y+1]=ee+re,X[Y+2]=ee-re,X[Y+3]=Q-me,Y+=4,k++}for(G=Y=0;4>G;++G)Q=(v=X[Y+0]+4)+X[Y+8],ee=v-X[Y+8],re=(35468*X[Y+4]>>16)-mr(X[Y+12]),Ii(E,M,0,0,Q+(me=mr(X[Y+4])+(35468*X[Y+12]>>16))),Ii(E,M,1,0,ee+re),Ii(E,M,2,0,ee-re),Ii(E,M,3,0,Q-me),Y++,M+=32}function Mp(v,k,E,M){var G=v[k+0]+4,Y=35468*v[k+4]>>16,X=mr(v[k+4]),Q=35468*v[k+1]>>16;ac(E,M,0,G+X,v=mr(v[k+1]),Q),ac(E,M,1,G+Y,v,Q),ac(E,M,2,G-Y,v,Q),ac(E,M,3,G-X,v,Q)}function Uv(v,k,E,M,G){sh(v,k,E,M),G&&sh(v,k+16,E,M+4)}function Ip(v,k,E,M){$s(v,k+0,E,M,1),$s(v,k+32,E,M+128,1)}function qv(v,k,E,M){var G;for(v=v[k+0]+4,G=0;4>G;++G)for(k=0;4>k;++k)Ii(E,M,k,G,v)}function Op(v,k,E,M){v[k+0]&&or(v,k+0,E,M),v[k+16]&&or(v,k+16,E,M+4),v[k+32]&&or(v,k+32,E,M+128),v[k+48]&&or(v,k+48,E,M+128+4)}function Hv(v,k,E,M){var G,Y=i(16);for(G=0;4>G;++G){var X=v[k+0+G]+v[k+12+G],Q=v[k+4+G]+v[k+8+G],ee=v[k+4+G]-v[k+8+G],re=v[k+0+G]-v[k+12+G];Y[0+G]=X+Q,Y[8+G]=X-Q,Y[4+G]=re+ee,Y[12+G]=re-ee}for(G=0;4>G;++G)X=(v=Y[0+4*G]+3)+Y[3+4*G],Q=Y[1+4*G]+Y[2+4*G],ee=Y[1+4*G]-Y[2+4*G],re=v-Y[3+4*G],E[M+0]=X+Q>>3,E[M+16]=re+ee>>3,E[M+32]=X-Q>>3,E[M+48]=re-ee>>3,M+=64}function oh(v,k,E){var M,G=k-32,Y=Ir,X=255-v[G-1];for(M=0;M<E;++M){var Q,ee=Y,re=X+v[k-1];for(Q=0;Q<E;++Q)v[k+Q]=ee[re+v[G+Q]];k+=32}}function Wv(v,k){oh(v,k,4)}function Gv(v,k){oh(v,k,8)}function Vv(v,k){oh(v,k,16)}function Ws(v,k){var E;for(E=0;16>E;++E)a(v,k+32*E,v,k-32,16)}function rc(v,k){var E;for(E=16;0<E;--E)r(v,k,v[k-1],16),k+=32}function ic(v,k,E){var M;for(M=0;16>M;++M)r(k,E+32*M,v,16)}function Fp(v,k){var E,M=16;for(E=0;16>E;++E)M+=v[k-1+32*E]+v[k+E-32];ic(M>>5,v,k)}function qa(v,k){var E,M=8;for(E=0;16>E;++E)M+=v[k-1+32*E];ic(M>>4,v,k)}function Kv(v,k){var E,M=8;for(E=0;16>E;++E)M+=v[k+E-32];ic(M>>4,v,k)}function Bp(v,k){ic(128,v,k)}function _t(v,k,E){return v+2*k+E+2>>2}function $v(v,k){var E,M=k-32;for(M=new Uint8Array([_t(v[M-1],v[M+0],v[M+1]),_t(v[M+0],v[M+1],v[M+2]),_t(v[M+1],v[M+2],v[M+3]),_t(v[M+2],v[M+3],v[M+4])]),E=0;4>E;++E)a(v,k+32*E,M,0,M.length)}function Yv(v,k){var E=v[k-1],M=v[k-1+32],G=v[k-1+64],Y=v[k-1+96];pe(v,k+0,16843009*_t(v[k-1-32],E,M)),pe(v,k+32,16843009*_t(E,M,G)),pe(v,k+64,16843009*_t(M,G,Y)),pe(v,k+96,16843009*_t(G,Y,Y))}function ls(v,k){var E,M=4;for(E=0;4>E;++E)M+=v[k+E-32]+v[k-1+32*E];for(M>>=3,E=0;4>E;++E)r(v,k+32*E,M,4)}function zp(v,k){var E=v[k-1+0],M=v[k-1+32],G=v[k-1+64],Y=v[k-1-32],X=v[k+0-32],Q=v[k+1-32],ee=v[k+2-32],re=v[k+3-32];v[k+0+96]=_t(M,G,v[k-1+96]),v[k+1+96]=v[k+0+64]=_t(E,M,G),v[k+2+96]=v[k+1+64]=v[k+0+32]=_t(Y,E,M),v[k+3+96]=v[k+2+64]=v[k+1+32]=v[k+0+0]=_t(X,Y,E),v[k+3+64]=v[k+2+32]=v[k+1+0]=_t(Q,X,Y),v[k+3+32]=v[k+2+0]=_t(ee,Q,X),v[k+3+0]=_t(re,ee,Q)}function Up(v,k){var E=v[k+1-32],M=v[k+2-32],G=v[k+3-32],Y=v[k+4-32],X=v[k+5-32],Q=v[k+6-32],ee=v[k+7-32];v[k+0+0]=_t(v[k+0-32],E,M),v[k+1+0]=v[k+0+32]=_t(E,M,G),v[k+2+0]=v[k+1+32]=v[k+0+64]=_t(M,G,Y),v[k+3+0]=v[k+2+32]=v[k+1+64]=v[k+0+96]=_t(G,Y,X),v[k+3+32]=v[k+2+64]=v[k+1+96]=_t(Y,X,Q),v[k+3+64]=v[k+2+96]=_t(X,Q,ee),v[k+3+96]=_t(Q,ee,ee)}function sc(v,k){var E=v[k-1+0],M=v[k-1+32],G=v[k-1+64],Y=v[k-1-32],X=v[k+0-32],Q=v[k+1-32],ee=v[k+2-32],re=v[k+3-32];v[k+0+0]=v[k+1+64]=Y+X+1>>1,v[k+1+0]=v[k+2+64]=X+Q+1>>1,v[k+2+0]=v[k+3+64]=Q+ee+1>>1,v[k+3+0]=ee+re+1>>1,v[k+0+96]=_t(G,M,E),v[k+0+64]=_t(M,E,Y),v[k+0+32]=v[k+1+96]=_t(E,Y,X),v[k+1+32]=v[k+2+96]=_t(Y,X,Q),v[k+2+32]=v[k+3+96]=_t(X,Q,ee),v[k+3+32]=_t(Q,ee,re)}function lh(v,k){var E=v[k+0-32],M=v[k+1-32],G=v[k+2-32],Y=v[k+3-32],X=v[k+4-32],Q=v[k+5-32],ee=v[k+6-32],re=v[k+7-32];v[k+0+0]=E+M+1>>1,v[k+1+0]=v[k+0+64]=M+G+1>>1,v[k+2+0]=v[k+1+64]=G+Y+1>>1,v[k+3+0]=v[k+2+64]=Y+X+1>>1,v[k+0+32]=_t(E,M,G),v[k+1+32]=v[k+0+96]=_t(M,G,Y),v[k+2+32]=v[k+1+96]=_t(G,Y,X),v[k+3+32]=v[k+2+96]=_t(Y,X,Q),v[k+3+64]=_t(X,Q,ee),v[k+3+96]=_t(Q,ee,re)}function Xv(v,k){var E=v[k-1+0],M=v[k-1+32],G=v[k-1+64],Y=v[k-1+96];v[k+0+0]=E+M+1>>1,v[k+2+0]=v[k+0+32]=M+G+1>>1,v[k+2+32]=v[k+0+64]=G+Y+1>>1,v[k+1+0]=_t(E,M,G),v[k+3+0]=v[k+1+32]=_t(M,G,Y),v[k+3+32]=v[k+1+64]=_t(G,Y,Y),v[k+3+64]=v[k+2+64]=v[k+0+96]=v[k+1+96]=v[k+2+96]=v[k+3+96]=Y}function Jv(v,k){var E=v[k-1+0],M=v[k-1+32],G=v[k-1+64],Y=v[k-1+96],X=v[k-1-32],Q=v[k+0-32],ee=v[k+1-32],re=v[k+2-32];v[k+0+0]=v[k+2+32]=E+X+1>>1,v[k+0+32]=v[k+2+64]=M+E+1>>1,v[k+0+64]=v[k+2+96]=G+M+1>>1,v[k+0+96]=Y+G+1>>1,v[k+3+0]=_t(Q,ee,re),v[k+2+0]=_t(X,Q,ee),v[k+1+0]=v[k+3+32]=_t(E,X,Q),v[k+1+32]=v[k+3+64]=_t(M,E,X),v[k+1+64]=v[k+3+96]=_t(G,M,E),v[k+1+96]=_t(Y,G,M)}function Qv(v,k){var E;for(E=0;8>E;++E)a(v,k+32*E,v,k-32,8)}function uh(v,k){var E;for(E=0;8>E;++E)r(v,k,v[k-1],8),k+=32}function Gl(v,k,E){var M;for(M=0;8>M;++M)r(k,E+32*M,v,8)}function To(v,k){var E,M=8;for(E=0;8>E;++E)M+=v[k+E-32]+v[k-1+32*E];Gl(M>>4,v,k)}function Zv(v,k){var E,M=4;for(E=0;8>E;++E)M+=v[k+E-32];Gl(M>>3,v,k)}function Vl(v,k){var E,M=4;for(E=0;8>E;++E)M+=v[k-1+32*E];Gl(M>>3,v,k)}function ch(v,k){Gl(128,v,k)}function oc(v,k,E){var M=v[k-E],G=v[k+0],Y=3*(G-M)+ix[1020+v[k-2*E]-v[k+E]],X=em[112+(Y+4>>3)];v[k-E]=Ir[255+M+em[112+(Y+3>>3)]],v[k+0]=Ir[255+G-X]}function qp(v,k,E,M){var G=v[k+0],Y=v[k+E];return di[255+v[k-2*E]-v[k-E]]>M||di[255+Y-G]>M}function Hp(v,k,E,M){return 4*di[255+v[k-E]-v[k+0]]+di[255+v[k-2*E]-v[k+E]]<=M}function Wp(v,k,E,M,G){var Y=v[k-3*E],X=v[k-2*E],Q=v[k-E],ee=v[k+0],re=v[k+E],me=v[k+2*E],je=v[k+3*E];return 4*di[255+Q-ee]+di[255+X-re]>M?0:di[255+v[k-4*E]-Y]<=G&&di[255+Y-X]<=G&&di[255+X-Q]<=G&&di[255+je-me]<=G&&di[255+me-re]<=G&&di[255+re-ee]<=G}function Gp(v,k,E,M){var G=2*M+1;for(M=0;16>M;++M)Hp(v,k+M,E,G)&&oc(v,k+M,E)}function us(v,k,E,M){var G=2*M+1;for(M=0;16>M;++M)Hp(v,k+M*E,1,G)&&oc(v,k+M*E,1)}function Gs(v,k,E,M){var G;for(G=3;0<G;--G)Gp(v,k+=4*E,E,M)}function ex(v,k,E,M){var G;for(G=3;0<G;--G)us(v,k+=4,E,M)}function Ro(v,k,E,M,G,Y,X,Q){for(Y=2*Y+1;0<G--;){if(Wp(v,k,E,Y,X))if(qp(v,k,E,Q))oc(v,k,E);else{var ee=v,re=k,me=E,je=ee[re-2*me],Ce=ee[re-me],Ne=ee[re+0],qe=ee[re+me],Pe=ee[re+2*me],ge=27*(ze=ix[1020+3*(Ne-Ce)+ix[1020+je-qe]])+63>>7,ye=18*ze+63>>7,ze=9*ze+63>>7;ee[re-3*me]=Ir[255+ee[re-3*me]+ze],ee[re-2*me]=Ir[255+je+ye],ee[re-me]=Ir[255+Ce+ge],ee[re+0]=Ir[255+Ne-ge],ee[re+me]=Ir[255+qe-ye],ee[re+2*me]=Ir[255+Pe-ze]}k+=M}}function Oi(v,k,E,M,G,Y,X,Q){for(Y=2*Y+1;0<G--;){if(Wp(v,k,E,Y,X))if(qp(v,k,E,Q))oc(v,k,E);else{var ee=v,re=k,me=E,je=ee[re-me],Ce=ee[re+0],Ne=ee[re+me],qe=em[112+((Pe=3*(Ce-je))+4>>3)],Pe=em[112+(Pe+3>>3)],ge=qe+1>>1;ee[re-2*me]=Ir[255+ee[re-2*me]+ge],ee[re-me]=Ir[255+je+Pe],ee[re+0]=Ir[255+Ce-qe],ee[re+me]=Ir[255+Ne-ge]}k+=M}}function dh(v,k,E,M,G,Y){Ro(v,k,E,1,16,M,G,Y)}function Kl(v,k,E,M,G,Y){Ro(v,k,1,E,16,M,G,Y)}function tx(v,k,E,M,G,Y){var X;for(X=3;0<X;--X)Oi(v,k+=4*E,E,1,16,M,G,Y)}function lc(v,k,E,M,G,Y){var X;for(X=3;0<X;--X)Oi(v,k+=4,1,E,16,M,G,Y)}function nx(v,k,E,M,G,Y,X,Q){Ro(v,k,G,1,8,Y,X,Q),Ro(E,M,G,1,8,Y,X,Q)}function hh(v,k,E,M,G,Y,X,Q){Ro(v,k,1,G,8,Y,X,Q),Ro(E,M,1,G,8,Y,X,Q)}function fh(v,k,E,M,G,Y,X,Q){Oi(v,k+4*G,G,1,8,Y,X,Q),Oi(E,M+4*G,G,1,8,Y,X,Q)}function Vp(v,k,E,M,G,Y,X,Q){Oi(v,k+4,1,G,8,Y,X,Q),Oi(E,M+4,1,G,8,Y,X,Q)}function uc(){this.ba=new Ti,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Mn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ph(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function mh(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Kp(){this.ua=0,this.Wa=new ne,this.vb=new ne,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new D}function ax(){this.xb=this.a=0,this.l=new nc,this.ca=new Ti,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new P,this.Pb=0,this.wd=new P,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Kp,this.ab=0,this.gc=s(4,mh),this.Oc=0}function cc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new nc,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function $l(v,k,E,M,G,Y,X){for(v=v==null?0:v[k+0],k=0;k<X;++k)G[Y+k]=v+E[M+k]&255,v=G[Y+k]}function gh(v,k,E,M,G,Y,X){var Q;if(v==null)$l(null,null,E,M,G,Y,X);else for(Q=0;Q<X;++Q)G[Y+Q]=v[k+Q]+E[M+Q]&255}function Lo(v,k,E,M,G,Y,X){if(v==null)$l(null,null,E,M,G,Y,X);else{var Q,ee=v[k+0],re=ee,me=ee;for(Q=0;Q<X;++Q)re=me+(ee=v[k+Q])-re,me=E[M+Q]+(-256&re?0>re?0:255:re)&255,re=ee,G[Y+Q]=me}}function vh(v,k,E,M){var G=k.width,Y=k.o;if(t(v!=null&&k!=null),0>E||0>=M||E+M>Y)return null;if(!v.Cc){if(v.ga==null){var X;if(v.ga=new cc,(X=v.ga==null)||(X=k.width*k.o,t(v.Gb.length==0),v.Gb=i(X),v.Uc=0,v.Gb==null?X=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,X=1),X=!X),!X){X=v.ga;var Q=v.Fa,ee=v.P,re=v.qc,me=v.mb,je=v.nb,Ce=ee+1,Ne=re-1,qe=X.l;if(t(Q!=null&&me!=null&&k!=null),Bo[0]=null,Bo[1]=$l,Bo[2]=gh,Bo[3]=Lo,X.ca=me,X.tb=je,X.c=k.width,X.i=k.height,t(0<X.c&&0<X.i),1>=re)k=0;else if(X.$a=Q[ee+0]>>0&3,X.Z=Q[ee+0]>>2&3,X.Lc=Q[ee+0]>>4&3,ee=Q[ee+0]>>6&3,0>X.$a||1<X.$a||4<=X.Z||1<X.Lc||ee)k=0;else if(qe.put=as,qe.ac=Ra,qe.bc=rs,qe.ma=X,qe.width=k.width,qe.height=k.height,qe.Da=k.Da,qe.v=k.v,qe.va=k.va,qe.j=k.j,qe.o=k.o,X.$a)e:{t(X.$a==1),k=si();t:for(;;){if(k==null){k=0;break e}if(t(X!=null),X.mc=k,k.c=X.c,k.i=X.i,k.l=X.l,k.l.ma=X,k.l.width=X.c,k.l.height=X.i,k.a=0,q(k.m,Q,Ce,Ne),!os(X.c,X.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&Hs(k.s)?(X.ic=1,Q=k.c*k.i,k.Ta=null,k.Ua=0,k.V=i(Q),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(X.ic=0,k=Wl(k,X.c)),!k))break t;k=1;break e}X.mc=null,k=0}else k=Ne>=X.c*X.i;X=!k}if(X)return null;v.ga.Lc!=1?v.Ga=0:M=Y-E}t(v.ga!=null),t(E+M<=Y);e:{if(k=(Q=v.ga).c,Y=Q.l.o,Q.$a==0){if(Ce=v.rc,Ne=v.Vc,qe=v.Fa,ee=v.P+1+E*k,re=v.mb,me=v.nb+E*k,t(ee<=v.P+v.qc),Q.Z!=0)for(t(Bo[Q.Z]!=null),X=0;X<M;++X)Bo[Q.Z](Ce,Ne,qe,ee,re,me,k),Ce=re,Ne=me,me+=k,ee+=k;else for(X=0;X<M;++X)a(re,me,qe,ee,k),Ce=re,Ne=me,me+=k,ee+=k;v.rc=Ce,v.Vc=Ne}else{if(t(Q.mc!=null),k=E+M,t((X=Q.mc)!=null),t(k<=X.i),X.C>=k)k=1;else if(Q.ic||Se(),Q.ic){Q=X.V,Ce=X.Ba,Ne=X.c;var Pe=X.i,ge=(qe=1,ee=X.$/Ne,re=X.$%Ne,me=X.m,je=X.s,X.$),ye=Ne*Pe,ze=Ne*k,$e=je.wc,Ue=ge<ze?ea(je,re,ee):null;t(ge<=ye),t(k<=Pe),t(Hs(je));t:for(;;){for(;!me.h&&ge<ze;){if(re&$e||(Ue=ea(je,re,ee)),t(Ue!=null),H(me),256>(Pe=pr(Ue.G[0],Ue.H[0],me)))Q[Ce+ge]=Pe,++ge,++re>=Ne&&(re=0,++ee<=k&&!(ee%16)&&Pi(X,ee));else{if(!(280>Pe)){qe=0;break t}Pe=Ri(Pe-256,me);var it,tt=pr(Ue.G[4],Ue.H[4],me);if(H(me),!(ge>=(tt=is(Ne,tt=Ri(tt,me)))&&ye-ge>=Pe)){qe=0;break t}for(it=0;it<Pe;++it)Q[Ce+ge+it]=Q[Ce+ge+it-tt];for(ge+=Pe,re+=Pe;re>=Ne;)re-=Ne,++ee<=k&&!(ee%16)&&Pi(X,ee);ge<ze&&re&$e&&(Ue=ea(je,re,ee))}t(me.h==K(me))}Pi(X,ee>k?k:ee);break t}!qe||me.h&&ge<ye?(qe=0,X.a=me.h?5:3):X.$=ge,k=qe}else k=Mi(X,X.V,X.Ba,X.c,X.i,k,Ju);if(!k){M=0;break e}}E+M>=Y&&(v.Cc=1),M=1}if(!M)return null;if(v.Cc&&((M=v.ga)!=null&&(M.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+E*G}function _(v,k,E,M,G,Y){for(;0<G--;){var X,Q=v,ee=k+(E?1:0),re=v,me=k+(E?0:3);for(X=0;X<M;++X){var je=re[me+4*X];je!=255&&(je*=32897,Q[ee+4*X+0]=Q[ee+4*X+0]*je>>23,Q[ee+4*X+1]=Q[ee+4*X+1]*je>>23,Q[ee+4*X+2]=Q[ee+4*X+2]*je>>23)}k+=Y}}function V(v,k,E,M,G){for(;0<M--;){var Y;for(Y=0;Y<E;++Y){var X=v[k+2*Y+0],Q=15&(re=v[k+2*Y+1]),ee=4369*Q,re=(240&re|re>>4)*ee>>16;v[k+2*Y+0]=(240&X|X>>4)*ee>>16&240|(15&X|X<<4)*ee>>16>>4&15,v[k+2*Y+1]=240&re|Q}k+=G}}function le(v,k,E,M,G,Y,X,Q){var ee,re,me=255;for(re=0;re<G;++re){for(ee=0;ee<M;++ee){var je=v[k+ee];Y[X+4*ee]=je,me&=je}k+=E,X+=Q}return me!=255}function fe(v,k,E,M,G){var Y;for(Y=0;Y<G;++Y)E[M+Y]=v[k+Y]>>8}function Se(){ci=_,vn=V,xn=le,Gn=fe}function Ie(v,k,E){A[v]=function(M,G,Y,X,Q,ee,re,me,je,Ce,Ne,qe,Pe,ge,ye,ze,$e){var Ue,it=$e-1>>1,tt=Q[ee+0]|re[me+0]<<16,vt=je[Ce+0]|Ne[qe+0]<<16;t(M!=null);var nt=3*tt+vt+131074>>2;for(k(M[G+0],255&nt,nt>>16,Pe,ge),Y!=null&&(nt=3*vt+tt+131074>>2,k(Y[X+0],255&nt,nt>>16,ye,ze)),Ue=1;Ue<=it;++Ue){var Yt=Q[ee+Ue]|re[me+Ue]<<16,nn=je[Ce+Ue]|Ne[qe+Ue]<<16,Gt=tt+Yt+vt+nn+524296,Ut=Gt+2*(Yt+vt)>>3;nt=Ut+tt>>1,tt=(Gt=Gt+2*(tt+nn)>>3)+Yt>>1,k(M[G+2*Ue-1],255&nt,nt>>16,Pe,ge+(2*Ue-1)*E),k(M[G+2*Ue-0],255&tt,tt>>16,Pe,ge+(2*Ue-0)*E),Y!=null&&(nt=Gt+vt>>1,tt=Ut+nn>>1,k(Y[X+2*Ue-1],255&nt,nt>>16,ye,ze+(2*Ue-1)*E),k(Y[X+2*Ue+0],255&tt,tt>>16,ye,ze+(2*Ue+0)*E)),tt=Yt,vt=nn}1&$e||(nt=3*tt+vt+131074>>2,k(M[G+$e-1],255&nt,nt>>16,Pe,ge+($e-1)*E),Y!=null&&(nt=3*vt+tt+131074>>2,k(Y[X+$e-1],255&nt,nt>>16,ye,ze+($e-1)*E)))}}function Ye(){hi[tm]=VA,hi[nm]=n5,hi[Jw]=KA,hi[am]=a5,hi[rm]=r5,hi[sx]=i5,hi[Qw]=$A,hi[ox]=n5,hi[lx]=a5,hi[im]=r5,hi[ux]=i5}function rt(v){return v&~YA?0>v?0:255:v>>s5}function gt(v,k){return rt((19077*v>>8)+(26149*k>>8)-14234)}function Tt(v,k,E){return rt((19077*v>>8)-(6419*k>>8)-(13320*E>>8)+8708)}function At(v,k){return rt((19077*v>>8)+(33050*k>>8)-17685)}function qt(v,k,E,M,G){M[G+0]=gt(v,E),M[G+1]=Tt(v,k,E),M[G+2]=At(v,k)}function An(v,k,E,M,G){M[G+0]=At(v,k),M[G+1]=Tt(v,k,E),M[G+2]=gt(v,E)}function In(v,k,E,M,G){var Y=Tt(v,k,E);k=Y<<3&224|At(v,k)>>3,M[G+0]=248&gt(v,E)|Y>>5,M[G+1]=k}function ta(v,k,E,M,G){var Y=240&At(v,k)|15;M[G+0]=240&gt(v,E)|Tt(v,k,E)>>4,M[G+1]=Y}function Ha(v,k,E,M,G){M[G+0]=255,qt(v,k,E,M,G+1)}function ya(v,k,E,M,G){An(v,k,E,M,G),M[G+3]=255}function Fi(v,k,E,M,G){qt(v,k,E,M,G),M[G+3]=255}function Mr(v,k){return 0>v?0:v>k?k:v}function cs(v,k,E){A[v]=function(M,G,Y,X,Q,ee,re,me,je){for(var Ce=me+(-2&je)*E;me!=Ce;)k(M[G+0],Y[X+0],Q[ee+0],re,me),k(M[G+1],Y[X+0],Q[ee+0],re,me+E),G+=2,++X,++ee,me+=2*E;1&je&&k(M[G+0],Y[X+0],Q[ee+0],re,me)}}function $p(v,k,E){return E==0?v==0?k==0?6:5:k==0?4:0:E}function xh(v,k,E,M,G){switch(v>>>30){case 3:$s(k,E,M,G,0);break;case 2:Wn(k,E,M,G);break;case 1:or(k,E,M,G)}}function bh(v,k){var E,M,G=k.M,Y=k.Nb,X=v.oc,Q=v.pc+40,ee=v.oc,re=v.pc+584,me=v.oc,je=v.pc+600;for(E=0;16>E;++E)X[Q+32*E-1]=129;for(E=0;8>E;++E)ee[re+32*E-1]=129,me[je+32*E-1]=129;for(0<G?X[Q-1-32]=ee[re-1-32]=me[je-1-32]=129:(r(X,Q-32-1,127,21),r(ee,re-32-1,127,9),r(me,je-32-1,127,9)),M=0;M<v.za;++M){var Ce=k.ya[k.aa+M];if(0<M){for(E=-1;16>E;++E)a(X,Q+32*E-4,X,Q+32*E+12,4);for(E=-1;8>E;++E)a(ee,re+32*E-4,ee,re+32*E+4,4),a(me,je+32*E-4,me,je+32*E+4,4)}var Ne=v.Gd,qe=v.Hd+M,Pe=Ce.ad,ge=Ce.Hc;if(0<G&&(a(X,Q-32,Ne[qe].y,0,16),a(ee,re-32,Ne[qe].f,0,8),a(me,je-32,Ne[qe].ea,0,8)),Ce.Za){var ye=X,ze=Q-32+16;for(0<G&&(M>=v.za-1?r(ye,ze,Ne[qe].y[15],4):a(ye,ze,Ne[qe+1].y,0,4)),E=0;4>E;E++)ye[ze+128+E]=ye[ze+256+E]=ye[ze+384+E]=ye[ze+0+E];for(E=0;16>E;++E,ge<<=2)ye=X,ze=Q+l5[E],Bi[Ce.Ob[E]](ye,ze),xh(ge,Pe,16*+E,ye,ze)}else if(ye=$p(M,G,Ce.Ob[0]),Fo[ye](X,Q),ge!=0)for(E=0;16>E;++E,ge<<=2)xh(ge,Pe,16*+E,X,Q+l5[E]);for(E=Ce.Gc,ye=$p(M,G,Ce.Dd),Xs[ye](ee,re),Xs[ye](me,je),ge=Pe,ye=ee,ze=re,255&(Ce=E>>0)&&(170&Ce?Sh(ge,256,ye,ze):li(ge,256,ye,ze)),Ce=me,ge=je,255&(E>>=8)&&(170&E?Sh(Pe,320,Ce,ge):li(Pe,320,Ce,ge)),G<v.Ub-1&&(a(Ne[qe].y,0,X,Q+480,16),a(Ne[qe].f,0,ee,re+224,8),a(Ne[qe].ea,0,me,je+224,8)),E=8*Y*v.B,Ne=v.sa,qe=v.ta+16*M+16*Y*v.R,Pe=v.qa,Ce=v.ra+8*M+E,ge=v.Ha,ye=v.Ia+8*M+E,E=0;16>E;++E)a(Ne,qe+E*v.R,X,Q+32*E,16);for(E=0;8>E;++E)a(Pe,Ce+E*v.B,ee,re+32*E,8),a(ge,ye+E*v.B,me,je+32*E,8)}}function dc(v,k,E,M,G,Y,X,Q,ee){var re=[0],me=[0],je=0,Ce=ee!=null?ee.kd:0,Ne=ee??new ph;if(v==null||12>E)return 7;Ne.data=v,Ne.w=k,Ne.ha=E,k=[k],E=[E],Ne.gb=[Ne.gb];e:{var qe=k,Pe=E,ge=Ne.gb;if(t(v!=null),t(Pe!=null),t(ge!=null),ge[0]=0,12<=Pe[0]&&!n(v,qe[0],"RIFF")){if(n(v,qe[0]+8,"WEBP")){ge=3;break e}var ye=Re(v,qe[0]+4);if(12>ye||4294967286<ye){ge=3;break e}if(Ce&&ye>Pe[0]-8){ge=7;break e}ge[0]=ye,qe[0]+=12,Pe[0]-=12}ge=0}if(ge!=0)return ge;for(ye=0<Ne.gb[0],E=E[0];;){e:{var ze=v;Pe=k,ge=E;var $e=re,Ue=me,it=qe=[0];if((nt=je=[je])[0]=0,8>ge[0])ge=7;else{if(!n(ze,Pe[0],"VP8X")){if(Re(ze,Pe[0]+4)!=10){ge=3;break e}if(18>ge[0]){ge=7;break e}var tt=Re(ze,Pe[0]+8),vt=1+De(ze,Pe[0]+12);if(2147483648<=vt*(ze=1+De(ze,Pe[0]+15))){ge=3;break e}it!=null&&(it[0]=tt),$e!=null&&($e[0]=vt),Ue!=null&&(Ue[0]=ze),Pe[0]+=18,ge[0]-=18,nt[0]=1}ge=0}}if(je=je[0],qe=qe[0],ge!=0)return ge;if(Pe=!!(2&qe),!ye&&je)return 3;if(Y!=null&&(Y[0]=!!(16&qe)),X!=null&&(X[0]=Pe),Q!=null&&(Q[0]=0),X=re[0],qe=me[0],je&&Pe&&ee==null){ge=0;break}if(4>E){ge=7;break}if(ye&&je||!ye&&!je&&!n(v,k[0],"ALPH")){E=[E],Ne.na=[Ne.na],Ne.P=[Ne.P],Ne.Sa=[Ne.Sa];e:{tt=v,ge=k,ye=E;var nt=Ne.gb;$e=Ne.na,Ue=Ne.P,it=Ne.Sa,vt=22,t(tt!=null),t(ye!=null),ze=ge[0];var Yt=ye[0];for(t($e!=null),t(it!=null),$e[0]=null,Ue[0]=null,it[0]=0;;){if(ge[0]=ze,ye[0]=Yt,8>Yt){ge=7;break e}var nn=Re(tt,ze+4);if(4294967286<nn){ge=3;break e}var Gt=8+nn+1&-2;if(vt+=Gt,0<nt&&vt>nt){ge=3;break e}if(!n(tt,ze,"VP8 ")||!n(tt,ze,"VP8L")){ge=0;break e}if(Yt[0]<Gt){ge=7;break e}n(tt,ze,"ALPH")||($e[0]=tt,Ue[0]=ze+8,it[0]=nn),ze+=Gt,Yt-=Gt}}if(E=E[0],Ne.na=Ne.na[0],Ne.P=Ne.P[0],Ne.Sa=Ne.Sa[0],ge!=0)break}E=[E],Ne.Ja=[Ne.Ja],Ne.xa=[Ne.xa];e:if(nt=v,ge=k,ye=E,$e=Ne.gb[0],Ue=Ne.Ja,it=Ne.xa,tt=ge[0],ze=!n(nt,tt,"VP8 "),vt=!n(nt,tt,"VP8L"),t(nt!=null),t(ye!=null),t(Ue!=null),t(it!=null),8>ye[0])ge=7;else{if(ze||vt){if(nt=Re(nt,tt+4),12<=$e&&nt>$e-12){ge=3;break e}if(Ce&&nt>ye[0]-8){ge=7;break e}Ue[0]=nt,ge[0]+=8,ye[0]-=8,it[0]=vt}else it[0]=5<=ye[0]&&nt[tt+0]==47&&!(nt[tt+4]>>5),Ue[0]=ye[0];ge=0}if(E=E[0],Ne.Ja=Ne.Ja[0],Ne.xa=Ne.xa[0],k=k[0],ge!=0)break;if(4294967286<Ne.Ja)return 3;if(Q==null||Pe||(Q[0]=Ne.xa?2:1),X=[X],qe=[qe],Ne.xa){if(5>E){ge=7;break}Q=X,Ce=qe,Pe=Y,v==null||5>E?v=0:5<=E&&v[k+0]==47&&!(v[k+4]>>5)?(ye=[0],nt=[0],$e=[0],q(Ue=new P,v,k,E),yt(Ue,ye,nt,$e)?(Q!=null&&(Q[0]=ye[0]),Ce!=null&&(Ce[0]=nt[0]),Pe!=null&&(Pe[0]=$e[0]),v=1):v=0):v=0}else{if(10>E){ge=7;break}Q=qe,v==null||10>E||!Rp(v,k+3,E-3)?v=0:(Ce=v[k+0]|v[k+1]<<8|v[k+2]<<16,Pe=16383&(v[k+7]<<8|v[k+6]),v=16383&(v[k+9]<<8|v[k+8]),1&Ce||3<(Ce>>1&7)||!(Ce>>4&1)||Ce>>5>=Ne.Ja||!Pe||!v?v=0:(X&&(X[0]=Pe),Q&&(Q[0]=v),v=1))}if(!v||(X=X[0],qe=qe[0],je&&(re[0]!=X||me[0]!=qe)))return 3;ee!=null&&(ee[0]=Ne,ee.offset=k-ee.w,t(4294967286>k-ee.w),t(ee.offset==ee.ha-E));break}return ge==0||ge==7&&je&&ee==null?(Y!=null&&(Y[0]|=Ne.na!=null&&0<Ne.na.length),M!=null&&(M[0]=X),G!=null&&(G[0]=qe),0):ge}function yh(v,k,E){var M=k.width,G=k.height,Y=0,X=0,Q=M,ee=G;if(k.Da=v!=null&&0<v.Da,k.Da&&(Q=v.cd,ee=v.bd,Y=v.v,X=v.j,11>E||(Y&=-2,X&=-2),0>Y||0>X||0>=Q||0>=ee||Y+Q>M||X+ee>G))return 0;if(k.v=Y,k.j=X,k.va=Y+Q,k.o=X+ee,k.U=Q,k.T=ee,k.da=v!=null&&0<v.da,k.da){if(!Qe(Q,ee,E=[v.ib],Y=[v.hb]))return 0;k.ib=E[0],k.hb=Y[0]}return k.ob=v!=null&&v.ob,k.Kb=v==null||!v.Sd,k.da&&(k.ob=k.ib<3*M/4&&k.hb<3*G/4,k.Kb=0),1}function wh(v){if(v==null)return 2;if(11>v.S){var k=v.f.RGBA;k.fb+=(v.height-1)*k.A,k.A=-k.A}else k=v.f.kb,v=v.height,k.O+=(v-1)*k.fa,k.fa=-k.fa,k.N+=(v-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(v-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(v-1)*k.lb,k.lb=-k.lb);return 0}function hc(v,k,E,M){if(M==null||0>=v||0>=k)return 2;if(E!=null){if(E.Da){var G=E.cd,Y=E.bd,X=-2&E.v,Q=-2&E.j;if(0>X||0>Q||0>=G||0>=Y||X+G>v||Q+Y>k)return 2;v=G,k=Y}if(E.da){if(!Qe(v,k,G=[E.ib],Y=[E.hb]))return 2;v=G[0],k=Y[0]}}M.width=v,M.height=k;e:{var ee=M.width,re=M.height;if(v=M.S,0>=ee||0>=re||!(v>=tm&&13>v))v=2;else{if(0>=M.Rd&&M.sd==null){X=Y=G=k=0;var me=(Q=ee*u5[v])*re;if(11>v||(Y=(re+1)/2*(k=(ee+1)/2),v==12&&(X=(G=ee)*re)),(re=i(me+2*Y+X))==null){v=1;break e}M.sd=re,11>v?((ee=M.f.RGBA).eb=re,ee.fb=0,ee.A=Q,ee.size=me):((ee=M.f.kb).y=re,ee.O=0,ee.fa=Q,ee.Fd=me,ee.f=re,ee.N=0+me,ee.Ab=k,ee.Cd=Y,ee.ea=re,ee.W=0+me+Y,ee.Db=k,ee.Ed=Y,v==12&&(ee.F=re,ee.J=0+me+2*Y),ee.Tc=X,ee.lb=G)}if(k=1,G=M.S,Y=M.width,X=M.height,G>=tm&&13>G)if(11>G)v=M.f.RGBA,k&=(Q=Math.abs(v.A))*(X-1)+Y<=v.size,k&=Q>=Y*u5[G],k&=v.eb!=null;else{v=M.f.kb,Q=(Y+1)/2,me=(X+1)/2,ee=Math.abs(v.fa),re=Math.abs(v.Ab);var je=Math.abs(v.Db),Ce=Math.abs(v.lb),Ne=Ce*(X-1)+Y;k&=ee*(X-1)+Y<=v.Fd,k&=re*(me-1)+Q<=v.Cd,k=(k&=je*(me-1)+Q<=v.Ed)&ee>=Y&re>=Q&je>=Q,k&=v.y!=null,k&=v.f!=null,k&=v.ea!=null,G==12&&(k&=Ce>=Y,k&=Ne<=v.Tc,k&=v.F!=null)}else k=0;v=k?0:2}}return v!=0||E!=null&&E.fd&&(v=wh(M)),v}var La=64,fc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],pc=24,mc=32,Nh=8,gr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ge("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(v){return v},A.Predictor2=function(v,k,E){return k[E+0]},A.Predictor3=function(v,k,E){return k[E+1]},A.Predictor4=function(v,k,E){return k[E-1]},A.Predictor5=function(v,k,E){return de(de(v,k[E+1]),k[E+0])},A.Predictor6=function(v,k,E){return de(v,k[E-1])},A.Predictor7=function(v,k,E){return de(v,k[E+0])},A.Predictor8=function(v,k,E){return de(k[E-1],k[E+0])},A.Predictor9=function(v,k,E){return de(k[E+0],k[E+1])},A.Predictor10=function(v,k,E){return de(de(v,k[E-1]),de(k[E+0],k[E+1]))},A.Predictor11=function(v,k,E){var M=k[E+0];return 0>=Ze(M>>24&255,v>>24&255,(k=k[E-1])>>24&255)+Ze(M>>16&255,v>>16&255,k>>16&255)+Ze(M>>8&255,v>>8&255,k>>8&255)+Ze(255&M,255&v,255&k)?M:v},A.Predictor12=function(v,k,E){var M=k[E+0];return(ke((v>>24&255)+(M>>24&255)-((k=k[E-1])>>24&255))<<24|ke((v>>16&255)+(M>>16&255)-(k>>16&255))<<16|ke((v>>8&255)+(M>>8&255)-(k>>8&255))<<8|ke((255&v)+(255&M)-(255&k)))>>>0},A.Predictor13=function(v,k,E){var M=k[E-1];return(Fe((v=de(v,k[E+0]))>>24&255,M>>24&255)<<24|Fe(v>>16&255,M>>16&255)<<16|Fe(v>>8&255,M>>8&255)<<8|Fe(v>>0&255,M>>0&255))>>>0};var rx=A.PredictorAdd0;A.PredictorAdd1=Xe,Ge("Predictor2","PredictorAdd2"),Ge("Predictor3","PredictorAdd3"),Ge("Predictor4","PredictorAdd4"),Ge("Predictor5","PredictorAdd5"),Ge("Predictor6","PredictorAdd6"),Ge("Predictor7","PredictorAdd7"),Ge("Predictor8","PredictorAdd8"),Ge("Predictor9","PredictorAdd9"),Ge("Predictor10","PredictorAdd10"),Ge("Predictor11","PredictorAdd11"),Ge("Predictor12","PredictorAdd12"),Ge("Predictor13","PredictorAdd13");var kh=A.PredictorAdd2;et("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),et("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Yp,oi=A.ColorIndexInverseTransform,gc=A.MapARGB,Xp=A.VP8LColorIndexInverseTransformAlpha,Jp=A.MapAlpha,Po=A.VP8LPredictorsAdd=[];Po.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Yl,vr,sr,Mo,Vs,Ks,vc,$s,Wn,Sh,or,li,xc,Qp,_h,Xl,Jl,Io,Ql,bc,Zl,Oo,jh,ui,ci,vn,xn,Gn,la=i(511),Ys=i(2041),Ch=i(225),yc=i(767),Zp=0,ix=Ys,em=Ch,Ir=yc,di=la,tm=0,nm=1,Jw=2,am=3,rm=4,sx=5,Qw=6,ox=7,lx=8,im=9,ux=10,RA=[2,3,7],LA=[3,3,11],Zw=[280,256,256,256,40],PA=[0,1,1,1,0],MA=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],IA=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],OA=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],FA=8,cx=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],dx=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ah=null,BA=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],zA=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],e5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],UA=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],qA=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],HA=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],WA=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Fo=[],Bi=[],Xs=[],GA=1,t5=2,Bo=[],hi=[];Ie("UpsampleRgbLinePair",qt,3),Ie("UpsampleBgrLinePair",An,3),Ie("UpsampleRgbaLinePair",Fi,4),Ie("UpsampleBgraLinePair",ya,4),Ie("UpsampleArgbLinePair",Ha,4),Ie("UpsampleRgba4444LinePair",ta,2),Ie("UpsampleRgb565LinePair",In,2);var VA=A.UpsampleRgbLinePair,KA=A.UpsampleBgrLinePair,n5=A.UpsampleRgbaLinePair,a5=A.UpsampleBgraLinePair,r5=A.UpsampleArgbLinePair,i5=A.UpsampleRgba4444LinePair,$A=A.UpsampleRgb565LinePair,sm=16,om=1<<sm-1,Eh=-227,hx=482,s5=6,YA=(256<<s5)-1,o5=0,XA=i(256),JA=i(256),QA=i(256),ZA=i(256),eE=i(hx-Eh),tE=i(hx-Eh);cs("YuvToRgbRow",qt,3),cs("YuvToBgrRow",An,3),cs("YuvToRgbaRow",Fi,4),cs("YuvToBgraRow",ya,4),cs("YuvToArgbRow",Ha,4),cs("YuvToRgba4444Row",ta,2),cs("YuvToRgb565Row",In,2);var l5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],lm=[0,2,8],nE=[8,7,6,4,4,2,2,2,1,1,1,1],aE=1;this.WebPDecodeRGBA=function(v,k,E,M,G){var Y=nm,X=new uc,Q=new Ti;X.ba=Q,Q.S=Y,Q.width=[Q.width],Q.height=[Q.height];var ee=Q.width,re=Q.height,me=new qs;if(me==null||v==null)var je=2;else t(me!=null),je=dc(v,k,E,me.width,me.height,me.Pd,me.Qd,me.format,null);if(je!=0?ee=0:(ee!=null&&(ee[0]=me.width[0]),re!=null&&(re[0]=me.height[0]),ee=1),ee){Q.width=Q.width[0],Q.height=Q.height[0],M!=null&&(M[0]=Q.width),G!=null&&(G[0]=Q.height);e:{if(M=new nc,(G=new ph).data=v,G.w=k,G.ha=E,G.kd=1,k=[0],t(G!=null),((v=dc(G.data,G.w,G.ha,null,null,null,k,null,G))==0||v==7)&&k[0]&&(v=4),(k=v)==0){if(t(X!=null),M.data=G.data,M.w=G.w+G.offset,M.ha=G.ha-G.offset,M.put=as,M.ac=Ra,M.bc=rs,M.ma=X,G.xa){if((v=si())==null){X=1;break e}if(function(Ce,Ne){var qe=[0],Pe=[0],ge=[0];t:for(;;){if(Ce==null)return 0;if(Ne==null)return Ce.a=2,0;if(Ce.l=Ne,Ce.a=0,q(Ce.m,Ne.data,Ne.w,Ne.ha),!yt(Ce.m,qe,Pe,ge)){Ce.a=3;break t}if(Ce.xb=t5,Ne.width=qe[0],Ne.height=Pe[0],!os(qe[0],Pe[0],1,Ce,null))break t;return 1}return t(Ce.a!=0),0}(v,M)){if(M=(k=hc(M.width,M.height,X.Oa,X.ba))==0){t:{M=v;n:for(;;){if(M==null){M=0;break t}if(t(M.s.yc!=null),t(M.s.Ya!=null),t(0<M.s.Wb),t((E=M.l)!=null),t((G=E.ma)!=null),M.xb!=0){if(M.ca=G.ba,M.tb=G.tb,t(M.ca!=null),!yh(G.Oa,E,am)){M.a=2;break n}if(!Wl(M,E.width)||E.da)break n;if((E.da||Kt(M.ca.S))&&Se(),11>M.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),M.ca.f.kb.F!=null&&Se()),M.Pb&&0<M.s.ua&&M.s.vb.X==null&&!we(M.s.vb,M.s.Wa.Xa)){M.a=1;break n}M.xb=0}if(!Mi(M,M.V,M.Ba,M.c,M.i,E.o,Xu))break n;G.Dc=M.Ma,M=1;break t}t(M.a!=0),M=0}M=!M}M&&(k=v.a)}else k=v.a}else{if((v=new Bv)==null){X=1;break e}if(v.Fa=G.na,v.P=G.P,v.qc=G.Sa,Lp(v,M)){if((k=hc(M.width,M.height,X.Oa,X.ba))==0){if(v.Aa=0,E=X.Oa,t((G=v)!=null),E!=null){if(0<(ee=0>(ee=E.Md)?0:100<ee?255:255*ee/100)){for(re=me=0;4>re;++re)12>(je=G.pb[re]).lc&&(je.ia=ee*nE[0>je.lc?0:je.lc]>>3),me|=je.ia;me&&(alert("todo:VP8InitRandom"),G.ia=1)}G.Ga=E.Id,100<G.Ga?G.Ga=100:0>G.Ga&&(G.Ga=0)}zv(v,M)||(k=v.a)}}else k=v.a}k==0&&X.Oa!=null&&X.Oa.fd&&(k=wh(X.ba))}X=k}Y=X!=0?null:11>Y?Q.f.RGBA.eb:Q.f.kb.y}else Y=null;return Y};var u5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(A,R){for(var L="",j=0;j<4;j++)L+=String.fromCharCode(A[R++]);return L}function d(A,R){return(A[R+0]<<0|A[R+1]<<8|A[R+2]<<16)>>>0}function h(A,R){return(A[R+0]<<0|A[R+1]<<8|A[R+2]<<16|A[R+3]<<24)>>>0}new u;var p=[0],f=[0],g=[],b=new u,w=e,m=function(A,R){var L={},j=0,D=!1,B=0,z=0;if(L.frames=[],!function(W,K,J,H){for(var ie=0;ie<H;ie++)if(W[K+ie]!=J.charCodeAt(ie))return!0;return!1}(A,R,"RIFF",4)){var U,I;for(h(A,R+=4),R+=8;R<A.length;){var F=c(A,R),q=h(A,R+=4);R+=4;var O=q+(1&q);switch(F){case"VP8 ":case"VP8L":L.frames[j]===void 0&&(L.frames[j]={}),(P=L.frames[j]).src_off=D?z:R-8,P.src_size=B+q+8,j++,D&&(D=!1,B=0,z=0);break;case"VP8X":(P=L.header={}).feature_flags=A[R];var $=R+4;P.canvas_width=1+d(A,$),$+=3,P.canvas_height=1+d(A,$),$+=3;break;case"ALPH":D=!0,B=O+8,z=R-8;break;case"ANIM":(P=L.header).bgcolor=h(A,R),$=R+4,P.loop_count=(U=A)[(I=$)+0]<<0|U[I+1]<<8,$+=2;break;case"ANMF":var Z,P;(P=L.frames[j]={}).offset_x=2*d(A,R),R+=3,P.offset_y=2*d(A,R),R+=3,P.width=1+d(A,R),R+=3,P.height=1+d(A,R),R+=3,P.duration=d(A,R),R+=3,Z=A[R++],P.dispose=1&Z,P.blend=Z>>1&1}F!="ANMF"&&(R+=O)}return L}}(w,0);m.response=w,m.rgbaoutput=!0,m.dataurl=!1;var x=m.header?m.header:null,y=m.frames?m.frames:null;if(x){x.loop_counter=x.loop_count,p=[x.canvas_height],f=[x.canvas_width];for(var N=0;N<y.length&&y[N].blend!=0;N++);}var S=y[0],T=b.WebPDecodeRGBA(w,S.src_off,S.src_size,f,p);S.rgba=T,S.imgwidth=f[0],S.imgheight=p[0];for(var C=0;C<f[0]*p[0]*4;C++)g[C]=T[C];return this.width=f,this.height=p,this.data=g,this}(function(e){var t=function(){return typeof ky=="function"},n=function(p,f,g,b){var w=4,m=s;switch(b){case e.image_compression.FAST:w=1,m=i;break;case e.image_compression.MEDIUM:w=6,m=o;break;case e.image_compression.SLOW:w=9,m=u}p=a(p,f,g,m);var x=ky(p,{level:w});return e.__addimage__.arrayBufferToBinaryString(x)},a=function(p,f,g,b){for(var w,m,x,y=p.length/f,N=new Uint8Array(p.length+y),S=d(),T=0;T<y;T+=1){if(x=T*f,w=p.subarray(x,x+f),b)N.set(b(w,g,m),x+T);else{for(var C,A=S.length,R=[];C<A;C+=1)R[C]=S[C](w,g,m);var L=h(R.concat());N.set(R[L],x+T)}m=w}return N},r=function(p){var f=Array.apply([],p);return f.unshift(0),f},i=function(p,f){var g,b=[],w=p.length;b[0]=1;for(var m=0;m<w;m+=1)g=p[m-f]||0,b[m+1]=p[m]-g+256&255;return b},s=function(p,f,g){var b,w=[],m=p.length;w[0]=2;for(var x=0;x<m;x+=1)b=g&&g[x]||0,w[x+1]=p[x]-b+256&255;return w},o=function(p,f,g){var b,w,m=[],x=p.length;m[0]=3;for(var y=0;y<x;y+=1)b=p[y-f]||0,w=g&&g[y]||0,m[y+1]=p[y]+256-(b+w>>>1)&255;return m},u=function(p,f,g){var b,w,m,x,y=[],N=p.length;y[0]=4;for(var S=0;S<N;S+=1)b=p[S-f]||0,w=g&&g[S]||0,m=g&&g[S-f]||0,x=c(b,w,m),y[S+1]=p[S]-x+256&255;return y},c=function(p,f,g){if(p===f&&f===g)return p;var b=Math.abs(f-g),w=Math.abs(p-g),m=Math.abs(p+f-g-g);return b<=w&&b<=m?p:w<=m?f:g},d=function(){return[r,i,s,o,u]},h=function(p){var f=p.map(function(g){return g.reduce(function(b,w){return b+Math.abs(w)},0)});return f.indexOf(Math.min.apply(null,f))};e.processPNG=function(p,f,g,b){var w,m,x,y,N,S,T,C,A,R,L,j,D,B,z,U=this.decode.FLATE_DECODE,I="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(x=new CH(p)).imgData,m=x.bits,w=x.colorSpace,N=x.colors,[4,6].indexOf(x.colorType)!==-1){if(x.bits===8){A=(C=x.pixelBitlength==32?new Uint32Array(x.decodePixels().buffer):x.pixelBitlength==16?new Uint16Array(x.decodePixels().buffer):new Uint8Array(x.decodePixels().buffer)).length,L=new Uint8Array(A*x.colors),R=new Uint8Array(A);var F,q=x.pixelBitlength-x.bits;for(B=0,z=0;B<A;B++){for(D=C[B],F=0;F<q;)L[z++]=D>>>F&255,F+=x.bits;R[B]=D>>>F&255}}if(x.bits===16){A=(C=new Uint32Array(x.decodePixels().buffer)).length,L=new Uint8Array(A*(32/x.pixelBitlength)*x.colors),R=new Uint8Array(A*(32/x.pixelBitlength)),j=x.colors>1,B=0,z=0;for(var O=0;B<A;)D=C[B++],L[z++]=D>>>0&255,j&&(L[z++]=D>>>16&255,D=C[B++],L[z++]=D>>>0&255),R[O++]=D>>>16&255;m=8}b!==e.image_compression.NONE&&t()?(p=n(L,x.width*x.colors,x.colors,b),T=n(R,x.width,1,b)):(p=L,T=R,U=void 0)}if(x.colorType===3&&(w=this.color_spaces.INDEXED,S=x.palette,x.transparency.indexed)){var $=x.transparency.indexed,Z=0;for(B=0,A=$.length;B<A;++B)Z+=$[B];if((Z/=255)===A-1&&$.indexOf(0)!==-1)y=[$.indexOf(0)];else if(Z!==A){for(C=x.decodePixels(),R=new Uint8Array(C.length),B=0,A=C.length;B<A;B++)R[B]=$[C[B]];T=n(R,x.width,1)}}var P=function(W){var K;switch(W){case e.image_compression.FAST:K=11;break;case e.image_compression.MEDIUM:K=13;break;case e.image_compression.SLOW:K=14;break;default:K=12}return K}(b);return U===this.decode.FLATE_DECODE&&(I="/Predictor "+P+" "),I+="/Colors "+N+" /BitsPerComponent "+m+" /Columns "+x.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(T&&this.__addimage__.isArrayBuffer(T)||this.__addimage__.isArrayBufferView(T))&&(T=this.__addimage__.arrayBufferToBinaryString(T)),{alias:g,data:p,index:f,filter:U,decodeParameters:I,transparency:y,palette:S,sMask:T,predictor:P,width:x.width,height:x.height,bitsPerComponent:m,colorSpace:w}}}})(xt.API),function(e){e.processGIF89A=function(t,n,a,r){var i=new AH(t),s=i.width,o=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var c={data:u,width:s,height:o},d=new qb(100).encode(c,100);return e.processJPEG.call(this,d,n,a,r)},e.processGIF87A=e.processGIF89A}(xt.API),Hi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:r,green:a,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Hi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){pn.log("bit decode error:"+n)}},Hi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,r=0;r<t;r++)for(var i=this.datav.getUint8(this.pos++,!0),s=a*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var u=this.palette[i>>7-o&1];this.data[s+4*o]=u.blue,this.data[s+4*o+1]=u.green,this.data[s+4*o+2]=u.red,this.data[s+4*o+3]=255}n!==0&&(this.pos+=4-n)}},Hi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,r=0;r<e;r++){var i=this.datav.getUint8(this.pos++,!0),s=a*this.width*4+2*r*4,o=i>>4,u=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*r+1>=this.width)break;c=this.palette[u],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Hi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var r=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*a;if(r<this.palette.length){var s=this.palette[r];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Hi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,u=(i>>10&t)/t*255|0,c=i>>15?255:0,d=a*this.width*4+4*r;this.data[d]=u,this.data[d+1]=o,this.data[d+2]=s,this.data[d+3]=c}this.pos+=e}},Hi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var r=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,u=(s>>5&n)/n*255|0,c=(s>>11)/t*255|0,d=r*this.width*4+4*i;this.data[d]=c,this.data[d+1]=u,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},Hi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;this.data[s]=i,this.data[s+1]=r,this.data[s+2]=a,this.data[s+3]=255}this.pos+=this.width%4}},Hi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=i,this.data[o+1]=r,this.data[o+2]=a,this.data[o+3]=s}},Hi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,a,r){var i=new Hi(t,!1),s=i.width,o=i.height,u={data:i.getData(),width:s,height:o},c=new qb(100).encode(u,100);return e.processJPEG.call(this,c,n,a,r)}}(xt.API),O4.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,a,r){var i=new O4(t),s=i.width,o=i.height,u={data:i.getData(),width:s,height:o},c=new qb(100).encode(u,100);return e.processJPEG.call(this,c,n,a,r)}}(xt.API),xt.API.processRGBA=function(e,t,n){for(var a=e.data,r=a.length,i=new Uint8Array(r/4*3),s=new Uint8Array(r/4),o=0,u=0,c=0;c<r;c+=4){var d=a[c],h=a[c+1],p=a[c+2],f=a[c+3];i[o++]=d,i[o++]=h,i[o++]=p,s[u++]=f}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:g,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},xt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Pc=xt.API,eg=Pc.getCharWidthsArray=function(e,t){var n,a,r=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:r.metadata.Unicode.widths,u=o.fof?o.fof:1,c=t.kerning?t.kerning:r.metadata.Unicode.kerning,d=c.fof?c.fof:1,h=t.doKerning!==!1,p=0,f=e.length,g=0,b=o[0]||u,w=[];for(n=0;n<f;n++)a=e.charCodeAt(n),typeof r.metadata.widthOfString=="function"?w.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(a))+s*(1e3/i)||0)/1e3):(p=h&&ln(c[a])==="object"&&!isNaN(parseInt(c[a][g],10))?c[a][g]/d:0,w.push((o[a]||b)/u+p)),g=a;return w},L4=Pc.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),r=t.charSpace||this.internal.getCharSpace();return Pc.processArabic&&(e=Pc.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,n,r)/n:eg.apply(this,arguments).reduce(function(i,s){return i+s},0)},P4=function(e,t,n,a){for(var r=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<n;)o+=t[i],i++;r.push(e.slice(0,i));var u=i;for(o=0;i!==s;)o+t[i]>a&&(r.push(e.slice(u,i)),o=0,u=i),o+=t[i],i++;return u!==i&&r.push(e.slice(u,i)),r},M4=function(e,t,n){n||(n={});var a,r,i,s,o,u,c,d=[],h=[d],p=n.textIndent||0,f=0,g=0,b=e.split(" "),w=eg.apply(this,[" ",n])[0];if(u=n.lineIndent===-1?b[0].length+2:n.lineIndent||0){var m=Array(u).join(" "),x=[];b.map(function(N){(N=N.split(/\s*\n/)).length>1?x=x.concat(N.map(function(S,T){return(T&&S.length?`
`:"")+S})):x.push(N[0])}),b=x,u=L4.apply(this,[m,n])}for(i=0,s=b.length;i<s;i++){var y=0;if(a=b[i],u&&a[0]==`
`&&(a=a.substr(1),y=1),p+f+(g=(r=eg.apply(this,[a,n])).reduce(function(N,S){return N+S},0))>t||y){if(g>t){for(o=P4.apply(this,[a,r,t-(p+f),t]),d.push(o.shift()),d=[o.pop()];o.length;)h.push([o.shift()]);g=r.slice(a.length-(d[0]?d[0].length:0)).reduce(function(N,S){return N+S},0)}else d=[a];h.push(d),p=g+u,f=w}else d.push(a),p+=f+g,f=w}return c=u?function(N,S){return(S?m:"")+N.join(" ")}:function(N){return N.join(" ")},h.map(c)},Pc.splitTextToSize=function(e,t,n){var a,r=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var h=this.internal.getFont(d.fontName,d.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/r;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,i.lineIndent=n.lineIndent;var o,u,c=[];for(o=0,u=a.length;o<u;o++)c=c.concat(M4.apply(this,[a[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},a={},r=0;r<t.length;r++)n[t[r]]="0123456789abcdef"[r],a["0123456789abcdef"[r]]=t[r];var i=function(h){return"0x"+parseInt(h,10).toString(16)},s=e.__fontmetrics__.compress=function(h){var p,f,g,b,w=["{"];for(var m in h){if(p=h[m],isNaN(parseInt(m,10))?f="'"+m+"'":(m=parseInt(m,10),f=(f=i(m).slice(2)).slice(0,-1)+a[f.slice(-1)]),typeof p=="number")p<0?(g=i(p).slice(3),b="-"):(g=i(p).slice(2),b=""),g=b+g.slice(0,-1)+a[g.slice(-1)];else{if(ln(p)!=="object")throw new Error("Don't know what to do with value type "+ln(p)+".");g=s(p)}w.push(f+g)}return w.push("}"),w.join("")},o=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,f,g,b,w={},m=1,x=w,y=[],N="",S="",T=h.length-1,C=1;C<T;C+=1)(b=h[C])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(b):b=="{"?(y.push([x,g]),x={},g=void 0):b=="}"?((f=y.pop())[0][f[1]]=x,g=void 0,x=f[0]):b=="-"?m=-1:g===void 0?n.hasOwnProperty(b)?(N+=n[b],g=parseInt(N,16)*m,m=1,N=""):N+=b:n.hasOwnProperty(b)?(S+=n[b],x[g]=parseInt(S,16)*m,m=1,g=void 0,S=""):S+=b;return w},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},d={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var p=h.font,f=d.Unicode[p.postScriptName];f&&(p.metadata.Unicode={},p.metadata.Unicode.widths=f.widths,p.metadata.Unicode.kerning=f.kerning);var g=c.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(xt.API),function(e){var t=function(n){for(var a=n.length,r=new Uint8Array(a),i=0;i<a;i++)r[i]=n.charCodeAt(i);return r};e.API.events.push(["addFont",function(n){var a=void 0,r=n.font,i=n.instance;if(!r.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(a=i.existsFileInVFS(r.postScriptName)===!1?i.loadFile(r.postScriptName):i.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(xf(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(r,a)}}])}(xt),function(e){function t(){return(Nt.canvg?Promise.resolve(Nt.canvg):gg(()=>import("./index.es-B8fvJ6Yq.js"),__vite__mapDeps([5,1,2,3,4]))).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}xt.API.addSvgAsImage=function(n,a,r,i,s,o,u,c){if(isNaN(a)||isNaN(r))throw pn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw pn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=s;var h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return t().then(function(g){return g.fromString(h,n,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(p)}).then(function(){f.addImage(d.toDataURL("image/jpeg",1),a,r,i,s,u,c)})}}(),xt.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var r=0;r<this.internal.pages[a].length;r++)this.internal.pages[a][r]=this.internal.pages[a][r].replace(t,n);return this},xt.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var a,r,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),u=[],c=0,d=0,h=0;function p(g,b){var w,m=!1;for(w=0;w<g.length;w+=1)g[w]===b&&(m=!0);return m}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var f=o.length;for(h=0;h<f;h+=1)n[o[h]].value=n[o[h]].defaultValue,n[o[h]].explicitSet=!1}if(ln(e)==="object"){for(r in e)if(i=e[r],p(o,r)&&i!==void 0){if(n[r].type==="boolean"&&typeof i=="boolean")n[r].value=i;else if(n[r].type==="name"&&p(n[r].valueSet,i))n[r].value=i;else if(n[r].type==="integer"&&Number.isInteger(i))n[r].value=i;else if(n[r].type==="array"){for(c=0;c<i.length;c+=1)if(a=!0,i[c].length===1&&typeof i[c][0]=="number")u.push(String(i[c]-1));else if(i[c].length>1){for(d=0;d<i[c].length;d+=1)typeof i[c][d]!="number"&&(a=!1);a===!0&&u.push([i[c][0]-1,i[c][1]-1].join(" "))}n[r].value="["+u.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,b=[];for(g in n)n[g].explicitSet===!0&&(n[g].type==="name"?b.push("/"+g+" /"+n[g].value):b.push("/"+g+" "+n[g].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+r.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(r+i+s+o+u),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(xt.API),function(e){var t=e.API,n=t.pdfEscape16=function(i,s){for(var o,u=s.metadata.Unicode.widths,c=["","0","00","000","0000"],d=[""],h=0,p=i.length;h<p;++h){if(o=s.metadata.characterToGlyph(i.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(h),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(c[4-o.length],o)}return d.join("")},a=function(i){var s,o,u,c,d,h,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],h=0,p=(o=Object.keys(i).sort(function(f,g){return f-g})).length;h<p;h++)s=o[h],u.length>=100&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+c+">"));return u.length&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,u=s.out,c=s.newObject,d=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",g=0;g<p.length;g++)f+=String.fromCharCode(p[g]);var b=c();d({data:f,addLength1:!0,objectId:b}),u("endobj");var w=c();d({data:a(o.metadata.toUnicode),addLength1:!0,objectId:w}),u("endobj");var m=c();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Hc(o.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var x=c();u("<<"),u("/Type /Font"),u("/BaseFont /"+Hc(o.fontName)),u("/FontDescriptor "+m+" 0 R"),u("/W "+e.API.PDFObject.convert(h)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=c(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+w+" 0 R"),u("/BaseFont /"+Hc(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+x+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,u=s.out,c=s.newObject,d=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",f=0;f<h.length;f++)p+=String.fromCharCode(h[f]);var g=c();d({data:p,addLength1:!0,objectId:g}),u("endobj");var b=c();d({data:a(o.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var w=c();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+g+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+Hc(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=c();for(var m=0;m<o.metadata.hmtx.widths.length;m++)o.metadata.hmtx.widths[m]=parseInt(o.metadata.hmtx.widths[m]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+Hc(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]);var r=function(i){var s,o=i.text||"",u=i.x,c=i.y,d=i.options||{},h=i.mutex||{},p=h.pdfEscape,f=h.activeFontKey,g=h.fonts,b=f,w="",m=0,x="",y=g[b].encoding;if(g[b].encoding!=="Identity-H")return{text:o,x:u,y:c,options:d,mutex:h};for(x=o,b=f,Array.isArray(o)&&(x=o[0]),m=0;m<x.length;m+=1)g[b].metadata.hasOwnProperty("cmap")&&(s=g[b].metadata.cmap.unicode.codeMap[x[m].charCodeAt(0)]),s||x[m].charCodeAt(0)<256&&g[b].metadata.hasOwnProperty("Unicode")?w+=x[m]:w+="";var N="";return parseInt(b.slice(1))<14||y==="WinAnsiEncoding"?N=p(w,b).split("").map(function(S){return S.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(N=n(w,g[b])),h.isHex=!0,{text:N,x:u,y:c,options:d,mutex:h}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],u={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([r(Object.assign({},u,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(r(Object.assign({},u,{text:s[c]})).text);i.text=o}else i.text=r(Object.assign({},u,{text:s})).text}])}(xt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,a){return t.call(this),this.internal.vFS[n]=a,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(xt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var r,i,s,o,u,c,d,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,y=0;this.__bidiEngine__={};var N=function(j){var D=j.charCodeAt(),B=D>>8,z=b[B];return z!==void 0?h[256*z+(255&D)]:B===252||B===253?"AL":m.test(B)?"L":B===8?"R":"N"},S=function(j){for(var D,B=0;B<j.length;B++){if((D=N(j.charAt(B)))==="L")return!1;if(D==="R")return!0}return!1},T=function(j,D,B,z){var U,I,F,q,O=D[z];switch(O){case"L":case"R":x=!1;break;case"N":case"AN":break;case"EN":x&&(O="AN");break;case"AL":x=!0,O="R";break;case"WS":O="N";break;case"CS":z<1||z+1>=D.length||(U=B[z-1])!=="EN"&&U!=="AN"||(I=D[z+1])!=="EN"&&I!=="AN"?O="N":x&&(I="AN"),O=I===U?I:"N";break;case"ES":O=(U=z>0?B[z-1]:"B")==="EN"&&z+1<D.length&&D[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&B[z-1]==="EN"){O="EN";break}if(x){O="N";break}for(F=z+1,q=D.length;F<q&&D[F]==="ET";)F++;O=F<q&&D[F]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(q=D.length,F=z+1;F<q&&D[F]==="NSM";)F++;if(F<q){var $=j[z],Z=$>=1425&&$<=2303||$===64286;if(U=D[F],Z&&(U==="R"||U==="AL")){O="R";break}}}O=z<1||(U=D[z-1])==="B"?"N":B[z-1];break;case"B":x=!1,r=!0,O=y;break;case"S":i=!0,O="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"BN":O="N"}return O},C=function(j,D,B){var z=j.split("");return B&&A(z,B,{hiLevel:y}),z.reverse(),D&&D.reverse(),z.join("")},A=function(j,D,B){var z,U,I,F,q,O=-1,$=j.length,Z=0,P=[],W=y?f:p,K=[];for(x=!1,r=!1,i=!1,U=0;U<$;U++)K[U]=N(j[U]);for(I=0;I<$;I++){if(q=Z,P[I]=T(j,K,P,I),z=240&(Z=W[q][g[P[I]]]),Z&=15,D[I]=F=W[Z][5],z>0)if(z===16){for(U=O;U<I;U++)D[U]=1;O=-1}else O=-1;if(W[Z][6])O===-1&&(O=I);else if(O>-1){for(U=O;U<I;U++)D[U]=F;O=-1}K[I]==="B"&&(D[I]=0),B.hiLevel|=F}i&&function(J,H,ie){for(var ue=0;ue<ie;ue++)if(J[ue]==="S"){H[ue]=y;for(var ce=ue-1;ce>=0&&J[ce]==="WS";ce--)H[ce]=y}}(K,D,$)},R=function(j,D,B,z,U){if(!(U.hiLevel<j)){if(j===1&&y===1&&!r)return D.reverse(),void(B&&B.reverse());for(var I,F,q,O,$=D.length,Z=0;Z<$;){if(z[Z]>=j){for(q=Z+1;q<$&&z[q]>=j;)q++;for(O=Z,F=q-1;O<F;O++,F--)I=D[O],D[O]=D[F],D[F]=I,B&&(I=B[O],B[O]=B[F],B[F]=I);Z=q}Z++}}},L=function(j,D,B){var z=j.split(""),U={hiLevel:y};return B||(B=[]),A(z,B,U),function(I,F,q){if(q.hiLevel!==0&&d)for(var O,$=0;$<I.length;$++)F[$]===1&&(O=w.indexOf(I[$]))>=0&&(I[$]=w[O+1])}(z,B,U),R(2,z,D,B,U),R(1,z,D,B,U),z.join("")};return this.__bidiEngine__.doBidiReorder=function(j,D,B){if(function(U,I){if(I)for(var F=0;F<U.length;F++)I[F]=F;o===void 0&&(o=S(U)),c===void 0&&(c=S(U))}(j,D),s||!u||c)if(s&&u&&o^c)y=o?1:0,j=C(j,D,B);else if(!s&&u&&c)y=o?1:0,j=L(j,D,B),j=C(j,D);else if(!s||o||u||c){if(s&&!u&&o^c)j=C(j,D),o?(y=0,j=L(j,D,B)):(y=1,j=L(j,D,B),j=C(j,D));else if(s&&o&&!u&&c)y=1,j=L(j,D,B),j=C(j,D);else if(!s&&!u&&o^c){var z=d;o?(y=1,j=L(j,D,B),y=0,d=!1,j=L(j,D,B),d=z):(y=0,j=L(j,D,B),j=C(j,D),y=1,d=!1,j=L(j,D,B),d=z,j=C(j,D))}}else y=0,j=L(j,D,B);else y=o?1:0,j=L(j,D,B);return j},this.__bidiEngine__.setOptions=function(j){j&&(s=j.isInputVisual,u=j.isOutputVisual,o=j.isInputRtl,c=j.isOutputRtl,d=j.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var r=a.text,i=(a.x,a.y,a.options||{}),s=(a.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(s=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?s.push([n.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):s.push([n.doBidiReorder(r[o])]);a.text=s}else a.text=n.doBidiReorder(r);n.setOptions({isInputVisual:!0})}])}(xt),xt.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new Il(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new HH(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new EH(this.contents),this.head=new TH(this),this.name=new IH(this),this.cmap=new DA(this),this.toUnicode={},this.hhea=new RH(this),this.maxp=new OH(this),this.hmtx=new FH(this),this.post=new PH(this),this.os2=new LH(this),this.loca=new qH(this),this.glyf=new BH(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,a,r,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,u,c;for(c=[],s=0,o=(u=this.bbox).length;s<o;s++)t=u[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(a=255&(r=this.post.italic_angle),32768&(n=r>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,a){var r,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)r=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(r))+a*(1e3/n)||0;return s*(n/1e3)},e.prototype.lineHeight=function(t,n){var a;return n==null&&(n=!1),a=n?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var ns,Il=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,a;for(a=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)a[n]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var n,a,r;for(r=[],n=0,a=t.length;0<=a?n<a:n>a;n=0<=a?++n:--n)r.push(this.writeByte(t.charCodeAt(n)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,a,r,i,s,o,u;return t=this.readByte(),n=this.readByte(),a=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^a)+4294967296*(255^r)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^u)+1):72057594037927940*t+281474976710656*n+1099511627776*a+4294967296*r+16777216*i+65536*s+256*o+u},e.prototype.writeLongLong=function(t){var n,a;return n=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,a;for(n=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)n.push(this.readByte());return n},e.prototype.write=function(t){var n,a,r,i;for(i=[],a=0,r=t.length;a<r;a++)n=t[a],i.push(this.writeByte(n));return i},e}(),EH=function(){var e;function t(n){var a,r,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},r=0,i=this.tableCount;0<=i?r<i:r>i;r=0<=i?++r:--r)a={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(n){var a,r,i,s,o,u,c,d,h,p,f,g,b;for(b in f=Object.keys(n).length,u=Math.log(2),h=16*Math.floor(Math.log(f)/u),s=Math.floor(h/u),d=16*f-h,(r=new Il).writeInt(this.scalarType),r.writeShort(f),r.writeShort(h),r.writeShort(s),r.writeShort(d),i=16*f,c=r.pos+i,o=null,g=[],n)for(p=n[b],r.writeString(b),r.writeInt(e(p)),r.writeInt(c),r.writeInt(p.length),g=g.concat(p),b==="head"&&(o=c),c+=p.length;c%4;)g.push(0),c++;return r.write(g),a=2981146554-e(r.data),r.pos=o+8,r.writeUInt32(a),r.data},e=function(n){var a,r,i,s;for(n=TA.call(n);n.length%4;)n.push(0);for(i=new Il(n),r=0,a=0,s=n.length;a<s;a=a+=4)r+=i.readUInt32();return 4294967295&r},t}(),DH={}.hasOwnProperty,Us=function(e,t){for(var n in t)DH.call(t,n)&&(e[n]=t[n]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};ns=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var TH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var a;return(a=new Il).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(n),a.writeShort(this.glyphDataFormat),a.data},t}(),F4=function(){function e(t,n){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(f=t.readUInt16(),p=f/2,t.pos+=6,i=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),t.pos+=2,b=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),c=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),d=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),r=(this.length-t.pos+this.offset)/2,o=function(){var N,S;for(S=[],u=N=0;0<=r?N<r:N>r;u=0<=r?++N:--N)S.push(t.readUInt16());return S}(),u=m=0,y=i.length;m<y;u=++m)for(w=i[u],a=x=g=b[u];g<=w?x<=w:x>=w;a=g<=w?++x:--x)d[u]===0?s=a+c[u]:(s=o[d[u]/2+(a-g)-(p-u)]||0)!==0&&(s+=c[u]),this.codeMap[a]=65535&s}t.pos=h}return e.encode=function(t,n){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,T,C,A,R,L,j,D,B,z,U,I,F,q,O,$,Z,P,W,K,J,H,ie,ue,ce,pe,ve,De;switch(z=new Il,s=Object.keys(t).sort(function(Re,we){return Re-we}),n){case"macroman":for(b=0,w=function(){var Re=[];for(g=0;g<256;++g)Re.push(0);return Re}(),x={0:0},i={},U=0,O=s.length;U<O;U++)x[ce=t[r=s[U]]]==null&&(x[ce]=++b),i[r]={old:t[r],new:x[t[r]]},w[r]=x[t[r]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(w),{charMap:i,subtable:z.data,maxGlyphID:b+1};case"unicode":for(D=[],h=[],y=0,x={},a={},m=c=null,I=0,$=s.length;I<$;I++)x[S=t[r=s[I]]]==null&&(x[S]=++y),a[r]={old:S,new:x[S]},o=x[S]-r,m!=null&&o===c||(m&&h.push(m),D.push(r),c=o),m=r;for(m&&h.push(m),h.push(65535),D.push(65535),L=2*(R=D.length),A=2*Math.pow(Math.log(R)/Math.LN2,2),p=Math.log(A/2)/Math.LN2,C=2*R-A,u=[],T=[],f=[],g=F=0,Z=D.length;F<Z;g=++F){if(j=D[g],d=h[g],j===65535){u.push(0),T.push(0);break}if(j-(B=a[j].new)>=32768)for(u.push(0),T.push(2*(f.length+R-g)),r=q=j;j<=d?q<=d:q>=d;r=j<=d?++q:--q)f.push(a[r].new);else u.push(B-j),T.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*R+2*f.length),z.writeUInt16(0),z.writeUInt16(L),z.writeUInt16(A),z.writeUInt16(p),z.writeUInt16(C),ie=0,P=h.length;ie<P;ie++)r=h[ie],z.writeUInt16(r);for(z.writeUInt16(0),ue=0,W=D.length;ue<W;ue++)r=D[ue],z.writeUInt16(r);for(pe=0,K=u.length;pe<K;pe++)o=u[pe],z.writeUInt16(o);for(ve=0,J=T.length;ve<J;ve++)N=T[ve],z.writeUInt16(N);for(De=0,H=f.length;De<H;De++)b=f[De],z.writeUInt16(b);return{charMap:a,subtable:z.data,maxGlyphID:y+1}}},e}(),DA=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="cmap",t.prototype.parse=function(n){var a,r,i;for(n.pos=this.offset,this.version=n.readUInt16(),i=n.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)a=new F4(n,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(n,a){var r,i;return a==null&&(a="macroman"),r=F4.encode(n,a),(i=new Il).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),RH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),LH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var a,r;for(r=[],a=0;a<10;++a)r.push(n.readByte());return r}(),this.charRange=function(){var a,r;for(r=[],a=0;a<4;++a)r.push(n.readInt());return r}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var a,r;for(r=[],a=0;a<2;a=++a)r.push(n.readInt());return r}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),PH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="post",t.prototype.parse=function(n){var a,r,i;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var s;for(r=n.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],i=[];n.pos<this.offset+this.length;)a=n.readByte(),i.push(this.names.push(n.readString(a)));return i;case 151552:return r=n.readUInt16(),this.offsets=n.read(r);case 196608:break;case 262144:return this.map=(function(){var o,u,c;for(c=[],s=o=0,u=this.file.maxp.numGlyphs;0<=u?o<u:o>u;s=0<=u?++o:--o)c.push(n.readUInt32());return c}).call(this)}},t}(),MH=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},IH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="name",t.prototype.parse=function(n){var a,r,i,s,o,u,c,d,h,p,f;for(n.pos=this.offset,n.readShort(),a=n.readShort(),u=n.readShort(),r=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)r.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+u+n.readShort()});for(c={},s=h=0,p=r.length;h<p;s=++h)i=r[s],n.pos=i.offset,d=n.readString(i.length),o=new MH(d,i),c[f=i.nameID]==null&&(c[f]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),OH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),FH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="hmtx",t.prototype.parse=function(n){var a,r,i,s,o,u,c;for(n.pos=this.offset,this.metrics=[],a=0,u=this.file.hhea.numberOfMetrics;0<=u?a<u:a>u;a=0<=u?++a:--a)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,h;for(h=[],a=d=0;0<=i?d<i:d>i;a=0<=i?++d:--d)h.push(n.readInt16());return h}(),this.widths=(function(){var d,h,p,f;for(f=[],d=0,h=(p=this.metrics).length;d<h;d++)s=p[d],f.push(s.advance);return f}).call(this),r=this.widths[this.widths.length-1],c=[],a=o=0;0<=i?o<i:o>i;a=0<=i?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),TA=[].slice,BH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var a,r,i,s,o,u,c,d,h,p;return n in this.cache?this.cache[n]:(s=this.file.loca,a=this.file.contents,r=s.indexOf(n),(i=s.lengthOf(n))===0?this.cache[n]=null:(a.pos=this.offset+r,o=(u=new Il(a.read(i))).readShort(),d=u.readShort(),p=u.readShort(),c=u.readShort(),h=u.readShort(),this.cache[n]=o===-1?new UH(u,d,p,c,h):new zH(u,o,d,p,c,h),this.cache[n]))},t.prototype.encode=function(n,a,r){var i,s,o,u,c;for(o=[],s=[],u=0,c=a.length;u<c;u++)i=n[a[u]],s.push(o.length),i&&(o=o.concat(i.encode(r)));return s.push(o.length),{table:o,offsets:s}},t}(),zH=function(){function e(t,n,a,r,i,s){this.raw=t,this.numberOfContours=n,this.xMin=a,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),UH=function(){function e(t,n,a,r,i){var s,o;for(this.raw=t,this.xMin=n,this.yMin=a,this.xMax=r,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,n,a;for(n=new Il(TA.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),qH=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Us(t,ns),t.prototype.tag="loca",t.prototype.parse=function(n){var a,r;return n.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*n.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(n.readUInt32());return s}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,a){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<r.length;++o)if(r[o]=i,s<a.length&&a[s]==o){++s,r[o]=i;var u=this.offsets[o],c=this.offsets[o+1]-u;c>0&&(i+=c)}for(var d=new Array(4*r.length),h=0;h<r.length;++h)d[4*h+3]=255&r[h],d[4*h+2]=(65280&r[h])>>8,d[4*h+1]=(16711680&r[h])>>16,d[4*h]=(4278190080&r[h])>>24;return d},t}(),HH=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,a,r,i;for(n in r=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[n],t[n]=r[a];return t},e.prototype.glyphsFor=function(t){var n,a,r,i,s,o,u;for(r={},s=0,o=t.length;s<o;s++)r[i=t[s]]=this.font.glyf.glyphFor(i);for(i in n=[],r)(a=r[i])!=null&&a.compound&&n.push.apply(n,a.glyphIDs);if(n.length>0)for(i in u=this.glyphsFor(n))a=u[i],r[i]=a;return r},e.prototype.encode=function(t,n){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m;for(r in a=DA.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),f={0:0},m=a.charMap)f[(u=m[r]).old]=u.new;for(g in p=a.maxGlyphID,s)g in f||(f[g]=p++);return d=function(x){var y,N;for(y in N={},x)N[x[y]]=y;return N}(f),h=Object.keys(d).sort(function(x,y){return x-y}),b=function(){var x,y,N;for(N=[],x=0,y=h.length;x<y;x++)o=h[x],N.push(d[o]);return N}(),i=this.font.glyf.encode(s,b,f),c=this.font.loca.encode(i.offsets,b),w={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},e}();xt.API.PDFObject=function(){var e;function t(){}return e=function(n,a){return(Array(a+1).join("0")+n).slice(-a)},t.convert=function(n){var a,r,i,s;if(Array.isArray(n))return"["+function(){var o,u,c;for(c=[],o=0,u=n.length;o<u;o++)a=n[o],c.push(t.convert(a));return c}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(r in i=["<<"],n)s=n[r],i.push("/"+r+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+n},t}();const WH=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:wH,AcroFormAppearance:ot,AcroFormButton:ca,AcroFormCheckBox:wf,AcroFormChoiceField:_u,AcroFormComboBox:Cu,AcroFormEditBox:bf,AcroFormListBox:ju,AcroFormPasswordField:Nf,AcroFormPushButton:yf,AcroFormRadioButton:Au,AcroFormTextField:Cl,GState:Yf,ShadingPattern:rl,TilingPattern:pu,default:xt,jsPDF:xt},Symbol.toStringTag,{value:"Module"}));var GH={exports:{}};const VH=gE(WH);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(a,r){e.exports=r(function(){try{return VH}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Nx<"u"?Nx:typeof window<"u"?window:typeof self<"u"?self:Nx,function(n){return function(){var a={172:function(o,u){var c=this&&this.__extends||function(){var p=function(f,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var m in w)Object.prototype.hasOwnProperty.call(w,m)&&(b[m]=w[m])},p(f,g)};return function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");p(f,g);function b(){this.constructor=f}f.prototype=g===null?Object.create(g):(b.prototype=g.prototype,new b)}}();Object.defineProperty(u,"__esModule",{value:!0}),u.CellHookData=u.HookData=void 0;var d=function(){function p(f,g,b){this.table=g,this.pageNumber=g.pageNumber,this.pageCount=this.pageNumber,this.settings=g.settings,this.cursor=b,this.doc=f.getDocument()}return p}();u.HookData=d;var h=function(p){c(f,p);function f(g,b,w,m,x,y){var N=p.call(this,g,b,y)||this;return N.cell=w,N.row=m,N.column=x,N.section=m.section,N}return f}(d);u.CellHookData=h},340:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0});var d=c(4),h=c(136),p=c(744),f=c(776),g=c(664),b=c(972);function w(m){m.API.autoTable=function(){for(var x=[],y=0;y<arguments.length;y++)x[y]=arguments[y];var N;x.length===1?N=x[0]:(console.error("Use of deprecated autoTable initiation"),N=x[2]||{},N.columns=x[0],N.body=x[1]);var S=(0,f.parseInput)(this,N),T=(0,b.createTable)(this,S);return(0,g.drawTable)(this,T),this},m.API.lastAutoTable=!1,m.API.previousAutoTable=!1,m.API.autoTable.previous=!1,m.API.autoTableText=function(x,y,N,S){(0,h.default)(x,y,N,S,this)},m.API.autoTableSetDefaults=function(x){return p.DocHandler.setDefaults(x,this),this},m.autoTableSetDefaults=function(x,y){p.DocHandler.setDefaults(x,y)},m.API.autoTableHtmlToJson=function(x,y){var N;if(y===void 0&&(y=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var S=new p.DocHandler(this),T=(0,d.parseHtml)(S,x,window,y,!1),C=T.head,A=T.body,R=((N=C[0])===null||N===void 0?void 0:N.map(function(L){return L.content}))||[];return{columns:R,rows:A,data:A}},m.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var x=this.lastAutoTable;return x&&x.finalY?x.finalY:0},m.API.autoTableAddPageContent=function(x){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),m.API.autoTable.globalDefaults||(m.API.autoTable.globalDefaults={}),m.API.autoTable.globalDefaults.addPageContent=x,this},m.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}u.default=w},136:function(o,u){Object.defineProperty(u,"__esModule",{value:!0});function c(d,h,p,f,g){f=f||{};var b=1.15,w=g.internal.scaleFactor,m=g.internal.getFontSize()/w,x=g.getLineHeightFactor?g.getLineHeightFactor():b,y=m*x,N=/\r\n|\r|\n/g,S="",T=1;if((f.valign==="middle"||f.valign==="bottom"||f.halign==="center"||f.halign==="right")&&(S=typeof d=="string"?d.split(N):d,T=S.length||1),p+=m*(2-b),f.valign==="middle"?p-=T/2*y:f.valign==="bottom"&&(p-=T*y),f.halign==="center"||f.halign==="right"){var C=m;if(f.halign==="center"&&(C*=.5),S&&T>=1){for(var A=0;A<S.length;A++)g.text(S[A],h-g.getStringUnitWidth(S[A])*C,p),p+=y;return g}h-=g.getStringUnitWidth(d)*C}return f.halign==="justify"?g.text(d,h,p,{maxWidth:f.maxWidth||100,align:"justify"}):g.text(d,h,p),g}u.default=c},420:function(o,u){Object.defineProperty(u,"__esModule",{value:!0}),u.getPageAvailableWidth=u.parseSpacing=u.getFillStyle=u.addTableBorder=u.getStringWidth=void 0;function c(g,b,w){w.applyStyles(b,!0);var m=Array.isArray(g)?g:[g],x=m.map(function(y){return w.getTextWidth(y)}).reduce(function(y,N){return Math.max(y,N)},0);return x}u.getStringWidth=c;function d(g,b,w,m){var x=b.settings.tableLineWidth,y=b.settings.tableLineColor;g.applyStyles({lineWidth:x,lineColor:y});var N=h(x,!1);N&&g.rect(w.x,w.y,b.getWidth(g.pageSize().width),m.y-w.y,N)}u.addTableBorder=d;function h(g,b){var w=g>0,m=b||b===0;return w&&m?"DF":w?"S":m?"F":null}u.getFillStyle=h;function p(g,b){var w,m,x,y;if(g=g||b,Array.isArray(g)){if(g.length>=4)return{top:g[0],right:g[1],bottom:g[2],left:g[3]};if(g.length===3)return{top:g[0],right:g[1],bottom:g[2],left:g[1]};if(g.length===2)return{top:g[0],right:g[1],bottom:g[0],left:g[1]};g.length===1?g=g[0]:g=b}return typeof g=="object"?(typeof g.vertical=="number"&&(g.top=g.vertical,g.bottom=g.vertical),typeof g.horizontal=="number"&&(g.right=g.horizontal,g.left=g.horizontal),{left:(w=g.left)!==null&&w!==void 0?w:b,top:(m=g.top)!==null&&m!==void 0?m:b,right:(x=g.right)!==null&&x!==void 0?x:b,bottom:(y=g.bottom)!==null&&y!==void 0?y:b}):(typeof g!="number"&&(g=b),{top:g,right:g,bottom:g,left:g})}u.parseSpacing=p;function f(g,b){var w=p(b.settings.margin,0);return g.pageSize().width-(w.left+w.right)}u.getPageAvailableWidth=f},796:function(o,u){var c=this&&this.__extends||function(){var f=function(g,b){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,m){w.__proto__=m}||function(w,m){for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(w[x]=m[x])},f(g,b)};return function(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");f(g,b);function w(){this.constructor=g}g.prototype=b===null?Object.create(b):(w.prototype=b.prototype,new w)}}();Object.defineProperty(u,"__esModule",{value:!0}),u.getTheme=u.defaultStyles=u.HtmlRowInput=void 0;var d=function(f){c(g,f);function g(b){var w=f.call(this)||this;return w._element=b,w}return g}(Array);u.HtmlRowInput=d;function h(f){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/f,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}u.defaultStyles=h;function p(f){var g={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return g[f]}u.getTheme=p},903:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.parseCss=void 0;var d=c(420);function h(w,m,x,y,N){var S={},T=1.3333333333333333,C=f(m,function(O){return N.getComputedStyle(O).backgroundColor});C!=null&&(S.fillColor=C);var A=f(m,function(O){return N.getComputedStyle(O).color});A!=null&&(S.textColor=A);var R=b(y,x);R&&(S.cellPadding=R);var L="borderTopColor",j=T*x,D=y.borderTopWidth;if(y.borderBottomWidth===D&&y.borderRightWidth===D&&y.borderLeftWidth===D){var B=(parseFloat(D)||0)/j;B&&(S.lineWidth=B)}else S.lineWidth={top:(parseFloat(y.borderTopWidth)||0)/j,right:(parseFloat(y.borderRightWidth)||0)/j,bottom:(parseFloat(y.borderBottomWidth)||0)/j,left:(parseFloat(y.borderLeftWidth)||0)/j},S.lineWidth.top||(S.lineWidth.right?L="borderRightColor":S.lineWidth.bottom?L="borderBottomColor":S.lineWidth.left&&(L="borderLeftColor"));var z=f(m,function(O){return N.getComputedStyle(O)[L]});z!=null&&(S.lineColor=z);var U=["left","right","center","justify"];U.indexOf(y.textAlign)!==-1&&(S.halign=y.textAlign),U=["middle","bottom","top"],U.indexOf(y.verticalAlign)!==-1&&(S.valign=y.verticalAlign);var I=parseInt(y.fontSize||"");isNaN(I)||(S.fontSize=I/T);var F=p(y);F&&(S.fontStyle=F);var q=(y.fontFamily||"").toLowerCase();return w.indexOf(q)!==-1&&(S.font=q),S}u.parseCss=h;function p(w){var m="";return(w.fontWeight==="bold"||w.fontWeight==="bolder"||parseInt(w.fontWeight)>=700)&&(m="bold"),(w.fontStyle==="italic"||w.fontStyle==="oblique")&&(m+="italic"),m}function f(w,m){var x=g(w,m);if(!x)return null;var y=x.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!y||!Array.isArray(y))return null;var N=[parseInt(y[1]),parseInt(y[2]),parseInt(y[3])],S=parseInt(y[4]);return S===0||isNaN(N[0])||isNaN(N[1])||isNaN(N[2])?null:N}function g(w,m){var x=m(w);return x==="rgba(0, 0, 0, 0)"||x==="transparent"||x==="initial"||x==="inherit"?w.parentElement==null?null:g(w.parentElement,m):x}function b(w,m){var x=[w.paddingTop,w.paddingRight,w.paddingBottom,w.paddingLeft],y=96/(72/m),N=(parseInt(w.lineHeight)-parseInt(w.fontSize))/m/2,S=x.map(function(C){return parseInt(C||"0")/y}),T=(0,d.parseSpacing)(S,0);return N>T.top&&(T.top=N),N>T.bottom&&(T.bottom=N),T}},744:function(o,u){Object.defineProperty(u,"__esModule",{value:!0}),u.DocHandler=void 0;var c={},d=function(){function h(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return h.setDefaults=function(p,f){f===void 0&&(f=null),f?f.__autoTableDocumentDefaults=p:c=p},h.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},h.prototype.applyStyles=function(p,f){var g,b,w;f===void 0&&(f=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var m=this.jsPDFDocument.internal.getFont(),x=m.fontStyle,y=m.fontName;if(p.font&&(y=p.font),p.fontStyle){x=p.fontStyle;var N=this.getFontList()[y];N&&N.indexOf(x)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(N[0]),x=N[0])}if(this.jsPDFDocument.setFont(y,x),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!f){var S=h.unifyColor(p.fillColor);S&&(g=this.jsPDFDocument).setFillColor.apply(g,S),S=h.unifyColor(p.textColor),S&&(b=this.jsPDFDocument).setTextColor.apply(b,S),S=h.unifyColor(p.lineColor),S&&(w=this.jsPDFDocument).setDrawColor.apply(w,S),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},h.prototype.splitTextToSize=function(p,f,g){return this.jsPDFDocument.splitTextToSize(p,f,g)},h.prototype.rect=function(p,f,g,b,w){return this.jsPDFDocument.rect(p,f,g,b,w)},h.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},h.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},h.prototype.getDocument=function(){return this.jsPDFDocument},h.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},h.prototype.addPage=function(){return this.jsPDFDocument.addPage()},h.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},h.prototype.getGlobalOptions=function(){return c||{}},h.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},h.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},h.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},h.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},h.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},h.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},h}();u.DocHandler=d},4:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.parseHtml=void 0;var d=c(903),h=c(796);function p(b,w,m,x,y){var N,S;x===void 0&&(x=!1),y===void 0&&(y=!1);var T;typeof w=="string"?T=m.document.querySelector(w):T=w;var C=Object.keys(b.getFontList()),A=b.scaleFactor(),R=[],L=[],j=[];if(!T)return console.error("Html table could not be found with input: ",w),{head:R,body:L,foot:j};for(var D=0;D<T.rows.length;D++){var B=T.rows[D],z=(S=(N=B==null?void 0:B.parentElement)===null||N===void 0?void 0:N.tagName)===null||S===void 0?void 0:S.toLowerCase(),U=f(C,A,m,B,x,y);U&&(z==="thead"?R.push(U):z==="tfoot"?j.push(U):L.push(U))}return{head:R,body:L,foot:j}}u.parseHtml=p;function f(b,w,m,x,y,N){for(var S=new h.HtmlRowInput(x),T=0;T<x.cells.length;T++){var C=x.cells[T],A=m.getComputedStyle(C);if(y||A.display!=="none"){var R=void 0;N&&(R=(0,d.parseCss)(b,C,w,A,m)),S.push({rowSpan:C.rowSpan,colSpan:C.colSpan,styles:R,_element:C,content:g(C)})}}var L=m.getComputedStyle(x);if(S.length>0&&(y||L.display!=="none"))return S}function g(b){var w=b.cloneNode(!0);return w.innerHTML=w.innerHTML.replace(/\n/g,"").replace(/ +/g," "),w.innerHTML=w.innerHTML.split(/<br.*?>/).map(function(m){return m.trim()}).join(`
`),w.innerText||w.textContent||""}},776:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.parseInput=void 0;var d=c(4),h=c(356),p=c(420),f=c(744),g=c(792);function b(T,C){var A=new f.DocHandler(T),R=A.getDocumentOptions(),L=A.getGlobalOptions();(0,g.default)(A,L,R,C);var j=(0,h.assign)({},L,R,C),D;typeof window<"u"&&(D=window);var B=w(L,R,C),z=m(L,R,C),U=x(A,j),I=N(A,j,D);return{id:C.tableId,content:I,hooks:z,styles:B,settings:U}}u.parseInput=b;function w(T,C,A){for(var R={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},L=function(z){if(z==="columnStyles"){var U=T[z],I=C[z],F=A[z];R.columnStyles=(0,h.assign)({},U,I,F)}else{var q=[T,C,A],O=q.map(function($){return $[z]||{}});R[z]=(0,h.assign)({},O[0],O[1],O[2])}},j=0,D=Object.keys(R);j<D.length;j++){var B=D[j];L(B)}return R}function m(T,C,A){for(var R=[T,C,A],L={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},j=0,D=R;j<D.length;j++){var B=D[j];B.didParseCell&&L.didParseCell.push(B.didParseCell),B.willDrawCell&&L.willDrawCell.push(B.willDrawCell),B.didDrawCell&&L.didDrawCell.push(B.didDrawCell),B.willDrawPage&&L.willDrawPage.push(B.willDrawPage),B.didDrawPage&&L.didDrawPage.push(B.didDrawPage)}return L}function x(T,C){var A,R,L,j,D,B,z,U,I,F,q,O,$=(0,p.parseSpacing)(C.margin,40/T.scaleFactor()),Z=(A=y(T,C.startY))!==null&&A!==void 0?A:$.top,P;C.showFoot===!0?P="everyPage":C.showFoot===!1?P="never":P=(R=C.showFoot)!==null&&R!==void 0?R:"everyPage";var W;C.showHead===!0?W="everyPage":C.showHead===!1?W="never":W=(L=C.showHead)!==null&&L!==void 0?L:"everyPage";var K=(j=C.useCss)!==null&&j!==void 0?j:!1,J=C.theme||(K?"plain":"striped"),H=!!C.horizontalPageBreak,ie=(D=C.horizontalPageBreakRepeat)!==null&&D!==void 0?D:null;return{includeHiddenHtml:(B=C.includeHiddenHtml)!==null&&B!==void 0?B:!1,useCss:K,theme:J,startY:Z,margin:$,pageBreak:(z=C.pageBreak)!==null&&z!==void 0?z:"auto",rowPageBreak:(U=C.rowPageBreak)!==null&&U!==void 0?U:"auto",tableWidth:(I=C.tableWidth)!==null&&I!==void 0?I:"auto",showHead:W,showFoot:P,tableLineWidth:(F=C.tableLineWidth)!==null&&F!==void 0?F:0,tableLineColor:(q=C.tableLineColor)!==null&&q!==void 0?q:200,horizontalPageBreak:H,horizontalPageBreakRepeat:ie,horizontalPageBreakBehaviour:(O=C.horizontalPageBreakBehaviour)!==null&&O!==void 0?O:"afterAllRows"}}function y(T,C){var A=T.getLastAutoTable(),R=T.scaleFactor(),L=T.pageNumber(),j=!1;if(A&&A.startPageNumber){var D=A.startPageNumber+A.pageNumber-1;j=D===L}return typeof C=="number"?C:(C==null||C===!1)&&j&&(A==null?void 0:A.finalY)!=null?A.finalY+20/R:null}function N(T,C,A){var R=C.head||[],L=C.body||[],j=C.foot||[];if(C.html){var D=C.includeHiddenHtml;if(A){var B=(0,d.parseHtml)(T,C.html,A,D,C.useCss)||{};R=B.head||R,L=B.body||R,j=B.foot||R}else console.error("Cannot parse html in non browser environment")}var z=C.columns||S(R,L,j);return{columns:z,head:R,body:L,foot:j}}function S(T,C,A){var R=T[0]||C[0]||A[0]||[],L=[];return Object.keys(R).filter(function(j){return j!=="_element"}).forEach(function(j){var D=1,B;Array.isArray(R)?B=R[parseInt(j)]:B=R[j],typeof B=="object"&&!Array.isArray(B)&&(D=(B==null?void 0:B.colSpan)||1);for(var z=0;z<D;z++){var U=void 0;Array.isArray(R)?U=L.length:U=j+(z>0?"_".concat(z):"");var I={dataKey:U};L.push(I)}}),L}},792:function(o,u){Object.defineProperty(u,"__esModule",{value:!0});function c(h,p,f,g){for(var b=function(y){y&&typeof y!="object"&&console.error("The options parameter should be of type object, is: "+typeof y),typeof y.extendWidth<"u"&&(y.tableWidth=y.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof y.margins<"u"&&(typeof y.margin>"u"&&(y.margin=y.margins),console.error("Use of deprecated option: margins, use margin instead.")),y.startY&&typeof y.startY!="number"&&(console.error("Invalid value for startY option",y.startY),delete y.startY),!y.didDrawPage&&(y.afterPageContent||y.beforePageContent||y.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),y.didDrawPage=function(j){h.applyStyles(h.userStyles),y.beforePageContent&&y.beforePageContent(j),h.applyStyles(h.userStyles),y.afterPageContent&&y.afterPageContent(j),h.applyStyles(h.userStyles),y.afterPageAdd&&j.pageNumber>1&&j.afterPageAdd(j),h.applyStyles(h.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(j){y[j]&&console.error('The "'.concat(j,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(j){var D=j[0],B=j[1];y[B]&&(console.error("Use of deprecated option ".concat(B,". Use ").concat(D," instead")),y[D]=y[B])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(j){var D=typeof j=="string"?j:j[0],B=typeof j=="string"?j:j[1];typeof y[D]<"u"&&(typeof y.styles[B]>"u"&&(y.styles[B]=y[D]),console.error("Use of deprecated option: "+D+", use the style "+B+" instead."))});for(var N=0,S=["styles","bodyStyles","headStyles","footStyles"];N<S.length;N++){var T=S[N];d(y[T]||{})}for(var C=y.columnStyles||{},A=0,R=Object.keys(C);A<R.length;A++){var L=R[A];d(C[L]||{})}},w=0,m=[p,f,g];w<m.length;w++){var x=m[w];b(x)}}u.default=c;function d(h){h.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),h.minCellHeight||(h.minCellHeight=h.rowHeight)):h.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),h.cellWidth||(h.cellWidth=h.columnWidth))}},260:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.Column=u.Cell=u.Row=u.Table=void 0;var d=c(796),h=c(172),p=c(420),f=function(){function m(x,y){this.pageNumber=1,this.pageCount=1,this.id=x.id,this.settings=x.settings,this.styles=x.styles,this.hooks=x.hooks,this.columns=y.columns,this.head=y.head,this.body=y.body,this.foot=y.foot}return m.prototype.getHeadHeight=function(x){return this.head.reduce(function(y,N){return y+N.getMaxCellHeight(x)},0)},m.prototype.getFootHeight=function(x){return this.foot.reduce(function(y,N){return y+N.getMaxCellHeight(x)},0)},m.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},m.prototype.callCellHooks=function(x,y,N,S,T,C){for(var A=0,R=y;A<R.length;A++){var L=R[A],j=new h.CellHookData(x,this,N,S,T,C),D=L(j)===!1;if(N.text=Array.isArray(N.text)?N.text:[N.text],D)return!1}return!0},m.prototype.callEndPageHooks=function(x,y){x.applyStyles(x.userStyles);for(var N=0,S=this.hooks.didDrawPage;N<S.length;N++){var T=S[N];T(new h.HookData(x,this,y))}},m.prototype.callWillDrawPageHooks=function(x,y){for(var N=0,S=this.hooks.willDrawPage;N<S.length;N++){var T=S[N];T(new h.HookData(x,this,y))}},m.prototype.getWidth=function(x){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var y=this.columns.reduce(function(S,T){return S+T.wrappedWidth},0);return y}else{var N=this.settings.margin;return x-N.left-N.right}},m}();u.Table=f;var g=function(){function m(x,y,N,S,T){T===void 0&&(T=!1),this.height=0,this.raw=x,x instanceof d.HtmlRowInput&&(this.raw=x._element,this.element=x._element),this.index=y,this.section=N,this.cells=S,this.spansMultiplePages=T}return m.prototype.getMaxCellHeight=function(x){var y=this;return x.reduce(function(N,S){var T;return Math.max(N,((T=y.cells[S.index])===null||T===void 0?void 0:T.height)||0)},0)},m.prototype.hasRowSpan=function(x){var y=this;return x.filter(function(N){var S=y.cells[N.index];return S?S.rowSpan>1:!1}).length>0},m.prototype.canEntireRowFit=function(x,y){return this.getMaxCellHeight(y)<=x},m.prototype.getMinimumRowHeight=function(x,y){var N=this;return x.reduce(function(S,T){var C=N.cells[T.index];if(!C)return 0;var A=y.getLineHeight(C.styles.fontSize),R=C.padding("vertical"),L=R+A;return L>S?L:S},0)},m}();u.Row=g;var b=function(){function m(x,y,N){var S,T;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=y,this.section=N,this.raw=x;var C=x;x!=null&&typeof x=="object"&&!Array.isArray(x)?(this.rowSpan=x.rowSpan||1,this.colSpan=x.colSpan||1,C=(T=(S=x.content)!==null&&S!==void 0?S:x.title)!==null&&T!==void 0?T:x,x._element&&(this.raw=x._element)):(this.rowSpan=1,this.colSpan=1);var A=C!=null?""+C:"",R=/\r\n|\r|\n/g;this.text=A.split(R)}return m.prototype.getTextPos=function(){var x;if(this.styles.valign==="top")x=this.y+this.padding("top");else if(this.styles.valign==="bottom")x=this.y+this.height-this.padding("bottom");else{var y=this.height-this.padding("vertical");x=this.y+y/2+this.padding("top")}var N;if(this.styles.halign==="right")N=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var S=this.width-this.padding("horizontal");N=this.x+S/2+this.padding("left")}else N=this.x+this.padding("left");return{x:N,y:x}},m.prototype.getContentHeight=function(x,y){y===void 0&&(y=1.15);var N=Array.isArray(this.text)?this.text.length:1,S=this.styles.fontSize/x*y,T=N*S+this.padding("vertical");return Math.max(T,this.styles.minCellHeight)},m.prototype.padding=function(x){var y=(0,p.parseSpacing)(this.styles.cellPadding,0);return x==="vertical"?y.top+y.bottom:x==="horizontal"?y.left+y.right:y[x]},m}();u.Cell=b;var w=function(){function m(x,y,N){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=x,this.raw=y,this.index=N}return m.prototype.getMaxCustomCellWidth=function(x){for(var y=0,N=0,S=x.allRows();N<S.length;N++){var T=S[N],C=T.cells[this.index];C&&typeof C.styles.cellWidth=="number"&&(y=Math.max(y,C.styles.cellWidth))}return y},m}();u.Column=w},356:function(o,u){Object.defineProperty(u,"__esModule",{value:!0}),u.assign=void 0;function c(d,h,p,f,g){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(d),w=1;w<arguments.length;w++){var m=arguments[w];if(m!=null)for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(b[x]=m[x])}return b}u.assign=c},972:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.createTable=void 0;var d=c(744),h=c(260),p=c(324),f=c(796),g=c(356);function b(T,C){var A=new d.DocHandler(T),R=w(C,A.scaleFactor()),L=new h.Table(C,R);return(0,p.calculateWidths)(A,L),A.applyStyles(A.userStyles),L}u.createTable=b;function w(T,C){var A=T.content,R=N(A.columns);if(A.head.length===0){var L=x(R,"head");L&&A.head.push(L)}if(A.foot.length===0){var L=x(R,"foot");L&&A.foot.push(L)}var j=T.settings.theme,D=T.styles;return{columns:R,head:m("head",A.head,R,D,j,C),body:m("body",A.body,R,D,j,C),foot:m("foot",A.foot,R,D,j,C)}}function m(T,C,A,R,L,j){var D={},B=C.map(function(z,U){for(var I=0,F={},q=0,O=0,$=0,Z=A;$<Z.length;$++){var P=Z[$];if(D[P.index]==null||D[P.index].left===0)if(O===0){var W=void 0;Array.isArray(z)?W=z[P.index-q-I]:W=z[P.dataKey];var K={};typeof W=="object"&&!Array.isArray(W)&&(K=(W==null?void 0:W.styles)||{});var J=S(T,P,U,L,R,j,K),H=new h.Cell(W,J,T);F[P.dataKey]=H,F[P.index]=H,O=H.colSpan-1,D[P.index]={left:H.rowSpan-1,times:O}}else O--,q++;else D[P.index].left--,O=D[P.index].times,I++}return new h.Row(z,U,T,F)});return B}function x(T,C){var A={};return T.forEach(function(R){if(R.raw!=null){var L=y(C,R.raw);L!=null&&(A[R.dataKey]=L)}}),Object.keys(A).length>0?A:null}function y(T,C){if(T==="head"){if(typeof C=="object")return C.header||C.title||null;if(typeof C=="string"||typeof C=="number")return C}else if(T==="foot"&&typeof C=="object")return C.footer;return null}function N(T){return T.map(function(C,A){var R,L,j;return typeof C=="object"?j=(L=(R=C.dataKey)!==null&&R!==void 0?R:C.key)!==null&&L!==void 0?L:A:j=A,new h.Column(j,C,A)})}function S(T,C,A,R,L,j,D){var B=(0,f.getTheme)(R),z;T==="head"?z=L.headStyles:T==="body"?z=L.bodyStyles:T==="foot"&&(z=L.footStyles);var U=(0,g.assign)({},B.table,B[T],L.styles,z),I=L.columnStyles[C.dataKey]||L.columnStyles[C.index]||{},F=T==="body"?I:{},q=T==="body"&&A%2===0?(0,g.assign)({},B.alternateRow,L.alternateRowStyles):{},O=(0,f.defaultStyles)(j),$=(0,g.assign)({},O,U,q,F);return(0,g.assign)($,D)}},664:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.addPage=u.drawTable=void 0;var d=c(420),h=c(260),p=c(744),f=c(356),g=c(136),b=c(224);function w(I,F){var q=F.settings,O=q.startY,$=q.margin,Z={x:$.left,y:O},P=F.getHeadHeight(F.columns)+F.getFootHeight(F.columns),W=O+$.bottom+P;if(q.pageBreak==="avoid"){var K=F.body,J=K.reduce(function(ue,ce){return ue+ce.height},0);W+=J}var H=new p.DocHandler(I);(q.pageBreak==="always"||q.startY!=null&&W>H.pageSize().height)&&(U(H),Z.y=$.top),F.callWillDrawPageHooks(H,Z);var ie=(0,f.assign)({},Z);F.startPageNumber=H.pageNumber(),q.horizontalPageBreak?m(H,F,ie,Z):(H.applyStyles(H.userStyles),(q.showHead==="firstPage"||q.showHead==="everyPage")&&F.head.forEach(function(ue){return L(H,F,ue,Z,F.columns)}),H.applyStyles(H.userStyles),F.body.forEach(function(ue,ce){var pe=ce===F.body.length-1;R(H,F,ue,pe,ie,Z,F.columns)}),H.applyStyles(H.userStyles),(q.showFoot==="lastPage"||q.showFoot==="everyPage")&&F.foot.forEach(function(ue){return L(H,F,ue,Z,F.columns)})),(0,d.addTableBorder)(H,F,ie,Z),F.callEndPageHooks(H,Z),F.finalY=Z.y,I.lastAutoTable=F,I.previousAutoTable=F,I.autoTable&&(I.autoTable.previous=F),H.applyStyles(H.userStyles)}u.drawTable=w;function m(I,F,q,O){var $=(0,b.calculateAllColumnsCanFitInPage)(I,F),Z=F.settings;if(Z.horizontalPageBreakBehaviour==="afterAllRows")$.forEach(function(J,H){I.applyStyles(I.userStyles),H>0?z(I,F,q,O,J.columns,!0):x(I,F,O,J.columns),y(I,F,q,O,J.columns),S(I,F,O,J.columns)});else for(var P=-1,W=$[0],K=function(){var J=P;if(W){I.applyStyles(I.userStyles);var H=W.columns;P>=0?z(I,F,q,O,H,!0):x(I,F,O,H),J=N(I,F,P+1,O,H),S(I,F,O,H)}var ie=J-P;$.slice(1).forEach(function(ue){I.applyStyles(I.userStyles),z(I,F,q,O,ue.columns,!0),N(I,F,P+1,O,ue.columns,ie),S(I,F,O,ue.columns)}),P=J};P<F.body.length-1;)K()}function x(I,F,q,O){var $=F.settings;I.applyStyles(I.userStyles),($.showHead==="firstPage"||$.showHead==="everyPage")&&F.head.forEach(function(Z){return L(I,F,Z,q,O)})}function y(I,F,q,O,$){I.applyStyles(I.userStyles),F.body.forEach(function(Z,P){var W=P===F.body.length-1;R(I,F,Z,W,q,O,$)})}function N(I,F,q,O,$,Z){I.applyStyles(I.userStyles),Z=Z??F.body.length;var P=Math.min(q+Z,F.body.length),W=-1;return F.body.slice(q,P).forEach(function(K,J){var H=q+J===F.body.length-1,ie=B(I,F,H,O);K.canEntireRowFit(ie,$)&&(L(I,F,K,O,$),W=q+J)}),W}function S(I,F,q,O){var $=F.settings;I.applyStyles(I.userStyles),($.showFoot==="lastPage"||$.showFoot==="everyPage")&&F.foot.forEach(function(Z){return L(I,F,Z,q,O)})}function T(I,F,q){var O=q.getLineHeight(I.styles.fontSize),$=I.padding("vertical"),Z=Math.floor((F-$)/O);return Math.max(0,Z)}function C(I,F,q,O){var $={};I.spansMultiplePages=!0,I.height=0;for(var Z=0,P=0,W=q.columns;P<W.length;P++){var K=W[P],J=I.cells[K.index];if(J){Array.isArray(J.text)||(J.text=[J.text]);var H=new h.Cell(J.raw,J.styles,J.section);H=(0,f.assign)(H,J),H.text=[];var ie=T(J,F,O);J.text.length>ie&&(H.text=J.text.splice(ie,J.text.length));var ue=O.scaleFactor(),ce=O.getLineHeightFactor();J.contentHeight=J.getContentHeight(ue,ce),J.contentHeight>=F&&(J.contentHeight=F,H.styles.minCellHeight-=F),J.contentHeight>I.height&&(I.height=J.contentHeight),H.contentHeight=H.getContentHeight(ue,ce),H.contentHeight>Z&&(Z=H.contentHeight),$[K.index]=H}}var pe=new h.Row(I.raw,-1,I.section,$,!0);pe.height=Z;for(var ve=0,De=q.columns;ve<De.length;ve++){var K=De[ve],H=pe.cells[K.index];H&&(H.height=pe.height);var J=I.cells[K.index];J&&(J.height=I.height)}return pe}function A(I,F,q,O){var $=I.pageSize().height,Z=O.settings.margin,P=Z.top+Z.bottom,W=$-P;F.section==="body"&&(W-=O.getHeadHeight(O.columns)+O.getFootHeight(O.columns));var K=F.getMinimumRowHeight(O.columns,I),J=K<q;if(K>W)return console.error("Will not be able to print row ".concat(F.index," correctly since it's minimum height is larger than page height")),!0;if(!J)return!1;var H=F.hasRowSpan(O.columns),ie=F.getMaxCellHeight(O.columns)>W;return ie?(H&&console.error("The content of row ".concat(F.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(H||O.settings.rowPageBreak==="avoid")}function R(I,F,q,O,$,Z,P){var W=B(I,F,O,Z);if(q.canEntireRowFit(W,P))L(I,F,q,Z,P);else if(A(I,q,W,F)){var K=C(q,W,F,I);L(I,F,q,Z,P),z(I,F,$,Z,P),R(I,F,K,O,$,Z,P)}else z(I,F,$,Z,P),R(I,F,q,O,$,Z,P)}function L(I,F,q,O,$){O.x=F.settings.margin.left;for(var Z=0,P=$;Z<P.length;Z++){var W=P[Z],K=q.cells[W.index];if(!K){O.x+=W.width;continue}I.applyStyles(K.styles),K.x=O.x,K.y=O.y;var J=F.callCellHooks(I,F.hooks.willDrawCell,K,q,W,O);if(J===!1){O.x+=W.width;continue}j(I,K,O);var H=K.getTextPos();(0,g.default)(K.text,H.x,H.y,{halign:K.styles.halign,valign:K.styles.valign,maxWidth:Math.ceil(K.width-K.padding("left")-K.padding("right"))},I.getDocument()),F.callCellHooks(I,F.hooks.didDrawCell,K,q,W,O),O.x+=W.width}O.y+=q.height}function j(I,F,q){var O=F.styles;if(I.getDocument().setFillColor(I.getDocument().getFillColor()),typeof O.lineWidth=="number"){var $=(0,d.getFillStyle)(O.lineWidth,O.fillColor);$&&I.rect(F.x,q.y,F.width,F.height,$)}else typeof O.lineWidth=="object"&&(O.fillColor&&I.rect(F.x,q.y,F.width,F.height,"F"),D(I,F,q,O.lineWidth))}function D(I,F,q,O){var $,Z,P,W;O.top&&($=q.x,Z=q.y,P=q.x+F.width,W=q.y,O.right&&(P+=.5*O.right),O.left&&($-=.5*O.left),K(O.top,$,Z,P,W)),O.bottom&&($=q.x,Z=q.y+F.height,P=q.x+F.width,W=q.y+F.height,O.right&&(P+=.5*O.right),O.left&&($-=.5*O.left),K(O.bottom,$,Z,P,W)),O.left&&($=q.x,Z=q.y,P=q.x,W=q.y+F.height,O.top&&(Z-=.5*O.top),O.bottom&&(W+=.5*O.bottom),K(O.left,$,Z,P,W)),O.right&&($=q.x+F.width,Z=q.y,P=q.x+F.width,W=q.y+F.height,O.top&&(Z-=.5*O.top),O.bottom&&(W+=.5*O.bottom),K(O.right,$,Z,P,W));function K(J,H,ie,ue,ce){I.getDocument().setLineWidth(J),I.getDocument().line(H,ie,ue,ce,"S")}}function B(I,F,q,O){var $=F.settings.margin.bottom,Z=F.settings.showFoot;return(Z==="everyPage"||Z==="lastPage"&&q)&&($+=F.getFootHeight(F.columns)),I.pageSize().height-O.y-$}function z(I,F,q,O,$,Z){$===void 0&&($=[]),Z===void 0&&(Z=!1),I.applyStyles(I.userStyles),F.settings.showFoot==="everyPage"&&!Z&&F.foot.forEach(function(W){return L(I,F,W,O,$)}),F.callEndPageHooks(I,O);var P=F.settings.margin;(0,d.addTableBorder)(I,F,q,O),U(I),F.pageNumber++,F.pageCount++,O.x=P.left,O.y=P.top,q.y=P.top,F.callWillDrawPageHooks(I,O),F.settings.showHead==="everyPage"&&(F.head.forEach(function(W){return L(I,F,W,O,$)}),I.applyStyles(I.userStyles))}u.addPage=z;function U(I){var F=I.pageNumber();I.setPage(F+1);var q=I.pageNumber();return q===F?(I.addPage(),!0):!1}},224:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.calculateAllColumnsCanFitInPage=void 0;var d=c(420);function h(f,g,b){var w;b===void 0&&(b={});var m=(0,d.getPageAvailableWidth)(f,g),x=new Map,y=[],N=[],S=[];g.settings.horizontalPageBreakRepeat,Array.isArray(g.settings.horizontalPageBreakRepeat)?S=g.settings.horizontalPageBreakRepeat:(typeof g.settings.horizontalPageBreakRepeat=="string"||typeof g.settings.horizontalPageBreakRepeat=="number")&&(S=[g.settings.horizontalPageBreakRepeat]),S.forEach(function(R){var L=g.columns.find(function(j){return j.dataKey===R||j.index===R});L&&!x.has(L.index)&&(x.set(L.index,!0),y.push(L.index),N.push(g.columns[L.index]),m-=L.wrappedWidth)});for(var T=!0,C=(w=b==null?void 0:b.start)!==null&&w!==void 0?w:0;C<g.columns.length;){if(x.has(C)){C++;continue}var A=g.columns[C].wrappedWidth;if(T||m>=A)T=!1,y.push(C),N.push(g.columns[C]),m-=A;else break;C++}return{colIndexes:y,columns:N,lastIndex:C-1}}function p(f,g){for(var b=[],w=0;w<g.columns.length;w++){var m=h(f,g,{start:w});m.columns.length&&(b.push(m),w=m.lastIndex)}return b}u.calculateAllColumnsCanFitInPage=p},324:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.ellipsize=u.resizeColumns=u.calculateWidths=void 0;var d=c(420);function h(y,N){p(y,N);var S=[],T=0;N.columns.forEach(function(A){var R=A.getMaxCustomCellWidth(N);R?A.width=R:(A.width=A.wrappedWidth,S.push(A)),T+=A.width});var C=N.getWidth(y.pageSize().width)-T;C&&(C=f(S,C,function(A){return Math.max(A.minReadableWidth,A.minWidth)})),C&&(C=f(S,C,function(A){return A.minWidth})),C=Math.abs(C),!N.settings.horizontalPageBreak&&C>.1/y.scaleFactor()&&(C=C<1?C:Math.round(C),console.warn("Of the table content, ".concat(C," units width could not fit page"))),b(N),w(N,y),g(N)}u.calculateWidths=h;function p(y,N){var S=y.scaleFactor(),T=N.settings.horizontalPageBreak,C=(0,d.getPageAvailableWidth)(y,N);N.allRows().forEach(function(A){for(var R=0,L=N.columns;R<L.length;R++){var j=L[R],D=A.cells[j.index];if(D){var B=N.hooks.didParseCell;N.callCellHooks(y,B,D,A,j,null);var z=D.padding("horizontal");D.contentWidth=(0,d.getStringWidth)(D.text,D.styles,y)+z;var U=(0,d.getStringWidth)(D.text.join(" ").split(/[^\S\u00A0]+/),D.styles,y);if(D.minReadableWidth=U+D.padding("horizontal"),typeof D.styles.cellWidth=="number")D.minWidth=D.styles.cellWidth,D.wrappedWidth=D.styles.cellWidth;else if(D.styles.cellWidth==="wrap"||T===!0)D.contentWidth>C?(D.minWidth=C,D.wrappedWidth=C):(D.minWidth=D.contentWidth,D.wrappedWidth=D.contentWidth);else{var I=10/S;D.minWidth=D.styles.minCellWidth||I,D.wrappedWidth=D.contentWidth,D.minWidth>D.wrappedWidth&&(D.wrappedWidth=D.minWidth)}}}}),N.allRows().forEach(function(A){for(var R=0,L=N.columns;R<L.length;R++){var j=L[R],D=A.cells[j.index];if(D&&D.colSpan===1)j.wrappedWidth=Math.max(j.wrappedWidth,D.wrappedWidth),j.minWidth=Math.max(j.minWidth,D.minWidth),j.minReadableWidth=Math.max(j.minReadableWidth,D.minReadableWidth);else{var B=N.styles.columnStyles[j.dataKey]||N.styles.columnStyles[j.index]||{},z=B.cellWidth||B.minCellWidth;z&&typeof z=="number"&&(j.minWidth=z,j.wrappedWidth=z)}D&&(D.colSpan>1&&!j.minWidth&&(j.minWidth=D.minWidth),D.colSpan>1&&!j.wrappedWidth&&(j.wrappedWidth=D.minWidth))}})}function f(y,N,S){for(var T=N,C=y.reduce(function(I,F){return I+F.wrappedWidth},0),A=0;A<y.length;A++){var R=y[A],L=R.wrappedWidth/C,j=T*L,D=R.width+j,B=S(R),z=D<B?B:D;N-=z-R.width,R.width=z}if(N=Math.round(N*1e10)/1e10,N){var U=y.filter(function(I){return N<0?I.width>S(I):!0});U.length&&(N=f(U,N,S))}return N}u.resizeColumns=f;function g(y){for(var N={},S=1,T=y.allRows(),C=0;C<T.length;C++)for(var A=T[C],R=0,L=y.columns;R<L.length;R++){var j=L[R],D=N[j.index];if(S>1)S--,delete A.cells[j.index];else if(D)D.cell.height+=A.height,S=D.cell.colSpan,delete A.cells[j.index],D.left--,D.left<=1&&delete N[j.index];else{var B=A.cells[j.index];if(!B)continue;if(B.height=A.height,B.rowSpan>1){var z=T.length-C,U=B.rowSpan>z?z:B.rowSpan;N[j.index]={cell:B,left:U,row:A}}}}}function b(y){for(var N=y.allRows(),S=0;S<N.length;S++)for(var T=N[S],C=null,A=0,R=0,L=0;L<y.columns.length;L++){var j=y.columns[L];if(R-=1,R>1&&y.columns[L+1])A+=j.width,delete T.cells[j.index];else if(C){var D=C;delete T.cells[j.index],C=null,D.width=j.width+A}else{var D=T.cells[j.index];if(!D)continue;if(R=D.colSpan,A=0,D.colSpan>1){C=D,A+=j.width;continue}D.width=j.width+A}}}function w(y,N){for(var S={count:0,height:0},T=0,C=y.allRows();T<C.length;T++){for(var A=C[T],R=0,L=y.columns;R<L.length;R++){var j=L[R],D=A.cells[j.index];if(D){N.applyStyles(D.styles,!0);var B=D.width-D.padding("horizontal");if(D.styles.overflow==="linebreak")D.text=N.splitTextToSize(D.text,B+1/N.scaleFactor(),{fontSize:D.styles.fontSize});else if(D.styles.overflow==="ellipsize")D.text=m(D.text,B,D.styles,N,"...");else if(D.styles.overflow==="hidden")D.text=m(D.text,B,D.styles,N,"");else if(typeof D.styles.overflow=="function"){var z=D.styles.overflow(D.text,B);typeof z=="string"?D.text=[z]:D.text=z}D.contentHeight=D.getContentHeight(N.scaleFactor(),N.getLineHeightFactor());var U=D.contentHeight/D.rowSpan;D.rowSpan>1&&S.count*S.height<U*D.rowSpan?S={height:U,count:D.rowSpan}:S&&S.count>0&&S.height>U&&(U=S.height),U>A.height&&(A.height=U)}}S.count--}}function m(y,N,S,T,C){return y.map(function(A){return x(A,N,S,T,C)})}u.ellipsize=m;function x(y,N,S,T,C){var A=1e4*T.scaleFactor();if(N=Math.ceil(N*A)/A,N>=(0,d.getStringWidth)(y,S,T))return y;for(;N<(0,d.getStringWidth)(y+C,S,T)&&!(y.length<=1);)y=y.substring(0,y.length-1);return y.trim()+C}},964:function(o){if(typeof n>"u"){var u=new Error("Cannot find module 'undefined'");throw u.code="MODULE_NOT_FOUND",u}o.exports=n}},r={};function i(o){var u=r[o];if(u!==void 0)return u.exports;var c=r[o]={exports:{}};return a[o].call(c.exports,c,c.exports,i),c.exports}var s={};return function(){var o=s;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var u=i(340),c=i(776),d=i(664),h=i(972),p=i(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return p.Table}});var f=i(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return f.CellHookData}});var g=i(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return g.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return g.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return g.Row}});function b(N){(0,u.default)(N)}o.applyPlugin=b;function w(N,S){var T=(0,c.parseInput)(N,S),C=(0,h.createTable)(N,T);(0,d.drawTable)(N,C)}function m(N,S){var T=(0,c.parseInput)(N,S);return(0,h.createTable)(N,T)}o.__createTable=m;function x(N,S){(0,d.drawTable)(N,S)}o.__drawTable=x;try{var y=i(964);y.jsPDF&&(y=y.jsPDF),b(y)}catch{}o.default=w}(),s}()})})(GH);const KH=({employee:e,onClose:t,onGenerated:n,issuedByUserId:a})=>{if(!e||!e.name||!a)return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 text-center",children:[l.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Data Tidak Lengkap"}),l.jsxs("p",{className:"text-gray-700 mb-6",children:["Tidak dapat menampilkan form surat peringatan.",l.jsx("br",{}),"Pastikan data karyawan dan user pengeluar surat sudah benar."]}),l.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded-lg",children:"Tutup"})]})});const[r,i]=ae.useState("SP1"),[s,o]=ae.useState(""),[u,c]=ae.useState(""),[d,h]=ae.useState(!1),[p,f]=ae.useState(null),[g,b]=ae.useState(!1),w=[{value:"SP1",label:"Surat Peringatan 1",color:"yellow"},{value:"SP2",label:"Surat Peringatan 2",color:"orange"},{value:"SP3",label:"Surat Peringatan 3",color:"red"},{value:"termination",label:"Surat Pemberhentian",color:"red"}],m=["Keterlambatan berulang","Tidak hadir tanpa keterangan","Melanggar peraturan perusahaan","Kinerja tidak memuaskan","Tidak mengikuti prosedur kerja","Pelanggaran disiplin kerja"],x=async()=>{if(!s.trim()){ct.fire({icon:"warning",title:"Alasan wajib diisi",text:"Alasan peringatan harus diisi."});return}if(!a){ct.fire({icon:"error",title:"Gagal",text:"Tidak dapat menentukan pengguna yang mengeluarkan surat."});return}h(!0);try{const{data:C,error:A}=await Te.rpc("generate_warning_letter",{p_user_id:e.id,p_warning_type:r,p_reason:s,p_description:u,p_issued_by:a});if(A)throw A;const{data:R,error:L}=await Te.from("warning_letters").select("*").eq("id",C).single();if(L)throw L;f(R),n&&n(R),b(!0)}catch(C){console.error("Error generating warning letter:",C),ct.fire({icon:"error",title:"Gagal",text:"Gagal membuat surat peringatan: "+C.message})}finally{h(!1)}},y=()=>{if(!p){ct.fire({icon:"error",title:"Gagal",text:"Surat belum digenerate."});return}try{const C=new xt;C.setFontSize(16),C.setFont("helvetica","bold"),C.text("PT. COMPANY NAME",105,20,{align:"center"}),C.setFontSize(12),C.setFont("helvetica","normal"),C.text("Jl. Contoh Alamat No. 123, Jakarta Selatan",105,28,{align:"center"}),C.text("Telp: (021) 1234-5678 | Email: info@company.com",105,34,{align:"center"}),C.setLineWidth(.5),C.line(20,38,190,38),C.setFontSize(14),C.setFont("helvetica","bold"),C.text(`SURAT PERINGATAN ${p.warning_type}`,105,50,{align:"center"}),C.setFontSize(12),C.text(`Nomor: ${p.letter_number}`,105,58,{align:"center"}),C.setFontSize(12),C.setFont("helvetica","normal"),C.text("Kepada Yth:",20,70),C.text(`Nama: ${e.name}`,20,78),C.text(`Jabatan: ${e.title||"Karyawan"}`,20,86),C.text(`Departemen: ${e.department||"-"}`,20,94),C.text(`Tanggal: ${new Date(p.issue_date).toLocaleDateString("id-ID")}`,20,102),C.text("Dengan ini kami memberikan surat peringatan dengan alasan:",20,116);const A=C.splitTextToSize(p.reason,150);C.setFont("helvetica","bold"),C.text(A,30,124);let R=124+A.length*8;if(p.description){C.setFont("helvetica","normal");const D=C.splitTextToSize(p.description,150);C.text(D,20,R),R+=D.length*8+8}else R+=16;C.setFont("helvetica","normal");const j=C.splitTextToSize("Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama. Apabila pelanggaran ini terulang kembali, maka perusahaan akan mengambil tindakan lebih lanjut sesuai dengan peraturan perusahaan yang berlaku.",170);C.text(j,20,R),R+=j.length*8+16,C.text("Demikian surat peringatan ini dibuat untuk dapat diperhatikan dan dilaksanakan dengan sebaik-baiknya.",20,R),R+=24,C.text("Hormat kami,",20,R),C.text("Manajemen Perusahaan",20,R+8),R+=40,C.text("_____________________",20,R),C.text("Tanda Tangan & Stempel",20,R+8),C.text("Diterima oleh,",140,R-40),C.text("Karyawan",140,R-32),C.text("_____________________",140,R),C.text(`(${e.name})`,140,R+8),C.save(`SP_${p.warning_type}_${e.name}_${p.letter_number.replace(/\//g,"_")}.pdf`)}catch(C){console.error("Error generating PDF:",C),alert("Gagal membuat file PDF: "+C.message)}},N=()=>{if(!p)return;const C=`
SURAT PERINGATAN ${p.warning_type}
Nomor: ${p.letter_number}

Kepada: ${e.name}
Jabatan: ${e.title||"Karyawan"}
Tanggal: ${new Date(p.issue_date).toLocaleDateString("id-ID")}

Dengan ini kami memberikan surat peringatan ${p.warning_type} atas:
${p.reason}

${p.description}

Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama.

Apabila pelanggaran ini terulang kembali, maka perusahaan akan mengambil tindakan lebih lanjut sesuai dengan peraturan perusahaan yang berlaku.

Demikian surat peringatan ini dibuat untuk dapat diperhatikan dan dilaksanakan dengan sebaik-baiknya.

Hormat kami,
Manajemen Perusahaan


_____________________
Tanda Tangan & Stempel
    `,A=new Blob([C],{type:"text/plain"}),R=URL.createObjectURL(A),L=document.createElement("a");L.href=R,L.download=`SP_${p.warning_type}_${e.name}_${p.letter_number.replace(/\//g,"_")}.txt`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(R)},S=C=>{const A=w.find(R=>R.value===C);return(A==null?void 0:A.color)||"gray"},T=()=>{if(!p)return;const C=window.open("","_blank");C.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Surat Peringatan ${p.warning_type}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 40px;
            line-height: 1.5;
          }
          .header {
            text-align: center;
            margin-bottom: 30px;
          }
          .company-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .company-address {
            font-size: 14px;
            margin-bottom: 5px;
          }
          .divider {
            border-top: 2px solid #000;
            margin: 20px 0;
          }
          .letter-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .letter-number {
            text-align: center;
            font-size: 14px;
            margin-bottom: 30px;
          }
          .recipient {
            margin-bottom: 20px;
          }
          .content {
            margin-bottom: 30px;
          }
          .reason {
            margin-left: 20px;
            font-weight: bold;
            margin-bottom: 20px;
          }
          .description {
            margin-bottom: 20px;
          }
          .warning {
            margin-bottom: 30px;
          }
          .closing {
            margin-bottom: 30px;
          }
          .signature {
            display: flex;
            justify-content: space-between;
          }
          .signature-block {
            width: 45%;
          }
          .signature-line {
            border-top: 1px solid #000;
            margin-top: 50px;
            width: 80%;
          }
          @media print {
            .no-print {
              display: none;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">PT. COMPANY NAME</div>
          <div class="company-address">Jl. Contoh Alamat No. 123, Jakarta Selatan</div>
          <div class="company-address">Telp: (021) 1234-5678 | Email: info@company.com</div>
        </div>
        
        <div class="divider"></div>
        
        <div class="letter-title">SURAT PERINGATAN ${p.warning_type}</div>
        <div class="letter-number">Nomor: ${p.letter_number}</div>
        
        <div class="recipient">
          <div>Kepada Yth:</div>
          <div>Nama: ${e.name}</div>
          <div>Jabatan: ${e.title||"Karyawan"}</div>
          <div>Departemen: ${e.department||"-"}</div>
          <div>Tanggal: ${new Date(p.issue_date).toLocaleDateString("id-ID")}</div>
        </div>
        
        <div class="content">
          <div>Dengan ini kami memberikan surat peringatan dengan alasan:</div>
          <div class="reason">${p.reason}</div>
          
          ${p.description?`<div class="description">${p.description}</div>`:""}
          
          <div class="warning">
            Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama. 
            Apabila pelanggaran ini terulang kembali, maka perusahaan akan mengambil tindakan lebih lanjut 
            sesuai dengan peraturan perusahaan yang berlaku.
          </div>
          
          <div class="closing">
            Demikian surat peringatan ini dibuat untuk dapat diperhatikan dan dilaksanakan dengan sebaik-baiknya.
          </div>
        </div>
        
        <div class="signature">
          <div class="signature-block">
            <div>Hormat kami,</div>
            <div>Manajemen Perusahaan</div>
            <div class="signature-line"></div>
            <div>Tanda Tangan & Stempel</div>
          </div>
          
          <div class="signature-block">
            <div>Diterima oleh,</div>
            <div>Karyawan</div>
            <div class="signature-line"></div>
            <div>(${e.name})</div>
          </div>
        </div>
        
        <div class="no-print" style="text-align: center; margin-top: 30px;">
          <button onclick="window.print()" style="padding: 10px 20px; background: #4F46E5; color: white; border: none; border-radius: 5px; cursor: pointer;">
            Print Surat Peringatan
          </button>
        </div>
      </body>
      </html>
    `),C.document.close(),C.onload=function(){C.focus(),setTimeout(()=>{C.print()},500)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(El,{className:"h-6 w-6 text-red-600"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Buat Surat Peringatan"})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Si,{className:"h-6 w-6"})})]}),g?l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(El,{className:"h-6 w-6 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-green-800 font-medium",children:"Surat Peringatan Berhasil Dibuat"}),l.jsxs("p",{className:"text-green-700 text-sm",children:["Nomor: ",p.letter_number]})]})]})}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["SURAT PERINGATAN ",p.warning_type]}),l.jsxs("p",{className:"text-gray-600",children:["Nomor: ",p.letter_number]})]}),l.jsxs("div",{className:"space-y-4 text-sm",children:[l.jsxs("div",{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Kepada:"})," ",e.name]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Jabatan:"})," ",e.title||"Karyawan"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tanggal:"})," ",new Date(p.issue_date).toLocaleDateString("id-ID")]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsxs("p",{className:"mb-2",children:["Dengan ini kami memberikan surat peringatan ",p.warning_type," atas:"]}),l.jsx("p",{className:"font-medium",children:p.reason})]}),p.description&&l.jsx("div",{className:"border-t pt-4",children:l.jsx("p",{children:p.description})}),l.jsx("div",{className:"border-t pt-4",children:l.jsx("p",{children:"Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama."})})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Tutup"}),l.jsx("button",{onClick:N,className:"px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Xf,{className:"h-4 w-4"}),l.jsx("span",{children:"Download TXT"})]})}),l.jsx("button",{onClick:y,className:"px-4 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:"Download PDF"})]})}),l.jsx("button",{onClick:T,className:"px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(SE,{className:"h-4 w-4"}),l.jsx("span",{children:"Print Surat"})]})}),l.jsx("button",{onClick:()=>ct.fire({icon:"info",title:"Segera Tersedia",text:"Fitur kirim email akan segera tersedia."}),className:"px-4 py-3 bg-yellow-600 text-white rounded-lg font-medium hover:bg-yellow-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(T0,{className:"h-4 w-4"}),l.jsx("span",{children:"Kirim Email"})]})})]})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Informasi Karyawan"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Nama:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Jabatan:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.title||"Karyawan"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Departemen:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.department||"-"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"ID:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.employee_id||"-"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Jenis Peringatan"}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:w.map(C=>l.jsx("button",{type:"button",onClick:()=>i(C.value),className:`p-3 rounded-lg border-2 transition-all text-left ${r===C.value?`border-${C.color}-500 bg-${C.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ln,{className:`h-4 w-4 text-${C.color}-500`}),l.jsx("span",{className:"font-medium",children:C.label})]})},C.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alasan Peringatan *"}),l.jsxs("select",{value:s,onChange:C=>o(C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-2",children:[l.jsx("option",{value:"",children:"Pilih alasan..."}),m.map(C=>l.jsx("option",{value:C,children:C},C)),l.jsx("option",{value:"custom",children:"Alasan lainnya..."})]}),(s==="custom"||!m.includes(s))&&l.jsx("input",{type:"text",value:s==="custom"?"":s,onChange:C=>o(C.target.value),placeholder:"Masukkan alasan peringatan...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Tambahan"}),l.jsx("textarea",{value:u,onChange:C=>c(C.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Jelaskan detail pelanggaran atau tindakan yang diharapkan..."})]}),l.jsx("div",{className:`p-4 rounded-lg border-l-4 border-${S(r)}-500 bg-${S(r)}-50`,children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Ln,{className:`h-5 w-5 text-${S(r)}-600 flex-shrink-0 mt-0.5`}),l.jsxs("div",{children:[l.jsx("p",{className:`text-${S(r)}-800 font-medium`,children:"Peringatan Penting"}),l.jsx("p",{className:`text-${S(r)}-700 text-sm mt-1`,children:"Surat peringatan akan dikirim ke karyawan dan tersimpan dalam sistem. Pastikan informasi yang dimasukkan sudah benar."})]})]})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"button",onClick:x,disabled:!s.trim()||d,className:"flex-1 bg-red-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Membuat Surat..."})]}):l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(xg,{className:"h-4 w-4"}),l.jsx("span",{children:"Buat & Kirim Surat"})]})})]})]})]})})})},ql=({user:e,profile:t,isCollapsed:n,setIsCollapsed:a})=>{const r=hr(),i=Dy(),[s,o]=ae.useState(!1),u=async()=>{try{await Te.auth.signOut(),await window.Swal.fire({icon:"success",title:"Logout Berhasil",text:"Anda telah berhasil logout."}),r("/login")}catch(f){console.error("Failed to log out:",f)}},c=[{title:"Dashboard",icon:l.jsx(_E,{className:"h-5 w-5"}),path:"/admin",active:i.pathname==="/admin"},{title:"Master Data",icon:l.jsx(Zh,{className:"h-5 w-5"}),submenu:[{title:"Kelola Pengguna",icon:l.jsx(U4,{className:"h-5 w-5"}),path:"/admin/users",active:i.pathname==="/admin/users"},{title:"Kelola Departemen",icon:l.jsx(ha,{className:"h-5 w-5"}),path:"/admin/departments",active:i.pathname==="/admin/departments"},{title:"Kelola Jabatan",icon:l.jsx(Gc,{className:"h-5 w-5"}),path:"/admin/positions",active:i.pathname==="/admin/positions"},{title:"Kelola Bank",icon:l.jsx(Zh,{className:"h-5 w-5"}),path:"/admin/bank",active:i.pathname==="/admin/bank"}]},{title:"Kelola Absensi",icon:l.jsx(Du,{className:"h-5 w-5"}),path:"/admin/attendance",active:i.pathname==="/admin/attendance"},{title:"Kelola Pembayaran",icon:l.jsx(xo,{className:"h-5 w-5"}),path:"/admin/salary-payment",active:i.pathname==="/admin/salary-payment"},{title:"Lokasi Kantor",icon:l.jsx(_i,{className:"h-5 w-5"}),path:"/admin/location",active:i.pathname==="/admin/location"}],[d,h]=ae.useState(["Master Data"]),p=f=>{h(g=>g.includes(f)?g.filter(b=>b!==f):[...g,f])};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50 print:hidden",children:l.jsx("button",{onClick:()=>o(!s),className:"p-2 rounded-lg bg-white shadow-lg text-gray-600 hover:bg-gray-200 transition-colors",children:s?l.jsx(Si,{className:"h-6 w-6"}):l.jsx(jE,{className:"h-6 w-6"})})}),l.jsx("div",{className:`lg:hidden fixed inset-0 bg-black/60 z-40 transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>o(!1)}),l.jsx("div",{className:`fixed inset-y-0 left-0 z-40 bg-white shadow-2xl transition-all duration-300 ease-in-out
          ${n?"w-16":"w-64"}
          ${s?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          max-w-xs lg:max-w-none print:hidden
        `,children:l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between h-16 bg-gradient-to-r from-blue-700 to-indigo-600 text-white px-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ha,{className:"h-7 w-7 flex-shrink-0"}),!n&&l.jsx("span",{className:"ml-2 text-lg font-semibold tracking-tight",children:"Admin Panel"})]}),l.jsx("button",{onClick:()=>a(!n),className:"hidden lg:block p-1 rounded-full hover:bg-blue-800 transition-colors",children:l.jsx(Gb,{className:`h-5 w-5 transform transition-transform ${n?"rotate-180":""}`})})]}),l.jsxs("div",{className:`flex items-center ${n?"justify-center py-3":"px-4 py-4"} border-b border-gray-200 bg-gray-50/50`,children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center overflow-hidden",children:t!=null&&t.avatar_url?l.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-full h-full object-cover"}):l.jsx(Al,{className:"h-6 w-6 text-blue-600"})}),!n&&l.jsxs("div",{className:"ml-3 overflow-hidden",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.name)||"Admin"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:(t==null?void 0:t.email)||(e==null?void 0:e.email)})]})]}),l.jsx("nav",{className:"flex-1 overflow-y-auto py-4 px-2 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:l.jsx("ul",{className:"space-y-1",children:c.map(f=>l.jsx("li",{children:f.submenu?l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>p(f.title),className:`w-full flex items-center ${n?"justify-center":"justify-between px-3"} py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200`,children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500",children:f.icon}),!n&&l.jsx("span",{className:"ml-3",children:f.title})]}),!n&&l.jsx(Gb,{className:`h-4 w-4 text-gray-400 transform transition-transform duration-200 ${d.includes(f.title)?"rotate-90":""}`})]}),!n&&d.includes(f.title)&&l.jsx("ul",{className:"ml-4 space-y-1 mt-1",children:f.submenu.map(g=>l.jsx("li",{children:l.jsxs("button",{onClick:()=>{r(g.path),window.innerWidth<1024&&o(!1)},className:`w-full flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200
                                  ${g.active?"text-blue-600 bg-blue-50 font-semibold":"text-gray-600 hover:bg-gray-100"}`,children:[l.jsx("span",{className:`${g.active?"text-blue-600":"text-gray-400"}`,children:g.icon}),l.jsx("span",{className:"ml-3",children:g.title})]})},g.path))})]}):l.jsxs("button",{onClick:()=>{r(f.path),window.innerWidth<1024&&o(!1)},className:`w-full flex items-center ${n?"justify-center":"justify-start px-3"} py-2.5 text-sm font-medium rounded-lg transition-colors duration-200
                        ${f.active?"text-blue-600 bg-blue-50 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx("span",{className:`${f.active?"text-blue-600":"text-gray-500"}`,children:f.icon}),!n&&l.jsx("span",{className:"ml-3",children:f.title})]})},f.title))})}),l.jsx("div",{className:"p-3 border-t border-gray-200",children:l.jsxs("button",{onClick:u,className:`w-full flex items-center ${n?"justify-center":"justify-start px-3"} py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200`,children:[l.jsx(W4,{className:"h-5 w-5"}),!n&&l.jsx("span",{className:"ml-3",children:"Logout"})]})})]})})]})},$H=()=>{var K;const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState({totalUsers:0,totalAttendance:0,todayAttendance:0,activeUsers:0,totalSalaryPaid:0,avgDailySalary:0,lateEmployees:0,activeWarnings:0,totalPositions:0,activeDepartments:0,absentToday:0}),[h,p]=ae.useState([]),[f,g]=ae.useState([]),[b,w]=ae.useState([]),[m,x]=ae.useState({}),[y,N]=ae.useState(!1),[S,T]=ae.useState(null),[C,A]=ae.useState(!1),[R,L]=ae.useState(!1),[j,D]=ae.useState(!1),[B,z]=ae.useState({enabled:!0,required_for_admin:!1});ae.useEffect(()=>{U()},[]);const U=async()=>{try{const{data:{user:J}}=await Te.auth.getUser();if(!J){e("/login");return}const{data:H}=await Te.from("profiles").select("*").eq("id",J.id).single();if(!H||H.role!=="admin"){e("/dashboard");return}n(J),r(H),await I()}catch(J){console.error("Error checking access:",J),e("/login")}finally{s(!1)}},I=async()=>{var J,H;try{const ie=new Date().toISOString().split("T")[0],[ue,ce,pe,ve]=await Promise.all([Te.from("profiles").select("id, role, status",{count:"exact"}),Te.from("attendance").select("id",{count:"exact"}),Te.from("attendance").select("*").gte("timestamp",`${ie}T00:00:00`).lte("timestamp",`${ie}T23:59:59`),Te.from("positions").select("id, department",{count:"exact"})]),{data:De}=await Te.from("profiles").select("id, name, email, avatar_url, employee_id, department, role, status").eq("role","karyawan").eq("status","active"),{data:Re}=await Te.from("attendance").select(`
          *,
          profiles!inner(id, name, email, avatar_url, employee_id, department, role)
        `).gte("timestamp",`${ie}T00:00:00`).lte("timestamp",`${ie}T23:59:59`).eq("status","berhasil"),we=(Re==null?void 0:Re.filter(Xe=>Xe.type==="masuk").map(Xe=>Xe.user_id))||[],xe=(De==null?void 0:De.filter(Xe=>!we.includes(Xe.id)&&Xe.role!=="admin"))||[];if(xe.length>0){const Xe=xe.map(oe=>({user_id:oe.id,type:"absent",timestamp:new Date().toISOString(),status:"tidak_hadir",notes:"Tidak hadir - tidak melakukan absensi masuk",is_late:!1,late_minutes:0,work_hours:0}));await Te.from("attendance").upsert(Xe,{onConflict:"user_id,timestamp",ignoreDuplicates:!0})}const ne=(Re==null?void 0:Re.filter(Xe=>Xe.type==="masuk"&&Xe.is_late))||[],{data:Qe}=await Te.from("employee_salaries").select("daily_salary").eq("is_active",!0),Je=(Qe==null?void 0:Qe.reduce((Xe,oe)=>Xe+oe.daily_salary*22,0))||0,Ae=(Qe==null?void 0:Qe.length)>0?Qe.reduce((Xe,oe)=>Xe+oe.daily_salary,0)/Qe.length:0,{data:Ge}=await Te.from("attendance_warnings").select("id").eq("is_resolved",!1),_e=[...new Set((J=ve.data)==null?void 0:J.map(Xe=>Xe.department).filter(Boolean))];d({totalUsers:ue.count||0,totalAttendance:ce.count||0,todayAttendance:we.length,activeUsers:((H=ue.data)==null?void 0:H.filter(Xe=>Xe.status==="active").length)||0,totalSalaryPaid:Je,avgDailySalary:Ae,lateEmployees:ne.length,activeWarnings:(Ge==null?void 0:Ge.length)||0,totalPositions:ve.count||0,activeDepartments:_e.length,absentToday:xe.length}),g(ne),w(xe);const{data:de}=await Te.from("attendance").select(`
          *,
          profiles!inner(name, role, department, avatar_url, employee_id)
        `).order("timestamp",{ascending:!1}).limit(15);p(de||[]);const{data:ke}=await Te.from("system_settings").select("*"),Fe={};ke==null||ke.forEach(Xe=>{Fe[Xe.setting_key]=Xe.setting_value}),x(Fe);const Ze=ke==null?void 0:ke.find(Xe=>Xe.setting_key==="camera_verification");Ze!=null&&Ze.setting_value&&z(Ze.setting_value)}catch(ie){console.error("Error fetching dashboard data:",ie)}},F=async()=>{try{const{error:J}=await Te.from("system_settings").upsert({setting_key:"camera_verification",setting_value:{...B,updated_by:t.id,updated_at:new Date().toISOString()},description:"Controls whether face verification is required for attendance",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(J)throw J;await ct.fire({icon:"success",title:"Berhasil",text:"Pengaturan verifikasi kamera berhasil disimpan!"}),D(!1)}catch(J){console.error("Error saving camera settings:",J),await ct.fire({icon:"error",title:"Gagal",text:"Gagal menyimpan pengaturan verifikasi kamera"})}},q=J=>{T(J),N(!0)},O=async J=>{N(!1),await ct.fire({icon:"success",title:"Surat Peringatan",text:`Surat peringatan ${J.warning_type} berhasil dibuat dan dikirim ke ${S.name}`}),I()},$=async J=>{J?(T(J),A(!0)):(console.error("Attempted to view details for a null/undefined employee."),await ct.fire({icon:"error",title:"Gagal",text:"Gagal menampilkan detail: data karyawan tidak ditemukan."}))},Z=async(J,H,ie,ue)=>{try{await Te.from("notifications").insert([{user_id:J,admin_id:t.id,type:H,title:ie,message:ue,data:{timestamp:new Date().toISOString(),sent_by:a.name},is_read:!1}])}catch(ce){console.error("Error sending notification:",ce)}},P=async J=>{var H;try{await Z(J.user_id||J.id,"late_warning","Peringatan Keterlambatan",`Anda terlambat ${J.late_minutes} menit hari ini. Harap lebih memperhatikan kedisiplinan waktu.`),await ct.fire({icon:"success",title:"Notifikasi Dikirim",text:`Notifikasi peringatan telah dikirim ke ${((H=J.profiles)==null?void 0:H.name)||J.name}`})}catch{await ct.fire({icon:"error",title:"Gagal",text:"Gagal mengirim notifikasi"})}},W=async J=>{try{await Z(J.id,"absence_warning","Peringatan Ketidakhadiran","Anda tidak hadir hari ini tanpa keterangan. Harap segera menghubungi atasan atau HR."),await ct.fire({icon:"success",title:"Notifikasi Dikirim",text:`Notifikasi peringatan telah dikirim ke ${J.name}`})}catch{await ct.fire({icon:"error",title:"Gagal",text:"Gagal mengirim notifikasi"})}};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat dashboard admin..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(ql,{user:t,profile:a,isCollapsed:o,setIsCollapsed:u}),l.jsxs("div",{className:`flex-1 transition-all duration-300 ease-in-out 
          ${o?"lg:ml-16":"lg:ml-64"} 
          pt-16 lg:pt-0`,children:[l.jsx("div",{className:"bg-white shadow-sm border-b fixed top-0 left-0 right-0 lg:relative z-30",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between py-3 lg:py-4",children:[l.jsx("div",{className:"lg:hidden"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"Dashboard Admin"}),l.jsx("p",{className:"hidden md:block text-sm text-gray-600",children:"Ringkasan aktivitas dan statistik sistem"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{onClick:()=>D(!0),className:"p-2 lg:px-3 lg:py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:[l.jsx(vg,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden lg:inline ml-2",children:"Pengaturan"})]}),l.jsxs("button",{onClick:()=>L(!0),className:"p-2 lg:px-3 lg:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[l.jsx(Xf,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden lg:inline ml-2",children:"Export"})]}),l.jsx(uA,{userId:t==null?void 0:t.id,userRole:a==null?void 0:a.role})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-8",children:[l.jsx(tg,{icon:Al,title:"Karyawan",value:c.totalUsers,footer:`${c.activeUsers} aktif`,color:"blue"}),l.jsx(tg,{icon:Vt,title:"Hadir",value:c.todayAttendance,footer:`${c.absentToday} absen`,color:"green"}),l.jsx(tg,{icon:Ln,title:"Terlambat",value:c.lateEmployees,footer:"Hari ini",color:"orange"}),l.jsx(tg,{icon:lo,title:"Peringatan",value:c.activeWarnings,footer:"Aktif",color:"red"})]}),(f.length>0||b.length>0)&&l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[f.length>0&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-orange-50",children:l.jsxs("h2",{className:"text-lg font-medium text-orange-900",children:["Karyawan Terlambat Hari Ini (",f.length,")"]})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-3",children:f.slice(0,5).map(J=>{var H;return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:l.jsx(ar,{className:"h-4 w-4 text-orange-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:(H=J.profiles)==null?void 0:H.name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Terlambat ",J.late_minutes," menit"]})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>$(J.profiles),className:"text-blue-600 hover:text-blue-800 p-1",title:"Lihat Detail",children:l.jsx(Wb,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>P(J),className:"text-orange-600 hover:text-orange-800 p-1",title:"Kirim Peringatan",children:l.jsx(lo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>q(J.profiles),className:"text-red-600 hover:text-red-800 p-1",title:"Buat SP",children:l.jsx(El,{className:"h-4 w-4"})})]})]},J.id)})})})]}),b.length>0&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-red-50",children:l.jsxs("h2",{className:"text-lg font-medium text-red-900",children:["Karyawan Tidak Hadir Hari Ini (",b.length,")"]})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-3",children:b.slice(0,5).map(J=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:l.jsx(ar,{className:"h-4 w-4 text-red-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:J.name}),l.jsx("p",{className:"text-sm text-gray-600",children:J.department||"Tidak ada departemen"})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>$(J),className:"text-blue-600 hover:text-blue-800 p-1",title:"Lihat Detail",children:l.jsx(Wb,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>W(J),className:"text-red-600 hover:text-red-800 p-1",title:"Kirim Peringatan",children:l.jsx(lo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>q(J),className:"text-red-600 hover:text-red-800 p-1",title:"Buat SP",children:l.jsx(El,{className:"h-4 w-4"})})]})]},J.id))})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zh,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Informasi Sistem"})]})}),l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Zh,{className:"h-8 w-8 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Database"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Supabase PostgreSQL"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Xi,{className:"h-8 w-8 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Jam Kerja"}),l.jsx("p",{className:"text-sm text-gray-600",children:"08:00 - 17:00"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(_i,{className:"h-8 w-8 text-purple-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Radius Kantor"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[((K=m.office_location)==null?void 0:K.radius)||100," meter"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(kd,{className:"h-8 w-8 text-orange-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Verifikasi Wajah"}),l.jsx("p",{className:"text-sm text-gray-600",children:B.enabled?"Aktif":"Nonaktif"})]})]})]})})]})]})]}),y&&S&&l.jsx(KH,{employee:S,onClose:()=>N(!1),onGenerated:O,issuedByUserId:t.id}),R&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Export Database"}),l.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-blue-50 p-6 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx(Zh,{className:"h-8 w-8 text-blue-600 flex-shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Export Database Supabase"}),l.jsx("p",{className:"text-blue-700 mb-4",children:"Untuk mengekspor seluruh database Supabase termasuk skema, data, dan storage, ikuti langkah-langkah berikut:"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"1. Akses Dashboard Supabase"}),l.jsxs("p",{className:"text-sm text-blue-700",children:["Login ke dashboard Supabase project Anda di ",l.jsx("a",{href:"https://app.supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"app.supabase.com"})]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"2. Buka Menu Database"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Pilih menu "Database" → "Backups" dari sidebar'})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"3. Generate Backup"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Klik tombol "Generate backup" untuk membuat backup terbaru dari database Anda'})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"4. Download Backup"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Setelah backup selesai dibuat, klik tombol "Download" untuk mengunduh file SQL'})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"5. Export Storage (Opsional)"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Untuk mengekspor file storage (seperti foto wajah), gunakan menu "Storage" dan download setiap bucket secara terpisah'})]})]})]})]})}),l.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Catatan Penting"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Backup database berisi semua data sensitif. Pastikan untuk menyimpannya dengan aman dan tidak membagikannya kepada pihak yang tidak berwenang."})]})]})}),l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:()=>L(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Tutup"})})]})]})})}),j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pengaturan Sistem"}),l.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Verifikasi Kamera"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"camera-enabled",checked:B.enabled,onChange:J=>z(H=>({...H,enabled:J.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{htmlFor:"camera-enabled",className:"ml-2 block text-sm text-gray-900",children:"Aktifkan verifikasi wajah untuk absensi"})]}),l.jsx("div",{className:"p-3 bg-white rounded-lg",children:l.jsx("p",{className:"text-sm text-gray-600",children:B.enabled?"Karyawan harus melakukan verifikasi wajah saat absensi":"Karyawan dapat absensi tanpa verifikasi wajah"})}),l.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(Ln,{className:"h-4 w-4 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-yellow-700",children:"Menonaktifkan verifikasi wajah akan mengurangi keamanan sistem absensi, tetapi dapat berguna jika terjadi masalah dengan kamera atau perangkat."})]})})]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Batal"}),l.jsx("button",{onClick:F,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Pengaturan"})]})})]})]})]})})})]})},tg=({icon:e,title:t,value:n,footer:a,color:r})=>{const i={blue:{bg:"bg-blue-50",text:"text-blue-700"},green:{bg:"bg-green-50",text:"text-green-700"},orange:{bg:"bg-orange-50",text:"text-orange-700"},red:{bg:"bg-red-50",text:"text-red-700"}},s=i[r]||i.blue;return l.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-10 h-10 ${s.bg} rounded-full flex items-center justify-center`,children:l.jsx(e,{className:`h-5 w-5 ${s.text}`})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700",children:t}),l.jsx("p",{className:"text-xl font-bold text-gray-900",children:n}),l.jsx("p",{className:`text-xs ${s.text}`,children:a})]})]})})},YH=({profile:e,onClose:t})=>e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative animate-fadeIn",children:[l.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-2xl",children:"×"}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("img",{src:e.avatar_url||"/default-bank.png",alt:"Avatar",className:"w-28 h-28 rounded-full border-4 border-blue-200 shadow mb-4 object-cover"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:e.name}),l.jsx("p",{className:"text-gray-500 mb-2",children:e.position||e.title||"-"}),l.jsx("p",{className:"text-gray-400 mb-4",children:e.department||"-"}),l.jsx("div",{className:"w-full border-t pt-4 mt-4",children:l.jsxs("div",{className:"flex flex-col gap-2 text-sm text-gray-700",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Email:"})," ",e.email]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"No. Pegawai:"})," ",e.employee_id||"-"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Telepon:"})," ",e.phone||"-"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Alamat:"})," ",e.address||"-"]})]})})]})]})}):null,XH=()=>{const e=hr(),[t,n]=ae.useState([]),[a,r]=ae.useState([]),[i,s]=ae.useState([]),[o,u]=ae.useState(!0),[c,d]=ae.useState(!1),[h,p]=ae.useState(!1);ae.useState(!1);const[f,g]=ae.useState("add"),[b,w]=ae.useState(""),[m,x]=ae.useState(""),[y,N]=ae.useState(""),[S,T]=ae.useState(null),[C,A]=ae.useState(null),[R,L]=ae.useState(!1),[j,D]=ae.useState({id:"",name:"",email:"",password:"",phone:"",location:"",title:"",bio:"",role:"karyawan",position_id:"",employee_id:"",department:"",salary:0,bank_id:"",bank_account_number:"",bank_account_name:"",status:"active"}),[B,z]=ae.useState(null),[U,I]=ae.useState(null),[F,q]=ae.useState(1),[O,$]=ae.useState(!1),[Z,P]=ae.useState(null),[W,K]=ae.useState(null);ae.useEffect(()=>{J()},[]);const J=async()=>{try{const{data:{user:oe}}=await Te.auth.getUser();if(!oe){e("/login");return}const{data:Be}=await Te.from("profiles").select("role").eq("id",oe.id).single();if(!Be||Be.role!=="admin"){e("/dashboard");return}T(oe),A(Be),await Promise.all([H(),ie(),ue()])}catch(oe){console.error("Error checking access:",oe),e("/login")}finally{u(!1)}},H=async()=>{d(!0);try{const{data:oe,error:Be}=await Te.from("profiles").select(`
          *,
          positions(name_id, department, base_salary),
          bank_info(bank_name, bank_logo)
        `).order("created_at",{ascending:!1});if(Be)throw Be;n(oe||[])}catch(oe){console.error("Error fetching users:",oe),P("Gagal memuat data pengguna")}finally{d(!1)}},ie=async()=>{try{const{data:oe,error:Be}=await Te.from("positions").select("*").eq("is_active",!0).order("name_id");if(Be)throw Be;r(oe||[])}catch(oe){console.error("Error fetching positions:",oe)}},ue=async()=>{try{const{data:oe,error:Be}=await Te.from("bank_info").select("*").eq("is_active",!0).order("bank_name");if(Be)throw Be;s(oe||[])}catch(oe){console.error("Error fetching banks:",oe)}},ce=oe=>{const{name:Be,value:Ke}=oe.target;if(Be==="position_id"){const et=a.find(He=>He.id===Ke);if(et){const He=et.name_id.substring(0,3).toUpperCase(),wt=Date.now().toString().slice(-4),dt=f==="add"?`${He}${wt}`:j.employee_id;D(_n=>({..._n,position_id:Ke,title:et.name_id,department:et.department||"",salary:et.base_salary||0,employee_id:dt}))}else D(He=>({...He,position_id:Ke,title:"",department:"",salary:0,employee_id:""}))}else D(Be==="name"||Be==="full_name"?et=>({...et,[Be]:Ke,bank_account_name:Ke}):et=>({...et,[Be]:Ke}))},pe=(oe,Be)=>{z(oe),I(Be),console.log("✅ Face captured",{photoBlob:oe,fingerprint:Be})},ve=oe=>{if(oe.preventDefault(),f==="add"&&j.password.length<6){ct.fire({icon:"error",title:"Gagal",text:"Password minimal 6 karakter"});return}if(!j.position_id){ct.fire({icon:"error",title:"Gagal",text:"Silakan pilih jabatan"});return}j.role==="admin"||f==="edit"?f==="add"?De():Re():q(2)},De=async()=>{if(j.role!=="admin"&&!B){ct.fire({icon:"error",title:"Gagal",text:"Silakan ambil foto wajah terlebih dahulu"});return}if(j.role!=="admin"&&!U){ct.fire({icon:"error",title:"Gagal",text:"Fingerprint wajah tidak terdeteksi, silakan ulangi pengambilan foto."});return}$(!0);try{const{data:oe,error:Be}=await Te.auth.signUp({email:j.email,password:j.password,options:{data:{name:j.name,role:j.role}}});if(Be)throw Be;if(!oe.user)throw new Error("Pendaftaran gagal");const Ke=oe.user.id;let et=null;if(j.role!=="admin"&&B){const Rt=`${Ke}-face-${Date.now()}.jpg`;await Yg(B,"face-photos",Rt),et=Xg("face-photos",Rt)}const He={id:Ke,name:j.name,full_name:j.name,email:j.email,phone:j.phone,location:j.location,title:j.title,bio:j.bio||`${Ae(j.role)} di sistem absensi`,avatar_url:et,role:j.role,position_id:j.position_id,employee_id:j.employee_id,department:j.department,salary:j.salary,bank_id:j.bank_id||null,bank_account_number:j.bank_account_number||null,bank_account_name:j.bank_account_name||j.name,is_face_registered:j.role==="admin"?!0:!!et,status:"active",join_date:new Date().toISOString().split("T")[0],contract_start_date:new Date().toISOString().split("T")[0],contract_type:"permanent",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:wt}=await Te.from("profiles").insert([He]);if(wt){const{error:Rt}=await Te.from("profiles").update(He).eq("id",Ke);if(Rt)throw new Error("Gagal membuat profil user")}const dt={user_id:Ke,daily_salary:j.salary/22,overtime_rate:1.5,bonus:0,deduction:0,effective_date:new Date().toISOString().split("T")[0],is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:_n}=await Te.from("employee_salaries").insert([dt]);ct.fire({icon:"success",title:"Berhasil",html:`<b>${j.name}</b> (${Ae(j.role)}) berhasil ditambahkan!`,showConfirmButton:!0}),ne(),await H()}catch(oe){ct.fire({icon:"error",title:"Gagal",text:oe.message||"Terjadi kesalahan saat membuat user"})}finally{$(!1)}},Re=async()=>{$(!0);try{let oe=j.avatar_url;if(j.role!=="admin"&&B){const wt=`${j.id}-face-${Date.now()}.jpg`;await Yg(B,"face-photos",wt),oe=Xg("face-photos",wt)}const Be={name:j.name,full_name:j.name,email:j.email,phone:j.phone,location:j.location,title:j.title,bio:j.bio||`${Ae(j.role)} di sistem absensi`,avatar_url:oe,role:j.role,position_id:j.position_id,employee_id:j.employee_id,department:j.department,salary:j.salary,bank_id:j.bank_id||null,bank_account_number:j.bank_account_number||null,bank_account_name:j.bank_account_name||j.name,is_face_registered:j.role==="admin"?!0:!!oe,status:j.status,updated_at:new Date().toISOString()},{error:Ke}=await Te.from("profiles").update(Be).eq("id",j.id);if(Ke)throw Ke;const et={user_id:j.id,daily_salary:j.salary/22,overtime_rate:1.5,bonus:0,deduction:0,effective_date:new Date().toISOString().split("T")[0],is_active:!0,updated_at:new Date().toISOString()},{error:He}=await Te.from("employee_salaries").update(et).eq("user_id",j.id).eq("is_active",!0);if(He&&!He.message.includes("0 rows")){const{error:wt}=await Te.from("employee_salaries").insert([et]);if(wt)throw wt}ct.fire({icon:"success",title:"Berhasil",html:`<b>${j.name}</b> berhasil diperbarui!`,showConfirmButton:!0}),ne(),await H()}catch(oe){ct.fire({icon:"error",title:"Gagal",text:oe.message||"Terjadi kesalahan saat memperbarui user"})}finally{$(!1)}},we=async()=>{if(j.password.length<6){ct.fire({icon:"error",title:"Gagal",text:"Password baru minimal 6 karakter"});return}$(!0);try{const oe=await fetch("https://<your-project-ref>.supabase.co/functions/v1/reset-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Te.auth.getSession().then(({data:Ke})=>{var et;return(et=Ke.session)==null?void 0:et.access_token})}`},body:JSON.stringify({user_id:j.id,new_password:j.password,admin_id:S.id})}),Be=await oe.json();if(!oe.ok)throw new Error(Be.error||"Gagal mereset password");ct.fire({icon:"success",title:"Berhasil",text:`Password untuk ${j.name} berhasil diperbarui!`,showConfirmButton:!0}),ne()}catch(oe){ct.fire({icon:"error",title:"Gagal",text:oe.message||"Terjadi kesalahan saat mereset password"})}finally{$(!1)}},xe=async(oe,Be,Ke)=>{const et=Be==="active"?"inactive":"active",He=et==="active"?"mengaktifkan":"menonaktifkan";if((await ct.fire({title:`${et==="active"?"Aktifkan":"Nonaktifkan"} User?`,text:`Apakah Anda yakin ingin ${He} user ${Ke}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:`Ya, ${He}`,cancelButtonText:"Batal"})).isConfirmed){d(!0);try{const{error:dt}=await Te.from("profiles").update({status:et,updated_at:new Date().toISOString()}).eq("id",oe);if(dt)throw dt;await H(),ct.fire({icon:"success",title:"Berhasil",text:`User ${Ke} berhasil ${et==="active"?"diaktifkan":"dinonaktifkan"}`})}catch{ct.fire({icon:"error",title:"Gagal",text:`Gagal ${He} user`})}finally{d(!1)}}},ne=()=>{D({id:"",name:"",email:"",password:"",phone:"",location:"",title:"",bio:"",role:"karyawan",position_id:"",employee_id:"",department:"",salary:0,bank_id:"",bank_account_number:"",bank_account_name:"",status:"active"}),z(null),I(null),q(1),p(!1),g("add"),P(null),K(null)},Qe=oe=>{var Be,Ke,et;D({id:oe.id,name:oe.name,email:oe.email,phone:oe.phone||"",location:oe.location||"",title:oe.title||((Be=oe.positions)==null?void 0:Be.name_id)||"",bio:oe.bio||"",role:oe.role,position_id:oe.position_id||"",employee_id:oe.employee_id||"",department:oe.department||((Ke=oe.positions)==null?void 0:Ke.department)||"",salary:oe.salary||((et=oe.positions)==null?void 0:et.base_salary)||0,bank_id:oe.bank_id||"",bank_account_number:oe.bank_account_number||"",bank_account_name:oe.bank_account_name||oe.name,status:oe.status||"active",avatar_url:oe.avatar_url||""}),z(null),I(null),g("edit"),q(1),p(!0)},Je=oe=>{D({id:oe.id,name:oe.name,email:oe.email,password:"",phone:"",location:"",title:"",bio:"",role:oe.role,position_id:"",employee_id:"",department:"",salary:0,bank_id:"",bank_account_number:"",bank_account_name:"",status:oe.status}),g("password"),p(!0)},Ae=oe=>{switch(oe){case"admin":return"Administrator";case"karyawan":return"Karyawan";default:return"Karyawan"}},Ge=oe=>{switch(oe){case"admin":return l.jsx(Wc,{className:"h-4 w-4"});default:return l.jsx(ar,{className:"h-4 w-4"})}},_e=oe=>{switch(oe){case"admin":return"bg-blue-100 text-blue-800";default:return"bg-green-100 text-green-800"}},de=oe=>oe==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",ke=oe=>(S==null?void 0:S.id)!==oe,Fe=oe=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(oe),Ze=()=>[...new Set(t.map(Be=>{var Ke;return Be.department||((Ke=Be.positions)==null?void 0:Ke.department)}).filter(Boolean))],Xe=t.filter(oe=>{var He,wt,dt;const Be=((He=oe.name)==null?void 0:He.toLowerCase().includes(b.toLowerCase()))||((wt=oe.email)==null?void 0:wt.toLowerCase().includes(b.toLowerCase()))||oe.employee_id&&oe.employee_id.toLowerCase().includes(b.toLowerCase()),Ke=m===""||oe.department===m||((dt=oe.positions)==null?void 0:dt.department)===m,et=y===""||oe.role===y;return Be&&Ke&&et});return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data pengguna..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row",children:[l.jsx(ql,{user:S,profile:C,className:"w-full md:w-64 md:fixed md:h-screen"}),l.jsxs("div",{className:"flex-1 md:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Pengguna"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, reset password, dan kelola status pengguna sistem"})]}),l.jsxs("button",{onClick:()=>{g("add"),p(!0)},className:"flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[l.jsx(R0,{className:"h-5 w-5"}),l.jsx("span",{children:"Tambah User"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[W&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:W}),l.jsx("button",{onClick:()=>K(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),Z&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:Z}),l.jsx("button",{onClick:()=>P(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative",children:[l.jsx(Hd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari berdasarkan nama, email, atau ID karyawan...",value:b,onChange:oe=>w(oe.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("div",{className:"w-full sm:w-40",children:l.jsxs("select",{value:m,onChange:oe=>x(oe.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),Ze().map(oe=>l.jsx("option",{value:oe,children:oe},oe))]})}),l.jsx("div",{className:"w-full sm:w-40",children:l.jsxs("select",{value:y,onChange:oe=>N(oe.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Role"}),l.jsx("option",{value:"karyawan",children:"Karyawan"}),l.jsx("option",{value:"admin",children:"Administrator"})]})})]})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Al,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base font-medium text-gray-900",children:["Daftar Pengguna (",Xe.length,")"]})]})}),c?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):Xe.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ar,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada pengguna ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau filter Anda"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pengguna"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jabatan & Departemen"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gaji"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kontak"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role & Status"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Xe.map(oe=>{var Be,Ke,et;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:oe.avatar_url?l.jsx("img",{src:oe.avatar_url,alt:oe.name,className:"w-8 h-8 rounded-full object-cover"}):l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${_e(oe.role)}`,children:Ge(oe.role)})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.jsx("span",{className:"cursor-pointer text-blue-700 hover:underline",onClick:()=>{A(oe),L(!0)},children:oe.name})}),l.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",oe.employee_id||"Belum diatur"]})]})]})}),l.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Be=oe.positions)==null?void 0:Be.name_id)||oe.title||Ae(oe.role)}),l.jsx("div",{className:"text-sm text-gray-500",children:((Ke=oe.positions)==null?void 0:Ke.department)||oe.department||"Belum diatur"})]}),l.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:Fe(((et=oe.positions)==null?void 0:et.base_salary)||oe.salary||0)}),l.jsx("div",{className:"text-sm text-gray-500",children:"per bulan"})]}),l.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[l.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[l.jsx(T0,{className:"h-4 w-4 mr-2 text-gray-400"}),l.jsx("span",{className:"cursor-pointer text-blue-700 hover:underline",onClick:()=>{A(oe),L(!0)},children:oe.email})]}),oe.phone&&l.jsxs("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[l.jsx(G4,{className:"h-4 w-4 mr-2 text-gray-400"}),oe.phone]})]}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"space-y-1",children:[l.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${_e(oe.role)}`,children:[oe.role==="admin"&&l.jsx(Wc,{className:"h-3 w-3 mr-1"}),Ae(oe.role)]}),l.jsx("div",{className:"text-xs text-gray-500",children:l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${de(oe.status)}`,children:oe.status==="active"?"Aktif":"Nonaktif"})}),oe.bank_info&&l.jsx("div",{className:"text-xs text-gray-500",children:l.jsxs("span",{className:"text-blue-600",children:["Bank: ",oe.bank_info.bank_name]})})]})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:l.jsx("div",{className:"flex space-x-2",children:ke(oe.id)?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Qe(oe),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit User",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>Je(oe),className:"text-yellow-600 hover:text-yellow-900 p-1 hover:bg-yellow-50 rounded",title:"Reset Password",children:l.jsx(ml,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>xe(oe.id,oe.status,oe.name),className:"text-purple-600 hover:text-purple-900 p-1 hover:bg-purple-50 rounded",title:oe.status==="active"?"Nonaktifkan":"Aktifkan",children:oe.status==="active"?l.jsx(j5,{className:"h-4 w-4"}):l.jsx(C5,{className:"h-4 w-4"})})]}):l.jsx("span",{className:"text-gray-400 text-xs",children:"Akun Anda"})})})]},oe.id)})})]}),l.jsx("div",{className:"md:hidden p-4 space-y-4",children:Xe.map(oe=>{var Be,Ke,et;return l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-5 border border-gray-100 transition-transform transform hover:scale-[1.02]",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:oe.avatar_url?l.jsx("img",{src:oe.avatar_url,alt:oe.name,className:"w-12 h-12 rounded-full object-cover"}):l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${_e(oe.role)}`,children:Ge(oe.role)})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-base font-semibold text-gray-900 cursor-pointer text-blue-700 hover:underline",onClick:()=>{A(oe),L(!0)},children:oe.name}),l.jsx("p",{className:"text-sm text-gray-600",children:((Be=oe.positions)==null?void 0:Be.name_id)||oe.title||Ae(oe.role)})]})]}),l.jsx("div",{className:"flex space-x-2",children:ke(oe.id)?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Qe(oe),className:"text-blue-600 hover:text-blue-900 p-2 rounded-full hover:bg-blue-50",children:l.jsx(ji,{className:"h-6 w-6"})}),l.jsx("button",{onClick:()=>Je(oe),className:"text-yellow-600 hover:text-yellow-900 p-2 rounded-full hover:bg-yellow-50",children:l.jsx(ml,{className:"h-6 w-6"})}),l.jsx("button",{onClick:()=>xe(oe.id,oe.status,oe.name),className:"text-purple-600 hover:text-purple-900 p-2 rounded-full hover:bg-purple-50",children:oe.status==="active"?l.jsx(j5,{className:"h-6 w-6"}):l.jsx(C5,{className:"h-6 w-6"})})]}):l.jsx("span",{className:"text-gray-400 text-sm",children:"Akun Anda"})})]}),l.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"ID:"})," ",oe.employee_id||"Belum diatur"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Departemen:"})," ",((Ke=oe.positions)==null?void 0:Ke.department)||oe.department||"Belum diatur"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Gaji:"})," ",Fe(((et=oe.positions)==null?void 0:et.base_salary)||oe.salary||0)]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Email:"})," ",oe.email]}),oe.phone&&l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Telepon:"})," ",oe.phone]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Role:"})," ",l.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${_e(oe.role)}`,children:[oe.role==="admin"&&l.jsx(Wc,{className:"h-4 w-4 mr-1"}),Ae(oe.role)]})]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${de(oe.status)}`,children:oe.status==="active"?"Aktif":"Nonaktif"})]}),oe.bank_info&&l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Bank:"})," ",oe.bank_info.bank_name]})]})]},oe.id)})})]})]}),R&&l.jsx(YH,{profile:C,onClose:()=>L(!1)})]})]}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md sm:max-w-lg bg-white rounded-xl shadow-2xl max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-5 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:f==="add"?"Tambah Pengguna Baru":f==="edit"?"Edit Pengguna":"Reset Password"}),l.jsx("button",{onClick:ne,className:"text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100",children:l.jsx(Si,{className:"h-6 w-6"})})]}),f!=="password"&&l.jsx("div",{className:"flex items-center justify-center mb-4",children:[1,2].map(oe=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${F>=oe?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:F>oe?l.jsx(Vt,{className:"h-5 w-5"}):oe}),oe<2&&l.jsx("div",{className:`w-10 h-1 mx-2 ${F>oe?"bg-blue-600":"bg-gray-200"}`})]},oe))}),f==="password"?l.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),we()},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Pengguna"}),l.jsx("input",{type:"text",value:j.name,readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Baru *"}),l.jsx("input",{type:"password",name:"password",value:j.password,onChange:ce,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Minimal 6 karakter"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:ne,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Batal"}),l.jsx("button",{type:"submit",disabled:O,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(ml,{className:"h-5 w-5"}),l.jsx("span",{children:"Reset Password"})]})})]})]}):F===1?l.jsxs("form",{onSubmit:ve,className:"space-y-4",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Pilih Jabatan"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jabatan *"}),l.jsxs("select",{name:"position_id",value:j.position_id,onChange:ce,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Pilih Jabatan..."}),a.map(oe=>l.jsxs("option",{value:oe.id,children:[oe.name_id," - ",oe.department," (",Fe(oe.base_salary||0),")"]},oe.id))]})]}),j.position_id&&l.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Karyawan"}),l.jsx("input",{type:"text",value:j.employee_id,readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gaji Bulanan"}),l.jsx("input",{type:"text",value:Fe(j.salary),readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap *"}),l.jsx("input",{type:"text",name:"name",value:j.name,onChange:ce,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Masukkan nama lengkap"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),l.jsx("input",{type:"email",name:"email",value:j.email,onChange:ce,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Masukkan email"})]})]}),f==="add"&&l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),l.jsx("input",{type:"password",name:"password",value:j.password,onChange:ce,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Minimal 6 karakter"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),l.jsxs("select",{name:"role",value:j.role,onChange:ce,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"karyawan",children:"Karyawan"}),l.jsx("option",{value:"admin",children:"Administrator"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No. Telepon"}),l.jsx("input",{type:"tel",name:"phone",value:j.phone,onChange:ce,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: +62-21-1234567"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lokasi"}),l.jsx("input",{type:"text",name:"location",value:j.location,onChange:ce,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: Jakarta, Indonesia"})]})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-green-900 mb-3",children:"Informasi Bank (Opsional)"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Bank"}),l.jsxs("select",{name:"bank_id",value:j.bank_id,onChange:ce,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Pilih Bank..."}),i.map(oe=>l.jsx("option",{value:oe.id,children:oe.bank_name},oe.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor Rekening"}),l.jsx("input",{type:"text",name:"bank_account_number",value:j.bank_account_number,onChange:ce,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Nomor rekening"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Pemilik Rekening"}),l.jsx("input",{type:"text",value:j.bank_account_name,readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm",placeholder:"Otomatis sesuai nama lengkap"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),l.jsx("textarea",{name:"bio",value:j.bio,onChange:ce,rows:4,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Deskripsi singkat tentang pengguna"})]}),f==="edit"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),l.jsxs("select",{name:"status",value:j.status,onChange:ce,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"active",children:"Aktif"}),l.jsx("option",{value:"inactive",children:"Nonaktif"})]})]}),j.role==="admin"&&l.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Wc,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Administrator"}),l.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Administrator tidak memerlukan verifikasi wajah dan dapat langsung mengakses semua fitur sistem."})]})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:ne,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Batal"}),l.jsx("button",{type:"submit",disabled:O,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-5 w-5"}),l.jsx("span",{children:f==="add"&&j.role==="admin"?"Buat Administrator":f==="add"?"Lanjut ke Foto Wajah":"Perbarui Pengguna"})]})})]})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center mb-4",children:[l.jsx(kd,{className:"h-12 w-12 text-blue-600 mx-auto mb-2"}),l.jsx("p",{className:"text-gray-600 text-sm",children:"Ambil foto wajah yang jelas untuk verifikasi absensi. Sistem kami menggunakan teknologi pengenalan wajah yang aman dan cepat."})]}),l.jsx(Ev,{onFaceCapture:pe,isCapturing:O}),B&&U&&l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 text-green-600 mb-4",children:[l.jsx(Vt,{className:"h-5 w-5"}),l.jsx("span",{children:"Foto wajah berhasil diambil dan diverifikasi!"})]})}),B&&!U&&l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 text-yellow-600 mb-4",children:[l.jsx(Ln,{className:"h-5 w-5"}),l.jsx("span",{children:"Fingerprint wajah tidak terdeteksi, silakan ulangi pengambilan foto."})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3",children:[l.jsx("button",{onClick:()=>q(1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Kembali"}),l.jsx("button",{onClick:f==="add"?De:Re,disabled:!B||!U||O,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsx("div",{className:"flex items-center justify-center space-x-2",children:O?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Yr,{className:"h-5 w-5"}),l.jsx("span",{children:f==="add"?"Buat Pengguna":"Perbarui Pengguna"})]})})})]})]})]})})})]})},JH=({employee:e,onClose:t,onPaymentProcessed:n})=>{var S;const[a,r]=ae.useState(!1),[i,s]=ae.useState(null),[o,u]=ae.useState(null),[c,d]=ae.useState([]),[h,p]=ae.useState(!1),[f,g]=ae.useState({amount:0,payment_method:"bank_transfer",payment_reference:"",payment_period_start:new Date().toISOString().split("T")[0],payment_period_end:new Date().toISOString().split("T")[0],notes:""});ae.useEffect(()=>{var T;if(e){let C=0;(T=e.positions)!=null&&T.base_salary?C=e.positions.base_salary:e.employee_salaries&&e.employee_salaries.length>0?C=e.employee_salaries[0].daily_salary*22||0:C=e.salary||0,g(A=>({...A,amount:C,notes:`Gaji bulan ${new Date().toLocaleString("id-ID",{month:"long",year:"numeric"})} untuk ${e.name}`})),b()}},[e]);const b=async()=>{if(e)try{const{data:T,error:C}=await Te.from("salary_payments").select("*").eq("user_id",e.id).order("payment_date",{ascending:!1}).limit(5);if(C)throw C;d(T||[])}catch(T){console.error("Error fetching payment history:",T)}},w=T=>{const{name:C,value:A}=T.target;g({...f,[C]:A})},m=async T=>{var C,A,R,L,j;T.preventDefault(),r(!0),s(null),u(null);try{if(!e){ct.fire({icon:"error",title:"Gagal",text:"Karyawan tidak ditemukan"});return}if(!f.amount||f.amount<=0){ct.fire({icon:"warning",title:"Jumlah tidak valid",text:"Jumlah pembayaran harus lebih dari 0"});return}if(f.payment_method==="bank_transfer"&&(!e.bank_info||!e.bank_account_number)){ct.fire({icon:"warning",title:"Rekening belum diatur",text:"Karyawan belum mengatur rekening bank. Gunakan metode pembayaran lain atau minta karyawan untuk mengatur rekening bank."});return}const{data:D,error:B}=await Te.from("salary_payments").insert([{user_id:e.id,salary_id:(A=(C=e.employee_salaries)==null?void 0:C[0])==null?void 0:A.id,payment_date:new Date().toISOString().split("T")[0],payment_amount:parseFloat(f.amount),payment_method:f.payment_method,payment_status:"completed",payment_reference:f.payment_reference,payment_period_start:f.payment_period_start,payment_period_end:f.payment_period_end,notes:f.notes,created_by:(R=(await Te.auth.getUser()).data.user)==null?void 0:R.id,payment_details:{processed_at:new Date().toISOString(),payment_method_details:f.payment_method==="bank_transfer"?{bank_name:(L=e.bank_info)==null?void 0:L.bank_name,account_number:e.bank_account_number}:{method:f.payment_method}}}]).select();if(B)throw B;if(e.employee_salaries&&e.employee_salaries.length>0){const{error:z}=await Te.from("employee_salaries").update({payment_status:"paid",last_payment_date:new Date().toISOString().split("T")[0],payment_notes:f.notes,updated_at:new Date().toISOString()}).eq("id",e.employee_salaries[0].id);z&&console.error("Error updating salary status:",z)}else{const z=N()/22,{error:U}=await Te.from("employee_salaries").insert([{user_id:e.id,daily_salary:z,overtime_rate:1.5,effective_date:new Date().toISOString().split("T")[0],payment_status:"paid",last_payment_date:new Date().toISOString().split("T")[0],payment_notes:f.notes,is_active:!0}]);U&&console.error("Error creating salary record:",U)}try{await Te.from("notifications").insert([{user_id:e.id,admin_id:(j=(await Te.auth.getUser()).data.user)==null?void 0:j.id,type:"salary_info",title:"Pembayaran Gaji",message:`Gaji Anda sebesar ${x(f.amount)} telah dibayarkan melalui ${f.payment_method==="bank_transfer"?"transfer bank":f.payment_method==="cash"?"tunai":"metode lainnya"}.`,data:{payment_id:D[0].id,amount:f.amount,payment_date:new Date().toISOString().split("T")[0],payment_method:f.payment_method},is_read:!1}])}catch(z){console.error("Error sending notification:",z)}u(`Pembayaran gaji sebesar ${x(f.amount)} untuk ${e.name} berhasil diproses!`),ct.fire({icon:"success",title:"Berhasil",text:`Pembayaran gaji sebesar ${x(f.amount)} untuk ${e.name} berhasil diproses!`}),await b(),n&&n({employeeId:e.id,amount:f.amount,paymentMethod:f.payment_method,paymentDate:new Date().toISOString()}),setTimeout(()=>{u(null),g({amount:0,payment_method:"bank_transfer",payment_reference:"",payment_period_start:new Date().toISOString().split("T")[0],payment_period_end:new Date().toISOString().split("T")[0],notes:""})},3e3)}catch(D){console.error("Error processing payment:",D),ct.fire({icon:"error",title:"Gagal",text:D.message||"Gagal memproses pembayaran"})}finally{r(!1)}},x=T=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(T),y=T=>new Date(T).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),N=()=>{var T;return(T=e.positions)!=null&&T.base_salary?e.positions.base_salary:e.employee_salaries&&e.employee_salaries.length>0?(e.employee_salaries[0].daily_salary||0)*22:e.salary||0};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full bg-white rounded-xl shadow-lg max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Proses Pembayaran Gaji"}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Si,{className:"h-6 w-6"})})]}),o&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-green-700 font-medium",children:"Pembayaran Berhasil!"}),l.jsx("p",{className:"text-green-600 text-sm mt-1",children:o})]})]}),i&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Pembayaran Gagal"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:i})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Informasi Karyawan"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ar,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Nama"}),l.jsx("p",{className:"font-medium text-blue-900",children:e.name})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Gc,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Jabatan"}),l.jsx("p",{className:"font-medium text-blue-900",children:((S=e.positions)==null?void 0:S.name_id)||e.title||"Karyawan"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ha,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Departemen"}),l.jsx("p",{className:"font-medium text-blue-900",children:e.department||"-"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(kf,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Gaji Bulanan"}),l.jsx("p",{className:"font-medium text-blue-900",children:x(N())})]})]})]})]}),l.jsxs("div",{className:`p-4 rounded-lg ${e.bank_info?"bg-green-50":"bg-yellow-50"}`,children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Informasi Rekening"}),e.bank_info?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ha,{className:"h-5 w-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Bank"}),l.jsx("p",{className:"font-medium text-gray-900",children:e.bank_info.bank_name})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(xo,{className:"h-5 w-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Nomor Rekening"}),l.jsx("p",{className:"font-medium text-gray-900",children:e.bank_account_number})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ar,{className:"h-5 w-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Atas Nama"}),l.jsx("p",{className:"font-medium text-gray-900",children:e.bank_account_name||e.name})]})]})]}):l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-yellow-500"}),l.jsx("p",{className:"text-yellow-700",children:"Karyawan belum mengatur informasi rekening bank"})]})]}),l.jsxs("form",{onSubmit:m,children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Detail Pembayaran"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jumlah Pembayaran (IDR) *"}),l.jsxs("div",{className:"relative",children:[l.jsx(kf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"number",name:"amount",value:f.amount,onChange:w,required:!0,min:"1",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: 5000000"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Metode Pembayaran *"}),l.jsxs("select",{name:"payment_method",value:f.payment_method,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"bank_transfer",children:"Transfer Bank"}),l.jsx("option",{value:"cash",children:"Tunai"}),l.jsx("option",{value:"other",children:"Lainnya"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referensi Pembayaran"}),l.jsx("input",{type:"text",name:"payment_reference",value:f.payment_reference,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: TRF/2025/06/001"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal Pembayaran"}),l.jsxs("div",{className:"relative",children:[l.jsx(Du,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"date",name:"payment_date",value:new Date().toISOString().split("T")[0],readOnly:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),l.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Periode Awal"}),l.jsx("input",{type:"date",name:"payment_period_start",value:f.payment_period_start,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Periode Akhir"}),l.jsx("input",{type:"date",name:"payment_period_end",value:f.payment_period_end,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catatan"}),l.jsx("textarea",{name:"notes",value:f.notes,onChange:w,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Catatan tambahan tentang pembayaran ini..."})]})]}),l.jsxs("div",{className:"mt-6 p-4 bg-green-50 rounded-lg border border-green-200",children:[l.jsx("h3",{className:"font-medium text-green-900 mb-3",children:"Ringkasan Pembayaran"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Total Pembayaran:"}),l.jsx("span",{className:"font-bold text-green-900",children:x(f.amount)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Metode Pembayaran:"}),l.jsx("span",{className:"font-medium text-green-900",children:f.payment_method==="bank_transfer"?"Transfer Bank":f.payment_method==="cash"?"Tunai":"Lainnya"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Penerima:"}),l.jsx("span",{className:"font-medium text-green-900",children:e.name})]}),f.payment_method==="bank_transfer"&&e.bank_info&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Rekening Tujuan:"}),l.jsxs("span",{className:"font-medium text-green-900",children:[e.bank_info.bank_name," - ",e.bank_account_number]})]})]})]}),l.jsxs("div",{className:"flex space-x-3 mt-6",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Memproses..."})]}):l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(xg,{className:"h-4 w-4"}),l.jsx("span",{children:"Proses Pembayaran"})]})})]})]}),l.jsx("div",{className:"mt-6",children:l.jsxs("button",{onClick:()=>p(!h),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800 transition-colors",children:[l.jsx(Xi,{className:"h-4 w-4"}),l.jsx("span",{children:h?"Sembunyikan Riwayat":"Lihat Riwayat Pembayaran"})]})}),h&&l.jsxs("div",{className:"mt-4 space-y-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:"Riwayat Pembayaran"}),c.length>0?l.jsx("div",{className:"space-y-3",children:c.map(T=>l.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Du,{className:"h-4 w-4 text-gray-500"}),l.jsx("span",{className:"font-medium text-gray-900",children:y(T.payment_date)})]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.payment_status==="completed"?"bg-green-100 text-green-800":T.payment_status==="pending"?"bg-yellow-100 text-yellow-800":T.payment_status==="processing"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:T.payment_status==="completed"?"Selesai":T.payment_status==="pending"?"Tertunda":T.payment_status==="processing"?"Diproses":"Gagal"})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("p",{className:"text-sm text-gray-600",children:[T.payment_method==="bank_transfer"?"Transfer Bank":T.payment_method==="cash"?"Tunai":"Lainnya",T.payment_reference&&` (${T.payment_reference})`]}),T.notes&&l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:T.notes})]}),l.jsx("p",{className:"font-bold text-gray-900",children:x(T.payment_amount)})]})]},T.id))}):l.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[l.jsx(El,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-500",children:"Belum ada riwayat pembayaran"})]})]})]})]})})}):null},QH=()=>{const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState([]),[h,p]=ae.useState([]),[f,g]=ae.useState(""),[b,w]=ae.useState(""),[m,x]=ae.useState(""),[y,N]=ae.useState(null),[S,T]=ae.useState(!1),[C,A]=ae.useState(null),[R,L]=ae.useState(null),[j,D]=ae.useState({totalPaid:0,pendingPayments:0,totalEmployees:0,paidEmployees:0});ae.useEffect(()=>{B()},[]);const B=async()=>{try{const{data:{user:H}}=await Te.auth.getUser();if(!H){e("/login");return}const{data:ie}=await Te.from("profiles").select("role").eq("id",H.id).single();if(!ie||ie.role!=="admin"){e("/dashboard");return}n(H),r(ie),await Promise.all([z(),U()])}catch(H){console.error("Error checking access:",H),e("/login")}finally{s(!1)}},z=async()=>{u(!0);try{const{data:H,error:ie}=await Te.from("profiles").select(`
          *,
          employee_salaries(*),
          positions(*),
          bank_info(*)
        `).order("name");if(ie)throw ie;d(H||[]);const ue=(H==null?void 0:H.length)||0,ce=(H==null?void 0:H.filter(pe=>{var ve,De;return((De=(ve=pe.employee_salaries)==null?void 0:ve[0])==null?void 0:De.payment_status)==="paid"}).length)||0;D(pe=>({...pe,totalEmployees:ue,paidEmployees:ce}))}catch(H){console.error("Error fetching employees:",H),A("Gagal memuat data karyawan")}finally{u(!1)}},U=async()=>{u(!0);try{const{data:H,error:ie}=await Te.from("salary_payments").select(`
          *,
          profiles:user_id(name, email, department, title, employee_id)
        `).order("payment_date",{ascending:!1}).limit(100);if(ie)throw ie;p(H||[]);const ue=(H==null?void 0:H.reduce((pe,ve)=>pe+(ve.payment_amount||0),0))||0,ce=(H==null?void 0:H.filter(pe=>pe.payment_status==="pending"||pe.payment_status==="processing").length)||0;D(pe=>({...pe,totalPaid:ue,pendingPayments:ce}))}catch(H){console.error("Error fetching payments:",H),A("Gagal memuat data pembayaran")}finally{u(!1)}},I=async H=>{L(`Pembayaran gaji untuk ${y.name} berhasil diproses!`),T(!1),await Promise.all([z(),U()]),setTimeout(()=>{L(null)},3e3)},F=H=>{N(H),T(!0)},q=H=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(H),O=H=>new Date(H).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),$=H=>{switch(H){case"paid":return"bg-green-100 text-green-800";case"unpaid":return"bg-red-100 text-red-800";case"processing":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Z=H=>{switch(H){case"paid":return"Dibayar";case"unpaid":return"Belum Dibayar";case"processing":return"Diproses";case"failed":return"Gagal";default:return"Tidak Diketahui"}},P=H=>{var ie;return(ie=H.positions)!=null&&ie.base_salary?H.positions.base_salary:H.employee_salaries&&H.employee_salaries.length>0?(H.employee_salaries[0].daily_salary||0)*22:H.salary||0},W=c.filter(H=>{var pe,ve,De,Re,we;const ie=((pe=H.name)==null?void 0:pe.toLowerCase().includes(f.toLowerCase()))||((ve=H.email)==null?void 0:ve.toLowerCase().includes(f.toLowerCase()))||((De=H.employee_id)==null?void 0:De.toLowerCase().includes(f.toLowerCase())),ue=!b||H.department===b,ce=!m||((we=(Re=H.employee_salaries)==null?void 0:Re[0])==null?void 0:we.payment_status)===m;return ie&&ue&&ce}),K=()=>[...new Set(c.map(ie=>ie.department).filter(Boolean))],J=()=>{if(h.length===0)return;const ie=[["Tanggal","Karyawan","Departemen","Jumlah","Metode","Status","Referensi","Catatan"],...h.map(ve=>{var De,Re;return[O(ve.payment_date),((De=ve.profiles)==null?void 0:De.name)||"Unknown",((Re=ve.profiles)==null?void 0:Re.department)||"-",ve.payment_amount,ve.payment_method==="bank_transfer"?"Transfer Bank":ve.payment_method==="cash"?"Tunai":"Lainnya",ve.payment_status,ve.payment_reference||"-",ve.notes||"-"]})].map(ve=>ve.join(",")).join(`
`),ue=new Blob([ie],{type:"text/csv;charset=utf-8;"}),ce=document.createElement("a"),pe=URL.createObjectURL(ue);ce.setAttribute("href",pe),ce.setAttribute("download",`salary_payments_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(pe)};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4 text-sm sm:text-base",children:"Memuat data pembayaran..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(ql,{user:t,profile:a}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 space-y-4 sm:space-y-0",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Pembayaran Gaji"}),l.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Proses pembayaran gaji karyawan dan lihat riwayat transaksi"})]}),l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[l.jsxs("button",{onClick:()=>{u(!0),Promise.all([z(),U()]).finally(()=>u(!1))},className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",title:"Refresh Data",children:[l.jsx(Ty,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),l.jsxs("button",{onClick:J,disabled:h.length===0,className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:[l.jsx(Xf,{className:"h-4 w-4"}),l.jsx("span",{children:"Export CSV"})]})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[R&&l.jsxs("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-green-50 rounded-lg flex items-start space-x-2 sm:space-x-3",children:[l.jsx(Vt,{className:"h-4 sm:h-5 w-4 sm:w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700 text-sm sm:text-base",children:R}),l.jsx("button",{onClick:()=>L(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),C&&l.jsxs("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-red-50 rounded-lg flex items-start space-x-2 sm:space-x-3",children:[l.jsx(Ln,{className:"h-4 sm:h-5 w-4 sm:w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700 text-sm sm:text-base",children:C}),l.jsx("button",{onClick:()=>A(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(kf,{className:"h-5 sm:h-6 w-5 sm:w-6 text-green-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Dibayarkan"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:q(j.totalPaid)})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ar,{className:"h-5 sm:h-6 w-5 sm:w-6 text-blue-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Karyawan Dibayar"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:j.paidEmployees}),l.jsxs("p",{className:"text-xs text-blue-600",children:["dari ",j.totalEmployees," karyawan"]})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:l.jsx(Xi,{className:"h-5 sm:h-6 w-5 sm:w-6 text-yellow-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Pembayaran Tertunda"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:j.pendingPayments})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-full flex items-center justify-center",children:l.jsx(xo,{className:"h-5 sm:h-6 w-5 sm:w-6 text-red-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Belum Dibayar"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:j.totalEmployees-j.paidEmployees}),l.jsx("p",{className:"text-xs text-red-600",children:"karyawan"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"flex flex-col space-y-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:space-y-0",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Hd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 sm:h-5 w-4 sm:w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari nama, email, atau ID...",value:f,onChange:H=>g(H.target.value),className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("select",{value:b,onChange:H=>w(H.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),K().map(H=>l.jsx("option",{value:H,children:H},H))]}),l.jsxs("select",{value:m,onChange:H=>x(H.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"paid",children:"Sudah Dibayar"}),l.jsx("option",{value:"unpaid",children:"Belum Dibayar"}),l.jsx("option",{value:"processing",children:"Sedang Diproses"})]})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:[l.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(xo,{className:"h-4 sm:h-5 w-4 sm:w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:["Daftar Gaji Karyawan (",W.length,")"]})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):W.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"sm:hidden divide-y divide-gray-200",children:W.map(H=>{var ue,ce;const ie=(ue=H.employee_salaries)==null?void 0:ue[0];return P(H),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-sm",children:H.name.charAt(0).toUpperCase()})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.name}),l.jsx("div",{className:"text-xs text-gray-500",children:H.email})]})]}),l.jsxs("button",{onClick:()=>F(H),className:"flex items-center space-x-1 px-2 py-1 bg-green-600 text-white rounded text-xs",children:[l.jsx(xg,{className:"h-3 w-3"}),l.jsx("span",{children:"Bayar"})]})]}),l.jsxs("div",{className:"mt-3 text-xs text-gray-500 space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Jabatan:"})," ",((ce=H.positions)==null?void 0:ce.name_id)||H.title||"Karyawan"," - ",H.department||"Belum diatur"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Rekening:"})," ",H.bank_info?`${H.bank_info.bank_name} (${H.bank_account_number})`:l.jsx("span",{className:"text-yellow-600",children:"Belum diatur"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${$((ie==null?void 0:ie.payment_status)||"unpaid")}`,children:Z((ie==null?void 0:ie.payment_status)||"unpaid")}),(ie==null?void 0:ie.last_payment_date)&&l.jsxs("span",{className:"ml-2",children:["(",O(ie.last_payment_date),")"]})]})]})]},H.id)})}),l.jsx("div",{className:"hidden sm:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jabatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rekening Bank"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Pembayaran"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(H=>{var ue,ce;const ie=(ue=H.employee_salaries)==null?void 0:ue[0];return P(H),l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium",children:H.name.charAt(0).toUpperCase()})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.name}),l.jsx("div",{className:"text-sm text-gray-500",children:H.email}),H.employee_id&&l.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",H.employee_id]})]})]})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:((ce=H.positions)==null?void 0:ce.name_id)||H.title||"Karyawan"}),l.jsx("div",{className:"text-sm text-gray-500",children:H.department||"Belum diatur"})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:H.bank_info?l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.bank_info.bank_name}),l.jsx("div",{className:"text-sm text-gray-500",children:H.bank_account_number})]}):l.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:"Belum diatur"})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$((ie==null?void 0:ie.payment_status)||"unpaid")}`,children:Z((ie==null?void 0:ie.payment_status)||"unpaid")}),(ie==null?void 0:ie.last_payment_date)&&l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Terakhir: ",O(ie.last_payment_date)]})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("button",{onClick:()=>F(H),className:"inline-flex items-center px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:[l.jsx(xg,{className:"h-3.5 w-3.5 mr-1"}),l.jsx("span",{children:"Bayar"})]})})]},H.id)})})]})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-12 sm:w-16 h-12 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ar,{className:"h-6 sm:h-8 w-6 sm:w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-base sm:text-lg mb-2",children:"Tidak ada karyawan ditemukan"}),l.jsx("p",{className:"text-gray-400 text-sm",children:"Coba sesuaikan pencarian atau filter Anda"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Xi,{className:"h-4 sm:h-5 w-4 sm:w-5 text-blue-600"}),l.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Riwayat Pembayaran Terbaru"})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):h.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"sm:hidden divide-y divide-gray-200",children:h.slice(0,10).map(H=>{var ie;return l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((ie=H.profiles)==null?void 0:ie.name)||"Unknown"}),l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${H.payment_status==="completed"?"bg-green-100 text-green-800":H.payment_status==="pending"?"bg-yellow-100 text-yellow-800":H.payment_status==="processing"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:H.payment_status==="completed"?"Selesai":H.payment_status==="pending"?"Tertunda":H.payment_status==="processing"?"Diproses":"Gagal"})]}),l.jsxs("div",{className:"mt-3 text-xs text-gray-500 space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Tanggal:"})," ",O(H.payment_date)," ",new Date(H.created_at).toLocaleTimeString("id-ID")]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Jumlah:"})," ",q(H.payment_amount)]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Metode:"})," ",H.payment_method==="bank_transfer"?"Transfer Bank":H.payment_method==="cash"?"Tunai":"Lainnya"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Referensi:"})," ",H.payment_reference||"-"]}),H.notes&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Catatan:"})," ",H.notes]})]})]},H.id)})}),l.jsx("div",{className:"hidden sm:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jumlah"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Metode"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Referensi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.slice(0,10).map(H=>{var ie,ue;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:O(H.payment_date)}),l.jsx("div",{className:"text-xs text-gray-500",children:new Date(H.created_at).toLocaleTimeString("id-ID")})]}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((ie=H.profiles)==null?void 0:ie.name)||"Unknown"}),l.jsx("div",{className:"text-xs text-gray-500",children:((ue=H.profiles)==null?void 0:ue.department)||"-"})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:q(H.payment_amount)})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:H.payment_method==="bank_transfer"?"Transfer Bank":H.payment_method==="cash"?"Tunai":"Lainnya"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${H.payment_status==="completed"?"bg-green-100 text-green-800":H.payment_status==="pending"?"bg-yellow-100 text-yellow-800":H.payment_status==="processing"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:H.payment_status==="completed"?"Selesai":H.payment_status==="pending"?"Tertunda":H.payment_status==="processing"?"Diproses":"Gagal"})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:H.payment_reference||"-"}),H.notes&&l.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:H.notes})]})]},H.id)})})]})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-12 sm:w-16 h-12 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(El,{className:"h-6 sm:h-8 w-6 sm:w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-base sm:text-lg mb-2",children:"Belum ada riwayat pembayaran"}),l.jsx("p",{className:"text-gray-400 text-sm",children:"Pembayaran yang diproses akan muncul di sini"})]})]})]})]}),S&&y&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-md sm:max-w-lg max-h-[90vh] overflow-y-auto",children:l.jsx(JH,{employee:y,onClose:()=>T(!1),onPaymentProcessed:I})})})]})},ZH=()=>{const e=hr(),[t,n]=ae.useState([]),[a,r]=ae.useState(!0),[i,s]=ae.useState(!1),[o,u]=ae.useState(""),[c,d]=ae.useState(!1),[h,p]=ae.useState(null),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(null),[S,T]=ae.useState({name:"",description:"",head_name:"",is_active:!0});ae.useEffect(()=>{C()},[]);const C=async()=>{try{const{data:{user:U}}=await Te.auth.getUser();if(!U){e("/login");return}const{data:I}=await Te.from("profiles").select("role").eq("id",U.id).single();if(!I||I.role!=="admin"){e("/dashboard");return}x(U),N(I),await A()}catch(U){console.error("Error checking access:",U),e("/login")}finally{r(!1)}},A=async()=>{s(!0);try{const{data:U,error:I}=await Te.from("departments").select("*").order("name");if(I)throw I;n(U||[])}catch(U){console.error("Error fetching departments:",U),g("Gagal memuat data departemen")}finally{s(!1)}},R=U=>{const{name:I,value:F,type:q,checked:O}=U.target;T($=>({...$,[I]:q==="checkbox"?O:F}))},L=()=>{T({name:"",description:"",head_name:"",is_active:!0}),p(null),d(!1),g(null)},j=async U=>{if(U.preventDefault(),g(null),!S.name.trim()){g("Nama departemen harus diisi");return}s(!0);try{const I={...S,updated_at:new Date().toISOString()};if(h){const{error:F}=await Te.from("departments").update(I).eq("id",h.id);if(F)throw F;w("Departemen berhasil diperbarui!")}else{I.created_at=new Date().toISOString();const{error:F}=await Te.from("departments").insert([I]);if(F)throw F;w("Departemen berhasil ditambahkan!")}L(),await A(),setTimeout(()=>w(null),3e3)}catch(I){console.error("Error saving department:",I),g("Gagal menyimpan departemen: "+I.message)}finally{s(!1)}},D=U=>{T({name:U.name,description:U.description||"",head_name:U.head_name||"",is_active:U.is_active}),p(U),d(!0)},B=async U=>{var I;if(confirm("Apakah Anda yakin ingin menghapus departemen ini?")){s(!0);try{const{data:F,error:q}=await Te.from("positions").select("id").eq("department",(I=t.find($=>$.id===U))==null?void 0:I.name).limit(1);if(q)throw q;if(F&&F.length>0){g("Departemen tidak dapat dihapus karena masih digunakan oleh jabatan");return}const{error:O}=await Te.from("departments").delete().eq("id",U);if(O)throw O;w("Departemen berhasil dihapus!"),await A(),setTimeout(()=>w(null),3e3)}catch(F){console.error("Error deleting department:",F),g("Gagal menghapus departemen: "+F.message)}finally{s(!1)}}},z=t.filter(U=>U.name.toLowerCase().includes(o.toLowerCase())||U.description&&U.description.toLowerCase().includes(o.toLowerCase())||U.head_name&&U.head_name.toLowerCase().includes(o.toLowerCase()));return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data departemen..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row",children:[l.jsx(ql,{user:m,profile:y,className:"w-full md:w-64 md:fixed md:h-screen"}),l.jsxs("div",{className:"flex-1 md:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Departemen"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, dan kelola departemen perusahaan"})]}),l.jsxs("button",{onClick:()=>d(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[l.jsx(R0,{className:"h-4 w-4"}),l.jsx("span",{children:"Tambah Departemen"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[b&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:b}),l.jsx("button",{onClick:()=>w(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),f&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:f}),l.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ha,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Departemen"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Vt,{className:"h-5 w-5 text-green-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Departemen Aktif"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.filter(U=>U.is_active).length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(Al,{className:"h-5 w-5 text-purple-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dengan Kepala"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.filter(U=>U.head_name).length})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(Hd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari departemen...",value:o,onChange:U=>u(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ha,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base font-medium text-gray-900",children:["Daftar Departemen (",z.length,")"]})]})}),i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):z.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ha,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada departemen ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau tambah departemen baru"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Departemen"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kepala Departemen"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(U=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ha,{className:"h-4 w-4 text-blue-600"})}),l.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name})]})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:U.description||"-"}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Al,{className:"h-4 w-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-900",children:U.head_name||"Belum diatur"})]})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>D(U),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit Departemen",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>B(U.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",title:"Hapus Departemen",children:l.jsx(Sd,{className:"h-4 w-4"})})]})})]},U.id))})]}),l.jsx("div",{className:"md:hidden p-4 space-y-4",children:z.map(U=>l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ha,{className:"h-4 w-4 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.name}),U.description&&l.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:U.description})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>D(U),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>B(U.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",children:l.jsx(Sd,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Kepala:"})," ",U.head_name||"Belum diatur"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})]})]})]},U.id))})]})]})]})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md sm:max-w-lg bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:h?"Edit Departemen":"Tambah Departemen Baru"}),l.jsx("button",{onClick:L,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Si,{className:"h-5 w-5"})})]}),l.jsxs("form",{onSubmit:j,className:"space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Informasi Departemen"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Departemen *"}),l.jsx("input",{type:"text",name:"name",value:S.name,onChange:R,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: IT, HR, Finance"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),l.jsx("textarea",{name:"description",value:S.description,onChange:R,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Deskripsi singkat tentang departemen..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kepala Departemen"}),l.jsx("input",{type:"text",name:"head_name",value:S.head_name,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Nama kepala departemen"})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_active",checked:S.is_active,onChange:R,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Departemen aktif"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Batal"}),l.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:h?"Perbarui Departemen":"Simpan Departemen"})]})})]})]})]})})})]})},eW=()=>{const e=hr(),[t,n]=ae.useState([]),[a,r]=ae.useState([]),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState(""),[h,p]=ae.useState(""),[f,g]=ae.useState(!1),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(null),[S,T]=ae.useState(null),[C,A]=ae.useState(null),[R,L]=ae.useState({name_id:"",name_en:"",description_id:"",description_en:"",base_salary:0,min_salary:0,max_salary:0,department:"",is_active:!0});ae.useEffect(()=>{j()},[]);const j=async()=>{try{const{data:{user:Z}}=await Te.auth.getUser();if(!Z){e("/login");return}const{data:P}=await Te.from("profiles").select("role").eq("id",Z.id).single();if(!P||P.role!=="admin"){e("/dashboard");return}T(Z),A(P),await Promise.all([D(),B()])}catch(Z){console.error("Error checking access:",Z),e("/login")}finally{s(!1)}},D=async()=>{u(!0);try{const{data:Z,error:P}=await Te.from("positions").select("*").order("created_at",{ascending:!1});if(P)throw P;n(Z||[])}catch(Z){console.error("Error fetching positions:",Z),x("Gagal memuat data jabatan")}finally{u(!1)}},B=async()=>{try{const{data:Z,error:P}=await Te.from("departments").select("*").eq("is_active",!0).order("name");if(P)throw P;r(Z||[])}catch(Z){console.error("Error fetching departments:",Z)}},z=Z=>{const{name:P,value:W,type:K,checked:J}=Z.target;L(H=>({...H,[P]:K==="checkbox"?J:W}))},U=()=>{L({name_id:"",name_en:"",description_id:"",description_en:"",base_salary:0,min_salary:0,max_salary:0,department:"",is_active:!0}),w(null),g(!1),x(null)},I=async Z=>{if(Z.preventDefault(),x(null),!R.name_id.trim()||!R.name_en.trim()){x("Nama jabatan (Indonesia dan English) harus diisi");return}if(!R.department){x("Departemen harus dipilih");return}if(R.min_salary>R.max_salary){x("Gaji minimum tidak boleh lebih besar dari gaji maksimum");return}u(!0);try{const P={name_id:R.name_id,name_en:R.name_en,description_id:R.description_id||null,description_en:R.description_en||null,base_salary:parseFloat(R.base_salary)||0,min_salary:parseFloat(R.min_salary)||0,max_salary:parseFloat(R.max_salary)||0,department:R.department,is_active:R.is_active,updated_at:new Date().toISOString()};if(b){const{error:W}=await Te.from("positions").update(P).eq("id",b.id);if(W)throw W;N("Jabatan berhasil diperbarui!")}else{P.created_at=new Date().toISOString();const{error:W}=await Te.from("positions").insert([P]);if(W)throw W;N("Jabatan berhasil ditambahkan!")}U(),await D(),setTimeout(()=>N(null),3e3)}catch(P){console.error("Error saving position:",P),x("Gagal menyimpan jabatan: "+P.message)}finally{u(!1)}},F=Z=>{L({name_id:Z.name_id,name_en:Z.name_en,description_id:Z.description_id||"",description_en:Z.description_en||"",base_salary:Z.base_salary||0,min_salary:Z.min_salary||0,max_salary:Z.max_salary||0,department:Z.department||"",is_active:Z.is_active}),w(Z),g(!0)},q=async Z=>{if(!(await ct.fire({title:"Hapus Jabatan?",text:"Apakah Anda yakin ingin menghapus jabatan ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"})).isConfirmed){ct.fire("Dibatalkan","Jabatan tidak dihapus.","info");return}u(!0);try{const{data:W,error:K}=await Te.from("profiles").select("id").eq("position_id",Z).limit(1);if(K)throw K;if(W&&W.length>0){x("Jabatan tidak dapat dihapus karena masih digunakan oleh karyawan");return}const{error:J}=await Te.from("positions").delete().eq("id",Z);if(J)throw J;await D(),setTimeout(()=>N(null),3e3)}catch(W){console.error("Error deleting position:",W),x("Gagal menghapus jabatan: "+W.message)}finally{u(!1)}},O=Z=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(Z),$=t.filter(Z=>{var K;const P=Z.name_id.toLowerCase().includes(c.toLowerCase())||Z.name_en.toLowerCase().includes(c.toLowerCase())||Z.department&&Z.department.toLowerCase().includes(c.toLowerCase()),W=h===""||Z.department===((K=a.find(J=>J.id===h))==null?void 0:K.name);return P&&W});return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data jabatan..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(ql,{user:S,profile:C}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kelola Jabatan"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, dan kelola jabatan beserta struktur gaji"})]}),l.jsxs("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(R0,{className:"h-4 w-4"}),l.jsx("span",{children:"Tambah Jabatan"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[y&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:y}),l.jsx("button",{onClick:()=>N(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),m&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:m}),l.jsx("button",{onClick:()=>x(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Gc,{className:"h-6 w-6 text-blue-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Jabatan"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Al,{className:"h-6 w-6 text-green-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Jabatan Aktif"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(Z=>Z.is_active).length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(kf,{className:"h-6 w-6 text-purple-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rata-rata Gaji"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.length>0?O(t.reduce((Z,P)=>Z+(P.base_salary||0),0)/t.length):O(0)})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative",children:[l.jsx(Hd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari jabatan atau departemen...",value:c,onChange:Z=>d(Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),l.jsx("div",{className:"sm:w-48",children:l.jsxs("select",{value:h,onChange:Z=>p(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),a.map(Z=>l.jsx("option",{value:Z.id,children:Z.name},Z.id))]})})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Gc,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Daftar Jabatan (",$.length,")"]})]})}),o||$.length===0?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):$.length>0?l.jsxs("div",{className:"overflow-x-auto sm:overflow-visible",children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50 hidden sm:table-header-group",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jabatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departemen"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gaji Pokok"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rentang Gaji"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$.map(Z=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:Z.name_id}),l.jsx("div",{className:"text-sm text-gray-500",children:Z.name_en}),Z.description_id&&l.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Z.description_id})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:Z.department||"Tidak ada"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:O(Z.base_salary||0)})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"text-sm text-gray-900",children:[O(Z.min_salary||0)," - ",O(Z.max_salary||0)]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Z.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Z.is_active?"Aktif":"Tidak Aktif"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>F(Z),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit Jabatan",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>q(Z.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",title:"Hapus Jabatan",children:l.jsx(Sd,{className:"h-4 w-4"})})]})})]},Z.id))})]}),l.jsx("div",{className:"sm:hidden",children:$.map(Z=>l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Gc,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:Z.name_id}),l.jsx("p",{className:"text-xs text-gray-500",children:Z.name_en})]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-700",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Departemen:"})," ",Z.department||"Tidak ada"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Gaji Pokok:"})," ",O(Z.base_salary||0)]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Rentang Gaji:"})," ",O(Z.min_salary||0)," - ",O(Z.max_salary||0)]}),Z.description_id&&l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:Z.description_id}),l.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Status: ",Z.is_active?"Aktif":"Tidak Aktif"]})]}),l.jsxs("div",{className:"mt-2 flex justify-end",children:[l.jsx("button",{onClick:()=>F(Z),className:"text-blue-600 hover:text-blue-900 p-2 rounded hover:bg-blue-50",children:l.jsx(ji,{className:"h-5 w-5"})}),l.jsx("button",{onClick:()=>q(Z.id),className:"text-red-600 hover:text-red-900 p-2 rounded hover:bg-red-50",children:l.jsx(Sd,{className:"h-5 w-5"})})]})]},Z.id))})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Gc,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada jabatan ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau tambah jabatan baru"})]})]})]})]}),f&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:b?"Edit Jabatan":"Tambah Jabatan Baru"}),l.jsx("button",{onClick:U,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Si,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:I,className:"space-y-6",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informasi Dasar"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Jabatan (Indonesia) *"}),l.jsx("input",{type:"text",name:"name_id",value:R.name_id,onChange:z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: Manager IT"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Jabatan (English) *"}),l.jsx("input",{type:"text",name:"name_en",value:R.name_en,onChange:z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Example: IT Manager"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departemen *"}),l.jsxs("select",{name:"department",value:R.department,onChange:z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Pilih Departemen..."}),a.map(Z=>l.jsx("option",{value:Z.name,children:Z.name},Z.id))]})]})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Deskripsi Jabatan"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi (Indonesia)"}),l.jsx("textarea",{name:"description_id",value:R.description_id,onChange:z,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Deskripsi tugas dan tanggung jawab..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi (English)"}),l.jsx("textarea",{name:"description_en",value:R.description_en,onChange:z,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Job description and responsibilities..."})]})]})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informasi Gaji"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gaji Pokok (IDR)"}),l.jsx("input",{type:"number",name:"base_salary",value:R.base_salary,onChange:z,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"5000000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gaji Minimum (IDR)"}),l.jsx("input",{type:"number",name:"min_salary",value:R.min_salary,onChange:z,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"4000000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gaji Maksimum (IDR)"}),l.jsx("input",{type:"number",name:"max_salary",value:R.max_salary,onChange:z,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"8000000"})]})]}),l.jsx("div",{className:"mt-3 p-3 bg-white rounded border",children:l.jsxs("div",{className:"text-sm text-gray-600",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Gaji Pokok:"})," ",O(R.base_salary||0)]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Rentang:"})," ",O(R.min_salary||0)," - ",O(R.max_salary||0)]})]})})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_active",checked:R.is_active,onChange:z,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Jabatan aktif (dapat dipilih saat menambah karyawan)"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:U,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:b?"Perbarui Jabatan":"Simpan Jabatan"})]})})]})]})]})})})]})},tW=()=>{var ie,ue,ce;const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState([]),[o,u]=ae.useState(!0),[c,d]=ae.useState(!1),[h,p]=ae.useState("face"),[f,g]=ae.useState(!1),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(!1),[S,T]=ae.useState(null),[C,A]=ae.useState(null),[R,L]=ae.useState({name:"",full_name:"",phone:"",location:"",bio:""}),[j,D]=ae.useState({bank_id:"",bank_account_number:"",bank_account_name:""}),[B,z]=ae.useState({currentPassword:"",newPassword:"",confirmPassword:""});ae.useEffect(()=>{U()},[]);const U=async()=>{try{const{data:{user:pe}}=await Te.auth.getUser();if(!pe){e("/login");return}n(pe),await Promise.all([I(pe.id),F()])}catch(pe){console.error("Error checking user:",pe),e("/login")}finally{u(!1)}},I=async pe=>{try{const{data:ve,error:De}=await Te.from("profiles").select(`
          *,
          positions(name_id, department),
          bank_info(id, bank_name, bank_logo)
        `).eq("id",pe).maybeSingle();if(De&&De.code!=="PGRST116")throw De;ve&&(r(ve),d(ve.role==="admin"),L({name:ve.name||"",full_name:ve.full_name||"",phone:ve.phone||"",location:ve.location||"",bio:ve.bio||""}),D({bank_id:ve.bank_id||"",bank_account_number:ve.bank_account_number||"",bank_account_name:ve.bank_account_name||ve.full_name||ve.name||""}))}catch(ve){console.error("Error fetching profile:",ve)}},F=async()=>{try{const{data:pe,error:ve}=await Te.from("bank_info").select("*").eq("is_active",!0).order("bank_name");if(ve)throw ve;s(pe||[])}catch(pe){console.error("Error fetching banks:",pe)}},q=(pe,ve)=>{w(pe),x(ve),T(null),console.log("✅ Face captured with custom fingerprint")},O=async()=>{if(!b||!m){T("Silakan ambil foto wajah terlebih dahulu");return}N(!0),T(null);try{console.log("Starting face photo save process...");const pe=Date.now(),ve=`${t.id}-face-${pe}.jpg`;console.log("Uploading face photo with filename:",ve),await Yg(b,"face-photos",ve);const De=Xg("face-photos",ve);console.log("Photo uploaded successfully, URL:",De);const{error:Re}=await Te.from("profiles").update({avatar_url:De,is_face_registered:!0,updated_at:new Date().toISOString()}).eq("id",t.id);if(Re)throw console.error("Profile update error:",Re),new Error(`Gagal menyimpan profil: ${Re.message}`);console.log("Profile updated successfully"),A("Foto wajah berhasil disimpan!"),await I(t.id),w(null),x(null)}catch(pe){console.error("Error saving face photo:",pe),T(pe.message||"Gagal menyimpan foto wajah. Silakan coba lagi.")}finally{N(!1)}},$=async()=>{N(!0),T(null);try{const{error:pe}=await Te.from("profiles").update({...R,updated_at:new Date().toISOString()}).eq("id",t.id);if(pe)throw pe;A("Profil berhasil diperbarui!"),await I(t.id)}catch(pe){console.error("Error updating profile:",pe),T("Gagal memperbarui profil. Silakan coba lagi.")}finally{N(!1)}},Z=async()=>{if(!j.bank_id){T("Silakan pilih bank terlebih dahulu");return}if(!j.bank_account_number){T("Nomor rekening harus diisi");return}N(!0),T(null);try{const{error:pe}=await Te.from("profiles").update({bank_id:j.bank_id,bank_account_number:j.bank_account_number,bank_account_name:j.bank_account_name,updated_at:new Date().toISOString()}).eq("id",t.id);if(pe)throw pe;A("Informasi rekening berhasil diperbarui!"),await I(t.id)}catch(pe){console.error("Error updating bank info:",pe),T("Gagal memperbarui informasi rekening. Silakan coba lagi.")}finally{N(!1)}},P=async()=>{if(B.newPassword!==B.confirmPassword){T("Password baru dan konfirmasi password tidak cocok");return}if(B.newPassword.length<6){T("Password baru minimal 6 karakter");return}N(!0),T(null);try{const{error:pe}=await Te.auth.updateUser({password:B.newPassword});if(pe)throw pe;await Te.from("password_changes").insert([{user_id:t.id,changed_by:t.id,change_type:"self_change",ip_address:"unknown",user_agent:navigator.userAgent}]),A("Password berhasil diubah!"),z({currentPassword:"",newPassword:"",confirmPassword:""})}catch(pe){console.error("Error changing password:",pe),T("Gagal mengubah password. Silakan coba lagi.")}finally{N(!1)}},W=pe=>{const{name:ve,value:De}=pe.target;L(Re=>({...Re,[ve]:De}))},K=pe=>{const{name:ve,value:De}=pe.target;D(Re=>({...Re,[ve]:De}))},J=pe=>{const{name:ve,value:De}=pe.target;z(Re=>({...Re,[ve]:De}))},H=()=>i.find(pe=>pe.id===j.bank_id);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat profil..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-700 to-blue-500 shadow-md border-b",children:l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex items-center justify-between py-6",children:l.jsxs("div",{className:"flex items-center space-x-5",children:[l.jsx("button",{onClick:()=>e("/dashboard"),className:"p-2 bg-white/30 hover:bg-white/50 rounded-full shadow transition-colors",title:"Kembali ke Dashboard",children:l.jsx(q4,{className:"h-6 w-6 text-blue-700"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-extrabold text-white tracking-tight drop-shadow",children:"Kelola Profil"}),l.jsx("p",{className:"text-base text-blue-100 mt-1",children:"Atur foto wajah, data pribadi, dan keamanan akun Anda"})]})]})})})}),l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[C&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-green-700 font-medium",children:"Berhasil!"}),l.jsx("p",{className:"text-green-600 text-sm mt-1",children:C})]})]}),S&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Error"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:S})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-8 border border-gray-100 flex flex-col md:flex-row items-center md:items-start gap-8",children:[l.jsx("div",{className:"w-28 h-28 bg-blue-100 rounded-full flex items-center justify-center overflow-hidden shadow border-4 border-white",children:a!=null&&a.avatar_url?l.jsx("img",{src:a.avatar_url,alt:"Profile",className:"w-full h-full object-cover"}):l.jsx(ar,{className:"h-12 w-12 text-blue-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 truncate",children:(a==null?void 0:a.full_name)||(a==null?void 0:a.name)||((ie=t==null?void 0:t.email)==null?void 0:ie.split("@")[0])||"Pengguna"}),l.jsx("button",{onClick:()=>g(!0),className:"ml-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-full shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400",title:"Edit Profil",children:"Edit"})]}),f&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-lg p-8 relative animate-fade-in",children:[l.jsx("button",{onClick:()=>g(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10",title:"Tutup Edit Profil",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Profil"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:(a==null?void 0:a.full_name)||""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:(a==null?void 0:a.email)||"",disabled:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No. Telepon"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:(a==null?void 0:a.phone)||""})]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200",children:"Batal"}),l.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:"Simpan"})]})]})]})}),l.jsx("p",{className:"text-base text-gray-500 mb-2 truncate",children:(a==null?void 0:a.email)||(t==null?void 0:t.email)}),l.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[((ue=a==null?void 0:a.positions)==null?void 0:ue.name_id)&&l.jsx("span",{className:"text-sm text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full",children:a.positions.name_id}),((ce=a==null?void 0:a.positions)==null?void 0:ce.department)&&l.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:a.positions.department}),(a==null?void 0:a.employee_id)&&l.jsxs("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:["ID: ",a.employee_id]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[l.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium shadow-sm ${a!=null&&a.is_face_registered?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:[l.jsx(kd,{className:"h-4 w-4"}),l.jsx("span",{children:a!=null&&a.is_face_registered?"Wajah Terdaftar":"Wajah Belum Terdaftar"})]}),(a==null?void 0:a.bank_info)&&l.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 font-medium shadow-sm",children:[l.jsx(ha,{className:"h-4 w-4"}),l.jsxs("span",{children:["Rekening ",a.bank_info.bank_name]})]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100",children:[l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"flex flex-wrap",children:[l.jsxs("button",{onClick:()=>{(c||!(a!=null&&a.is_face_registered))&&p("face")},className:`px-6 py-4 text-sm font-medium ${h==="face"?"border-b-2 border-blue-500 text-blue-600":a!=null&&a.is_face_registered&&!c?"text-gray-400 cursor-not-allowed":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(kd,{className:"h-4 w-4 inline mr-2"}),"Foto Wajah"]}),l.jsxs("button",{onClick:()=>p("profile"),className:`px-6 py-4 text-sm font-medium ${h==="profile"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(ji,{className:"h-4 w-4 inline mr-2"}),"Informasi Pribadi"]}),l.jsxs("button",{onClick:()=>p("bank"),className:`px-6 py-4 text-sm font-medium ${h==="bank"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(ha,{className:"h-4 w-4 inline mr-2"}),"Rekening Bank"]}),l.jsxs("button",{onClick:()=>p("password"),className:`px-6 py-4 text-sm font-medium ${h==="password"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(ml,{className:"h-4 w-4 inline mr-2"}),"Ubah Password"]})]})}),l.jsxs("div",{className:"p-6",children:[h==="face"&&l.jsx("div",{children:a!=null&&a.is_face_registered&&!c?l.jsxs("div",{className:"text-center py-8",children:[l.jsxs("div",{className:"w-24 h-24 mx-auto mb-4 relative",children:[a.avatar_url?l.jsx("img",{src:a.avatar_url,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-green-100"}):l.jsx("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ar,{className:"h-12 w-12 text-blue-600"})}),l.jsx("div",{className:"absolute bottom-0 right-0 bg-green-500 text-white p-1 rounded-full",children:l.jsx(Vt,{className:"h-5 w-5"})})]}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Wajah Terverifikasi"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Foto wajah Anda telah terdaftar dan terverifikasi dalam sistem. Anda dapat menggunakan verifikasi wajah untuk absensi."}),l.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg text-left",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Perhatian"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Foto wajah yang sudah terverifikasi tidak dapat diubah oleh pengguna. Jika Anda perlu mengubah foto wajah, silakan hubungi administrator."})]})]})})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Setup Foto Wajah"}),l.jsx("p",{className:"text-gray-600",children:"Foto wajah digunakan untuk verifikasi absensi yang aman dan akurat"})]}),l.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"✨ Keunggulan Sistem Kami"}),l.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[l.jsx("li",{children:"• Teknologi pengenalan wajah yang aman dan cepat"}),l.jsx("li",{children:"• Tidak memerlukan download model AI eksternal"}),l.jsx("li",{children:"• Analisis pola wajah dengan algoritma custom"}),l.jsx("li",{children:"• Data tersimpan aman dengan enkripsi"})]})]}),l.jsx(Ev,{onFaceCapture:q,isCapturing:y}),b&&l.jsxs("div",{className:"mt-6 text-center",children:[l.jsxs("div",{className:"inline-flex items-center space-x-2 text-green-600 mb-4",children:[l.jsx(Vt,{className:"h-5 w-5"}),l.jsx("span",{children:"Foto wajah berhasil diambil dan diverifikasi!"})]}),l.jsx("button",{onClick:O,disabled:y,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Foto Wajah"})]})})]})]})}),h==="profile"&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informasi Pribadi"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Panggilan"}),l.jsx("input",{type:"text",name:"name",value:R.name,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nama panggilan"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),l.jsx("input",{type:"text",name:"full_name",value:R.full_name,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nama lengkap"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(G4,{className:"h-4 w-4 inline mr-1"}),"Nomor Telepon"]}),l.jsx("input",{type:"tel",name:"phone",value:R.phone,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+62-21-1234567"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(_i,{className:"h-4 w-4 inline mr-1"}),"Lokasi"]}),l.jsx("input",{type:"text",name:"location",value:R.location,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Jakarta, Indonesia"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),l.jsx("textarea",{name:"bio",value:R.bio,onChange:W,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ceritakan sedikit tentang diri Anda..."})]}),l.jsx("button",{onClick:$,disabled:y,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Perubahan"})]})})]})]}),h==="bank"&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informasi Rekening Bank"}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-100 mb-6",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(ha,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Informasi Rekening untuk Gaji"}),l.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Informasi rekening bank Anda digunakan untuk pembayaran gaji dan tunjangan. Pastikan data yang dimasukkan sudah benar."})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(ha,{className:"h-4 w-4 inline mr-1"}),"Pilih Bank *"]}),l.jsx("div",{className:"relative",children:l.jsxs("select",{name:"bank_id",value:j.bank_id,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Pilih Bank..."}),i.map(pe=>l.jsx("option",{value:pe.id,children:pe.bank_name},pe.id))]})}),H()&&l.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-sm text-gray-600",children:[H().bank_logo&&l.jsx("img",{src:H().bank_logo,alt:H().bank_name,className:"w-6 h-6 object-contain",onError:pe=>{pe.target.onerror=null,pe.target.src="",pe.target.parentElement.innerHTML=`
                                  <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600">
                                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    </svg>
                                  </div>
                                `}}),H()&&l.jsxs("span",{children:["Bank ",H().bank_name]})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(xo,{className:"h-4 w-4 inline mr-1"}),"Nomor Rekening *"]}),l.jsx("input",{type:"text",name:"bank_account_number",value:j.bank_account_number,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan nomor rekening tanpa spasi"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(ar,{className:"h-4 w-4 inline mr-1"}),"Nama Pemilik Rekening"]}),l.jsx("input",{type:"text",name:"bank_account_name",value:j.bank_account_name,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50",placeholder:"Nama sesuai saat pendaftaran",readOnly:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nama pemilik rekening otomatis menggunakan nama lengkap dari profil Anda"})]}),l.jsx("button",{onClick:Z,disabled:y,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Informasi Rekening"})]})}),l.jsxs("div",{className:"mt-8",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Bank Tersedia"}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:i.map(pe=>l.jsx("div",{className:`p-4 rounded-xl border transition-all cursor-pointer ${j.bank_id===pe.id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,onClick:()=>D(ve=>({...ve,bank_id:pe.id})),children:l.jsxs("div",{className:"flex flex-col items-center text-center",children:[pe.bank_logo?l.jsx("img",{src:pe.bank_logo,alt:pe.bank_name,className:"w-12 h-12 object-contain mb-3"}):l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-3",children:l.jsx(ha,{className:"h-5 w-5 text-blue-600"})}),l.jsx("span",{className:"text-sm font-medium text-gray-800",children:pe.bank_name}),j.bank_id===pe.id&&l.jsxs("div",{className:"mt-2 text-xs text-blue-600 flex items-center",children:[l.jsx(Vt,{className:"h-3 w-3 mr-1"}),"Dipilih"]})]})},pe.id))})]})]})]}),h==="password"&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Ubah Password"}),l.jsxs("div",{className:"space-y-6 max-w-md",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Saat Ini"}),l.jsx("input",{type:"password",name:"currentPassword",value:B.currentPassword,onChange:J,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan password saat ini"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Baru"}),l.jsx("input",{type:"password",name:"newPassword",value:B.newPassword,onChange:J,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan password baru (min. 6 karakter)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Password Baru"}),l.jsx("input",{type:"password",name:"confirmPassword",value:B.confirmPassword,onChange:J,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Konfirmasi password baru"})]}),l.jsx("button",{onClick:P,disabled:y||!B.newPassword||!B.confirmPassword,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Mengubah..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ml,{className:"h-4 w-4"}),l.jsx("span",{children:"Ubah Password"})]})})]}),l.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-100",children:[l.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"🔒 Tips Keamanan Password"}),l.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[l.jsx("p",{children:"• Gunakan minimal 6 karakter"}),l.jsx("p",{children:"• Kombinasikan huruf besar, kecil, dan angka"}),l.jsx("p",{children:"• Jangan gunakan informasi pribadi yang mudah ditebak"}),l.jsx("p",{children:"• Ubah password secara berkala"})]})]})]})]})]}),l.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl border border-gray-200",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"🔒 Keamanan & Privasi"}),l.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[l.jsx("p",{children:"• Foto wajah dienkripsi dan disimpan dengan aman"}),l.jsx("p",{children:"• Menggunakan algoritma fingerprinting custom yang aman"}),l.jsx("p",{children:"• Hanya digunakan untuk verifikasi absensi"}),l.jsx("p",{children:"• Data rekening bank hanya digunakan untuk pembayaran gaji"}),l.jsx("p",{children:"• Data tidak dibagikan kepada pihak ketiga"}),l.jsx("p",{children:"• Anda dapat mengubah informasi kapan saja"})]})]})]})]})},nW=({initialLocation:e,onLocationSelect:t,onCancel:n,radius:a=100})=>{const[r,i]=ae.useState(e||{lat:-6.2,lng:106.816666}),[s,o]=ae.useState(""),[u,c]=ae.useState(!1),[d,h]=ae.useState(null),[p,f]=ae.useState(null);ae.useEffect(()=>{e&&(i(e),o(e.address||""))},[e]);const g=()=>{if(!navigator.geolocation){h("Geolokasi tidak didukung oleh browser ini.");return}c(!0),h(null),navigator.geolocation.getCurrentPosition(N=>{const S={lat:N.coords.latitude,lng:N.coords.longitude};i(S),o(`${S.lat.toFixed(6)}, ${S.lng.toFixed(6)}`),f("Lokasi saat ini berhasil didapatkan!"),c(!1)},N=>{console.error("Geolocation error:",N);let S="Gagal mendapatkan lokasi saat ini.";switch(N.code){case N.PERMISSION_DENIED:S="Akses lokasi ditolak. Silakan izinkan akses lokasi.";break;case N.POSITION_UNAVAILABLE:S="Informasi lokasi tidak tersedia.";break;case N.TIMEOUT:S="Permintaan lokasi timeout.";break}h(S),c(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},b=(N,S)=>{const T=parseFloat(S);isNaN(T)||(i(C=>({...C,[N]:T})),h(null))},w=()=>!r.lat||!r.lng?(h("Koordinat latitude dan longitude harus diisi."),!1):r.lat<-90||r.lat>90?(h("Latitude harus antara -90 dan 90."),!1):r.lng<-180||r.lng>180?(h("Longitude harus antara -180 dan 180."),!1):s.trim()?!0:(h("Alamat kantor harus diisi."),!1),m=()=>{w()&&t&&t({latitude:r.lat,longitude:r.lng,address:s.trim(),radius:a})},x=[{name:"Jakarta Pusat",lat:-6.2,lng:106.816666,address:"Jakarta Pusat, DKI Jakarta, Indonesia"},{name:"Surabaya",lat:-7.257472,lng:112.75209,address:"Surabaya, Jawa Timur, Indonesia"},{name:"Bandung",lat:-6.917464,lng:107.619123,address:"Bandung, Jawa Barat, Indonesia"},{name:"Medan",lat:3.595196,lng:98.672226,address:"Medan, Sumatera Utara, Indonesia"},{name:"Yogyakarta",lat:-7.797068,lng:110.370529,address:"Yogyakarta, DI Yogyakarta, Indonesia"}],y=N=>{i({lat:N.lat,lng:N.lng}),o(N.address),f(`Lokasi ${N.name} dipilih!`),h(null)};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(_i,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Atur Lokasi Kantor"}),l.jsx("p",{className:"text-gray-600",children:"Tentukan koordinat dan alamat lokasi kantor untuk sistem absensi"})]}),p&&l.jsxs("div",{className:"p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:p})]}),d&&l.jsxs("div",{className:"p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Eu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:d})]}),l.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-blue-900",children:"Gunakan Lokasi Saat Ini"}),l.jsx("p",{className:"text-sm text-blue-700",children:"Otomatis mengisi koordinat berdasarkan GPS"})]}),l.jsxs("button",{onClick:g,disabled:u,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(V4,{className:`h-4 w-4 ${u?"animate-spin":""}`}),l.jsx("span",{children:u?"Mencari...":"Gunakan GPS"})]})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Lokasi Populer"}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:x.map(N=>l.jsxs("button",{onClick:()=>y(N),className:"p-3 text-left bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:[l.jsx("div",{className:"font-medium text-gray-900",children:N.name}),l.jsxs("div",{className:"text-xs text-gray-500",children:[N.lat.toFixed(4),", ",N.lng.toFixed(4)]})]},N.name))})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Input Manual Koordinat"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alamat Kantor *"}),l.jsx("input",{type:"text",value:s,onChange:N=>o(N.target.value),placeholder:"Contoh: Jl. Sudirman No. 1, Jakarta Pusat",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude *"}),l.jsx("input",{type:"number",step:"any",value:r.lat||"",onChange:N=>b("lat",N.target.value),placeholder:"-6.200000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Rentang: -90 hingga 90"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude *"}),l.jsx("input",{type:"number",step:"any",value:r.lng||"",onChange:N=>b("lng",N.target.value),placeholder:"106.816666",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Rentang: -180 hingga 180"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Radius Absensi (meter)"}),l.jsx("input",{type:"number",value:a,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Karyawan harus berada dalam radius ini untuk dapat absen"})]})]})]}),r.lat&&r.lng&&l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Preview Lokasi"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(_i,{className:"h-4 w-4 text-gray-500 mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"text-gray-700",children:s||"Alamat belum diisi"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Latitude:"})," ",r.lat.toFixed(6)]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Longitude:"})," ",r.lng.toFixed(6)]})]}),l.jsxs("div",{className:"text-gray-600",children:[l.jsx("span",{className:"font-medium",children:"Radius Absensi:"})," ",a," meter"]})]})]}),l.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"💡 Tips Mencari Koordinat"}),l.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[l.jsx("p",{children:"• Buka Google Maps di browser"}),l.jsx("p",{children:"• Cari alamat kantor Anda"}),l.jsx("p",{children:"• Klik kanan pada lokasi yang tepat"}),l.jsx("p",{children:"• Pilih koordinat yang muncul (contoh: -6.200000, 106.816666)"}),l.jsx("p",{children:"• Copy dan paste ke form di atas"})]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:n,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Si,{className:"h-4 w-4"}),l.jsx("span",{children:"Batal"})]})}),l.jsx("button",{onClick:m,disabled:!r.lat||!r.lng||!s.trim(),className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Lokasi"})]})})]})]})},aW=()=>{const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(null),[c,d]=ae.useState(!1),[h,p]=ae.useState(100),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(!1);ae.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:{user:A}}=await Te.auth.getUser();if(!A){e("/login");return}const{data:R}=await Te.from("profiles").select("role").eq("id",A.id).single();if(!R||R.role!=="admin"){e("/dashboard");return}n(A),r(R),await N()}catch(A){console.error("Error checking access:",A),e("/login")}finally{s(!1)}},N=async()=>{try{const{data:A,error:R}=await Te.from("system_settings").select("setting_value").eq("setting_key","office_location").maybeSingle();if(R&&R.code!=="PGRST116")throw R;A!=null&&A.setting_value?(u(A.setting_value),p(A.setting_value.radius||100)):u({latitude:-6.2,longitude:106.816666,address:"Jakarta, Indonesia",radius:100})}catch(A){console.error("Error fetching office location:",A),g("Gagal memuat pengaturan lokasi kantor")}},S=async A=>{x(!0),g(null);try{const R={latitude:A.latitude,longitude:A.longitude,address:A.address,radius:h},{error:L}=await Te.from("system_settings").upsert({setting_key:"office_location",setting_value:R,description:"Lokasi kantor utama dan radius absensi",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(L)throw L;u(R),d(!1),w("Lokasi kantor berhasil diperbarui!"),setTimeout(()=>w(null),3e3)}catch(R){console.error("Error saving office location:",R),g("Gagal menyimpan lokasi kantor")}finally{x(!1)}},T=async A=>{if(o){x(!0),g(null);try{const R={...o,radius:parseInt(A)},{error:L}=await Te.from("system_settings").upsert({setting_key:"office_location",setting_value:R,description:"Lokasi kantor utama dan radius absensi",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(L)throw L;u(R),p(parseInt(A)),w("Radius absensi berhasil diperbarui!"),setTimeout(()=>w(null),3e3)}catch(R){console.error("Error updating radius:",R),g("Gagal memperbarui radius absensi")}finally{x(!1)}}},C=()=>{if(o){const A=`https://www.google.com/maps?q=${o.latitude},${o.longitude}`;window.open(A,"_blank")}};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat pengaturan lokasi..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(ql,{user:t,profile:a}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex items-center justify-between py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pengaturan Lokasi Kantor"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Kelola lokasi kantor dan radius absensi tanpa Google Maps"})]})})})}),l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[b&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:b})]}),f&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Eu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:f})]}),c?l.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:l.jsx(nW,{initialLocation:o?{lat:o.latitude,lng:o.longitude,address:o.address}:null,radius:h,onLocationSelect:S,onCancel:()=>d(!1)})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Lokasi Kantor Saat Ini"}),l.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(ji,{className:"h-4 w-4"}),l.jsx("span",{children:"Edit Lokasi"})]})]}),o?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(_i,{className:"h-5 w-5 text-blue-600 mt-1 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Alamat"}),l.jsx("p",{className:"text-gray-600",children:o.address})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Koordinat"}),l.jsxs("p",{className:"text-gray-600",children:[o.latitude.toFixed(6),", ",o.longitude.toFixed(6)]})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Radius Absensi"}),l.jsxs("p",{className:"text-gray-600",children:[o.radius," meter"]})]})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(V4,{className:"h-4 w-4"}),l.jsx("span",{children:"Lihat di Google Maps"})]})})]}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(_i,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500",children:"Lokasi kantor belum diatur"}),l.jsx("button",{onClick:()=>d(!0),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Atur Lokasi Sekarang"})]})]}),o&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Pengaturan Radius Absensi"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Radius Absensi (meter)"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("input",{type:"range",min:"50",max:"500",step:"10",value:h,onChange:A=>p(parseInt(A.target.value)),className:"flex-1"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"number",min:"50",max:"500",value:h,onChange:A=>p(parseInt(A.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("span",{className:"text-gray-600",children:"m"})]})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Karyawan harus berada dalam radius ini untuk dapat melakukan absensi"})]}),l.jsxs("button",{onClick:()=>T(h),disabled:m||h===o.radius,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:m?"Menyimpan...":"Simpan Radius"})]})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"✨ Keunggulan Sistem Tanpa Google Maps"}),l.jsxs("div",{className:"space-y-2 text-sm text-blue-700",children:[l.jsx("p",{children:"• Tidak memerlukan API key Google Maps yang berbayar"}),l.jsx("p",{children:"• Sistem tetap akurat menggunakan koordinat GPS"}),l.jsx("p",{children:"• Mudah digunakan dengan preset lokasi populer"}),l.jsx("p",{children:"• Dapat menggunakan GPS untuk mendapatkan lokasi saat ini"}),l.jsx("p",{children:"• Koordinat dapat dicari manual dari Google Maps"}),l.jsx("p",{children:"• Sistem validasi radius tetap berfungsi dengan sempurna"})]})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"📋 Cara Menggunakan"}),l.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"1. Gunakan GPS:"}),' Klik "Gunakan GPS" untuk otomatis mengisi koordinat lokasi saat ini']}),l.jsxs("p",{children:[l.jsx("strong",{children:"2. Pilih Preset:"})," Pilih dari lokasi populer yang sudah tersedia"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"3. Input Manual:"})," Cari koordinat di Google Maps dan input manual"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"4. Atur Radius:"})," Sesuaikan radius absensi sesuai kebutuhan (50-500 meter)"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"5. Simpan:"})," Klik simpan untuk menerapkan pengaturan"]})]})]})]})]})]})]})},rW=()=>{const e=hr(),[t,n]=ae.useState([]),[a,r]=ae.useState(!0),[i,s]=ae.useState(!1),[o,u]=ae.useState(""),[c,d]=ae.useState(!1),[h,p]=ae.useState(null),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(null),[S,T]=ae.useState({bank_name:"",bank_code:"",bank_logo:"",description:"",is_active:!0});ae.useEffect(()=>{C()},[]);const C=async()=>{try{const{data:{user:U}}=await Te.auth.getUser();if(!U){e("/login");return}const{data:I}=await Te.from("profiles").select("role").eq("id",U.id).single();if(!I||I.role!=="admin"){e("/dashboard");return}x(U),N(I),await A()}catch(U){console.error("Error checking access:",U),e("/login")}finally{r(!1)}},A=async()=>{s(!0);try{const{data:U,error:I}=await Te.from("bank_info").select("*").order("bank_name");if(I)throw I;n(U||[])}catch(U){console.error("Error fetching banks:",U),g("Gagal memuat data bank")}finally{s(!1)}},R=U=>{const{name:I,value:F,type:q,checked:O}=U.target;T($=>({...$,[I]:q==="checkbox"?O:F}))},L=()=>{T({bank_name:"",bank_code:"",bank_logo:"",description:"",is_active:!0}),p(null),d(!1),g(null)},j=async U=>{if(U.preventDefault(),g(null),!S.bank_name.trim()){g("Nama bank harus diisi");return}s(!0);try{const I={...S,updated_at:new Date().toISOString()};if(h){const{error:F}=await Te.from("bank_info").update(I).eq("id",h.id);if(F)throw F;w("Bank berhasil diperbarui!")}else{I.created_at=new Date().toISOString();const{error:F}=await Te.from("bank_info").insert([I]);if(F)throw F;w("Bank berhasil ditambahkan!")}L(),await A(),setTimeout(()=>w(null),3e3)}catch(I){console.error("Error saving bank:",I),g("Gagal menyimpan bank: "+I.message)}finally{s(!1)}},D=U=>{T({bank_name:U.bank_name,bank_code:U.bank_code||"",bank_logo:U.bank_logo||"",description:U.description||"",is_active:U.is_active}),p(U),d(!0)},B=async U=>{if(confirm("Apakah Anda yakin ingin menghapus bank ini?")){s(!0);try{const{data:I,error:F}=await Te.from("profiles").select("id").eq("bank_id",U).limit(1);if(F)throw F;if(I&&I.length>0){g("Bank tidak dapat dihapus karena masih digunakan oleh karyawan");return}const{error:q}=await Te.from("bank_info").delete().eq("id",U);if(q)throw q;w("Bank berhasil dihapus!"),await A(),setTimeout(()=>w(null),3e3)}catch(I){console.error("Error deleting bank:",I),g("Gagal menghapus bank: "+I.message)}finally{s(!1)}}},z=t.filter(U=>U.bank_name.toLowerCase().includes(o.toLowerCase())||U.bank_code&&U.bank_code.toLowerCase().includes(o.toLowerCase())||U.description&&U.description.toLowerCase().includes(o.toLowerCase()));return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data bank..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row",children:[l.jsx(ql,{user:m,profile:y,className:"w-full md:w-64 md:fixed md:h-screen"}),l.jsxs("div",{className:"flex-1 md:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Bank"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, dan kelola daftar bank untuk pembayaran gaji"})]}),l.jsxs("button",{onClick:()=>d(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[l.jsx(R0,{className:"h-4 w-4"}),l.jsx("span",{children:"Tambah Bank"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[b&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:b}),l.jsx("button",{onClick:()=>w(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),f&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:f}),l.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ha,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Bank"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Vt,{className:"h-5 w-5 text-green-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bank Aktif"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.filter(U=>U.is_active).length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(xo,{className:"h-5 w-5 text-purple-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pembayaran"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:"Transfer Bank"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(Hd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari bank...",value:o,onChange:U=>u(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ha,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base font-medium text-gray-900",children:["Daftar Bank (",z.length,")"]})]})}),i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):z.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ha,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada bank ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau tambah bank baru"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Bank"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kode Bank"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(U=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:U.bank_logo?l.jsx("img",{src:U.bank_logo,alt:U.bank_name,className:"h-6 w-6 object-contain"}):l.jsx(ha,{className:"h-4 w-4 text-blue-600"})}),l.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.bank_name})]})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(CE,{className:"h-4 w-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-900",children:U.bank_code||"-"})]})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:U.description||"-"}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>D(U),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit Bank",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>B(U.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",title:"Hapus Bank",children:l.jsx(Sd,{className:"h-4 w-4"})})]})})]},U.id))})]}),l.jsx("div",{className:"md:hidden p-4 space-y-4",children:z.map(U=>l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:U.bank_logo?l.jsx("img",{src:U.bank_logo,alt:U.bank_name,className:"h-6 w-6 object-contain"}):l.jsx(ha,{className:"h-4 w-4 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.bank_name}),U.description&&l.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:U.description})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>D(U),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",children:l.jsx(ji,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>B(U.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",children:l.jsx(Sd,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Kode Bank:"})," ",U.bank_code||"-"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})]})]})]},U.id))})]})]})]})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md sm:max-w-lg bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:h?"Edit Bank":"Tambah Bank Baru"}),l.jsx("button",{onClick:L,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Si,{className:"h-5 w-5"})})]}),l.jsxs("form",{onSubmit:j,className:"space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Informasi Bank"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Bank *"}),l.jsx("input",{type:"text",name:"bank_name",value:S.bank_name,onChange:R,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: BCA, Mandiri, BNI"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kode Bank"}),l.jsx("input",{type:"text",name:"bank_code",value:S.bank_code,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: 014, 008, 009"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL Logo Bank"}),l.jsx("input",{type:"text",name:"bank_logo",value:S.bank_logo,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"https://example.com/logo.png"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Masukkan URL gambar logo bank (opsional)"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),l.jsx("textarea",{name:"description",value:S.description,onChange:R,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Deskripsi singkat tentang bank..."})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_active",checked:S.is_active,onChange:R,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Bank aktif"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Batal"}),l.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-4 w-4"}),l.jsx("span",{children:h?"Perbarui Bank":"Simpan Bank"})]})})]})]})]})})})]})},iW=()=>{const e=hr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState([]),[h,p]=ae.useState([]),[f,g]=ae.useState(""),[b,w]=ae.useState(""),[m,x]=ae.useState(""),[y,N]=ae.useState(""),[S,T]=ae.useState(new Date),[C,A]=ae.useState(null),[R,L]=ae.useState(null),[j,D]=ae.useState(!1),[B,z]=ae.useState({startTime:"08:00",endTime:"17:00",lateThreshold:15,earlyLeaveThreshold:15,breakDuration:60}),[U,I]=ae.useState(!1),[F,q]=ae.useState(window.innerWidth<768);ae.useEffect(()=>{const we=()=>{q(window.innerWidth<768)};return window.addEventListener("resize",we),()=>window.removeEventListener("resize",we)},[]),ae.useEffect(()=>{O()},[]),ae.useEffect(()=>{t&&$()},[t]),ae.useEffect(()=>{S&&t&&W(S)},[S,t]);const O=async()=>{try{const{data:{user:we}}=await Te.auth.getUser();if(!we){e("/login");return}const{data:xe}=await Te.from("profiles").select("role").eq("id",we.id).single();if(!xe||xe.role!=="admin"){e("/dashboard");return}n(we),r(xe),await Promise.all([P(),W(new Date)])}catch(we){console.error("Error checking access:",we),e("/login")}finally{s(!1)}},$=async()=>{try{const{data:we,error:xe}=await Te.from("system_settings").select("setting_value").eq("setting_key","work_hours").single();if(xe&&xe.code!=="PGRST116")throw xe;we!=null&&we.setting_value&&z(ne=>({...ne,...we.setting_value}))}catch(we){console.error("Error fetching work hours settings:",we)}},Z=async()=>{try{const{error:we}=await Te.from("system_settings").upsert({setting_key:"work_hours",setting_value:B,description:"Standard working hours configuration",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(we)throw we;L("Pengaturan jam kerja berhasil disimpan!"),D(!1),setTimeout(()=>L(null),3e3)}catch(we){console.error("Error saving work hours settings:",we),A("Gagal menyimpan pengaturan jam kerja")}},P=async()=>{try{const{data:we,error:xe}=await Te.from("profiles").select("id, name, email, employee_id, department, role, status").order("name");if(xe)throw xe;p(we||[])}catch(we){console.error("Error fetching employees:",we)}},W=async we=>{u(!0);try{const xe=we.toISOString().split("T")[0],ne=`${xe}T00:00:00`,Qe=`${xe}T23:59:59`,{data:Je,error:Ae}=await Te.from("attendance").select(`
          *,
          profiles:user_id(id, name, email, employee_id, department, role, status)
        `).gte("timestamp",ne).lte("timestamp",Qe).order("timestamp",{ascending:!1});if(Ae)throw Ae;const{data:Ge,error:_e}=await Te.from("profiles").select("id, name, email, employee_id, department, role, status").eq("status","active").neq("role","admin");if(_e)throw _e;const de=new Set(Je.filter(He=>He.type==="masuk"&&He.status==="berhasil").map(He=>He.user_id)),ke=new Date,Fe=xe===ke.toISOString().split("T")[0],Ze=we<ke,[Xe,oe]=B.endTime.split(":").map(Number),Be=new Date;Be.setHours(Xe,oe,0,0);const Ke=new Date(Be);Ke.setMinutes(Ke.getMinutes()+30);const et=Ze||Fe&&ke>=Ke;if(Fe&&et||Ze){const wt=Ge.filter(dt=>!de.has(dt.id)&&dt.role!=="admin").map(dt=>({id:`absent-${dt.id}-${xe}`,user_id:dt.id,type:"absent",timestamp:`${xe}T${Ke.toTimeString().slice(0,8)}`,status:"tidak_hadir",is_late:!1,late_minutes:0,work_hours:0,overtime_hours:0,profiles:dt,notes:`Tidak hadir - tidak melakukan absensi masuk hingga ${Ke.toTimeString().slice(0,5)}`}));d([...Je,...wt])}else d(Je||[])}catch(xe){console.error("Error fetching attendance by date:",xe),A("Gagal memuat data absensi")}finally{u(!1)}},K=we=>{T(new Date(we.target.value))},J=()=>{if(c.length===0)return;const xe=[["Tanggal","Waktu","Karyawan","ID Karyawan","Departemen","Jenis","Status","Terlambat","Menit Terlambat","Jam Kerja","Lembur","Latitude","Longitude"],...c.map(Ae=>{var ke,Fe,Ze;const Ge=new Date(Ae.timestamp),_e=Ge.toLocaleDateString("id-ID"),de=Ge.toLocaleTimeString("id-ID");return[_e,de,((ke=Ae.profiles)==null?void 0:ke.name)||"Unknown",((Fe=Ae.profiles)==null?void 0:Fe.employee_id)||"-",((Ze=Ae.profiles)==null?void 0:Ze.department)||"-",Ae.type==="masuk"?"Masuk":Ae.type==="keluar"?"Keluar":"Tidak Hadir",Ae.status,Ae.is_late?"Ya":"Tidak",Ae.late_minutes||"0",Ae.work_hours||"0",Ae.overtime_hours||"0",Ae.latitude||"",Ae.longitude||""]})].map(Ae=>Ae.join(",")).join(`
`),ne=new Blob([xe],{type:"text/csv;charset=utf-8;"}),Qe=document.createElement("a"),Je=URL.createObjectURL(ne);Qe.setAttribute("href",Je),Qe.setAttribute("download",`attendance_${S.toISOString().split("T")[0]}.csv`),document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe),URL.revokeObjectURL(Je)},H=we=>{switch(we){case"berhasil":return"text-green-600 bg-green-100";case"wajah_tidak_valid":return"text-red-600 bg-red-100";case"lokasi_tidak_valid":return"text-yellow-600 bg-yellow-100";case"tidak_hadir":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},ie=we=>{switch(we){case"berhasil":return l.jsx(Vt,{className:"h-4 w-4"});case"wajah_tidak_valid":case"lokasi_tidak_valid":return l.jsx(Rn,{className:"h-4 w-4"});case"tidak_hadir":return l.jsx(Rn,{className:"h-4 w-4"});default:return l.jsx(Ln,{className:"h-4 w-4"})}},ue=we=>{switch(we){case"berhasil":return"Berhasil";case"wajah_tidak_valid":return"Wajah Invalid";case"lokasi_tidak_valid":return"Lokasi Invalid";case"tidak_hadir":return"Tidak Hadir";default:return"Gagal"}},ce=we=>new Date(we).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),pe=we=>we.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),ve=we=>{const{name:xe,value:ne}=we.target;z(Qe=>({...Qe,[xe]:ne}))},De=c.filter(we=>{var Ae,Ge,_e,de;const xe=((Ae=we.profiles)==null?void 0:Ae.name)&&we.profiles.name.toLowerCase().includes(f.toLowerCase())||((Ge=we.profiles)==null?void 0:Ge.email)&&we.profiles.email.toLowerCase().includes(f.toLowerCase())||((_e=we.profiles)==null?void 0:_e.employee_id)&&we.profiles.employee_id.toLowerCase().includes(f.toLowerCase()),ne=!b||((de=we.profiles)==null?void 0:de.department)===b,Qe=!m||we.status===m,Je=!y||we.type===y;return xe&&ne&&Qe&&Je}),Re=()=>[...new Set(h.map(xe=>xe.department).filter(Boolean))];return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-2 text-blue-600",children:[l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4 text-base",children:"Memuat data absensi..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(ql,{user:t,profile:a}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b sticky top-0 z-10",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"py-4 sm:py-6",children:l.jsxs("div",{className:"flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 truncate",children:"Kelola Absensi"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Lihat dan kelola absensi karyawan berdasarkan tanggal"})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsxs("button",{onClick:()=>D(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm min-w-[48px] h-12",children:[l.jsx(vg,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Jam Kerja"})]}),l.jsxs("button",{onClick:()=>{u(!0),W(S).finally(()=>u(!1))},className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm min-w-[48px] h-12",title:"Refresh Data",children:[l.jsx(Ty,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),l.jsxs("button",{onClick:J,disabled:c.length===0,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm h-12",children:[l.jsx(Xf,{className:"h-5 w-5"}),l.jsx("span",{children:"Export CSV"})]})]})]})})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[C&&l.jsxs("div",{className:"mb-4 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Ln,{className:"h-6 w-6 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-red-700 flex-1",children:C}),l.jsx("button",{onClick:()=>A(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Si,{className:"h-5 w-5"})})]}),R&&l.jsxs("div",{className:"mb-4 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Vt,{className:"h-6 w-6 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-green-700 flex-1",children:R}),l.jsx("button",{onClick:()=>L(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Si,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:l.jsx("div",{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Xi,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Pilih Tanggal"})]}),l.jsx("input",{type:"date",value:S.toISOString().split("T")[0],onChange:K,className:"w-full sm:w-48 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-blue-50",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[l.jsx(Xi,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsxs("h2",{className:"text-base sm:text-lg font-medium text-gray-900 truncate",children:["Absensi: ",pe(S)]})]}),l.jsxs("div",{className:"text-sm text-gray-600 flex-shrink-0",children:[De.length," data"]})]})}),l.jsx("div",{className:"p-4 border-b border-gray-200 sticky top-16 z-10 bg-white",children:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Hd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari nama, email, ID...",value:f,onChange:we=>g(we.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),l.jsxs("button",{onClick:()=>I(!U),className:"flex items-center justify-between w-full px-4 py-3 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(H4,{className:"h-5 w-5"}),l.jsx("span",{children:"Filter Data"})]}),U?l.jsx(AE,{className:"h-5 w-5"}):l.jsx(EE,{className:"h-5 w-5"})]}),U&&l.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departemen"}),l.jsxs("select",{value:b,onChange:we=>w(we.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),Re().map(we=>l.jsx("option",{value:we,children:we},we))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),l.jsxs("select",{value:m,onChange:we=>x(we.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"berhasil",children:"Berhasil"}),l.jsx("option",{value:"wajah_tidak_valid",children:"Wajah Invalid"}),l.jsx("option",{value:"lokasi_tidak_valid",children:"Lokasi Invalid"}),l.jsx("option",{value:"tidak_hadir",children:"Tidak Hadir"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jenis"}),l.jsxs("select",{value:y,onChange:we=>N(we.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Jenis"}),l.jsx("option",{value:"masuk",children:"Masuk"}),l.jsx("option",{value:"keluar",children:"Keluar"}),l.jsx("option",{value:"absent",children:"Tidak Hadir"})]})]})]})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-2 text-blue-600",children:[l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):De.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"hidden md:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Waktu"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jenis"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterlambatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lokasi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:De.map(we=>{var xe,ne,Qe,Je;return l.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-base",children:((ne=(xe=we.profiles)==null?void 0:xe.name)==null?void 0:ne.charAt(0).toUpperCase())||"?"})}),l.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:((Qe=we.profiles)==null?void 0:Qe.name)||"Unknown"}),l.jsx("div",{className:"text-xs text-gray-500 truncate",children:((Je=we.profiles)==null?void 0:Je.employee_id)||"-"})]})]})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:ce(we.timestamp)}),l.jsx("div",{className:"text-xs text-gray-500",children:pe(new Date(we.timestamp))})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize",children:we.type==="masuk"?"Masuk":we.type==="keluar"?"Keluar":"Tidak Hadir"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:`inline-flex items-center space-x-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${H(we.status)}`,children:[ie(we.status),l.jsx("span",{children:ue(we.status)})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:we.is_late?l.jsx("div",{className:"text-sm text-red-600",children:l.jsxs("span",{className:"font-medium",children:["Terlambat ",we.late_minutes," menit"]})}):l.jsx("div",{className:"text-sm text-green-600",children:l.jsx("span",{className:"font-medium",children:"Tepat Waktu"})})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:we.latitude&&we.longitude?l.jsxs("div",{className:"flex items-center",children:[l.jsx(_i,{className:"h-5 w-5 mr-1 text-gray-400"}),l.jsxs("span",{className:"text-xs",children:[we.latitude.toFixed(4),", ",we.longitude.toFixed(4)]})]}):l.jsx("span",{className:"text-gray-400 text-xs",children:"Tidak ada lokasi"})})]},we.id)})})]})}),l.jsx("div",{className:"md:hidden space-y-4 p-4",children:De.map(we=>{var xe,ne,Qe,Je,Ae;return l.jsxs("div",{className:"bg-gray-50 rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[l.jsx("div",{className:"flex-shrink-0 h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-lg",children:((ne=(xe=we.profiles)==null?void 0:xe.name)==null?void 0:ne.charAt(0).toUpperCase())||"?"})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-base font-medium text-gray-900 truncate",children:((Qe=we.profiles)==null?void 0:Qe.name)||"Unknown"}),l.jsxs("p",{className:"text-sm text-gray-500 truncate",children:[((Je=we.profiles)==null?void 0:Je.employee_id)||"-"," • ",((Ae=we.profiles)==null?void 0:Ae.department)||"-"]})]})]}),l.jsxs("div",{className:"text-right flex-shrink-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-800 whitespace-nowrap",children:ce(we.timestamp)}),l.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap",children:pe(new Date(we.timestamp))})]})]}),l.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[l.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-sm font-medium ${H(we.status)}`,children:[ie(we.status),l.jsx("span",{className:"ml-1",children:ue(we.status)})]}),l.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 capitalize",children:we.type==="masuk"?"Masuk":we.type==="keluar"?"Keluar":"Tidak Hadir"})]}),l.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[l.jsx("div",{children:we.is_late?l.jsxs("p",{className:"text-sm text-red-600",children:["Terlambat ",we.late_minutes," menit"]}):l.jsx("p",{className:"text-sm text-green-600",children:"Tepat Waktu"})}),we.latitude&&we.longitude&&l.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[l.jsx(_i,{className:"h-4 w-4 mr-1"}),l.jsxs("span",{children:[we.latitude.toFixed(2),", ",we.longitude.toFixed(2)]})]})]})]},we.id)})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(El,{className:"h-10 w-10 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg",children:"Tidak ada data absensi pada tanggal ini"})]})]})]})]}),j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pengaturan Jam Kerja"}),l.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Si,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Masuk"}),l.jsx("input",{type:"time",name:"startTime",value:B.startTime,onChange:ve,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Keluar"}),l.jsx("input",{type:"time",name:"endTime",value:B.endTime,onChange:ve,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toleransi Keterlambatan (menit)"}),l.jsx("input",{type:"number",name:"lateThreshold",value:B.lateThreshold,onChange:ve,min:"0",max:"60",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Karyawan dianggap terlambat jika masuk setelah jam masuk + toleransi"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toleransi Pulang Cepat (menit)"}),l.jsx("input",{type:"number",name:"earlyLeaveThreshold",value:B.earlyLeaveThreshold,onChange:ve,min:"0",max:"60",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Karyawan dianggap pulang cepat jika keluar sebelum jam keluar - toleransi"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durasi Istirahat (menit)"}),l.jsx("input",{type:"number",name:"breakDuration",value:B.breakDuration,onChange:ve,min:"0",max:"120",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(lo,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"font-medium text-blue-900 text-base",children:"Pengaturan Absensi Otomatis"})]}),l.jsx("p",{className:"text-sm text-blue-700",children:'Sistem akan otomatis menandai karyawan sebagai "Tidak Hadir" jika:'}),l.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1 pl-5 list-disc",children:[l.jsx("li",{children:"Sudah melewati jam keluar kerja"}),l.jsx("li",{children:"Tidak ada catatan absensi masuk pada hari tersebut"}),l.jsx("li",{children:"Karyawan berstatus aktif (bukan admin)"})]})]}),l.jsxs("div",{className:"flex space-x-4 pt-4",children:[l.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Batal"}),l.jsx("button",{onClick:Z,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Yr,{className:"h-5 w-5"}),l.jsx("span",{children:"Simpan"})]})})]})]})]})})})]})},sW=ae.createContext(),oW={id:{loading:"Memuat...",save:"Simpan",cancel:"Batal",edit:"Edit",delete:"Hapus",add:"Tambah",search:"Cari",filter:"Filter",back:"Kembali",next:"Selanjutnya",previous:"Sebelumnya",submit:"Kirim",close:"Tutup",confirm:"Konfirmasi",success:"Berhasil",error:"Error",warning:"Peringatan",info:"Informasi",note:"Catatan",notSet:"Belum diatur",from:"dari",days:"hari",minutes:"menit",hours:"jam",office:"Kantor",login:"Masuk",logout:"Keluar",register:"Daftar",email:"Email",password:"Password",confirmPassword:"Konfirmasi Password",forgotPassword:"Lupa Password",rememberMe:"Ingat Saya",loginTitle:"Portal Karyawan",loginSubtitle:"Masuk untuk mengakses sistem absensi",registerTitle:"Daftar Akun Baru",welcomeBack:"Selamat Datang Kembali",createAccount:"Buat Akun Baru",emailPlaceholder:"Masukkan email Anda",passwordPlaceholder:"Masukkan password Anda",loggingIn:"Sedang Masuk...",registerSuccess:"Pendaftaran Berhasil!",noAccount:"Belum punya akun?",registerHere:"Daftar di sini",demoInfo:"Info",demoDescription:"Pilih role sesuai akses yang diinginkan saat mendaftar",dashboard:"Dashboard",welcome:"Selamat Datang",todayAttendance:"Absensi Hari Ini",monthlyStats:"Statistik Bulanan",recentActivity:"Aktivitas Terbaru",quickActions:"Aksi Cepat",quickAccess:"Akses Manajemen",monthlyAttendance:"Hadir Bulan Ini",onTime:"Tepat Waktu",late:"Terlambat",monthlySalary:"Gaji Bulan Ini",dailySalary:"Gaji Harian",perWorkDay:"per hari kerja",noAttendanceToday:"Belum ada absensi hari ini",attendNow:"Absen Sekarang",noActivity:"Belum ada aktivitas",moreWarnings:"peringatan lainnya",activeWarnings:"Peringatan Aktif",attendance:"Absensi",checkIn:"Masuk",checkOut:"Keluar",attendanceHistory:"Riwayat Absensi",attendanceReport:"Laporan Absensi",lateArrival:"Terlambat",absent:"Tidak Hadir",present:"Hadir",workHours:"Jam Kerja",overtime:"Lembur",faceVerification:"Verifikasi Wajah",locationVerification:"Verifikasi Lokasi",attendanceSummary:"Ringkasan Kehadiran",employees:"Karyawan",employee:"Karyawan",employeeManagement:"Kelola Karyawan",addEmployee:"Tambah Karyawan",editEmployee:"Edit Karyawan",employeeDetails:"Detail Karyawan",personalInfo:"Informasi Pribadi",employmentInfo:"Informasi Pekerjaan",bankingInfo:"Informasi Bank",fullName:"Nama Lengkap",phoneNumber:"Nomor Telepon",address:"Alamat",birthDate:"Tanggal Lahir",gender:"Jenis Kelamin",male:"Laki-laki",female:"Perempuan",position:"Jabatan",department:"Departemen",salary:"Gaji",joinDate:"Tanggal Bergabung",status:"Status",active:"Aktif",inactive:"Tidak Aktif",terminated:"Diberhentikan",bankName:"Nama Bank",bankAccountNumber:"Nomor Rekening",bankAccountName:"Nama Pemegang Rekening",salaryManagement:"Kelola Gaji",positionManagement:"Kelola Jabatan",positions:"Jabatan",addPosition:"Tambah Jabatan",editPosition:"Edit Jabatan",baseSalary:"Gaji Pokok",minSalary:"Gaji Minimum",maxSalary:"Gaji Maksimum",salaryRange:"Rentang Gaji",bonus:"Bonus",deduction:"Potongan",netSalary:"Gaji Bersih",salaryInfo:"Informasi Gaji",settings:"Pengaturan",systemSettings:"Pengaturan Sistem",attendanceSettings:"Pengaturan Absensi",locationSettings:"Pengaturan Lokasi",workingHours:"Jam Kerja",workStartTime:"Jam Masuk",workEndTime:"Jam Keluar",lateThreshold:"Batas Terlambat",earlyLeaveThreshold:"Batas Pulang Cepat",breakDuration:"Durasi Istirahat",officeLocation:"Lokasi Kantor",allowedRadius:"Radius Diizinkan",language:"Bahasa",indonesian:"Bahasa Indonesia",english:"English",systemSettingsDesc:"Kelola lokasi kantor dan radius",reports:"Laporan",salaryReport:"Laporan Gaji",employeeReport:"Laporan Karyawan",exportReport:"Export Laporan",dateRange:"Rentang Tanggal",startDate:"Tanggal Mulai",endDate:"Tanggal Selesai",reportsDesc:"Lihat dan export laporan kehadiran",profile:"Profil",myProfile:"Profil Saya",editProfile:"Edit Profil",changePassword:"Ubah Password",currentPassword:"Password Saat Ini",newPassword:"Password Baru",profilePicture:"Foto Profil",uploadPhoto:"Upload Foto",adminPanel:"Panel Admin",adminRole:"Administrator",employeeRole:"Karyawan",adminDescription:"Kelola semua pengguna dan sistem",employeeDescription:"Absensi pribadi dan riwayat",userManagement:"Kelola Karyawan",userManagementDesc:"Tambah, edit, dan kelola data karyawan",systemLogs:"Log Sistem",activityLogs:"Log Aktivitas",passwordChanges:"Perubahan Password",systemHealth:"Kesehatan Sistem",backupRestore:"Backup & Restore",faceRegistration:"Lengkapi Profil",faceCapture:"Ambil Foto Wajah",faceDetected:"Wajah Terdeteksi",faceNotDetected:"Wajah Tidak Terdeteksi",faceQuality:"Kualitas Wajah",retakePhoto:"Ambil Ulang Foto",faceRegistered:"Wajah Terdaftar",faceNotRegistered:"Profil Belum Lengkap",faceRegistrationRequired:"Anda perlu menambahkan foto wajah untuk dapat melakukan absensi dengan verifikasi wajah.",faceRegistrationDesc:"Untuk dapat melakukan absensi dengan verifikasi wajah, Anda perlu menambahkan foto wajah ke profil.",faceRegistrationNote:"Tanpa foto wajah, Anda tidak dapat melakukan absensi dengan verifikasi keamanan.",registerFace:"Setup Foto Wajah",currentLocation:"Lokasi Saat Ini",officeRadius:"Radius Kantor",insideOfficeArea:"Dalam Area Kantor",outsideOfficeArea:"Di Luar Area Kantor",locationAccuracy:"Akurasi Lokasi",gpsEnabled:"GPS Aktif",gpsDisabled:"GPS Tidak Aktif"},en:{loading:"Loading...",save:"Save",cancel:"Cancel",edit:"Edit",delete:"Delete",add:"Add",search:"Search",filter:"Filter",back:"Back",next:"Next",previous:"Previous",submit:"Submit",close:"Close",confirm:"Confirm",success:"Success",error:"Error",warning:"Warning",info:"Information",note:"Note",notSet:"Not Set",from:"from",days:"days",minutes:"minutes",hours:"hours",office:"Office",login:"Login",logout:"Logout",register:"Register",email:"Email",password:"Password",confirmPassword:"Confirm Password",forgotPassword:"Forgot Password",rememberMe:"Remember Me",loginTitle:"Employee Portal",loginSubtitle:"Login to access attendance system",registerTitle:"Create New Account",welcomeBack:"Welcome Back",createAccount:"Create New Account",emailPlaceholder:"Enter your email",passwordPlaceholder:"Enter your password",loggingIn:"Logging in...",registerSuccess:"Registration Successful!",noAccount:"Don't have an account?",registerHere:"Register here",demoInfo:"Info",demoDescription:"Choose role according to desired access when registering",dashboard:"Dashboard",welcome:"Welcome",todayAttendance:"Today's Attendance",monthlyStats:"Monthly Statistics",recentActivity:"Recent Activity",quickActions:"Quick Actions",quickAccess:"Management Access",monthlyAttendance:"Monthly Attendance",onTime:"On Time",late:"Late",monthlySalary:"Monthly Salary",dailySalary:"Daily Salary",perWorkDay:"per work day",noAttendanceToday:"No attendance today",attendNow:"Attend Now",noActivity:"No activity",moreWarnings:"more warnings",activeWarnings:"Active Warnings",attendance:"Attendance",checkIn:"Check In",checkOut:"Check Out",attendanceHistory:"Attendance History",attendanceReport:"Attendance Report",lateArrival:"Late",absent:"Absent",present:"Present",workHours:"Work Hours",overtime:"Overtime",faceVerification:"Face Verification",locationVerification:"Location Verification",attendanceSummary:"Attendance Summary",employees:"Employees",employee:"Employee",employeeManagement:"Employee Management",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",bankingInfo:"Banking Information",fullName:"Full Name",phoneNumber:"Phone Number",address:"Address",birthDate:"Birth Date",gender:"Gender",male:"Male",female:"Female",position:"Position",department:"Department",salary:"Salary",joinDate:"Join Date",status:"Status",active:"Active",inactive:"Inactive",terminated:"Terminated",bankName:"Bank Name",bankAccountNumber:"Account Number",bankAccountName:"Account Holder Name",salaryManagement:"Salary Management",positionManagement:"Position Management",positions:"Positions",addPosition:"Add Position",editPosition:"Edit Position",baseSalary:"Base Salary",minSalary:"Minimum Salary",maxSalary:"Maximum Salary",salaryRange:"Salary Range",bonus:"Bonus",deduction:"Deduction",netSalary:"Net Salary",salaryInfo:"Salary Information",settings:"Settings",systemSettings:"System Settings",attendanceSettings:"Attendance Settings",locationSettings:"Location Settings",workingHours:"Working Hours",workStartTime:"Work Start Time",workEndTime:"Work End Time",lateThreshold:"Late Threshold",earlyLeaveThreshold:"Early Leave Threshold",breakDuration:"Break Duration",officeLocation:"Office Location",allowedRadius:"Allowed Radius",language:"Language",indonesian:"Bahasa Indonesia",english:"English",systemSettingsDesc:"Manage office location and radius",reports:"Reports",salaryReport:"Salary Report",employeeReport:"Employee Report",exportReport:"Export Report",dateRange:"Date Range",startDate:"Start Date",endDate:"End Date",reportsDesc:"View and export attendance reports",profile:"Profile",myProfile:"My Profile",editProfile:"Edit Profile",changePassword:"Change Password",currentPassword:"Current Password",newPassword:"New Password",profilePicture:"Profile Picture",uploadPhoto:"Upload Photo",adminPanel:"Admin Panel",adminRole:"Administrator",employeeRole:"Employee",adminDescription:"Manage all users and system",employeeDescription:"Personal attendance and history",userManagement:"User Management",userManagementDesc:"Add, edit, and manage employee data",systemLogs:"System Logs",activityLogs:"Activity Logs",passwordChanges:"Password Changes",systemHealth:"System Health",backupRestore:"Backup & Restore",faceRegistration:"Complete Profile",faceCapture:"Capture Face",faceDetected:"Face Detected",faceNotDetected:"Face Not Detected",faceQuality:"Face Quality",retakePhoto:"Retake Photo",faceRegistered:"Face Registered",faceNotRegistered:"Profile Incomplete",faceRegistrationRequired:"You need to add a face photo to perform attendance with face verification.",faceRegistrationDesc:"To perform attendance with face verification, you need to add a face photo to your profile.",faceRegistrationNote:"Without a face photo, you cannot perform attendance with security verification.",registerFace:"Setup Face Photo",currentLocation:"Current Location",officeRadius:"Office Radius",insideOfficeArea:"Inside Office Area",outsideOfficeArea:"Outside Office Area",locationAccuracy:"Location Accuracy",gpsEnabled:"GPS Enabled",gpsDisabled:"GPS Disabled"}},lW=({children:e})=>{const[t,n]=ae.useState("id");ae.useEffect(()=>{const s=localStorage.getItem("language");s&&["id","en"].includes(s)&&n(s)},[]);const a=s=>{["id","en"].includes(s)&&(n(s),localStorage.setItem("language",s))},r=Nd.useCallback(s=>{var o;return((o=oW[t])==null?void 0:o[s])||s},[t]),i=Nd.useMemo(()=>({language:t,changeLanguage:a,t:r,isIndonesian:t==="id",isEnglish:t==="en"}),[t,r]);return l.jsx(sW.Provider,{value:i,children:e})};function uW(){return l.jsx(lW,{children:l.jsx("div",{className:"flex flex-col min-h-screen",children:l.jsx(xE,{children:l.jsx(cW,{})})})})}function cW(){const[e,t]=ae.useState(null),[n,a]=ae.useState(!0),[r,i]=ae.useState(null),s=Dy(),o=hr();ae.useEffect(()=>{Te.auth.getSession().then(({data:{session:d},error:h})=>{h?(console.error("Session error:",h),Te.auth.signOut(),t(null)):(t(d),d&&u(d.user.id)),a(!1)}).catch(d=>{console.error("Unexpected session error:",d),Te.auth.signOut(),t(null),a(!1)});const{data:{subscription:c}}=Te.auth.onAuthStateChange((d,h)=>{t(h),h?u(h.user.id):i(null)});return()=>c.unsubscribe()},[]),ae.useEffect(()=>{!["/login","/register","/dashboard","/profile-setup","/history","/admin","/admin/users","/admin/departments","/admin/positions","/admin/salary-payment","/admin/location","/admin/bank","/admin/attendance","/"].some(h=>s.pathname===h||h!=="/"&&s.pathname.startsWith(h+"/"))&&!n&&o(e?r==="admin"?"/admin":"/dashboard":"/login")},[s.pathname,n,e,r,o]);const u=async c=>{try{const{data:d,error:h}=await Te.from("profiles").select("role").eq("id",c).single();if(h)throw h;i(d.role)}catch(d){console.error("Error fetching user role:",d),i(null)}};return n?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat aplikasi..."})]})}):l.jsx("div",{className:"flex flex-col flex-1",children:l.jsxs(bE,{children:[l.jsx(ur,{path:"/login",element:e?r==="admin"?l.jsx(Fn,{to:"/admin",replace:!0}):l.jsx(Fn,{to:"/dashboard",replace:!0}):l.jsx(ZP,{})}),l.jsx(ur,{path:"/register",element:e?r==="admin"?l.jsx(Fn,{to:"/admin",replace:!0}):l.jsx(Fn,{to:"/dashboard",replace:!0}):l.jsx(eU,{})}),l.jsx(ur,{path:"/dashboard",element:e?r==="admin"?l.jsx(Fn,{to:"/admin",replace:!0}):l.jsx(Wq,{}):l.jsx(Fn,{to:"/login",replace:!0})}),l.jsx(ur,{path:"/profile-setup",element:e?l.jsx(tW,{}):l.jsx(Fn,{to:"/login",replace:!0})}),l.jsx(ur,{path:"/history",element:e?l.jsx(cA,{}):l.jsx(Fn,{to:"/login",replace:!0})}),l.jsx(ur,{path:"/admin",element:e&&r==="admin"?l.jsx($H,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/users",element:e&&r==="admin"?l.jsx(XH,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/departments",element:e&&r==="admin"?l.jsx(ZH,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/positions",element:e&&r==="admin"?l.jsx(eW,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/salary-payment",element:e&&r==="admin"?l.jsx(QH,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/location",element:e&&r==="admin"?l.jsx(aW,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/bank",element:e&&r==="admin"?l.jsx(rW,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/admin/attendance",element:e&&r==="admin"?l.jsx(iW,{}):l.jsx(Fn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(ur,{path:"/",element:e?r==="admin"?l.jsx(Fn,{to:"/admin",replace:!0}):l.jsx(Fn,{to:"/dashboard",replace:!0}):l.jsx(Fn,{to:"/login",replace:!0})}),l.jsx(ur,{path:"*",element:e?r==="admin"?l.jsx(Fn,{to:"/admin",replace:!0}):l.jsx(Fn,{to:"/dashboard",replace:!0}):l.jsx(Fn,{to:"/login",replace:!0})})]})})}sR.createRoot(document.getElementById("root")).render(l.jsx(ae.StrictMode,{children:l.jsx(uW,{})}));export{E8 as R,ln as _,tv as a};
