const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BO1yNtnY.js","assets/vendor-G3Ew41wm.js","assets/router-CVrnbT5v.js","assets/supabase-p-WtcZUz.js","assets/icons-CzQ7AwXB.js","assets/index.es-DkLo0d7-.js"])))=>i.map(i=>d[i]);
import{r as ae,a as uT,b as Fg,d as iS,g as cT,c as Qx}from"./vendor-G3Ew41wm.js";import{u as wr,a as S2,L as dT,B as hT,R as fT,b as vr,N as Vn}from"./router-CVrnbT5v.js";import{c as pT,_ as Bg}from"./supabase-p-WtcZUz.js";import{I as k1,B as sS,C as zu,M as ev,L as _l,E as mT,a as S1,b as gT,c as $t,U as oS,d as br,S as Zc,e as Ld,f as Fl,g as vT,h as Rn,i as qi,j as Wi,k as ls,l as vo,X as Ui,m as Uu,F as Bl,T as Pn,A as lS,R as _2,D as cp,n as uS,o as DN,p as cS,q as Rf,r as qu,s as _1,t as xT,u as zg,v as di,P as bT,w as yT,x as cf,y as ya,z as df,G as wT,H as dS,J as tv,K as Jd,N as hS,O as TN,Q as LN,V as Mf,W as fS,Y as NT,Z as kT,_ as ST}from"./icons-CzQ7AwXB.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var pS={exports:{}},nv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _T=Symbol.for("react.transitional.element"),jT=Symbol.for("react.fragment");function mS(e,t,n){var a=null;if(n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),"key"in t){n={};for(var r in t)r!=="key"&&(n[r]=t[r])}else n=t;return t=n.ref,{$$typeof:_T,type:e,key:a,ref:t!==void 0?t:null,props:n}}nv.Fragment=jT;nv.jsx=mS;nv.jsxs=mS;pS.exports=nv;var l=pS.exports,gS={exports:{}},av={},vS={exports:{}},xS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,B){var q=O.length;O.push(B);e:for(;0<q;){var I=q-1>>>1,K=O[I];if(0<r(K,B))O[I]=B,O[q]=K,q=I;else break e}}function n(O){return O.length===0?null:O[0]}function a(O){if(O.length===0)return null;var B=O[0],q=O.pop();if(q!==B){O[0]=q;e:for(var I=0,K=O.length,Z=K>>>1;I<Z;){var R=2*(I+1)-1,H=O[R],$=R+1,X=O[$];if(0>r(H,q))$<K&&0>r(X,H)?(O[I]=X,O[$]=q,I=$):(O[I]=H,O[R]=q,I=R);else if($<K&&0>r(X,q))O[I]=X,O[$]=q,I=$;else break e}}return B}function r(O,B){var q=O.sortIndex-B.sortIndex;return q!==0?q:O.id-B.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],c=[],d=1,h=null,p=3,f=!1,g=!1,b=!1,w=!1,m=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function N(O){for(var B=n(c);B!==null;){if(B.callback===null)a(c);else if(B.startTime<=O)a(c),B.sortIndex=B.expirationTime,t(u,B);else break;B=n(c)}}function S(O){if(b=!1,N(O),!g)if(n(u)!==null)g=!0,D||(D=!0,E());else{var B=n(c);B!==null&&U(S,B.startTime-O)}}var D=!1,_=-1,A=5,L=-1;function P(){return w?!0:!(e.unstable_now()-L<A)}function j(){if(w=!1,D){var O=e.unstable_now();L=O;var B=!0;try{e:{g=!1,b&&(b=!1,x(_),_=-1),f=!0;var q=p;try{t:{for(N(O),h=n(u);h!==null&&!(h.expirationTime>O&&P());){var I=h.callback;if(typeof I=="function"){h.callback=null,p=h.priorityLevel;var K=I(h.expirationTime<=O);if(O=e.unstable_now(),typeof K=="function"){h.callback=K,N(O),B=!0;break t}h===n(u)&&a(u),N(O)}else a(u);h=n(u)}if(h!==null)B=!0;else{var Z=n(c);Z!==null&&U(S,Z.startTime-O),B=!1}}break e}finally{h=null,p=q,f=!1}B=void 0}}finally{B?E():D=!1}}}var E;if(typeof y=="function")E=function(){y(j)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,z=F.port2;F.port1.onmessage=j,E=function(){z.postMessage(null)}}else E=function(){m(j,0)};function U(O,B){_=m(function(){O(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var B=3;break;default:B=p}var q=p;p=B;try{return O()}finally{p=q}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(O,B){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var q=p;p=O;try{return B()}finally{p=q}},e.unstable_scheduleCallback=function(O,B,q){var I=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?I+q:I):q=I,O){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=q+K,O={id:d++,callback:B,priorityLevel:O,startTime:q,expirationTime:K,sortIndex:-1},q>I?(O.sortIndex=q,t(c,O),n(u)===null&&O===n(c)&&(b?(x(_),_=-1):b=!0,U(S,q-I))):(O.sortIndex=K,t(u,O),g||f||(g=!0,D||(D=!0,E()))),O},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(O){var B=p;return function(){var q=p;p=B;try{return O.apply(this,arguments)}finally{p=q}}}})(xS);vS.exports=xS;var CT=vS.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sa=CT,bS=ae,AT=uT;function Ve(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function yS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function dp(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function wS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function PN(e){if(dp(e)!==e)throw Error(Ve(188))}function ET(e){var t=e.alternate;if(!t){if(t=dp(e),t===null)throw Error(Ve(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(a=r.return,a!==null){n=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return PN(r),e;if(i===a)return PN(r),t;i=i.sibling}throw Error(Ve(188))}if(n.return!==a.return)n=r,a=i;else{for(var s=!1,o=r.child;o;){if(o===n){s=!0,n=r,a=i;break}if(o===a){s=!0,a=r,n=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===n){s=!0,n=i,a=r;break}if(o===a){s=!0,a=i,n=r;break}o=o.sibling}if(!s)throw Error(Ve(189))}}if(n.alternate!==a)throw Error(Ve(190))}if(n.tag!==3)throw Error(Ve(188));return n.stateNode.current===n?e:t}function NS(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=NS(e),t!==null)return t;e=e.sibling}return null}var Dn=Object.assign,DT=Symbol.for("react.element"),Im=Symbol.for("react.transitional.element"),rf=Symbol.for("react.portal"),ed=Symbol.for("react.fragment"),kS=Symbol.for("react.strict_mode"),j1=Symbol.for("react.profiler"),TT=Symbol.for("react.provider"),SS=Symbol.for("react.consumer"),xo=Symbol.for("react.context"),j2=Symbol.for("react.forward_ref"),C1=Symbol.for("react.suspense"),A1=Symbol.for("react.suspense_list"),C2=Symbol.for("react.memo"),ll=Symbol.for("react.lazy"),E1=Symbol.for("react.activity"),LT=Symbol.for("react.memo_cache_sentinel"),RN=Symbol.iterator;function Hh(e){return e===null||typeof e!="object"?null:(e=RN&&e[RN]||e["@@iterator"],typeof e=="function"?e:null)}var PT=Symbol.for("react.client.reference");function D1(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===PT?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ed:return"Fragment";case j1:return"Profiler";case kS:return"StrictMode";case C1:return"Suspense";case A1:return"SuspenseList";case E1:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case rf:return"Portal";case xo:return(e.displayName||"Context")+".Provider";case SS:return(e._context.displayName||"Context")+".Consumer";case j2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case C2:return t=e.displayName||null,t!==null?t:D1(e.type)||"Memo";case ll:t=e._payload,e=e._init;try{return D1(e(t))}catch{}}return null}var sf=Array.isArray,kt=bS.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rn=AT.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_u={pending:!1,data:null,method:null,action:null},T1=[],td=-1;function Vs(e){return{current:e}}function Oa(e){0>td||(e.current=T1[td],T1[td]=null,td--)}function Mn(e,t){td++,T1[td]=e.current,e.current=t}var Ms=Vs(null),Of=Vs(null),jl=Vs(null),Ug=Vs(null);function qg(e,t){switch(Mn(jl,t),Mn(Of,e),Mn(Ms,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?B3(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=B3(t),e=Uj(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Oa(Ms),Mn(Ms,e)}function Pd(){Oa(Ms),Oa(Of),Oa(jl)}function L1(e){e.memoizedState!==null&&Mn(Ug,e);var t=Ms.current,n=Uj(t,e.type);t!==n&&(Mn(Of,e),Mn(Ms,n))}function Wg(e){Of.current===e&&(Oa(Ms),Oa(Of)),Ug.current===e&&(Oa(Ug),Gf._currentValue=_u)}var P1=Object.prototype.hasOwnProperty,A2=Sa.unstable_scheduleCallback,Zx=Sa.unstable_cancelCallback,RT=Sa.unstable_shouldYield,MT=Sa.unstable_requestPaint,Os=Sa.unstable_now,OT=Sa.unstable_getCurrentPriorityLevel,_S=Sa.unstable_ImmediatePriority,jS=Sa.unstable_UserBlockingPriority,Hg=Sa.unstable_NormalPriority,IT=Sa.unstable_LowPriority,CS=Sa.unstable_IdlePriority,FT=Sa.log,BT=Sa.unstable_setDisableYieldValue,hp=null,hi=null;function ml(e){if(typeof FT=="function"&&BT(e),hi&&typeof hi.setStrictMode=="function")try{hi.setStrictMode(hp,e)}catch{}}var fi=Math.clz32?Math.clz32:qT,zT=Math.log,UT=Math.LN2;function qT(e){return e>>>=0,e===0?32:31-(zT(e)/UT|0)|0}var Fm=256,Bm=4194304;function pu(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function rv(e,t,n){var a=e.pendingLanes;if(a===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=a&134217727;return o!==0?(a=o&~i,a!==0?r=pu(a):(s&=o,s!==0?r=pu(s):n||(n=o&~e,n!==0&&(r=pu(n))))):(o=a&~i,o!==0?r=pu(o):s!==0?r=pu(s):n||(n=a&~e,n!==0&&(r=pu(n)))),r===0?0:t!==0&&t!==r&&!(t&i)&&(i=r&-r,n=t&-t,i>=n||i===32&&(n&4194048)!==0)?t:r}function fp(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function WT(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AS(){var e=Fm;return Fm<<=1,!(Fm&4194048)&&(Fm=256),e}function ES(){var e=Bm;return Bm<<=1,!(Bm&62914560)&&(Bm=4194304),e}function eb(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function pp(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function HT(e,t,n,a,r,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,u=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var d=31-fi(n),h=1<<d;o[d]=0,u[d]=-1;var p=c[d];if(p!==null)for(c[d]=null,d=0;d<p.length;d++){var f=p[d];f!==null&&(f.lane&=-536870913)}n&=~h}a!==0&&DS(e,a,0),i!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=i&~(s&~t))}function DS(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-fi(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|n&4194090}function TS(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-fi(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}function E2(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function D2(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function LS(){var e=rn.p;return e!==0?e:(e=window.event,e===void 0?32:Jj(e.type))}function VT(e,t){var n=rn.p;try{return rn.p=e,t()}finally{rn.p=n}}var $l=Math.random().toString(36).slice(2),lr="__reactFiber$"+$l,zr="__reactProps$"+$l,Qd="__reactContainer$"+$l,R1="__reactEvents$"+$l,GT="__reactListeners$"+$l,$T="__reactHandles$"+$l,MN="__reactResources$"+$l,mp="__reactMarker$"+$l;function T2(e){delete e[lr],delete e[zr],delete e[R1],delete e[GT],delete e[$T]}function nd(e){var t=e[lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Qd]||n[lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=q3(e);e!==null;){if(n=e[lr])return n;e=q3(e)}return t}e=n,n=e.parentNode}return null}function Zd(e){if(e=e[lr]||e[Qd]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function of(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(Ve(33))}function pd(e){var t=e[MN];return t||(t=e[MN]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ra(e){e[mp]=!0}var PS=new Set,RS={};function Xu(e,t){Rd(e,t),Rd(e+"Capture",t)}function Rd(e,t){for(RS[e]=t,e=0;e<t.length;e++)PS.add(t[e])}var KT=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ON={},IN={};function YT(e){return P1.call(IN,e)?!0:P1.call(ON,e)?!1:KT.test(e)?IN[e]=!0:(ON[e]=!0,!1)}function kg(e,t,n){if(YT(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function zm(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function oo(e,t,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+a)}}var tb,FN;function Hc(e){if(tb===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);tb=t&&t[1]||"",FN=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tb+e+FN}var nb=!1;function ab(e,t){if(!e||nb)return"";nb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(f){var p=f}Reflect.construct(e,[],h)}else{try{h.call()}catch(f){p=f}e.call(h.prototype)}}else{try{throw Error()}catch(f){p=f}(h=e())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(f){if(f&&p&&typeof f.stack=="string")return[f.stack,p.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=a.DetermineComponentFrameRoot(),s=i[0],o=i[1];if(s&&o){var u=s.split(`
`),c=o.split(`
`);for(r=a=0;a<u.length&&!u[a].includes("DetermineComponentFrameRoot");)a++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(a===u.length||r===c.length)for(a=u.length-1,r=c.length-1;1<=a&&0<=r&&u[a]!==c[r];)r--;for(;1<=a&&0<=r;a--,r--)if(u[a]!==c[r]){if(a!==1||r!==1)do if(a--,r--,0>r||u[a]!==c[r]){var d=`
`+u[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=r);break}}}finally{nb=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Hc(n):""}function XT(e){switch(e.tag){case 26:case 27:case 5:return Hc(e.type);case 16:return Hc("Lazy");case 13:return Hc("Suspense");case 19:return Hc("SuspenseList");case 0:case 15:return ab(e.type,!1);case 11:return ab(e.type.render,!1);case 1:return ab(e.type,!0);case 31:return Hc("Activity");default:return""}}function BN(e){try{var t="";do t+=XT(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Li(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function MS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function JT(e){var t=MS(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(s){a=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(s){a=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vg(e){e._valueTracker||(e._valueTracker=JT(e))}function OS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=MS(e)?e.checked?"true":"false":e.value),e=a,e!==n?(t.setValue(e),!0):!1}function Gg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var QT=/[\n"\\]/g;function Oi(e){return e.replace(QT,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function M1(e,t,n,a,r,i,s,o){e.name="",s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"?e.type=s:e.removeAttribute("type"),t!=null?s==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Li(t)):e.value!==""+Li(t)&&(e.value=""+Li(t)):s!=="submit"&&s!=="reset"||e.removeAttribute("value"),t!=null?O1(e,s,Li(t)):n!=null?O1(e,s,Li(n)):a!=null&&e.removeAttribute("value"),r==null&&i!=null&&(e.defaultChecked=!!i),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.name=""+Li(o):e.removeAttribute("name")}function IS(e,t,n,a,r,i,s,o){if(i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"&&(e.type=i),t!=null||n!=null){if(!(i!=="submit"&&i!=="reset"||t!=null))return;n=n!=null?""+Li(n):"",t=t!=null?""+Li(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}a=a??r,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.name=s)}function O1(e,t,n){t==="number"&&Gg(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function md(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+Li(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,a&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function FS(e,t,n){if(t!=null&&(t=""+Li(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Li(n):""}function BS(e,t,n,a){if(t==null){if(a!=null){if(n!=null)throw Error(Ve(92));if(sf(a)){if(1<a.length)throw Error(Ve(93));a=a[0]}n=a}n==null&&(n=""),t=n}n=Li(t),e.defaultValue=n,a=e.textContent,a===n&&a!==""&&a!==null&&(e.value=a)}function Md(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ZT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zN(e,t,n){var a=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,n):typeof n!="number"||n===0||ZT.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function zS(e,t,n){if(t!=null&&typeof t!="object")throw Error(Ve(62));if(e=e.style,n!=null){for(var a in n)!n.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var r in t)a=t[r],t.hasOwnProperty(r)&&n[r]!==a&&zN(e,r,a)}else for(var i in t)t.hasOwnProperty(i)&&zN(e,i,t[i])}function L2(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eL=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tL=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sg(e){return tL.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var I1=null;function P2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ad=null,gd=null;function UN(e){var t=Zd(e);if(t&&(e=t.stateNode)){var n=e[zr]||null;e:switch(e=t.stateNode,t.type){case"input":if(M1(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Oi(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=a[zr]||null;if(!r)throw Error(Ve(90));M1(a,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)a=n[t],a.form===e.form&&OS(a)}break e;case"textarea":FS(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&md(e,!!n.multiple,t,!1)}}}var rb=!1;function US(e,t,n){if(rb)return e(t,n);rb=!0;try{var a=e(t);return a}finally{if(rb=!1,(ad!==null||gd!==null)&&(pv(),ad&&(t=ad,e=gd,gd=ad=null,UN(t),e)))for(t=0;t<e.length;t++)UN(e[t])}}function If(e,t){var n=e.stateNode;if(n===null)return null;var a=n[zr]||null;if(a===null)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Ve(231,t,typeof n));return n}var jo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),F1=!1;if(jo)try{var Vh={};Object.defineProperty(Vh,"passive",{get:function(){F1=!0}}),window.addEventListener("test",Vh,Vh),window.removeEventListener("test",Vh,Vh)}catch{F1=!1}var gl=null,R2=null,_g=null;function qS(){if(_g)return _g;var e,t=R2,n=t.length,a,r="value"in gl?gl.value:gl.textContent,i=r.length;for(e=0;e<n&&t[e]===r[e];e++);var s=n-e;for(a=1;a<=s&&t[n-a]===r[i-a];a++);return _g=r.slice(e,1<a?1-a:void 0)}function jg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Um(){return!0}function qN(){return!1}function Wr(e){function t(n,a,r,i,s){this._reactName=n,this._targetInst=r,this.type=a,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Um:qN,this.isPropagationStopped=qN,this}return Dn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Um)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Um)},persist:function(){},isPersistent:Um}),t}var Ju={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iv=Wr(Ju),gp=Dn({},Ju,{view:0,detail:0}),nL=Wr(gp),ib,sb,Gh,sv=Dn({},gp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:M2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gh&&(Gh&&e.type==="mousemove"?(ib=e.screenX-Gh.screenX,sb=e.screenY-Gh.screenY):sb=ib=0,Gh=e),ib)},movementY:function(e){return"movementY"in e?e.movementY:sb}}),WN=Wr(sv),aL=Dn({},sv,{dataTransfer:0}),rL=Wr(aL),iL=Dn({},gp,{relatedTarget:0}),ob=Wr(iL),sL=Dn({},Ju,{animationName:0,elapsedTime:0,pseudoElement:0}),oL=Wr(sL),lL=Dn({},Ju,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),uL=Wr(lL),cL=Dn({},Ju,{data:0}),HN=Wr(cL),dL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pL(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fL[e])?!!t[e]:!1}function M2(){return pL}var mL=Dn({},gp,{key:function(e){if(e.key){var t=dL[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?hL[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:M2,charCode:function(e){return e.type==="keypress"?jg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gL=Wr(mL),vL=Dn({},sv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VN=Wr(vL),xL=Dn({},gp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:M2}),bL=Wr(xL),yL=Dn({},Ju,{propertyName:0,elapsedTime:0,pseudoElement:0}),wL=Wr(yL),NL=Dn({},sv,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kL=Wr(NL),SL=Dn({},Ju,{newState:0,oldState:0}),_L=Wr(SL),jL=[9,13,27,32],O2=jo&&"CompositionEvent"in window,hf=null;jo&&"documentMode"in document&&(hf=document.documentMode);var CL=jo&&"TextEvent"in window&&!hf,WS=jo&&(!O2||hf&&8<hf&&11>=hf),GN=" ",$N=!1;function HS(e,t){switch(e){case"keyup":return jL.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function VS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rd=!1;function AL(e,t){switch(e){case"compositionend":return VS(t);case"keypress":return t.which!==32?null:($N=!0,GN);case"textInput":return e=t.data,e===GN&&$N?null:e;default:return null}}function EL(e,t){if(rd)return e==="compositionend"||!O2&&HS(e,t)?(e=qS(),_g=R2=gl=null,rd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return WS&&t.locale!=="ko"?null:t.data;default:return null}}var DL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!DL[e.type]:t==="textarea"}function GS(e,t,n,a){ad?gd?gd.push(a):gd=[a]:ad=a,t=c0(t,"onChange"),0<t.length&&(n=new iv("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var ff=null,Ff=null;function TL(e){Fj(e,0)}function ov(e){var t=of(e);if(OS(t))return e}function YN(e,t){if(e==="change")return t}var $S=!1;if(jo){var lb;if(jo){var ub="oninput"in document;if(!ub){var XN=document.createElement("div");XN.setAttribute("oninput","return;"),ub=typeof XN.oninput=="function"}lb=ub}else lb=!1;$S=lb&&(!document.documentMode||9<document.documentMode)}function JN(){ff&&(ff.detachEvent("onpropertychange",KS),Ff=ff=null)}function KS(e){if(e.propertyName==="value"&&ov(Ff)){var t=[];GS(t,Ff,e,P2(e)),US(TL,t)}}function LL(e,t,n){e==="focusin"?(JN(),ff=t,Ff=n,ff.attachEvent("onpropertychange",KS)):e==="focusout"&&JN()}function PL(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ov(Ff)}function RL(e,t){if(e==="click")return ov(t)}function ML(e,t){if(e==="input"||e==="change")return ov(t)}function OL(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vi=typeof Object.is=="function"?Object.is:OL;function Bf(e,t){if(vi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!P1.call(t,r)||!vi(e[r],t[r]))return!1}return!0}function QN(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ZN(e,t){var n=QN(e);e=0;for(var a;n;){if(n.nodeType===3){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=QN(n)}}function YS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?YS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function XS(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Gg(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Gg(e.document)}return t}function I2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var IL=jo&&"documentMode"in document&&11>=document.documentMode,id=null,B1=null,pf=null,z1=!1;function e3(e,t,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;z1||id==null||id!==Gg(a)||(a=id,"selectionStart"in a&&I2(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),pf&&Bf(pf,a)||(pf=a,a=c0(B1,"onSelect"),0<a.length&&(t=new iv("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=id)))}function du(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var sd={animationend:du("Animation","AnimationEnd"),animationiteration:du("Animation","AnimationIteration"),animationstart:du("Animation","AnimationStart"),transitionrun:du("Transition","TransitionRun"),transitionstart:du("Transition","TransitionStart"),transitioncancel:du("Transition","TransitionCancel"),transitionend:du("Transition","TransitionEnd")},cb={},JS={};jo&&(JS=document.createElement("div").style,"AnimationEvent"in window||(delete sd.animationend.animation,delete sd.animationiteration.animation,delete sd.animationstart.animation),"TransitionEvent"in window||delete sd.transitionend.transition);function Qu(e){if(cb[e])return cb[e];if(!sd[e])return e;var t=sd[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in JS)return cb[e]=t[n];return e}var QS=Qu("animationend"),ZS=Qu("animationiteration"),e_=Qu("animationstart"),FL=Qu("transitionrun"),BL=Qu("transitionstart"),zL=Qu("transitioncancel"),t_=Qu("transitionend"),n_=new Map,U1="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");U1.push("scrollEnd");function us(e,t){n_.set(e,t),Xu(t,[e])}var t3=new WeakMap;function Ii(e,t){if(typeof e=="object"&&e!==null){var n=t3.get(e);return n!==void 0?n:(t={value:e,source:t,stack:BN(t)},t3.set(e,t),t)}return{value:e,source:t,stack:BN(t)}}var Ti=[],od=0,F2=0;function lv(){for(var e=od,t=F2=od=0;t<e;){var n=Ti[t];Ti[t++]=null;var a=Ti[t];Ti[t++]=null;var r=Ti[t];Ti[t++]=null;var i=Ti[t];if(Ti[t++]=null,a!==null&&r!==null){var s=a.pending;s===null?r.next=r:(r.next=s.next,s.next=r),a.pending=r}i!==0&&a_(n,r,i)}}function uv(e,t,n,a){Ti[od++]=e,Ti[od++]=t,Ti[od++]=n,Ti[od++]=a,F2|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function B2(e,t,n,a){return uv(e,t,n,a),$g(e)}function eh(e,t){return uv(e,null,null,t),$g(e)}function a_(e,t,n){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n);for(var r=!1,i=e.return;i!==null;)i.childLanes|=n,a=i.alternate,a!==null&&(a.childLanes|=n),i.tag===22&&(e=i.stateNode,e===null||e._visibility&1||(r=!0)),e=i,i=i.return;return e.tag===3?(i=e.stateNode,r&&t!==null&&(r=31-fi(n),e=i.hiddenUpdates,a=e[r],a===null?e[r]=[t]:a.push(t),t.lane=n|536870912),i):null}function $g(e){if(50<Sf)throw Sf=0,ly=null,Error(Ve(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ld={};function UL(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(e,t,n,a){return new UL(e,t,n,a)}function z2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ko(e,t){var n=e.alternate;return n===null?(n=si(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function r_(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Cg(e,t,n,a,r,i){var s=0;if(a=e,typeof e=="function")z2(e)&&(s=1);else if(typeof e=="string")s=WP(e,n,Ms.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case E1:return e=si(31,n,t,r),e.elementType=E1,e.lanes=i,e;case ed:return ju(n.children,r,i,t);case kS:s=8,r|=24;break;case j1:return e=si(12,n,t,r|2),e.elementType=j1,e.lanes=i,e;case C1:return e=si(13,n,t,r),e.elementType=C1,e.lanes=i,e;case A1:return e=si(19,n,t,r),e.elementType=A1,e.lanes=i,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case TT:case xo:s=10;break e;case SS:s=9;break e;case j2:s=11;break e;case C2:s=14;break e;case ll:s=16,a=null;break e}s=29,n=Error(Ve(130,e===null?"null":typeof e,"")),a=null}return t=si(s,n,t,r),t.elementType=e,t.type=a,t.lanes=i,t}function ju(e,t,n,a){return e=si(7,e,a,t),e.lanes=n,e}function db(e,t,n){return e=si(6,e,null,t),e.lanes=n,e}function hb(e,t,n){return t=si(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ud=[],cd=0,Kg=null,Yg=0,Pi=[],Ri=0,Cu=null,bo=1,yo="";function mu(e,t){ud[cd++]=Yg,ud[cd++]=Kg,Kg=e,Yg=t}function i_(e,t,n){Pi[Ri++]=bo,Pi[Ri++]=yo,Pi[Ri++]=Cu,Cu=e;var a=bo;e=yo;var r=32-fi(a)-1;a&=~(1<<r),n+=1;var i=32-fi(t)+r;if(30<i){var s=r-r%5;i=(a&(1<<s)-1).toString(32),a>>=s,r-=s,bo=1<<32-fi(t)+r|n<<r|a,yo=i+e}else bo=1<<i|n<<r|a,yo=e}function U2(e){e.return!==null&&(mu(e,1),i_(e,1,0))}function q2(e){for(;e===Kg;)Kg=ud[--cd],ud[cd]=null,Yg=ud[--cd],ud[cd]=null;for(;e===Cu;)Cu=Pi[--Ri],Pi[Ri]=null,yo=Pi[--Ri],Pi[Ri]=null,bo=Pi[--Ri],Pi[Ri]=null}var xr=null,Kn=null,tn=!1,Au=null,Cs=!1,q1=Error(Ve(519));function Wu(e){var t=Error(Ve(418,""));throw zf(Ii(t,e)),q1}function n3(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[lr]=e,t[zr]=a,n){case"dialog":Ft("cancel",t),Ft("close",t);break;case"iframe":case"object":case"embed":Ft("load",t);break;case"video":case"audio":for(n=0;n<Wf.length;n++)Ft(Wf[n],t);break;case"source":Ft("error",t);break;case"img":case"image":case"link":Ft("error",t),Ft("load",t);break;case"details":Ft("toggle",t);break;case"input":Ft("invalid",t),IS(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),Vg(t);break;case"select":Ft("invalid",t);break;case"textarea":Ft("invalid",t),BS(t,a.value,a.defaultValue,a.children),Vg(t)}n=a.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||a.suppressHydrationWarning===!0||zj(t.textContent,n)?(a.popover!=null&&(Ft("beforetoggle",t),Ft("toggle",t)),a.onScroll!=null&&Ft("scroll",t),a.onScrollEnd!=null&&Ft("scrollend",t),a.onClick!=null&&(t.onclick=vv),t=!0):t=!1,t||Wu(e)}function a3(e){for(xr=e.return;xr;)switch(xr.tag){case 5:case 13:Cs=!1;return;case 27:case 3:Cs=!0;return;default:xr=xr.return}}function $h(e){if(e!==xr)return!1;if(!tn)return a3(e),tn=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||py(e.type,e.memoizedProps)),n=!n),n&&Kn&&Wu(e),a3(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ve(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){Kn=ss(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}Kn=null}}else t===27?(t=Kn,Kl(e.type)?(e=vy,vy=null,Kn=e):Kn=t):Kn=xr?ss(e.stateNode.nextSibling):null;return!0}function vp(){Kn=xr=null,tn=!1}function r3(){var e=Au;return e!==null&&(Mr===null?Mr=e:Mr.push.apply(Mr,e),Au=null),e}function zf(e){Au===null?Au=[e]:Au.push(e)}var W1=Vs(null),Zu=null,wo=null;function cl(e,t,n){Mn(W1,t._currentValue),t._currentValue=n}function So(e){e._currentValue=W1.current,Oa(W1)}function H1(e,t,n){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function V1(e,t,n,a){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var i=r.dependencies;if(i!==null){var s=r.child;i=i.firstContext;e:for(;i!==null;){var o=i;i=r;for(var u=0;u<t.length;u++)if(o.context===t[u]){i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),H1(i.return,n,e),a||(s=null);break e}i=o.next}}else if(r.tag===18){if(s=r.return,s===null)throw Error(Ve(341));s.lanes|=n,i=s.alternate,i!==null&&(i.lanes|=n),H1(s,n,e),s=null}else s=r.child;if(s!==null)s.return=r;else for(s=r;s!==null;){if(s===e){s=null;break}if(r=s.sibling,r!==null){r.return=s.return,s=r;break}s=s.return}r=s}}function xp(e,t,n,a){e=null;for(var r=t,i=!1;r!==null;){if(!i){if(r.flags&524288)i=!0;else if(r.flags&262144)break}if(r.tag===10){var s=r.alternate;if(s===null)throw Error(Ve(387));if(s=s.memoizedProps,s!==null){var o=r.type;vi(r.pendingProps.value,s.value)||(e!==null?e.push(o):e=[o])}}else if(r===Ug.current){if(s=r.alternate,s===null)throw Error(Ve(387));s.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(Gf):e=[Gf])}r=r.return}e!==null&&V1(t,e,n,a),t.flags|=262144}function Xg(e){for(e=e.firstContext;e!==null;){if(!vi(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Hu(e){Zu=e,wo=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ur(e){return s_(Zu,e)}function qm(e,t){return Zu===null&&Hu(e),s_(e,t)}function s_(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},wo===null){if(e===null)throw Error(Ve(308));wo=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else wo=wo.next=t;return n}var qL=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},WL=Sa.unstable_scheduleCallback,HL=Sa.unstable_NormalPriority,ba={$$typeof:xo,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function W2(){return{controller:new qL,data:new Map,refCount:0}}function bp(e){e.refCount--,e.refCount===0&&WL(HL,function(){e.controller.abort()})}var mf=null,G1=0,Od=0,vd=null;function VL(e,t){if(mf===null){var n=mf=[];G1=0,Od=hw(),vd={status:"pending",value:void 0,then:function(a){n.push(a)}}}return G1++,t.then(i3,i3),t}function i3(){if(--G1===0&&mf!==null){vd!==null&&(vd.status="fulfilled");var e=mf;mf=null,Od=0,vd=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function GL(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(a.status="rejected",a.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),a}var s3=kt.S;kt.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&VL(e,t),s3!==null&&s3(e,t)};var Eu=Vs(null);function H2(){var e=Eu.current;return e!==null?e:Sn.pooledCache}function Ag(e,t){t===null?Mn(Eu,Eu.current):Mn(Eu,t.pool)}function o_(){var e=H2();return e===null?null:{parent:ba._currentValue,pool:e}}var yp=Error(Ve(460)),l_=Error(Ve(474)),cv=Error(Ve(542)),$1={then:function(){}};function o3(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Wm(){}function u_(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Wm,Wm),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,u3(e),e;default:if(typeof t.status=="string")t.then(Wm,Wm);else{if(e=Sn,e!==null&&100<e.shellSuspendCounter)throw Error(Ve(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=a}},function(a){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,u3(e),e}throw gf=t,yp}}var gf=null;function l3(){if(gf===null)throw Error(Ve(459));var e=gf;return gf=null,e}function u3(e){if(e===yp||e===cv)throw Error(Ve(483))}var ul=!1;function V2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function K1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Cl(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Al(e,t,n){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,dn&2){var r=a.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),a.pending=t,t=$g(e),a_(e,null,n),t}return uv(e,a,t,n),$g(e)}function vf(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,TS(e,n)}}function fb(e,t){var n=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};i===null?r=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?r=i=t:i=i.next=t}else r=i=t;n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:a.shared,callbacks:a.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Y1=!1;function xf(){if(Y1){var e=vd;if(e!==null)throw e}}function bf(e,t,n,a){Y1=!1;var r=e.updateQueue;ul=!1;var i=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var u=o,c=u.next;u.next=null,s===null?i=c:s.next=c,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=r.baseState;s=0,d=c=u=null,o=i;do{var p=o.lane&-536870913,f=p!==o.lane;if(f?(Kt&p)===p:(a&p)===p){p!==0&&p===Od&&(Y1=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=e,b=o;p=t;var w=n;switch(b.tag){case 1:if(g=b.payload,typeof g=="function"){h=g.call(w,h,p);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,p=typeof g=="function"?g.call(w,h,p):g,p==null)break e;h=Dn({},h,p);break e;case 2:ul=!0}}p=o.callback,p!==null&&(e.flags|=64,f&&(e.flags|=8192),f=r.callbacks,f===null?r.callbacks=[p]:f.push(p))}else f={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=f,u=h):d=d.next=f,s|=p;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;f=o,o=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);d===null&&(u=h),r.baseState=u,r.firstBaseUpdate=c,r.lastBaseUpdate=d,i===null&&(r.shared.lanes=0),ql|=s,e.lanes=s,e.memoizedState=h}}function c_(e,t){if(typeof e!="function")throw Error(Ve(191,e));e.call(t)}function d_(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)c_(n[e],t)}var Id=Vs(null),Jg=Vs(0);function c3(e,t){e=Eo,Mn(Jg,e),Mn(Id,t),Eo=e|t.baseLanes}function X1(){Mn(Jg,Eo),Mn(Id,Id.current)}function G2(){Eo=Jg.current,Oa(Id),Oa(Jg)}var zl=0,Rt=null,vn=null,da=null,Qg=!1,xd=!1,Vu=!1,Zg=0,Uf=0,bd=null,$L=0;function ea(){throw Error(Ve(321))}function $2(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!vi(e[n],t[n]))return!1;return!0}function K2(e,t,n,a,r,i){return zl=i,Rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,kt.H=e===null||e.memoizedState===null?q_:W_,Vu=!1,i=n(a,r),Vu=!1,xd&&(i=f_(t,n,a,r)),h_(e),i}function h_(e){kt.H=e0;var t=vn!==null&&vn.next!==null;if(zl=0,da=vn=Rt=null,Qg=!1,Uf=0,bd=null,t)throw Error(Ve(300));e===null||Ma||(e=e.dependencies,e!==null&&Xg(e)&&(Ma=!0))}function f_(e,t,n,a){Rt=e;var r=0;do{if(xd&&(bd=null),Uf=0,xd=!1,25<=r)throw Error(Ve(301));if(r+=1,da=vn=null,e.updateQueue!=null){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,i.memoCache!=null&&(i.memoCache.index=0)}kt.H=eP,i=t(n,a)}while(xd);return i}function KL(){var e=kt.H,t=e.useState()[0];return t=typeof t.then=="function"?wp(t):t,e=e.useState()[0],(vn!==null?vn.memoizedState:null)!==e&&(Rt.flags|=1024),t}function Y2(){var e=Zg!==0;return Zg=0,e}function X2(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function J2(e){if(Qg){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Qg=!1}zl=0,da=vn=Rt=null,xd=!1,Uf=Zg=0,bd=null}function Pr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return da===null?Rt.memoizedState=da=e:da=da.next=e,da}function fa(){if(vn===null){var e=Rt.alternate;e=e!==null?e.memoizedState:null}else e=vn.next;var t=da===null?Rt.memoizedState:da.next;if(t!==null)da=t,vn=e;else{if(e===null)throw Rt.alternate===null?Error(Ve(467)):Error(Ve(310));vn=e,e={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},da===null?Rt.memoizedState=da=e:da=da.next=e}return da}function Q2(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wp(e){var t=Uf;return Uf+=1,bd===null&&(bd=[]),e=u_(bd,e,t),t=Rt,(da===null?t.memoizedState:da.next)===null&&(t=t.alternate,kt.H=t===null||t.memoizedState===null?q_:W_),e}function dv(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return wp(e);if(e.$$typeof===xo)return ur(e)}throw Error(Ve(438,String(e)))}function Z2(e){var t=null,n=Rt.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var a=Rt.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Q2(),Rt.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=LT;return t.index++,n}function Co(e,t){return typeof t=="function"?t(e):t}function Eg(e){var t=fa();return ew(t,vn,e)}function ew(e,t,n){var a=e.queue;if(a===null)throw Error(Ve(311));a.lastRenderedReducer=n;var r=e.baseQueue,i=a.pending;if(i!==null){if(r!==null){var s=r.next;r.next=i.next,i.next=s}t.baseQueue=r=i,a.pending=null}if(i=e.baseState,r===null)e.memoizedState=i;else{t=r.next;var o=s=null,u=null,c=t,d=!1;do{var h=c.lane&-536870913;if(h!==c.lane?(Kt&h)===h:(zl&h)===h){var p=c.revertLane;if(p===0)u!==null&&(u=u.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===Od&&(d=!0);else if((zl&p)===p){c=c.next,p===Od&&(d=!0);continue}else h={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},u===null?(o=u=h,s=i):u=u.next=h,Rt.lanes|=p,ql|=p;h=c.action,Vu&&n(i,h),i=c.hasEagerState?c.eagerState:n(i,h)}else p={lane:h,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},u===null?(o=u=p,s=i):u=u.next=p,Rt.lanes|=h,ql|=h;c=c.next}while(c!==null&&c!==t);if(u===null?s=i:u.next=o,!vi(i,e.memoizedState)&&(Ma=!0,d&&(n=vd,n!==null)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=u,a.lastRenderedState=i}return r===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function pb(e){var t=fa(),n=t.queue;if(n===null)throw Error(Ve(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,i=t.memoizedState;if(r!==null){n.pending=null;var s=r=r.next;do i=e(i,s.action),s=s.next;while(s!==r);vi(i,t.memoizedState)||(Ma=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function p_(e,t,n){var a=Rt,r=fa(),i=tn;if(i){if(n===void 0)throw Error(Ve(407));n=n()}else n=t();var s=!vi((vn||r).memoizedState,n);s&&(r.memoizedState=n,Ma=!0),r=r.queue;var o=v_.bind(null,a,r,e);if(Np(2048,8,o,[e]),r.getSnapshot!==t||s||da!==null&&da.memoizedState.tag&1){if(a.flags|=2048,Fd(9,hv(),g_.bind(null,a,r,n,t),null),Sn===null)throw Error(Ve(349));i||zl&124||m_(a,t,n)}return n}function m_(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Rt.updateQueue,t===null?(t=Q2(),Rt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function g_(e,t,n,a){t.value=n,t.getSnapshot=a,x_(t)&&b_(e)}function v_(e,t,n){return n(function(){x_(t)&&b_(e)})}function x_(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!vi(e,n)}catch{return!0}}function b_(e){var t=eh(e,2);t!==null&&mi(t,e,2)}function J1(e){var t=Pr();if(typeof e=="function"){var n=e;if(e=n(),Vu){ml(!0);try{n()}finally{ml(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t}function y_(e,t,n,a){return e.baseState=n,ew(e,vn,typeof a=="function"?a:Co)}function YL(e,t,n,a,r){if(fv(e))throw Error(Ve(485));if(e=t.action,e!==null){var i={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(s){i.listeners.push(s)}};kt.T!==null?n(!0):i.isTransition=!1,a(i),n=t.pending,n===null?(i.next=t.pending=i,w_(t,i)):(i.next=n.next,t.pending=n.next=i)}}function w_(e,t){var n=t.action,a=t.payload,r=e.state;if(t.isTransition){var i=kt.T,s={};kt.T=s;try{var o=n(r,a),u=kt.S;u!==null&&u(s,o),d3(e,t,o)}catch(c){Q1(e,t,c)}finally{kt.T=i}}else try{i=n(r,a),d3(e,t,i)}catch(c){Q1(e,t,c)}}function d3(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(a){h3(e,t,a)},function(a){return Q1(e,t,a)}):h3(e,t,n)}function h3(e,t,n){t.status="fulfilled",t.value=n,N_(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,w_(e,n)))}function Q1(e,t,n){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=n,N_(t),t=t.next;while(t!==a)}e.action=null}function N_(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function k_(e,t){return t}function f3(e,t){if(tn){var n=Sn.formState;if(n!==null){e:{var a=Rt;if(tn){if(Kn){t:{for(var r=Kn,i=Cs;r.nodeType!==8;){if(!i){r=null;break t}if(r=ss(r.nextSibling),r===null){r=null;break t}}i=r.data,r=i==="F!"||i==="F"?r:null}if(r){Kn=ss(r.nextSibling),a=r.data==="F!";break e}}Wu(a)}a=!1}a&&(t=n[0])}}return n=Pr(),n.memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:k_,lastRenderedState:t},n.queue=a,n=B_.bind(null,Rt,a),a.dispatch=n,a=J1(!1),i=rw.bind(null,Rt,!1,a.queue),a=Pr(),r={state:t,dispatch:null,action:e,pending:null},a.queue=r,n=YL.bind(null,Rt,r,i,n),r.dispatch=n,a.memoizedState=e,[t,n,!1]}function p3(e){var t=fa();return S_(t,vn,e)}function S_(e,t,n){if(t=ew(e,t,k_)[0],e=Eg(Co)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=wp(t)}catch(s){throw s===yp?cv:s}else a=t;t=fa();var r=t.queue,i=r.dispatch;return n!==t.memoizedState&&(Rt.flags|=2048,Fd(9,hv(),XL.bind(null,r,n),null)),[a,i,e]}function XL(e,t){e.action=t}function m3(e){var t=fa(),n=vn;if(n!==null)return S_(t,n,e);fa(),t=t.memoizedState,n=fa();var a=n.queue.dispatch;return n.memoizedState=e,[t,a,!1]}function Fd(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},t=Rt.updateQueue,t===null&&(t=Q2(),Rt.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function hv(){return{destroy:void 0,resource:void 0}}function __(){return fa().memoizedState}function Dg(e,t,n,a){var r=Pr();a=a===void 0?null:a,Rt.flags|=e,r.memoizedState=Fd(1|t,hv(),n,a)}function Np(e,t,n,a){var r=fa();a=a===void 0?null:a;var i=r.memoizedState.inst;vn!==null&&a!==null&&$2(a,vn.memoizedState.deps)?r.memoizedState=Fd(t,i,n,a):(Rt.flags|=e,r.memoizedState=Fd(1|t,i,n,a))}function g3(e,t){Dg(8390656,8,e,t)}function j_(e,t){Np(2048,8,e,t)}function C_(e,t){return Np(4,2,e,t)}function A_(e,t){return Np(4,4,e,t)}function E_(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function D_(e,t,n){n=n!=null?n.concat([e]):null,Np(4,4,E_.bind(null,t,e),n)}function tw(){}function T_(e,t){var n=fa();t=t===void 0?null:t;var a=n.memoizedState;return t!==null&&$2(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function L_(e,t){var n=fa();t=t===void 0?null:t;var a=n.memoizedState;if(t!==null&&$2(t,a[1]))return a[0];if(a=e(),Vu){ml(!0);try{e()}finally{ml(!1)}}return n.memoizedState=[a,t],a}function nw(e,t,n){return n===void 0||zl&1073741824?e.memoizedState=t:(e.memoizedState=n,e=Nj(),Rt.lanes|=e,ql|=e,n)}function P_(e,t,n,a){return vi(n,t)?n:Id.current!==null?(e=nw(e,n,a),vi(e,t)||(Ma=!0),e):zl&42?(e=Nj(),Rt.lanes|=e,ql|=e,t):(Ma=!0,e.memoizedState=n)}function R_(e,t,n,a,r){var i=rn.p;rn.p=i!==0&&8>i?i:8;var s=kt.T,o={};kt.T=o,rw(e,!1,t,n);try{var u=r(),c=kt.S;if(c!==null&&c(o,u),u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=GL(u,a);yf(e,t,d,pi(e))}else yf(e,t,a,pi(e))}catch(h){yf(e,t,{then:function(){},status:"rejected",reason:h},pi())}finally{rn.p=i,kt.T=s}}function JL(){}function Z1(e,t,n,a){if(e.tag!==5)throw Error(Ve(476));var r=M_(e).queue;R_(e,r,t,_u,n===null?JL:function(){return O_(e),n(a)})}function M_(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:_u,baseState:_u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:_u},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function O_(e){var t=M_(e).next.queue;yf(e,t,{},pi())}function aw(){return ur(Gf)}function I_(){return fa().memoizedState}function F_(){return fa().memoizedState}function QL(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=pi();e=Cl(n);var a=Al(t,e,n);a!==null&&(mi(a,t,n),vf(a,t,n)),t={cache:W2()},e.payload=t;return}t=t.return}}function ZL(e,t,n){var a=pi();n={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},fv(e)?z_(t,n):(n=B2(e,t,n,a),n!==null&&(mi(n,e,a),U_(n,t,a)))}function B_(e,t,n){var a=pi();yf(e,t,n,a)}function yf(e,t,n,a){var r={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(fv(e))z_(t,r);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,n);if(r.hasEagerState=!0,r.eagerState=o,vi(o,s))return uv(e,t,r,0),Sn===null&&lv(),!1}catch{}finally{}if(n=B2(e,t,r,a),n!==null)return mi(n,e,a),U_(n,t,a),!0}return!1}function rw(e,t,n,a){if(a={lane:2,revertLane:hw(),action:a,hasEagerState:!1,eagerState:null,next:null},fv(e)){if(t)throw Error(Ve(479))}else t=B2(e,n,a,2),t!==null&&mi(t,e,2)}function fv(e){var t=e.alternate;return e===Rt||t!==null&&t===Rt}function z_(e,t){xd=Qg=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function U_(e,t,n){if(n&4194048){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,TS(e,n)}}var e0={readContext:ur,use:dv,useCallback:ea,useContext:ea,useEffect:ea,useImperativeHandle:ea,useLayoutEffect:ea,useInsertionEffect:ea,useMemo:ea,useReducer:ea,useRef:ea,useState:ea,useDebugValue:ea,useDeferredValue:ea,useTransition:ea,useSyncExternalStore:ea,useId:ea,useHostTransitionStatus:ea,useFormState:ea,useActionState:ea,useOptimistic:ea,useMemoCache:ea,useCacheRefresh:ea},q_={readContext:ur,use:dv,useCallback:function(e,t){return Pr().memoizedState=[e,t===void 0?null:t],e},useContext:ur,useEffect:g3,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Dg(4194308,4,E_.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Dg(4194308,4,e,t)},useInsertionEffect:function(e,t){Dg(4,2,e,t)},useMemo:function(e,t){var n=Pr();t=t===void 0?null:t;var a=e();if(Vu){ml(!0);try{e()}finally{ml(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=Pr();if(n!==void 0){var r=n(t);if(Vu){ml(!0);try{n(t)}finally{ml(!1)}}}else r=t;return a.memoizedState=a.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=ZL.bind(null,Rt,e),[a.memoizedState,e]},useRef:function(e){var t=Pr();return e={current:e},t.memoizedState=e},useState:function(e){e=J1(e);var t=e.queue,n=B_.bind(null,Rt,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:tw,useDeferredValue:function(e,t){var n=Pr();return nw(n,e,t)},useTransition:function(){var e=J1(!1);return e=R_.bind(null,Rt,e.queue,!0,!1),Pr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Rt,r=Pr();if(tn){if(n===void 0)throw Error(Ve(407));n=n()}else{if(n=t(),Sn===null)throw Error(Ve(349));Kt&124||m_(a,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,g3(v_.bind(null,a,i,e),[e]),a.flags|=2048,Fd(9,hv(),g_.bind(null,a,i,n,t),null),n},useId:function(){var e=Pr(),t=Sn.identifierPrefix;if(tn){var n=yo,a=bo;n=(a&~(1<<32-fi(a)-1)).toString(32)+n,t="«"+t+"R"+n,n=Zg++,0<n&&(t+="H"+n.toString(32)),t+="»"}else n=$L++,t="«"+t+"r"+n.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:aw,useFormState:f3,useActionState:f3,useOptimistic:function(e){var t=Pr();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=rw.bind(null,Rt,!0,n),n.dispatch=t,[e,t]},useMemoCache:Z2,useCacheRefresh:function(){return Pr().memoizedState=QL.bind(null,Rt)}},W_={readContext:ur,use:dv,useCallback:T_,useContext:ur,useEffect:j_,useImperativeHandle:D_,useInsertionEffect:C_,useLayoutEffect:A_,useMemo:L_,useReducer:Eg,useRef:__,useState:function(){return Eg(Co)},useDebugValue:tw,useDeferredValue:function(e,t){var n=fa();return P_(n,vn.memoizedState,e,t)},useTransition:function(){var e=Eg(Co)[0],t=fa().memoizedState;return[typeof e=="boolean"?e:wp(e),t]},useSyncExternalStore:p_,useId:I_,useHostTransitionStatus:aw,useFormState:p3,useActionState:p3,useOptimistic:function(e,t){var n=fa();return y_(n,vn,e,t)},useMemoCache:Z2,useCacheRefresh:F_},eP={readContext:ur,use:dv,useCallback:T_,useContext:ur,useEffect:j_,useImperativeHandle:D_,useInsertionEffect:C_,useLayoutEffect:A_,useMemo:L_,useReducer:pb,useRef:__,useState:function(){return pb(Co)},useDebugValue:tw,useDeferredValue:function(e,t){var n=fa();return vn===null?nw(n,e,t):P_(n,vn.memoizedState,e,t)},useTransition:function(){var e=pb(Co)[0],t=fa().memoizedState;return[typeof e=="boolean"?e:wp(e),t]},useSyncExternalStore:p_,useId:I_,useHostTransitionStatus:aw,useFormState:m3,useActionState:m3,useOptimistic:function(e,t){var n=fa();return vn!==null?y_(n,vn,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Z2,useCacheRefresh:F_},yd=null,qf=0;function Hm(e){var t=qf;return qf+=1,yd===null&&(yd=[]),u_(yd,e,t)}function Kh(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Vm(e,t){throw t.$$typeof===DT?Error(Ve(525)):(e=Object.prototype.toString.call(t),Error(Ve(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function v3(e){var t=e._init;return t(e._payload)}function H_(e){function t(m,x){if(e){var y=m.deletions;y===null?(m.deletions=[x],m.flags|=16):y.push(x)}}function n(m,x){if(!e)return null;for(;x!==null;)t(m,x),x=x.sibling;return null}function a(m){for(var x=new Map;m!==null;)m.key!==null?x.set(m.key,m):x.set(m.index,m),m=m.sibling;return x}function r(m,x){return m=ko(m,x),m.index=0,m.sibling=null,m}function i(m,x,y){return m.index=y,e?(y=m.alternate,y!==null?(y=y.index,y<x?(m.flags|=67108866,x):y):(m.flags|=67108866,x)):(m.flags|=1048576,x)}function s(m){return e&&m.alternate===null&&(m.flags|=67108866),m}function o(m,x,y,N){return x===null||x.tag!==6?(x=db(y,m.mode,N),x.return=m,x):(x=r(x,y),x.return=m,x)}function u(m,x,y,N){var S=y.type;return S===ed?d(m,x,y.props.children,N,y.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ll&&v3(S)===x.type)?(x=r(x,y.props),Kh(x,y),x.return=m,x):(x=Cg(y.type,y.key,y.props,null,m.mode,N),Kh(x,y),x.return=m,x)}function c(m,x,y,N){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=hb(y,m.mode,N),x.return=m,x):(x=r(x,y.children||[]),x.return=m,x)}function d(m,x,y,N,S){return x===null||x.tag!==7?(x=ju(y,m.mode,N,S),x.return=m,x):(x=r(x,y),x.return=m,x)}function h(m,x,y){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return x=db(""+x,m.mode,y),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Im:return y=Cg(x.type,x.key,x.props,null,m.mode,y),Kh(y,x),y.return=m,y;case rf:return x=hb(x,m.mode,y),x.return=m,x;case ll:var N=x._init;return x=N(x._payload),h(m,x,y)}if(sf(x)||Hh(x))return x=ju(x,m.mode,y,null),x.return=m,x;if(typeof x.then=="function")return h(m,Hm(x),y);if(x.$$typeof===xo)return h(m,qm(m,x),y);Vm(m,x)}return null}function p(m,x,y,N){var S=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return S!==null?null:o(m,x,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Im:return y.key===S?u(m,x,y,N):null;case rf:return y.key===S?c(m,x,y,N):null;case ll:return S=y._init,y=S(y._payload),p(m,x,y,N)}if(sf(y)||Hh(y))return S!==null?null:d(m,x,y,N,null);if(typeof y.then=="function")return p(m,x,Hm(y),N);if(y.$$typeof===xo)return p(m,x,qm(m,y),N);Vm(m,y)}return null}function f(m,x,y,N,S){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return m=m.get(y)||null,o(x,m,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Im:return m=m.get(N.key===null?y:N.key)||null,u(x,m,N,S);case rf:return m=m.get(N.key===null?y:N.key)||null,c(x,m,N,S);case ll:var D=N._init;return N=D(N._payload),f(m,x,y,N,S)}if(sf(N)||Hh(N))return m=m.get(y)||null,d(x,m,N,S,null);if(typeof N.then=="function")return f(m,x,y,Hm(N),S);if(N.$$typeof===xo)return f(m,x,y,qm(x,N),S);Vm(x,N)}return null}function g(m,x,y,N){for(var S=null,D=null,_=x,A=x=0,L=null;_!==null&&A<y.length;A++){_.index>A?(L=_,_=null):L=_.sibling;var P=p(m,_,y[A],N);if(P===null){_===null&&(_=L);break}e&&_&&P.alternate===null&&t(m,_),x=i(P,x,A),D===null?S=P:D.sibling=P,D=P,_=L}if(A===y.length)return n(m,_),tn&&mu(m,A),S;if(_===null){for(;A<y.length;A++)_=h(m,y[A],N),_!==null&&(x=i(_,x,A),D===null?S=_:D.sibling=_,D=_);return tn&&mu(m,A),S}for(_=a(_);A<y.length;A++)L=f(_,m,A,y[A],N),L!==null&&(e&&L.alternate!==null&&_.delete(L.key===null?A:L.key),x=i(L,x,A),D===null?S=L:D.sibling=L,D=L);return e&&_.forEach(function(j){return t(m,j)}),tn&&mu(m,A),S}function b(m,x,y,N){if(y==null)throw Error(Ve(151));for(var S=null,D=null,_=x,A=x=0,L=null,P=y.next();_!==null&&!P.done;A++,P=y.next()){_.index>A?(L=_,_=null):L=_.sibling;var j=p(m,_,P.value,N);if(j===null){_===null&&(_=L);break}e&&_&&j.alternate===null&&t(m,_),x=i(j,x,A),D===null?S=j:D.sibling=j,D=j,_=L}if(P.done)return n(m,_),tn&&mu(m,A),S;if(_===null){for(;!P.done;A++,P=y.next())P=h(m,P.value,N),P!==null&&(x=i(P,x,A),D===null?S=P:D.sibling=P,D=P);return tn&&mu(m,A),S}for(_=a(_);!P.done;A++,P=y.next())P=f(_,m,A,P.value,N),P!==null&&(e&&P.alternate!==null&&_.delete(P.key===null?A:P.key),x=i(P,x,A),D===null?S=P:D.sibling=P,D=P);return e&&_.forEach(function(E){return t(m,E)}),tn&&mu(m,A),S}function w(m,x,y,N){if(typeof y=="object"&&y!==null&&y.type===ed&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Im:e:{for(var S=y.key;x!==null;){if(x.key===S){if(S=y.type,S===ed){if(x.tag===7){n(m,x.sibling),N=r(x,y.props.children),N.return=m,m=N;break e}}else if(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ll&&v3(S)===x.type){n(m,x.sibling),N=r(x,y.props),Kh(N,y),N.return=m,m=N;break e}n(m,x);break}else t(m,x);x=x.sibling}y.type===ed?(N=ju(y.props.children,m.mode,N,y.key),N.return=m,m=N):(N=Cg(y.type,y.key,y.props,null,m.mode,N),Kh(N,y),N.return=m,m=N)}return s(m);case rf:e:{for(S=y.key;x!==null;){if(x.key===S)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){n(m,x.sibling),N=r(x,y.children||[]),N.return=m,m=N;break e}else{n(m,x);break}else t(m,x);x=x.sibling}N=hb(y,m.mode,N),N.return=m,m=N}return s(m);case ll:return S=y._init,y=S(y._payload),w(m,x,y,N)}if(sf(y))return g(m,x,y,N);if(Hh(y)){if(S=Hh(y),typeof S!="function")throw Error(Ve(150));return y=S.call(y),b(m,x,y,N)}if(typeof y.then=="function")return w(m,x,Hm(y),N);if(y.$$typeof===xo)return w(m,x,qm(m,y),N);Vm(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,x!==null&&x.tag===6?(n(m,x.sibling),N=r(x,y),N.return=m,m=N):(n(m,x),N=db(y,m.mode,N),N.return=m,m=N),s(m)):n(m,x)}return function(m,x,y,N){try{qf=0;var S=w(m,x,y,N);return yd=null,S}catch(_){if(_===yp||_===cv)throw _;var D=si(29,_,null,m.mode);return D.lanes=N,D.return=m,D}finally{}}}var Bd=H_(!0),V_=H_(!1),Hi=Vs(null),Is=null;function dl(e){var t=e.alternate;Mn(wa,wa.current&1),Mn(Hi,e),Is===null&&(t===null||Id.current!==null||t.memoizedState!==null)&&(Is=e)}function G_(e){if(e.tag===22){if(Mn(wa,wa.current),Mn(Hi,e),Is===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Is=e)}}else hl()}function hl(){Mn(wa,wa.current),Mn(Hi,Hi.current)}function No(e){Oa(Hi),Is===e&&(Is=null),Oa(wa)}var wa=Vs(0);function t0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||gy(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function mb(e,t,n,a){t=e.memoizedState,n=n(a,t),n=n==null?t:Dn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ey={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=pi(),r=Cl(a);r.payload=t,n!=null&&(r.callback=n),t=Al(e,r,a),t!==null&&(mi(t,e,a),vf(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=pi(),r=Cl(a);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=Al(e,r,a),t!==null&&(mi(t,e,a),vf(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=pi(),a=Cl(n);a.tag=2,t!=null&&(a.callback=t),t=Al(e,a,n),t!==null&&(mi(t,e,n),vf(t,e,n))}};function x3(e,t,n,a,r,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,s):t.prototype&&t.prototype.isPureReactComponent?!Bf(n,a)||!Bf(r,i):!0}function b3(e,t,n,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&ey.enqueueReplaceState(t,t.state,null)}function Gu(e,t){var n=t;if("ref"in t){n={};for(var a in t)a!=="ref"&&(n[a]=t[a])}if(e=e.defaultProps){n===t&&(n=Dn({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var n0=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function $_(e){n0(e)}function K_(e){console.error(e)}function Y_(e){n0(e)}function a0(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function y3(e,t,n){try{var a=e.onCaughtError;a(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function ty(e,t,n){return n=Cl(n),n.tag=3,n.payload={element:null},n.callback=function(){a0(e,t)},n}function X_(e){return e=Cl(e),e.tag=3,e}function J_(e,t,n,a){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=a.value;e.payload=function(){return r(i)},e.callback=function(){y3(t,n,a)}}var s=n.stateNode;s!==null&&typeof s.componentDidCatch=="function"&&(e.callback=function(){y3(t,n,a),typeof r!="function"&&(El===null?El=new Set([this]):El.add(this));var o=a.stack;this.componentDidCatch(a.value,{componentStack:o!==null?o:""})})}function tP(e,t,n,a,r){if(n.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=n.alternate,t!==null&&xp(t,n,r,!0),n=Hi.current,n!==null){switch(n.tag){case 13:return Is===null?uy():n.alternate===null&&Yn===0&&(Yn=3),n.flags&=-257,n.flags|=65536,n.lanes=r,a===$1?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([a]):t.add(a),jb(e,a,r)),!1;case 22:return n.flags|=65536,a===$1?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([a]):n.add(a)),jb(e,a,r)),!1}throw Error(Ve(435,n.tag))}return jb(e,a,r),uy(),!1}if(tn)return t=Hi.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=r,a!==q1&&(e=Error(Ve(422),{cause:a}),zf(Ii(e,n)))):(a!==q1&&(t=Error(Ve(423),{cause:a}),zf(Ii(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,a=Ii(a,n),r=ty(e.stateNode,a,r),fb(e,r),Yn!==4&&(Yn=2)),!1;var i=Error(Ve(520),{cause:a});if(i=Ii(i,n),kf===null?kf=[i]:kf.push(i),Yn!==4&&(Yn=2),t===null)return!0;a=Ii(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=ty(n.stateNode,a,e),fb(n,e),!1;case 1:if(t=n.type,i=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||i!==null&&typeof i.componentDidCatch=="function"&&(El===null||!El.has(i))))return n.flags|=65536,r&=-r,n.lanes|=r,r=X_(r),J_(r,e,n,a),fb(n,r),!1}n=n.return}while(n!==null);return!1}var Q_=Error(Ve(461)),Ma=!1;function Ha(e,t,n,a){t.child=e===null?V_(t,null,n,a):Bd(t,e.child,n,a)}function w3(e,t,n,a,r){n=n.render;var i=t.ref;if("ref"in a){var s={};for(var o in a)o!=="ref"&&(s[o]=a[o])}else s=a;return Hu(t),a=K2(e,t,n,s,i,r),o=Y2(),e!==null&&!Ma?(X2(e,t,r),Ao(e,t,r)):(tn&&o&&U2(t),t.flags|=1,Ha(e,t,a,r),t.child)}function N3(e,t,n,a,r){if(e===null){var i=n.type;return typeof i=="function"&&!z2(i)&&i.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=i,Z_(e,t,i,a,r)):(e=Cg(n.type,null,a,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!iw(e,r)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:Bf,n(s,a)&&e.ref===t.ref)return Ao(e,t,r)}return t.flags|=1,e=ko(i,a),e.ref=t.ref,e.return=t,t.child=e}function Z_(e,t,n,a,r){if(e!==null){var i=e.memoizedProps;if(Bf(i,a)&&e.ref===t.ref)if(Ma=!1,t.pendingProps=a=i,iw(e,r))e.flags&131072&&(Ma=!0);else return t.lanes=e.lanes,Ao(e,t,r)}return ny(e,t,n,a,r)}function ej(e,t,n){var a=t.pendingProps,r=a.children,i=e!==null?e.memoizedState:null;if(a.mode==="hidden"){if(t.flags&128){if(a=i!==null?i.baseLanes|n:n,e!==null){for(r=t.child=e.child,i=0;r!==null;)i=i|r.lanes|r.childLanes,r=r.sibling;t.childLanes=i&~a}else t.childLanes=0,t.child=null;return k3(e,t,a,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ag(t,i!==null?i.cachePool:null),i!==null?c3(t,i):X1(),G_(t);else return t.lanes=t.childLanes=536870912,k3(e,t,i!==null?i.baseLanes|n:n,n)}else i!==null?(Ag(t,i.cachePool),c3(t,i),hl(),t.memoizedState=null):(e!==null&&Ag(t,null),X1(),hl());return Ha(e,t,r,n),t.child}function k3(e,t,n,a){var r=H2();return r=r===null?null:{parent:ba._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&Ag(t,null),X1(),G_(t),e!==null&&xp(e,t,a,!0),null}function Tg(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(Ve(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function ny(e,t,n,a,r){return Hu(t),n=K2(e,t,n,a,void 0,r),a=Y2(),e!==null&&!Ma?(X2(e,t,r),Ao(e,t,r)):(tn&&a&&U2(t),t.flags|=1,Ha(e,t,n,r),t.child)}function S3(e,t,n,a,r,i){return Hu(t),t.updateQueue=null,n=f_(t,a,n,r),h_(e),a=Y2(),e!==null&&!Ma?(X2(e,t,i),Ao(e,t,i)):(tn&&a&&U2(t),t.flags|=1,Ha(e,t,n,i),t.child)}function _3(e,t,n,a,r){if(Hu(t),t.stateNode===null){var i=ld,s=n.contextType;typeof s=="object"&&s!==null&&(i=ur(s)),i=new n(a,i),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=ey,t.stateNode=i,i._reactInternals=t,i=t.stateNode,i.props=a,i.state=t.memoizedState,i.refs={},V2(t),s=n.contextType,i.context=typeof s=="object"&&s!==null?ur(s):ld,i.state=t.memoizedState,s=n.getDerivedStateFromProps,typeof s=="function"&&(mb(t,n,s,a),i.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(s=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),s!==i.state&&ey.enqueueReplaceState(i,i.state,null),bf(t,a,i,r),xf(),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){i=t.stateNode;var o=t.memoizedProps,u=Gu(n,o);i.props=u;var c=i.context,d=n.contextType;s=ld,typeof d=="object"&&d!==null&&(s=ur(d));var h=n.getDerivedStateFromProps;d=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function",o=t.pendingProps!==o,d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o||c!==s)&&b3(t,i,a,s),ul=!1;var p=t.memoizedState;i.state=p,bf(t,a,i,r),xf(),c=t.memoizedState,o||p!==c||ul?(typeof h=="function"&&(mb(t,n,h,a),c=t.memoizedState),(u=ul||x3(t,n,u,a,p,c,s))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),i.props=a,i.state=c,i.context=s,a=u):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,K1(e,t),s=t.memoizedProps,d=Gu(n,s),i.props=d,h=t.pendingProps,p=i.context,c=n.contextType,u=ld,typeof c=="object"&&c!==null&&(u=ur(c)),o=n.getDerivedStateFromProps,(c=typeof o=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==h||p!==u)&&b3(t,i,a,u),ul=!1,p=t.memoizedState,i.state=p,bf(t,a,i,r),xf();var f=t.memoizedState;s!==h||p!==f||ul||e!==null&&e.dependencies!==null&&Xg(e.dependencies)?(typeof o=="function"&&(mb(t,n,o,a),f=t.memoizedState),(d=ul||x3(t,n,d,a,p,f,u)||e!==null&&e.dependencies!==null&&Xg(e.dependencies))?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(a,f,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(a,f,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),i.props=a,i.state=f,i.context=u,a=d):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}return i=a,Tg(e,t),a=(t.flags&128)!==0,i||a?(i=t.stateNode,n=a&&typeof n.getDerivedStateFromError!="function"?null:i.render(),t.flags|=1,e!==null&&a?(t.child=Bd(t,e.child,null,r),t.child=Bd(t,null,n,r)):Ha(e,t,n,r),t.memoizedState=i.state,e=t.child):e=Ao(e,t,r),e}function j3(e,t,n,a){return vp(),t.flags|=256,Ha(e,t,n,a),t.child}var gb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vb(e){return{baseLanes:e,cachePool:o_()}}function xb(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Bi),e}function tj(e,t,n){var a=t.pendingProps,r=!1,i=(t.flags&128)!==0,s;if((s=i)||(s=e!==null&&e.memoizedState===null?!1:(wa.current&2)!==0),s&&(r=!0,t.flags&=-129),s=(t.flags&32)!==0,t.flags&=-33,e===null){if(tn){if(r?dl(t):hl(),tn){var o=Kn,u;if(u=o){e:{for(u=o,o=Cs;u.nodeType!==8;){if(!o){o=null;break e}if(u=ss(u.nextSibling),u===null){o=null;break e}}o=u}o!==null?(t.memoizedState={dehydrated:o,treeContext:Cu!==null?{id:bo,overflow:yo}:null,retryLane:536870912,hydrationErrors:null},u=si(18,null,null,0),u.stateNode=o,u.return=t,t.child=u,xr=t,Kn=null,u=!0):u=!1}u||Wu(t)}if(o=t.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return gy(o)?t.lanes=32:t.lanes=536870912,null;No(t)}return o=a.children,a=a.fallback,r?(hl(),r=t.mode,o=r0({mode:"hidden",children:o},r),a=ju(a,r,n,null),o.return=t,a.return=t,o.sibling=a,t.child=o,r=t.child,r.memoizedState=vb(n),r.childLanes=xb(e,s,n),t.memoizedState=gb,a):(dl(t),ay(t,o))}if(u=e.memoizedState,u!==null&&(o=u.dehydrated,o!==null)){if(i)t.flags&256?(dl(t),t.flags&=-257,t=bb(e,t,n)):t.memoizedState!==null?(hl(),t.child=e.child,t.flags|=128,t=null):(hl(),r=a.fallback,o=t.mode,a=r0({mode:"visible",children:a.children},o),r=ju(r,o,n,null),r.flags|=2,a.return=t,r.return=t,a.sibling=r,t.child=a,Bd(t,e.child,null,n),a=t.child,a.memoizedState=vb(n),a.childLanes=xb(e,s,n),t.memoizedState=gb,t=r);else if(dl(t),gy(o)){if(s=o.nextSibling&&o.nextSibling.dataset,s)var c=s.dgst;s=c,a=Error(Ve(419)),a.stack="",a.digest=s,zf({value:a,source:null,stack:null}),t=bb(e,t,n)}else if(Ma||xp(e,t,n,!1),s=(n&e.childLanes)!==0,Ma||s){if(s=Sn,s!==null&&(a=n&-n,a=a&42?1:E2(a),a=a&(s.suspendedLanes|n)?0:a,a!==0&&a!==u.retryLane))throw u.retryLane=a,eh(e,a),mi(s,e,a),Q_;o.data==="$?"||uy(),t=bb(e,t,n)}else o.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=u.treeContext,Kn=ss(o.nextSibling),xr=t,tn=!0,Au=null,Cs=!1,e!==null&&(Pi[Ri++]=bo,Pi[Ri++]=yo,Pi[Ri++]=Cu,bo=e.id,yo=e.overflow,Cu=t),t=ay(t,a.children),t.flags|=4096);return t}return r?(hl(),r=a.fallback,o=t.mode,u=e.child,c=u.sibling,a=ko(u,{mode:"hidden",children:a.children}),a.subtreeFlags=u.subtreeFlags&65011712,c!==null?r=ko(c,r):(r=ju(r,o,n,null),r.flags|=2),r.return=t,a.return=t,a.sibling=r,t.child=a,a=r,r=t.child,o=e.child.memoizedState,o===null?o=vb(n):(u=o.cachePool,u!==null?(c=ba._currentValue,u=u.parent!==c?{parent:c,pool:c}:u):u=o_(),o={baseLanes:o.baseLanes|n,cachePool:u}),r.memoizedState=o,r.childLanes=xb(e,s,n),t.memoizedState=gb,a):(dl(t),n=e.child,e=n.sibling,n=ko(n,{mode:"visible",children:a.children}),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function ay(e,t){return t=r0({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function r0(e,t){return e=si(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function bb(e,t,n){return Bd(t,e.child,null,n),e=ay(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function C3(e,t,n){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),H1(e.return,t,n)}function yb(e,t,n,a,r){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=n,i.tailMode=r)}function nj(e,t,n){var a=t.pendingProps,r=a.revealOrder,i=a.tail;if(Ha(e,t,a.children,n),a=wa.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&C3(e,n,t);else if(e.tag===19)C3(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(Mn(wa,a),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&t0(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),yb(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&t0(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}yb(t,!0,n,null,i);break;case"together":yb(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ao(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ql|=t.lanes,!(n&t.childLanes))if(e!==null){if(xp(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(Ve(153));if(t.child!==null){for(e=t.child,n=ko(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ko(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function iw(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&Xg(e)))}function nP(e,t,n){switch(t.tag){case 3:qg(t,t.stateNode.containerInfo),cl(t,ba,e.memoizedState.cache),vp();break;case 27:case 5:L1(t);break;case 4:qg(t,t.stateNode.containerInfo);break;case 10:cl(t,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(dl(t),t.flags|=128,null):n&t.child.childLanes?tj(e,t,n):(dl(t),e=Ao(e,t,n),e!==null?e.sibling:null);dl(t);break;case 19:var r=(e.flags&128)!==0;if(a=(n&t.childLanes)!==0,a||(xp(e,t,n,!1),a=(n&t.childLanes)!==0),r){if(a)return nj(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Mn(wa,wa.current),a)break;return null;case 22:case 23:return t.lanes=0,ej(e,t,n);case 24:cl(t,ba,e.memoizedState.cache)}return Ao(e,t,n)}function aj(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ma=!0;else{if(!iw(e,n)&&!(t.flags&128))return Ma=!1,nP(e,t,n);Ma=!!(e.flags&131072)}else Ma=!1,tn&&t.flags&1048576&&i_(t,Yg,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,r=a._init;if(a=r(a._payload),t.type=a,typeof a=="function")z2(a)?(e=Gu(a,e),t.tag=1,t=_3(null,t,a,e,n)):(t.tag=0,t=ny(null,t,a,e,n));else{if(a!=null){if(r=a.$$typeof,r===j2){t.tag=11,t=w3(null,t,a,e,n);break e}else if(r===C2){t.tag=14,t=N3(null,t,a,e,n);break e}}throw t=D1(a)||a,Error(Ve(306,t,""))}}return t;case 0:return ny(e,t,t.type,t.pendingProps,n);case 1:return a=t.type,r=Gu(a,t.pendingProps),_3(e,t,a,r,n);case 3:e:{if(qg(t,t.stateNode.containerInfo),e===null)throw Error(Ve(387));a=t.pendingProps;var i=t.memoizedState;r=i.element,K1(e,t),bf(t,a,null,n);var s=t.memoizedState;if(a=s.cache,cl(t,ba,a),a!==i.cache&&V1(t,[ba],n,!0),xf(),a=s.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){t=j3(e,t,a,n);break e}else if(a!==r){r=Ii(Error(Ve(424)),t),zf(r),t=j3(e,t,a,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Kn=ss(e.firstChild),xr=t,tn=!0,Au=null,Cs=!0,n=V_(t,null,a,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(vp(),a===r){t=Ao(e,t,n);break e}Ha(e,t,a,n)}t=t.child}return t;case 26:return Tg(e,t),e===null?(n=H3(t.type,null,t.pendingProps,null))?t.memoizedState=n:tn||(n=t.type,e=t.pendingProps,a=d0(jl.current).createElement(n),a[lr]=t,a[zr]=e,Xa(a,n,e),Ra(a),t.stateNode=a):t.memoizedState=H3(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return L1(t),e===null&&tn&&(a=t.stateNode=Wj(t.type,t.pendingProps,jl.current),xr=t,Cs=!0,r=Kn,Kl(t.type)?(vy=r,Kn=ss(a.firstChild)):Kn=r),Ha(e,t,t.pendingProps.children,n),Tg(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&tn&&((r=a=Kn)&&(a=DP(a,t.type,t.pendingProps,Cs),a!==null?(t.stateNode=a,xr=t,Kn=ss(a.firstChild),Cs=!1,r=!0):r=!1),r||Wu(t)),L1(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,py(r,i)?a=null:s!==null&&py(r,s)&&(t.flags|=32),t.memoizedState!==null&&(r=K2(e,t,KL,null,null,n),Gf._currentValue=r),Tg(e,t),Ha(e,t,a,n),t.child;case 6:return e===null&&tn&&((e=n=Kn)&&(n=TP(n,t.pendingProps,Cs),n!==null?(t.stateNode=n,xr=t,Kn=null,e=!0):e=!1),e||Wu(t)),null;case 13:return tj(e,t,n);case 4:return qg(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Bd(t,null,a,n):Ha(e,t,a,n),t.child;case 11:return w3(e,t,t.type,t.pendingProps,n);case 7:return Ha(e,t,t.pendingProps,n),t.child;case 8:return Ha(e,t,t.pendingProps.children,n),t.child;case 12:return Ha(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,cl(t,t.type,a.value),Ha(e,t,a.children,n),t.child;case 9:return r=t.type._context,a=t.pendingProps.children,Hu(t),r=ur(r),a=a(r),t.flags|=1,Ha(e,t,a,n),t.child;case 14:return N3(e,t,t.type,t.pendingProps,n);case 15:return Z_(e,t,t.type,t.pendingProps,n);case 19:return nj(e,t,n);case 31:return a=t.pendingProps,n=t.mode,a={mode:a.mode,children:a.children},e===null?(n=r0(a,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=ko(e.child,a),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return ej(e,t,n);case 24:return Hu(t),a=ur(ba),e===null?(r=H2(),r===null&&(r=Sn,i=W2(),r.pooledCache=i,i.refCount++,i!==null&&(r.pooledCacheLanes|=n),r=i),t.memoizedState={parent:a,cache:r},V2(t),cl(t,ba,r)):(e.lanes&n&&(K1(e,t),bf(t,null,null,n),xf()),r=e.memoizedState,i=t.memoizedState,r.parent!==a?(r={parent:a,cache:a},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),cl(t,ba,a)):(a=i.cache,cl(t,ba,a),a!==r.cache&&V1(t,[ba],n,!0))),Ha(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(Ve(156,t.tag))}function lo(e){e.flags|=4}function A3(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!Gj(t)){if(t=Hi.current,t!==null&&((Kt&4194048)===Kt?Is!==null:(Kt&62914560)!==Kt&&!(Kt&536870912)||t!==Is))throw gf=$1,l_;e.flags|=8192}}function Gm(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ES():536870912,e.lanes|=t,zd|=t)}function Yh(e,t){if(!tn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Bn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags&65011712,a|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function aP(e,t,n){var a=t.pendingProps;switch(q2(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(t),null;case 1:return Bn(t),null;case 3:return n=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),So(ba),Pd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&($h(t)?lo(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,r3())),Bn(t),null;case 26:return n=t.memoizedState,e===null?(lo(t),n!==null?(Bn(t),A3(t,n)):(Bn(t),t.flags&=-16777217)):n?n!==e.memoizedState?(lo(t),Bn(t),A3(t,n)):(Bn(t),t.flags&=-16777217):(e.memoizedProps!==a&&lo(t),Bn(t),t.flags&=-16777217),null;case 27:Wg(t),n=jl.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==a&&lo(t);else{if(!a){if(t.stateNode===null)throw Error(Ve(166));return Bn(t),null}e=Ms.current,$h(t)?n3(t):(e=Wj(r,a,n),t.stateNode=e,lo(t))}return Bn(t),null;case 5:if(Wg(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&lo(t);else{if(!a){if(t.stateNode===null)throw Error(Ve(166));return Bn(t),null}if(e=Ms.current,$h(t))n3(t);else{switch(r=d0(jl.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof a.is=="string"?r.createElement("select",{is:a.is}):r.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e=typeof a.is=="string"?r.createElement(n,{is:a.is}):r.createElement(n)}}e[lr]=t,e[zr]=a;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(Xa(e,n,a),n){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&lo(t)}}return Bn(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&lo(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Ve(166));if(e=jl.current,$h(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,r=xr,r!==null)switch(r.tag){case 27:case 5:a=r.memoizedProps}e[lr]=t,e=!!(e.nodeValue===n||a!==null&&a.suppressHydrationWarning===!0||zj(e.nodeValue,n)),e||Wu(t)}else e=d0(e).createTextNode(a),e[lr]=t,t.stateNode=e}return Bn(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=$h(t),a!==null&&a.dehydrated!==null){if(e===null){if(!r)throw Error(Ve(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Ve(317));r[lr]=t}else vp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bn(t),r=!1}else r=r3(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(No(t),t):(No(t),null)}if(No(t),t.flags&128)return t.lanes=n,t;if(n=a!==null,e=e!==null&&e.memoizedState!==null,n){a=t.child,r=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(r=a.alternate.memoizedState.cachePool.pool);var i=null;a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==r&&(a.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Gm(t,t.updateQueue),Bn(t),null;case 4:return Pd(),e===null&&fw(t.stateNode.containerInfo),Bn(t),null;case 10:return So(t.type),Bn(t),null;case 19:if(Oa(wa),r=t.memoizedState,r===null)return Bn(t),null;if(a=(t.flags&128)!==0,i=r.rendering,i===null)if(a)Yh(r,!1);else{if(Yn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=t0(e),i!==null){for(t.flags|=128,Yh(r,!1),e=i.updateQueue,t.updateQueue=e,Gm(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)r_(n,e),n=n.sibling;return Mn(wa,wa.current&1|2),t.child}e=e.sibling}r.tail!==null&&Os()>s0&&(t.flags|=128,a=!0,Yh(r,!1),t.lanes=4194304)}else{if(!a)if(e=t0(i),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,Gm(t,e),Yh(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!tn)return Bn(t),null}else 2*Os()-r.renderingStartTime>s0&&n!==536870912&&(t.flags|=128,a=!0,Yh(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(e=r.last,e!==null?e.sibling=i:t.child=i,r.last=i)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Os(),t.sibling=null,e=wa.current,Mn(wa,a?e&1|2:e&1),t):(Bn(t),null);case 22:case 23:return No(t),G2(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?n&536870912&&!(t.flags&128)&&(Bn(t),t.subtreeFlags&6&&(t.flags|=8192)):Bn(t),n=t.updateQueue,n!==null&&Gm(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),e!==null&&Oa(Eu),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),So(ba),Bn(t),null;case 25:return null;case 30:return null}throw Error(Ve(156,t.tag))}function rP(e,t){switch(q2(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return So(ba),Pd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Wg(t),null;case 13:if(No(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ve(340));vp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Oa(wa),null;case 4:return Pd(),null;case 10:return So(t.type),null;case 22:case 23:return No(t),G2(),e!==null&&Oa(Eu),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return So(ba),null;case 25:return null;default:return null}}function rj(e,t){switch(q2(t),t.tag){case 3:So(ba),Pd();break;case 26:case 27:case 5:Wg(t);break;case 4:Pd();break;case 13:No(t);break;case 19:Oa(wa);break;case 10:So(t.type);break;case 22:case 23:No(t),G2(),e!==null&&Oa(Eu);break;case 24:So(ba)}}function kp(e,t){try{var n=t.updateQueue,a=n!==null?n.lastEffect:null;if(a!==null){var r=a.next;n=r;do{if((n.tag&e)===e){a=void 0;var i=n.create,s=n.inst;a=i(),s.destroy=a}n=n.next}while(n!==r)}}catch(o){wn(t,t.return,o)}}function Ul(e,t,n){try{var a=t.updateQueue,r=a!==null?a.lastEffect:null;if(r!==null){var i=r.next;a=i;do{if((a.tag&e)===e){var s=a.inst,o=s.destroy;if(o!==void 0){s.destroy=void 0,r=t;var u=n,c=o;try{c()}catch(d){wn(r,u,d)}}}a=a.next}while(a!==i)}}catch(d){wn(t,t.return,d)}}function ij(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{d_(t,n)}catch(a){wn(e,e.return,a)}}}function sj(e,t,n){n.props=Gu(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){wn(e,t,a)}}function wf(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof n=="function"?e.refCleanup=n(a):n.current=a}}catch(r){wn(e,t,r)}}function Ls(e,t){var n=e.ref,a=e.refCleanup;if(n!==null)if(typeof a=="function")try{a()}catch(r){wn(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){wn(e,t,r)}else n.current=null}function oj(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(r){wn(e,e.return,r)}}function wb(e,t,n){try{var a=e.stateNode;_P(a,e.type,n,t),a[zr]=t}catch(r){wn(e,e.return,r)}}function lj(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Kl(e.type)||e.tag===4}function Nb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Kl(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ry(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=vv));else if(a!==4&&(a===27&&Kl(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(ry(e,t,n),e=e.sibling;e!==null;)ry(e,t,n),e=e.sibling}function i0(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(a!==4&&(a===27&&Kl(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(i0(e,t,n),e=e.sibling;e!==null;)i0(e,t,n),e=e.sibling}function uj(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Xa(t,a,n),t[lr]=e,t[zr]=n}catch(i){wn(e,e.return,i)}}var po=!1,na=!1,kb=!1,E3=typeof WeakSet=="function"?WeakSet:Set,Pa=null;function iP(e,t){if(e=e.containerInfo,hy=m0,e=XS(e),I2(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,o=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(o=s+r),h!==i||a!==0&&h.nodeType!==3||(u=s+a),h.nodeType===3&&(s+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===r&&(o=s),p===i&&++d===a&&(u=s),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(fy={focusedElem:e,selectionRange:n},m0=!1,Pa=t;Pa!==null;)if(t=Pa,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Pa=e;else for(;Pa!==null;){switch(t=Pa,i=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&i!==null){e=void 0,n=t,r=i.memoizedProps,i=i.memoizedState,a=n.stateNode;try{var g=Gu(n.type,r,n.elementType===n.type);e=a.getSnapshotBeforeUpdate(g,i),a.__reactInternalSnapshotBeforeUpdate=e}catch(b){wn(n,n.return,b)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)my(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":my(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(Ve(163))}if(e=t.sibling,e!==null){e.return=t.return,Pa=e;break}Pa=t.return}}function cj(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:tl(e,n),a&4&&kp(5,n);break;case 1:if(tl(e,n),a&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(s){wn(n,n.return,s)}else{var r=Gu(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){wn(n,n.return,s)}}a&64&&ij(n),a&512&&wf(n,n.return);break;case 3:if(tl(e,n),a&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{d_(e,t)}catch(s){wn(n,n.return,s)}}break;case 27:t===null&&a&4&&uj(n);case 26:case 5:tl(e,n),t===null&&a&4&&oj(n),a&512&&wf(n,n.return);break;case 12:tl(e,n);break;case 13:tl(e,n),a&4&&fj(e,n),a&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=pP.bind(null,n),LP(e,n))));break;case 22:if(a=n.memoizedState!==null||po,!a){t=t!==null&&t.memoizedState!==null||na,r=po;var i=na;po=a,(na=t)&&!i?ol(e,n,(n.subtreeFlags&8772)!==0):tl(e,n),po=r,na=i}break;case 30:break;default:tl(e,n)}}function dj(e){var t=e.alternate;t!==null&&(e.alternate=null,dj(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&T2(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ln=null,Rr=!1;function uo(e,t,n){for(n=n.child;n!==null;)hj(e,t,n),n=n.sibling}function hj(e,t,n){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(hp,n)}catch{}switch(n.tag){case 26:na||Ls(n,t),uo(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:na||Ls(n,t);var a=Ln,r=Rr;Kl(n.type)&&(Ln=n.stateNode,Rr=!1),uo(e,t,n),_f(n.stateNode),Ln=a,Rr=r;break;case 5:na||Ls(n,t);case 6:if(a=Ln,r=Rr,Ln=null,uo(e,t,n),Ln=a,Rr=r,Ln!==null)if(Rr)try{(Ln.nodeType===9?Ln.body:Ln.nodeName==="HTML"?Ln.ownerDocument.body:Ln).removeChild(n.stateNode)}catch(i){wn(n,t,i)}else try{Ln.removeChild(n.stateNode)}catch(i){wn(n,t,i)}break;case 18:Ln!==null&&(Rr?(e=Ln,U3(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Yf(e)):U3(Ln,n.stateNode));break;case 4:a=Ln,r=Rr,Ln=n.stateNode.containerInfo,Rr=!0,uo(e,t,n),Ln=a,Rr=r;break;case 0:case 11:case 14:case 15:na||Ul(2,n,t),na||Ul(4,n,t),uo(e,t,n);break;case 1:na||(Ls(n,t),a=n.stateNode,typeof a.componentWillUnmount=="function"&&sj(n,t,a)),uo(e,t,n);break;case 21:uo(e,t,n);break;case 22:na=(a=na)||n.memoizedState!==null,uo(e,t,n),na=a;break;default:uo(e,t,n)}}function fj(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Yf(e)}catch(n){wn(t,t.return,n)}}function sP(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new E3),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new E3),t;default:throw Error(Ve(435,e.tag))}}function Sb(e,t){var n=sP(e);t.forEach(function(a){var r=mP.bind(null,e,a);n.has(a)||(n.add(a),a.then(r,r))})}function ti(e,t){var n=t.deletions;if(n!==null)for(var a=0;a<n.length;a++){var r=n[a],i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 27:if(Kl(o.type)){Ln=o.stateNode,Rr=!1;break e}break;case 5:Ln=o.stateNode,Rr=!1;break e;case 3:case 4:Ln=o.stateNode.containerInfo,Rr=!0;break e}o=o.return}if(Ln===null)throw Error(Ve(160));hj(i,s,r),Ln=null,Rr=!1,i=r.alternate,i!==null&&(i.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)pj(t,e),t=t.sibling}var as=null;function pj(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ti(t,e),ni(e),a&4&&(Ul(3,e,e.return),kp(3,e),Ul(5,e,e.return));break;case 1:ti(t,e),ni(e),a&512&&(na||n===null||Ls(n,n.return)),a&64&&po&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?a:n.concat(a))));break;case 26:var r=as;if(ti(t,e),ni(e),a&512&&(na||n===null||Ls(n,n.return)),a&4){var i=n!==null?n.memoizedState:null;if(a=e.memoizedState,n===null)if(a===null)if(e.stateNode===null){e:{a=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(a){case"title":i=r.getElementsByTagName("title")[0],(!i||i[mp]||i[lr]||i.namespaceURI==="http://www.w3.org/2000/svg"||i.hasAttribute("itemprop"))&&(i=r.createElement(a),r.head.insertBefore(i,r.querySelector("head > title"))),Xa(i,a,n),i[lr]=e,Ra(i),a=i;break e;case"link":var s=G3("link","href",r).get(a+(n.href||""));if(s){for(var o=0;o<s.length;o++)if(i=s[o],i.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&i.getAttribute("rel")===(n.rel==null?null:n.rel)&&i.getAttribute("title")===(n.title==null?null:n.title)&&i.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){s.splice(o,1);break t}}i=r.createElement(a),Xa(i,a,n),r.head.appendChild(i);break;case"meta":if(s=G3("meta","content",r).get(a+(n.content||""))){for(o=0;o<s.length;o++)if(i=s[o],i.getAttribute("content")===(n.content==null?null:""+n.content)&&i.getAttribute("name")===(n.name==null?null:n.name)&&i.getAttribute("property")===(n.property==null?null:n.property)&&i.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&i.getAttribute("charset")===(n.charSet==null?null:n.charSet)){s.splice(o,1);break t}}i=r.createElement(a),Xa(i,a,n),r.head.appendChild(i);break;default:throw Error(Ve(468,a))}i[lr]=e,Ra(i),a=i}e.stateNode=a}else $3(r,e.type,e.stateNode);else e.stateNode=V3(r,a,e.memoizedProps);else i!==a?(i===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):i.count--,a===null?$3(r,e.type,e.stateNode):V3(r,a,e.memoizedProps)):a===null&&e.stateNode!==null&&wb(e,e.memoizedProps,n.memoizedProps)}break;case 27:ti(t,e),ni(e),a&512&&(na||n===null||Ls(n,n.return)),n!==null&&a&4&&wb(e,e.memoizedProps,n.memoizedProps);break;case 5:if(ti(t,e),ni(e),a&512&&(na||n===null||Ls(n,n.return)),e.flags&32){r=e.stateNode;try{Md(r,"")}catch(f){wn(e,e.return,f)}}a&4&&e.stateNode!=null&&(r=e.memoizedProps,wb(e,r,n!==null?n.memoizedProps:r)),a&1024&&(kb=!0);break;case 6:if(ti(t,e),ni(e),a&4){if(e.stateNode===null)throw Error(Ve(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(f){wn(e,e.return,f)}}break;case 3:if(Rg=null,r=as,as=h0(t.containerInfo),ti(t,e),as=r,ni(e),a&4&&n!==null&&n.memoizedState.isDehydrated)try{Yf(t.containerInfo)}catch(f){wn(e,e.return,f)}kb&&(kb=!1,mj(e));break;case 4:a=as,as=h0(e.stateNode.containerInfo),ti(t,e),ni(e),as=a;break;case 12:ti(t,e),ni(e);break;case 13:ti(t,e),ni(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(cw=Os()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Sb(e,a)));break;case 22:r=e.memoizedState!==null;var u=n!==null&&n.memoizedState!==null,c=po,d=na;if(po=c||r,na=d||u,ti(t,e),na=d,po=c,ni(e),a&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||u||po||na||gu(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){u=n=t;try{if(i=u.stateNode,r)s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none";else{o=u.stateNode;var h=u.memoizedProps.style,p=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(f){wn(u,u.return,f)}}}else if(t.tag===6){if(n===null){u=t;try{u.stateNode.nodeValue=r?"":u.memoizedProps}catch(f){wn(u,u.return,f)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(n=a.retryQueue,n!==null&&(a.retryQueue=null,Sb(e,n))));break;case 19:ti(t,e),ni(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Sb(e,a)));break;case 30:break;case 21:break;default:ti(t,e),ni(e)}}function ni(e){var t=e.flags;if(t&2){try{for(var n,a=e.return;a!==null;){if(lj(a)){n=a;break}a=a.return}if(n==null)throw Error(Ve(160));switch(n.tag){case 27:var r=n.stateNode,i=Nb(e);i0(e,i,r);break;case 5:var s=n.stateNode;n.flags&32&&(Md(s,""),n.flags&=-33);var o=Nb(e);i0(e,o,s);break;case 3:case 4:var u=n.stateNode.containerInfo,c=Nb(e);ry(e,c,u);break;default:throw Error(Ve(161))}}catch(d){wn(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mj(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;mj(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function tl(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)cj(e,t.alternate,t),t=t.sibling}function gu(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ul(4,t,t.return),gu(t);break;case 1:Ls(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&sj(t,t.return,n),gu(t);break;case 27:_f(t.stateNode);case 26:case 5:Ls(t,t.return),gu(t);break;case 22:t.memoizedState===null&&gu(t);break;case 30:gu(t);break;default:gu(t)}e=e.sibling}}function ol(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,r=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:ol(r,i,n),kp(4,i);break;case 1:if(ol(r,i,n),a=i,r=a.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(c){wn(a,a.return,c)}if(a=i,r=a.updateQueue,r!==null){var o=a.stateNode;try{var u=r.shared.hiddenCallbacks;if(u!==null)for(r.shared.hiddenCallbacks=null,r=0;r<u.length;r++)c_(u[r],o)}catch(c){wn(a,a.return,c)}}n&&s&64&&ij(i),wf(i,i.return);break;case 27:uj(i);case 26:case 5:ol(r,i,n),n&&a===null&&s&4&&oj(i),wf(i,i.return);break;case 12:ol(r,i,n);break;case 13:ol(r,i,n),n&&s&4&&fj(r,i);break;case 22:i.memoizedState===null&&ol(r,i,n),wf(i,i.return);break;case 30:break;default:ol(r,i,n)}t=t.sibling}}function sw(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&bp(n))}function ow(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&bp(e))}function ys(e,t,n,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)gj(e,t,n,a),t=t.sibling}function gj(e,t,n,a){var r=t.flags;switch(t.tag){case 0:case 11:case 15:ys(e,t,n,a),r&2048&&kp(9,t);break;case 1:ys(e,t,n,a);break;case 3:ys(e,t,n,a),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&bp(e)));break;case 12:if(r&2048){ys(e,t,n,a),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;typeof o=="function"&&o(s,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(u){wn(t,t.return,u)}}else ys(e,t,n,a);break;case 13:ys(e,t,n,a);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,t.memoizedState!==null?i._visibility&2?ys(e,t,n,a):Nf(e,t):i._visibility&2?ys(e,t,n,a):(i._visibility|=2,Vc(e,t,n,a,(t.subtreeFlags&10256)!==0)),r&2048&&sw(s,t);break;case 24:ys(e,t,n,a),r&2048&&ow(t.alternate,t);break;default:ys(e,t,n,a)}}function Vc(e,t,n,a,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var i=e,s=t,o=n,u=a,c=s.flags;switch(s.tag){case 0:case 11:case 15:Vc(i,s,o,u,r),kp(8,s);break;case 23:break;case 22:var d=s.stateNode;s.memoizedState!==null?d._visibility&2?Vc(i,s,o,u,r):Nf(i,s):(d._visibility|=2,Vc(i,s,o,u,r)),r&&c&2048&&sw(s.alternate,s);break;case 24:Vc(i,s,o,u,r),r&&c&2048&&ow(s.alternate,s);break;default:Vc(i,s,o,u,r)}t=t.sibling}}function Nf(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,a=t,r=a.flags;switch(a.tag){case 22:Nf(n,a),r&2048&&sw(a.alternate,a);break;case 24:Nf(n,a),r&2048&&ow(a.alternate,a);break;default:Nf(n,a)}t=t.sibling}}var lf=8192;function Rc(e){if(e.subtreeFlags&lf)for(e=e.child;e!==null;)vj(e),e=e.sibling}function vj(e){switch(e.tag){case 26:Rc(e),e.flags&lf&&e.memoizedState!==null&&VP(as,e.memoizedState,e.memoizedProps);break;case 5:Rc(e);break;case 3:case 4:var t=as;as=h0(e.stateNode.containerInfo),Rc(e),as=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=lf,lf=16777216,Rc(e),lf=t):Rc(e));break;default:Rc(e)}}function xj(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Xh(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];Pa=a,yj(a,e)}xj(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)bj(e),e=e.sibling}function bj(e){switch(e.tag){case 0:case 11:case 15:Xh(e),e.flags&2048&&Ul(9,e,e.return);break;case 3:Xh(e);break;case 12:Xh(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Lg(e)):Xh(e);break;default:Xh(e)}}function Lg(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];Pa=a,yj(a,e)}xj(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ul(8,t,t.return),Lg(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Lg(t));break;default:Lg(t)}e=e.sibling}}function yj(e,t){for(;Pa!==null;){var n=Pa;switch(n.tag){case 0:case 11:case 15:Ul(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var a=n.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:bp(n.memoizedState.cache)}if(a=n.child,a!==null)a.return=n,Pa=a;else e:for(n=e;Pa!==null;){a=Pa;var r=a.sibling,i=a.return;if(dj(a),a===n){Pa=null;break e}if(r!==null){r.return=i,Pa=r;break e}Pa=i}}}var oP={getCacheForType:function(e){var t=ur(ba),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},lP=typeof WeakMap=="function"?WeakMap:Map,dn=0,Sn=null,Bt=null,Kt=0,cn=0,ai=null,vl=!1,th=!1,lw=!1,Eo=0,Yn=0,ql=0,Du=0,uw=0,Bi=0,zd=0,kf=null,Mr=null,iy=!1,cw=0,s0=1/0,o0=null,El=null,Ka=0,Dl=null,Ud=null,wd=0,sy=0,oy=null,wj=null,Sf=0,ly=null;function pi(){if(dn&2&&Kt!==0)return Kt&-Kt;if(kt.T!==null){var e=Od;return e!==0?e:hw()}return LS()}function Nj(){Bi===0&&(Bi=!(Kt&536870912)||tn?AS():536870912);var e=Hi.current;return e!==null&&(e.flags|=32),Bi}function mi(e,t,n){(e===Sn&&(cn===2||cn===9)||e.cancelPendingCommit!==null)&&(qd(e,0),xl(e,Kt,Bi,!1)),pp(e,n),(!(dn&2)||e!==Sn)&&(e===Sn&&(!(dn&2)&&(Du|=n),Yn===4&&xl(e,Kt,Bi,!1)),Gs(e))}function kj(e,t,n){if(dn&6)throw Error(Ve(327));var a=!n&&(t&124)===0&&(t&e.expiredLanes)===0||fp(e,t),r=a?dP(e,t):_b(e,t,!0),i=a;do{if(r===0){th&&!a&&xl(e,t,0,!1);break}else{if(n=e.current.alternate,i&&!uP(n)){r=_b(e,t,!1),i=!1;continue}if(r===2){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=e.pendingLanes&-536870913,s=s!==0?s:s&536870912?536870912:0;if(s!==0){t=s;e:{var o=e;r=kf;var u=o.current.memoizedState.isDehydrated;if(u&&(qd(o,s).flags|=256),s=_b(o,s,!1),s!==2){if(lw&&!u){o.errorRecoveryDisabledLanes|=i,Du|=i,r=4;break e}i=Mr,Mr=r,i!==null&&(Mr===null?Mr=i:Mr.push.apply(Mr,i))}r=s}if(i=!1,r!==2)continue}}if(r===1){qd(e,0),xl(e,t,0,!0);break}e:{switch(a=e,i=r,i){case 0:case 1:throw Error(Ve(345));case 4:if((t&4194048)!==t)break;case 6:xl(a,t,Bi,!vl);break e;case 2:Mr=null;break;case 3:case 5:break;default:throw Error(Ve(329))}if((t&62914560)===t&&(r=cw+300-Os(),10<r)){if(xl(a,t,Bi,!vl),rv(a,0,!0)!==0)break e;a.timeoutHandle=qj(D3.bind(null,a,n,Mr,o0,iy,t,Bi,Du,zd,vl,i,2,-0,0),r);break e}D3(a,n,Mr,o0,iy,t,Bi,Du,zd,vl,i,0,-0,0)}}break}while(!0);Gs(e)}function D3(e,t,n,a,r,i,s,o,u,c,d,h,p,f){if(e.timeoutHandle=-1,h=t.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(Vf={stylesheets:null,count:0,unsuspend:HP},vj(t),h=GP(),h!==null)){e.cancelPendingCommit=h(L3.bind(null,e,t,i,n,a,r,s,o,u,d,1,p,f)),xl(e,i,s,!c);return}L3(e,t,i,n,a,r,s,o,u)}function uP(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var a=0;a<n.length;a++){var r=n[a],i=r.getSnapshot;r=r.value;try{if(!vi(i(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xl(e,t,n,a){t&=~uw,t&=~Du,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var r=t;0<r;){var i=31-fi(r),s=1<<i;a[i]=-1,r&=~s}n!==0&&DS(e,n,t)}function pv(){return dn&6?!0:(Sp(0),!1)}function dw(){if(Bt!==null){if(cn===0)var e=Bt.return;else e=Bt,wo=Zu=null,J2(e),yd=null,qf=0,e=Bt;for(;e!==null;)rj(e.alternate,e),e=e.return;Bt=null}}function qd(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,CP(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),dw(),Sn=e,Bt=n=ko(e.current,null),Kt=t,cn=0,ai=null,vl=!1,th=fp(e,t),lw=!1,zd=Bi=uw=Du=ql=Yn=0,Mr=kf=null,iy=!1,t&8&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var r=31-fi(a),i=1<<r;t|=e[r],a&=~i}return Eo=t,lv(),n}function Sj(e,t){Rt=null,kt.H=e0,t===yp||t===cv?(t=l3(),cn=3):t===l_?(t=l3(),cn=4):cn=t===Q_?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ai=t,Bt===null&&(Yn=1,a0(e,Ii(t,e.current)))}function _j(){var e=kt.H;return kt.H=e0,e===null?e0:e}function jj(){var e=kt.A;return kt.A=oP,e}function uy(){Yn=4,vl||(Kt&4194048)!==Kt&&Hi.current!==null||(th=!0),!(ql&134217727)&&!(Du&134217727)||Sn===null||xl(Sn,Kt,Bi,!1)}function _b(e,t,n){var a=dn;dn|=2;var r=_j(),i=jj();(Sn!==e||Kt!==t)&&(o0=null,qd(e,t)),t=!1;var s=Yn;e:do try{if(cn!==0&&Bt!==null){var o=Bt,u=ai;switch(cn){case 8:dw(),s=6;break e;case 3:case 2:case 9:case 6:Hi.current===null&&(t=!0);var c=cn;if(cn=0,ai=null,dd(e,o,u,c),n&&th){s=0;break e}break;default:c=cn,cn=0,ai=null,dd(e,o,u,c)}}cP(),s=Yn;break}catch(d){Sj(e,d)}while(!0);return t&&e.shellSuspendCounter++,wo=Zu=null,dn=a,kt.H=r,kt.A=i,Bt===null&&(Sn=null,Kt=0,lv()),s}function cP(){for(;Bt!==null;)Cj(Bt)}function dP(e,t){var n=dn;dn|=2;var a=_j(),r=jj();Sn!==e||Kt!==t?(o0=null,s0=Os()+500,qd(e,t)):th=fp(e,t);e:do try{if(cn!==0&&Bt!==null){t=Bt;var i=ai;t:switch(cn){case 1:cn=0,ai=null,dd(e,t,i,1);break;case 2:case 9:if(o3(i)){cn=0,ai=null,T3(t);break}t=function(){cn!==2&&cn!==9||Sn!==e||(cn=7),Gs(e)},i.then(t,t);break e;case 3:cn=7;break e;case 4:cn=5;break e;case 7:o3(i)?(cn=0,ai=null,T3(t)):(cn=0,ai=null,dd(e,t,i,7));break;case 5:var s=null;switch(Bt.tag){case 26:s=Bt.memoizedState;case 5:case 27:var o=Bt;if(!s||Gj(s)){cn=0,ai=null;var u=o.sibling;if(u!==null)Bt=u;else{var c=o.return;c!==null?(Bt=c,mv(c)):Bt=null}break t}}cn=0,ai=null,dd(e,t,i,5);break;case 6:cn=0,ai=null,dd(e,t,i,6);break;case 8:dw(),Yn=6;break e;default:throw Error(Ve(462))}}hP();break}catch(d){Sj(e,d)}while(!0);return wo=Zu=null,kt.H=a,kt.A=r,dn=n,Bt!==null?0:(Sn=null,Kt=0,lv(),Yn)}function hP(){for(;Bt!==null&&!RT();)Cj(Bt)}function Cj(e){var t=aj(e.alternate,e,Eo);e.memoizedProps=e.pendingProps,t===null?mv(e):Bt=t}function T3(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=S3(n,t,t.pendingProps,t.type,void 0,Kt);break;case 11:t=S3(n,t,t.pendingProps,t.type.render,t.ref,Kt);break;case 5:J2(t);default:rj(n,t),t=Bt=r_(t,Eo),t=aj(n,t,Eo)}e.memoizedProps=e.pendingProps,t===null?mv(e):Bt=t}function dd(e,t,n,a){wo=Zu=null,J2(t),yd=null,qf=0;var r=t.return;try{if(tP(e,r,t,n,Kt)){Yn=1,a0(e,Ii(n,e.current)),Bt=null;return}}catch(i){if(r!==null)throw Bt=r,i;Yn=1,a0(e,Ii(n,e.current)),Bt=null;return}t.flags&32768?(tn||a===1?e=!0:th||Kt&536870912?e=!1:(vl=e=!0,(a===2||a===9||a===3||a===6)&&(a=Hi.current,a!==null&&a.tag===13&&(a.flags|=16384))),Aj(t,e)):mv(t)}function mv(e){var t=e;do{if(t.flags&32768){Aj(t,vl);return}e=t.return;var n=aP(t.alternate,t,Eo);if(n!==null){Bt=n;return}if(t=t.sibling,t!==null){Bt=t;return}Bt=t=e}while(t!==null);Yn===0&&(Yn=5)}function Aj(e,t){do{var n=rP(e.alternate,e);if(n!==null){n.flags&=32767,Bt=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Bt=e;return}Bt=e=n}while(e!==null);Yn=6,Bt=null}function L3(e,t,n,a,r,i,s,o,u){e.cancelPendingCommit=null;do gv();while(Ka!==0);if(dn&6)throw Error(Ve(327));if(t!==null){if(t===e.current)throw Error(Ve(177));if(i=t.lanes|t.childLanes,i|=F2,HT(e,n,i,s,o,u),e===Sn&&(Bt=Sn=null,Kt=0),Ud=t,Dl=e,wd=n,sy=i,oy=r,wj=a,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,gP(Hg,function(){return Pj(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,t.subtreeFlags&13878||a){a=kt.T,kt.T=null,r=rn.p,rn.p=2,s=dn,dn|=4;try{iP(e,t,n)}finally{dn=s,rn.p=r,kt.T=a}}Ka=1,Ej(),Dj(),Tj()}}function Ej(){if(Ka===1){Ka=0;var e=Dl,t=Ud,n=(t.flags&13878)!==0;if(t.subtreeFlags&13878||n){n=kt.T,kt.T=null;var a=rn.p;rn.p=2;var r=dn;dn|=4;try{pj(t,e);var i=fy,s=XS(e.containerInfo),o=i.focusedElem,u=i.selectionRange;if(s!==o&&o&&o.ownerDocument&&YS(o.ownerDocument.documentElement,o)){if(u!==null&&I2(o)){var c=u.start,d=u.end;if(d===void 0&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var h=o.ownerDocument||document,p=h&&h.defaultView||window;if(p.getSelection){var f=p.getSelection(),g=o.textContent.length,b=Math.min(u.start,g),w=u.end===void 0?b:Math.min(u.end,g);!f.extend&&b>w&&(s=w,w=b,b=s);var m=ZN(o,b),x=ZN(o,w);if(m&&x&&(f.rangeCount!==1||f.anchorNode!==m.node||f.anchorOffset!==m.offset||f.focusNode!==x.node||f.focusOffset!==x.offset)){var y=h.createRange();y.setStart(m.node,m.offset),f.removeAllRanges(),b>w?(f.addRange(y),f.extend(x.node,x.offset)):(y.setEnd(x.node,x.offset),f.addRange(y))}}}}for(h=[],f=o;f=f.parentNode;)f.nodeType===1&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var N=h[o];N.element.scrollLeft=N.left,N.element.scrollTop=N.top}}m0=!!hy,fy=hy=null}finally{dn=r,rn.p=a,kt.T=n}}e.current=t,Ka=2}}function Dj(){if(Ka===2){Ka=0;var e=Dl,t=Ud,n=(t.flags&8772)!==0;if(t.subtreeFlags&8772||n){n=kt.T,kt.T=null;var a=rn.p;rn.p=2;var r=dn;dn|=4;try{cj(e,t.alternate,t)}finally{dn=r,rn.p=a,kt.T=n}}Ka=3}}function Tj(){if(Ka===4||Ka===3){Ka=0,MT();var e=Dl,t=Ud,n=wd,a=wj;t.subtreeFlags&10256||t.flags&10256?Ka=5:(Ka=0,Ud=Dl=null,Lj(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(El=null),D2(n),t=t.stateNode,hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(hp,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=kt.T,r=rn.p,rn.p=2,kt.T=null;try{for(var i=e.onRecoverableError,s=0;s<a.length;s++){var o=a[s];i(o.value,{componentStack:o.stack})}}finally{kt.T=t,rn.p=r}}wd&3&&gv(),Gs(e),r=e.pendingLanes,n&4194090&&r&42?e===ly?Sf++:(Sf=0,ly=e):Sf=0,Sp(0)}}function Lj(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,bp(t)))}function gv(e){return Ej(),Dj(),Tj(),Pj()}function Pj(){if(Ka!==5)return!1;var e=Dl,t=sy;sy=0;var n=D2(wd),a=kt.T,r=rn.p;try{rn.p=32>n?32:n,kt.T=null,n=oy,oy=null;var i=Dl,s=wd;if(Ka=0,Ud=Dl=null,wd=0,dn&6)throw Error(Ve(331));var o=dn;if(dn|=4,bj(i.current),gj(i,i.current,s,n),dn=o,Sp(0,!1),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(hp,i)}catch{}return!0}finally{rn.p=r,kt.T=a,Lj(e,t)}}function P3(e,t,n){t=Ii(n,t),t=ty(e.stateNode,t,2),e=Al(e,t,2),e!==null&&(pp(e,2),Gs(e))}function wn(e,t,n){if(e.tag===3)P3(e,e,n);else for(;t!==null;){if(t.tag===3){P3(t,e,n);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(El===null||!El.has(a))){e=Ii(n,e),n=X_(2),a=Al(t,n,2),a!==null&&(J_(n,a,t,e),pp(a,2),Gs(a));break}}t=t.return}}function jb(e,t,n){var a=e.pingCache;if(a===null){a=e.pingCache=new lP;var r=new Set;a.set(t,r)}else r=a.get(t),r===void 0&&(r=new Set,a.set(t,r));r.has(n)||(lw=!0,r.add(n),e=fP.bind(null,e,t,n),t.then(e,e))}function fP(e,t,n){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Sn===e&&(Kt&n)===n&&(Yn===4||Yn===3&&(Kt&62914560)===Kt&&300>Os()-cw?!(dn&2)&&qd(e,0):uw|=n,zd===Kt&&(zd=0)),Gs(e)}function Rj(e,t){t===0&&(t=ES()),e=eh(e,t),e!==null&&(pp(e,t),Gs(e))}function pP(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Rj(e,n)}function mP(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(Ve(314))}a!==null&&a.delete(t),Rj(e,n)}function gP(e,t){return A2(e,t)}var l0=null,Gc=null,cy=!1,u0=!1,Cb=!1,Tu=0;function Gs(e){e!==Gc&&e.next===null&&(Gc===null?l0=Gc=e:Gc=Gc.next=e),u0=!0,cy||(cy=!0,xP())}function Sp(e,t){if(!Cb&&u0){Cb=!0;do for(var n=!1,a=l0;a!==null;){if(e!==0){var r=a.pendingLanes;if(r===0)var i=0;else{var s=a.suspendedLanes,o=a.pingedLanes;i=(1<<31-fi(42|e)+1)-1,i&=r&~(s&~o),i=i&201326741?i&201326741|1:i?i|2:0}i!==0&&(n=!0,R3(a,i))}else i=Kt,i=rv(a,a===Sn?i:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),!(i&3)||fp(a,i)||(n=!0,R3(a,i));a=a.next}while(n);Cb=!1}}function vP(){Mj()}function Mj(){u0=cy=!1;var e=0;Tu!==0&&(jP()&&(e=Tu),Tu=0);for(var t=Os(),n=null,a=l0;a!==null;){var r=a.next,i=Oj(a,t);i===0?(a.next=null,n===null?l0=r:n.next=r,r===null&&(Gc=n)):(n=a,(e!==0||i&3)&&(u0=!0)),a=r}Sp(e)}function Oj(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes&-62914561;0<i;){var s=31-fi(i),o=1<<s,u=r[s];u===-1?(!(o&n)||o&a)&&(r[s]=WT(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}if(t=Sn,n=Kt,n=rv(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,n===0||e===t&&(cn===2||cn===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&Zx(a),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||fp(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(a!==null&&Zx(a),D2(n)){case 2:case 8:n=jS;break;case 32:n=Hg;break;case 268435456:n=CS;break;default:n=Hg}return a=Ij.bind(null,e),n=A2(n,a),e.callbackPriority=t,e.callbackNode=n,t}return a!==null&&a!==null&&Zx(a),e.callbackPriority=2,e.callbackNode=null,2}function Ij(e,t){if(Ka!==0&&Ka!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(gv()&&e.callbackNode!==n)return null;var a=Kt;return a=rv(e,e===Sn?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(kj(e,a,t),Oj(e,Os()),e.callbackNode!=null&&e.callbackNode===n?Ij.bind(null,e):null)}function R3(e,t){if(gv())return null;kj(e,t,!0)}function xP(){AP(function(){dn&6?A2(_S,vP):Mj()})}function hw(){return Tu===0&&(Tu=AS()),Tu}function M3(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Sg(""+e)}function O3(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function bP(e,t,n,a,r){if(t==="submit"&&n&&n.stateNode===r){var i=M3((r[zr]||null).action),s=a.submitter;s&&(t=(t=s[zr]||null)?M3(t.formAction):s.getAttribute("formAction"),t!==null&&(i=t,s=null));var o=new iv("action","action",null,a,r);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(Tu!==0){var u=s?O3(r,s):new FormData(r);Z1(n,{pending:!0,data:u,method:r.method,action:i},null,u)}}else typeof i=="function"&&(o.preventDefault(),u=s?O3(r,s):new FormData(r),Z1(n,{pending:!0,data:u,method:r.method,action:i},i,u))},currentTarget:r}]})}}for(var Ab=0;Ab<U1.length;Ab++){var Eb=U1[Ab],yP=Eb.toLowerCase(),wP=Eb[0].toUpperCase()+Eb.slice(1);us(yP,"on"+wP)}us(QS,"onAnimationEnd");us(ZS,"onAnimationIteration");us(e_,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(FL,"onTransitionRun");us(BL,"onTransitionStart");us(zL,"onTransitionCancel");us(t_,"onTransitionEnd");Rd("onMouseEnter",["mouseout","mouseover"]);Rd("onMouseLeave",["mouseout","mouseover"]);Rd("onPointerEnter",["pointerout","pointerover"]);Rd("onPointerLeave",["pointerout","pointerover"]);Xu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NP=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wf));function Fj(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var s=a.length-1;0<=s;s--){var o=a[s],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&r.isPropagationStopped())break e;i=o,r.currentTarget=c;try{i(r)}catch(d){n0(d)}r.currentTarget=null,i=u}else for(s=0;s<a.length;s++){if(o=a[s],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&r.isPropagationStopped())break e;i=o,r.currentTarget=c;try{i(r)}catch(d){n0(d)}r.currentTarget=null,i=u}}}}function Ft(e,t){var n=t[R1];n===void 0&&(n=t[R1]=new Set);var a=e+"__bubble";n.has(a)||(Bj(t,e,2,!1),n.add(a))}function Db(e,t,n){var a=0;t&&(a|=4),Bj(n,e,a,t)}var $m="_reactListening"+Math.random().toString(36).slice(2);function fw(e){if(!e[$m]){e[$m]=!0,PS.forEach(function(n){n!=="selectionchange"&&(NP.has(n)||Db(n,!1,e),Db(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$m]||(t[$m]=!0,Db("selectionchange",!1,t))}}function Bj(e,t,n,a){switch(Jj(t)){case 2:var r=YP;break;case 8:r=XP;break;default:r=vw}n=r.bind(null,t,n,e),r=void 0,!F1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),a?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Tb(e,t,n,a,r){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var s=a.tag;if(s===3||s===4){var o=a.stateNode.containerInfo;if(o===r)break;if(s===4)for(s=a.return;s!==null;){var u=s.tag;if((u===3||u===4)&&s.stateNode.containerInfo===r)return;s=s.return}for(;o!==null;){if(s=nd(o),s===null)return;if(u=s.tag,u===5||u===6||u===26||u===27){a=i=s;continue e}o=o.parentNode}}a=a.return}US(function(){var c=i,d=P2(n),h=[];e:{var p=n_.get(e);if(p!==void 0){var f=iv,g=e;switch(e){case"keypress":if(jg(n)===0)break e;case"keydown":case"keyup":f=gL;break;case"focusin":g="focus",f=ob;break;case"focusout":g="blur",f=ob;break;case"beforeblur":case"afterblur":f=ob;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=WN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=rL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=bL;break;case QS:case ZS:case e_:f=oL;break;case t_:f=wL;break;case"scroll":case"scrollend":f=nL;break;case"wheel":f=kL;break;case"copy":case"cut":case"paste":f=uL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=VN;break;case"toggle":case"beforetoggle":f=_L}var b=(t&4)!==0,w=!b&&(e==="scroll"||e==="scrollend"),m=b?p!==null?p+"Capture":null:p;b=[];for(var x=c,y;x!==null;){var N=x;if(y=N.stateNode,N=N.tag,N!==5&&N!==26&&N!==27||y===null||m===null||(N=If(x,m),N!=null&&b.push(Hf(x,N,y))),w)break;x=x.return}0<b.length&&(p=new f(p,g,null,n,d),h.push({event:p,listeners:b}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&n!==I1&&(g=n.relatedTarget||n.fromElement)&&(nd(g)||g[Qd]))break e;if((f||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,f?(g=n.relatedTarget||n.toElement,f=c,g=g?nd(g):null,g!==null&&(w=dp(g),b=g.tag,g!==w||b!==5&&b!==27&&b!==6)&&(g=null)):(f=null,g=c),f!==g)){if(b=WN,N="onMouseLeave",m="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(b=VN,N="onPointerLeave",m="onPointerEnter",x="pointer"),w=f==null?p:of(f),y=g==null?p:of(g),p=new b(N,x+"leave",f,n,d),p.target=w,p.relatedTarget=y,N=null,nd(d)===c&&(b=new b(m,x+"enter",g,n,d),b.target=y,b.relatedTarget=w,N=b),w=N,f&&g)t:{for(b=f,m=g,x=0,y=b;y;y=Mc(y))x++;for(y=0,N=m;N;N=Mc(N))y++;for(;0<x-y;)b=Mc(b),x--;for(;0<y-x;)m=Mc(m),y--;for(;x--;){if(b===m||m!==null&&b===m.alternate)break t;b=Mc(b),m=Mc(m)}b=null}else b=null;f!==null&&I3(h,p,f,b,!1),g!==null&&w!==null&&I3(h,w,g,b,!0)}}e:{if(p=c?of(c):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=YN;else if(KN(p))if($S)S=ML;else{S=PL;var D=LL}else f=p.nodeName,!f||f.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?c&&L2(c.elementType)&&(S=YN):S=RL;if(S&&(S=S(e,c))){GS(h,S,n,d);break e}D&&D(e,p,c),e==="focusout"&&c&&p.type==="number"&&c.memoizedProps.value!=null&&O1(p,"number",p.value)}switch(D=c?of(c):window,e){case"focusin":(KN(D)||D.contentEditable==="true")&&(id=D,B1=c,pf=null);break;case"focusout":pf=B1=id=null;break;case"mousedown":z1=!0;break;case"contextmenu":case"mouseup":case"dragend":z1=!1,e3(h,n,d);break;case"selectionchange":if(IL)break;case"keydown":case"keyup":e3(h,n,d)}var _;if(O2)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else rd?HS(e,n)&&(A="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(WS&&n.locale!=="ko"&&(rd||A!=="onCompositionStart"?A==="onCompositionEnd"&&rd&&(_=qS()):(gl=d,R2="value"in gl?gl.value:gl.textContent,rd=!0)),D=c0(c,A),0<D.length&&(A=new HN(A,e,null,n,d),h.push({event:A,listeners:D}),_?A.data=_:(_=VS(n),_!==null&&(A.data=_)))),(_=CL?AL(e,n):EL(e,n))&&(A=c0(c,"onBeforeInput"),0<A.length&&(D=new HN("onBeforeInput","beforeinput",null,n,d),h.push({event:D,listeners:A}),D.data=_)),bP(h,e,c,n,d)}Fj(h,t)})}function Hf(e,t,n){return{instance:e,listener:t,currentTarget:n}}function c0(e,t){for(var n=t+"Capture",a=[];e!==null;){var r=e,i=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||i===null||(r=If(e,n),r!=null&&a.unshift(Hf(e,r,i)),r=If(e,t),r!=null&&a.push(Hf(e,r,i))),e.tag===3)return a;e=e.return}return[]}function Mc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function I3(e,t,n,a,r){for(var i=t._reactName,s=[];n!==null&&n!==a;){var o=n,u=o.alternate,c=o.stateNode;if(o=o.tag,u!==null&&u===a)break;o!==5&&o!==26&&o!==27||c===null||(u=c,r?(c=If(n,i),c!=null&&s.unshift(Hf(n,c,u))):r||(c=If(n,i),c!=null&&s.push(Hf(n,c,u)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var kP=/\r\n?/g,SP=/\u0000|\uFFFD/g;function F3(e){return(typeof e=="string"?e:""+e).replace(kP,`
`).replace(SP,"")}function zj(e,t){return t=F3(t),F3(e)===t}function vv(){}function gn(e,t,n,a,r,i){switch(n){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||Md(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&Md(e,""+a);break;case"className":zm(e,"class",a);break;case"tabIndex":zm(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":zm(e,n,a);break;case"style":zS(e,a,i);break;case"data":if(t!=="object"){zm(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=Sg(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof i=="function"&&(n==="formAction"?(t!=="input"&&gn(e,t,"name",r.name,r,null),gn(e,t,"formEncType",r.formEncType,r,null),gn(e,t,"formMethod",r.formMethod,r,null),gn(e,t,"formTarget",r.formTarget,r,null)):(gn(e,t,"encType",r.encType,r,null),gn(e,t,"method",r.method,r,null),gn(e,t,"target",r.target,r,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=Sg(""+a),e.setAttribute(n,a);break;case"onClick":a!=null&&(e.onclick=vv);break;case"onScroll":a!=null&&Ft("scroll",e);break;case"onScrollEnd":a!=null&&Ft("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(Ve(61));if(n=a.__html,n!=null){if(r.children!=null)throw Error(Ve(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}n=Sg(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":a===!0?e.setAttribute(n,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Ft("beforetoggle",e),Ft("toggle",e),kg(e,"popover",a);break;case"xlinkActuate":oo(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":oo(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":oo(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":oo(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":oo(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":oo(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":oo(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":oo(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":oo(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":kg(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=eL.get(n)||n,kg(e,n,a))}}function dy(e,t,n,a,r,i){switch(n){case"style":zS(e,a,i);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(Ve(61));if(n=a.__html,n!=null){if(r.children!=null)throw Error(Ve(60));e.innerHTML=n}}break;case"children":typeof a=="string"?Md(e,a):(typeof a=="number"||typeof a=="bigint")&&Md(e,""+a);break;case"onScroll":a!=null&&Ft("scroll",e);break;case"onScrollEnd":a!=null&&Ft("scrollend",e);break;case"onClick":a!=null&&(e.onclick=vv);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!RS.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),i=e[zr]||null,i=i!=null?i[n]:null,typeof i=="function"&&e.removeEventListener(t,i,r),typeof a=="function")){typeof i!="function"&&i!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,r);break e}n in e?e[n]=a:a===!0?e.setAttribute(n,""):kg(e,n,a)}}}function Xa(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ft("error",e),Ft("load",e);var a=!1,r=!1,i;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(s!=null)switch(i){case"src":a=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Ve(137,t));default:gn(e,t,i,s,n,null)}}r&&gn(e,t,"srcSet",n.srcSet,n,null),a&&gn(e,t,"src",n.src,n,null);return;case"input":Ft("invalid",e);var o=i=s=r=null,u=null,c=null;for(a in n)if(n.hasOwnProperty(a)){var d=n[a];if(d!=null)switch(a){case"name":r=d;break;case"type":s=d;break;case"checked":u=d;break;case"defaultChecked":c=d;break;case"value":i=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(Ve(137,t));break;default:gn(e,t,a,d,n,null)}}IS(e,i,o,u,c,s,r,!1),Vg(e);return;case"select":Ft("invalid",e),a=s=i=null;for(r in n)if(n.hasOwnProperty(r)&&(o=n[r],o!=null))switch(r){case"value":i=o;break;case"defaultValue":s=o;break;case"multiple":a=o;default:gn(e,t,r,o,n,null)}t=i,n=s,e.multiple=!!a,t!=null?md(e,!!a,t,!1):n!=null&&md(e,!!a,n,!0);return;case"textarea":Ft("invalid",e),i=r=a=null;for(s in n)if(n.hasOwnProperty(s)&&(o=n[s],o!=null))switch(s){case"value":a=o;break;case"defaultValue":r=o;break;case"children":i=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Ve(91));break;default:gn(e,t,s,o,n,null)}BS(e,a,r,i),Vg(e);return;case"option":for(u in n)if(n.hasOwnProperty(u)&&(a=n[u],a!=null))switch(u){case"selected":e.selected=a&&typeof a!="function"&&typeof a!="symbol";break;default:gn(e,t,u,a,n,null)}return;case"dialog":Ft("beforetoggle",e),Ft("toggle",e),Ft("cancel",e),Ft("close",e);break;case"iframe":case"object":Ft("load",e);break;case"video":case"audio":for(a=0;a<Wf.length;a++)Ft(Wf[a],e);break;case"image":Ft("error",e),Ft("load",e);break;case"details":Ft("toggle",e);break;case"embed":case"source":case"link":Ft("error",e),Ft("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(a=n[c],a!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(Ve(137,t));default:gn(e,t,c,a,n,null)}return;default:if(L2(t)){for(d in n)n.hasOwnProperty(d)&&(a=n[d],a!==void 0&&dy(e,t,d,a,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(a=n[o],a!=null&&gn(e,t,o,a,n,null))}function _P(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,i=null,s=null,o=null,u=null,c=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&h!=null)switch(f){case"checked":break;case"value":break;case"defaultValue":u=h;default:a.hasOwnProperty(f)||gn(e,t,f,null,a,h)}}for(var p in a){var f=a[p];if(h=n[p],a.hasOwnProperty(p)&&(f!=null||h!=null))switch(p){case"type":i=f;break;case"name":r=f;break;case"checked":c=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":o=f;break;case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(Ve(137,t));break;default:f!==h&&gn(e,t,p,f,a,h)}}M1(e,s,o,u,c,d,i,r);return;case"select":f=s=o=p=null;for(i in n)if(u=n[i],n.hasOwnProperty(i)&&u!=null)switch(i){case"value":break;case"multiple":f=u;default:a.hasOwnProperty(i)||gn(e,t,i,null,a,u)}for(r in a)if(i=a[r],u=n[r],a.hasOwnProperty(r)&&(i!=null||u!=null))switch(r){case"value":p=i;break;case"defaultValue":o=i;break;case"multiple":s=i;default:i!==u&&gn(e,t,r,i,a,u)}t=o,n=s,a=f,p!=null?md(e,!!n,p,!1):!!a!=!!n&&(t!=null?md(e,!!n,t,!0):md(e,!!n,n?[]:"",!1));return;case"textarea":f=p=null;for(o in n)if(r=n[o],n.hasOwnProperty(o)&&r!=null&&!a.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:gn(e,t,o,null,a,r)}for(s in a)if(r=a[s],i=n[s],a.hasOwnProperty(s)&&(r!=null||i!=null))switch(s){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(Ve(91));break;default:r!==i&&gn(e,t,s,r,a,i)}FS(e,p,f);return;case"option":for(var g in n)if(p=n[g],n.hasOwnProperty(g)&&p!=null&&!a.hasOwnProperty(g))switch(g){case"selected":e.selected=!1;break;default:gn(e,t,g,null,a,p)}for(u in a)if(p=a[u],f=n[u],a.hasOwnProperty(u)&&p!==f&&(p!=null||f!=null))switch(u){case"selected":e.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:gn(e,t,u,p,a,f)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var b in n)p=n[b],n.hasOwnProperty(b)&&p!=null&&!a.hasOwnProperty(b)&&gn(e,t,b,null,a,p);for(c in a)if(p=a[c],f=n[c],a.hasOwnProperty(c)&&p!==f&&(p!=null||f!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(Ve(137,t));break;default:gn(e,t,c,p,a,f)}return;default:if(L2(t)){for(var w in n)p=n[w],n.hasOwnProperty(w)&&p!==void 0&&!a.hasOwnProperty(w)&&dy(e,t,w,void 0,a,p);for(d in a)p=a[d],f=n[d],!a.hasOwnProperty(d)||p===f||p===void 0&&f===void 0||dy(e,t,d,p,a,f);return}}for(var m in n)p=n[m],n.hasOwnProperty(m)&&p!=null&&!a.hasOwnProperty(m)&&gn(e,t,m,null,a,p);for(h in a)p=a[h],f=n[h],!a.hasOwnProperty(h)||p===f||p==null&&f==null||gn(e,t,h,p,a,f)}var hy=null,fy=null;function d0(e){return e.nodeType===9?e:e.ownerDocument}function B3(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uj(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function py(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lb=null;function jP(){var e=window.event;return e&&e.type==="popstate"?e===Lb?!1:(Lb=e,!0):(Lb=null,!1)}var qj=typeof setTimeout=="function"?setTimeout:void 0,CP=typeof clearTimeout=="function"?clearTimeout:void 0,z3=typeof Promise=="function"?Promise:void 0,AP=typeof queueMicrotask=="function"?queueMicrotask:typeof z3<"u"?function(e){return z3.resolve(null).then(e).catch(EP)}:qj;function EP(e){setTimeout(function(){throw e})}function Kl(e){return e==="head"}function U3(e,t){var n=t,a=0,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(0<a&&8>a){n=a;var s=e.ownerDocument;if(n&1&&_f(s.documentElement),n&2&&_f(s.body),n&4)for(n=s.head,_f(n),s=n.firstChild;s;){var o=s.nextSibling,u=s.nodeName;s[mp]||u==="SCRIPT"||u==="STYLE"||u==="LINK"&&s.rel.toLowerCase()==="stylesheet"||n.removeChild(s),s=o}}if(r===0){e.removeChild(i),Yf(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:a=n.charCodeAt(0)-48;else a=0;n=i}while(n);Yf(t)}function my(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":my(n),T2(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function DP(e,t,n,a){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[mp])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(i=e.getAttribute("rel"),i==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(i!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(i=e.getAttribute("src"),(i!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var i=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===i)return e}else return e;if(e=ss(e.nextSibling),e===null)break}return null}function TP(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ss(e.nextSibling),e===null))return null;return e}function gy(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function LP(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function ss(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var vy=null;function q3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function Wj(e,t,n){switch(t=d0(n),e){case"html":if(e=t.documentElement,!e)throw Error(Ve(452));return e;case"head":if(e=t.head,!e)throw Error(Ve(453));return e;case"body":if(e=t.body,!e)throw Error(Ve(454));return e;default:throw Error(Ve(451))}}function _f(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);T2(e)}var Vi=new Map,W3=new Set;function h0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Do=rn.d;rn.d={f:PP,r:RP,D:MP,C:OP,L:IP,m:FP,X:zP,S:BP,M:UP};function PP(){var e=Do.f(),t=pv();return e||t}function RP(e){var t=Zd(e);t!==null&&t.tag===5&&t.type==="form"?O_(t):Do.r(e)}var nh=typeof document>"u"?null:document;function Hj(e,t,n){var a=nh;if(a&&typeof t=="string"&&t){var r=Oi(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),W3.has(r)||(W3.add(r),e={rel:e,crossOrigin:n,href:t},a.querySelector(r)===null&&(t=a.createElement("link"),Xa(t,"link",e),Ra(t),a.head.appendChild(t)))}}function MP(e){Do.D(e),Hj("dns-prefetch",e,null)}function OP(e,t){Do.C(e,t),Hj("preconnect",e,t)}function IP(e,t,n){Do.L(e,t,n);var a=nh;if(a&&e&&t){var r='link[rel="preload"][as="'+Oi(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+Oi(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+Oi(n.imageSizes)+'"]')):r+='[href="'+Oi(e)+'"]';var i=r;switch(t){case"style":i=Wd(e);break;case"script":i=ah(e)}Vi.has(i)||(e=Dn({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Vi.set(i,e),a.querySelector(r)!==null||t==="style"&&a.querySelector(_p(i))||t==="script"&&a.querySelector(jp(i))||(t=a.createElement("link"),Xa(t,"link",e),Ra(t),a.head.appendChild(t)))}}function FP(e,t){Do.m(e,t);var n=nh;if(n&&e){var a=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+Oi(a)+'"][href="'+Oi(e)+'"]',i=r;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=ah(e)}if(!Vi.has(i)&&(e=Dn({rel:"modulepreload",href:e},t),Vi.set(i,e),n.querySelector(r)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(jp(i)))return}a=n.createElement("link"),Xa(a,"link",e),Ra(a),n.head.appendChild(a)}}}function BP(e,t,n){Do.S(e,t,n);var a=nh;if(a&&e){var r=pd(a).hoistableStyles,i=Wd(e);t=t||"default";var s=r.get(i);if(!s){var o={loading:0,preload:null};if(s=a.querySelector(_p(i)))o.loading=5;else{e=Dn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Vi.get(i))&&pw(e,n);var u=s=a.createElement("link");Ra(u),Xa(u,"link",e),u._p=new Promise(function(c,d){u.onload=c,u.onerror=d}),u.addEventListener("load",function(){o.loading|=1}),u.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Pg(s,t,a)}s={type:"stylesheet",instance:s,count:1,state:o},r.set(i,s)}}}function zP(e,t){Do.X(e,t);var n=nh;if(n&&e){var a=pd(n).hoistableScripts,r=ah(e),i=a.get(r);i||(i=n.querySelector(jp(r)),i||(e=Dn({src:e,async:!0},t),(t=Vi.get(r))&&mw(e,t),i=n.createElement("script"),Ra(i),Xa(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(r,i))}}function UP(e,t){Do.M(e,t);var n=nh;if(n&&e){var a=pd(n).hoistableScripts,r=ah(e),i=a.get(r);i||(i=n.querySelector(jp(r)),i||(e=Dn({src:e,async:!0,type:"module"},t),(t=Vi.get(r))&&mw(e,t),i=n.createElement("script"),Ra(i),Xa(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(r,i))}}function H3(e,t,n,a){var r=(r=jl.current)?h0(r):null;if(!r)throw Error(Ve(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Wd(n.href),n=pd(r).hoistableStyles,a=n.get(t),a||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Wd(n.href);var i=pd(r).hoistableStyles,s=i.get(e);if(s||(r=r.ownerDocument||r,s={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},i.set(e,s),(i=r.querySelector(_p(e)))&&!i._p&&(s.instance=i,s.state.loading=5),Vi.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Vi.set(e,n),i||qP(r,e,n,s.state))),t&&a===null)throw Error(Ve(528,""));return s}if(t&&a!==null)throw Error(Ve(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=ah(n),n=pd(r).hoistableScripts,a=n.get(t),a||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(Ve(444,e))}}function Wd(e){return'href="'+Oi(e)+'"'}function _p(e){return'link[rel="stylesheet"]['+e+"]"}function Vj(e){return Dn({},e,{"data-precedence":e.precedence,precedence:null})}function qP(e,t,n,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),Xa(t,"link",n),Ra(t),e.head.appendChild(t))}function ah(e){return'[src="'+Oi(e)+'"]'}function jp(e){return"script[async]"+e}function V3(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+Oi(n.href)+'"]');if(a)return t.instance=a,Ra(a),a;var r=Dn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),Ra(a),Xa(a,"style",r),Pg(a,n.precedence,e),t.instance=a;case"stylesheet":r=Wd(n.href);var i=e.querySelector(_p(r));if(i)return t.state.loading|=4,t.instance=i,Ra(i),i;a=Vj(n),(r=Vi.get(r))&&pw(a,r),i=(e.ownerDocument||e).createElement("link"),Ra(i);var s=i;return s._p=new Promise(function(o,u){s.onload=o,s.onerror=u}),Xa(i,"link",a),t.state.loading|=4,Pg(i,n.precedence,e),t.instance=i;case"script":return i=ah(n.src),(r=e.querySelector(jp(i)))?(t.instance=r,Ra(r),r):(a=n,(r=Vi.get(i))&&(a=Dn({},n),mw(a,r)),e=e.ownerDocument||e,r=e.createElement("script"),Ra(r),Xa(r,"link",a),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(Ve(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(a=t.instance,t.state.loading|=4,Pg(a,n.precedence,e));return t.instance}function Pg(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=a.length?a[a.length-1]:null,i=r,s=0;s<a.length;s++){var o=a[s];if(o.dataset.precedence===t)i=o;else if(i!==r)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function pw(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function mw(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Rg=null;function G3(e,t,n){if(Rg===null){var a=new Map,r=Rg=new Map;r.set(n,a)}else r=Rg,a=r.get(n),a||(a=new Map,r.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var i=n[r];if(!(i[mp]||i[lr]||e==="link"&&i.getAttribute("rel")==="stylesheet")&&i.namespaceURI!=="http://www.w3.org/2000/svg"){var s=i.getAttribute(t)||"";s=e+s;var o=a.get(s);o?o.push(i):a.set(s,[i])}}return a}function $3(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function WP(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Gj(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Vf=null;function HP(){}function VP(e,t,n){if(Vf===null)throw Error(Ve(475));var a=Vf;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var r=Wd(n.href),i=e.querySelector(_p(r));if(i){e=i._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(a.count++,a=f0.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=i,Ra(i);return}i=e.ownerDocument||e,n=Vj(n),(r=Vi.get(r))&&pw(n,r),i=i.createElement("link"),Ra(i);var s=i;s._p=new Promise(function(o,u){s.onload=o,s.onerror=u}),Xa(i,"link",n),t.instance=i}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(a.count++,t=f0.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}function GP(){if(Vf===null)throw Error(Ve(475));var e=Vf;return e.stylesheets&&e.count===0&&xy(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&xy(e,e.stylesheets),e.unsuspend){var a=e.unsuspend;e.unsuspend=null,a()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function f0(){if(this.count--,this.count===0){if(this.stylesheets)xy(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var p0=null;function xy(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,p0=new Map,t.forEach($P,e),p0=null,f0.call(e))}function $P(e,t){if(!(t.state.loading&4)){var n=p0.get(e);if(n)var a=n.get(null);else{n=new Map,p0.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<r.length;i++){var s=r[i];(s.nodeName==="LINK"||s.getAttribute("media")!=="not all")&&(n.set(s.dataset.precedence,s),a=s)}a&&n.set(null,a)}r=t.instance,s=r.getAttribute("data-precedence"),i=n.get(s)||a,i===a&&n.set(null,r),n.set(s,r),this.count++,a=f0.bind(this),r.addEventListener("load",a),r.addEventListener("error",a),i?i.parentNode.insertBefore(r,i.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var Gf={$$typeof:xo,Provider:null,Consumer:null,_currentValue:_u,_currentValue2:_u,_threadCount:0};function KP(e,t,n,a,r,i,s,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=eb(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eb(0),this.hiddenUpdates=eb(null),this.identifierPrefix=a,this.onUncaughtError=r,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function $j(e,t,n,a,r,i,s,o,u,c,d,h){return e=new KP(e,t,n,s,o,u,c,h),t=1,i===!0&&(t|=24),i=si(3,null,null,t),e.current=i,i.stateNode=e,t=W2(),t.refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:a,isDehydrated:n,cache:t},V2(i),e}function Kj(e){return e?(e=ld,e):ld}function Yj(e,t,n,a,r,i){r=Kj(r),a.context===null?a.context=r:a.pendingContext=r,a=Cl(t),a.payload={element:n},i=i===void 0?null:i,i!==null&&(a.callback=i),n=Al(e,a,t),n!==null&&(mi(n,e,t),vf(n,e,t))}function K3(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function gw(e,t){K3(e,t),(e=e.alternate)&&K3(e,t)}function Xj(e){if(e.tag===13){var t=eh(e,67108864);t!==null&&mi(t,e,67108864),gw(e,67108864)}}var m0=!0;function YP(e,t,n,a){var r=kt.T;kt.T=null;var i=rn.p;try{rn.p=2,vw(e,t,n,a)}finally{rn.p=i,kt.T=r}}function XP(e,t,n,a){var r=kt.T;kt.T=null;var i=rn.p;try{rn.p=8,vw(e,t,n,a)}finally{rn.p=i,kt.T=r}}function vw(e,t,n,a){if(m0){var r=by(a);if(r===null)Tb(e,t,a,g0,n),Y3(e,a);else if(QP(r,e,t,n,a))a.stopPropagation();else if(Y3(e,a),t&4&&-1<JP.indexOf(e)){for(;r!==null;){var i=Zd(r);if(i!==null)switch(i.tag){case 3:if(i=i.stateNode,i.current.memoizedState.isDehydrated){var s=pu(i.pendingLanes);if(s!==0){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var u=1<<31-fi(s);o.entanglements[1]|=u,s&=~u}Gs(i),!(dn&6)&&(s0=Os()+500,Sp(0))}}break;case 13:o=eh(i,2),o!==null&&mi(o,i,2),pv(),gw(i,2)}if(i=by(a),i===null&&Tb(e,t,a,g0,n),i===r)break;r=i}r!==null&&a.stopPropagation()}else Tb(e,t,a,null,n)}}function by(e){return e=P2(e),xw(e)}var g0=null;function xw(e){if(g0=null,e=nd(e),e!==null){var t=dp(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=wS(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return g0=e,null}function Jj(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(OT()){case _S:return 2;case jS:return 8;case Hg:case IT:return 32;case CS:return 268435456;default:return 32}default:return 32}}var yy=!1,Tl=null,Ll=null,Pl=null,$f=new Map,Kf=new Map,fl=[],JP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Y3(e,t){switch(e){case"focusin":case"focusout":Tl=null;break;case"dragenter":case"dragleave":Ll=null;break;case"mouseover":case"mouseout":Pl=null;break;case"pointerover":case"pointerout":$f.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kf.delete(t.pointerId)}}function Jh(e,t,n,a,r,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:i,targetContainers:[r]},t!==null&&(t=Zd(t),t!==null&&Xj(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function QP(e,t,n,a,r){switch(t){case"focusin":return Tl=Jh(Tl,e,t,n,a,r),!0;case"dragenter":return Ll=Jh(Ll,e,t,n,a,r),!0;case"mouseover":return Pl=Jh(Pl,e,t,n,a,r),!0;case"pointerover":var i=r.pointerId;return $f.set(i,Jh($f.get(i)||null,e,t,n,a,r)),!0;case"gotpointercapture":return i=r.pointerId,Kf.set(i,Jh(Kf.get(i)||null,e,t,n,a,r)),!0}return!1}function Qj(e){var t=nd(e.target);if(t!==null){var n=dp(t);if(n!==null){if(t=n.tag,t===13){if(t=wS(n),t!==null){e.blockedOn=t,VT(e.priority,function(){if(n.tag===13){var a=pi();a=E2(a);var r=eh(n,a);r!==null&&mi(r,n,a),gw(n,a)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=by(e.nativeEvent);if(n===null){n=e.nativeEvent;var a=new n.constructor(n.type,n);I1=a,n.target.dispatchEvent(a),I1=null}else return t=Zd(n),t!==null&&Xj(t),e.blockedOn=n,!1;t.shift()}return!0}function X3(e,t,n){Mg(e)&&n.delete(t)}function ZP(){yy=!1,Tl!==null&&Mg(Tl)&&(Tl=null),Ll!==null&&Mg(Ll)&&(Ll=null),Pl!==null&&Mg(Pl)&&(Pl=null),$f.forEach(X3),Kf.forEach(X3)}function Km(e,t){e.blockedOn===t&&(e.blockedOn=null,yy||(yy=!0,Sa.unstable_scheduleCallback(Sa.unstable_NormalPriority,ZP)))}var Ym=null;function J3(e){Ym!==e&&(Ym=e,Sa.unstable_scheduleCallback(Sa.unstable_NormalPriority,function(){Ym===e&&(Ym=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],r=e[t+2];if(typeof a!="function"){if(xw(a||n)===null)continue;break}var i=Zd(n);i!==null&&(e.splice(t,3),t-=3,Z1(i,{pending:!0,data:r,method:n.method,action:a},a,r))}}))}function Yf(e){function t(u){return Km(u,e)}Tl!==null&&Km(Tl,e),Ll!==null&&Km(Ll,e),Pl!==null&&Km(Pl,e),$f.forEach(t),Kf.forEach(t);for(var n=0;n<fl.length;n++){var a=fl[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<fl.length&&(n=fl[0],n.blockedOn===null);)Qj(n),n.blockedOn===null&&fl.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(a=0;a<n.length;a+=3){var r=n[a],i=n[a+1],s=r[zr]||null;if(typeof i=="function")s||J3(n);else if(s){var o=null;if(i&&i.hasAttribute("formAction")){if(r=i,s=i[zr]||null)o=s.formAction;else if(xw(r)!==null)continue}else o=s.action;typeof o=="function"?n[a+1]=o:(n.splice(a,3),a-=3),J3(n)}}}function bw(e){this._internalRoot=e}xv.prototype.render=bw.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ve(409));var n=t.current,a=pi();Yj(n,a,e,t,null,null)};xv.prototype.unmount=bw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yj(e.current,2,null,e,null,null),pv(),t[Qd]=null}};function xv(e){this._internalRoot=e}xv.prototype.unstable_scheduleHydration=function(e){if(e){var t=LS();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fl.length&&t!==0&&t<fl[n].priority;n++);fl.splice(n,0,e),n===0&&Qj(e)}};var Q3=bS.version;if(Q3!=="19.1.0")throw Error(Ve(527,Q3,"19.1.0"));rn.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ve(188)):(e=Object.keys(e).join(","),Error(Ve(268,e)));return e=ET(t),e=e!==null?NS(e):null,e=e===null?null:e.stateNode,e};var eR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:kt,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xm.isDisabled&&Xm.supportsFiber)try{hp=Xm.inject(eR),hi=Xm}catch{}}av.createRoot=function(e,t){if(!yS(e))throw Error(Ve(299));var n=!1,a="",r=$_,i=K_,s=Y_,o=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(i=t.onCaughtError),t.onRecoverableError!==void 0&&(s=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(o=t.unstable_transitionCallbacks)),t=$j(e,1,!1,null,null,n,a,r,i,s,o,null),e[Qd]=t.current,fw(e),new bw(t)};av.hydrateRoot=function(e,t,n){if(!yS(e))throw Error(Ve(299));var a=!1,r="",i=$_,s=K_,o=Y_,u=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(i=n.onUncaughtError),n.onCaughtError!==void 0&&(s=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(u=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=$j(e,1,!0,t,n??null,a,r,i,s,o,u,c),t.context=Kj(null),n=t.current,a=pi(),a=E2(a),r=Cl(a),r.callback=null,Al(n,r,a),n=a,t.current.lanes=n,pp(t,n),Gs(t),e[Qd]=t.current,fw(e),new xv(t)};av.version="19.1.0";function Zj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zj)}catch(e){console.error(e)}}Zj(),gS.exports=av;var tR=gS.exports;const mo="https://okltvbilvewzwyhjcfrp.supabase.co",wy="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9rbHR2YmlsdmV3end5aGpjZnJwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEwOTUwMTIsImV4cCI6MjA2NjY3MTAxMn0.6OTF3BU5qiHyQ8m7dWfnBkLOvt7BAJoFffREQl6oM_Q",rh=!mo.startsWith("http")||mo.includes("placeholder")||mo.length<10,ih=wy.includes("placeholder")||wy.length<10;let Pe;if(rh||ih){console.warn(`⚠️ Supabase not configured - using development mode.
To connect to Supabase:
1. Click "Connect to Supabase" button in the top right
2. Or manually update your .env file with actual Supabase credentials
Current URL: ${mo}
Current Key: [REDACTED]`);const e=(n="Supabase not configured")=>({data:null,error:{message:n,code:"SUPABASE_NOT_CONFIGURED"}}),t=(n=null)=>({data:n,error:null});Pe={auth:{signUp:()=>Promise.resolve(e("Please configure Supabase to sign up")),signInWithPassword:()=>Promise.resolve(e("Please configure Supabase to sign in")),signOut:()=>Promise.resolve({error:null}),getSession:()=>Promise.resolve(t({session:null})),getUser:()=>Promise.resolve(t({user:null})),onAuthStateChange:n=>(n&&setTimeout(()=>n("SIGNED_OUT",null),0),{data:{subscription:{unsubscribe:()=>{}}}}),updateUser:()=>Promise.resolve(e("Please configure Supabase to update user")),resetPasswordForEmail:()=>Promise.resolve(e("Please configure Supabase for password reset"))},from:n=>({select:(a="*")=>({eq:(r,i)=>({single:()=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),maybeSingle:()=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),limit:s=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),order:(s,o)=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),neq:(r,i)=>({limit:s=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),order:(s,o)=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),order:(r,i)=>({limit:s=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),limit:r=>Promise.resolve(e(`Please configure Supabase to query ${n}`)),range:(r,i)=>Promise.resolve(e(`Please configure Supabase to query ${n}`))}),insert:a=>({select:()=>Promise.resolve(e(`Please configure Supabase to insert into ${n}`))}),update:a=>({eq:(r,i)=>({select:()=>Promise.resolve(e(`Please configure Supabase to update ${n}`))})}),delete:()=>({eq:(a,r)=>Promise.resolve(e(`Please configure Supabase to delete from ${n}`))}),upsert:a=>({select:()=>Promise.resolve(e(`Please configure Supabase to upsert into ${n}`))})}),storage:{from:n=>({upload:(a,r,i)=>Promise.resolve(e("Please configure Supabase for file upload")),getPublicUrl:a=>({data:{publicUrl:""}}),remove:a=>Promise.resolve(e("Please configure Supabase for file removal"))})},rpc:(n,a)=>Promise.resolve(e(`Please configure Supabase to call function ${n}`))}}else try{Pe=pT(mo,wy,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"attendance-app"}}}),(async()=>{try{const{data:{session:t},error:n}=await Pe.auth.getSession();if(n){console.warn("Session error detected, clearing session:",n.message),await Pe.auth.signOut(),localStorage.removeItem(`sb-${mo.split("//")[1].split(".")[0]}-auth-token`);return}if(t){const{error:a}=await Pe.auth.getUser();a&&(a.message.includes("user_not_found")||a.message.includes("JWT"))&&(console.warn("Invalid user session detected, clearing session:",a.message),await Pe.auth.signOut(),localStorage.removeItem(`sb-${mo.split("//")[1].split(".")[0]}-auth-token`))}}catch(t){console.warn("Error during session validation, clearing session:",t.message);try{await Pe.auth.signOut(),localStorage.removeItem(`sb-${mo.split("//")[1].split(".")[0]}-auth-token`)}catch(n){console.warn("Error during sign out:",n.message)}}})(),console.log("✅ Supabase client initialized successfully")}catch(e){console.error("❌ Failed to initialize Supabase client:",e),Pe={auth:{signUp:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),signInWithPassword:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),signOut:()=>Promise.resolve({error:null}),getSession:()=>Promise.resolve({data:{session:null},error:null}),getUser:()=>Promise.resolve({data:{user:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},from:()=>({select:()=>({eq:()=>({single:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),maybeSingle:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),limit:()=>Promise.resolve({data:[],error:{message:"Supabase initialization failed"}})}),order:()=>Promise.resolve({data:[],error:{message:"Supabase initialization failed"}}),limit:()=>Promise.resolve({data:[],error:{message:"Supabase initialization failed"}})}),insert:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),update:()=>({eq:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}})}),delete:()=>({eq:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}})}),upsert:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}})}),storage:{from:()=>({upload:()=>Promise.resolve({data:null,error:{message:"Supabase initialization failed"}}),getPublicUrl:()=>({data:{publicUrl:""}})})}}}const Hd=async e=>{var t,n,a,r;if(e&&((t=e.message)!=null&&t.includes("user_not_found")||(n=e.message)!=null&&n.includes("JWT")||(a=e.message)!=null&&a.includes("Invalid token")||e.code==="user_not_found")){console.warn("Auth error detected, clearing session:",e.message);try{await Pe.auth.signOut();const i=(r=mo.split("//")[1])==null?void 0:r.split(".");i&&i[0]&&localStorage.removeItem(`sb-${i[0]}-auth-token`),window.location.href="/login"}catch(i){console.warn("Error during sign out:",i.message),window.location.href="/login"}}},eC=async()=>{try{if(rh||ih)return{latitude:-6.2,longitude:106.816666,radius:100,address:"Jakarta Office (Demo)"};const{data:e,error:t}=await Pe.from("system_settings").select("setting_value").eq("setting_key","office_location").eq("is_enabled",!0).maybeSingle();if(t&&t.code!=="PGRST116")throw await Hd(t),t;return(e==null?void 0:e.setting_value)||{latitude:-6.2,longitude:106.816666,radius:100,address:"Jakarta Office"}}catch(e){return console.error("Error fetching office location:",e),await Hd(e),{latitude:-6.2,longitude:106.816666,radius:100,address:"Jakarta Office"}}};let Oc=null,Pb=0;const tC=async(e=!1)=>{const n=Date.now();if(!e&&Oc&&n-Pb<12e4)return Oc;try{if(rh||ih)return Oc={enabled:!0,required_for_admin:!1},Pb=n,Oc;const{data:a,error:r}=await Pe.from("system_settings").select("setting_value").eq("setting_key","camera_verification").eq("is_enabled",!0).maybeSingle();if(r&&r.code!=="PGRST116")throw await Hd(r),r;return Oc=(a==null?void 0:a.setting_value)||{enabled:!0,required_for_admin:!1},Pb=n,Oc}catch(a){return console.error("Error fetching camera verification settings:",a),await Hd(a),{enabled:!0,required_for_admin:!1}}},v0=async(e,t,n)=>{try{if(rh||ih)throw new Error("Supabase not configured - please connect to Supabase first");console.log("Uploading file:",n,"to bucket:",t);try{await Pe.storage.from(t).remove([n])}catch(i){console.log("File delete attempt (ignore if not exists):",i.message)}const{data:a,error:r}=await Pe.storage.from(t).upload(n,e,{cacheControl:"3600",upsert:!0});if(r)throw console.error("Upload error details:",r),await Hd(r),new Error(`Upload failed: ${r.message}`);return console.log("Upload successful:",a),a}catch(a){throw console.error("Upload error:",a),await Hd(a),a}},x0=(e,t)=>{if(rh||ih)return"";const{data:n}=Pe.storage.from(e).getPublicUrl(t);return n.publicUrl},bl=()=>!rh&&!ih;/*!
* sweetalert2 v11.22.2
* Released under the MIT License.
*/function nC(e,t,n){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function nR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z3(e,t){return e.get(nC(e,t))}function aR(e,t,n){nR(e,t),t.set(e,n)}function rR(e,t,n){return e.set(nC(e,t),n),n}const iR=100,wt={},sR=()=>{wt.previousActiveElement instanceof HTMLElement?(wt.previousActiveElement.focus(),wt.previousActiveElement=null):document.body&&document.body.focus()},oR=e=>new Promise(t=>{if(!e)return t();const n=window.scrollX,a=window.scrollY;wt.restoreFocusTimeout=setTimeout(()=>{sR(),t()},iR),window.scrollTo(n,a)}),aC="swal2-",lR=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],Ie=lR.reduce((e,t)=>(e[t]=aC+t,e),{}),uR=["success","warning","info","question","error"],b0=uR.reduce((e,t)=>(e[t]=aC+t,e),{}),rC="SweetAlert2:",yw=e=>e.charAt(0).toUpperCase()+e.slice(1),yr=e=>{console.warn(`${rC} ${typeof e=="object"?e.join(" "):e}`)},ec=e=>{console.error(`${rC} ${e}`)},e4=[],cR=e=>{e4.includes(e)||(e4.push(e),yr(e))},iC=(e,t=null)=>{cR(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},bv=e=>typeof e=="function"?e():e,ww=e=>e&&typeof e.toPromise=="function",Cp=e=>ww(e)?e.toPromise():Promise.resolve(e),Nw=e=>e&&Promise.resolve(e)===e,Nr=()=>document.body.querySelector(`.${Ie.container}`),Ap=e=>{const t=Nr();return t?t.querySelector(e):null},bi=e=>Ap(`.${e}`),Jt=()=>bi(Ie.popup),sh=()=>bi(Ie.icon),dR=()=>bi(Ie["icon-content"]),sC=()=>bi(Ie.title),kw=()=>bi(Ie["html-container"]),oC=()=>bi(Ie.image),Sw=()=>bi(Ie["progress-steps"]),yv=()=>bi(Ie["validation-message"]),qs=()=>Ap(`.${Ie.actions} .${Ie.confirm}`),oh=()=>Ap(`.${Ie.actions} .${Ie.cancel}`),tc=()=>Ap(`.${Ie.actions} .${Ie.deny}`),hR=()=>bi(Ie["input-label"]),lh=()=>Ap(`.${Ie.loader}`),Ep=()=>bi(Ie.actions),lC=()=>bi(Ie.footer),wv=()=>bi(Ie["timer-progress-bar"]),_w=()=>bi(Ie.close),fR=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,jw=()=>{const e=Jt();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(t).sort((i,s)=>{const o=parseInt(i.getAttribute("tabindex")||"0"),u=parseInt(s.getAttribute("tabindex")||"0");return o>u?1:o<u?-1:0}),a=e.querySelectorAll(fR),r=Array.from(a).filter(i=>i.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(r))].filter(i=>Fr(i))},Cw=()=>_o(document.body,Ie.shown)&&!_o(document.body,Ie["toast-shown"])&&!_o(document.body,Ie["no-backdrop"]),Nv=()=>{const e=Jt();return e?_o(e,Ie.toast):!1},pR=()=>{const e=Jt();return e?e.hasAttribute("data-loading"):!1},yi=(e,t)=>{if(e.textContent="",t){const a=new DOMParser().parseFromString(t,"text/html"),r=a.querySelector("head");r&&Array.from(r.childNodes).forEach(s=>{e.appendChild(s)});const i=a.querySelector("body");i&&Array.from(i.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?e.appendChild(s.cloneNode(!0)):e.appendChild(s)})}},_o=(e,t)=>{if(!t)return!1;const n=t.split(/\s+/);for(let a=0;a<n.length;a++)if(!e.classList.contains(n[a]))return!1;return!0},mR=(e,t)=>{Array.from(e.classList).forEach(n=>{!Object.values(Ie).includes(n)&&!Object.values(b0).includes(n)&&!Object.values(t.showClass||{}).includes(n)&&e.classList.remove(n)})},xi=(e,t,n)=>{if(mR(e,t),!t.customClass)return;const a=t.customClass[n];if(a){if(typeof a!="string"&&!a.forEach){yr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof a}"`);return}nn(e,a)}},kv=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${Ie.popup} > .${Ie[t]}`);case"checkbox":return e.querySelector(`.${Ie.popup} > .${Ie.checkbox} input`);case"radio":return e.querySelector(`.${Ie.popup} > .${Ie.radio} input:checked`)||e.querySelector(`.${Ie.popup} > .${Ie.radio} input:first-child`);case"range":return e.querySelector(`.${Ie.popup} > .${Ie.range} input`);default:return e.querySelector(`.${Ie.popup} > .${Ie.input}`)}},uC=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},cC=(e,t,n)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(a=>{Array.isArray(e)?e.forEach(r=>{n?r.classList.add(a):r.classList.remove(a)}):n?e.classList.add(a):e.classList.remove(a)}))},nn=(e,t)=>{cC(e,t,!0)},Gi=(e,t)=>{cC(e,t,!1)},yl=(e,t)=>{const n=Array.from(e.children);for(let a=0;a<n.length;a++){const r=n[a];if(r instanceof HTMLElement&&_o(r,t))return r}},Lu=(e,t,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?e.style.setProperty(t,typeof n=="number"?`${n}px`:n):e.style.removeProperty(t)},Fa=(e,t="flex")=>{e&&(e.style.display=t)},hr=e=>{e&&(e.style.display="none")},Aw=(e,t="block")=>{e&&new MutationObserver(()=>{Dp(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},t4=(e,t,n,a)=>{const r=e.querySelector(t);r&&r.style.setProperty(n,a)},Dp=(e,t,n="flex")=>{t?Fa(e,n):hr(e)},Fr=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),gR=()=>!Fr(qs())&&!Fr(tc())&&!Fr(oh()),Ny=e=>e.scrollHeight>e.clientHeight,vR=(e,t)=>{let n=e;for(;n&&n!==t;){if(Ny(n))return!0;n=n.parentElement}return!1},dC=e=>{const t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("animation-duration")||"0"),a=parseFloat(t.getPropertyValue("transition-duration")||"0");return n>0||a>0},Ew=(e,t=!1)=>{const n=wv();n&&Fr(n)&&(t&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${e/1e3}s linear`,n.style.width="0%"},10))},xR=()=>{const e=wv();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const n=parseInt(window.getComputedStyle(e).width),a=t/n*100;e.style.width=`${a}%`},bR=()=>typeof window>"u"||typeof document>"u",yR=`
 <div aria-labelledby="${Ie.title}" aria-describedby="${Ie["html-container"]}" class="${Ie.popup}" tabindex="-1">
   <button type="button" class="${Ie.close}"></button>
   <ul class="${Ie["progress-steps"]}"></ul>
   <div class="${Ie.icon}"></div>
   <img class="${Ie.image}" />
   <h2 class="${Ie.title}" id="${Ie.title}"></h2>
   <div class="${Ie["html-container"]}" id="${Ie["html-container"]}"></div>
   <input class="${Ie.input}" id="${Ie.input}" />
   <input type="file" class="${Ie.file}" />
   <div class="${Ie.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Ie.select}" id="${Ie.select}"></select>
   <div class="${Ie.radio}"></div>
   <label class="${Ie.checkbox}">
     <input type="checkbox" id="${Ie.checkbox}" />
     <span class="${Ie.label}"></span>
   </label>
   <textarea class="${Ie.textarea}" id="${Ie.textarea}"></textarea>
   <div class="${Ie["validation-message"]}" id="${Ie["validation-message"]}"></div>
   <div class="${Ie.actions}">
     <div class="${Ie.loader}"></div>
     <button type="button" class="${Ie.confirm}"></button>
     <button type="button" class="${Ie.deny}"></button>
     <button type="button" class="${Ie.cancel}"></button>
   </div>
   <div class="${Ie.footer}"></div>
   <div class="${Ie["timer-progress-bar-container"]}">
     <div class="${Ie["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),wR=()=>{const e=Nr();return e?(e.remove(),Gi([document.documentElement,document.body],[Ie["no-backdrop"],Ie["toast-shown"],Ie["has-column"]]),!0):!1},hu=()=>{wt.currentInstance.resetValidationMessage()},NR=()=>{const e=Jt(),t=yl(e,Ie.input),n=yl(e,Ie.file),a=e.querySelector(`.${Ie.range} input`),r=e.querySelector(`.${Ie.range} output`),i=yl(e,Ie.select),s=e.querySelector(`.${Ie.checkbox} input`),o=yl(e,Ie.textarea);t.oninput=hu,n.onchange=hu,i.onchange=hu,s.onchange=hu,o.oninput=hu,a.oninput=()=>{hu(),r.value=a.value},a.onchange=()=>{hu(),r.value=a.value}},kR=e=>typeof e=="string"?document.querySelector(e):e,SR=e=>{const t=Jt();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},_R=e=>{window.getComputedStyle(e).direction==="rtl"&&nn(Nr(),Ie.rtl)},jR=e=>{const t=wR();if(bR()){ec("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=Ie.container,t&&nn(n,Ie["no-transition"]),yi(n,yR),n.dataset.swal2Theme=e.theme;const a=kR(e.target);a.appendChild(n),e.topLayer&&(n.setAttribute("popover",""),n.showPopover()),SR(e),_R(a),NR()},Dw=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?CR(e,t):e&&yi(t,e)},CR=(e,t)=>{e.jquery?AR(t,e):yi(t,e.toString())},AR=(e,t)=>{if(e.textContent="",0 in t)for(let n=0;n in t;n++)e.appendChild(t[n].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},ER=(e,t)=>{const n=Ep(),a=lh();!n||!a||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?hr(n):Fa(n),xi(n,t,"actions"),DR(n,a,t),yi(a,t.loaderHtml||""),xi(a,t,"loader"))};function DR(e,t,n){const a=qs(),r=tc(),i=oh();!a||!r||!i||(Mb(a,"confirm",n),Mb(r,"deny",n),Mb(i,"cancel",n),TR(a,r,i,n),n.reverseButtons&&(n.toast?(e.insertBefore(i,a),e.insertBefore(r,a)):(e.insertBefore(i,t),e.insertBefore(r,t),e.insertBefore(a,t))))}function TR(e,t,n,a){if(!a.buttonsStyling){Gi([e,t,n],Ie.styled);return}nn([e,t,n],Ie.styled),a.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",a.confirmButtonColor),a.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",a.denyButtonColor),a.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",a.cancelButtonColor),Rb(e),Rb(t),Rb(n)}function Rb(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const n=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Mb(e,t,n){const a=yw(t);Dp(e,n[`show${a}Button`],"inline-block"),yi(e,n[`${t}ButtonText`]||""),e.setAttribute("aria-label",n[`${t}ButtonAriaLabel`]||""),e.className=Ie[t],xi(e,n,`${t}Button`)}const LR=(e,t)=>{const n=_w();n&&(yi(n,t.closeButtonHtml||""),xi(n,t,"closeButton"),Dp(n,t.showCloseButton),n.setAttribute("aria-label",t.closeButtonAriaLabel||""))},PR=(e,t)=>{const n=Nr();n&&(RR(n,t.backdrop),MR(n,t.position),OR(n,t.grow),xi(n,t,"container"))};function RR(e,t){typeof t=="string"?e.style.background=t:t||nn([document.documentElement,document.body],Ie["no-backdrop"])}function MR(e,t){t&&(t in Ie?nn(e,Ie[t]):(yr('The "position" parameter is not valid, defaulting to "center"'),nn(e,Ie.center)))}function OR(e,t){t&&nn(e,Ie[`grow-${t}`])}var _n={innerParams:new WeakMap,domCache:new WeakMap};const IR=["input","file","range","select","radio","checkbox","textarea"],FR=(e,t)=>{const n=Jt();if(!n)return;const a=_n.innerParams.get(e),r=!a||t.input!==a.input;IR.forEach(i=>{const s=yl(n,Ie[i]);s&&(UR(i,t.inputAttributes),s.className=Ie[i],r&&hr(s))}),t.input&&(r&&BR(t),qR(t))},BR=e=>{if(!e.input)return;if(!ta[e.input]){ec(`Unexpected type of input! Expected ${Object.keys(ta).join(" | ")}, got "${e.input}"`);return}const t=hC(e.input);if(!t)return;const n=ta[e.input](t,e);Fa(t),e.inputAutoFocus&&setTimeout(()=>{uC(n)})},zR=e=>{for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;["id","type","value","style"].includes(n)||e.removeAttribute(n)}},UR=(e,t)=>{const n=Jt();if(!n)return;const a=kv(n,e);if(a){zR(a);for(const r in t)a.setAttribute(r,t[r])}},qR=e=>{if(!e.input)return;const t=hC(e.input);t&&xi(t,e,"input")},Tw=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},Tp=(e,t,n)=>{if(n.inputLabel){const a=document.createElement("label"),r=Ie["input-label"];a.setAttribute("for",e.id),a.className=r,typeof n.customClass=="object"&&nn(a,n.customClass.inputLabel),a.innerText=n.inputLabel,t.insertAdjacentElement("beforebegin",a)}},hC=e=>{const t=Jt();if(t)return yl(t,Ie[e]||Ie.input)},y0=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:Nw(t)||yr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},ta={};ta.text=ta.email=ta.password=ta.number=ta.tel=ta.url=ta.search=ta.date=ta["datetime-local"]=ta.time=ta.week=ta.month=(e,t)=>(y0(e,t.inputValue),Tp(e,e,t),Tw(e,t),e.type=t.input,e);ta.file=(e,t)=>(Tp(e,e,t),Tw(e,t),e);ta.range=(e,t)=>{const n=e.querySelector("input"),a=e.querySelector("output");return y0(n,t.inputValue),n.type=t.input,y0(a,t.inputValue),Tp(n,e,t),e};ta.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const n=document.createElement("option");yi(n,t.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,e.appendChild(n)}return Tp(e,e,t),e};ta.radio=e=>(e.textContent="",e);ta.checkbox=(e,t)=>{const n=kv(Jt(),"checkbox");n.value="1",n.checked=!!t.inputValue;const a=e.querySelector("span");return yi(a,t.inputPlaceholder||t.inputLabel),n};ta.textarea=(e,t)=>{y0(e,t.inputValue),Tw(e,t),Tp(e,e,t);const n=a=>parseInt(window.getComputedStyle(a).marginLeft)+parseInt(window.getComputedStyle(a).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const a=parseInt(window.getComputedStyle(Jt()).width),r=()=>{if(!document.body.contains(e))return;const i=e.offsetWidth+n(e);i>a?Jt().style.width=`${i}px`:Lu(Jt(),"width",t.width)};new MutationObserver(r).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const WR=(e,t)=>{const n=kw();n&&(Aw(n),xi(n,t,"htmlContainer"),t.html?(Dw(t.html,n),Fa(n,"block")):t.text?(n.textContent=t.text,Fa(n,"block")):hr(n),FR(e,t))},HR=(e,t)=>{const n=lC();n&&(Aw(n),Dp(n,t.footer,"block"),t.footer&&Dw(t.footer,n),xi(n,t,"footer"))},VR=(e,t)=>{const n=_n.innerParams.get(e),a=sh();if(!a)return;if(n&&t.icon===n.icon){a4(a,t),n4(a,t);return}if(!t.icon&&!t.iconHtml){hr(a);return}if(t.icon&&Object.keys(b0).indexOf(t.icon)===-1){ec(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),hr(a);return}Fa(a),a4(a,t),n4(a,t),nn(a,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",fC)},n4=(e,t)=>{for(const[n,a]of Object.entries(b0))t.icon!==n&&Gi(e,a);nn(e,t.icon&&b0[t.icon]),KR(e,t),fC(),xi(e,t,"icon")},fC=()=>{const e=Jt();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),n=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let a=0;a<n.length;a++)n[a].style.backgroundColor=t},GR=e=>`
  ${e.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${e.animation?'<div class="swal2-success-fix"></div>':""}
  ${e.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,$R=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,a4=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let n=e.innerHTML,a="";t.iconHtml?a=r4(t.iconHtml):t.icon==="success"?(a=GR(t),n=n.replace(/ style=".*?"/g,"")):t.icon==="error"?a=$R:t.icon&&(a=r4({question:"?",warning:"!",info:"i"}[t.icon])),n.trim()!==a.trim()&&yi(e,a)},KR=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])t4(e,n,"background-color",t.iconColor);t4(e,".swal2-success-ring","border-color",t.iconColor)}},r4=e=>`<div class="${Ie["icon-content"]}">${e}</div>`,YR=(e,t)=>{const n=oC();if(n){if(!t.imageUrl){hr(n);return}Fa(n,""),n.setAttribute("src",t.imageUrl),n.setAttribute("alt",t.imageAlt||""),Lu(n,"width",t.imageWidth),Lu(n,"height",t.imageHeight),n.className=Ie.image,xi(n,t,"image")}};let Lw=!1,pC=0,mC=0,gC=0,vC=0;const XR=e=>{e.addEventListener("mousedown",w0),document.body.addEventListener("mousemove",N0),e.addEventListener("mouseup",k0),e.addEventListener("touchstart",w0),document.body.addEventListener("touchmove",N0),e.addEventListener("touchend",k0)},JR=e=>{e.removeEventListener("mousedown",w0),document.body.removeEventListener("mousemove",N0),e.removeEventListener("mouseup",k0),e.removeEventListener("touchstart",w0),document.body.removeEventListener("touchmove",N0),e.removeEventListener("touchend",k0)},w0=e=>{const t=Jt();if(e.target===t||sh().contains(e.target)){Lw=!0;const n=xC(e);pC=n.clientX,mC=n.clientY,gC=parseInt(t.style.insetInlineStart)||0,vC=parseInt(t.style.insetBlockStart)||0,nn(t,"swal2-dragging")}},N0=e=>{const t=Jt();if(Lw){let{clientX:n,clientY:a}=xC(e);t.style.insetInlineStart=`${gC+(n-pC)}px`,t.style.insetBlockStart=`${vC+(a-mC)}px`}},k0=()=>{const e=Jt();Lw=!1,Gi(e,"swal2-dragging")},xC=e=>{let t=0,n=0;return e.type.startsWith("mouse")?(t=e.clientX,n=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,n=e.touches[0].clientY),{clientX:t,clientY:n}},QR=(e,t)=>{const n=Nr(),a=Jt();if(!(!n||!a)){if(t.toast){Lu(n,"width",t.width),a.style.width="100%";const r=lh();r&&a.insertBefore(r,sh())}else Lu(a,"width",t.width);Lu(a,"padding",t.padding),t.color&&(a.style.color=t.color),t.background&&(a.style.background=t.background),hr(yv()),ZR(a,t),t.draggable&&!t.toast?(nn(a,Ie.draggable),XR(a)):(Gi(a,Ie.draggable),JR(a))}},ZR=(e,t)=>{const n=t.showClass||{};e.className=`${Ie.popup} ${Fr(e)?n.popup:""}`,t.toast?(nn([document.documentElement,document.body],Ie["toast-shown"]),nn(e,Ie.toast)):nn(e,Ie.modal),xi(e,t,"popup"),typeof t.customClass=="string"&&nn(e,t.customClass),t.icon&&nn(e,Ie[`icon-${t.icon}`])},eM=(e,t)=>{const n=Sw();if(!n)return;const{progressSteps:a,currentProgressStep:r}=t;if(!a||a.length===0||r===void 0){hr(n);return}Fa(n),n.textContent="",r>=a.length&&yr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),a.forEach((i,s)=>{const o=tM(i);if(n.appendChild(o),s===r&&nn(o,Ie["active-progress-step"]),s!==a.length-1){const u=nM(t);n.appendChild(u)}})},tM=e=>{const t=document.createElement("li");return nn(t,Ie["progress-step"]),yi(t,e),t},nM=e=>{const t=document.createElement("li");return nn(t,Ie["progress-step-line"]),e.progressStepsDistance&&Lu(t,"width",e.progressStepsDistance),t},aM=(e,t)=>{const n=sC();n&&(Aw(n),Dp(n,t.title||t.titleText,"block"),t.title&&Dw(t.title,n),t.titleText&&(n.innerText=t.titleText),xi(n,t,"title"))},bC=(e,t)=>{QR(e,t),PR(e,t),eM(e,t),VR(e,t),YR(e,t),aM(e,t),LR(e,t),WR(e,t),ER(e,t),HR(e,t);const n=Jt();typeof t.didRender=="function"&&n&&t.didRender(n),wt.eventEmitter.emit("didRender",n)},rM=()=>Fr(Jt()),yC=()=>{var e;return(e=qs())===null||e===void 0?void 0:e.click()},iM=()=>{var e;return(e=tc())===null||e===void 0?void 0:e.click()},sM=()=>{var e;return(e=oh())===null||e===void 0?void 0:e.click()},uh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),wC=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},oM=(e,t,n)=>{wC(e),t.toast||(e.keydownHandler=a=>uM(t,a,n),e.keydownTarget=t.keydownListenerCapture?window:Jt(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},ky=(e,t)=>{var n;const a=jw();if(a.length){e=e+t,e===-2&&(e=a.length-1),e===a.length?e=0:e===-1&&(e=a.length-1),a[e].focus();return}(n=Jt())===null||n===void 0||n.focus()},NC=["ArrowRight","ArrowDown"],lM=["ArrowLeft","ArrowUp"],uM=(e,t,n)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?cM(t,e):t.key==="Tab"?dM(t):[...NC,...lM].includes(t.key)?hM(t.key):t.key==="Escape"&&fM(t,e,n)))},cM=(e,t)=>{if(!bv(t.allowEnterKey))return;const n=kv(Jt(),t.input);if(e.target&&n&&e.target instanceof HTMLElement&&e.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(t.input))return;yC(),e.preventDefault()}},dM=e=>{const t=e.target,n=jw();let a=-1;for(let r=0;r<n.length;r++)if(t===n[r]){a=r;break}e.shiftKey?ky(a,-1):ky(a,1),e.stopPropagation(),e.preventDefault()},hM=e=>{const t=Ep(),n=qs(),a=tc(),r=oh();if(!t||!n||!a||!r)return;const i=[n,a,r];if(document.activeElement instanceof HTMLElement&&!i.includes(document.activeElement))return;const s=NC.includes(e)?"nextElementSibling":"previousElementSibling";let o=document.activeElement;if(o){for(let u=0;u<t.children.length;u++){if(o=o[s],!o)return;if(o instanceof HTMLButtonElement&&Fr(o))break}o instanceof HTMLButtonElement&&o.focus()}},fM=(e,t,n)=>{e.preventDefault(),bv(t.allowEscapeKey)&&n(uh.esc)};var Vd={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const pM=()=>{const e=Nr();Array.from(document.body.children).forEach(n=>{n.contains(e)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},kC=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},SC=typeof window<"u"&&!!window.GestureEvent,mM=()=>{if(SC&&!_o(document.body,Ie.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,nn(document.body,Ie.iosfix),gM()}},gM=()=>{const e=Nr();if(!e)return;let t;e.ontouchstart=n=>{t=vM(n)},e.ontouchmove=n=>{t&&(n.preventDefault(),n.stopPropagation())}},vM=e=>{const t=e.target,n=Nr(),a=kw();return!n||!a||xM(e)||bM(e)?!1:t===n||!Ny(n)&&t instanceof HTMLElement&&!vR(t,a)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(Ny(a)&&a.contains(t))},xM=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",bM=e=>e.touches&&e.touches.length>1,yM=()=>{if(_o(document.body,Ie.iosfix)){const e=parseInt(document.body.style.top,10);Gi(document.body,Ie.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},wM=()=>{const e=document.createElement("div");e.className=Ie["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let Nd=null;const NM=e=>{Nd===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(Nd=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Nd+wM()}px`)},kM=()=>{Nd!==null&&(document.body.style.paddingRight=`${Nd}px`,Nd=null)};function _C(e,t,n,a){Nv()?i4(e,a):(oR(n).then(()=>i4(e,a)),wC(wt)),SC?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),Cw()&&(kM(),yM(),kC()),SM()}function SM(){Gi([document.documentElement,document.body],[Ie.shown,Ie["height-auto"],Ie["no-backdrop"],Ie["toast-shown"]])}function wl(e){e=jM(e);const t=Vd.swalPromiseResolve.get(this),n=_M(this);this.isAwaitingPromise?e.isDismissed||(Lp(this),t(e)):n&&t(e)}const _M=e=>{const t=Jt();if(!t)return!1;const n=_n.innerParams.get(e);if(!n||_o(t,n.hideClass.popup))return!1;Gi(t,n.showClass.popup),nn(t,n.hideClass.popup);const a=Nr();return Gi(a,n.showClass.backdrop),nn(a,n.hideClass.backdrop),CM(e,t,n),!0};function jC(e){const t=Vd.swalPromiseReject.get(this);Lp(this),t&&t(e)}const Lp=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,_n.innerParams.get(e)||e._destroy())},jM=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),CM=(e,t,n)=>{var a;const r=Nr(),i=dC(t);typeof n.willClose=="function"&&n.willClose(t),(a=wt.eventEmitter)===null||a===void 0||a.emit("willClose",t),i?AM(e,t,r,n.returnFocus,n.didClose):_C(e,r,n.returnFocus,n.didClose)},AM=(e,t,n,a,r)=>{wt.swalCloseEventFinishedCallback=_C.bind(null,e,n,a,r);const i=function(s){if(s.target===t){var o;(o=wt.swalCloseEventFinishedCallback)===null||o===void 0||o.call(wt),delete wt.swalCloseEventFinishedCallback,t.removeEventListener("animationend",i),t.removeEventListener("transitionend",i)}};t.addEventListener("animationend",i),t.addEventListener("transitionend",i)},i4=(e,t)=>{setTimeout(()=>{var n;typeof t=="function"&&t.bind(e.params)(),(n=wt.eventEmitter)===null||n===void 0||n.emit("didClose"),e._destroy&&e._destroy()})},Gd=e=>{let t=Jt();if(t||new ct,t=Jt(),!t)return;const n=lh();Nv()?hr(sh()):EM(t,e),Fa(n),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},EM=(e,t)=>{const n=Ep(),a=lh();!n||!a||(!t&&Fr(qs())&&(t=qs()),Fa(n),t&&(hr(t),a.setAttribute("data-button-to-replace",t.className),n.insertBefore(a,t)),nn([e,n],Ie.loading))},DM=(e,t)=>{t.input==="select"||t.input==="radio"?MM(e,t):["text","email","number","tel","textarea"].some(n=>n===t.input)&&(ww(t.inputValue)||Nw(t.inputValue))&&(Gd(qs()),OM(e,t))},TM=(e,t)=>{const n=e.getInput();if(!n)return null;switch(t.input){case"checkbox":return LM(n);case"radio":return PM(n);case"file":return RM(n);default:return t.inputAutoTrim?n.value.trim():n.value}},LM=e=>e.checked?1:0,PM=e=>e.checked?e.value:null,RM=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,MM=(e,t)=>{const n=Jt();if(!n)return;const a=r=>{t.input==="select"?IM(n,S0(r),t):t.input==="radio"&&FM(n,S0(r),t)};ww(t.inputOptions)||Nw(t.inputOptions)?(Gd(qs()),Cp(t.inputOptions).then(r=>{e.hideLoading(),a(r)})):typeof t.inputOptions=="object"?a(t.inputOptions):ec(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},OM=(e,t)=>{const n=e.getInput();n&&(hr(n),Cp(t.inputValue).then(a=>{n.value=t.input==="number"?`${parseFloat(a)||0}`:`${a}`,Fa(n),n.focus(),e.hideLoading()}).catch(a=>{ec(`Error in inputValue promise: ${a}`),n.value="",Fa(n),n.focus(),e.hideLoading()}))};function IM(e,t,n){const a=yl(e,Ie.select);if(!a)return;const r=(i,s,o)=>{const u=document.createElement("option");u.value=o,yi(u,s),u.selected=CC(o,n.inputValue),i.appendChild(u)};t.forEach(i=>{const s=i[0],o=i[1];if(Array.isArray(o)){const u=document.createElement("optgroup");u.label=s,u.disabled=!1,a.appendChild(u),o.forEach(c=>r(u,c[1],c[0]))}else r(a,o,s)}),a.focus()}function FM(e,t,n){const a=yl(e,Ie.radio);if(!a)return;t.forEach(i=>{const s=i[0],o=i[1],u=document.createElement("input"),c=document.createElement("label");u.type="radio",u.name=Ie.radio,u.value=s,CC(s,n.inputValue)&&(u.checked=!0);const d=document.createElement("span");yi(d,o),d.className=Ie.label,c.appendChild(u),c.appendChild(d),a.appendChild(c)});const r=a.querySelectorAll("input");r.length&&r[0].focus()}const S0=e=>{const t=[];return e instanceof Map?e.forEach((n,a)=>{let r=n;typeof r=="object"&&(r=S0(r)),t.push([a,r])}):Object.keys(e).forEach(n=>{let a=e[n];typeof a=="object"&&(a=S0(a)),t.push([n,a])}),t},CC=(e,t)=>!!t&&t.toString()===e.toString(),BM=e=>{const t=_n.innerParams.get(e);e.disableButtons(),t.input?AC(e,"confirm"):Rw(e,!0)},zM=e=>{const t=_n.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?AC(e,"deny"):Pw(e,!1)},UM=(e,t)=>{e.disableButtons(),t(uh.cancel)},AC=(e,t)=>{const n=_n.innerParams.get(e);if(!n.input){ec(`The "input" parameter is needed to be set when using returnInputValueOn${yw(t)}`);return}const a=e.getInput(),r=TM(e,n);n.inputValidator?qM(e,r,t):a&&!a.checkValidity()?(e.enableButtons(),e.showValidationMessage(n.validationMessage||a.validationMessage)):t==="deny"?Pw(e,r):Rw(e,r)},qM=(e,t,n)=>{const a=_n.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>Cp(a.inputValidator(t,a.validationMessage))).then(i=>{e.enableButtons(),e.enableInput(),i?e.showValidationMessage(i):n==="deny"?Pw(e,t):Rw(e,t)})},Pw=(e,t)=>{const n=_n.innerParams.get(e||void 0);n.showLoaderOnDeny&&Gd(tc()),n.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>Cp(n.preDeny(t,n.validationMessage))).then(r=>{r===!1?(e.hideLoading(),Lp(e)):e.close({isDenied:!0,value:typeof r>"u"?t:r})}).catch(r=>EC(e||void 0,r))):e.close({isDenied:!0,value:t})},s4=(e,t)=>{e.close({isConfirmed:!0,value:t})},EC=(e,t)=>{e.rejectPromise(t)},Rw=(e,t)=>{const n=_n.innerParams.get(e||void 0);n.showLoaderOnConfirm&&Gd(),n.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>Cp(n.preConfirm(t,n.validationMessage))).then(r=>{Fr(yv())||r===!1?(e.hideLoading(),Lp(e)):s4(e,typeof r>"u"?t:r)}).catch(r=>EC(e||void 0,r))):s4(e,t)};function _0(){const e=_n.innerParams.get(this);if(!e)return;const t=_n.domCache.get(this);hr(t.loader),Nv()?e.icon&&Fa(sh()):WM(t),Gi([t.popup,t.actions],Ie.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const WM=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?Fa(t[0],"inline-block"):gR()&&hr(e.actions)};function DC(){const e=_n.innerParams.get(this),t=_n.domCache.get(this);return t?kv(t.popup,e.input):null}function TC(e,t,n){const a=_n.domCache.get(e);t.forEach(r=>{a[r].disabled=n})}function LC(e,t){const n=Jt();if(!(!n||!e))if(e.type==="radio"){const a=n.querySelectorAll(`[name="${Ie.radio}"]`);for(let r=0;r<a.length;r++)a[r].disabled=t}else e.disabled=t}function PC(){TC(this,["confirmButton","denyButton","cancelButton"],!1)}function RC(){TC(this,["confirmButton","denyButton","cancelButton"],!0)}function MC(){LC(this.getInput(),!1)}function OC(){LC(this.getInput(),!0)}function IC(e){const t=_n.domCache.get(this),n=_n.innerParams.get(this);yi(t.validationMessage,e),t.validationMessage.className=Ie["validation-message"],n.customClass&&n.customClass.validationMessage&&nn(t.validationMessage,n.customClass.validationMessage),Fa(t.validationMessage);const a=this.getInput();a&&(a.setAttribute("aria-invalid","true"),a.setAttribute("aria-describedby",Ie["validation-message"]),uC(a),nn(a,Ie.inputerror))}function FC(){const e=_n.domCache.get(this);e.validationMessage&&hr(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),Gi(t,Ie.inputerror))}const kd={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},HM=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],VM={allowEnterKey:void 0},GM=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],BC=e=>Object.prototype.hasOwnProperty.call(kd,e),zC=e=>HM.indexOf(e)!==-1,UC=e=>VM[e],$M=e=>{BC(e)||yr(`Unknown parameter "${e}"`)},KM=e=>{GM.includes(e)&&yr(`The parameter "${e}" is incompatible with toasts`)},YM=e=>{const t=UC(e);t&&iC(e,t)},qC=e=>{e.backdrop===!1&&e.allowOutsideClick&&yr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&yr(`Invalid theme "${e.theme}"`);for(const t in e)$M(t),e.toast&&KM(t),YM(t)};function WC(e){const t=Nr(),n=Jt(),a=_n.innerParams.get(this);if(!n||_o(n,a.hideClass.popup)){yr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const r=XM(e),i=Object.assign({},a,r);qC(i),t.dataset.swal2Theme=i.theme,bC(this,i),_n.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const XM=e=>{const t={};return Object.keys(e).forEach(n=>{zC(n)?t[n]=e[n]:yr(`Invalid parameter to update: ${n}`)}),t};function HC(){const e=_n.domCache.get(this),t=_n.innerParams.get(this);if(!t){VC(this);return}e.popup&&wt.swalCloseEventFinishedCallback&&(wt.swalCloseEventFinishedCallback(),delete wt.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),wt.eventEmitter.emit("didDestroy"),JM(this)}const JM=e=>{VC(e),delete e.params,delete wt.keydownHandler,delete wt.keydownTarget,delete wt.currentInstance},VC=e=>{e.isAwaitingPromise?(Ob(_n,e),e.isAwaitingPromise=!0):(Ob(Vd,e),Ob(_n,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},Ob=(e,t)=>{for(const n in e)e[n].delete(t)};var QM=Object.freeze({__proto__:null,_destroy:HC,close:wl,closeModal:wl,closePopup:wl,closeToast:wl,disableButtons:RC,disableInput:OC,disableLoading:_0,enableButtons:PC,enableInput:MC,getInput:DC,handleAwaitingPromise:Lp,hideLoading:_0,rejectPromise:jC,resetValidationMessage:FC,showValidationMessage:IC,update:WC});const ZM=(e,t,n)=>{e.toast?e8(e,t,n):(n8(t),a8(t),r8(e,t,n))},e8=(e,t,n)=>{t.popup.onclick=()=>{e&&(t8(e)||e.timer||e.input)||n(uh.close)}},t8=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let j0=!1;const n8=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(j0=!0)}}},a8=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(n){e.popup.onmouseup=()=>{},(n.target===e.popup||n.target instanceof HTMLElement&&e.popup.contains(n.target))&&(j0=!0)}}},r8=(e,t,n)=>{t.container.onclick=a=>{if(j0){j0=!1;return}a.target===t.container&&bv(e.allowOutsideClick)&&n(uh.backdrop)}},i8=e=>typeof e=="object"&&e.jquery,o4=e=>e instanceof Element||i8(e),s8=e=>{const t={};return typeof e[0]=="object"&&!o4(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((n,a)=>{const r=e[a];typeof r=="string"||o4(r)?t[n]=r:r!==void 0&&ec(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof r}`)}),t};function o8(...e){return new this(...e)}function l8(e){class t extends this{_main(a,r){return super._main(a,Object.assign({},e,r))}}return t}const u8=()=>wt.timeout&&wt.timeout.getTimerLeft(),GC=()=>{if(wt.timeout)return xR(),wt.timeout.stop()},$C=()=>{if(wt.timeout){const e=wt.timeout.start();return Ew(e),e}},c8=()=>{const e=wt.timeout;return e&&(e.running?GC():$C())},d8=e=>{if(wt.timeout){const t=wt.timeout.increase(e);return Ew(t,!0),t}},h8=()=>!!(wt.timeout&&wt.timeout.isRunning());let l4=!1;const Sy={};function f8(e="data-swal-template"){Sy[e]=this,l4||(document.body.addEventListener("click",p8),l4=!0)}const p8=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const n in Sy){const a=t.getAttribute(n);if(a){Sy[n].fire({template:a});return}}};class m8{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,n){const a=this._getHandlersByEventName(t);a.includes(n)||a.push(n)}once(t,n){const a=(...r)=>{this.removeListener(t,a),n.apply(this,r)};this.on(t,a)}emit(t,...n){this._getHandlersByEventName(t).forEach(a=>{try{a.apply(this,n)}catch(r){console.error(r)}})}removeListener(t,n){const a=this._getHandlersByEventName(t),r=a.indexOf(n);r>-1&&a.splice(r,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}wt.eventEmitter=new m8;const g8=(e,t)=>{wt.eventEmitter.on(e,t)},v8=(e,t)=>{wt.eventEmitter.once(e,t)},x8=(e,t)=>{if(!e){wt.eventEmitter.reset();return}t?wt.eventEmitter.removeListener(e,t):wt.eventEmitter.removeAllListeners(e)};var b8=Object.freeze({__proto__:null,argsToParams:s8,bindClickHandler:f8,clickCancel:sM,clickConfirm:yC,clickDeny:iM,enableLoading:Gd,fire:o8,getActions:Ep,getCancelButton:oh,getCloseButton:_w,getConfirmButton:qs,getContainer:Nr,getDenyButton:tc,getFocusableElements:jw,getFooter:lC,getHtmlContainer:kw,getIcon:sh,getIconContent:dR,getImage:oC,getInputLabel:hR,getLoader:lh,getPopup:Jt,getProgressSteps:Sw,getTimerLeft:u8,getTimerProgressBar:wv,getTitle:sC,getValidationMessage:yv,increaseTimer:d8,isDeprecatedParameter:UC,isLoading:pR,isTimerRunning:h8,isUpdatableParameter:zC,isValidParameter:BC,isVisible:rM,mixin:l8,off:x8,on:g8,once:v8,resumeTimer:$C,showLoading:Gd,stopTimer:GC,toggleTimer:c8});class y8{constructor(t,n){this.callback=t,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const n=this.running;return n&&this.stop(),this.remaining+=t,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const KC=["swal-title","swal-html","swal-footer"],w8=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const n=t.content;return E8(n),Object.assign(N8(n),k8(n),S8(n),_8(n),j8(n),C8(n),A8(n,KC))},N8=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(a=>{$u(a,["name","value"]);const r=a.getAttribute("name"),i=a.getAttribute("value");!r||!i||(typeof kd[r]=="boolean"?t[r]=i!=="false":typeof kd[r]=="object"?t[r]=JSON.parse(i):t[r]=i)}),t},k8=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(a=>{const r=a.getAttribute("name"),i=a.getAttribute("value");!r||!i||(t[r]=new Function(`return ${i}`)())}),t},S8=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(a=>{$u(a,["type","color","aria-label"]);const r=a.getAttribute("type");!r||!["confirm","cancel","deny"].includes(r)||(t[`${r}ButtonText`]=a.innerHTML,t[`show${yw(r)}Button`]=!0,a.hasAttribute("color")&&(t[`${r}ButtonColor`]=a.getAttribute("color")),a.hasAttribute("aria-label")&&(t[`${r}ButtonAriaLabel`]=a.getAttribute("aria-label")))}),t},_8=e=>{const t={},n=e.querySelector("swal-image");return n&&($u(n,["src","width","height","alt"]),n.hasAttribute("src")&&(t.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(t.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(t.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(t.imageAlt=n.getAttribute("alt")||void 0)),t},j8=e=>{const t={},n=e.querySelector("swal-icon");return n&&($u(n,["type","color"]),n.hasAttribute("type")&&(t.icon=n.getAttribute("type")),n.hasAttribute("color")&&(t.iconColor=n.getAttribute("color")),t.iconHtml=n.innerHTML),t},C8=e=>{const t={},n=e.querySelector("swal-input");n&&($u(n,["type","label","placeholder","value"]),t.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(t.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(t.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(t.inputValue=n.getAttribute("value")));const a=Array.from(e.querySelectorAll("swal-input-option"));return a.length&&(t.inputOptions={},a.forEach(r=>{$u(r,["value"]);const i=r.getAttribute("value");if(!i)return;const s=r.innerHTML;t.inputOptions[i]=s})),t},A8=(e,t)=>{const n={};for(const a in t){const r=t[a],i=e.querySelector(r);i&&($u(i,[]),n[r.replace(/^swal-/,"")]=i.innerHTML.trim())}return n},E8=e=>{const t=KC.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(n=>{const a=n.tagName.toLowerCase();t.includes(a)||yr(`Unrecognized element <${a}>`)})},$u=(e,t)=>{Array.from(e.attributes).forEach(n=>{t.indexOf(n.name)===-1&&yr([`Unrecognized attribute "${n.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},YC=10,D8=e=>{const t=Nr(),n=Jt();typeof e.willOpen=="function"&&e.willOpen(n),wt.eventEmitter.emit("willOpen",n);const r=window.getComputedStyle(document.body).overflowY;P8(t,n,e),setTimeout(()=>{T8(t,n)},YC),Cw()&&(L8(t,e.scrollbarPadding,r),pM()),!Nv()&&!wt.previousActiveElement&&(wt.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(n)),wt.eventEmitter.emit("didOpen",n),Gi(t,Ie["no-transition"])},C0=e=>{const t=Jt();if(e.target!==t)return;const n=Nr();t.removeEventListener("animationend",C0),t.removeEventListener("transitionend",C0),n.style.overflowY="auto"},T8=(e,t)=>{dC(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",C0),t.addEventListener("transitionend",C0)):e.style.overflowY="auto"},L8=(e,t,n)=>{mM(),t&&n!=="hidden"&&NM(n),setTimeout(()=>{e.scrollTop=0})},P8=(e,t,n)=>{nn(e,n.showClass.backdrop),n.animation?(t.style.setProperty("opacity","0","important"),Fa(t,"grid"),setTimeout(()=>{nn(t,n.showClass.popup),t.style.removeProperty("opacity")},YC)):Fa(t,"grid"),nn([document.documentElement,document.body],Ie.shown),n.heightAuto&&n.backdrop&&!n.toast&&nn([document.documentElement,document.body],Ie["height-auto"])};var u4={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function R8(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=u4.email),e.input==="url"&&(e.inputValidator=u4.url))}function M8(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(yr('Target parameter is not valid, defaulting to "body"'),e.target="body")}function O8(e){R8(e),e.showLoaderOnConfirm&&!e.preConfirm&&yr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),M8(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),jR(e)}let _s;var Jm=new WeakMap;class oa{constructor(...t){if(aR(this,Jm,void 0),typeof window>"u")return;_s=this;const n=Object.freeze(this.constructor.argsToParams(t));this.params=n,this.isAwaitingPromise=!1,rR(Jm,this,this._main(_s.params))}_main(t,n={}){if(qC(Object.assign({},n,t)),wt.currentInstance){const i=Vd.swalPromiseResolve.get(wt.currentInstance),{isAwaitingPromise:s}=wt.currentInstance;wt.currentInstance._destroy(),s||i({isDismissed:!0}),Cw()&&kC()}wt.currentInstance=_s;const a=F8(t,n);O8(a),Object.freeze(a),wt.timeout&&(wt.timeout.stop(),delete wt.timeout),clearTimeout(wt.restoreFocusTimeout);const r=B8(_s);return bC(_s,a),_n.innerParams.set(_s,a),I8(_s,r,a)}then(t){return Z3(Jm,this).then(t)}finally(t){return Z3(Jm,this).finally(t)}}const I8=(e,t,n)=>new Promise((a,r)=>{const i=s=>{e.close({isDismissed:!0,dismiss:s})};Vd.swalPromiseResolve.set(e,a),Vd.swalPromiseReject.set(e,r),t.confirmButton.onclick=()=>{BM(e)},t.denyButton.onclick=()=>{zM(e)},t.cancelButton.onclick=()=>{UM(e,i)},t.closeButton.onclick=()=>{i(uh.close)},ZM(n,t,i),oM(wt,n,i),DM(e,n),D8(n),z8(wt,n,i),U8(t,n),setTimeout(()=>{t.container.scrollTop=0})}),F8=(e,t)=>{const n=w8(e),a=Object.assign({},kd,t,n,e);return a.showClass=Object.assign({},kd.showClass,a.showClass),a.hideClass=Object.assign({},kd.hideClass,a.hideClass),a.animation===!1&&(a.showClass={backdrop:"swal2-noanimation"},a.hideClass={}),a},B8=e=>{const t={popup:Jt(),container:Nr(),actions:Ep(),confirmButton:qs(),denyButton:tc(),cancelButton:oh(),loader:lh(),closeButton:_w(),validationMessage:yv(),progressSteps:Sw()};return _n.domCache.set(e,t),t},z8=(e,t,n)=>{const a=wv();hr(a),t.timer&&(e.timeout=new y8(()=>{n("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(Fa(a),xi(a,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&Ew(t.timer)})))},U8=(e,t)=>{if(!t.toast){if(!bv(t.allowEnterKey)){iC("allowEnterKey"),H8();return}q8(e)||W8(e,t)||ky(-1,1)}},q8=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const n of t)if(n instanceof HTMLElement&&Fr(n))return n.focus(),!0;return!1},W8=(e,t)=>t.focusDeny&&Fr(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&Fr(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&Fr(e.confirmButton)?(e.confirmButton.focus(),!0):!1,H8=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}oa.prototype.disableButtons=RC;oa.prototype.enableButtons=PC;oa.prototype.getInput=DC;oa.prototype.disableInput=OC;oa.prototype.enableInput=MC;oa.prototype.hideLoading=_0;oa.prototype.disableLoading=_0;oa.prototype.showValidationMessage=IC;oa.prototype.resetValidationMessage=FC;oa.prototype.close=wl;oa.prototype.closePopup=wl;oa.prototype.closeModal=wl;oa.prototype.closeToast=wl;oa.prototype.rejectPromise=jC;oa.prototype.update=WC;oa.prototype._destroy=HC;Object.assign(oa,b8);Object.keys(QM).forEach(e=>{oa[e]=function(...t){return _s&&_s[e]?_s[e](...t):null}});oa.DismissReason=uh;oa.version="11.22.2";const ct=oa;ct.default=ct;typeof document<"u"&&function(e,t){var n=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=t);else try{n.innerHTML=t}catch{n.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const V8=()=>l.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:l.jsx("div",{className:"flex items-start space-x-3",children:l.jsx(k1,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"})})}),G8=ae.lazy(()=>Bg(()=>import("./index-BO1yNtnY.js"),__vite__mapDeps([0,1,2,3,4]))),$8=()=>{const e=wr(),t=S2(),[n,a]=ae.useState({email:"",password:""}),[r,i]=ae.useState(!1),[s,o]=ae.useState(null),[u,c]=ae.useState(null),[d,h]=ae.useState(!1),[p,f]=ae.useState(null),[g,b]=ae.useState(!1),w=Fg.createRef();ae.useEffect(()=>{var _,A;(_=t.state)!=null&&_.message&&(c(t.state.message),(A=t.state)!=null&&A.email&&a(L=>({...L,email:t.state.email})),window.history.replaceState({},document.title))},[t.state]);const m=_=>{a({...n,[_.target.name]:_.target.value})},x=()=>!n.email||!n.password?(ct.fire({icon:"warning",title:"Form Tidak Lengkap",text:"Silakan isi email dan password"}),!1):p?!0:(ct.fire({icon:"warning",title:"Verifikasi Diperlukan",html:`
          <div class="text-left">
            <p>Silakan verifikasi bahwa Anda bukan robot dengan mencentang reCAPTCHA</p>
            <p class="mt-2 text-sm text-gray-600">Ini membantu kami mencegah akses tidak sah ke sistem.</p>
          </div>
        `}),!1),y=async _=>{var A;if(_.preventDefault(),!!x()){i(!0),o(null),c(null);try{if(!bl())throw new Error("Sistem belum dikonfigurasi. Silakan hubungi administrator untuk mengatur koneksi database.");const{data:L,error:P}=await Pe.auth.signInWithPassword({email:n.email,password:n.password});if(P)throw P;if(L.user){const{data:j,error:E}=await Pe.from("profiles").select("role, name, is_face_registered, status").eq("id",L.user.id).single();if(E)console.error("Error fetching profile:",E);else if(j.status!=="active")throw await Pe.auth.signOut(),new Error("Akun Anda tidak aktif. Silakan hubungi administrator.");try{await Pe.from("activity_logs").insert([{user_id:L.user.id,action_type:"login",action_details:{email:L.user.email,role:(j==null?void 0:j.role)||"unknown",timestamp:new Date().toISOString()},ip_address:"unknown",user_agent:navigator.userAgent}])}catch(z){console.error("Error logging activity:",z)}try{await Pe.from("profiles").update({last_login:new Date().toISOString(),device_info:{user_agent:navigator.userAgent,timestamp:new Date().toISOString()}}).eq("id",L.user.id)}catch(z){console.error("Error updating last login:",z)}let F=(j==null?void 0:j.name)||L.user.email||"";await ct.fire({icon:"success",title:"Login Berhasil",html:`
            <div class="text-center">
              <div class="animate-bounce mb-4">
                <CheckCircle class="h-12 w-12 text-green-500 mx-auto" />
              </div>
              <h3 class="text-xl font-bold text-gray-800">Selamat datang, <span class="text-blue-600">${F}</span>!</h3>
              <p class="mt-2 text-gray-600">Anda akan diarahkan ke dashboard</p>
            </div>
          `,showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:()=>{ct.showLoading()}}),(j==null?void 0:j.role)==="admin"?e("/admin/dashboard"):e("/dashboard")}}catch(L){let P="Terjadi kesalahan saat login";P={"Invalid login credentials":"Email atau password salah","Email not confirmed":"Email belum dikonfirmasi. Silakan cek email Anda.","Too many requests":"Terlalu banyak percobaan login. Silakan coba lagi nanti.","Sistem belum dikonfigurasi":"Sistem belum dikonfigurasi. Silakan hubungi administrator.","Akun Anda tidak aktif":L.message}[L.message]||L.message||P,await ct.fire({icon:"error",title:"Login Gagal",html:`
          <div class="text-left">
            <p class="font-medium">${P}</p>
            ${L.message.includes("credentials")?'<p class="mt-2 text-sm text-gray-600">Pastikan email dan password yang Anda masukkan benar.</p>':""}
          </div>
        `,confirmButtonColor:"#3b82f6"}),(A=w.current)==null||A.reset(),f(null)}finally{i(!1)}}},N=_=>{f(_)},S=()=>{f(null),ct.fire({icon:"info",title:"Verifikasi Kadaluarsa",text:"Silakan verifikasi ulang bahwa Anda bukan robot",timer:3e3,showConfirmButton:!1})},D=()=>{f(null),ct.fire({icon:"error",title:"Verifikasi Gagal",text:"Terjadi kesalahan saat memverifikasi reCAPTCHA. Silakan coba lagi.",confirmButtonColor:"#3b82f6"})};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-indigo-800 flex items-center justify-center p-4",children:l.jsxs("div",{className:"max-w-md w-full animate-fade-in",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-6 shadow-lg transform transition-transform hover:scale-105",children:l.jsx(sS,{className:"h-10 w-10 text-blue-600"})}),l.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Portal Karyawan"}),l.jsx("p",{className:"text-blue-100",children:"Masuk untuk mengakses sistem absensi"})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 backdrop-blur-sm transition-all hover:shadow-3xl",children:[l.jsxs("div",{className:"mb-8 text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:"Masuk ke Akun Anda"}),l.jsx("p",{className:"text-gray-500 mt-1",children:"Silakan login menggunakan email dan password"})]}),!bl()&&l.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg flex items-start space-x-3 animate-pulse",children:[l.jsx(zu,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Sistem Belum Dikonfigurasi"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Database belum terhubung. Silakan hubungi administrator untuk mengatur koneksi Supabase."})]})]}),l.jsxs("form",{onSubmit:y,className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("div",{className:"w-full",children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Alamat Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(ev,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:m,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md focus:shadow-md bg-gray-50",placeholder:"Masukkan email Anda"})]})]}),l.jsxs("div",{className:"w-full",children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(_l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:d?"text":"password",id:"password",name:"password",value:n.password,onChange:m,required:!0,className:"w-full pl-10 pr-10 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md focus:shadow-md bg-gray-50",placeholder:"Masukkan password Anda"}),l.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>h(!d),"aria-label":d?"Sembunyikan password":"Tampilkan password",children:d?l.jsx(mT,{className:"h-5 w-5"}):l.jsx(S1,{className:"h-5 w-5"})})]})]})]}),l.jsx("div",{className:"mt-6 flex justify-center",children:l.jsx(ae.Suspense,{fallback:l.jsx("div",{className:"h-20 w-full flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),children:l.jsx(G8,{ref:w,sitekey:"6LdVU1srAAAAAHHTvpZWAe6SDWNUgXw80Gh1t8ea",onChange:N,onExpired:S,onErrored:D,theme:"light",className:"transform transition-transform hover:scale-[1.02]",onLoad:()=>b(!0)})})}),l.jsx("button",{type:"submit",disabled:r||!bl()||!p,className:`w-full py-3 px-4 rounded-lg font-medium focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all 
                ${r?"bg-blue-400 text-white cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"}
                ${!bl()||!p?"opacity-70 cursor-not-allowed":"shadow-md hover:shadow-lg"}
                transform hover:scale-[1.01] active:scale-[0.99]`,"aria-busy":r,children:r?l.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[l.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V8H4z"})]}),l.jsx("span",{children:"Memproses..."})]}):l.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[l.jsx(gT,{className:"h-5 w-5"}),l.jsx("span",{children:"Masuk"})]})})]})]})]})})};var XC={exports:{}},K8="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Y8=K8,X8=Y8;function JC(){}function QC(){}QC.resetWarningCache=JC;var J8=function(){function e(a,r,i,s,o,u){if(u!==X8){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:QC,resetWarningCache:JC};return n.PropTypes=n,n};XC.exports=J8();var Q8=XC.exports;const Lr=iS(Q8);var Z8=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function _y(){return _y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_y.apply(this,arguments)}function eO(e,t){if(e==null)return{};var n={},a=Object.keys(e),r,i;for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Qm(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tO(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,jy(e,t)}function jy(e,t){return jy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,r){return a.__proto__=r,a},jy(e,t)}var Sv=function(e){tO(t,e);function t(){var a;return a=e.call(this)||this,a.handleExpired=a.handleExpired.bind(Qm(a)),a.handleErrored=a.handleErrored.bind(Qm(a)),a.handleChange=a.handleChange.bind(Qm(a)),a.handleRecaptchaRef=a.handleRecaptchaRef.bind(Qm(a)),a}var n=t.prototype;return n.getCaptchaFunction=function(r){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[r]:this.props.grecaptcha[r]:null},n.getValue=function(){var r=this.getCaptchaFunction("getResponse");return r&&this._widgetId!==void 0?r(this._widgetId):null},n.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},n.execute=function(){var r=this.getCaptchaFunction("execute");if(r&&this._widgetId!==void 0)return r(this._widgetId);this._executeRequested=!0},n.executeAsync=function(){var r=this;return new Promise(function(i,s){r.executionResolve=i,r.executionReject=s,r.execute()})},n.reset=function(){var r=this.getCaptchaFunction("reset");r&&this._widgetId!==void 0&&r(this._widgetId)},n.forceReset=function(){var r=this.getCaptchaFunction("reset");r&&r()},n.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},n.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},n.handleChange=function(r){this.props.onChange&&this.props.onChange(r),this.executionResolve&&(this.executionResolve(r),delete this.executionReject,delete this.executionResolve)},n.explicitRender=function(){var r=this.getCaptchaFunction("render");if(r&&this._widgetId===void 0){var i=document.createElement("div");this._widgetId=r(i,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(i)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},n.componentDidMount=function(){this.explicitRender()},n.componentDidUpdate=function(){this.explicitRender()},n.handleRecaptchaRef=function(r){this.captcha=r},n.render=function(){var r=this.props;r.sitekey,r.onChange,r.theme,r.type,r.tabindex,r.onExpired,r.onErrored,r.size,r.stoken,r.grecaptcha,r.badge,r.hl,r.isolated;var i=eO(r,Z8);return ae.createElement("div",_y({},i,{ref:this.handleRecaptchaRef}))},t}(ae.Component);Sv.displayName="ReCAPTCHA";Sv.propTypes={sitekey:Lr.string.isRequired,onChange:Lr.func,grecaptcha:Lr.object,theme:Lr.oneOf(["dark","light"]),type:Lr.oneOf(["image","audio"]),tabindex:Lr.number,onExpired:Lr.func,onErrored:Lr.func,size:Lr.oneOf(["compact","normal","invisible"]),stoken:Lr.string,hl:Lr.string,badge:Lr.oneOf(["bottomright","bottomleft","inline"]),isolated:Lr.bool};Sv.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var ZC={exports:{}},fn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var za=typeof Symbol=="function"&&Symbol.for,Mw=za?Symbol.for("react.element"):60103,Ow=za?Symbol.for("react.portal"):60106,_v=za?Symbol.for("react.fragment"):60107,jv=za?Symbol.for("react.strict_mode"):60108,Cv=za?Symbol.for("react.profiler"):60114,Av=za?Symbol.for("react.provider"):60109,Ev=za?Symbol.for("react.context"):60110,Iw=za?Symbol.for("react.async_mode"):60111,Dv=za?Symbol.for("react.concurrent_mode"):60111,Tv=za?Symbol.for("react.forward_ref"):60112,Lv=za?Symbol.for("react.suspense"):60113,nO=za?Symbol.for("react.suspense_list"):60120,Pv=za?Symbol.for("react.memo"):60115,Rv=za?Symbol.for("react.lazy"):60116,aO=za?Symbol.for("react.block"):60121,rO=za?Symbol.for("react.fundamental"):60117,iO=za?Symbol.for("react.responder"):60118,sO=za?Symbol.for("react.scope"):60119;function wi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Mw:switch(e=e.type,e){case Iw:case Dv:case _v:case Cv:case jv:case Lv:return e;default:switch(e=e&&e.$$typeof,e){case Ev:case Tv:case Rv:case Pv:case Av:return e;default:return t}}case Ow:return t}}}function eA(e){return wi(e)===Dv}fn.AsyncMode=Iw;fn.ConcurrentMode=Dv;fn.ContextConsumer=Ev;fn.ContextProvider=Av;fn.Element=Mw;fn.ForwardRef=Tv;fn.Fragment=_v;fn.Lazy=Rv;fn.Memo=Pv;fn.Portal=Ow;fn.Profiler=Cv;fn.StrictMode=jv;fn.Suspense=Lv;fn.isAsyncMode=function(e){return eA(e)||wi(e)===Iw};fn.isConcurrentMode=eA;fn.isContextConsumer=function(e){return wi(e)===Ev};fn.isContextProvider=function(e){return wi(e)===Av};fn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Mw};fn.isForwardRef=function(e){return wi(e)===Tv};fn.isFragment=function(e){return wi(e)===_v};fn.isLazy=function(e){return wi(e)===Rv};fn.isMemo=function(e){return wi(e)===Pv};fn.isPortal=function(e){return wi(e)===Ow};fn.isProfiler=function(e){return wi(e)===Cv};fn.isStrictMode=function(e){return wi(e)===jv};fn.isSuspense=function(e){return wi(e)===Lv};fn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===_v||e===Dv||e===Cv||e===jv||e===Lv||e===nO||typeof e=="object"&&e!==null&&(e.$$typeof===Rv||e.$$typeof===Pv||e.$$typeof===Av||e.$$typeof===Ev||e.$$typeof===Tv||e.$$typeof===rO||e.$$typeof===iO||e.$$typeof===sO||e.$$typeof===aO)};fn.typeOf=wi;ZC.exports=fn;var oO=ZC.exports,Fw=oO,lO={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},uO={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},cO={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},tA={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Bw={};Bw[Fw.ForwardRef]=cO;Bw[Fw.Memo]=tA;function c4(e){return Fw.isMemo(e)?tA:Bw[e.$$typeof]||lO}var dO=Object.defineProperty,hO=Object.getOwnPropertyNames,d4=Object.getOwnPropertySymbols,fO=Object.getOwnPropertyDescriptor,pO=Object.getPrototypeOf,h4=Object.prototype;function nA(e,t,n){if(typeof t!="string"){if(h4){var a=pO(t);a&&a!==h4&&nA(e,a,n)}var r=hO(t);d4&&(r=r.concat(d4(t)));for(var i=c4(e),s=c4(t),o=0;o<r.length;++o){var u=r[o];if(!uO[u]&&!(n&&n[u])&&!(s&&s[u])&&!(i&&i[u])){var c=fO(t,u);try{dO(e,u,c)}catch{}}}}return e}var mO=nA;const gO=iS(mO);function Cy(){return Cy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Cy.apply(this,arguments)}function vO(e,t){if(e==null)return{};var n={},a=Object.keys(e),r,i;for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function xO(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Zi={},bO=0;function yO(e,t){return t=t||{},function(a){var r=a.displayName||a.name||"Component",i=function(o){xO(u,o);function u(d,h){var p;return p=o.call(this,d,h)||this,p.state={},p.__scriptURL="",p}var c=u.prototype;return c.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+bO++),this.__scriptLoaderID},c.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},c.asyncScriptLoaderHandleLoad=function(h){var p=this;this.setState(h,function(){return p.props.asyncScriptOnLoad&&p.props.asyncScriptOnLoad(p.state)})},c.asyncScriptLoaderTriggerOnScriptLoaded=function(){var h=Zi[this.__scriptURL];if(!h||!h.loaded)throw new Error("Script is not loaded.");for(var p in h.observers)h.observers[p](h);delete window[t.callbackName]},c.componentDidMount=function(){var h=this,p=this.setupScriptURL(),f=this.asyncScriptLoaderGetScriptLoaderID(),g=t,b=g.globalName,w=g.callbackName,m=g.scriptId;if(b&&typeof window[b]<"u"&&(Zi[p]={loaded:!0,observers:{}}),Zi[p]){var x=Zi[p];if(x&&(x.loaded||x.errored)){this.asyncScriptLoaderHandleLoad(x);return}x.observers[f]=function(_){return h.asyncScriptLoaderHandleLoad(_)};return}var y={};y[f]=function(_){return h.asyncScriptLoaderHandleLoad(_)},Zi[p]={loaded:!1,observers:y};var N=document.createElement("script");N.src=p,N.async=!0;for(var S in t.attributes)N.setAttribute(S,t.attributes[S]);m&&(N.id=m);var D=function(A){if(Zi[p]){var L=Zi[p],P=L.observers;for(var j in P)A(P[j])&&delete P[j]}};w&&typeof window<"u"&&(window[w]=function(){return h.asyncScriptLoaderTriggerOnScriptLoaded()}),N.onload=function(){var _=Zi[p];_&&(_.loaded=!0,D(function(A){return w?!1:(A(_),!0)}))},N.onerror=function(){var _=Zi[p];_&&(_.errored=!0,D(function(A){return A(_),!0}))},document.body.appendChild(N)},c.componentWillUnmount=function(){var h=this.__scriptURL;if(t.removeOnUnmount===!0)for(var p=document.getElementsByTagName("script"),f=0;f<p.length;f+=1)p[f].src.indexOf(h)>-1&&p[f].parentNode&&p[f].parentNode.removeChild(p[f]);var g=Zi[h];g&&(delete g.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete Zi[h])},c.render=function(){var h=t.globalName,p=this.props;p.asyncScriptOnLoad;var f=p.forwardedRef,g=vO(p,["asyncScriptOnLoad","forwardedRef"]);return h&&typeof window<"u"&&(g[h]=typeof window[h]<"u"?window[h]:void 0),g.ref=f,ae.createElement(a,g)},u}(ae.Component),s=ae.forwardRef(function(o,u){return ae.createElement(i,Cy({},o,{forwardedRef:u}))});return s.displayName="AsyncScriptLoader("+r+")",s.propTypes={asyncScriptOnLoad:Lr.func},gO(s,a)}}var Ay="onloadcallback",wO="grecaptcha";function Ey(){return typeof window<"u"&&window.recaptchaOptions||{}}function NO(){var e=Ey(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+Ay+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+Ay+"&render=explicit"}const kO=yO(NO,{callbackName:Ay,globalName:wO,attributes:Ey().nonce?{nonce:Ey().nonce}:{}})(Sv);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aA=function(e,t){return(aA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)a.hasOwnProperty(r)&&(n[r]=a[r])})(e,t)};function cs(e,t){function n(){this.constructor=e}aA(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function lt(e,t,n,a){return new(n||(n=Promise))(function(r,i){function s(c){try{u(a.next(c))}catch(d){i(d)}}function o(c){try{u(a.throw(c))}catch(d){i(d)}}function u(c){c.done?r(c.value):new n(function(d){d(c.value)}).then(s,o)}u((a=a.apply(e,[])).next())})}function ut(e,t){var n,a,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(c){return function(d){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&d[0]?a.return:d[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,d[1])).done)return r;switch(a=0,r&&(d=[2&d[0],r.value]),d[0]){case 0:case 1:r=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,a=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){s.label=d[1];break}if(d[0]===6&&s.label<r[1]){s.label=r[1],r=d;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(d);break}r[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(e,s)}catch(h){d=[6,h],a=0}finally{n=r=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([u,c])}}}var SO=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,a){if(this.flagRegistry[t]={evaluationFn:n,setHook:a},this.urlFlags[t]!=null){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,a,r=(n=this.global.location.search,a={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return _O(a,s[0],s[1]),s.join("=")}),a);"tfjsflags"in r&&r.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),o=s[0],u=s[1];t.urlFlags[o]=function(c,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+c+".")}(o,u)})}},e}();function _O(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Be(){return rA}var rA=null,A0=new Map,Dy=new Map;function iA(e,t){var n=oA(e,t);return A0.get(n)}function jO(e){return Dy.get(e)}function f4(e){for(var t=A0.entries(),n=[];;){var a=t.next(),r=a.done,i=a.value;if(r)break;var s=i[0],o=i[1];s.split("_")[0]===e&&n.push(o)}return n}function sA(e){var t=e.kernelName,n=e.backendName,a=oA(t,n);if(A0.has(a))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");A0.set(a,e)}function CO(e){var t=e.kernelName;Dy.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Dy.set(t,e)}function oA(e,t){return t+"_"+e}function Ty(e,t,n){return Math.max(e,Math.min(t,n))}function lA(e){return e%2==0?e:e+1}function AO(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function se(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function sn(e,t,n){n===void 0&&(n=""),se(Ia(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function ch(e){se(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function $d(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Fs(e)&&!n)for(var a=0;a<e.length;++a)$d(e[a],t,n);else t.push(e);return t}function dt(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Ia(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function sa(e){return e%1==0}function EO(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Ly(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Sd(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function p4(e,t,n){return t===void 0&&(t=function(a){return 0}),new Promise(function(a,r){var i=0,s=function(){if(e())a();else{i++;var o=t(i);n!=null&&i>=n?r():setTimeout(s,o)}};s()})}function DO(e,t){for(var n=1,a=-1,r=0;r<e.length;++r)if(e[r]>=0)n*=e[r];else if(e[r]===-1){if(a!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+a+" and dim "+r);a=r}else if(e[r]<0)throw Error("Shapes can not be < 0. Found "+e[r]+" at dim "+r);if(a===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[a]=t/n,i}function Ca(e,t){var n=t.length;return se((e=e==null?t.map(function(a,r){return r}):[].concat(e)).every(function(a){return a>=-n&&a<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),se(e.every(function(a){return sa(a)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(a){return a<0?n+a:a})}function wu(e,t){for(var n=[],a=[],r=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||r?null:Ca(t,e).sort(),s=0,o=0;o<e.length;++o){if(i!=null){if(i[s]===o&&e[o]!==1)throw new Error("Can't squeeze axis "+o+" since its dim '"+e[o]+"' is not 1");(i[s]==null||i[s]>o)&&e[o]===1&&(n.push(e[o]),a.push(o)),i[s]<=o&&s++}e[o]!==1&&(n.push(e[o]),a.push(o))}return{newShape:n,keptDims:a}}function Xf(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function E0(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function TO(e,t){for(var n=0;n<e.length;n++){var a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type "+t+" being uploaded contains "+a+".")}}function LO(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function PO(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Fs(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function uA(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function RO(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function zw(e){return typeof e=="string"||e instanceof String}function MO(e){return typeof e=="boolean"}function OO(e){return typeof e=="number"}function Pp(e){return Array.isArray(e)?Pp(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":OO(e)?"float32":zw(e)?"string":MO(e)?"bool":"float32"}function Py(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Ry(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Bs(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var a=t-3;a>=0;--a)n[a]=n[a+1]*e[a+1];return n}function cA(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=$d(e)),n&&TO(e,t),function(i,s){return i instanceof Float32Array&&s==="float32"||i instanceof Int32Array&&s==="int32"||i instanceof Uint8Array&&s==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var a=new Uint8Array(e.length),r=0;r<a.length;++r)Math.round(e[r])!==0&&(a[r]=1);return a}throw new Error("Unknown data type "+t)}function m4(e,t){if(e.length===0)return t[0];var n=e.reduce(function(a,r){return a*r});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function a(r,i,s){var o=new Array;if(i.length===1)for(var u=i[0],c=0;c<u;c++)o[c]=s[r+c];else{u=i[0];var d=i.slice(1),h=d.reduce(function(p,f){return p*f});for(c=0;c<u;c++)o[c]=a(r+c*h,d,s)}return o}(0,e,t)}function dA(e,t){for(var n=Rp(e,t),a=0;a<n.length;a++)n[a]=1;return n}function Rp(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function js(){return Be().platform.now()}function hA(e){e.forEach(function(t){se(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function IO(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Be().platform.encode(e,t)}function D0(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Be().platform.decode(e,t)}function g4(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var a=e[e.length-1],r=0;r<e.length-1;++r)a+=n[r]*e[r];return a}function FO(e,t,n){if(t===0)return[];if(t===1)return[e];for(var a=new Array(t),r=0;r<a.length-1;++r)a[r]=Math.floor(e/n[r]),e-=a[r]*n[r];return a[a.length-1]=e,a}var BO=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new zO)}return e.prototype.profileKernel=function(t,n,a){var r,i=this,s=this.backendTimer.time(function(){r=a()});return r.forEach(function(o){o.data().then(function(u){(function(c,d,h){if(d!=="float32")return!1;for(var p=0;p<c.length;p++){var f=c[p];if(isNaN(f)||!isFinite(f))return console.warn("Found "+f+" in the result of '"+h+"'"),!0}})(u,o.dtype,t),s.then(function(c){var d="";c.getExtraProfileInfo!=null&&(d=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,o,u,c.kernelMs,n,d)})})}),r},e}(),zO=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,a,r,i,s){var o=typeof r=="number"?Sd(r+"ms",9):r.error,u=Sd(t,25),c=n.rank,d=n.size,h=Sd(n.shape.toString(),14),p="";for(var f in i){var g=i[f].shape||n.shape,b=g.length;p+=f+": "+b+"D "+(b>0?g:"")+" "}console.log("%c"+u+"	%c"+o+"	%c"+c+"D "+h+"	%c"+d+"	%c"+p+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),v4=20,Qh=3,Ib=7;function UO(e,t,n,a){var r=Bs(t),i=function(c,d,h,p){var f=dt(d),g=p[p.length-1],b=new Array(g).fill(0),w=d.length,m=h==="complex64"?ef(c):c;if(w>1)for(var x=0;x<f/g;x++)for(var y=x*g,N=0;N<g;N++)b[N]=Math.max(b[N],Zh(m[y+N],0,h).length);return b}(e,t,n,r),s=t.length,o=function c(d,h,p,f,g,b){b===void 0&&(b=!0);var w=p==="complex64"?2:1,m=h[0],x=h.length;if(x===0)return p==="complex64"?[Zh(ef(d)[0],0,p)]:p==="bool"?[fA(d[0])]:[d[0].toString()];if(x===1){if(m>v4){var y=Qh*w,N=Array.from(d.slice(0,y)),S=Array.from(d.slice((m-Qh)*w,m*w));return p==="complex64"&&(N=ef(N),S=ef(S)),["["+N.map(function(U,O){return Zh(U,g[O],p)}).join(", ")+", ..., "+S.map(function(U,O){return Zh(U,g[m-Qh+O],p)}).join(", ")+"]"]}return["["+(p==="complex64"?ef(d):Array.from(d)).map(function(U,O){return Zh(U,g[O],p)}).join(", ")+"]"]}var D=h.slice(1),_=f.slice(1),A=f[0]*w,L=[];if(m>v4){for(var P=0;P<Qh;P++){var j=(E=P*A)+A;L.push.apply(L,c(d.slice(E,j),D,p,_,g,!1))}for(L.push("..."),P=m-Qh;P<m;P++)j=(E=P*A)+A,L.push.apply(L,c(d.slice(E,j),D,p,_,g,P===m-1))}else for(P=0;P<m;P++){var E;j=(E=P*A)+A,L.push.apply(L,c(d.slice(E,j),D,p,_,g,P===m-1))}var F=x===2?",":"";for(L[0]="["+L[0]+F,P=1;P<L.length-1;P++)L[P]=" "+L[P]+F;var z=`,
`;for(P=2;P<x;P++)z+=`
`;return L[L.length-1]=" "+L[L.length-1]+"]"+(b?"":z),L}(e,t,n,r,i),u=["Tensor"];return a&&(u.push("  dtype: "+n),u.push("  rank: "+s),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(o.map(function(c){return"    "+c}).join(`
`)),u.join(`
`)}function Zh(e,t,n){return Sd(Array.isArray(e)?parseFloat(e[0].toFixed(Ib))+" + "+parseFloat(e[1].toFixed(Ib))+"j":zw(e)?"'"+e+"'":n==="bool"?fA(e):parseFloat(e.toFixed(Ib)).toString(),t)}function fA(e){return e===0?"false":"true"}function ef(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Jf=function(){function e(t,n,a){var r=this;if(this.dtype=n,this.shape=t.slice(),this.size=dt(t),a!=null){var i=a.length;se(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=a||E0(n,this.size),this.strides=Bs(t)}return e.prototype.set=function(t){for(var n=this,a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];a.length===0&&(a=[0]),se(a.length===this.rank,function(){return"The number of provided coordinates ("+a.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(a);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var a=0,r=0,i=t;r<i.length;r++){var s=i[r];if(s<0||s>=this.shape[a]){var o="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(o)}a++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],a=0;a<t.length-1;++a)n+=this.strides[a]*t[a];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),a=0;a<n.length-1;++a)n[a]=Math.floor(t/this.strides[a]),t-=n[a]*this.strides[a];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return As().makeTensor(this.values,this.shape,this.dtype)},e}(),As=null,Re=null,pA=null,zn=function(){function e(t,n,a,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=dt(t),this.strides=Bs(t),this.dataId=a,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),se(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,a){return this.throwIfDisposed(),this.reshape([t,n,a])},e.prototype.as4D=function(t,n,a,r){return this.throwIfDisposed(),this.reshape([t,n,a,r])},e.prototype.as5D=function(t,n,a,r,i){return this.throwIfDisposed(),this.reshape([t,n,a,r,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),Re.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Re.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return Re.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,m4(this.shape,t)]}})})},e.prototype.arraySync=function(){return m4(this.shape,this.dataSync())},e.prototype.data=function(){return lt(this,void 0,void 0,function(){var t,n;return ut(this,function(a){switch(a.label){case 0:return this.throwIfDisposed(),t=As().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=a.sent();try{return[2,n.map(function(r){return D0(r)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}a.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=As().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return D0(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,As().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(As().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),Re.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),Re.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),Re.expandDims(this,t)},e.prototype.cumsum=function(t,n,a){return t===void 0&&(t=0),n===void 0&&(n=!1),a===void 0&&(a=!1),Re.cumsum(this,t,n,a)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),Re.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),Re.clone(this)},e.prototype.oneHot=function(t,n,a){return this.throwIfDisposed(),Re.oneHot(this,t,n,a)},e.prototype.toString=function(t){return t===void 0&&(t=!1),UO(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),Re.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Re.gather(this,t,n)},e.prototype.matMul=function(t,n,a){return n===void 0&&(n=!1),a===void 0&&(a=!1),this.throwIfDisposed(),Re.matMul(this,t,n,a)},e.prototype.dot=function(t){return this.throwIfDisposed(),Re.dot(this,t)},e.prototype.norm=function(t,n,a){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),a===void 0&&(a=!1),this.throwIfDisposed(),Re.norm(this,t,n,a)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),Re.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),Re.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Re.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Re.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),Re.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),Re.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),Re.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,a,r,i){return a===void 0&&(a=.001),pA("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,r,a)},e.prototype.batchNorm=function(t,n,a,r,i){return i===void 0&&(i=.001),this.throwIfDisposed(),Re.batchNorm(this,t,n,a,r,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Re.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Re.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Re.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),Re.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),Re.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),Re.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),Re.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),Re.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),Re.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),Re.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),Re.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),Re.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),Re.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),Re.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),Re.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),Re.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),Re.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),Re.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Re.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),Re.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Re.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),Re.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),Re.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Re.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),Re.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),Re.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Re.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),Re.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),Re.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),Re.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),Re.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),Re.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Re.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),Re.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Re.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Re.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Re.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Re.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),Re.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Re.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),Re.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),Re.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),Re.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Re.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Re.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Re.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Re.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Re.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Re.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Re.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Re.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Re.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Re.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Re.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Re.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Re.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Re.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Re.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),Re.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),Re.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Re.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Re.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Re.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),Re.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),Re.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Re.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Re.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Re.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Re.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Re.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Re.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Re.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Re.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Re.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Re.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Re.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Re.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Re.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Re.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Re.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Re.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Re.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Re.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Re.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),Re.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Re.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Re.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Re.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Re.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,a,r,i,s){return r===void 0&&(r="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),Re.conv1d(this,t,n,a,r,i,s)},e.prototype.conv2d=function(t,n,a,r,i,s){return r===void 0&&(r="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Re.conv2d(this,t,n,a,r,i,s)},e.prototype.conv2dTranspose=function(t,n,a,r,i){return this.throwIfDisposed(),Re.conv2dTranspose(this,t,n,a,r,i)},e.prototype.depthwiseConv2D=function(t,n,a,r,i,s){return r===void 0&&(r="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Re.depthwiseConv2d(this,t,n,a,r,i,s)},e.prototype.separableConv2d=function(t,n,a,r,i,s){return i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),Re.separableConv2d(this,t,n,a,r,i,s)},e.prototype.avgPool=function(t,n,a,r){return this.throwIfDisposed(),Re.avgPool(this,t,n,a,r)},e.prototype.maxPool=function(t,n,a,r){return this.throwIfDisposed(),Re.maxPool(this,t,n,a,r)},e.prototype.localResponseNormalization=function(t,n,a,r){return t===void 0&&(t=5),n===void 0&&(n=1),a===void 0&&(a=1),r===void 0&&(r=.5),Re.localResponseNormalization(this,t,n,a,r)},e.prototype.pool=function(t,n,a,r,i){return this.throwIfDisposed(),Re.pool(this,t,n,a,r,i)},e.prototype.variable=function(t,n,a){return t===void 0&&(t=!0),this.throwIfDisposed(),As().makeVariable(this,t,n,a)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),Re.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),Re.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Re.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),Re.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,a,r,i,s,o,u){return r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),this.throwIfDisposed(),Re.stridedSlice(this,t,n,a,r,i,s,o,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),Re.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),Re.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Re.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Re.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Re.spectral.irfft(this)},e}();Object.defineProperty(zn,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var x4,My,Oy,Iy,Fy,Kd=function(e){function t(n,a,r,i){var s=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return s.trainable=a,s.name=r,s}return cs(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Ia(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");As().disposeTensor(this),this.dataId=n.dataId,As().incRef(this,null)},t.prototype.dispose=function(){As().disposeVariable(this),this.isDisposedInternal=!0},t}(zn);Object.defineProperty(Kd,Symbol.hasInstance,{value:function(e){return e instanceof zn&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(x4||(x4={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(My||(My={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Oy||(Oy={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Iy||(Iy={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Fy||(Fy={}));var qO={float32:Iy,int32:My,bool:Oy,complex64:Fy};function Ga(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return qO[e][t]}function Fb(e){return Ga(e,"int32")}function qn(e,t){if(e.dtype===t.dtype)return[e,t];var n=Ga(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function WO(e,t){se(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function mA(e){var t=[];return function n(a,r,i){if(a!=null){if(a instanceof zn)return void r.push(a);if(s=a,!(!Array.isArray(s)&&typeof s!="object")){var s,o=a;for(var u in o){var c=o[u];i.has(c)||(i.add(c),n(c,r,i))}}}}(e,t,new Set),t}var Bb,b4=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),HO=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new b4}return e.prototype.ready=function(){return lt(this,void 0,void 0,function(){var t,n,a;return ut(this,function(r){switch(r.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,r.label=1;case 1:return n<t.length?(a=t[n],[4,this.initializeBackend(a).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(a)]:[3,4];case 3:return r.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,a){return a===void 0&&(a=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:a},!0)},e.prototype.setBackend=function(t){return lt(this,void 0,void 0,function(){var n,a,r;return ut(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),a=n.success,n.asyncInit?[4,a]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=a,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new BO(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;f4(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;f4(t).forEach(function(a){a.disposeFunc!=null&&a.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,a=this.registryFactory[t];if(a==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=a.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,s=r.then(function(o){return!(i<n.pendingBackendInitId)&&(n.registry[t]=o,n.pendingBackendInit=null,!0)}).catch(function(o){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(o.stack||o.message),!1)});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(o){return console.warn("Initialization of backend "+t+" failed"),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,a){return t.registryFactory[a].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var a=t[n],r=this.initializeBackend(a),i=r.success,s=r.asyncInit;if(s||i)return{name:a,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var a=this.state.tensorInfo.get(n),r=a.backend,i=this.readSync(n);r.disposeData(n),a.backend=t,t.move(n,i,a.shape,a.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var a,r=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return r.startScope(i)},function(){return r.endScope(a)},function(){return(a=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a})},e.prototype.scopedRun=function(t,n,a){t();try{var r=a();return n(),r}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),a={x:t};return this.addTapeNode(this.state.activeScope.name,a,[n],function(r){return{x:function(){return r.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,a,r,i){return this.runKernelFunc(null,n,null,t,a,r,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,a){var r=this.backend.numDataIds(),i=0;a.forEach(function(u){i+=u.dtype==="complex64"?3:1});var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-n-i-s;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,a,r,i,s,o){var u,c=this;s===void 0&&(s=[]),o===void 0&&(o=[]);var d=[],h=this.isTapeOn();r==null&&(r=this.state.activeScope!=null?this.state.activeScope.name:"");var p,f=function(x){h&&(d=x.map(function(y){return c.keep(c.clone(y))}))},g=this.state.numBytes,b=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var w,m=iA(r,this.backendName);return p=m!=null?function(){var x=c.backend.numDataIds();w=m.kernelFunc({inputs:n,attrs:i,backend:c.backend});var y=Array.isArray(w)?w:[w];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(r,x,y);var N=y.map(function(D){var _=D.dataId,A=D.shape,L=D.dtype;return c.makeTensorFromDataId(_,A,L)}),S=N.filter(function(D,_){return o[_]});return f((s||[]).slice().concat(S)),N}:function(){var x=c.backend.numDataIds();w=c.tidy(function(){return t(c.backend,f)});var y=Array.isArray(w)?w:[w];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(r,x,y),y},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(r,n,function(){return p()}):p()}),h&&this.addTapeNode(r,n,u,a,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-g,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-b,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(x){return n[x].shape}),outputShapes:u.map(function(x){return x.shape})}),Array.isArray(w)?u:u[0]},e.prototype.makeTensor=function(t,n,a,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");a=a||"float32",r=r||this.backend;var i=t;a==="string"&&zw(t[0])&&(i=t.map(function(d){return IO(d)}));var s=r.write(i,n,a),o=new zn(n,a,s,this.nextTensorId());if(this.incRef(o,r),a==="string"){var u=this.state.tensorInfo.get(s),c=RO(i);this.state.numBytes+=c-u.bytes,u.bytes=c}return o},e.prototype.makeTensorFromDataId=function(t,n,a,r){var i=new zn(n,a=a||"float32",t,this.nextTensorId());return this.incRef(i,r),i},e.prototype.makeVariable=function(t,n,a,r){n===void 0&&(n=!0),a=a||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.asType(r));var i=new Kd(t,n,a,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var a=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,a===0){this.state.numDataBuffers++;var r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*uA(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Kd||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return lt(this,void 0,void 0,function(){var n,a;return ut(this,function(r){return this.state.profiling=!0,n=this.state.numBytes,a=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-a,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,a,r,i){var s=this,o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:a,saved:i},u=jO(t);u!=null&&(r=u.gradFunc),r!=null&&(o.gradient=function(c){return c=c.map(function(d,h){if(d==null){var p=a[h],f=Rp(p.size,p.dtype);return s.makeTensor(f,p.shape,p.dtype)}return d}),r(c.length>1?c:c[0],i)}),this.state.activeTape.push(o)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,a=mA(t),r=new Set(a.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||r.has(s.id)||s.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],a.forEach(function(u){u.kept||u.scopeId!==o.id||n.track(u)})},e.prototype.gradients=function(t,n,a,r){var i=this;if(r===void 0&&(r=!1),se(n.length>0,function(){return"gradients() received an empty list of xs."}),a!=null&&a.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+a.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});se(s instanceof zn,function(){return"The result y returned by f() must be a tensor."});var o=function(u,c,d){for(var h={},p={},f=0;f<c.length;f++)h[c[f].id]=!0;for(f=0;f<u.length;f++){var g=(D=u[f]).inputs;for(var b in g){for(var w=g[b],m=!1,x=0;x<c.length;x++)if(h[w.id]){D.outputs.forEach(function(P){return h[P.id]=!0}),m=!0,p[D.id]=!0;break}if(m)break}}var y={};y[d.id]=!0;var N={};for(f=u.length-1;f>=0;f--)for(g=(D=u[f]).inputs,x=0;x<D.outputs.length;x++)if(y[D.outputs[x].id]){for(var b in g)y[g[b].id]=!0,N[D.id]=!0;break}var S=[];for(f=0;f<u.length;f++){var D;if(p[(D=u[f]).id]&&N[D.id]){var _={};for(var b in D.inputs){var A=D.inputs[b];h[A.id]&&(_[b]=A)}var L=Object.assign({},D);L.inputs=_,L.outputs=D.outputs,S.push(L)}}return S}(this.state.activeTape,n,s);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,d={};d[s.id]=a??(u=s.shape,c=dA(dt(u),"float32"),ye.makeTensor(c,u,"float32")),function(p,f,g){for(var b=function(m){var x=f[m],y=[];if(x.outputs.forEach(function(_){var A=p[_.id];A!=null?y.push(A):y.push(null)}),x.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+x.kernelName+".");var N=x.gradient(y),S=function(_){if(!(_ in N))throw new Error("Cannot backprop through input "+_+". Available gradients found: "+Object.keys(N)+".");var A=g(function(){return N[_]()});if(A.dtype!=="float32")throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input "+_+" must have 'float32' dtype, but has '"+A.dtype+"'");var L=x.inputs[_];if(!Ia(A.shape,L.shape))throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input '"+_+"' has shape '"+A.shape+"', which does not match the shape of the input '"+L.shape+"'");if(p[L.id]==null)p[L.id]=A;else{var P=p[L.id];p[L.id]=P.add(A),P.dispose()}};for(var D in x.inputs)S(D)},w=f.length-1;w>=0;w--)b(w)}(d,o,function(p){return i.tidy(p)});var h=n.map(function(p){return d[p.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(p){for(var f=0,g=p.saved;f<g.length;f++)g[f].dispose()}),i.state.activeTape=null),{value:s,grads:h}})},e.prototype.customGrad=function(t){var n=this;return se(Py(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var a,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];se(r.every(function(o){return o instanceof zn}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return r.forEach(function(o,u){s[u]=o}),n.runKernelFunc(function(o,u){return se((a=t.apply(void 0,r.concat([u]))).value instanceof zn,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),se(Py(a.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),a.value},s,function(o,u){var c=a.gradFunc(o,u),d=Array.isArray(c)?c:[c];se(d.length===r.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),se(d.every(function(p){return p instanceof zn}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return d.forEach(function(p,f){h[f]=function(){return p}}),h})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return lt(this,void 0,void 0,function(){var n,a;return ut(this,function(r){switch(r.label){case 0:return n=js(),[4,this.backend.time(t)];case 1:return(a=r.sent()).wallMs=js()-n,[2,a]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new b4,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),ye=function(){var e=function(){if(Bb==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Bb=n}return Bb}();if(e._tfengine==null){var t=new SO(e);e._tfengine=new HO(t)}return function(n){rA=n}(e._tfengine.ENV),As=function(){return e._tfengine},e._tfengine}();function gA(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var co=Be();co.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),co.registerFlag("IS_BROWSER",function(){return gA()}),co.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),co.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),co.registerFlag("PROD",function(){return!1}),co.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return co.getBool("DEBUG")}),co.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),co.registerFlag("IS_TEST",function(){return!1});var Qf,oi,ii,vu={},zb={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function VO(e,t){vu[e]=t}function $s(e){e in vu||(vu[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var a=function(r){if(typeof OffscreenCanvas<"u"&&r===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return a.addEventListener("webglcontextlost",function(r){r.preventDefault(),delete vu[n]},!1),n===1?a.getContext("webgl",zb)||a.getContext("experimental-webgl",zb):a.getContext("webgl2",zb)}(e));var t=vu[e];return t.isContextLost()?(delete vu[e],$s(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),vu[e])}function Mv(e,t){return[t,e]}function jf(e){var t=dt(e);return Ly(Math.ceil(t/4))}function Mp(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Uw(e,t){var n,a,r,i,s,o,u,c,d,h=e;return Be().getNumber("WEBGL_VERSION")===2?(n=h.R32F,a=h.R16F,r=h.RGBA16F,i=h.RGBA32F,s=h.RED,o=4,u=1,c=h.HALF_FLOAT,d=h.FLOAT):(n=e.RGBA,a=e.RGBA,r=e.RGBA,i=h.RGBA,s=e.RGBA,o=4,u=4,c=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:o,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:d}}function ht(e,t,n){var a=n();return t&&function(r){var i=r.getError();if(i!==r.NO_ERROR)throw new Error("WebGL Error: "+YO(r,i))}(e),a}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Qf||(Qf={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(oi||(oi={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(ii||(ii={}));var GO=596e-10,$O=65504;function KO(e){return!!(Be().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||GO<Math.abs(e)&&Math.abs(e)<$O)}function YO(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Zm(e,t,n){return To(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function XO(e,t,n){var a=To(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ht(e,t,function(){return e.shaderSource(a,n)}),ht(e,t,function(){return e.compileShader(a)}),e.getShaderParameter(a,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(a)),new Error("Failed to compile vertex shader.");return a}function JO(e,t,n){var a=To(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ht(e,t,function(){return e.shaderSource(a,n)}),ht(e,t,function(){return e.compileShader(a)}),e.getShaderParameter(a,e.COMPILE_STATUS)===!1)throw function(r,i){var s=QO.exec(i);if(s==null)return console.log("Couldn't parse line number in error: "+i),void console.log(r);for(var o=+s[1],u=r.split(`
`),c=u.length.toString().length+2,d=u.map(function(w,m){return Sd((m+1).toString(),c)+w}),h=0,p=0;p<d.length;p++)h=Math.max(d[p].length,h);var f=d.slice(0,o-1),g=d.slice(o-1,o),b=d.slice(o);console.log(f.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+Sd(g[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(b.join(`
`))}(n,e.getShaderInfoLog(a)),new Error("Failed to compile fragment shader.");return a}var Ub,qb,QO=/ERROR: [0-9]+:([0-9]+):/g;function ZO(e,t){return To(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function eI(e,t,n){if(ht(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Wb(e,t,n){if(ht(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function tI(e,t,n){var a=To(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ht(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),ht(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),a}function nI(e,t,n){var a=To(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ht(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a)}),ht(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),a}function aI(e,t){return To(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function rI(e,t){var n=Be().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var a="["+e+"x"+t+"]";throw new Error("Requested texture size "+a+" is invalid.")}if(e>n||t>n)throw a="["+e+"x"+t+"]",new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function iI(e,t){return To(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function y4(e,t,n,a,r,i,s,o){var u=e.getAttribLocation(n,a);return u!==-1&&(ht(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ht(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,s,o)}),ht(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function sI(e,t,n,a){dI(e,a),ht(e,t,function(){return e.activeTexture(e.TEXTURE0+a)}),ht(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function oI(e,t,n,a){return To(e,t,function(){return e.getUniformLocation(n,a)},'uniform "'+a+'" not present in program.')}function lI(e,t,n){return e.getUniformLocation(t,n)}function uI(e,t,n,a,r,i){ht(e,t,function(){return sI(e,t,a,i)}),ht(e,t,function(){return e.uniform1i(r,i)})}function Hb(e,t,n,a){ht(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,a)}),ht(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function w4(e,t,n){ht(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ht(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function eg(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+cI(e,t))}function cI(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function To(e,t,n,a){var r=ht(e,t,function(){return n()});if(r==null)throw new Error(a);return r}function dI(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||a>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function T0(e,t){return t===void 0&&(t=2),dt(e.slice(0,e.length-t))}function L0(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Vb(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[T0(e)].concat(L0(e))),t}function hI(e,t){var n;t===void 0&&(t=!1);var a=Be().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(a*=2,(e=e.map(function(c,d){return d>=e.length-2?lA(e[d]):e[d]})).length===1&&(e=[2,e[0]])),e.length!==2){var r=wu(e);e=r.newShape}var i=dt(e);if(e.length<=1&&i<=a)return[1,i];if(e.length===2&&e[0]<=a&&e[1]<=a)return e;if(e.length===3&&e[0]*e[1]<=a&&e[2]<=a)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=a&&e[1]*e[2]<=a)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=a&&e[3]<=a)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=a&&e[1]*e[2]*e[3]<=a)return[e[0],e[1]*e[2]*e[3]];if(t){var s=T0(e),o=2,u=2;return e.length&&(o=(n=L0(e))[0],u=n[1]),Ly(i=s*(o/2)*(u/2)).map(function(c){return 2*c})}return Ly(i)}function tg(e){return e%2==0}function ng(e,t){if(Ia(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],a=t.slice(-1)[0];if(n===a||tg(n)&&tg(a)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&tg(e[0])&&tg(t[0])}function fI(e){if(Ub==null){var t=$s(e);Ub=t.getParameter(t.MAX_TEXTURE_SIZE)}return Ub}function pI(e){if(qb==null){var t=$s(e);qb=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,qb)}function mI(e){if(e===0)return 0;var t=$s(e);return zi(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:zi(t,"EXT_disjoint_timer_query")?1:0}function zi(e,t){return e.getExtension(t)!=null}function N4(e){try{if($s(e)!=null)return!0}catch{return!1}return!1}function gI(e){if(e===0)return!1;var t=$s(e);if(e===1){if(!zi(t,"OES_texture_float"))return!1}else if(!zi(t,"EXT_color_buffer_float"))return!1;return By(t)}function vI(e){if(e===0)return!1;var t=$s(e);if(e!==1){if(zi(t,"EXT_color_buffer_float"))return By(t);if(zi(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(a,r){var i=Uw(a,r),s=a.createTexture();a.bindTexture(a.TEXTURE_2D,s),a.texImage2D(a.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var o=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,o),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,s,0);var u=a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE;return a.bindTexture(a.TEXTURE_2D,null),a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteTexture(s),a.deleteFramebuffer(o),u}(t,n)}return!1}return!!zi(t,"OES_texture_float")&&!!zi(t,"WEBGL_color_buffer_float")&&By(t)}function By(e){var t=Uw(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var r=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),r}function xI(e){return e===2&&$s(e).fenceSync!=null}var _t=Be();function vA(e){Be().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function st(e,t){return ye.tidy(e,t)}function Br(e){mA(e).forEach(function(t){return t.dispose()})}function bI(e){return ye.keep(e)}function P0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Be().getBool("IS_TEST")||console.warn.apply(console,e)}function Yl(e,t){var n=e;if(Fs(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||Fs(n)&&t!=="string";)a.push(n.length),n=n[0];return Array.isArray(e)&&Be().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function r(i,s,o){if(o=o||[],!Array.isArray(i)&&!Fs(i))return void se(s.length===0,function(){return"Element arr["+o.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"});se(s.length>0,function(){return"Element arr["+o.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),se(i.length===s[0],function(){return"Element arr["+o.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var u=s.slice(1),c=0;c<i.length;++c)r(i[c],u,o.concat(c))}(e,a,[]),a}function k4(e,t,n,a){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+a+"' must be "+e+" tensor, but got "+t+" tensor")}function te(e,t,n,a){if(a===void 0&&(a="numeric"),e instanceof zn)return k4(a,e.dtype,t,n),e;var r=Pp(e);if(r!=="string"&&["bool","int32","float32"].indexOf(a)>=0&&(r=a),k4(a,r,t,n),e==null||!Fs(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var s=Yl(e,r);Fs(e)||Array.isArray(e)||(e=[e]);var o=r!=="string"?cA(e,r,Be().getBool("DEBUG")):$d(e,[],!0);return ye.makeTensor(o,s,r)}function R0(e,t,n,a){if(a===void 0&&(a="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(r,i){return te(r,t+"["+i+"]",n)},a)}function xA(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function yI(e,t,n){for(var a=e.length+t.length,r=[],i=0,s=0,o=0;o<a;o++)n.indexOf(o)===-1?r.push(e[i++]):r.push(t[s++]);return r}function ar(e,t){for(var n=[],a=e.length,r=0;r<a;r++)t.indexOf(r)===-1&&n.push(e[r]);return[n,t.map(function(i){return e[i]})]}function Ur(e,t){return yI(e,t.map(function(n){return 1}),t)}function ri(e,t,n){se(xA(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Ks(e,t){if(xA(e,t))return null;for(var n=[],a=0;a<t;++a)e.indexOf(a)===-1&&n.push(a);return e.forEach(function(r){return n.push(r)}),n}function qw(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Ys(e,t){for(var n=[],a=t-e;a<t;++a)n.push(a);return n}function wI(e,t){var n=e[0].length;e.forEach(function(r,i){se(r.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),se(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var a=e[0];e.forEach(function(r,i){for(var s=0;s<n;s++)se(s===t||r[s]===a[s],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+r+") does not match the shape of the rest ("+a+") along the non-concatenated axis "+i+"."})})}function Yd(e,t){for(var n=e[0].slice(),a=1;a<e.length;a++)n[t]+=e[a][t];return n}function de(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var r=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];ye.startScope(n);try{var o=a.apply(void 0,i);return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),ye.endScope(o),o}catch(u){throw ye.endScope(null),u}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}_t.registerFlag("HAS_WEBGL",function(){return _t.getNumber("WEBGL_VERSION")>0}),_t.registerFlag("WEBGL_VERSION",function(){return N4(2)?2:N4(1)?1:0}),_t.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return _t.get("WEBGL_VERSION")===2}),_t.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),_t.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),_t.registerFlag("WEBGL_PACK",function(){return _t.getBool("HAS_WEBGL")}),_t.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_PACK_CLIP",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),_t.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_PACK_REDUCE",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_LAZILY_UNPACK",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_CONV_IM2COL",function(){return _t.getBool("WEBGL_PACK")}),_t.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return fI(_t.getNumber("WEBGL_VERSION"))}),_t.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return pI(_t.getNumber("WEBGL_VERSION"))}),_t.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=_t.getNumber("WEBGL_VERSION");return e===0?0:mI(e)}),_t.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return _t.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),_t.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return gI(_t.getNumber("WEBGL_VERSION"))}),_t.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!_t.getBool("WEBGL_FORCE_F16_TEXTURES")&&_t.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),_t.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return vI(_t.getNumber("WEBGL_VERSION"))}),_t.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return xI(_t.getNumber("WEBGL_VERSION"))}),_t.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return _t.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),pA=vA;var Va=de({complex_:function(e,t){var n=te(e,"real","complex"),a=te(t,"imag","complex");return sn(n.shape,a.shape,"real and imag shapes, "+n.shape+" and "+a.shape+", must match in call to tf.complex()."),ye.runKernelFunc(function(r){return r.complex(n,a)},{$real:n,$imag:a})}}),Fi=de({real_:function(e){var t=te(e,"input","real");return ye.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Es=de({imag_:function(e){var t=te(e,"input","imag");return ye.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function $a(e,t,n){return Xl(e,t,Yl(e,n),n)}function Xl(e,t,n,a){if(a==null&&(a=Pp(e)),a==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Fs(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){hA(t);var r=dt(t),i=dt(n);se(r===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+r+" values but has "+i});for(var s=0;s<n.length;++s){var o=n[s],u=s!==n.length-1||o!==dt(t.slice(s));se(n[s]===t[s]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Fs(e)||Array.isArray(e)||(e=[e]),t=t||n,e=a!=="string"?cA(e,a,Be().getBool("DEBUG")):$d(e,[],!0),ye.makeTensor(e,t,a)}function at(e,t){if((Fs(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Fs(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Xl(e,[],[],t)}function ha(e,t){ch(e);var n=Yl(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Xl(e,null,n,t)}function Rl(e,t,n){if(ch(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var a=Yl(e,n);if(a.length!==2&&a.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Xl(e,t,a,n)}function Ww(e,t,n){if(ch(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var a=Yl(e,n);if(a.length!==3&&a.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Xl(e,t,a,n)}function Or(e,t,n){if(ch(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var a=Yl(e,n);if(a.length!==4&&a.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Xl(e,t,a,n)}function NI(e,t,n){if(ch(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var a=Yl(e,n);if(a.length!==5&&a.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Xl(e,t,a,n)}function kI(e,t,n){if(ch(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var a=Yl(e,n);if(a.length!==6&&a.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(a.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Xl(e,t=t||a,a,n)}function SI(e,t,n,a){return t===void 0&&(t=!0),ye.makeVariable(e,t,n,a)}function dh(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=dh(e,"float32"),a=An(e,"float32");return Va(n,a)}var r=dA(dt(e),t);return ye.makeTensor(r,e,t)}function An(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=An(e,"float32"),a=An(e,"float32");return Va(n,a)}var r=Rp(dt(e),t);return ye.makeTensor(r,e,t)}function zs(e,t,n){return ye.runKernelFunc(function(a){return a.fill(e,t,n)},{})}function _I(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return ye.runKernelFunc(function(a){return a.linspace(e,t,n)},{})}function M0(e,t,n,a){if(n===void 0&&(n=1),a===void 0&&(a="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return An([0],a);var r=Rp(Math.abs(Math.ceil((t-e)/n)),a);t<e&&n===1&&(n=-1),r[0]=e;for(var i=1;i<r.length;i++)r[i]=r[i-1]+n;return ha(r,a)}var bA=de({onesLike_:function(e){var t=te(e,"x","onesLike");if(t.dtype==="complex64"){var n=bA(Fi(t)),a=Yt(Es(t));return Va(n,a)}return ye.runKernelFunc(function(r){return r.onesLike(t)},{$x:t},function(r,i){return{$x:function(){return Yt(r)}}})}}),Yt=de({zerosLike_:function(e){var t=te(e,"x","zerosLike");return ye.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,a){return{$x:function(){return Yt(n)}}})}}),Na=de({concat_:function(e,t){t===void 0&&(t=0),se(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=R0(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(o){if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+o.dtype+". ")}),t=Ca(t,n[0].shape)[0];var a=Yd(n.map(function(o){return o.shape}),t);if(dt(a)===0)return $a([],a);if((n=n.filter(function(o){return o.size>0})).length===1)return n[0];var r=n.map(function(o){return o.shape});wI(r,t);var i=n,s={axis:t};return ye.runKernelFunc(function(o){return o.concat(n,t)},i,function(o){var u=r.map(function(c){return c[t]});return Hw(o,u,t).map(function(c){return function(){return c}})},"Concat",s)}}),jI=de({concat1d_:function(e){return Na(e,0)}}),CI=de({concat2d_:function(e,t){return Na(e,t)}}),AI=de({concat3d_:function(e,t){return Na(e,t)}}),EI=de({concat4d_:function(e,t){return Na(e,t)}}),Hw=de({split_:function(e,t,n){n===void 0&&(n=0);var a,r=te(e,"x","split");return n=Ca(n,r.shape)[0],typeof t=="number"?(se(r.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),a=new Array(t).fill(r.shape[n]/t)):(se(r.shape[n]===t.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),a=t),ye.runKernelFunc(function(i){return i.split(r,a,n)},{$x:r},function(i){return{$x:function(){return Na(i,n)}}})}});function nc(e,t){return e(t={exports:{}},t.exports),t.exports}var DI=nc(function(e){(function(t,n,a){function r(o){var u,c=this,d=(u=4022871197,function(h){h=h.toString();for(var p=0;p<h.length;p++){var f=.02519603282416938*(u+=h.charCodeAt(p));f-=u=f>>>0,u=(f*=u)>>>0,u+=4294967296*(f-=u)}return 23283064365386963e-26*(u>>>0)});c.next=function(){var h=2091639*c.s0+23283064365386963e-26*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=0|h)},c.c=1,c.s0=d(" "),c.s1=d(" "),c.s2=d(" "),c.s0-=d(o),c.s0<0&&(c.s0+=1),c.s1-=d(o),c.s1<0&&(c.s1+=1),c.s2-=d(o),c.s2<0&&(c.s2+=1),d=null}function i(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function s(o,u){var c=new r(o),d=u&&u.state,h=c.next;return h.int32=function(){return 4294967296*c.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.alea=s})(0,e)}),TI=nc(function(e){(function(t,n,a){function r(o){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var h=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^h^h>>>8},o===(0|o)?u.x=o:c+=o;for(var d=0;d<c.length+64;d++)u.x^=0|c.charCodeAt(d),u.next()}function i(o,u){return u.x=o.x,u.y=o.y,u.z=o.z,u.w=o.w,u}function s(o,u){var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xor128=s})(0,e)}),LI=nc(function(e){(function(t,n,a){function r(o){var u=this,c="";u.next=function(){var h=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^h^h<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,o===(0|o)?u.x=o:c+=o;for(var d=0;d<c.length+64;d++)u.x^=0|c.charCodeAt(d),d==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(o,u){return u.x=o.x,u.y=o.y,u.z=o.z,u.w=o.w,u.v=o.v,u.d=o.d,u}function s(o,u){var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xorwow=s})(0,e)}),PI=nc(function(e){(function(t,n,a){function r(o){var u=this;u.next=function(){var c,d,h=u.x,p=u.i;return c=h[p],d=(c^=c>>>7)^c<<24,d^=(c=h[p+1&7])^c>>>10,d^=(c=h[p+3&7])^c>>>3,d^=(c=h[p+4&7])^c<<7,c=h[p+7&7],d^=(c^=c<<13)^c<<9,h[p]=d,u.i=p+1&7,d},function(c,d){var h,p=[];if(d===(0|d))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[7&h]=p[7&h]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],c.x=p,c.i=0,h=256;h>0;--h)c.next()}(u,o)}function i(o,u){return u.x=o.x.slice(),u.i=o.i,u}function s(o,u){o==null&&(o=+new Date);var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(d.x&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xorshift7=s})(0,e)}),RI=nc(function(e){(function(t,n,a){function r(o){var u=this;u.next=function(){var c,d,h=u.w,p=u.X,f=u.i;return u.w=h=h+1640531527|0,d=p[f+34&127],c=p[f=f+1&127],d^=d<<13,c^=c<<17,d^=d>>>15,c^=c>>>12,d=p[f]=d^c,u.i=f,d+(h^h>>>16)|0},function(c,d){var h,p,f,g,b,w=[],m=128;for(d===(0|d)?(p=d,d=null):(d+="\0",p=0,m=Math.max(m,d.length)),f=0,g=-32;g<m;++g)d&&(p^=d.charCodeAt((g+32)%d.length)),g===0&&(b=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,g>=0&&(b=b+1640531527|0,f=(h=w[127&g]^=p+b)==0?f+1:0);for(f>=128&&(w[127&(d&&d.length||0)]=-1),f=127,g=512;g>0;--g)p=w[f+34&127],h=w[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,w[f]=p^h;c.w=b,c.X=w,c.i=f}(u,o)}function i(o,u){return u.i=o.i,u.w=o.w,u.X=o.X.slice(),u}function s(o,u){o==null&&(o=+new Date);var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(d.X&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.xor4096=s})(0,e)}),MI=nc(function(e){(function(t,n,a){function r(o){var u=this,c="";u.next=function(){var h=u.b,p=u.c,f=u.d,g=u.a;return h=h<<25^h>>>7^p,p=p-f|0,f=f<<24^f>>>8^g,g=g-h|0,u.b=h=h<<20^h>>>12^p,u.c=p=p-f|0,u.d=f<<16^p>>>16^g,u.a=g-h|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,o===Math.floor(o)?(u.a=o/4294967296|0,u.b=0|o):c+=o;for(var d=0;d<c.length+20;d++)u.b^=0|c.charCodeAt(d),u.next()}function i(o,u){return u.a=o.a,u.b=o.b,u.c=o.c,u.d=o.d,u}function s(o,u){var c=new r(o),d=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=s:this.tychei=s})(0,e)}),xu=nc(function(e){(function(t,n){var a,r=this,i=256,s=6,o="random",u=n.pow(i,s),c=n.pow(2,52),d=2*c,h=i-1;function p(m,x,y){var N=[],S=b(function A(L,P){var j,E=[],F=typeof L;if(P&&F=="object")for(j in L)try{E.push(A(L[j],P-1))}catch{}return E.length?E:F=="string"?L:L+"\0"}((x=x==1?{entropy:!0}:x||{}).entropy?[m,w(t)]:m??function(){try{var A;return a&&(A=a.randomBytes)?A=A(i):(A=new Uint8Array(i),(r.crypto||r.msCrypto).getRandomValues(A)),w(A)}catch{var L=r.navigator,P=L&&L.plugins;return[+new Date,r,P,r.screen,w(t)]}}(),3),N),D=new f(N),_=function(){for(var A=D.g(s),L=u,P=0;A<c;)A=(A+P)*i,L*=i,P=D.g(1);for(;A>=d;)A/=2,L/=2,P>>>=1;return(A+P)/L};return _.int32=function(){return 0|D.g(4)},_.quick=function(){return D.g(4)/4294967296},_.double=_,b(w(D.S),t),(x.pass||y||function(A,L,P,j){return j&&(j.S&&g(j,D),A.state=function(){return g(D,{})}),P?(n[o]=A,L):A})(_,S,"global"in x?x.global:this==n,x.state)}function f(m){var x,y=m.length,N=this,S=0,D=N.i=N.j=0,_=N.S=[];for(y||(m=[y++]);S<i;)_[S]=S++;for(S=0;S<i;S++)_[S]=_[D=h&D+m[S%y]+(x=_[S])],_[D]=x;(N.g=function(A){for(var L,P=0,j=N.i,E=N.j,F=N.S;A--;)L=F[j=h&j+1],P=P*i+F[h&(F[j]=F[E=h&E+L])+(F[E]=L)];return N.i=j,N.j=E,P})(i)}function g(m,x){return x.i=m.i,x.j=m.j,x.S=m.S.slice(),x}function b(m,x){for(var y,N=m+"",S=0;S<N.length;)x[h&S]=h&(y^=19*x[h&S])+N.charCodeAt(S++);return w(x)}function w(m){return String.fromCharCode.apply(0,m)}if(n["seed"+o]=p,b(n.random(),t),e.exports){e.exports=p;try{a=require("crypto")}catch{}}})([],Math)});xu.alea=DI,xu.xor128=TI,xu.xorwow=LI,xu.xorshift7=PI,xu.xor4096=RI,xu.tychei=MI;var Ov=xu.alea,Vw=function(){function e(t,n,a,r,i){this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=Ov(s.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,a,r=!1;!r;){var i=void 0,s=void 0,o=void 0;do o=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s;while(o>=1||o===0);var u=Math.sqrt(-2*Math.log(o)/o);n=this.mean+this.stdDev*i*u,a=this.mean+this.stdDev*s*u,this.truncated&&!this.isValidTruncated(n)||(r=!0)}return this.truncated&&!this.isValidTruncated(a)||(this.nextVal=this.convertValue(a)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),OI=function(){function e(t,n,a,r){this.alpha=t,this.beta=1/n,this.dtype=a;var i=r||Math.random();this.randu=Ov(i.toString()),this.randn=new Vw(0,1,a,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,a,r,i,s;;){do r=this.randn.nextValue(),s=1+this.c*r;while(s<=0);if(s*=s*s,n=1-.331*(t=r*r)*t,a=.5*t+this.d*(1-s+Math.log(s)),(i=this.randu())<n||Math.log(i)<a)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),II=function(){function e(t,n,a,r){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=a,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Ov(r)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Et(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",hA(e),new Jf(e,t,n)}function FI(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var yA=de({batchToSpaceND_:function(e,t,n){var a=te(e,"x","batchToSpaceND"),r=t.reduce(function(i,s){return i*s});return se(a.rank>=1+t.length,function(){return"input rank is "+a.rank+" but should be > than blockShape.length "+t.length}),se(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),se(a.shape[0]%r==0,function(){return"input tensor batch is "+a.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+r}),ye.runKernelFunc(function(i){return i.batchToSpaceND(a,t,n)},{$x:a},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),BI=de({broadcastTo_:function(e,t){var n=te(e,"broadcastTo","x"),a=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var r=n.shape.slice();r.length<t.length;)r.unshift(1);n=n.reshape(r)}for(var i=Array.from(t),s=t.length-1;s>=0;s--)if(n.shape[s]===t[s])i[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+a+"] cannot be broadcast to ["+t+"].");var o=i.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return o.length===0?n.clone():ye.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(o,!0)}}})}}),zI=de({cast_:function(e,t){var n=te(e,"x","cast");if(!LO(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var a={dtype:t};return ye.runKernelFunc(function(r){return r.cast(n,t)},{x:n},function(r){return{x:function(){return r.clone()}}},"Cast",a)}}),UI=de({clone_:function(e){var t=te(e,"x","clone",null);return ye.runKernelFunc(function(){return ye.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),qI=de({cumsum_:function(e,t,n,a){t===void 0&&(t=0),n===void 0&&(n=!1),a===void 0&&(a=!1);var r=te(e,"x","cumsum"),i=Ks([t|=0],r.rank),s=r;i!=null&&(s=r.transpose(i));var o=Ys(1,r.rank)[0],u=ye.runKernelFunc(function(c){return c.cumsum(s,o,n,a)},{permutedX:s},function(c){return{permutedX:function(){return c.cumsum(t,n,!a)}}});return i!=null&&(u=u.transpose(i)),u}}),WI=de({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var a=te(e,"x","depthToSpace"),r=n==="NHWC"?a.shape[1]:a.shape[2],i=n==="NHWC"?a.shape[2]:a.shape[3],s=n==="NHWC"?a.shape[3]:a.shape[1];return se(r*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+r+" and "+t+`  for depthToSpace with input shape
      `+a.shape}),se(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+a.shape}),se(s%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+a.shape}),ye.runKernelFunc(function(o){return o.depthToSpace(a,t,n)},{$x:a})}}),Mi=de({expandDims_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","expandDims",null);se(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var a=n.shape.slice();return t<0&&(se(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),a.splice(t,0,1),is(n,a)}}),wA=de({eye_:function(e,t,n,a){a===void 0&&(a="float32"),t==null&&(t=e);for(var r=Et([e,t],a),i=e<=t?e:t,s=0;s<i;++s)r.set(1,s,s);var o=r.toTensor().as2D(e,t);if(n==null)return o;if(n.length===1)return _d(Mi(o,0),[n[0],1,1]);if(n.length===2)return _d(Mi(Mi(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return _d(Mi(Mi(Mi(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),HI=de({multinomial_:function(e,t,n,a){a===void 0&&(a=!1);var r=te(e,"logits","multinomial"),i=r.size,s=r.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);n=n||Math.random();var o=s===1?r.as2D(1,-1):r,u=ye.runKernelFunc(function(c){return c.multinomial(o,a,t,n)},{logits2D:o});return s===1?u.as1D():u}}),zy=de({oneHot_:function(e,t,n,a){if(n===void 0&&(n=1),a===void 0&&(a=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var r=te(e,"indices","oneHot","int32"),i=r.shape.concat([t]);return r=r.flatten(),ye.runKernelFunc(function(s){return s.oneHot(r,t,n,a)},{$indices:r},function(s){return{$indices:function(){return An(r.shape,"float32")}}}).reshape(i)}}),ac=de({pad_:function(e,t,n){n===void 0&&(n=0);var a=te(e,"x","pad");if(a.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var r={paddings:t,constantValue:n};return ye.runKernelFunc(function(i){return i.pad(a,t,n)},{x:a},function(i){var s=t.map(function(o){return o[0]});return{x:function(){return i.slice(s,a.shape)}}},"PadV2",r)}}),VI=de({pad1d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),ac(e,[t],n)}}),GI=de({pad2d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ac(e,t,n)}}),$I=de({pad3d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ac(e,t,n)}}),KI=de({pad4d_:function(e,t,n){return n===void 0&&(n=0),se(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ac(e,t,n)}}),YI=de({rand_:function(e,t,n){var a=dt(e),r=null;if(n==null||n==="float32")r=new Float32Array(a);else if(n==="int32")r=new Int32Array(a);else{if(n!=="bool")throw new Error("Unknown data type "+n);r=new Uint8Array(a)}for(var i=0;i<a;i++)r[i]=t();return ye.makeTensor(r,e,n)}}),XI=de({randomNormal_:function(e,t,n,a,r){if(t===void 0&&(t=0),n===void 0&&(n=1),a!=null&&a==="bool")throw new Error("Unsupported data type "+a);for(var i=new Vw(t,n,a,!1,r),s=Et(e,a),o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),JI=de({randomGamma_:function(e,t,n,a,r){if(n===void 0&&(n=1),a===void 0&&(a="float32"),n==null&&(n=1),a==null&&(a="float32"),a!=="float32"&&a!=="int32")throw new Error("Unsupported data type "+a);for(var i=new OI(t,n,a,r),s=Et(e,a),o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),NA=de({randomUniform_:function(e,t,n,a,r){t===void 0&&(t=0),n===void 0&&(n=1),a===void 0&&(a="float32");for(var i=Et(e,a),s=new II(t,n,null,r),o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}}),is=de({reshape_:function(e,t){var n=te(e,"x","reshape",null);t=DO(t,n.size),se(n.size===dt(t),function(){return"new shape and old shape must have the same number of elements."});var a={shape:t};return ye.runKernelFunc(function(r){return r.reshape(n,t)},{x:n},function(r){return{x:function(){return r.reshape(n.shape)}}},"Reshape",a)}}),kA=de({spaceToBatchND_:function(e,t,n){var a=te(e,"x","spaceToBatchND");return se(a.rank>=1+t.length,function(){return"input rank "+a.rank+" should be > than [blockShape] "+t.length}),se(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),se(a.shape.reduce(function(r,i,s){return s>0&&s<=t.length?r&&(i+n[s-1][0]+n[s-1][1])%t[s-1]==0:r},!0),function(){return"input spatial dimensions "+a.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),ye.runKernelFunc(function(r){return r.spaceToBatchND(a,t,n)},{$x:a},function(r){return{$x:function(){return r.batchToSpaceND(t,n)}}})}}),SA=de({squeeze_:function(e,t){var n=te(e,"x","squeeze");return is(n,wu(n.shape,t).newShape)}}),gi=de({stack_:function(e,t){t===void 0&&(t=0);var n=R0(e,"tensors","stack");if(se(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var a=n[0].rank,r=n[0].shape,i=n[0].dtype;se(t<=a,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(o){sn(r,o.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(o){se(i===o.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=n.map(function(o){return o.expandDims(t)});return Na(s,t)}}),_d=de({tile_:function(e,t){var n=te(e,"x","tile",null);se(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var a=[n],r={reps:t};return ye.runKernelFunc(function(i,s){var o=i.tile(n,t);return s([n]),o},{x:n},function(i,s){var o=s[0];return{x:function(){var u=Yt(o);if(o.rank===1)for(var c=0;c<t[0];++c)u=u.add(i.slice([c*o.shape[0]],[o.shape[0]]));else if(o.rank===2)for(c=0;c<t[0];++c)for(var d=0;d<t[1];++d)u=u.add(i.slice([c*o.shape[0],d*o.shape[1]],[o.shape[0],o.shape[1]]));else if(o.rank===3)for(c=0;c<t[0];++c)for(d=0;d<t[1];++d)for(var h=0;h<t[2];++h)u=u.add(i.slice([c*o.shape[0],d*o.shape[1],h*o.shape[2]],[o.shape[0],o.shape[1],o.shape[2]]));else{if(o.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+o.rank+" tensors yet.");for(c=0;c<t[0];++c)for(d=0;d<t[1];++d)for(h=0;h<t[2];++h)for(var p=0;p<t[3];++p)u=u.add(i.slice([c*o.shape[0],d*o.shape[1],h*o.shape[2],p*o.shape[3]],[o.shape[0],o.shape[1],o.shape[2],o.shape[3]]))}return u}}},"Tile",r,a)}}),QI=de({truncatedNormal_:function(e,t,n,a,r){if(t===void 0&&(t=0),n===void 0&&(n=1),a!=null&&a==="bool")throw new Error("Unsupported data type "+a);for(var i=new Vw(t,n,a,!0,r),s=Et(e,a),o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),ka=de({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=te(e,"x","unstack");se(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var a={axis:t};return ye.runKernelFunc(function(r){return r.unstack(n,t)},{x:n},function(r){return{x:function(){return gi(r,t)}}},"Unpack",a)}}),ZI=function(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h;return ut(this,function(p){switch(p.label){case 0:return n=te(e,"x","setdiff1d"),a=te(t,"y","setdiff1d"),se(n.dtype===a.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+a.dtype+")."}),se(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),se(a.rank===1,function(){return"y should be 1D tensor, but got y ("+a.shape+")."}),[4,n.data()];case 1:return r=p.sent(),[4,a.data()];case 2:for(i=p.sent(),s=new Set(i),o=0,d=0;d<r.length;d++)s.has(r[d])||o++;for(u=new Jf([o],n.dtype),c=new Jf([o],"int32"),d=0,h=0;d<r.length;d++)s.has(r[d])||(u.values[h]=r[d],c.values[h]=d,h++);return[2,[u.toTensor(),c.toTensor()]]}})})};function O0(e,t,n,a){a===void 0&&(a=!0);var r=[];if(a)(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);for(var i=t.length,s=0;s<i;++s)r=r.concat([e[s+1]/t[s],t[s]]);r=r.concat(e.slice(i+1))}return r}function I0(e,t,n){n===void 0&&(n=!0);var a=[];if(n){a.push(t);for(var r=t+1;r<e;++r)r<=2*t?(a.push(r),a.push(r-(t+1))):a.push(r)}else{var i=[],s=[];for(r=1;r<e;++r)r>=2*t+1||r%2==1?s.push(r):i.push(r);a.push.apply(a,i),a.push(0),a.push.apply(a,s)}return a}function F0(e,t,n,a){a===void 0&&(a=!0);var r=[];a?r.push(e[0]/n):r.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?a?r.push(t[i-1]*e[i]):r.push(e[i]/t[i-1]):r.push(e[i]);return r}function _A(e,t){for(var n=[0],a=0;a<t;++a)n.push(e[a][0]);return n}function jA(e,t,n){for(var a=e.slice(0,1),r=0;r<n;++r)a.push(e[r+1]-t[r][0]-t[r][1]);return a}function CA(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,a=n[n.length-1],r=1,i=0;i<n.length-1;++i)r*=n[i];var s=e.shape,o=n.slice();o.pop();var u=1;for(i=a;i<e.rank;++i)u*=s[i],o.push(s[i]);var c=Bs(e.shape).map(function(d){return d/u}).concat([1]).slice(0,a);return[o,r,u,c]}var AA=30;function Gb(e){return e<=AA?e:Ry(e,Math.floor(Math.sqrt(e)))}function e7(e,t,n){var a=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+a+", and batchDim: "+r+".";if(n.rank<r)throw new Error(i+" update.rank < "+r+". ");if(e.length<a+(n.rank-r))throw new Error(i+" Output shape length < "+(a+(n.rank-r)));if(n.rank!==r+e.length-a)throw new Error(i+" update.rank != "+(r+e.length-a));for(var s=0;s<r;++s)if(n.shape[s]!==t.shape[s])throw new Error(i+" updates.shape["+s+"] ("+n.shape[s]+") != indices.shape["+s+"] ("+t.shape[s]+").");for(s=0;s<n.rank-r;++s)if(n.shape[s+r]!==e[s+a])throw new Error(i+" updates.shape["+(s+r)+"] ("+n.shape[s+r]+") != shape["+(s+r)+"] ("+e[s+r]+")")}function t7(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}e7(n,t,e)}function B0(e,t,n){for(var a=t.shape.length,r=a>1?t.shape[a-1]:1,i=n.length,s=1,o=r;o<i;++o)s*=n[o];var u=r<1?1:r;return{sliceRank:r,numUpdates:dt(t.shape)/u,sliceSize:s,strides:Bs(n.slice(0,r)).concat([1]),outputSize:dt(n)}}function n7(e,t,n){se(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),se(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var a=function(i){se(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},r=0;r<e.rank;++r)a(r)}function S4(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Gw(e,t,n){for(var a=[],r=0;r<e.length;r++)a[r]=Math.ceil((t[r]-e[r])/n[r]);return a}function a7(e,t,n,a,r){var i=t[r],s=n[r]||1;(e&1<<r||i==null)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var o=a[r];return i<0&&(i+=o),i=Ty(0,i,o-1)}function r7(e,t,n,a,r){var i=t[r],s=n[r]||1;(e&1<<r||i==null)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var o=a[r];return i<0&&(i+=o),i=s>0?Ty(0,i,o):Ty(-1,i,o-1)}function EA(e,t,n){for(var a=n.length,r=0;r<n.length;r++)if(n[r]>1){a=r;break}for(r=a+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function DA(e,t){for(var n=e.length>0?e[e.length-1]:1,a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}function i7(e,t){se(Py(e),function(){return"The f passed in variableGrads(f) must be a function"}),se(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof Kd}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var a in t=[],ye.registeredVariables)t.push(ye.registeredVariables[a]);var r=n?t.filter(function(d){return!d.trainable}):null,i=t.length;se((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=ye.gradients(e,t,null,!0),o=s.value,u=s.grads;se(u.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),se(o.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+o.rank+" tensor"});var c={};return t.forEach(function(d,h){u[h]!=null&&(c[d.name]=u[h])}),r!=null&&r.forEach(function(d){return c[d.name]=null}),{value:o,grads:c}}function Iv(e){return ye.customGrad(e)}var Lo=de({softmax_:function(e,t){t===void 0&&(t=-1);var n=te(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return ye.runKernelFunc(function(a,r){var i=a.softmax(n,t);return r([i]),i},{logits:n},function(a,r){var i=r[0],s=a.mul(i);return{logits:function(){return s.sub(s.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),s7=de({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=te(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Iv(function(a,r){var i=a.max(t,!0),s=a.sub(i),o=s.toFloat().sub(s.exp().sum(t,!0).log());return r([o]),{value:o,gradFunc:function(u,c){var d=c[0].exp();return u.sub(u.sum(t,!0).mul(d))}}})(n)}}),TA=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),LA=function(){function e(){}return e.prototype.time=function(t){return Le("time")},e.prototype.read=function(t){return Le("read")},e.prototype.readSync=function(t){return Le("readSync")},e.prototype.numDataIds=function(){return Le("numDataIds")},e.prototype.disposeData=function(t){return Le("disposeData")},e.prototype.write=function(t,n,a){return Le("write")},e.prototype.move=function(t,n,a,r){return Le("move")},e.prototype.memory=function(){return Le("memory")},e.prototype.floatPrecision=function(){return Le("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,a,r){return Le("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,Le("fusedBatchMatMul")},e.prototype.slice=function(t,n,a){return Le("slice")},e.prototype.stridedSlice=function(t,n,a,r){return Le("stridedSlice")},e.prototype.unstack=function(t,n){return Le("unstack")},e.prototype.reverse=function(t,n){return Le("reverse")},e.prototype.concat=function(t,n){return Le("concat")},e.prototype.neg=function(t){return Le("neg")},e.prototype.add=function(t,n){return Le("add")},e.prototype.addN=function(t){return Le("addN")},e.prototype.subtract=function(t,n){return Le("subtract")},e.prototype.multiply=function(t,n){return Le("multiply")},e.prototype.realDivide=function(t,n){return Le("realDivide")},e.prototype.floorDiv=function(t,n){return Le("floorDiv")},e.prototype.sum=function(t,n){return Le("sum")},e.prototype.prod=function(t,n){return Le("prod")},e.prototype.unsortedSegmentSum=function(t,n,a){return Le("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return Le("argMin")},e.prototype.argMax=function(t,n){return Le("argMax")},e.prototype.equal=function(t,n){return Le("equal")},e.prototype.notEqual=function(t,n){return Le("notEqual")},e.prototype.less=function(t,n){return Le("less")},e.prototype.lessEqual=function(t,n){return Le("lessEqual")},e.prototype.greater=function(t,n){return Le("greater")},e.prototype.greaterEqual=function(t,n){return Le("greaterEqual")},e.prototype.logicalNot=function(t){return Le("logicalNot")},e.prototype.logicalAnd=function(t,n){return Le("logicalAnd")},e.prototype.logicalOr=function(t,n){return Le("logicalOr")},e.prototype.where=function(t){return Le("where")},e.prototype.select=function(t,n,a){return Le("select")},e.prototype.topk=function(t,n,a){return Le("topk")},e.prototype.min=function(t,n){return Le("min")},e.prototype.minimum=function(t,n){return Le("minimum")},e.prototype.mod=function(t,n){return Le("mod")},e.prototype.max=function(t,n){return Le("max")},e.prototype.maximum=function(t,n){return Le("maximum")},e.prototype.all=function(t,n){return Le("all")},e.prototype.any=function(t,n){return Le("any")},e.prototype.squaredDifference=function(t,n){return Le("squaredDifference")},e.prototype.ceil=function(t){return Le("ceil")},e.prototype.floor=function(t){return Le("floor")},e.prototype.round=function(t){return Le("round")},e.prototype.sign=function(t){return Le("sign")},e.prototype.isNaN=function(t){return Le("isNaN")},e.prototype.isInf=function(t){return Le("isInf")},e.prototype.isFinite=function(t){return Le("isFinite")},e.prototype.pow=function(t,n){return Le("pow")},e.prototype.exp=function(t){return Le("exp")},e.prototype.expm1=function(t){return Le("expm1")},e.prototype.softmax=function(t,n){return Le("softmax")},e.prototype.log=function(t){return Le("log")},e.prototype.log1p=function(t){return Le("log1p")},e.prototype.sqrt=function(t){return Le("sqrt")},e.prototype.rsqrt=function(t){return Le("rsqrt")},e.prototype.square=function(t){return Le("square")},e.prototype.reciprocal=function(t){return Le("reciprocal")},e.prototype.relu=function(t){return Le("relu")},e.prototype.relu6=function(t){return Le("relu6")},e.prototype.prelu=function(t,n){return Le("prelu")},e.prototype.elu=function(t){return Le("elu")},e.prototype.eluDer=function(t,n){return Le("eluDer")},e.prototype.selu=function(t){return Le("selu")},e.prototype.int=function(t){return Le("int")},e.prototype.clip=function(t,n,a){return Le("clip")},e.prototype.abs=function(t){return Le("abs")},e.prototype.complexAbs=function(t){return Le("complexAbs")},e.prototype.sigmoid=function(t){return Le("sigmoid")},e.prototype.softplus=function(t){return Le("softplus")},e.prototype.sin=function(t){return Le("sin")},e.prototype.cos=function(t){return Le("cos")},e.prototype.tan=function(t){return Le("tan")},e.prototype.asin=function(t){return Le("asin")},e.prototype.acos=function(t){return Le("acos")},e.prototype.atan=function(t){return Le("atan")},e.prototype.atan2=function(t,n){return Le("atan2")},e.prototype.sinh=function(t){return Le("sinh")},e.prototype.cosh=function(t){return Le("cosh")},e.prototype.tanh=function(t){return Le("tanh")},e.prototype.asinh=function(t){return Le("asinh")},e.prototype.acosh=function(t){return Le("acosh")},e.prototype.atanh=function(t){return Le("atanh")},e.prototype.erf=function(t){return Le("erf")},e.prototype.step=function(t,n){return Le("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Le("fusedConv2d")},e.prototype.conv2d=function(t,n,a){return Le("conv2d")},e.prototype.conv2dDerInput=function(t,n,a){return Le("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,a){return Le("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Le("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,a){return Le("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,a){return Le("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,a){return Le("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,a){return Le("conv3d")},e.prototype.conv3dDerInput=function(t,n,a){return Le("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,a){return Le("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return Le("maxPool")},e.prototype.maxPoolBackprop=function(t,n,a,r){return Le("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return Le("avgPool")},e.prototype.avgPoolBackprop=function(t,n,a){return Le("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return Le("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,a){return Le("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return Le("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,a,r){return Le("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return Le("reshape")},e.prototype.cast=function(t,n){return Le("cast")},e.prototype.tile=function(t,n){return Le("tile")},e.prototype.pad=function(t,n,a){return Le("pad")},e.prototype.transpose=function(t,n){return Le("transpose")},e.prototype.gather=function(t,n,a){return Le("gather")},e.prototype.gatherND=function(t,n){return Le("gatherND")},e.prototype.scatterND=function(t,n,a){return Le("scatterND")},e.prototype.batchToSpaceND=function(t,n,a){return Le("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,a){return Le("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,a,r){return Le("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,a){return Le("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,a,r){return Le("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,a){return Le("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,a,r,i,s){return Le("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,a,r,i){return Le("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,a,r,i,s,o){return Le("LRNGrad")},e.prototype.multinomial=function(t,n,a,r){return Le("multinomial")},e.prototype.oneHot=function(t,n,a,r){return Le("oneHot")},e.prototype.cumsum=function(t,n,a,r){return Le("cumsum")},e.prototype.nonMaxSuppression=function(t,n,a,r,i){return Le("nonMaxSuppression")},e.prototype.fft=function(t){return Le("fft")},e.prototype.ifft=function(t){return Le("ifft")},e.prototype.complex=function(t,n){return Le("complex")},e.prototype.real=function(t){return Le("real")},e.prototype.imag=function(t){return Le("imag")},e.prototype.cropAndResize=function(t,n,a,r,i,s){return Le("cropAndResize")},e.prototype.depthToSpace=function(t,n,a){return Le("depthToSpace")},e.prototype.split=function(t,n,a){return Le("split")},e.prototype.sparseToDense=function(t,n,a,r){return Le("sparseToDense")},e.prototype.diag=function(t){return Le("diag")},e.prototype.fill=function(t,n,a){return Le("fill")},e.prototype.onesLike=function(t){return Le("onesLike")},e.prototype.zerosLike=function(t){return Le("zerosLike")},e.prototype.linspace=function(t,n,a){return Le("linspace")},e.prototype.dispose=function(){return Le("dispose")},e}();function Le(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Nl(e,t){for(var n=e.length,a=[],r=0;r<n;r++){var i=n-1-r,s=e[i]||1;(t[t.length-1-r]||1)>1&&s===1&&a.unshift(i)}return a}function _a(e,t){for(var n=[],a=0;a<t.length;a++){var r=e[e.length-a-1],i=t.length-a-1,s=t[i];(r==null||r===1&&s>1)&&n.unshift(i)}return n}function zt(e,t){for(var n=[],a=Math.max(e.length,t.length),r=0;r<a;r++){var i=e[e.length-r-1];i==null&&(i=1);var s=t[t.length-r-1];if(s==null&&(s=1),i===1)n.unshift(s);else if(s===1)n.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Zf(e,t,n,a,r,i,s){s===void 0&&(s="channelsLast");var o,u=q0(t),c=u[0],d=u[1];if(s==="channelsLast")o=[c,d,e[3],e[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);o=[c,d,e[1],e[1]]}return rc(e,o,n,a,r,i,!1,s)}function z0(e,t,n,a,r,i,s){s===void 0&&(s="NDHWC");var o,u,c=Uy(t),d=c[0],h=c[1],p=c[2];if(s==="NDHWC")u="channelsLast",o=[d,h,p,e[4],e[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);u="channelsFirst",o=[d,h,p,e[1],e[1]]}return U0(e,o,n,a,r,!1,u,i)}function rc(e,t,n,a,r,i,s,o){s===void 0&&(s=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1],c=u[0],d=u[1],h=u[2],p=u[3];if(o==="channelsLast")c=e[0],d=e[1],h=e[2],p=e[3];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);c=e[0],p=e[1],d=e[2],h=e[3]}var f,g=t[0],b=t[1],w=t[3],m=q0(n),x=m[0],y=m[1],N=q0(a),S=N[0],D=N[1],_=jd(g,S),A=jd(b,D),L=function(z,U,O,B,q,I,K,Z){var R,H,$;if(typeof z=="number"){R={top:z,bottom:z,left:z,right:z,type:z===0?"VALID":"NUMBER"};var X=function(ge,Ee,Te,fe,me){fe==null&&(fe=PA(ge,Ee,Te));var ne=ge[0],De=ge[1],Oe=Cf((ne-Ee+2*fe)/Te+1,me);se(sa(Oe),function(){return"The output # of rows ("+Oe+") must be an integer. Change the stride and/or zero pad parameters"});var ke=Cf((De-Ee+2*fe)/Te+1,me);return se(sa(ke),function(){return"The output # of columns ("+ke+") must be an integer. Change the stride and/or zero pad parameters"}),[Oe,ke]}([U,O],I,B,z,Z);H=X[0],$=X[1]}else if(z==="same"){H=Math.ceil(U/B),$=Math.ceil(O/q);var W=Math.max(0,(H-1)*B+I-U),ie=Math.max(0,($-1)*q+K-O),ce=Math.floor(W/2),ue=W-ce,he=Math.floor(ie/2);R={top:ce,bottom:ue,left:he,right:ie-he,type:"SAME"}}else{if(z!=="valid")throw Error("Unknown padding parameter: "+z);R={top:0,bottom:0,left:0,right:0,type:"VALID"},H=Math.ceil((U-I+1)/B),$=Math.ceil((O-K+1)/q)}return{padInfo:R,outHeight:H,outWidth:$}}(r,d,h,x,y,_,A,i),P=L.padInfo,j=L.outHeight,E=L.outWidth,F=s?w*p:w;return o==="channelsFirst"?f=[c,F,j,E]:o==="channelsLast"&&(f=[c,j,E,F]),{batchSize:c,dataFormat:o,inHeight:d,inWidth:h,inChannels:p,outHeight:j,outWidth:E,outChannels:F,padInfo:P,strideHeight:x,strideWidth:y,filterHeight:g,filterWidth:b,effectiveFilterHeight:_,effectiveFilterWidth:A,dilationHeight:S,dilationWidth:D,inShape:e,outShape:f,filterShape:t}}function U0(e,t,n,a,r,i,s,o){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],d=u[1],h=u[2],p=u[3],f=u[4];if(s==="channelsLast")c=e[0],d=e[1],h=e[2],p=e[3],f=e[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);c=e[0],f=e[1],d=e[2],h=e[3],p=e[4]}var g,b=t[0],w=t[1],m=t[2],x=t[4],y=Uy(n),N=y[0],S=y[1],D=y[2],_=Uy(a),A=_[0],L=_[1],P=_[2],j=jd(b,A),E=jd(w,L),F=jd(m,P),z=function(K,Z,R,H,$,X,W,ie,ce,ue,he){var ge,Ee,Te,fe;if(typeof K=="number"){ge={top:K,bottom:K,left:K,right:K,front:K,back:K,type:K===0?"VALID":"NUMBER"};var me=function(Qe,Ze,Je,le,Xe,We){Xe==null&&(Xe=PA(Qe,Ze,le));var et=Qe[0],Ke=Qe[1],Ht=Qe[2],xt=Cf((et-Ze+2*Xe)/le+1,We);se(sa(xt),function(){return"The output # of depths ("+xt+") must be an integer. Change the stride and/or zero pad parameters"});var Xn=Cf((Ke-Ze+2*Xe)/le+1,We);se(sa(Xn),function(){return"The output # of rows ("+Xn+") must be an integer. Change the stride and/or zero pad parameters"});var Mt=Cf((Ht-Ze+2*Xe)/le+1,We);return se(sa(Mt),function(){return"The output # of columns ("+Mt+") must be an integer. Change the stride and/or zero pad parameters"}),[xt,Xn,Mt,Je]}([Z,R,H,1],ie,1,$,K,he);Ee=me[0],Te=me[1],fe=me[2]}else if(K==="same"){Ee=Math.ceil(Z/$),Te=Math.ceil(R/X),fe=Math.ceil(H/W);var ne=(Ee-1)*$+ie-Z,De=(Te-1)*X+ce-R,Oe=(fe-1)*W+ue-H,ke=Math.floor(ne/2),xe=ne-ke,Ae=Math.floor(De/2),Ce=De-Ae,He=Math.floor(Oe/2);ge={top:Ae,bottom:Ce,left:He,right:Oe-He,front:ke,back:xe,type:"SAME"}}else{if(K!=="valid")throw Error("Unknown padding parameter: "+K);ge={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ee=Math.ceil((Z-ie+1)/$),Te=Math.ceil((R-ce+1)/X),fe=Math.ceil((H-ue+1)/W)}return{padInfo:ge,outDepth:Ee,outHeight:Te,outWidth:fe}}(r,d,h,p,N,S,D,j,E,F,o),U=z.padInfo,O=z.outDepth,B=z.outHeight,q=z.outWidth,I=i?x*f:x;return s==="channelsFirst"?g=[c,I,O,B,q]:s==="channelsLast"&&(g=[c,O,B,q,I]),{batchSize:c,dataFormat:s,inDepth:d,inHeight:h,inWidth:p,inChannels:f,outDepth:O,outHeight:B,outWidth:q,outChannels:I,padInfo:U,strideDepth:N,strideHeight:S,strideWidth:D,filterDepth:b,filterHeight:w,filterWidth:m,effectiveFilterDepth:j,effectiveFilterHeight:E,effectiveFilterWidth:F,dilationDepth:A,dilationHeight:L,dilationWidth:P,inShape:e,outShape:g,filterShape:t}}function PA(e,t,n,a){a===void 0&&(a=1);var r=jd(t,a);return Math.floor((e[0]*(n-1)-n+r)/2)}function q0(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Uy(e){return typeof e=="number"?[e,e,e]:e}function jd(e,t){return t<=1?e:e+(e-1)*(t-1)}function Cf(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Xd(e){var t=q0(e),n=t[0],a=t[1],r=t[2];return n===1&&a===1&&r===1}function qr(e,t){return Xd(e)||Xd(t)}function $w(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function RA(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var a=An(e.shape),r=e.toFloat(),i=n.complex(r,a);return a.dispose(),r.dispose(),i}if(!PO(e.dtype,t))return ye.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var s=n.real(e);return i=s.cast(t),s.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var o=at(0,e.dtype);return i=n.notEqual(e,o),o.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function qy(e,t){return ye.makeTensorFromDataId(e.dataId,t,e.dtype)}function MA(e,t,n){var a=(t-e)/(n-1),r=Rp(n,"float32");r[0]=e;for(var i=1;i<r.length;i++)r[i]=r[i-1]+a;return ha(r,"float32")}function Wy(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function _4(e,t){return{real:e[2*t],imag:e[2*t+1]}}function o7(e,t,n,a){e[2*a]=t,e[2*a+1]=n}function l7(e,t,n){var a=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(a),imag:Math.sin(a)}}function u7(e,t,n){var a=function(i,s,o){return function(u,c,d){for(var h=0,p=u.length,f=0,g=!1;h<p;){var b=d(c,u[f=h+(p-h>>>1)]);b>0?h=f+1:(p=f,g=!b)}return g?h:-h-1}(i,s,o||c7)}(e,t,n),r=a<0?-(a+1):a;e.splice(r,0,t)}function c7(e,t){return e>t?1:e<t?-1:0}function Kw(e,t,n,a,r){return OA(e,t,n,a,r,0).selectedIndices}function Yw(e,t,n,a,r,i){var s=OA(e,t,n,a,r,i);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function OA(e,t,n,a,r,i,s,o){o===void 0&&(o=!1);for(var u=Array.from(t).map(function(N,S){return{score:N,boxIndex:S,suppressBeginIndex:0}}).filter(function(N){return N.score>r}).sort(j4),c=i>0?-.5/i:0,d=[],h=[];d.length<n&&u.length>0;){var p=u.pop(),f=p.score,g=p.boxIndex,b=p.suppressBeginIndex;if(f<r)break;for(var w=!1,m=d.length-1;m>=b;--m){var x=d7(e,g,d[m]);if(x>=a){w=!0;break}if(p.score=p.score*h7(a,c,x),p.score<=r)break}p.suppressBeginIndex=d.length,w||(p.score===f?(d.push(g),h.push(p.score)):p.score>r&&u7(u,p,j4))}var y=d.length;return o&&(d.fill(0,y),h.fill(0,y)),{selectedIndices:ha(d,"int32"),selectedScores:ha(h,"float32"),numValidOutputs:at(y,"int32")}}function d7(e,t,n){var a=e.subarray(4*t,4*t+4),r=e.subarray(4*n,4*n+4),i=Math.min(a[0],a[2]),s=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),u=Math.max(a[1],a[3]),c=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),f=(o-i)*(u-s),g=(h-c)*(p-d);if(f<=0||g<=0)return 0;var b=Math.max(i,c),w=Math.max(s,d),m=Math.min(o,h),x=Math.min(u,p),y=Math.max(m-b,0)*Math.max(x-w,0);return y/(f+g-y)}function h7(e,t,n){var a=Math.exp(t*n*n);return n<=e?a:0}function j4(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function IA(e,t,n){var a=new Array(e.rank).fill(0),r=e.shape.slice();return t.map(function(i){r[n]=i;var s=e.slice(a,r);return a[n]+=i,s})}function FA(e,t){for(var n=new Array(e.rank),a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];var r=Et(n,e.dtype);for(a=0;a<r.values.length;++a){for(var i=r.indexToLoc(a),s=new Array(e.rank),o=0;o<s.length;o++)s[o]=i[o]%e.shape[o];var u=e.locToIndex(s);r.values[a]=e.values[u]}return r.toTensor()}function BA(e,t,n,a,r){for(var i=t[t.length-1],s=[e.length/i,i],o=s[0],u=s[1],c=Xf(n,o*a),d=Xf("int32",o*a),h=0;h<o;h++){for(var p=h*u,f=e.subarray(p,p+u),g=[],b=0;b<f.length;b++)g.push({value:f[b],index:b});g.sort(function(N,S){return S.value-N.value});var w=h*a,m=c.subarray(w,w+a),x=d.subarray(w,w+a);for(b=0;b<a;b++)m[b]=g[b].value,x[b]=g[b].index}var y=t.slice();return y[y.length-1]=a,[$a(c,y,n),$a(d,y,"int32")]}function Xw(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);var r=Et(e,"int32"),i=Et([n.length,e.length],"int32");for(a=0;a<n.length;a++){var s=r.indexToLoc(n[a]),o=a*e.length;i.values.set(s,o)}return i.toTensor()}var f7=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(r,i){return"T"+i});var n=[];this.variableNames.forEach(function(r){n.push("float v"+r+" = get"+r+"AtOutCoords();")});var a=this.variableNames.map(function(r){return"v"+r}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+a+`;
        setOutput(result);
      }
    `},p7=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(r,i){return"T"+i});var n=[];this.variableNames.forEach(function(r){n.push("vec4 v"+r+" = get"+r+"AtOutCoords();")});var a=this.variableNames.map(function(r){return"v"+r}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+a+`;
        setOutput(result);
      }
    `},m7=function(e,t,n){this.variableNames=["A"];var a=e.windowSize,r=e.batchSize,i=e.inSize,s=Math.ceil(i/a);n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,s];var o=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+a+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+a+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+o+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function zA(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function Ir(e,t){return t===1?[e]:zA(e,t)}function ir(){var e,t,n,a,r,i,s,o,u,c;return Be().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",a="in",r="texture",i="outputColor",s="out vec4 outputColor;",o=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",a="varying",r="texture2D",i="gl_FragColor",s="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:r,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:u,defineRound:c}}function Nu(e,t,n){n===void 0&&(n="index");var a=Bs(t);return a.map(function(r,i){return"int "+e[i]+" = "+n+" / "+r+"; "+(i===a.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+r:"index -= "+e[i]+" * "+r)+";"}).join("")}function Jw(e){var t=Bs(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var UA=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function g7(e,t,n,a){var r=[];e.forEach(function(f){var g=dt(f.shapeInfo.logicalShape);f.shapeInfo.isUniform?r.push("uniform float "+f.name+(g>1?"["+g+"]":"")+";"):(r.push("uniform sampler2D "+f.name+";"),r.push("uniform int offset"+f.name+";"))});var i,s,o=r.join(`
`),u=e.map(function(f){return function(g,b,w){w===void 0&&(w=!1);var m="";m+=w?qA(g):$c(g);var x=g.shapeInfo.logicalShape,y=b.logicalShape;return x.length<=y.length&&(m+=w?function(N,S){var D,_=N.name,A=_.charAt(0).toUpperCase()+_.slice(1),L="get"+A+"AtOutCoords",P=N.shapeInfo.logicalShape.length,j=S.logicalShape.length,E=Nl(N.shapeInfo.logicalShape,S.logicalShape),F=jn(j),z=j-P,U=["x","y","z","w","u","v"];D=P===0?"":j<2&&E.length>=1?"coords = 0;":E.map(function(R){return"coords."+U[R+z]+" = 0;"}).join(`
`);var O="";O=j<2&&P>0?"coords":N.shapeInfo.logicalShape.map(function(R,H){return"coords."+U[H+z]}).join(", ");var B="return outputValue;",q=dt(N.shapeInfo.logicalShape)===1,I=dt(S.logicalShape)===1;if(P!==1||q||I){if(q&&!I)B=j===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(E.length){var K=P-2,Z=P-1;E.indexOf(K)>-1&&E.indexOf(Z)>-1?B="return vec4(outputValue.x);":E.indexOf(K)>-1?B="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":E.indexOf(Z)>-1&&(B="return vec4(outputValue.xx, outputValue.zz);")}}else B=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+L+`() {
      `+F+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+A+"("+O+`);
      `+B+`
    }
  `}(g,b):function(N,S){var D=N.name,_=D.charAt(0).toUpperCase()+D.slice(1),A="get"+_+"AtOutCoords",L=S.texShape,P=N.shapeInfo.texShape,j=N.shapeInfo.logicalShape.length,E=S.logicalShape.length;if(!N.shapeInfo.isUniform&&j===E&&N.shapeInfo.flatOffset==null&&Ia(P,L))return`
      float `+A+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var F,z=jn(E),U=Nl(N.shapeInfo.logicalShape,S.logicalShape),O=E-j,B=["x","y","z","w","u","v"];F=j===0?"":E<2&&U.length>=1?"coords = 0;":U.map(function(I){return"coords."+B[I+O]+" = 0;"}).join(`
`);var q="";return q=E<2&&j>0?"coords":N.shapeInfo.logicalShape.map(function(I,K){return"coords."+B[K+O]}).join(", "),`
    float `+A+`() {
      `+z+` coords = getOutputCoords();
      `+F+`
      return get`+_+"("+q+`);
    }
  `}(g,b)),m}(f,t,a)}).join(`
`),c=t.texShape,d=ir(),h=function(f){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+f.texture2D+`(textureSampler, uv).r;
    }
  `}(d),p=function(f){return f.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+f.varyingFs+` vec2 resultUV;
    `+f.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+f.defineSpecialNaN+`
    `+f.defineSpecialInf+`
    `+f.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+v7+`
    `+x7+`
    `+b7+`
  `}(d);return t.isPacked?(i=function(f,g){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(N,S){var D=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `}(0,g);case 2:return function(N,S){var D=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];if(Ia(N,S))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var _=Math.ceil(N[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec2(r, c);
    }
  `}(f,g);case 3:return b=f,w=g,m=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],x=Math.ceil(b[2]/2),y=x*Math.ceil(b[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+y+`;
      index -= b * `+y+`;

      int r = 2 * (index / `+x+`);
      int c = imod(index, `+x+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(N,S){for(var D=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],_=Math.ceil(N[N.length-1]/2),A=_*Math.ceil(N[N.length-2]/2),L=A,P="",j="b, r, c",E=2;E<N.length-1;E++)L*=N[N.length-E-1],P=`
      int b`+E+" = index / "+L+`;
      index -= b`+E+" * "+L+`;
    `+P,j="b"+E+", "+j;return`
    ivec`+N.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+P+`

      int b = index / `+A+`;
      index -= b * `+A+`;

      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec`+N.length+"("+j+`);
    }
  `}(f,g)}var b,w,m,x,y}(t.logicalShape,c),s=function(f){return`
    void setOutput(vec4 val) {
      `+f.output+` = val;
    }
  `}(d)):(i=function(f,g){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,x){return x[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+x[1]+`.0);
      }
    `:x[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+x[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      return resTexRC.x * `+x[1]+` + resTexRC.y;
    }
  `}(0,g);case 2:return function(m,x){return Ia(m,x)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+x[0]+", "+x[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(f,g);case 3:return b=g,w=Nu(["r","c","d"],f),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      `+w+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,x){var y=Nu(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      `+y+`
      return ivec4(r, c, d, d2);
    }
  `}(f,g);case 5:return function(m,x){var y=Nu(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+x[0]+`,
                             `+x[1]+`));

      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+y+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(f,g);case 6:return function(m,x){var y=Nu(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+y+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(f,g);default:throw new Error(f.length+"-D output sampling is not yet supported")}var b,w}(t.logicalShape,c),s=function(f){return`
    void setOutput(float val) {
      `+f.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),a&&(p+=y7),[p,h,s,o,i,u,n].join(`
`)}function $c(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var a=n.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1);if(n.shapeInfo.isUniform)return"float "+r+"() {return "+a+";}";var i=n.shapeInfo.texShape,s=i[0],o=i[1];if(s===1&&o===1)return`
      float `+r+`() {
        return sampleTexture(`+a+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,c=u[0],d=u[1],h=fu(a);return`
    float `+r+`() {
      vec2 uv = uvFromFlat(`+c+", "+d+", "+h+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 1:return function(n){var a=n.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1);if(n.shapeInfo.isUniform)return`
      float `+r+`(int index) {
        `+Ic(n)+`
      }
    `;var i=n.shapeInfo.texShape,s=i[0],o=i[1];if(o===1&&s===1)return`
      float `+r+`(int index) {
        return sampleTexture(`+a+`, halfCR);
      }
    `;var u=fu(a);return o===1?`
      float `+r+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+s+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `:s===1?`
      float `+r+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+o+`.0, 0.5);
        return sampleTexture(`+a+`, uv);
      }
    `:`
    float `+r+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+o+", index + "+u+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 2:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape;if(s!=null&&Ia(a,s)){var o=s[0],u=s[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+o+`.0);
      return sampleTexture(`+r+`, uv);
    }
  `}var c=wu(a),d=c.newShape,h=c.keptDims,p=d;if(p.length<a.length){var f=Kc(n,p);return`
      `+$c(f)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Yc(["row","col"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+a[1]+`, 1)));
        `+Ic(n)+`
      }
    `;var g=s[0],b=s[1],w=fu(r);return b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+a[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+g+`.0);
      return sampleTexture(`+r+`, uv);
    }
  `:g===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+a[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+b+`.0, 0.5);
      return sampleTexture(`+r+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+a[1]+" + col + "+w+`;
    vec2 uv = uvFromFlat(`+g+", "+b+`, index);
    return sampleTexture(`+r+`, uv);
  }
`}(e);case 3:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[1]*a[2],o=a[2],u=wu(a),c=u.newShape,d=u.keptDims,h=c;if(h.length<a.length){var p=Kc(n,h);return`
        `+$c(p)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Yc(["row","col","depth"],d)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+o+`, 1)));
        `+Ic(n)+`
      }
    `;var f=n.shapeInfo.texShape,g=f[0],b=f[1],w=n.shapeInfo.flatOffset;if(b===s&&w==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+o+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+b+".0, "+g+`.0);
          return sampleTexture(`+r+`, uv);
        }
      `;if(b===o&&w==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+a[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+b+".0, "+g+`.0);
      return sampleTexture(`+r+`, uv);
    }
  `;var m=fu(r);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+o+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+g+", "+b+`, index);
        return sampleTexture(`+r+`, uv);
      }
  `}(e);case 4:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[3],o=a[2]*s,u=a[1]*o,c=wu(a),d=c.newShape,h=c.keptDims;if(d.length<a.length){var p=Kc(n,d);return`
      `+$c(p)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Yc(["row","col","depth","depth2"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+o+", "+s+`, 1)));
        `+Ic(n)+`
      }
    `;var f=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,b=g[0],w=g[1];if(w===u&&f==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+o+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+b+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;if(w===s&&f==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+a[1]*a[2]+", "+a[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+b+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;var m=fu(r);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+o+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+b+", "+w+", index + "+m+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 5:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[4],o=a[3]*s,u=a[2]*o,c=a[1]*u,d=wu(a),h=d.newShape,p=d.keptDims;if(h.length<a.length){var f=Kc(n,h);return`
      `+$c(f)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Yc(["row","col","depth","depth2","depth3"],p)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+c+", "+u+", "+o+", "+s+`)) +
          depth3;
        `+Ic(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,b=n.shapeInfo.texShape,w=b[0],m=b[1];if(m===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+o+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+w+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;if(m===s&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+a[1]*a[2]*a[3]+`,
               `+a[2]*a[3]+", "+a[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+w+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;var x=fu(r);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+u+" + depth * "+o+` +
          depth2 * `+s+" + depth3 + "+x+`;
      vec2 uv = uvFromFlat(`+w+", "+m+`, index);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 6:return function(n){var a=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=wu(a),o=s.newShape,u=s.keptDims;if(o.length<a.length){var c=Kc(n,o);return`
      `+$c(c)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Yc(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var d=a[5],h=a[4]*d,p=a[3]*h,f=a[2]*p,g=a[1]*f;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+g+", "+f+", "+p+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+Ic(n)+`
      }
    `;var b=n.shapeInfo.flatOffset,w=n.shapeInfo.texShape,m=w[0],x=w[1];if(x===g&&b==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+f+", "+p+", "+h+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;if(x===d&&b==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+a[1]*a[2]*a[3]*a[4]+`,
               `+a[2]*a[3]*a[4]+`,
               `+a[3]*a[4]+`,
               `+a[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `;var y=fu(r);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+g+" + col * "+f+" + depth * "+p+` +
          depth2 * `+h+" + depth3 * "+d+" + depth4 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+x+`, index);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function qA(e){var t,n,a;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=ir(),`
    vec4 `+n+`() {
      return `+a.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(r){var i=r.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r.shapeInfo.texShape,u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=ir();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+c.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(r){var i=r.shapeInfo.logicalShape,s=r.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),u=r.shapeInfo.texShape,c=u[0],d=u[1],h=ir();if(u!=null&&Ia(i,u))return`
      vec4 `+o+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+c+`.0);

        return `+h.texture2D+"("+s+`, uv);
      }
    `;var p=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],f=Math.ceil(i[1]/2);return`
    vec4 `+o+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+f+", "+p[0]+", "+p[1]+`, row, col);
      return `+h.texture2D+"("+s+`, uv);
    }
  `}(e);case 3:return function(r){var i=r.shapeInfo.logicalShape,s=r.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),u=r.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var d=i.slice(1),h=Kc(r,d);return`
        `+qA(h)+`
        vec4 `+o+`(int b, int row, int col) {
          return `+o+"("+Yc(["b","row","col"],[1,2])+`);
        }
      `}var p=c[0],f=c[1],g=Math.ceil(i[2]/2),b=g*Math.ceil(i[1]/2),w=ir();return`
    vec4 `+o+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+p+", "+f+", "+b+", "+g+`, b, row, col);
      return `+w.texture2D+"("+s+`, uv);
    }
  `}(e);default:return function(r){for(var i=r.shapeInfo.logicalShape,s=i.length,o=r.name,u="get"+o.charAt(0).toUpperCase()+o.slice(1),c=r.shapeInfo.texShape,d=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],h=d[0],p=d[1],f=Math.ceil(i[s-1]/2),g=f*Math.ceil(i[s-2]/2),b="int b, int row, int col",w="b * "+g+" + (row / 2) * "+f+" + (col / 2)",m=2;m<s-1;m++)b="int b"+m+", "+b,g*=i[s-m-1],w="b"+m+" * "+g+" + "+w;var x=ir();return`
    vec4 `+u+"("+b+`) {
      int index = `+w+`;
      int texR = index / `+p+`;
      int texC = index - texR * `+p+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+", "+h+`);
      return `+x.texture2D+"("+o+`, uv);
    }
  `}(e)}}var v7=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,x7=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,b7=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,y7=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function fu(e){return"offset"+e}function Ic(e){var t=e.name,n=dt(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function jn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Kc(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Yc(e,t){return t.map(function(n){return e[n]}).join(", ")}var w7=function(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,se(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var r=e[e.length-1],i=Math.ceil(r/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");var s,o,u=this.outputShape,c=u.length,d=jn(c),h=Ir("coords",c);if(i===1){var p=jn(o=c+1);s=`
        `+p+" sourceLocR = "+p+"("+h.join()+`, 0);
        ++`+h[c-1]+`;
        `+p+" sourceLocG = "+p+"("+h.join()+`, 0);
        ++`+h[c-2]+`;
        `+p+" sourceLocA = "+p+"("+h.join()+`, 0);
        --`+h[c-1]+`;
        `+p+" sourceLocB = "+p+"("+h.join()+`, 0);
        --`+h[c-2]+";"}else o=c,s=`
        `+d+` sourceLocR = coords;
        ++`+h[c-1]+`;
        `+d+` sourceLocG = coords;
        ++`+h[c-2]+`;
        `+d+` sourceLocA = coords;
        --`+h[c-1]+`;
        `+d+` sourceLocB = coords;
        --`+h[c-2]+";";var f=["x","y","z","w","u","v"].slice(0,o),g="."+f[o-1],b=f.map(function(A){return"int "+A}),w=Ir("sourceLocR",o-1).concat("inIdx.r"),m=Ir("sourceLocG",o-1).concat("inIdx.g"),x=Ir("sourceLocB",o-1).concat("inIdx.b"),y=Ir("sourceLocA",o-1).concat("inIdx.a"),N=n==="max"?"greaterThan":"lessThan",S=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+y.join()+")));",D=`vec4(
            getAChannel(`+w.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+y.join()+") : 0.)",_=a?"":`
      float getBestIndicesAChannel(`+b.join()+`) {
        return getChannel(getBestIndicesA(`+f.join()+`),
                                          vec2(`+f.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+b.join()+`) {
        return getChannel(getA(`+f.join()+`),
                               vec2(`+f.slice(-2).join()+`));
      }
      `+_+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+h[c-1]+" < "+(u[c-1]-1)+`;
        bool hasNextRow = `+h[c-2]+" < "+(u[c-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+g+", sourceLocG"+g+`,
          sourceLocB`+g+", sourceLocA"+g+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+S+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+N+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},N7=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=o-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+a+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},k7=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=d-1-e.padInfo.front,g=h-1-e.padInfo.top,b=p-1-e.padInfo.left,w=1/(t*n*a);this.userCode=`
      const ivec3 pads = ivec3(`+f+", "+g+", "+b+`);
      const float avgMultiplier = float(`+w+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+r+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+p+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},S7=function(e,t,n,a,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],zt(e,t),zt(e,n);var s="0.0";a!=null&&(zt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var o="1.0";r!=null&&(zt(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+o+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},_7=function(e,t,n,a,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],zt(e,t),zt(e,n);var s="vec4(0.0)";a!=null&&(zt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var o="vec4(1.0)";r!=null&&(zt(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+o+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},j7="return areal * breal - aimag * bimag;",C7="return areal * bimag + aimag * breal;",C4=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=zt(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},$b="return a + b;",Kb="return a - b;",A4="return a * b;",WA="return (a < 0.) ? b * a : a;",Gn=function(e,t,n){this.variableNames=["A","B"],this.outputShape=zt(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},HA=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,fo=function(e,t,n,a){a===void 0&&(a=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=zt(t,n);var r=this.outputShape.length,i="";if(a)if(r===0||dt(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+jn(r)+` coords = getOutputCoords();
        `,r===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=Ir("coords",r);i+=`
            bool nextRowOutOfBounds =
              (`+s[r-2]+" + 1) >= "+this.outputShape[r-2]+`;
            bool nextColOutOfBounds =
              (`+s[r-1]+" + 1) >= "+this.outputShape[r-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},A7=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var a=this;return function(r,i){a.minLoc==null&&(a.minLoc=r.getUniformLocationNoThrow(i,"minVal"),a.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(a.minLoc,t),r.gl.uniform1f(a.maxLoc,n)}},e}(),E7=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var a=this;return function(r,i){a.minLoc==null&&(a.minLoc=r.getUniformLocationNoThrow(i,"minVal"),a.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(a.minLoc,t),r.gl.uniform1f(a.maxLoc,n)}},e}(),D7=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},T7=function(e){this.outputShape=[],this.outputShape=Yd(e,1),this.variableNames=e.map(function(o,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var a=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var r=t[n-1];a.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+r+"));")}var i=t.length,s=t[t.length-1];a.push("else setOutput(getT"+i+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+a.join(`
        `)+`
      }
    `},L7=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Yd(e,t);var n=this.outputShape,a=n.length,r=jn(a),i=Ir("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map(function(w,m){return"T"+m});var o=new Array(e.length-1);o[0]=e[0][t];for(var u=1;u<o.length;u++)o[u]=o[u-1]+e[u][t];var c=s[t],d=s.slice(-2),h=s.join(),p="if ("+c+" < "+o[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+d.join()+`));
        }`;for(u=1;u<o.length;u++){var f=o[u-1];p+=`
        if (`+c+" < "+o[u]+"  && "+c+" >= "+o[u-1]+`) {
          return getChannel(
            getT`+u+"("+ag(s,c,f)+`),
            vec2(`+ag(d,c,f)+`));
        }`}var g=o.length,b=o[o.length-1];p+=`
        return getChannel(
          getT`+g+"("+ag(s,c,b)+`),
          vec2(`+ag(d,c,b)+"));",this.userCode=`
      float getValue(`+s.map(function(w){return"int "+w})+`) {
        `+p+`
      }

      void main() {
        `+r+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[a-1]+" = "+i[a-1]+` + 1;
        if (`+i[a-1]+" < "+n[a-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[a-2]+" = "+i[a-2]+` + 1;
        if (`+i[a-2]+" < "+n[a-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[a-1]+" = "+i[a-1]+` - 1;
        if (`+i[a-2]+" < "+n[a-2]+` &&
            `+i[a-1]+" < "+n[a-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function ag(e,t,n){var a=e.indexOf(t);return e.map(function(r,i){return i===a?r+" - "+n:r}).join()}var P7=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+a+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+r+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},R7=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dataFormat==="channelsLast",s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+c+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+a+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},M7=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+r+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+a+" - "+s+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},O7=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+o+", "+u+", "+c+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+r+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+a+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+a+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},I7=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+a+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+r+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},F7=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+a+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+o+`; dm++) {
              int d2 = d1 * `+o+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},E4=function(e,t,n,a){t===void 0&&(t=!1),n===void 0&&(n=null),a===void 0&&(a=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var r=e.padInfo.top,i=e.padInfo.left,s=e.strideHeight,o=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,g=e.dataFormat==="channelsLast",b=g?1:2,w=g?2:3,m=g?3:1,x="",y="";n&&(x=a?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,y="result = activation(result);");var N=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+s+", "+o+`);
      const ivec2 pads = ivec2(`+r+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+b+"], coords["+w+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+c+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+p+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+g+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(f===1)+`) {

              if (`+g+`) {
                dotProd +=
                    getX(batch, xR, xC, `+p+`) *
                    getW(wR, wC, `+p+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+p+`, xR, xC) *
                    getW(wR, wC, `+p+`, d2);
              }

            } else if (`+(f===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2)
              );

              if (`+g+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(f===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2),
                getW(wR, wC, `+p+` + 2, d2)
              );

              if (`+g+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1),
                  getX(batch, xR, xC, `+p+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC),
                  getX(batch, `+p+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+N+`
        `+y+`
        setOutput(result);
      }
    `},B7=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=4*Math.floor(e.inChannels/4),g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+r+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+a+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+o+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+p+`; wC++) {
              int xC = xCCorner + wC * `+c+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+f+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(g===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+f+`) *
                  getW(wF, wR, wC, `+f+`, d2);
              } else if (`+(g===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(g===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1),
                  getX(batch, xF, xR, xC, `+f+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2),
                  getW(wF, wR, wC, `+f+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},D4=function(e,t,n,a){t===void 0&&(t=!1),n===void 0&&(n=null),a===void 0&&(a=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var r=e.inHeight,i=e.inWidth,s=e.padInfo.top,o=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=e.outChannels/e.inChannels,b="",w="";n&&(b=a?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,w="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+g+`;
        int q = d2 - d1 * `+g+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+p+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+r+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+w+`
        setOutput(result);
      }
    `},T4=function(e,t,n,a){t===void 0&&(t=!1),n===void 0&&(n=null),a===void 0&&(a=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var r=e.inHeight,i=e.inWidth,s=e.padInfo.top,o=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=f,b="int xR; int xC; int xCOffset;",w=0;w<p;w++)for(var m=0;m<f;m++)b+=`
          vec4 xTexelR`+w+"C"+2*m+` = vec4(0.);
          vec4 wR`+w+"C"+m+` = vec4(0.);
          vec4 xR`+w+"C"+m+" = vec4(0.);";for(w=0;w<p;w++)for(var x=0;x<g;x++){if(b+=`
          xR = xRCorner + `+w*d+`;
          xC = xCCorner + `+(m=2*x)*h+`;
        `,c===1){if(m<f&&(b+=o%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+r+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+w+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+r+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+w+"C"+m+" = vec4(previous.zw, xTexelR"+w+"C"+m+`.xy);
                } else {
                  xR`+w+"C"+m+" = vec4(0, 0, xTexelR"+w+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+r+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                xR`+w+"C"+m+" = xTexelR"+w+"C"+m+`;
              `,m+1<f)){var y=o%2==0?lA(h):h;h%2==0&&o%2==1||h%2!=0&&o%2!=1?(b+=`
                  xCOffset = xC + `+o%2+" + "+y+`;

                  if(xR >= 0 && xR < `+r+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(b+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+r+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+w+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+w+"C"+m+` = vec4(0.);
                    }
                  `),b+=`
                  xR`+w+"C"+(m+1)+` = vec4(
                    xTexelR`+w+"C"+m+".zw, xTexelR"+w+"C"+(m+2)+`.xy);
                `):b+=`
                  xCOffset = xC + `+y+`;

                  if(xR >= 0 && xR < `+r+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+w+"C"+(m+1)+" = xTexelR"+w+"C"+(m+2)+`;
                `}}else m<f&&(b+=`
              if(xR >= 0 && xR < `+r+`) {
            `,o%2==1?(b+=`
                xCOffset = xC + 1 - `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+w+"C"+(m+2)+` = vec4(0.);
                }

                xR`+w+"C"+m+` = vec4(
                  xTexelR`+w+"C"+m+".zw, xTexelR"+w+"C"+(m+2)+`.zw);
              `,m+1<f&&(b+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+c+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+w+"C"+(m+1)+" = vec4(xTexelR"+w+"C"+(m+2)+`.xy, final.xy);
                `)):(b+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+w+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+c+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+w+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+(m+2)+` = vec4(0.);
                }

                xR`+w+"C"+m+` = vec4(
                  xTexelR`+w+"C"+m+".xy, xTexelR"+w+"C"+(m+2)+`.xy);
              `,m+1<f&&(b+=`
                  xR`+w+"C"+(m+1)+` = vec4(
                    xTexelR`+w+"C"+m+".zw, xTexelR"+w+"C"+(m+2)+`.zw);
                `)),b+="}");m<f&&(b+=`
            vec4 wTexelR`+w+"C"+m+" = getW("+w+", "+m+`, d1, q);
            wR`+w+"C"+m+" = vec4(wTexelR"+w+"C"+m+".xz, wTexelR"+w+"C"+m+`.xz);
          `,m+1<f&&(b+=`
              vec4 wTexelR`+w+"C"+(m+1)+" = getW("+w+", "+(m+1)+`, d1, q);
              wR`+w+"C"+(m+1)+` =
                vec4(wTexelR`+w+"C"+(m+1)+".xz, wTexelR"+w+"C"+(m+1)+".xz);"))}for(w=0;w<p;w++)for(m=0;m<f;m++)b+="dotProd += xR"+w+"C"+m+" * wR"+w+"C"+m+";";var N="",S="";n&&(N=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,S="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+N+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+b+`

        vec4 result = dotProd;
        `+D+`
        `+S+`
        setOutput(result);
      }
    `},z7=function(e,t,n,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],s=e[1],o=e[2],u=e[3],c=t[0],d=n[0],h=n[1];this.outputShape=[c,d,h,u];var p=a==="bilinear"?1:0,f=[s-1+".0",o-1+".0"],g=f[0],b=f[1],w=d>1?[""+(s-1)/(d-1),"(y2-y1) * height_ratio","y1*"+g+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+g],m=w[0],x=w[1],y=w[2],N=h>1?[""+(o-1)/(h-1),"(x2-x1) * width_ratio","x1*"+b+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+b],S=N[0],D=N[1],_=N[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+S+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+x+`;
        float width_scale = `+D+`;

        float in_y = `+y+`;
        if( in_y < 0.0 || in_y > `+g+` ) {
          setOutput(float(`+r+`));
          return;
        }
        float in_x = `+_+`;
        if( in_x < 0.0 || in_x > `+b+` ) {
          setOutput(float(`+r+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+p+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},U7=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var a=e.length,r=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+r+" -i - 1;":"return i;")+`
      }

      void main() {
        `+jn(a)+` coords = getOutputCoords();
        int end = `+L4(a,"coords")+`;
        float val = 0.0;
        for (int i = `+r+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+L4(a,"coords")+` = idx;
          val += getX(`+function(s,o){if(s===1)return""+o;if(s===2)return o+".x, "+o+".y";if(s===3)return o+".x, "+o+".y, "+o+".z";if(s===4)return o+".x, "+o+".y, "+o+".z, "+o+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}(a,"coords")+`);
        }
        setOutput(val);
      }
    `};function L4(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var q7=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Qf.DENSE;var t=jf(e),n=ir();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Nu(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},W7=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Qf.DENSE;var t=jf(e),n=ir();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Nu(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},H7=function(){function e(t,n,a){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=a,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),V7=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},G7=function(e){this.variableNames=["A"],this.outTexUsage=oi.DOWNLOAD;var t=ir();this.outputShape=e,this.userCode=`
      `+UA+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},$7=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=oi.DOWNLOAD;var t=ir();this.outputShape=e,this.userCode=`
      `+UA+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},K7=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var a=ir(),r=t[0],i=t[1];this.outputShape=e;var s="result";n&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+Jw(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+r+`.0);
        vec4 values = `+a.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+a.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},Y7=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=ir(),r=t[0],i=t[1];this.outputShape=e;var s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var d=2*u+c;s+=`
          localCoords = coords;
          if(localCoords[2] + `+c+" < "+e[2]+`) {
            localCoords[2] += `+c+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+r+`.0);
              values = `+a.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Jw(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+a.output+" = "+o+`;
      }
    `},X7="return real * expR - imag * expI;",J7="return real * expI + imag * expR;",P4=function(e,t,n){this.variableNames=["real","imag"];var a=t[1];this.outputShape=t;var r=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?a+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+r+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+a+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+a+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},Q7=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(a,r){n.valueLoc==null&&(n.valueLoc=a.getUniformLocationNoThrow(r,"value")),a.gl.uniform1f(n.valueLoc,t)}},e}(),Z7=function(e,t,n){this.variableNames=["A","indices"];var a=e.slice();a[n]=t,this.outputShape=a,this.rank=a.length;var r=jn(this.rank),i=function(s,o){var u=s.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],h=0;h<s.length;h++)h===o?d.push("int(getIndices("+c[h]+"))"):d.push(""+c[h]);return d.join()}(e,n);this.userCode=`
      void main() {
        `+r+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},eF=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var a=jn(t.length),r=jn(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+a+" strides = "+a+"("+this.strides+`);
         void main() {
          `+r+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function tF(e,t){var n=ir();return XO(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function nF(e,t){return tI(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function aF(e,t){return nI(e,t,new Uint16Array([0,1,2,2,1,3]))}function Op(e,t,n,a,r,i,s){rI(n,a);var o=aI(e,t),u=e.TEXTURE_2D;return ht(e,t,function(){return e.bindTexture(u,o)}),ht(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ht(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ht(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ht(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ht(e,t,function(){return e.texImage2D(u,0,r,n,a,0,i,s,null)}),ht(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),o}function rF(e,t,n,a,r){var i=Mv(n,a);return Op(e,t,i[0],i[1],r.internalFormatFloat,r.textureFormatFloat,e.FLOAT)}function iF(e,t,n,a,r){var i=Mv(n,a);return Op(e,t,i[0],i[1],r.internalFormatHalfFloat,r.textureFormatFloat,r.textureTypeHalfFloat)}function sF(e,t,n,a,r){var i=Mv(n,a);return Op(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function oF(e,t,n,a,r){var i=Mp(n,a);return Op(e,t,i[0],i[1],r.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function lF(e,t,n,a,r){var i=Mp(n,a);return Op(e,t,i[0],i[1],r.internalFormatPackedHalfFloat,e.RGBA,r.textureTypeHalfFloat)}function uF(e,t,n,a){return ht(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),y4(e,t,n,"clipSpacePos",a,3,20,0)&&y4(e,t,n,"uv",a,2,20,12)}function cF(e,t,n,a,r,i,s){var o,u,c;ht(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(o=new Uint8Array(a*r*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(o=new Float32Array(a*r*4),u=e.FLOAT,c=s.internalFormatPackedFloat),o.set(i),ht(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,c,a,r,0,e.RGBA,u,o)}),ht(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function dF(e,t,n,a){ht(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a.data instanceof Uint8Array?ht(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,a.width,a.height,0,e.RGBA,e.UNSIGNED_BYTE,a.data)}):ht(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a)}),ht(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function hF(e,t,n,a,r){var i=e.createBuffer();ht(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var s=16*n*a;return ht(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ)}),ht(e,t,function(){return e.readPixels(0,0,a,n,e.RGBA,e.FLOAT,0)}),ht(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function fF(e,t,n){var a=e,r=new Float32Array(n);return a.bindBuffer(a.PIXEL_PACK_BUFFER,t),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,r),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),r}function pF(e,t,n,a,r){var i=Mv(n,a),s=i[0],o=i[1],u=new Uint8Array(n*a*4);return ht(e,t,function(){return e.readPixels(0,0,s,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function mF(e,t,n,a,r,i,s,o){var u=e,c=new Float32Array(function(d,h){var p=Mp(d,h);return p[0]*p[1]*4}(i,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function gF(e,t,n,a){var r=new Float32Array(n*a*4);return ht(e,t,function(){return e.readPixels(0,0,a,n,e.RGBA,e.FLOAT,r)}),r}var vF=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Be().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,VO(n,t)):this.gl=$s(n);var a="WEBGL_color_buffer_float";if(Be().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Zm(this.gl,this.debug,"OES_texture_float"),zi(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Zm(this.gl,this.debug,"OES_texture_half_float");else if(Be().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(a),zi(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Zm(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Be().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(a="EXT_color_buffer_float",zi(this.gl,a))this.colorBufferFloatExtension=this.gl.getExtension(a);else{if(!zi(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=nF(this.gl,this.debug),this.indexBuffer=aF(this.gl,this.debug),this.framebuffer=iI(this.gl,this.debug),this.textureConfig=Uw(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return Be().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ht(n,this.debug,function(){return n.finish()}),ht(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ht(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ht(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ht(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ht(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),rF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),iF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),sF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),dF(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,a,r){this.throwIfDisposed(),cF(this.gl,this.debug,t,n,a,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),lF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),oF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(w4(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ht(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,a){var r=this;return this.downloadMatrixDriver(t,function(){return pF(r.gl,r.debug,n,a,r.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,a,r,i,s){return mF(this.gl,t,0,0,0,i,s,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return fF(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,a){this.bindTextureToFrameBuffer(t);var r=hF(this.gl,this.debug,n,a,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,a,r=this;if(Be().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),a=function(){var o=i.clientWaitSync(s,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},n=s}else Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),a=function(){return r.isQueryAvailable(n,Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):a=function(){return!0};return{query:n,isFencePassed:a}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,a){var r=this;return this.downloadMatrixDriver(t,function(){return gF(r.gl,r.debug,n,a)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,a=JO(n,this.debug,t),r=tF(n,this.debug),i=ZO(n,this.debug);return ht(n,this.debug,function(){return n.attachShader(i,r)}),ht(n,this.debug,function(){return n.attachShader(i,a)}),eI(n,this.debug,i),this.debug&&Wb(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=uF(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ht(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Wb(this.gl,this.debug,this.program),ht(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,a){return a===void 0&&(a=!0),this.throwIfDisposed(),a?oI(this.gl,this.debug,t,n):lI(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var a=this;return this.throwIfDisposed(),ht(this.gl,this.debug,function(){return a.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,a){this.throwIfDisposed(),this.throwIfNoProgram(),uI(this.gl,this.debug,this.program,t,n,a)},e.prototype.setOutputMatrixTexture=function(t,n,a){this.setOutputMatrixTextureDriver(t,a,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,a){this.throwIfDisposed();var r=Mp(n,a),i=r[0],s=r[1];this.setOutputMatrixTextureDriver(t,i,s)},e.prototype.setOutputMatrixWriteRegion=function(t,n,a,r){this.setOutputMatrixWriteRegionDriver(a,t,r,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,a,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&Wb(this.gl,this.debug,this.program),eg(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ht(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ht(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Zm(this.gl,this.debug,Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,a),a}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,a=this.getQueryTimerExtensionWebGL2();n.endQuery(a.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return lt(this,void 0,void 0,function(){var n=this;return ut(this,function(a){switch(a.label){case 0:return[4,p4(function(){return n.disposed||n.isQueryAvailable(t,Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return a.sent(),[2,this.getQueryTime(t,Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var a=this.gl;return a.getQueryParameter(t,a.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var a=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=a.getQueryParameter(t,a.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(a){n.addItemToPoll(function(){return t.isFencePassed()},function(){return a()})})},e.prototype.pollItems=function(){for(var t=function(a){for(var r=0;r<a.length&&a[r]();++r);return r-1}(this.itemsToPoll.map(function(a){return a.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var a=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||p4(function(){return a.pollItems(),a.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Hb(this.gl,this.debug,t,this.framebuffer),this.debug&&eg(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Hb(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&eg(this.gl)):w4(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var a=n();return this.unbindTextureToFrameBuffer(),a},e.prototype.setOutputMatrixTextureDriver=function(t,n,a){this.throwIfDisposed();var r=this.gl;Hb(r,this.debug,t,this.framebuffer),this.debug&&eg(r),this.outputTexture=t,ht(r,this.debug,function(){return r.viewport(0,0,n,a)}),ht(r,this.debug,function(){return r.scissor(0,0,n,a)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,a,r){var i=this;this.throwIfDisposed(),ht(this.gl,this.debug,function(){return i.gl.scissor(t,n,a,r)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function R4(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,a){var r=n.logicalShape,i=t[a],s=i.shape;if(!Ia(r,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+s+" must match");if(!n.isUniform||!i.isUniform){var o=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!Ia(o,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+u+" must match")}})}var xF=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var a=n.filterWidth,r=n.inChannels,i=n.strideWidth,s=n.strideHeight,o=n.padInfo,u=n.outWidth,c=n.dilationWidth,d=n.dilationHeight,h=n.dataFormat,p=o.left,f=o.top,g=r*a,b=ir(),w=h==="channelsLast",m=w?0:1,x=w?1:2,y="",N=0;N<=1;N++)for(var S=0;S<=1;S++)y+=`
          blockIndex = rc.y + `+S+`;
          pos = rc.x + `+N+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+s+" - "+f+`;
            d0 = offsetY + `+d+" * (pos / "+g+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+p+`.);
              d1 = offsetX + `+c+" * (int(mod(float(pos), "+g+".) / "+r+`.));

              if(d1 < `+t[x]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+r+`.));

                if (`+w+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*N+S)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*N+S)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+y+`

        `+b.output+` = result;
      }
    `},bF=function(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[];var i,s=t,o=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+a+") * sum";i=r===.5?"inversesqrt("+u+")":r===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+r+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+o+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},yF=function(e,t,n,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+a+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+a+`)
                * float(`+r+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+r+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},wF=function(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,s=t,o=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+a+") * sum";i=r===.5?"inversesqrt("+u+")":r===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+r+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+o+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},NF=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=r-1-e.padInfo.top,o=i-1-e.padInfo.left,u=r*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+r+`;
          wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},kF=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=o-1-e.padInfo.front,h=u-1-e.padInfo.top,p=c-1-e.padInfo.left,f=o*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+h+", "+p+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+o+`;
           wD += `+r+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+c+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+f+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+c+` +
                  wR * `+c+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Yb=function(e,t,n,a,r,i,s){n===void 0&&(n=!1),a===void 0&&(a=!1),r===void 0&&(r=!1),i===void 0&&(i=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var o=n?e[1]:e[2],u=Math.ceil(o/2),c=n?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",g="";i&&(f=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,g="result = activation(result);");var b=r?"result += getBiasAtOutCoords();":"";r&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+f+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+c+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+p[0]+`);
          result += (`+h[1]+" * "+p[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+b+`

        `+g+`

        setOutput(result);
      }
    `},SF=function(){function e(t,n,a){this.variableNames=["probs"],this.outputShape=[t,a],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(a,r){n.seedLoc==null&&(n.seedLoc=a.getUniformLocation(r,"seed")),a.gl.uniform1f(n.seedLoc,t)}},e}(),_F=function(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+a+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},jF=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=Ir("rc",t),a=jn(t),r=function(o,u,c){if(o===1)return"rc > "+u[0];for(var d="",h=o-2;h<o;h++)d+=c[h]+" >= "+u[h],h<o-1&&(d+="||");return d}(t,e,n),i=function(o,u,c,d){if(o===1)return"";var h=d.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+c+`;
  `}(t,e[e.length-1],e[e.length-2],n),s=function(o,u){var c=o.length,d=function(h,p){for(var f=[],g=0;g<=1;g++)for(var b=0;b<=1;b++){for(var w=(g===0?"r":"rp1")+", "+(b===0?"c":"cp1"),m=2;m<h;m++)w=p[p.length-1-m]+","+w;f.push(w)}return f}(c,u);return c===1?`getA(rc),
            rc + 1 >= `+o[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(e,n);this.userCode=`
        void main() {
          `+a+` rc = getOutputCoords();

          if(`+r+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},CF=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,c){return u[0]+e[c]+u[1]});var a=e.length,r=jn(a),i=t.map(function(u){return u[0]}).join(","),s=t.map(function(u,c){return u[0]+e[c]}).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=a!==1?`
      `+r+" start = "+r+"("+i+`);
      `+r+" end = "+r+"("+s+`);

      void main() {
        `+r+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+r+` coords = outC - start;
          setOutput(getX(`+o+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},AF=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(w,m){return w[0]+e[m]+w[1]});for(var a=e.length,r=jn(a),i=t.map(function(w){return w[0]}).join(","),s=t.map(function(w,m){return w[0]+e[m]}).join(","),o=Ir("rc",a),u=Ir("source",a),c=o[a-1]+" < "+this.outputShape[a-1],d=a===1?"source":"vec2("+u.slice(-2).join()+")",h=[r+" rc = outputLoc;",o[a-1]+` += 1;
       if(`+c+`) {
      `,a===1?"":`}
       rc = outputLoc;
       `+o[a-2]+` += 1;
       if(`+o[a-2]+" < "+this.outputShape[a-2]+") {",a===1?"":"  "+o[a-1]+` += 1;
         if(`+c+") {"],p=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",g=0,b=a===1?2:4;g<b;g++)f+=`
        `+h[g]+`
        if (`+p+`) {
          result[`+g+"] = float("+n+`);
        } else {
          `+r+` source = rc - start;
          result[`+g+"] = getChannel(getX("+u.join()+"), "+d+`);
        }
      `;f+=a===1?"} ":"}}",this.userCode=`
      const `+r+" start = "+r+"("+i+`);
      const `+r+" end = "+r+"("+s+`);

      void main() {
        `+r+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+f+`
        setOutput(result);
      }
    `},Xb=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,r=e.strideHeight,i=e.strideWidth,s=e.dilationHeight,o=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",f="0.0";if(p||(f="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+r+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+c+`;
                wC += `+o+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+c+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var g=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(g="avgValue / count");var b=4*Math.floor(a/4),w=a%4,m=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+r+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+f+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+f+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+o+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+o+`, d),
              getValue(batch, xR, xC + 2 * `+o+`, d),
              getValue(batch, xR, xC + 3 * `+o+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(w===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(w===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+o+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(w===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+o+`, d),
              getValue(batch, xR, xC + 2 * `+o+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+g+`);
      }
    `}},Jb=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,g=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;var w=t==="avg",m="0.0";if(w||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+r+", "+i+", "+s+`);
        const ivec3 pads = ivec3(`+f+", "+g+", "+b+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+o+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+c+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+p+` +
                      wR * `+p+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var y=4*Math.floor(a/4),N=a%4,S=`
      if (`+w+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+r+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+f+", "+g+", "+b+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+o+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+y+`; wC += 4) {
              int xC = xCCorner + wC * `+c+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+c+`, ch)
              );

              `+S+`
            }

            int xC = xCCorner + `+y+`;
            if (`+(N===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(N===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(N===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                initializationValue
              );

              `+S+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},EF=function(e,t){this.variableNames=["x"];var n=e.windowSize,a=e.batchSize,r=e.inSize,i=Math.ceil(r/n);this.outputShape=[a,i];var s="0.0",o="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",o="min"):t==="max"&&(s="-1.0 / 1e-20",o="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var c=4*Math.floor(n/4),d=n%4,h=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+o+`(values, minMaxValue);
      }
    `,p="vec4";t==="all"?(s="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(s="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");var f="";r%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+r+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+f+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+c+`; i += 4) {
          int inIdx = inOffset + i;
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+c+`;
        if (`+(d===1)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===2)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===3)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+u+`);
      }
    `},DF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",a=0;a<4;a++){var r="thisRC = rc;";a%2==1&&(r+="thisRC.z += 1;"),a>1&&(r+="thisRC.y += 1;"),n+=`
        `+r+`
        `+(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+a+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(a>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Nu(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Jw(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},TF=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var a=t.shape,r=a[1],i=a[2],s=e.shape,o=s[1],u=s[2],c=[n&&o>1?r-1:r,n&&u>1?i-1:i],d=[n&&o>1?o-1:o,n&&u>1?u-1:u],h=c[0]/d[0],p=c[1]/d[1],f=1/h,g=1/p,b=2*Math.ceil(f)+2,w=2*Math.ceil(g)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+g+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+o+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(r-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},LF=function(e,t,n,a){this.variableNames=["A"],this.outputShape=[];var r=e[0],i=e[1],s=e[2],o=e[3];this.outputShape=[r,t,n,o];var u=[a&&t>1?i-1:i,a&&n>1?s-1:s],c=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},PF=function(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var r=e[0],i=e[1],s=e[2],o=e[3];this.outputShape=[r,t,n,o];var u=[a&&t>1?i-1:i,a&&n>1?s-1:s],c=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`,
          `+u[1]/c[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(o-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},RF=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var a=t.shape,r=a[1],i=a[2],s=e.shape,o=s[1],u=s[2],c=[n&&o>1?r-1:r,n&&u>1?i-1:i],d=[n&&o>1?o-1:o,n&&u>1?u-1:u],h=c[0]/d[0],p=c[1]/d[1],f=1/h,g=1/p,b=2*Math.ceil(f)+2,w=2*Math.ceil(g)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+g+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+o+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+c[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+c[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+r+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},MF=function(e,t,n,a){this.variableNames=["A"],this.outputShape=[];var r=e[0],i=e[1],s=e[2],o=e[3];this.outputShape=[r,t,n,o];var u=[a&&t>1?i-1:i,a&&n>1?s-1:s],c=[a&&t>1?t-1:t,a&&n>1?n-1:n],d=a?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},OF=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var a=e.map(function(i,s){return function(o){return t.indexOf(o)!==-1&&e[o]!==1?e[o]+" - coords["+o+"] - 1":"coords["+o+"]"}(s)}).join(","),r=jn(n);this.userCode=`
      void main() {
        `+r+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},IF=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var a=Ir("rc",n),r=a[n-1]+" + 1 < "+this.outputShape[n-1],i=a[n-2]+" + 1 < "+this.outputShape[n-2],s=jn(n);function o(u){var c=e.map(function(d,h){return function(p,f){return t.indexOf(p)!==-1&&e[p]!==1?e[p]+" - "+f[p]+" - 1":""+f[p]}(h,u)});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+r+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return o(u)}(a.slice())+`;
          if(`+r+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",o(u)}(a.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",o(u)}(a.slice())+`;
            if(`+r+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",o(u)}(a.slice())+`;
            }
          }
          setOutput(result);
        }
    `},M4=function(e,t,n,a,r,i,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var o=jn(r.length),u=jn(i.length),c="";n===1?c="i":n===2&&(c="i, j");var d="getIndices("+c+")",h="";a===1?h="i":a===2&&(h="i, coords[1]");var p="getUpdates("+h+")",f=t>1?"strides[j]":"strides";this.userCode=`
        `+o+" strides = "+o+"("+r+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+f+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+p+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},FF=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,a=e.batchSize,r=e.inSize,i=e.numSegments,s=i*Math.ceil(r/n);this.outputShape=[a,s];var o=4*Math.floor(n/4),u=n%4,c=`
        sumValue += dot(values, segFilter);
    `,d="";r%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+r+`) {
          return initializationValue;
        }
      `);var h="";r%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+r+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+o+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+c+`
        }

        int inIdx = inOffset + `+o+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+c+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+c+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+c+`
        }
        setOutput(sumValue);
      }
    `},BF=function(e,t,n){var a,r;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)r="resRC",a="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[],u=0;u<t.length;u++)o.push(""+i[u]),u<e&&s.push(""+i[u]);a=s.join(),r=o.join()}var c=jn(n);this.userCode=`
      void main() {
        `+c+` resRC = getOutputCoords();
        float cVal = getC(`+a+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+r+`));
        } else {
          setOutput(getB(`+r+`));
        }
      }
    `},zF=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,a=jn(this.rank),r="uniform int start["+this.rank+"];",i=function(s){if(s===1)return"sourceLoc";if(s<=6)return Qb.slice(0,s).map(function(o){return"sourceLoc."+o}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")}(this.rank);n=`
        `+a+` sourceLoc;
        `+a+` coords = getOutputCoords();
        `+t.map(function(s,o){return"sourceLoc."+Qb[o]+" = start["+o+"] + coords."+Qb[o]+";"}).join(`
`)+`
      `,this.userCode=`
      `+r+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(a,r){n.startLoc==null&&(n.startLoc=a.getUniformLocationNoThrow(r,"start"),n.startLoc==null)||a.gl.uniform1iv(n.startLoc,t)}},e}(),Qb=["x","y","z","w","u","v"],UF=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=jn(this.rank),a=Ir("coords",this.rank),r=Ir("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+r.slice(-2).join()+")",s="getChannel(getSource("+r.join()+"), "+i+")",o=`
      result.x = `+s+`;
      if (++`+a[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+r[this.rank-1]+`;
        result.y = `+s+`;
        --`+r[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+a[this.rank-1]+`;
      if (++`+a[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+r[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+a[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+r[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(d,h){return"start["+h+"]"}).join()+");":t.map(function(d,h){return r[h]+" = "+a[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+c+`
        vec4 result = vec4(0.);
        `+o+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(a,r){n.startLoc==null&&(n.startLoc=a.getUniformLocationNoThrow(r,"start"),n.startLoc==null)||a.gl.uniform1iv(n.startLoc,t)}},e}(),qF=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var a=n.length,r=jn(n.length),i=jn(n.length),s="";if(a===1)s="coords * strides + begin";else{var o=0;s=n.map(function(u,c){return o++,n.length===1?"coords * strides["+c+"] + begin["+c+"]":"coords["+(o-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode=`
      `+r+" begin = "+r+"("+e+`);
      `+r+" strides = "+r+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},WF=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,a){var r,i=O4(n,a),s=I4(t,i,a);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[s].shift();return this.usedTextures[s].push(o),o}return this.numUsedTextures++,this.log(),i===ii.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===ii.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===ii.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===ii.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===ii.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(r),r},e.prototype.releaseTexture=function(t,n,a,r){if(this.freeTextures!=null){var i=I4(n,O4(a,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],o=s.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function O4(e,t){if(e===oi.UPLOAD)return ii.PACKED_2X2_FLOAT32;if(e===oi.RENDER||e==null)return function(n){return Be().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?ii.PACKED_2X2_FLOAT32:ii.UNPACKED_FLOAT32:n?ii.PACKED_2X2_FLOAT16:ii.UNPACKED_FLOAT16}(t);if(e===oi.DOWNLOAD||e===oi.PIXELS)return ii.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function I4(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var HF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;var r=jn(this.rank),i=function(s){var o=s.length;if(o>5)throw Error("Tile for rank "+o+" is not yet supported");if(o===1)return"imod(resRC, "+s[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],d=0;d<s.length;d++)c.push("imod("+u[d]+", "+s[d]+")");return c.join()}(e);this.userCode=`
      void main() {
        `+r+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},VF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;var r=jn(this.rank),i=function(s){var o=s.length;if(o>6)throw Error("Transpose for rank "+o+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(o),d=0;d<s.length;d++)c[s[d]]=u[d];return c.join()}(t);this.userCode=`
    void main() {
      `+r+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},GF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[t[a]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var r=jn(this.rank),i=zA("rc",this.rank),s=new Array(this.rank);for(a=0;a<t.length;a++)s[t[a]]=i[a];var o="vec2("+s.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+s.join()+"), "+o+")";this.userCode=`
    void main() {
      `+r+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+c+`;
      if(`+u+`) {
        result[1] = `+c+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+c+`;
        if(`+u+`) {
          result[3] = `+c+`;
        }
      }
      setOutput(result);
    }
    `},Qw=1.7580993408473768,Zw=1.0507009873554805,Pt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},ds="if (isnan(x)) return x;",$F="return x;",F4="return abs(x);",VA=ds+`
  return (x < 0.0) ? 0.0 : x;
`,GA=ds+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,$A="return (x >= 0.0) ? x : (exp(x) - 1.0);",KF=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Qw+`;
  float scale = `+Zw+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,B4="return -x;",z4="return ceil(x);",U4="return floor(x);",q4="return exp(x);",W4="return exp(x) - 1.0;",YF=ds+`
  return sin(x);
`,XF=ds+`
  return cos(x);
`,JF=ds+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,QF=ds+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,ZF=ds+`
  return atan(x);
`,eB=ds+"return log(x + sqrt(x * x + 1.0));",tB=ds+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,nB=ds+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,rg="return x;",aB="return x;",KA=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,YA=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XA=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,tf=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},rB=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=Ir("rc",t),a=jn(t),r=function(o,u){if(o===1)return"rc";for(var c="",d=0;d<o;d++)c+=u[d],d<o-1&&(c+=",");return c}(t,n),i=n.slice(-2),s=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+a+` rc = getOutputCoords();
        vec4 packedInput = getA(`+r+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},ig={};function sg(e,t){if(t===void 0&&(t=!1),e==="linear")return t?aB:$F;if(e==="relu")return t?KA:VA;if(e==="elu")return t?XA:$A;if(e==="relu6")return t?YA:GA;if(e==="prelu")return t?HA:WA;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var iB=600,sB=function(e){function t(n){var a,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!Be().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=$s(Be().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Be().getNumber("WEBGL_VERSION"))in ig||(ig[a]={}),ig[a]),r.gpgpu=new vF(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=n,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=n.gl.canvas;return r.textureManager=new WF(r.gpgpu),r.numMBBeforeWarning=Be().global.screen==null?1024:Be().global.screen.height*Be().global.screen.width*window.devicePixelRatio*iB/1024/1024,r.texData=new TA(r,ye),r}return cs(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,a,r){if(Be().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:a,dtype:r,values:n,usage:oi.UPLOAD}),i},t.prototype.move=function(n,a,r,i){if(Be().getBool("DEBUG")&&this.checkNumericalProblems(a),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:r,dtype:i,values:a,usage:oi.UPLOAD})},t.prototype.readSync=function(n){var a=this.texData.get(n),r=a.values,i=a.dtype,s=a.complexTensors,o=a.slice,u=a.shape,c=a.isPacked;if(o!=null){var d=void 0;d=c?new tf(u,rg):new Pt(u,rg);var h=this.runWebGLProgram(d,[{dataId:n,shape:u,dtype:i}],i),p=this.readSync(h.dataId);return this.disposeData(h.dataId),p}if(r!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return r;var f,g,b=this.activeTimers!=null;return b&&(f=js()),i==="complex64"?g=Wy(s.real.dataSync(),s.imag.dataSync()):g=this.getValuesFromTexture(n),b&&(this.downloadWaitMs+=js()-f),this.convertAndCacheOnCPU(n,g)},t.prototype.read=function(n){return lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,D,_,A;return ut(this,function(L){switch(L.label){case 0:if(this.pendingRead.has(n))return a=this.pendingRead.get(n),[2,new Promise(function(P){return a.push(P)})];if(r=this.texData.get(n),i=r.values,s=r.shape,o=r.slice,u=r.dtype,c=r.complexTensors,d=r.isPacked,o!=null)return h=void 0,h=d?new tf(s,rg):new Pt(s,rg),p=this.runWebGLProgram(h,[{dataId:n,shape:s,dtype:u}],u),f=this.read(p.dataId),this.disposeData(p.dataId),[2,f];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!Be().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Be().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return g=null,u!=="complex64"&&Be().get("WEBGL_BUFFER_SUPPORTED")&&(b=this.decode(n),w=this.texData.get(b.dataId),g=(A=this.gpgpu).createBufferFromTexture.apply(A,[w.texture].concat(jf(s)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:L.sent(),L.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return x=L.sent(),y=x[0],N=x[1],m=Wy(y,N),[3,5];case 4:g==null?m=this.getValuesFromTexture(n):(S=dt(s),m=this.gpgpu.downloadFloat32MatrixFromBuffer(g,S)),L.label=5;case 5:return b!=null&&this.disposeData(b.dataId),D=this.convertAndCacheOnCPU(n,m),_=this.pendingRead.get(n),this.pendingRead.delete(n),_.forEach(function(P){return P(D)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var a=0;a<n.length;a++){var r=n[a];if(!KO(r))throw Be().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+r+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+r+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var a,r=this.texData.get(n),i=r.shape,s=r.dtype,o=r.isPacked,u=dt(i);if(Be().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(n),d=this.texData.get(c.dataId),h=(a=this.gpgpu).downloadMatrixFromPackedTexture.apply(a,[d.texture].concat(jf(i))).subarray(0,u);return this.disposeData(c.dataId),h}var p=Be().getBool("WEBGL_PACK")&&o===!0,f=p?Vb(i):i,g=p?new $7(f):new G7(f),b=this.runWebGLProgram(g,[{shape:f,dtype:s,dataId:n}],"float32"),w=this.texData.get(b.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(w.texture,w.texShape[0],w.texShape[1]).subarray(0,u);return this.disposeData(b.dataId),m},t.prototype.time=function(n){return lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c;return ut(this,function(d){switch(d.label){case 0:return a=this.activeTimers,r=[],i=!1,this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,n(),s=$d(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),o=$d(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=a,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return c=d.sent(),u.kernelMs=AO(c),u.getExtraProfileInfo=function(){return c.map(function(h,p){return{name:o[p],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:js(),endMs:null}},t.prototype.endTimer=function(n){return Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=js(),n)},t.prototype.getQueryTime=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){return Be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(a=n).endMs-a.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var a=this.texData.get(n).complexTensors;a!=null&&(a.real.dispose(),a.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var a=this.texData.get(n),r=a.texture,i=a.dtype,s=a.texShape,o=a.usage,u=a.isPacked,c=a.slice,d=c&&c.origDataId||n,h=this.dataRefCount.get(d);h>1?this.dataRefCount.set(d,h-1):(this.dataRefCount.delete(d),r!=null&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(r,s,o,u)));var p=this.texData.get(n);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return Be().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=ye.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,a){var r=this;return a===void 0&&(a=128),this.getCPUBackend()!=null&&n.every(function(i){return r.texData.get(i.dataId).texture==null&&i.size<a})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,a){var r=this.makeOutput(n.shape,"complex64");return this.texData.get(r.dataId).complexTensors={real:ye.keep(n.clone()),imag:ye.keep(a.clone())},r},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,a,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,a,r);if(dt(r)===0)return $a([],r,n.dtype);var i=this.texData.get(n.dataId).isPacked,s=EA(n.shape,a,r);if(i||!s){var o=Be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UF(r):new zF(r),u=o.getCustomSetupFunc(a);return this.compileAndRun(o,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,a,r)},t.prototype.shallowSlice=function(n,a,r){var i=this.texData.get(n.dataId),s=this.makeOutput(r,n.dtype),o=this.texData.get(s.dataId);Object.assign(o,i),o.shape=r,o.dtype=n.dtype;var u=DA(a,n.strides);i.slice&&(u+=i.slice.flatOffset),o.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var c=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,c+1),s},t.prototype.stridedSlice=function(n,a,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,a,r,i);var s=Gw(a,r,i);if(s.some(function(u){return u===0}))return $a([],s);var o=new qF(a,i,s);return this.compileAndRun(o,[n])},t.prototype.reverse=function(n,a){var r=Be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IF(n.shape,a):new OF(n.shape,a);return this.compileAndRun(r,[n])},t.prototype.concat=function(n,a){if(n[0].dtype==="complex64"){var r=n.map(function(f){return Fi(f)}),i=n.map(function(f){return Es(f)});return Va(this.concat(r,a),this.concat(i,a))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,a);if(n.length===1)return n[0];if(n.length>Be().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(n.length/2),o=this.concat(n.slice(0,s),a),u=this.concat(n.slice(s),a);return this.concat([o,u],a)}if(Be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var c=new L7(n.map(function(f){return f.shape}),a);return this.compileAndRun(c,n)}var d=Yd(n.map(function(f){return f.shape}),a),h=n.map(function(f){return f.as2D(-1,dt(f.shape.slice(a)))}),p=new T7(h.map(function(f){return f.shape}));return this.compileAndRun(p,h).reshape(d)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,B4,n.dtype);var a=new Pt(n.shape,B4);return this.compileAndRun(a,[n])},t.prototype.batchMatMul=function(n,a,r,i){var s=r?n.shape[2]:n.shape[1],o=i?a.shape[1]:a.shape[2],u=r?n.shape[1]:n.shape[2],c=n.shape[0];if((s===1||o===1)&&u>1e3){r&&(n=n.transpose([0,2,1])),i&&(a=a.transpose([0,2,1]));var d=o===1?n:n.as3D(c,u,1),h=o===1?2:1,p=o===1?a.as3D(c,1,u):a;return this.multiply(d,p).sum(h,!0)}var f=Ga(n.dtype,a.dtype),g=new Yb(n.shape,[c,s,o],r,i);return this.compileAndRun(g,[n,a],f)},t.prototype.fusedBatchMatMul=function(n){var a=n.a,r=n.b,i=n.transposeA,s=n.transposeB,o=n.bias,u=n.activation,c=n.preluActivationWeights,d=i?a.shape[2]:a.shape[1],h=s?r.shape[1]:r.shape[2],p=a.shape[0],f=Ga(a.dtype,r.dtype),g=o!=null,b=c!=null,w=u?sg(u,!0):null,m=new Yb(a.shape,[p,d,h],i,s,g,w,b),x=[a,r];return o&&x.push(o),c&&x.push(c),this.compileAndRun(m,x,f)},t.prototype.multiply=function(n,a){if(n.dtype==="complex64"){var r=this.texData.get(n.dataId),i=this.texData.get(a.dataId),s=new C4(j7,n.shape,a.shape),o=new C4(C7,n.shape,a.shape),u=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag),this.makeComplexComponentTensorInfo(a,i.complexTensors.real),this.makeComplexComponentTensorInfo(a,i.complexTensors.imag)],c=this.compileAndRun(s,u),d=this.compileAndRun(o,u),h=this.complex(c,d);return c.dispose(),d.dispose(),h}if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.multiply(n,a);if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,A4,n.dtype);var p=new Gn(A4,n.shape,a.shape);return this.compileAndRun(p,[n,a],n.dtype)},t.prototype.batchNormalization=function(n,a,r,i,s,o){var u=[n,a,r],c=null;o!=null&&(c=o.shape,u.push(o));var d=null;if(s!=null&&(d=s.shape,u.push(s)),Be().getBool("WEBGL_PACK_NORMALIZATION")){var h=new _7(n.shape,a.shape,r.shape,c,d,i);return this.compileAndRun(h,u)}var p=new S7(n.shape,a.shape,r.shape,c,d,i);return this.compileAndRun(p,u)},t.prototype.localResponseNormalization4D=function(n,a,r,i,s){var o=Be().getBool("WEBGL_PACK_NORMALIZATION")?new wF(n.shape,a,r,i,s):new bF(n.shape,a,r,i,s);return this.compileAndRun(o,[n])},t.prototype.LRNGrad=function(n,a,r,i,s,o,u){var c=new yF(a.shape,i,s,o,u);return this.compileAndRun(c,[a,r,n])},t.prototype.tile=function(n,a){if(n.dtype==="string"){var r=this.readSync(n.dataId).map(function(s){return D0(s)});return FA(Et(n.shape,n.dtype,r),a)}var i=new HF(n.shape,a);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,a,r){var i=Be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new AF(n.shape,a,r):new CF(n.shape,a,r);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,a);var r=Be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new GF(n.shape,a):new VF(n.shape,a);return this.compileAndRun(r,[n])},t.prototype.gather=function(n,a,r){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.gather(n,a,r);var i=new Z7(n.shape,a.size,r);return this.compileAndRun(i,[n,a])},t.prototype.batchToSpaceND=function(n,a,r){se(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=a.reduce(function(h,p){return h*p}),s=O0(n.shape,a,i),o=I0(s.length,a.length),u=F0(n.shape,a,i),c=_A(r,a.length),d=jA(u,r,a.length);return n.reshape(s).transpose(o).reshape(u).slice(c,d)},t.prototype.spaceToBatchND=function(n,a,r){se(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=a.reduce(function(p,f){return p*f}),s=[[0,0]];s.push.apply(s,r);for(var o=1+a.length;o<n.shape.length;++o)s.push([0,0]);var u=n.pad(s),c=O0(u.shape,a,i,!1),d=I0(c.length,a.length,!1),h=F0(u.shape,a,i,!1);return u.reshape(c).transpose(d).reshape(h)},t.prototype.reduce=function(n,a,r){var i=n.shape[0],s=n.shape[1],o=Gb(s),u=new EF({windowSize:o,inSize:s,batchSize:i},a),c=this.compileAndRun(u,[n],r);return c.shape[1]===1?c:this.reduce(c,a,r)},t.prototype.argReduce=function(n,a,r){r===void 0&&(r=null);var i=n.shape[0],s=n.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);var o=Gb(s),u=new m7({windowSize:o,inSize:s,batchSize:i},a,r==null),c=[n];r!=null&&c.push(r);var d=this.compileAndRun(u,c,"int32");return d.shape[1]===1?d:this.argReduce(n,a,d)},t.prototype.argReducePacked=function(n,a,r){r===void 0&&(r=null);var i=r!=null?r.shape:n.shape,s=Gb(i[i.length-1]),o=new w7(i,s,a,r==null),u=r==null?[n]:[n,r],c=this.compileAndRun(o,u,"int32");return c.rank===n.rank?this.argReducePacked(n,a,c):c},t.prototype.sum=function(n,a){ri("sum",a,n.rank);var r=ar(n.shape,a),i=r[0],s=dt(r[1]),o=n.as2D(-1,s),u=Fb(n.dtype);return this.reduce(o,"sum",u).reshape(i)},t.prototype.prod=function(n,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,a);var r=ar(n.shape,a),i=r[0],s=dt(r[1]),o=n.as2D(-1,s),u=Fb(n.dtype);return this.reduce(o,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,a,r){var i=0,s=Ks([i],n.rank),o=n;s!=null&&(o=n.transpose(s),i=Ys(1,n.rank)[0]);var u=function(f,g,b){for(var w=[],m=f.length,x=0;x<m;x++)x!==g?w.push(f[x]):w.push(b);return w}(o.shape,i,r),c=dt([o.shape[i]]),d=o.as2D(-1,c),h=Fb(n.dtype),p=this.segOpCompute(d,"unsortedSegmentSum",a,h,r).reshape(u);return s!=null&&(p=p.transpose(qw(s))),p},t.prototype.segOpCompute=function(n,a,r,i,s){var o=n.shape[0],u=n.shape[1],c=function(p,f){var g,b=!1;for(p<=AA?(g=p,b=!0):g=Ry(p,Math.floor(Math.sqrt(p)));!b;)g>f||g===p?b=!0:g=Ry(p,g+1);return g}(u,s),d=new FF({windowSize:c,inSize:u,batchSize:o,numSegments:s}),h=this.compileAndRun(d,[n,r],i);return h.shape[1]===s?h:(r=M0(0,s).tile([u/c]),this.segOpCompute(h,a,r,i,s))},t.prototype.argMinMaxReduce=function(n,a,r){var i=[a];if(ri("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,n.rank),!Be().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var s=ar(n.shape,i),o=s[0],u=dt(s[1]),c=n.as2D(-1,u);return this.argReduce(c,r).reshape(o)}return this.argReducePacked(n,r)},t.prototype.argMin=function(n,a){return this.argMinMaxReduce(n,a,"min")},t.prototype.argMax=function(n,a){return this.argMinMaxReduce(n,a,"max")},t.prototype.cumsum=function(n,a,r,i){if(a!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+a);var s=new U7(n.shape,r,i);return this.compileAndRun(s,[n])},t.prototype.equal=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(equal(a, b));
`,"bool");var r=new Gn("return float(a == b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.notEqual=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(notEqual(a, b));
`,"bool");var r=new Gn("return float(a != b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.less=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.less(n,a);if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(lessThan(a, b));
`,"bool");var r=new Gn("return float(a < b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.lessEqual=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(lessThanEqual(a, b));
`,"bool");var r=new Gn("return float(a <= b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.greater=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.greater(n,a);if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(greaterThan(a, b));
`,"bool");var r=new Gn("return float(a > b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.greaterEqual=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var r=new Gn("return float(a >= b);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.logicalNot=function(n){var a=new Pt(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(a,[n])},t.prototype.logicalAnd=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var r=new Gn("return float(a >= 1.0 && b >= 1.0);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.logicalOr=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var r=new Gn("return float(a >= 1.0 || b >= 1.0);",n.shape,a.shape);return this.compileAndRun(r,[n,a],"bool")},t.prototype.select=function(n,a,r){var i=new BF(n.rank,a.shape,a.rank);return this.compileAndRun(i,[n,a,r],Ga(a.dtype,r.dtype))},t.prototype.where=function(n){P0("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var a=n.dataSync();return Xw(n.shape,a)},t.prototype.topk=function(n,a,r){return BA(n.dataSync(),n.shape,n.dtype,a)},t.prototype.min=function(n,a){ri("min",a,n.rank);var r=ar(n.shape,a),i=r[0],s=dt(r[1]),o=n.as2D(-1,s);return this.reduce(o,"min",o.dtype).reshape(i)},t.prototype.minimum=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.minimum(n,a);var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Gn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.mod=function(n,a){var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Gn(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.max=function(n,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,a);ri("max",a,n.rank);var r=ar(n.shape,a),i=r[0],s=dt(r[1]),o=n.as2D(-1,s);return this.reduce(o,"max",o.dtype).reshape(i)},t.prototype.maximum=function(n,a){if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.maximum(n,a);var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Gn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.all=function(n,a){ri("all",a,n.rank);var r=ar(n.shape,a),i=r[0],s=dt(r[1]),o=n.as2D(-1,s);return this.reduce(o,"all",o.dtype).reshape(i)},t.prototype.any=function(n,a){ri("any",a,n.rank);var r=ar(n.shape,a),i=r[0],s=dt(r[1]),o=n.as2D(-1,s);return this.reduce(o,"any",o.dtype).reshape(i)},t.prototype.realDivide=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var r=new Gn(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,a.shape);return this.compileAndRun(r,[n,a],"float32")},t.prototype.floorDiv=function(n,a){if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var r=new Gn(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,a.shape);return this.compileAndRun(r,[n,a],"int32")},t.prototype.add=function(n,a){if(n.dtype==="complex64"&&a.dtype==="complex64")return this.complexSeparableBinaryOp(n,a,$b);if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.add(n,a);var r=Ga(n.dtype,a.dtype);if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,$b,r);var i=new Gn($b,n.shape,a.shape);return this.compileAndRun(i,[n,a],r)},t.prototype.packedUnaryOp=function(n,a,r){var i=new tf(n.shape,a);return this.compileAndRun(i,[n],r)},t.prototype.packedBinaryOp=function(n,a,r,i,s){s===void 0&&(s=!1);var o=new fo(r,n.shape,a.shape,s);return this.compileAndRun(o,[n,a],i)},t.prototype.complexSeparableBinaryOp=function(n,a,r){var i=this,s=this.texData.get(n.dataId),o=this.texData.get(a.dataId),u=[[s.complexTensors.real,o.complexTensors.real],[s.complexTensors.imag,o.complexTensors.imag]].map(function(p){var f=p[0],g=p[1],b=i.makeComplexComponentTensorInfo(n,f),w=i.makeComplexComponentTensorInfo(a,g),m=new Gn(r,n.shape,a.shape);return i.compileAndRun(m,[b,w],Ga(f.dtype,g.dtype))}),c=u[0],d=u[1],h=this.complex(c,d);return c.dispose(),d.dispose(),h},t.prototype.makeComplexComponentTensorInfo=function(n,a){return{dataId:a.dataId,dtype:a.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>Be().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),r=this.addN(n.slice(0,a)),i=this.addN(n.slice(a));return this.addN([r,i])}var s=n.map(function(c){return c.dtype}).reduce(function(c,d){return Ga(c,d)}),o=n.map(function(c){return c.shape}),u=Be().getBool("WEBGL_PACK")?new p7(n[0].shape,o):new f7(n[0].shape,o);return this.compileAndRun(u,n,s)},t.prototype.subtract=function(n,a){if(n.dtype==="complex64"&&a.dtype==="complex64")return this.complexSeparableBinaryOp(n,a,Kb);if(this.shouldExecuteOnCPU([n,a]))return this.cpuBackend.subtract(n,a);var r=Ga(n.dtype,a.dtype);if(Be().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,a,Kb,n.dtype);var i=new Gn(Kb,n.shape,a.shape);return this.compileAndRun(i,[n,a],r)},t.prototype.pow=function(n,a){var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Gn(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,a.shape),i=Ga(n.dtype,a.dtype);return this.compileAndRun(r,[n,a],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,z4,n.dtype);var a=new Pt(n.shape,z4);return this.compileAndRun(a,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,U4,n.dtype);var a=new Pt(n.shape,U4);return this.compileAndRun(a,[n])},t.prototype.sign=function(n){var a=new Pt(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(a,[n])},t.prototype.isNaN=function(n){var a=new Pt(n.shape,"return float(isnan(x));");return this.compileAndRun(a,[n],"bool")},t.prototype.isInf=function(n){var a=new Pt(n.shape,"return float(isinf(x));");return this.compileAndRun(a,[n],"bool")},t.prototype.isFinite=function(n){var a=new Pt(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(a,[n],"bool")},t.prototype.round=function(n){var a=new Pt(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(a,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,q4,n.dtype);var a=new Pt(n.shape,q4);return this.compileAndRun(a,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,W4,n.dtype);var a=new Pt(n.shape,W4);return this.compileAndRun(a,[n])},t.prototype.softmax=function(n,a){var r=Ca([a],n.shape),i=this.max(n,r),s=Ur(i.shape,r),o=this.subtract(n,i.reshape(s)),u=this.exp(o),c=this.sum(u,r).reshape(s);return this.realDivide(u,c)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var a=new Pt(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(a,[n])},t.prototype.log1p=function(n){var a=new Pt(n.shape,"return log(1.0 + x);");return this.compileAndRun(a,[n])},t.prototype.sqrt=function(n){var a=new Pt(n.shape,"return sqrt(x);");return this.compileAndRun(a,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var a=new Pt(n.shape,"return inversesqrt(x);");return this.compileAndRun(a,[n])},t.prototype.reciprocal=function(n){var a=new Pt(n.shape,"return 1.0 / x;");return this.compileAndRun(a,[n])},t.prototype.relu=function(n){var a;return a=Be().getBool("WEBGL_PACK")?new tf(n.shape,KA):new Pt(n.shape,VA),this.compileAndRun(a,[n])},t.prototype.relu6=function(n){var a;return a=Be().getBool("WEBGL_PACK")?new tf(n.shape,YA):new Pt(n.shape,GA),this.compileAndRun(a,[n])},t.prototype.prelu=function(n,a){var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(HA,n.shape,a.shape):new Gn(WA,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.elu=function(n){if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,XA,n.dtype);var a=new Pt(n.shape,$A);return this.compileAndRun(a,[n])},t.prototype.eluDer=function(n,a){var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,a.shape):new Gn("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.selu=function(n){var a=new Pt(n.shape,KF);return this.compileAndRun(a,[n])},t.prototype.int=function(n){var a=new Pt(n.shape,"return float(int(x));");return this.compileAndRun(a,[n],"int32")},t.prototype.clip=function(n,a,r){var i,s=(i=Be().getBool("WEBGL_PACK_CLIP")?new E7(n.shape):new A7(n.shape)).getCustomSetupFunc(a,r);return this.compileAndRun(i,[n],null,s)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(Be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,F4,n.dtype);var a=new Pt(n.shape,F4);return this.compileAndRun(a,[n])},t.prototype.complexAbs=function(n){var a=this.texData.get(n.dataId),r=new D7(n.shape),i=[this.makeComplexComponentTensorInfo(n,a.complexTensors.real),this.makeComplexComponentTensorInfo(n,a.complexTensors.imag)];return this.compileAndRun(r,i)},t.prototype.sigmoid=function(n){var a=new Pt(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(a,[n])},t.prototype.softplus=function(n){var a=new Pt(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(a,[n])},t.prototype.sin=function(n){var a=new Pt(n.shape,YF);return this.compileAndRun(a,[n])},t.prototype.cos=function(n){var a=new Pt(n.shape,XF);return this.compileAndRun(a,[n])},t.prototype.tan=function(n){var a=new Pt(n.shape,"return tan(x);");return this.compileAndRun(a,[n])},t.prototype.asin=function(n){var a=new Pt(n.shape,JF);return this.compileAndRun(a,[n])},t.prototype.acos=function(n){var a=new Pt(n.shape,QF);return this.compileAndRun(a,[n])},t.prototype.atan=function(n){var a=new Pt(n.shape,ZF);return this.compileAndRun(a,[n])},t.prototype.atan2=function(n,a){var r=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,a.shape):new Gn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,a.shape);return this.compileAndRun(r,[n,a])},t.prototype.sinh=function(n){var a=new Pt(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(a,[n])},t.prototype.cosh=function(n){var a=new Pt(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(a,[n])},t.prototype.tanh=function(n){var a=new Pt(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(a,[n])},t.prototype.asinh=function(n){var a=new Pt(n.shape,eB);return this.compileAndRun(a,[n])},t.prototype.acosh=function(n){var a=new Pt(n.shape,tB);return this.compileAndRun(a,[n])},t.prototype.atanh=function(n){var a=new Pt(n.shape,nB);return this.compileAndRun(a,[n])},t.prototype.erf=function(n){var a=new Pt(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(a,[n])},t.prototype.step=function(n,a){var r=new Pt(n.shape,function(i){return i===void 0&&(i=0),ds+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(a));return this.compileAndRun(r,[n])},t.prototype.conv2dByMatMul=function(n,a,r,i,s,o){var u=n.shape,c=this.texData.get(n.dataId),d=r.inChannels,h=u[0]*u[1]*u[2],p=r.outChannels,f=r.dataFormat==="channelsLast",g=(h===1||p===1)&&d>1e3,b=u[2]%2!=0&&!!c.isPacked;if(g||!Be().getBool("WEBGL_LAZILY_UNPACK")||!Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){var w=f?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],m=this.reshape(n,[1,w,r.inChannels]),x=this.reshape(a,[1,r.inChannels,r.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:x,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o}),r.outShape)}var y=f?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),N={dataId:n.dataId,shape:[1,y,r.inChannels],dtype:n.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,se(ng(c.shape,N.shape),function(){return"packed reshape "+c.shape+" to "+N.shape+" isn't free"});var D=this.reshape(a,[1,r.inChannels,r.outChannels]),_=this.fusedBatchMatMul({a:N,b:D,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o}),A=this.texData.get(_.dataId);return se(A.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=S,A.shape=r.outShape,ye.makeTensorFromDataId(_.dataId,r.outShape,_.dtype)},t.prototype.conv2dWithIm2Row=function(n,a,r,i,s,o){var u=r.filterWidth,c=r.filterHeight,d=r.inChannels,h=r.outWidth,p=r.outHeight,f=r.dataFormat==="channelsLast",g=u*c*d,b=p*h,w=[g,b],m=n.squeeze([0]),x=a.reshape([1,g,-1]),y=new xF(w,m.shape,r),N=this.compileAndRun(y,[m]).reshape([1,w[0],w[1]]),S=i!=null,D=o!=null,_=s?sg(s,!0):null,A=new Yb(N.shape,[1,b,r.outChannels],!0,!1,S,_,D),L=[N,x];i&&L.push(i),D&&L.push(o);var P=this.compileAndRun(A,L);return f?P.reshape([1,p,h,r.outChannels]):P.reshape([1,r.outChannels,p,h])},t.prototype.fusedConv2d=function(n){var a=n.input,r=n.filter,i=n.convInfo,s=n.bias,o=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(a,r,i,s,o,u);if(Be().getBool("WEBGL_CONV_IM2COL")&&a.shape[0]===1)return this.conv2dWithIm2Row(a,r,i,s,o,u);var c=s!=null,d=u!=null,h=o?sg(o,!1):null,p=new E4(i,c,h,d),f=[a,r];return s&&f.push(s),u&&f.push(u),this.compileAndRun(p,f)},t.prototype.conv2d=function(n,a,r){if(r.filterHeight===1&&r.filterWidth===1&&r.dilationHeight===1&&r.dilationWidth===1&&r.strideHeight===1&&r.strideWidth===1&&(r.padInfo.type==="SAME"||r.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,r);if(Be().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,r);var i=new E4(r);return this.compileAndRun(i,[n,a])},t.prototype.conv2dDerInput=function(n,a,r){var i=new R7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv2dDerFilter=function(n,a,r){var i=new P7(r);return this.compileAndRun(i,[n,a])},t.prototype.fusedDepthwiseConv2D=function(n){var a,r=n.input,i=n.filter,s=n.convInfo,o=n.bias,u=n.activation,c=n.preluActivationWeights,d=Be().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,h=u?sg(u,d):null,p=[r,i],f=o!=null,g=c!=null;return f&&p.push(o),g&&p.push(c),d?(a=new T4(s,f,h,g),this.compileAndRun(a,p)):(a=new D4(s,f,h,g),this.compileAndRun(a,p))},t.prototype.depthwiseConv2D=function(n,a,r){var i;return Be().getBool("WEBGL_PACK_DEPTHWISECONV")&&r.strideWidth<=2&&r.outChannels/r.inChannels==1?(i=new T4(r),this.compileAndRun(i,[n,a])):(i=new D4(r),this.compileAndRun(i,[n,a]))},t.prototype.depthwiseConv2DDerInput=function(n,a,r){var i=new F7(r);return this.compileAndRun(i,[n,a])},t.prototype.depthwiseConv2DDerFilter=function(n,a,r){var i=new I7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv3d=function(n,a,r){var i=new B7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv3dDerInput=function(n,a,r){var i=new O7(r);return this.compileAndRun(i,[n,a])},t.prototype.conv3dDerFilter=function(n,a,r){var i=new M7(r);return this.compileAndRun(i,[n,a])},t.prototype.maxPool=function(n,a){var r=new Xb(a,"max",!1);return this.compileAndRun(r,[n])},t.prototype.avgPool=function(n,a){var r=new Xb(a,"avg",!1);return this.compileAndRun(r,[n],"float32")},t.prototype.maxPoolBackprop=function(n,a,r,i){var s=new Xb(i,"max",!0),o=this.compileAndRun(s,[a]),u=new NF(i),c=this.compileAndRun(u,[n,o],a.dtype);return o.dispose(),c},t.prototype.avgPoolBackprop=function(n,a,r){var i=new N7(r);return this.compileAndRun(i,[n],a.dtype)},t.prototype.cast=function(n,a){return RA(n,a,this)},t.prototype.unstack=function(n,a){for(var r=n.shape[a],i=new Array(n.rank-1),s=0,o=0;o<n.rank;o++)o!==a&&(i[s++]=n.shape[o]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[a]=1;var d=new Array(r);for(o=0;o<d.length;o++)u[a]=o,d[o]=this.slice(n,u,c).reshape(i);return d},t.prototype.avgPool3d=function(n,a){var r=new Jb(a,"avg",!1);return this.compileAndRun(r,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,a,r){var i=new k7(r);return this.compileAndRun(i,[n],a.dtype)},t.prototype.maxPool3d=function(n,a){var r=new Jb(a,"max",!1);return this.compileAndRun(r,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,a,r,i){var s=new Jb(i,"max",!0),o=this.compileAndRun(s,[a]),u=new kF(i),c=this.compileAndRun(u,[n,o],a.dtype);return o.dispose(),c},t.prototype.reshape=function(n,a){var r=this.texData.get(n.dataId);if(r.isPacked&&!ng(n.shape,a)&&(r.texture===null||!ng(r.shape,a))){var i=this.packedReshape(n,a);return ye.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return qy(n,a)},t.prototype.resizeBilinear=function(n,a,r,i){var s=Be().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new PF(n.shape,a,r,i):new LF(n.shape,a,r,i);return this.compileAndRun(s,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,a,r){var i=new TF(n,a,r);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,a,r,i){var s=new MF(n.shape,a,r,i);return this.compileAndRun(s,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,a,r){var i=new RF(n,a,r);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,a,r,i){var s=a?n:Lo(n),o=s.shape[0],u=s.shape[1],c=new SF(o,u,r),d=c.getCustomSetupFunc(i);return this.compileAndRun(c,[s],"int32",d)},t.prototype.oneHot=function(n,a,r,i){var s=new _F(n.size,a,r,i);return this.compileAndRun(s,[n])},t.prototype.diag=function(n){var a=new V7(n.size);return this.compileAndRun(a,[n])},t.prototype.nonMaxSuppression=function(n,a,r,i,s){return P0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Kw(n.dataSync(),a.dataSync(),r,i,s)},t.prototype.cropAndResize=function(n,a,r,i,s,o){var u=new z7(n.shape,a.shape,i,s,o);return this.compileAndRun(u,[n,a,r],"float32")},t.prototype.depthToSpace=function(n,a,r){se(a>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+a});var i=n.shape[0],s=r==="NHWC"?n.shape[1]:n.shape[2],o=r==="NHWC"?n.shape[2]:n.shape[3],u=r==="NHWC"?n.shape[3]:n.shape[1],c=s*a,d=o*a,h=u/(a*a),p=new H7(r==="NHWC"?[i,c,d,h]:[i,h,c,d],a,r);return this.compileAndRun(p,[n])},t.prototype.split=function(n,a,r){return IA(n,a,r)},t.prototype.scatterND=function(n,a,r){var i=B0(0,n,r),s=i.sliceRank,o=i.numUpdates,u=i.sliceSize,c=i.strides,d=i.outputSize,h=[d/u,u],p=n.reshape([o,s]),f=a.reshape([o,u]);if(d===0)return qy($a([]),r);var g=at(0),b=new M4(o,s,p.rank,f.rank,c,h);return this.compileAndRun(b,[f,p,g]).reshape(r)},t.prototype.sparseToDense=function(n,a,r,i){var s=B0(0,n,r),o=s.sliceRank,u=s.numUpdates,c=s.strides,d=s.outputSize,h=new M4(u,o,n.rank,a.rank,c,[d,1]);return this.compileAndRun(h,[a,n,i]).reshape(r)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,a){var r=this.texData.get(n.dataId),i=new P4(X7,n.shape,a),s=new P4(J7,n.shape,a),o=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)],u=this.compileAndRun(i,o),c=this.compileAndRun(s,o),d=this.complex(u,c).as2D(n.shape[0],n.shape[1]);return u.dispose(),c.dispose(),d},t.prototype.gatherND=function(n,a){var r=a.shape,i=r[r.length-1],s=CA(n,a),o=s[0],u=s[1],c=s[2],d=s[3],h=a.reshape([u,i]),p=n.reshape([n.size/c,c]),f=new eF(i,d,[u,c]);return this.compileAndRun(f,[p,h]).reshape(o)},t.prototype.fill=function(n,a,r){if((r=r||Pp(a))==="string"){var i=E0(r,dt(n));return i.fill(a),ye.makeTensor(i,n,r,this)}var s=new Q7(n,a),o=s.getCustomSetupFunc(a);return this.compileAndRun(s,[],r,o)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,a,r){return MA(n,a,r)},t.prototype.makeTensorInfo=function(n,a){var r=this.write(null,n,a);return this.texData.get(r).usage=null,{dataId:r,shape:n,dtype:a}},t.prototype.makeOutput=function(n,a){var r=this.makeTensorInfo(n,a).dataId;return ye.makeTensorFromDataId(r,n,a,this)},t.prototype.unpackTensor=function(n){var a=new rB(n.shape);return this.runWebGLProgram(a,[n],n.dtype)},t.prototype.packTensor=function(n){var a=new jF(n.shape);return this.runWebGLProgram(a,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,a){var r=[T0(n.shape)].concat(L0(n.shape)),i={dtype:n.dtype,shape:r,dataId:n.dataId},s=[T0(a)].concat(L0(a)),o=new DF(s,r),u=this.runWebGLProgram(o,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:a,dtype:u.dtype}},t.prototype.decode=function(n){var a,r=this.texData.get(n),i=r.isPacked,s=r.shape,o=r.dtype,u=Vb(s);return a=i?new W7(u):new q7(u),{dtype:o,shape:s,dataId:this.runWebGLProgram(a,[{shape:u,dtype:o,dataId:n}],o,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,a,r,i,s){var o=this;s===void 0&&(s=!1);var u=this.makeTensorInfo(n.outputShape,r),c=this.texData.get(u.dataId);if(n.packedOutput&&(c.isPacked=!0),n.outPackingScheme===Qf.DENSE){var d=jf(n.outputShape);c.texShape=d.map(function(y){return 2*y})}if(n.outTexUsage!=null&&(c.usage=n.outTexUsage),dt(u.shape)===0)return c.values=Xf(u.dtype,0),u;var h=[],p=a.map(function(y){if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var N=o.texData.get(y.dataId);if(N.texture==null){if(!n.packedInputs&&dt(y.shape)<=Be().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:N.values};n.packedInputs&&(N.isPacked=!0,N.shape=y.shape)}else if(!!N.isPacked!=!!n.packedInputs)y=N.isPacked?o.unpackTensor(y):o.packTensor(y),h.push(y),N=o.texData.get(y.dataId);else if(N.isPacked&&!ng(N.shape,y.shape)){var S=y,D=y.shape;y.shape=N.shape,y=o.packedReshape(y,D),h.push(y),N=o.texData.get(y.dataId),S.shape=D}return o.uploadToGPU(y.dataId),{shape:y.shape,texData:N,isUniform:!1}});this.uploadToGPU(u.dataId);var f,g={shape:u.shape,texData:c,isUniform:!1},b=function(y,N,S){var D="";N.concat(S).forEach(function(L){var P=L.texData!=null&&L.texData.slice!=null&&L.texData.slice.flatOffset>0,j=L.isUniform?"uniform":L.texData.texShape;D+=L.shape+"_"+j+"_"+P});var _=y.userCode,A=y.constructor.name;return A+="_"+D+"_"+_}(n,p,g),w=this.getAndSaveBinary(b,function(){return function(y,N,S,D){var _=N.userCode,A=S.map(function(q,I){var K={logicalShape:q.shape,texShape:q.isUniform?null:q.texData.texShape,isUniform:q.isUniform,isPacked:!q.isUniform&&q.texData.isPacked,flatOffset:null};return q.texData!=null&&q.texData.slice!=null&&q.texData.slice.flatOffset>0&&(K.flatOffset=q.texData.slice.flatOffset),{name:N.variableNames[I],shapeInfo:K}}),L=A.map(function(q){return q.shapeInfo}),P={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},j=g7(A,P,_,N.packedInputs),E=y.createProgram(j),F=null,z=y.getUniformLocation(E,"NAN",!1);Be().getNumber("WEBGL_VERSION")===1&&(F=y.getUniformLocation(E,"INFINITY",!1));for(var U={},O=0;O<N.variableNames.length;O++){var B=N.variableNames[O];U[B]=y.getUniformLocation(E,B,!1),U["offset"+B]=y.getUniformLocation(E,"offset"+B,!1)}return{program:N,source:j,webGLProgram:E,uniformLocations:U,inShapeInfos:L,outShapeInfo:P,infLoc:F,nanLoc:z}}(o.gpgpu,n,p,g)}),m=this.activeTimers!=null;if(m&&(f=this.startTimer()),function(y,N,S,D,_){R4(N.inShapeInfos,S),R4([N.outShapeInfo],[D]);var A=D.texData.texture,L=D.texData.texShape;D.texData.isPacked?y.setOutputPackedMatrixTexture(A,L[0],L[1]):y.setOutputMatrixTexture(A,L[0],L[1]),y.setProgram(N.webGLProgram),Be().getNumber("WEBGL_VERSION")===1&&N.infLoc!==null&&y.gl.uniform1f(N.infLoc,1/0),N.nanLoc!==null&&y.gl.uniform1f(N.nanLoc,NaN),S.forEach(function(P,j){var E=N.program.variableNames[j],F=N.uniformLocations[E],z=N.uniformLocations["offset"+E];if(F!=null)if(P.isUniform)if(dt(P.shape)<2)y.gl.uniform1f(F,P.uniformValues[0]);else{var U=P.uniformValues;U instanceof Float32Array||(U=new Float32Array(U)),y.gl.uniform1fv(F,U)}else P.texData.slice!=null&&z!=null&&y.gl.uniform1i(z,P.texData.slice.flatOffset),y.setInputMatrixTexture(P.texData.texture,F,j)}),_!=null&&_(y,N.webGLProgram),y.executeProgram()}(this.gpgpu,w,p,g,i),h.forEach(function(y){return o.disposeData(y.dataId)}),m&&(f=this.endTimer(f),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(f)})),!Be().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&s===!1){var x=this.unpackTensor(u);return this.disposeData(u.dataId),x}return u},t.prototype.compileAndRun=function(n,a,r,i,s){s===void 0&&(s=!1),r=r||a[0].dtype;var o=this.runWebGLProgram(n,a,r,i,s);return ye.makeTensorFromDataId(o.dataId,o.shape,o.dtype)},t.prototype.getAndSaveBinary=function(n,a){return n in this.binaryCache||(this.binaryCache[n]=a()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(Be().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(a){n.gpgpu.deleteProgram(n.binaryCache[a].webGLProgram),delete n.binaryCache[a]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=st(function(){if(!Be().get("WEBGL_RENDER_FLOAT32_ENABLED")){var a=Be().getBool("DEBUG");Be().set("DEBUG",!1);var r=n.abs(at(1e-8)).dataSync()[0];if(Be().set("DEBUG",a),r>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var a,r=this.texData.get(n),i=r.shape,s=r.dtype,o=r.values,u=r.texture,c=r.usage,d=r.isPacked;if(u==null){var h,p=this.activeTimers!=null;p&&(h=js());var f=r.texShape;if(f==null&&(f=hI(i,d),r.texShape=f),o!=null){var g=Vb(i),b=void 0,w=f[1],m=f[0],x=o instanceof Uint8Array;d?(w=(a=Mp(f[0],f[1]))[0],m=a[1],b=new Y7(g,[m,w],x)):b=new K7(g,[m,w],x);var y=this.makeTensorInfo([m,w],s);this.texData.get(y.dataId).usage=x?oi.PIXELS:oi.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),w,m,o);var N=this.runWebGLProgram(b,[y],s,null,!0),S=this.texData.get(N.dataId);r.texture=S.texture,r.texShape=S.texShape,r.isPacked=S.isPacked,r.usage=S.usage,this.disposeData(y.dataId),this.texData.delete(N.dataId),r.values=null,p&&(this.uploadWaitMs+=js()-h)}else{var D=this.acquireTexture(f,c,s,d);r.texture=D}}},t.prototype.convertAndCacheOnCPU=function(n,a){var r=this.texData.get(n),i=r.dtype;return this.releaseGPUData(n),a!=null&&(r.values=function(s,o){if(o==="float32"||o==="complex64")return s;if(o==="int32"||o==="bool"){for(var u=o==="int32"?new Int32Array(s.length):new Uint8Array(s.length),c=0;c<u.length;++c)u[c]=Math.round(s[c]);return u}throw new Error("Unknown dtype "+o)}(a,i)),r.values},t.prototype.acquireTexture=function(n,a,r,i){if(this.numBytesInGPU+=this.computeBytes(n,r),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,a,i)},t.prototype.computeBytes=function(n,a){return n[0]*n[1]*uA(a)},t}(LA);gA()&&ye.registerBackend("webgl",function(){return new sB},2);var oB=de({square_:function(e){var t=te(e,"x","square"),n=[t];return ye.runKernelFunc(function(a,r){return r([t]),a.square(t)},{x:t},null,"Square",{},n,[])}}),ep="SquaredDifference",JA=de({squaredDifference_:function(e,t){var n,a=te(e,"a","squaredDifference"),r=te(t,"b","squaredDifference");n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape);var i={a,b:r},s=[a,r];return ye.runKernelFunc(function(o,u){var c=o.squaredDifference(a,r);return u([a,r]),c},i,function(o,u){var c=u[0],d=u[1],h=at(2);return{a:function(){return o.mul(c.sub(d).mul(h))},b:function(){return o.mul(d.sub(c).mul(h))}}},ep,{},s,[])}}),lB=de({abs_:function(e){var t=te(e,"x","abs");return t.dtype==="complex64"?ye.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):ye.runKernelFunc(function(n,a){var r=n.abs(t);return a([t]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return n.mul(r.toFloat().step(-1))}}},"Abs")}}),uB=de({acos_:function(e){var t=te(e,"x","acos");return ye.runKernelFunc(function(n,a){var r=n.acos(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(at(1).sub(r.toFloat().square()).sqrt()).neg()}}})}}),cB=de({acosh_:function(e){var t=te(e,"x","acosh");return ye.runKernelFunc(function(n,a){var r=n.acosh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(r.toFloat().square().sub(1).sqrt())}}})}}),dB=de({asin_:function(e){var t=te(e,"x","asin");return ye.runKernelFunc(function(n,a){var r=n.asin(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(at(1).sub(r.toFloat().square()).sqrt())}}})}}),hB=de({asinh_:function(e){var t=te(e,"x","asinh");return ye.runKernelFunc(function(n,a){var r=n.asinh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.divStrict(at(1).add(r.toFloat().square()).sqrt())}}})}}),fB=de({atan_:function(e){var t=te(e,"x","atan");return ye.runKernelFunc(function(n,a){var r=n.atan(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.toFloat().square().add(1))}}})}}),pB=de({atanh_:function(e){var t=te(e,"x","atanh");return ye.runKernelFunc(function(n,a){var r=n.atanh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(at(1).sub(r.toFloat().square()))}}})}}),mB=de({ceil_:function(e){var t=te(e,"x","ceil");return ye.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),e5=de({clipByValue_:function(e,t,n){var a=te(e,"x","clipByValue");se(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var r=[a],i={min:t,max:n};return ye.runKernelFunc(function(s,o){var u=s.clip(a,t,n);return o([a]),u},{x:a},function(s,o){var u=o[0];return{x:function(){return s.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),Yt(s))}}},"ClipByValue",i,r)}}),gB=de({cos_:function(e){var t=te(e,"x","cos"),n=[t];return ye.runKernelFunc(function(a,r){var i=a.cos(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return i.toFloat().sin().neg().mul(a)}}},"Cos",{},n)}}),vB=de({cosh_:function(e){var t=te(e,"x","cosh");return ye.runKernelFunc(function(n,a){var r=n.cosh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return r.toFloat().sinh().mulStrict(n)}}})}}),xB=de({erf_:function(e){var t=te(e,"x","erf");return se(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),ye.runKernelFunc(function(n,a){var r=n.erf(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Hy=de({exp_:function(e){var t=te(e,"x","exp");return ye.runKernelFunc(function(n,a){var r=n.exp(t);return a([r]),r},{x:t},function(n,a){return{x:function(){return n.mulStrict(a[0])}}},"Exp",{},[],[!0])}}),bB=de({expm1_:function(e){var t=te(e,"x","expm1");return ye.runKernelFunc(function(n,a){var r=n.expm1(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.exp())}}})}}),yB=de({floor_:function(e){var t=te(e,"x","floor");return ye.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),wB=de({log_:function(e){var t=te(e,"x","log"),n=[t];return ye.runKernelFunc(function(a,r){var i=a.log(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return a.div(i.toFloat())}}},"Log",{},n)}}),NB=de({log1p_:function(e){var t=te(e,"x","log1p");return ye.runKernelFunc(function(n,a){var r=n.log1p(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.add(1))}}})}}),kB=de({logSigmoid_:function(e){var t=te(e,"x","logSigmoid");return ye.runKernelFunc(function(n,a){var r=n.softplus(t.neg()).neg();return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.neg().sigmoid())}}})}}),W0=de({neg_:function(e){var t=te(e,"x","neg"),n=[t];return ye.runKernelFunc(function(a){return a.neg(t)},{x:t},function(a){return{x:function(){return a.neg()}}},"Neg",{},n)}}),SB=de({reciprocal_:function(e){var t=te(e,"x","reciprocal");return ye.runKernelFunc(function(n,a){var r=n.reciprocal(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.square().neg())}}})}}),_B=de({round_:function(e){var t=te(e,"x","round");return ye.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),QA=de({rsqrt_:function(e){var t=te(e,"x","rsqrt"),n=[t];return ye.runKernelFunc(function(a,r){var i=a.rsqrt(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return a.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),ZA=de({sigmoid_:function(e){var t=te(e,"x","sigmoid");return ye.runKernelFunc(function(n,a){var r=n.sigmoid(t);return a([r]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return n.mul(r.mul(at(1).sub(r)))}}},"Sigmoid")}}),jB=de({sign_:function(e){var t=te(e,"x","sign");return ye.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),CB=de({isNaN_:function(e){var t=te(e,"x","isNaN");return ye.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),AB=de({isInf_:function(e){var t=te(e,"x","isInf");return ye.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),EB=de({isFinite_:function(e){var t=te(e,"x","isFinite");return ye.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Yt(n)}}})}}),DB=de({sin_:function(e){var t=te(e,"x","sin"),n=[t];return ye.runKernelFunc(function(a,r){var i=a.sin(t);return r([t]),i},{x:t},function(a,r){var i=r[0];return{x:function(){return i.toFloat().cos().mul(a)}}},"Sin",{},n)}}),TB=de({sinh_:function(e){var t=te(e,"x","sinh");return ye.runKernelFunc(function(n,a){var r=n.sinh(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return r.toFloat().cosh().mulStrict(n)}}})}}),LB=de({softplus_:function(e){var t=te(e,"x","softplus");return ye.runKernelFunc(function(n,a){var r=n.softplus(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.mul(r.sigmoid())}}})}}),PB=de({sqrt_:function(e){var t=te(e,"x","sqrt");return ye.runKernelFunc(function(n,a){var r=n.sqrt(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.toFloat().sqrt().mul(2))}}})}}),RB=de({step_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","step");return ye.runKernelFunc(function(a){return a.step(n,t)},{$x:n},function(a){return{$x:function(){return Yt(a)}}})}}),MB=de({tan_:function(e){var t=te(e,"x","tan");return ye.runKernelFunc(function(n,a){var r=n.tan(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return n.div(r.cos().square())}}})}}),OB=de({tanh_:function(e){var t=te(e,"x","tanh");return ye.runKernelFunc(function(n,a){var r=n.tanh(t);return a([r]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return at(1).sub(r.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function e6(e,t,n,a,r,i){var s,o,u=te(e,"x","batchNorm"),c=te(t,"mean","batchNorm"),d=te(n,"variance","batchNorm");return r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),se(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),se(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),s!=null&&se(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),o!=null&&se(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+o.rank+"."}),Ip(u,c,d,o,s,i)}function t6(e,t,n,a,r,i){var s,o,u=te(e,"x","batchNorm"),c=te(t,"mean","batchNorm"),d=te(n,"variance","batchNorm");return r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),se(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),se(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),s!=null&&se(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),o!=null&&se(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+o.rank+"."}),Ip(u,c,d,o,s,i)}function n6(e,t,n,a,r,i){var s,o,u=te(e,"x","batchNorm"),c=te(t,"mean","batchNorm"),d=te(n,"variance","batchNorm");return r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),se(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),se(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),s!=null&&se(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),o!=null&&se(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+o.rank+"."}),Ip(u,c,d,o,s,i)}function Ip(e,t,n,a,r,i){i==null&&(i=.001);var s,o,u,c=te(e,"x","batchNorm"),d=te(t,"mean","batchNorm"),h=te(n,"variance","batchNorm");r!=null&&(s=te(r,"scale","batchNorm")),a!=null&&(o=te(a,"offset","batchNorm")),se(d.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),se(o==null||d.rank===o.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),se(s==null||d.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=c.rank===0||c.rank===1?c.as4D(1,1,1,c.size):c.rank===2?c.as4D(1,1,c.shape[0],c.shape[1]):c.rank===3?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var p=[c,d,h,s];return ye.runKernelFunc(function(f,g){var b=f.batchNormalization(u,og(d),og(h),i,og(s),og(o));return g([c,d,h,s]),b},{x:c,mean:d,variance:h,scale:s,offset:o},function(f,g){var b=g,w=b[0],m=b[1],x=b[2],y=b[3],N=y??at(1),S=_a(m.shape,u.shape),D=[];if(m.rank===1){for(var _=0;_<u.shape.length-1;++_)D.push(u.shape[_]);D.push(1)}var A=w.sub(m),L=f.mul(N),P=QA(x.add(at(i))),j=P.mul(P).mul(P).mul(at(-.5));return{x:function(){return m.rank===1?f.mul(_d(P.as4D(1,1,1,m.shape[0]),D)).mul(N).reshape(w.shape):f.mul(P).mul(N).reshape(w.shape)},mean:function(){var E=P.mul(at(-1)).mul(L);return m.rank===1&&(E=E.sum(S)),E.reshape(m.shape)},variance:function(){var E=j.mul(A).mul(L);return m.rank===1&&(E=E.sum(S)),E.reshape(m.shape)},scale:function(){var E=A.mul(P),F=f.mul(E);return m.rank===1&&(F=F.sum(S)),F.reshape(m.shape)},offset:function(){var E=f;return m.rank===1&&(E=E.sum(S)),E.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:i},p).reshape(c.shape)}function og(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Fv(){vA("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var IB=de({batchNormalization2d_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),Fv(),e6(e,t,n,i,r,a)}}),FB=de({batchNormalization3d_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),Fv(),t6(e,t,n,i,r,a)}}),BB=de({batchNormalization4d_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),Fv(),n6(e,t,n,i,r,a)}}),zB=de({batchNormalization_:function(e,t,n,a,r,i){return a===void 0&&(a=.001),Fv(),Ip(e,t,n,i,r,a)}}),a6=de({batchNorm_:Ip}),UB=de({batchNorm2d_:e6}),qB=de({batchNorm3d_:t6}),WB=de({batchNorm4d_:n6}),Bv=de({logicalAnd_:function(e,t){var n=te(e,"a","logicalAnd","bool"),a=te(t,"b","logicalAnd","bool");return zt(n.shape,a.shape),ye.runKernelFunc(function(r){return r.logicalAnd(n,a)},{a:n,b:a},null,"LogicalAnd")}}),HB=de({logicalNot_:function(e){var t=te(e,"x","logicalNot","bool");return ye.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),r6=de({logicalOr_:function(e,t){var n=te(e,"a","logicalOr","bool"),a=te(t,"b","logicalOr","bool");return zt(n.shape,a.shape),ye.runKernelFunc(function(r){return r.logicalOr(n,a)},{$a:n,$b:a})}}),VB=de({logicalXor_:function(e,t){var n=te(e,"a","logicalXor","bool"),a=te(t,"b","logicalXor","bool");return zt(n.shape,a.shape),r6(e,t).logicalAnd(Bv(e,t).logicalNot())}}),Ku=de({where_:function(e,t,n){var a=te(t,"a","where"),r=te(n,"b","where"),i=te(e,"condition","where","bool");return sn(a.shape,r.shape,"Error in where: "),i.rank===1?se(i.shape[0]===a.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):sn(i.shape,r.shape,"Error in where: "),ye.runKernelFunc(function(s,o){var u=s.select(i,a,r);return o([i]),u},{$condition:i,$a:a,$b:r},function(s,o){var u=o[0];return{$condition:function(){return Yt(u).toFloat()},$a:function(){return s.mul(u.cast(s.dtype))},$b:function(){return s.mul(u.logicalNot().cast(s.dtype))}}})}}),i6=function(e){return lt(this,void 0,void 0,function(){var t,n,a;return ut(this,function(r){switch(r.label){case 0:return[4,(t=te(e,"condition","whereAsync","bool")).data()];case 1:return n=r.sent(),a=Xw(t.shape,n),e!==t&&t.dispose(),[2,a]}})})},Ot=de({add_:function(e,t){var n,a=te(e,"a","add"),r=te(t,"b","add");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s){return s.add(a,r)},{a,b:r},function(s){return{a:function(){var o=s,u=_a(a.shape,i);return u.length>0&&(o=o.sum(u)),o.reshape(a.shape)},b:function(){var o=s,u=_a(r.shape,i);return u.length>0&&(o=o.sum(u)),o.reshape(r.shape)}}},"Add")}}),GB=de({addN_:function(e){se(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),se(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(r,i){return te(r,"tensors"+i,"addN")}),n=t[0];t.forEach(function(r){if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(r){if(!Ia(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var a=t;return ye.runKernelFunc(function(r){return r.addN(t)},a,function(r){var i={};return t.forEach(function(s,o){i[o]=function(){return r.clone()}}),i},"AddN")}}),$B=de({addStrict_:function(e,t){var n=te(e,"a","addStrict"),a=te(t,"b","addStrict");return sn(n.shape,a.shape,"Error in addStrict: "),n.add(a)}}),KB=de({atan2_:function(e,t){var n,a=te(e,"a","atan2"),r=te(t,"b","atan2");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s,o){var u=s.atan2(a,r);return o([a,r]),u},{$a:a,$b:r},function(s,o){var u=o[0],c=o[1];return{$a:function(){var d=Ot(u.square(),c.square()),h=s.mul(c.div(d)),p=_a(u.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(u.shape)},$b:function(){var d=Ot(u.square(),c.square()),h=W0(s.mul(u.div(d))),p=_a(c.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(c.shape)}}})}}),rs=de({div_:function(e,t){var n,a=te(e,"a","div"),r=te(t,"b","div");if(n=qn(a,r),a=n[0],r=n[1],a.dtype==="int32"&&r.dtype==="int32")return s6(a,r);var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s,o){var u=s.realDivide(a,r);return o([a,r]),u},{a,b:r},function(s,o){var u=o[0],c=o[1];return{a:function(){var d=s.div(c.toFloat()),h=_a(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d},b:function(){var d=s.mul(u.toFloat()),h=_a(c.shape,i);h.length>0&&(d=d.sum(h).reshape(c.shape));var p=c.square();return d.div(p.toFloat()).neg()}}},"Div")}}),YB=de({divNoNan_:function(e,t){var n,a=te(e,"a","div"),r=te(t,"b","div");a=(n=qn(a,r))[0],r=n[1];var i=rs(a,r),s=Yt(i),o=r.equal(s);return Ku(o,s,i)}}),XB=de({divStrict_:function(e,t){var n=te(e,"a","div"),a=te(t,"b","div");return sn(n.shape,a.shape,"Error in divideStrict: "),n.div(a)}}),s6=de({floorDiv_:function(e,t){var n,a=te(e,"a","floorDiv"),r=te(t,"b","floorDiv");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s,o){var u=s.floorDiv(a,r);return o([a,r]),u},{a,b:r},function(s,o){var u=o[0],c=o[1];return{a:function(){var d=s.div(c.toFloat()),h=_a(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d},b:function(){var d=s.mul(u.toFloat()),h=_a(c.shape,i);h.length>0&&(d=d.sum(h).reshape(c.shape));var p=c.square();return d.div(p.toFloat()).neg()}}},"FloorDiv")}}),t5=de({maximum_:function(e,t){var n,a=te(e,"a","maximum"),r=te(t,"b","maximum");return n=qn(a,r),a=n[0],r=n[1],a.dtype==="bool"&&(a=a.toInt(),r=r.toInt()),zt(a.shape,r.shape),ye.runKernelFunc(function(i,s){var o=i.maximum(a,r);return s([a,r]),o},{a,b:r},function(i,s){var o=s[0],u=s[1];return{a:function(){return i.mul(o.greaterEqual(u).toFloat())},b:function(){return i.mul(o.less(u).toFloat())}}},"Maximum")}}),JB=de({maximumStrict_:function(e,t){var n=te(e,"a","maximumStrict"),a=te(t,"b","maximumStrict");return sn(n.shape,a.shape,"Error in maximumStrict: "),n.maximum(a)}}),o6=de({minimum_:function(e,t){var n,a=te(e,"a","minimum"),r=te(t,"b","minimum");return n=qn(a,r),a=n[0],r=n[1],a.dtype==="bool"&&(a=a.toInt(),r=r.toInt()),zt(a.shape,r.shape),ye.runKernelFunc(function(i,s){var o=i.minimum(a,r);return s([a,r]),o},{a,b:r},function(i,s){var o=s[0],u=s[1];return{a:function(){return i.mul(o.lessEqual(u).toFloat())},b:function(){return i.mul(o.greater(u).toFloat())}}},"Minimum")}}),QB=de({minimumStrict_:function(e,t){var n=te(e,"a","minimumStrict"),a=te(t,"b","minimumStrict");return sn(n.shape,a.shape,"Error in minimumStrict: "),n.minimum(a)}}),ZB=de({mod_:function(e,t){var n,a=te(e,"a","mod"),r=te(t,"b","mod");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s,o){var u=s.mod(a,r);return o([a,r]),u},{$a:a,$b:r},function(s,o){var u=o[0],c=o[1];return{$a:function(){var d=_a(u.shape,i);return d.length>0?s.sum(d).reshape(u.shape):s},$b:function(){var d=s.mul(u.div(c).floor().neg()),h=_a(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d}}})}}),e9=de({modStrict_:function(e,t){var n=te(e,"a","modStrict"),a=te(t,"b","modStrict");return sn(n.shape,a.shape,"Error in modStrict: "),n.mod(a)}}),cr=de({mul_:function(e,t){var n,a=te(e,"a","mul"),r=te(t,"b","mul");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s,o){var u=s.multiply(a,r);return o([a,r]),u},{a,b:r},function(s,o){var u=o[0],c=o[1];return{a:function(){var d=s.mul(c.toFloat()),h=_a(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d},b:function(){var d=s.mul(u.toFloat()),h=_a(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d}}},"Mul")}}),t9=de({mulStrict_:function(e,t){var n=te(e,"a","mul"),a=te(t,"b","mul");return sn(n.shape,a.shape,"Error in multiplyStrict: "),n.mul(a)}}),H0=de({pow_:function(e,t){var n,a=te(e,"base","pow"),r=te(t,"exp","pow");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape),s=[a,r];return ye.runKernelFunc(function(o,u){var c=o.pow(a,r);return u([a,r,c]),c},{a,b:r},function(o,u){var c=u[0],d=u[1],h=u[2];return{a:function(){var p=d.toFloat(),f=o.mul(p.mul(c.pow(p.sub(at(1))))),g=_a(c.shape,i);return g.length>0&&(f=f.sum(g)),f.reshape(c.shape)},b:function(){var p=c.greater(0),f=c.log().where(p,Yt(c)),g=o.mul(h.mul(f)),b=_a(d.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(d.shape)}}},"Pow",{},s,[!0])}}),n9=de({powStrict_:function(e,t){return sn(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),a9=de({squaredDifferenceStrict_:function(e,t){var n=te(e,"a","squaredDifferenceStrict"),a=te(t,"b","squaredDifferenceStrict");return sn(n.shape,a.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(a)}}),ja=de({sub_:function(e,t){var n,a=te(e,"a","sub"),r=te(t,"b","sub");n=qn(a,r),a=n[0],r=n[1];var i=zt(a.shape,r.shape);return ye.runKernelFunc(function(s){return s.subtract(a,r)},{a,b:r},function(s){return{a:function(){var o=s,u=_a(a.shape,i);return u.length>0&&(o=o.sum(u)),o.reshape(a.shape)},b:function(){var o=s,u=_a(r.shape,i);return u.length>0&&(o=o.sum(u)),o.neg().reshape(r.shape)}}},"Sub")}}),r9=de({subStrict_:function(e,t){var n=te(e,"a","subStrict"),a=te(t,"b","subStrict");return sn(n.shape,a.shape,"Error in subStrict: "),n.sub(a)}}),l6=de({equal_:function(e,t){var n,a=te(e,"a","equal"),r=te(t,"b","equal");return n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),ye.runKernelFunc(function(i){return i.equal(a,r)},{$a:a,$b:r})}}),i9=de({equalStrict_:function(e,t){var n=te(e,"a","equalStrict"),a=te(t,"b","equalStrict");return sn(n.shape,a.shape,"Error in equalStrict: "),n.equal(a)}}),s9=de({greater_:function(e,t){var n,a=te(e,"a","greater"),r=te(t,"b","greater");return n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),ye.runKernelFunc(function(i){return i.greater(a,r)},{a,b:r},null,"Greater")}}),u6=de({greaterEqual_:function(e,t){var n,a=te(e,"a","greaterEqual"),r=te(t,"b","greaterEqual");return n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),ye.runKernelFunc(function(i,s){var o=i.greaterEqual(a,r);return s([a,r]),o},{a,b:r},function(i,s){var o=s[0],u=s[1];return{a:function(){return Yt(o)},b:function(){return Yt(u)}}},"GreaterEqual")}}),o9=de({greaterEqualStrict_:function(e,t){var n=te(e,"a","greaterEqualStrict"),a=te(t,"b","greaterEqualStrict");return sn(n.shape,a.shape,"Error in greaterEqualStrict: "),n.greaterEqual(a)}}),l9=de({greaterStrict_:function(e,t){var n=te(e,"a","greaterStrict"),a=te(t,"b","greaterStrict");return sn(n.shape,a.shape,"Error in greaterStrict: "),n.greater(a)}}),u9=de({less_:function(e,t){var n,a=te(e,"a","less"),r=te(t,"b","less");return n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),ye.runKernelFunc(function(i){return i.less(a,r)},{a,b:r},null,"Less")}}),c9=de({lessEqual_:function(e,t){var n,a=te(e,"a","lessEqual"),r=te(t,"b","lessEqual");return n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),ye.runKernelFunc(function(i,s){var o=i.lessEqual(a,r);return s([a,r]),o},{a,b:r},null,"LessEqual")}}),d9=de({lessEqualStrict_:function(e,t){var n=te(e,"a","lessEqualStrict"),a=te(t,"b","lessEqualStrict");return sn(n.shape,a.shape,"Error in lessEqualStrict: "),n.lessEqual(a)}}),h9=de({lessStrict_:function(e,t){var n=te(e,"a","lessStrict"),a=te(t,"b","lessStrict");return sn(n.shape,a.shape,"Error in lessStrict: "),n.less(a)}}),f9=de({notEqual_:function(e,t){var n,a=te(e,"a","notEqual"),r=te(t,"b","notEqual");return n=qn(a,r),a=n[0],r=n[1],zt(a.shape,r.shape),ye.runKernelFunc(function(i){return i.notEqual(a,r)},{a,b:r},null,"NotEqual")}}),p9=de({notEqualStrict_:function(e,t){var n=te(e,"a","notEqualStrict"),a=te(t,"b","notEqualStrict");return sn(n.shape,a.shape,"Error in notEqualStrict: "),n.notEqual(a)}});function H4(e,t){for(var n=[],a=e;a<t;++a)n.push(a);return n}function V4(e){for(var t=[],n=0;n<e.length;++n)for(var a=0;a<e[n].length;++a)t.push(e[n][a]);return t}var n5=de({gather_:function(e,t,n){n===void 0&&(n=0);var a=te(e,"x","gather"),r=te(t,"indices","gather","int32");n=Ca(n,a.shape)[0];var i=function(s,o,u){for(var c=s.shape[u],d=[],h=1,p=1,f=0;f<u;f++)d.push(s.shape[f]),h*=s.shape[f];for(f=0;f<o.rank;f++)d.push(o.shape[f]);for(f=u+1;f<s.rank;f++)d.push(s.shape[f]),p*=s.shape[f];return{batchSize:h,sliceSize:p,dimSize:c,outputShape:d}}(a,r,n);return ye.runKernelFunc(function(s,o){var u=s.gather(a,r.flatten(),n);return o([r]),u},{x:a,indices:r},function(s,o){var u=o[0];return{x:function(){var c=a.shape,d=u.size,h=c.slice(0,n),p=h.length,f=c.slice(n,c.length).slice(1),g=f.length,b=H4(0,p),w=H4(p+1,p+1+g),m=V4([h,[d],f]),x=s.reshape(m),y=u.reshape([d]),N=V4([[p],b,w]),S=x.transpose(N),D=c6(S,y,a.shape[n]),_=qw(N);return D=D.transpose(_)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),c6=de({unsortedSegmentSum_:function(e,t,n){var a=te(e,"x","unsortedSegmentSum"),r=te(t,"segmentIds","unsortedSegmentSum","int32");return se(sa(n),function(){return"numSegments must be of dtype int"}),ye.runKernelFunc(function(i,s){var o=i.unsortedSegmentSum(a,r,n);return s([r]),o},{$x:a},function(i,s){var o=s[0];return{$x:function(){return function(u,c){for(var d=t5(c,Yt(c)),h=n5(u,d),p=u6(c,at(0,"int32")),f=h.rank-p.rank,g=0;g<f;++g)p=Mi(p,g+1);p=Bv(p,dh(h.shape,"bool"));var b=Yt(h);return Ku(p,h,b)}(i,o)}}})}}),m9=function(e,t,n){return lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h,p,f,g,b;return ut(this,function(w){switch(w.label){case 0:for(a=te(e,"tensor","boolMask"),r=te(t,"mask","boolMask","bool"),i=n??0,s=r.rank,o=a.shape,se(s>0,function(){return"mask cannot be scalar"}),sn(o.slice(i,i+s),r.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+s;c++)u*=o[c];return d=o.slice(0,i).concat([u],o.slice(i+s)),h=a.reshape(d),p=r.reshape([-1]),[4,i6(p)];case 1:return f=w.sent(),g=f.squeeze([1]),b=n5(h,g,i),e!==a&&a.dispose(),t!==r&&r.dispose(),g.dispose(),h.dispose(),p.dispose(),f.dispose(),[2,b]}})})};function d6(e,t,n,a,r,i,s){i===void 0&&(i="NHWC"),se(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var o=e,u=t,c=!1;t.rank===3&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),o=[1,e[0],e[1],e[2]]),se(o.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+o.length+"."}),se(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),se(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var d=i==="NHWC"?o[3]:o[1],h=i==="NHWC"?u.shape[3]:u.shape[1];se(d===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+n.shape[2]+"."}),se(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),s!=null&&se(sa(r),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var p=$w(i),f=rc(o,n.shape,a,1,r,s,!1,p),g=ye.runKernelFunc(function(b,w){var m=b.conv2dDerInput(u,n,f);return w([n,u]),m},{dy4D:u,filter:n},function(b,w){var m=w[0],x=w[1];return{dy4D:function(){return $i(b,m,a,r,i,1,s)},filter:function(){return a5(b,x,m.shape,a,r,i,s)}}});return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}function Zb(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],a=t[1],r=t[2];return n===1&&a===1&&r===1}function h6(e,t,n,a,r){se(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,s=t,o=!1;t.rank===4&&(o=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=s.shape[4];se(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),se(s.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),se(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),se(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),se(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var d=U0(i,n.shape,a,1,r),h=ye.runKernelFunc(function(p){return p.conv3dDerInput(s,n,d)},{dy5D:s});return o?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var g9=de({conv1d_:function(e,t,n,a,r,i,s){r===void 0&&(r="NWC"),i===void 0&&(i=1);var o=te(e,"x","conv1d"),u=te(t,"filter","conv1d"),c=o,d=!1;o.rank===2&&(d=!0,c=o.as3D(1,o.shape[0],o.shape[1])),se(c.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),se(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),s!=null&&se(sa(a),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}),se(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),se(qr(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),se(r==="NWC",function(){return"Error in conv1d: got dataFormat of "+r+" but only NWC is currently supported."});var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=$i(p,h,[1,n],a,"NHWC",[1,i],s);return d?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),$i=de({conv2d_:function(e,t,n,a,r,i,s){r===void 0&&(r="NHWC"),i===void 0&&(i=[1,1]);var o=te(e,"x","conv2d"),u=te(t,"filter","conv2d"),c=o,d=!1;o.rank===3&&(d=!0,c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),se(c.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),se(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),s!=null&&se(sa(a),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var h=r==="NHWC"?c.shape[3]:c.shape[1];se(h===u.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."}),se(qr(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var p=$w(r),f=rc(c.shape,u.shape,n,i,a,s,!1,p),g=[u,c],b=ye.runKernelFunc(function(w,m){var x=w.conv2d(c,u,f);return m([u,c]),x},{x:c,filter:u},function(w,m){var x=m,y=x[0],N=x[1];return se(Xd(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return f6(N.shape,w,y,n,a,r)},filter:function(){return a5(N,w,y.shape,n,a,r)}}},"Conv2D",f,g);return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),v9=de({conv3d_:function(e,t,n,a,r,i){r===void 0&&(r="NDHWC"),i===void 0&&(i=[1,1,1]);var s=te(e,"x","conv3d"),o=te(t,"filter","conv3d"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),se(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),se(o.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+o.rank+"."}),se(u.shape[4]===o.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+o.shape[3]+"."}),se(function(p,f){return Zb(p)||Zb(f)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),se(r==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+r+" but only NDHWC is currently supported."});var d=U0(u.shape,o.shape,n,i,a),h=ye.runKernelFunc(function(p,f){var g=p.conv3d(u,o,d);return f([u,o]),g},{x:u,$filter:o},function(p,f){se(Zb(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var g=f[0],b=f[1];return{x:function(){return h6(g.shape,p,b,n,a)},$filter:function(){return function(w,m,x,y,N){var S=w;w.rank===4&&(S=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]));var D=m;D.rank===4&&(D=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),se(S.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+S.shape+"."}),se(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),se(x.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+x+"."}),se(S.shape[4]===x[3],function(){return"Error in conv3dDerFilter: depth of input "+S.shape[4]+") must match input depth in filter ("+x[3]+"."}),se(D.shape[4]===x[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+x[4]+")."});var _=U0(S.shape,x,y,1,N);return ye.runKernelFunc(function(A){return A.conv3dDerFilter(S,D,_)},{x5D:S,dy5D:D})}(g,p,b.shape,n,a)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),a5=de({conv2dDerFilter_:function(e,t,n,a,r,i,s){i===void 0&&(i="NHWC");var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),se(o.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+o.shape+"."}),se(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),se(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c=i==="NHWC"?o.shape[3]:o.shape[1],d=i==="NHWC"?u.shape[3]:u.shape[1];se(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),se(d===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+n[3]+")."}),s!=null&&se(sa(r),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var h=$w(i),p=rc(o.shape,n,a,1,r,s,!1,h);return ye.runKernelFunc(function(f){return f.conv2dDerFilter(o,u,p)},{x4D:o,dy4D:u})}}),f6=de({conv2dDerInput_:d6}),zv=de({depthwiseConv2d_:function(e,t,n,a,r,i,s){i===void 0&&(i=[1,1]);var o=te(e,"x","depthwiseConv2d"),u=te(t,"filter","depthwiseConv2d"),c=o,d=!1;o.rank===3&&(d=!0,c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),se(c.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),se(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),se(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),se(qr(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),s!=null&&se(sa(a),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var h=rc(c.shape,u.shape,n,i,a,s,!0),p=[c,u],f=ye.runKernelFunc(function(g,b){var w=g.depthwiseConv2D(c,u,h);return b([c,u]),w},{x:c,filter:u},function(g,b){se(Xd(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var w=b[0],m=b[1];return{x:function(){return p6(w.shape,g,m,h)},filter:function(){return m6(w,g,m.shape,h)}}},"DepthwiseConv2dNative",h,p);return d?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),p6=de({depthwiseConv2dDerInput_:function(e,t,n,a){var r=t,i=!1;t.rank===3&&(i=!0,r=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=ye.runKernelFunc(function(o){return o.depthwiseConv2DDerInput(r,n,a)},{dy4D:r});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),m6=de({depthwiseConv2dDerFilter_:function(e,t,n,a){var r=e;e.rank===3&&(r=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),ye.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(r,i,a)},{x4D:r,dy4D:i})}}),r5=de({separableConv2d_:function(e,t,n,a,r,i,s){i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC");var o=te(e,"x","separableConv2d"),u=te(t,"depthwiseFilter","separableConv2d"),c=te(n,"pointwiseFilter","separableConv2d"),d=o,h=!1;if(o.rank===3&&(h=!0,d=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");se(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),se(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),se(c.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),se(c.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),se(c.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var p=u.shape[2],f=u.shape[3];se(c.shape[2]===p*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*f+", but got "+c.shape[2]+"."});var g=zv(d,u,a,r,s,i),b=$i(g,c,1,"valid",s);return h?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),x9=de({conv2dTranspose_:function(e,t,n,a,r,i){return d6(n,te(e,"x","conv2dTranspose"),te(t,"filter","conv2dTranspose"),a,r,"NHWC",i)}}),b9=de({conv3dTranspose_:function(e,t,n,a,r){return h6(n,te(e,"x","conv3dTranspose"),te(t,"filter","conv3dTranspose"),a,r)}}),Uv=de({matMul_:function(e,t,n,a){var r;n===void 0&&(n=!1),a===void 0&&(a=!1);var i=te(e,"a","matMul"),s=te(t,"b","matMul");r=qn(i,s),i=r[0],s=r[1];var o=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=a?s.shape[s.rank-1]:s.shape[s.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],d=a?s.shape[s.rank-2]:s.shape[s.rank-1],h=i.shape.slice(0,-2),p=s.shape.slice(0,-2),f=dt(h),g=dt(p);se(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),se(Ia(h,p),function(){return"Error in matMul: outer dimensions ("+h+") and ("+p+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),se(o===u,function(){return"Error in matMul: inner shapes ("+o+") and ("+u+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+n+" and transposeB="+a+" must match."});var b=i.shape.slice(0,-2).concat([c,d]),w=n?i.as3D(f,o,c):i.as3D(f,c,o),m=a?s.as3D(g,d,u):s.as3D(g,u,d),x={transposeA:n,transposeB:a};return ye.runKernelFunc(function(y,N){var S=y.batchMatMul(w,m,n,a);return N([w,m]),S},{a:w,b:m},function(y,N){var S=N,D=S[0],_=S[1];return n||a?!n&&a?{a:function(){return y.matMul(_,!1,!1)},b:function(){return y.matMul(D,!0,!1)}}:n&&!a?{a:function(){return _.matMul(y,!1,!0)},b:function(){return D.matMul(y,!1,!1)}}:{a:function(){return _.matMul(y,!0,!0)},b:function(){return y.matMul(D,!0,!0)}}:{a:function(){return y.matMul(_,!1,!0)},b:function(){return D.matMul(y,!0,!1)}}},"BatchMatMul",x).reshape(b)}}),y9=de({dot_:function(e,t){var n=te(e,"t1","dot"),a=te(t,"t2","dot");se(!(n.rank!==1&&n.rank!==2||a.rank!==1&&a.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+a.rank+"."});var r=n.rank===1?n.size:n.shape[1],i=a.rank===1?a.size:a.shape[0];return se(r===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+r+" and "+i+"."}),n.rank===1&&a.rank===1?n.as2D(1,-1).matMul(a.as2D(-1,1)).asScalar():n.rank===1&&a.rank===2?n.as2D(1,-1).matMul(a.as2D(a.shape[0],a.shape[1])).as1D():n.rank===2&&a.rank===1?n.matMul(a.as2D(-1,1)).as1D():n.matMul(a.as2D(a.shape[0],a.shape[1]))}}),w9=de({outerProduct_:function(e,t){var n=te(e,"v1","outerProduct"),a=te(t,"v2","outerProduct");return se(n.rank===1&&a.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+a.rank+"."}),n.as2D(-1,1).matMul(a.as2D(1,-1))}}),Fp=de({reverse_:function(e,t){var n=te(e,"x","reverse");if(n.rank===0)return n.clone();var a=Ca(t,n.shape);return ye.runKernelFunc(function(r){return r.reverse(n,a)},{$x:n},function(r){return{$x:function(){return r.reverse(a)}}}).reshapeAs(n)}}),N9=de({reverse1d_:function(e){var t=te(e,"x","reverse");return se(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Fp(t,0)}}),k9=de({reverse2d_:function(e,t){var n=te(e,"x","reverse");return se(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Fp(n,t)}}),S9=de({reverse3d_:function(e,t){var n=te(e,"x","reverse");return se(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Fp(n,t)}}),_9=de({reverse4d_:function(e,t){var n=te(e,"x","reverse");return se(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Fp(n,t)}});function g6(e,t,n,a,r,i){var s=te(e,"x","maxPool"),o=s,u=!1;s.rank===3&&(u=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),se(o.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+o.rank+"."}),se(qr(n,a),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),i!=null&&se(sa(r),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=Zf(o.shape,t,n,a,r,i);if(c.filterWidth===1&&c.filterHeight===1&&Ia(c.inShape,c.outShape))return s.clone();var d=[o],h=ye.runKernelFunc(function(p,f){var g=p.maxPool(o,c);return f([o,g]),g},{x:o},function(p,f){var g=f[0],b=f[1];return{x:function(){return function(w,m,x,y,N,S,D,_){var A=te(w,"dy","maxPoolBackprop"),L=te(m,"input","maxPoolBackprop"),P=te(x,"output","maxPoolBackprop");se(L.rank===A.rank,function(){return"Rank of input ("+L.rank+") does not match rank of dy ("+A.rank+")"}),se(qr(N,S),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+S+"'"}),se(A.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+A.rank+"."}),se(L.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+L.rank+"."});var j=Zf(L.shape,y,N,S,D,_);return ye.runKernelFunc(function(E){return E.maxPoolBackprop(A,L,P,j)},{$dy:A,$input:L})}(p,g,b,t,n,a,r)}}},"MaxPool",c,d);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function v6(e,t,n,a,r,i){var s=te(e,"x","avgPool","float32");se(qr(n,a),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var o=s,u=!1;s.rank===3&&(u=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),se(o.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+o.rank+"."}),i!=null&&se(sa(r),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=Zf(o.shape,t,n,a,r,i);if(c.filterWidth===1&&c.filterHeight===1&&Ia(c.inShape,c.outShape))return s.clone();var d=ye.runKernelFunc(function(h){return h.avgPool(o,c)},{x:o},function(h){return{x:function(){return function(p,f,g,b,w,m){var x=te(p,"dy","avgPoolBackprop"),y=te(f,"input","avgPoolBackprop");se(y.rank===x.rank,function(){return"Rank of input ("+y.rank+") does not match rank of dy ("+x.rank+")"}),se(qr(b,w),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+w+"'"});var N=y,S=x,D=!1;y.rank===3&&(D=!0,N=y.as4D(1,y.shape[0],y.shape[1],y.shape[2]),S=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),se(S.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+S.rank+"."}),se(N.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var _=Zf(N.shape,g,b,w,m),A=ye.runKernelFunc(function(L){return L.avgPoolBackprop(S,N,_)},{dy4D:S,input4D:N});return D?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}(h,o,t,n,a,r)}}},"AvgPool",c);return d=d.cast(s.dtype),u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var La=de({maxPool_:function(e,t,n,a,r){return g6(e,t,n,1,a,r)}}),Bp=de({avgPool_:function(e,t,n,a,r){return v6(e,t,n,1,a,r)}}),j9=de({pool_:function(e,t,n,a,r,i){r==null&&(r=[1,1]),i==null&&(i=1),a===0&&(a="valid");var s=te(e,"x","maxPool"),o=s,u=!1;s.rank===3&&(u=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),se(qr(i,r),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+r+"'"});var c,d=Zf(o.shape,t,i,r,a),h=[d.dilationHeight,d.dilationWidth];c=a==="same"?function(N,S){var D=N.map(function(L,P){return L+(L-1)*(S[P]-1)}).map(function(L){return L-1}),_=D.map(function(L){return Math.floor(L/2)}),A=D.map(function(L,P){return L-_[P]});return D.map(function(L,P){return[_[P],A[P]]})}([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];var p=h[0]===1&&h[1]===1,f=function(N,S,D){var _=D.map(function(z){return z[0]}),A=D.map(function(z){return z[1]}),L=N.concat(_,A),P=S.map(function(z,U){return(z-L[U]%z)%z}),j=A.map(function(z,U){return z+P[U]}),E=S.map(function(z,U){return[_[U],j[U]]}),F=S.map(function(z,U){return[0,P[U]]});return[E,F]}([d.inHeight,d.inWidth],h,c),g=f[0],b=f[1],w=p?a:"valid",m=p?o:kA(o,h,g),x=(n==="avg"?function(){return v6(m,t,i,1,w)}:function(){return g6(m,t,i,1,w)})(),y=p?x:yA(x,h,b);return u?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),C9=de({maxPool3d_:function(e,t,n,a,r,i,s){i===void 0&&(i="NDHWC");var o=te(e,"x","maxPool3d"),u=o,c=!1;o.rank===4&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),s==null&&(s=[1,1,1]),se(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),se(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),se(qr(n,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"}),r!=null&&se(sa(a),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+r+" but got pad "+a+"."});var d=z0(u.shape,t,n,s,a,r,i),h=ye.runKernelFunc(function(p,f){var g=p.maxPool3d(u,d);return f([u,g]),g},{x:u},function(p,f){var g=f[0],b=f[1];return{x:function(){return function(w,m,x,y,N,S,D,_){var A=te(w,"dy","maxPool3dBackprop"),L=te(m,"input","maxPool3dBackprop"),P=te(x,"output","maxPool3dBackprop"),j=A,E=L,F=P,z=!1;L.rank===4&&(z=!0,j=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3]),E=L.as5D(1,L.shape[0],L.shape[1],L.shape[2],L.shape[3]),F=P.as5D(1,P.shape[0],P.shape[1],P.shape[2],P.shape[3])),se(j.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+j.rank+"."}),se(E.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+E.rank+"."}),se(F.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+F.rank+"."}),S==null&&(S=[1,1,1]),se(qr(N,S),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+S+"'"}),_!=null&&se(sa(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+_+" but got pad "+D+"."});var U=z0(E.shape,y,N,S,D,_),O=ye.runKernelFunc(function(B){return B.maxPool3dBackprop(j,E,F,U)},{dy5D:j,input5D:E});return z?O.as4D(O.shape[1],O.shape[2],O.shape[3],O.shape[4]):O}(p,g,b,t,n,s,a,r)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),A9=de({avgPool3d_:function(e,t,n,a,r,i,s){i===void 0&&(i="NDHWC");var o=te(e,"x","avgPool3d","float32"),u=o,c=!1;o.rank===4&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),s==null&&(s=[1,1,1]),se(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),se(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),se(qr(n,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"}),r!=null&&se(sa(a),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+r+" but got pad "+a+"."});var d=z0(u.shape,t,n,s,a,r,i),h=ye.runKernelFunc(function(p){return p.avgPool3d(u,d)},{x:u},function(p){return{x:function(){return function(f,g,b,w,m,x,y){var N=te(f,"dy","avgPool3dBackprop"),S=te(g,"input","avgPool3dBackprop"),D=N,_=S,A=!1;S.rank===4&&(A=!0,D=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),_=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),se(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),se(_.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+_.rank+"."}),m==null&&(m=[1,1,1]),se(qr(w,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+m+"'"}),y!=null&&se(sa(x),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+y+" but got pad "+x+"."});var L=z0(_.shape,b,w,m,x,y),P=ye.runKernelFunc(function(j){return j.avgPool3dBackprop(D,_,L)},{dy5D:D,input5D:_});return A?P.as4D(P.shape[1],P.shape[2],P.shape[3],P.shape[4]):P}(p,u,t,n,s,a,r)}}});return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Ws=de({slice_:function(e,t,n){var a,r,i=te(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(a=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){se(u!==-1,function(){return"slice() does not support negative begin indexing."})}),r=(r=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,c){return u>=0?u:(se(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),i.shape[c]-a[c])}),n7(i,a,r);var s=i.shape,o={begin:a,size:r};return ye.runKernelFunc(function(u){return u.slice(i,a,r)},{x:i},function(u){for(var c=[],d=0;d<u.rank;d++)c.push([a[d],s[d]-a[d]-r[d]]);return{x:function(){return u.pad(c)}}},"Slice",o)}}),E9=de({slice1d_:function(e,t,n){var a=te(e,"x","slice1d");return se(a.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+a.rank+" tensor"}),Ws(a,[t],[n])}}),D9=de({slice2d_:function(e,t,n){var a=te(e,"x","slice2d");return se(a.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+a.rank+" tensor"}),Ws(a,t,n)}}),x6=de({slice3d_:function(e,t,n){var a=te(e,"x","slice3d");return se(a.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+a.rank+" tensor"}),Ws(a,t,n)}}),T9=de({slice4d_:function(e,t,n){var a=te(e,"x","slice4d");return se(a.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+a.rank+" tensor"}),Ws(a,t,n)}});function b6(e,t,n,a,r){return t.rank<n.rank&&(t=t.reshape(Ur(t.shape,a))),e.rank<n.rank&&(e=e.reshape(Ur(e.shape,a))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return r==null?i:i.transpose(r)}}}var L9=de({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","all","bool"),r=Ca(t,a.shape),i=r,s=Ks(i,a.rank);s!=null&&(a=a.transpose(s),i=Ys(i.length,a.rank));var o=ye.runKernelFunc(function(c){return c.all(a,i)},{$x:a});if(n){var u=Ur(o.shape,r);return o.reshape(u)}return o}}),P9=de({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","any","bool"),r=Ca(t,a.shape),i=r,s=Ks(i,a.rank);s!=null&&(a=a.transpose(s),i=Ys(i.length,a.rank));var o=ye.runKernelFunc(function(c){return c.any(a,i)},{$x:a});if(n){var u=Ur(o.shape,r);return o.reshape(u)}return o}}),R9=de({argMax_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","argMax");t==null&&(t=0);var a=Ca(t,n.shape),r=Ks(a,n.rank);r!=null&&(n=n.transpose(r),a=Ys(a.length,n.rank));var i={axis:a[0]},s=[n];return ye.runKernelFunc(function(o,u){var c=o.argMax(n,a[0]);return u([n]),c},{x:n},function(o,u){var c=u[0];return{x:function(){return Yt(c)}}},"ArgMax",i,s)}}),M9=de({argMin_:function(e,t){t===void 0&&(t=0);var n=te(e,"x","argMin");t==null&&(t=0);var a=Ca(t,n.shape),r=Ks(a,n.rank);return r!=null&&(n=n.transpose(r),a=Ys(a.length,n.rank)),ye.runKernelFunc(function(i,s){var o=i.argMin(n,a[0]);return s([n]),o},{$x:n},function(i,s){var o=s[0];return{$x:function(){return Yt(o)}}})}}),O9=de({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","logSumExp"),r=Ca(t,a.shape),i=a.max(r,!0),s=a.sub(i).exp().sum(r).log(),o=i.reshape(s.shape).add(s);if(n){var u=Ur(o.shape,r);return o.reshape(u)}return o}}),qv=de({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","max"),r=a,i=Ca(t,a.shape),s=i,o=Ks(s,a.rank);o!=null&&(a=a.transpose(o),s=Ys(s.length,a.rank));var u=[a],c=ye.runKernelFunc(function(h,p){var f=h.max(a,s);return p([r,f]),f},{x:a},function(h,p){return b6(h,p[1],p[0],i,o)},"Max",{axes:s},u,[!0]);if(n){var d=Ur(c.shape,i);c=c.reshape(d)}return c}}),I9=de({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","mean"),r=Ca(t,a.shape),i=dt(ar(a.shape,r)[1]);return Iv(function(s){var o=at(i);return{value:(o.dtype===s.dtype?s:s.cast(o.dtype)).div(o).sum(t,n),gradFunc:function(u){var c=s.shape.slice();return r.forEach(function(d){c[d]=1}),u.reshape(c).mul(dh(s.shape,"float32")).div(i)}}})(a)}}),F9=de({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","min"),r=a,i=Ca(t,a.shape),s=i,o=Ks(s,a.rank);o!=null&&(a=a.transpose(o),s=Ys(s.length,a.rank));var u=[a],c=ye.runKernelFunc(function(h,p){var f=h.min(a,s);return p([r,f]),f},{x:a},function(h,p){return b6(h,p[1],p[0],i,o)},"Min",{axes:s},u,[!0]);if(n){var d=Ur(c.shape,i);c=c.reshape(d)}return c}}),B9=de({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=Ca(t,(e=te(e,"x","moments")).shape),r=e.mean(a,n),i=r.shape;n||(i=Ur(r.shape,a));var s=e.toFloat().sub(r.reshape(i)).square();return{mean:r,variance:s.mean(a,n)}}}),y6=de({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","sum");a.dtype==="bool"&&(a=a.toInt());var r=Ca(t,a.shape);return Iv(function(i){var s=Ks(r,i.rank),o=r,u=i;s!=null&&(u=i.transpose(s),o=Ys(o.length,i.rank));var c=function(f){var g=i.shape.slice();return r.forEach(function(b){g[b]=1}),f.reshape(g).mul(dh(i.shape,"float32"))},d={axes:o},h=ye.runKernelFunc(function(f){return f.sum(u,o)},{x:u},function(f){return{x:function(){return c(f)}}},"Sum",d);if(n){var p=Ur(h.shape,r);h=h.reshape(p)}return{value:h,gradFunc:c}})(a)}}),z9=de({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var a=te(e,"x","prod");a.dtype==="bool"&&(a=a.toInt());var r=Ca(t,a.shape),i=Ks(r,a.rank),s=r,o=a;i!=null&&(o=a.transpose(i),s=Ys(s.length,a.rank));var u=ye.runKernelFunc(function(d){return d.prod(o,s)},{permutedX:o});if(n){var c=Ur(u.shape,r);u=u.reshape(c)}return u}}),w6=de({elu_:function(e){var t=te(e,"x","elu");return ye.runKernelFunc(function(n,a){var r=n.elu(t);return a([r]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){return ye.runKernelFunc(function(i){return i.eluDer(n,r)},{dy:n,y:r})}}})}}),U9=de({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=te(e,"x","leakyRelu");return t5(at(t).mul(n),n)}}),N6=de({prelu_:function(e,t){var n=te(e,"x","prelu"),a=te(t,"alpha","prelu");return ye.runKernelFunc(function(r,i){var s=r.prelu(n,a);return i([n,a]),s},{x:n,alpha:a},function(r,i){var s=i[0],o=i[1],u=s.greater(0);return{x:function(){return Ku(u,r,r.mul(o))},alpha:function(){var c=Ku(u,Yt(r),r.mul(s)),d=_a(o.shape,r.shape);return d.length>0&&(c=c.sum(d)),c.reshape(o.shape)}}},"Prelu")}}),Un=de({relu_:function(e){var t=te(e,"x","relu");return t.dtype==="bool"?t.toInt():ye.runKernelFunc(function(n,a){var r=n.relu(t);return a([t]),r},{x:t},function(n,a){var r=a[0];return{x:function(){return n.mulStrict(r.step().toFloat())}}},"Relu")}}),k6=de({relu6_:function(e){var t=te(e,"x","relu6");return t.dtype==="bool"?t.toInt():ye.runKernelFunc(function(n,a){var r=n.relu6(t);return a([t]),r},{x:t},function(n,a){var r=a[0],i=r.lessEqual(6).mul(r.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),q9=de({selu_:function(e){var t=te(e,"x","selu");return ye.runKernelFunc(function(n,a){var r=n.selu(t);return a([t]),r},{$x:t},function(n,a){var r=a[0];return{$x:function(){var i=r.greater(at(0)),s=at(Qw),o=at(Zw),u=n.mul(o),c=n.mul(s).mul(r.toFloat().exp());return Ku(i,u,c)}}})}}),Wl=de({transpose_:function(e,t){var n=te(e,"x","transpose");if(t==null&&(t=n.shape.map(function(r,i){return i}).reverse()),se(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(r){se(r>=0&&r<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var a={perm:t};return ye.runKernelFunc(function(r){return r.transpose(n,t)},{x:n},function(r){var i=qw(t);return{x:function(){return r.transpose(i)}}},"Transpose",a)}}),W9=de({localResponseNormalization_:function(e,t,n,a,r){t===void 0&&(t=5),n===void 0&&(n=1),a===void 0&&(a=1),r===void 0&&(r=.5);var i=te(e,"x","localResponseNormalization");se(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),se(sa(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var s=i,o=!1;i.rank===3&&(o=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=ye.runKernelFunc(function(c,d){var h=c.localResponseNormalization4D(s,t,n,a,r);return d([s,h]),h},{x4D:s},function(c,d){var h=d[0],p=d[1];return{x4D:function(){return ye.runKernelFunc(function(f){return f.LRNGrad(c,h,p,t,n,a,r)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),S6=de({norm_:function(e,t,n,a){t===void 0&&(t="euclidean"),n===void 0&&(n=null),a===void 0&&(a=!1);var r=function o(u,c,d){if(d===void 0&&(d=null),u.rank===0)return u.abs();if(u.rank!==1&&d===null)return o(u.reshape([-1]),c,d);if(u.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(c===1)return u.abs().sum(d);if(c===1/0)return u.abs().max(d);if(c===-1/0)return u.abs().min(d);if(c==="euclidean"||c===2)return u.abs().pow(at(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(d)&&d.length===2){if(c===1)return u.abs().sum(d[0]).max(d[1]-1);if(c===1/0)return u.abs().sum(d[1]).max(d[0]);if(c===-1/0)return u.abs().sum(d[1]).min(d[0]);if(c==="fro"||c==="euclidean")return u.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+d)}(e=te(e,"x","norm"),t,n),i=r.shape;if(a){var s=Ca(n,e.shape);i=Ur(r.shape,s)}return r.reshape(i)}}),H9=de({basicLSTMCell_:function(e,t,n,a,r,i){var s=te(e,"forgetBias","basicLSTMCell"),o=te(t,"lstmKernel","basicLSTMCell"),u=te(n,"lstmBias","basicLSTMCell"),c=te(a,"data","basicLSTMCell"),d=te(r,"c","basicLSTMCell"),h=te(i,"h","basicLSTMCell"),p=c.concat(h,1).matMul(o).add(u),f=p.shape[0],g=p.shape[1]/4,b=[f,g],w=p.slice([0,0],b),m=p.slice([0,g],b),x=p.slice([0,2*g],b),y=p.slice([0,3*g],b),N=w.sigmoid().mulStrict(m.tanh()).addStrict(d.mulStrict(s.add(x).sigmoid())),S=N.tanh().mulStrict(y.sigmoid());return[N,S]}}),V9=de({multiRNNCell_:function(e,t,n,a){for(var r=te(t,"data","multiRNNCell"),i=R0(n,"c","multiRNNCell"),s=R0(a,"h","multiRNNCell"),o=r,u=[],c=0;c<e.length;c++){var d=e[c](o,i[c],s[c]);u.push(d[0]),u.push(d[1]),o=d[1]}var h=[],p=[];for(c=0;c<u.length;c+=2)h.push(u[c]),p.push(u[c+1]);return[h,p]}}),G9=de({movingAverage_:function(e,t,n,a,r){r===void 0&&(r=!0);var i=te(e,"v","movingAverage"),s=te(t,"x","movingAverage"),o=te(n,"decay","movingAverage");WO(i,s),se(Ia(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var u=at(1),c=u.sub(o),d=s.sub(i).mul(c);if(r){se(a!=null,function(){return"When using zeroDebias: true, step is required."});var h=te(a,"step","movingAverage");d=d.div(u.sub(H0(o,h)))}return i.add(d)}}),$9=de({stridedSlice_:function(e,t,n,a,r,i,s,o,u){if(r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),a==null&&(a=new Array(t.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var c=te(e,"x","stridedSlice"),d=S4(o),h=c.shape.slice();d.forEach(function(w){t[w]=0,n[w]=1,h.splice(w,0,1)}),c=c.reshape(h);for(var p=0;p<c.rank;p++)t[p]=a7(r,t,a,c.shape,p),n[p]=r7(i,n,a,c.shape,p),a[p]=a[p]||1;var f=S4(u);f.forEach(function(w){n[w]=t[w]+1,a[w]=1});var g=Gw(t,n,a),b=g.filter(function(w,m){return f.indexOf(m)===-1});return a.every(function(w){return w===1})?Ws(c,t,g).reshape(b):ye.runKernelFunc(function(w){return w.stridedSlice(c,t,n,a)},{$x:c}).reshape(b)}}),K9=de({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var a=te(e,"x","topk");if(a.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var r=a.shape[a.shape.length-1];if(t>r)throw new Error("'k' passed to topk() must be <= the last dimension ("+r+") but got "+t);var i=ye.runKernelFunc(function(s){return s.topk(a,t,n)},{$x:a});return{values:i[0],indices:i[1]}}}),Y9=de({scatterND_:function(e,t,n){var a=te(e,"indices","scatterND","int32"),r=te(t,"updates","scatterND");return t7(r,a,n),ye.runKernelFunc(function(i){return i.scatterND(a,r,n)},{indices:a,updates:r},null,"ScatterNd",{shape:n})}}),i5=de({fft_:function(e){se(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,a=e.as2D(n,t);return ye.runKernelFunc(function(r){return r.fft(a)},{input:e}).reshape(e.shape)}}),V0=de({ifft_:function(e){se(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,a=e.as2D(n,t);return ye.runKernelFunc(function(r){return r.ifft(a)},{input:e}).reshape(e.shape)}}),s5=de({rfft_:function(e,t){se(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,a=e.shape[e.shape.length-1],r=e.size/a;if(t!=null&&t<a){var i=e.shape.map(function(m){return 0}),s=e.shape.map(function(m){return m});s[e.shape.length-1]=t,n=e.slice(i,s),a=t}else if(t!=null&&t>a){var o=e.shape.map(function(m){return m});o[e.shape.length-1]=t-a,n=e.concat(An(o),e.shape.length-1),a=t}else n=e;var u=n.zerosLike(),c=Va(n,u).as2D(r,a),d=i5(c),h=Math.floor(a/2)+1,p=Fi(d),f=Es(d),g=p.split([h,a-h],p.shape.length-1),b=f.split([h,a-h],f.shape.length-1),w=n.shape.slice();return w[n.shape.length-1]=h,Va(g[0],b[0]).reshape(w)}}),_6=de({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var a=e.as2D(n,t),r=V0(a);return Fi(r)}var i=[n,2*(t-1)],s=Fi(e).as2D(n,t),o=Es(e).as2D(n,t),u=s.slice([0,1],[n,t-2]).reverse(1),c=o.slice([0,1],[n,t-2]).reverse(1).mul(at(-1)),d=s.concat(u,1),h=o.concat(c,1);return a=Va(d,h).as2D(i[0],i[1]),r=V0(a),Fi(r)}}),X9=Object.freeze({fft:i5,ifft:V0,rfft:s5,irfft:_6}),J9=de({sparseToDense_:function(e,t,n,a){a===void 0&&(a=0);var r=te(e,"sparseIndices","sparseToDense","int32"),i=te(t,"sparseValues","sparseToDense"),s=te(a,"defaultValue","sparseToDense",i.dtype);return function(o,u,c,d){if(o.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+o.dtype+".");if(o.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+o.shape+".");var h=o.rank>0?o.shape[0]:1,p=o.rank>1?o.shape[1]:1;if(c.length!==p)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+p+".");var f=u.size;if(u.rank!==0&&(u.rank!==1||f!==h))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+h+"]");if(u.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(r,i,n,s),ye.runKernelFunc(function(o){return o.sparseToDense(r,i,n,s)},{$sparseIndices:r,$sparseValues:i,$defaultValue:s})}}),Q9=de({gatherND_:function(e,t){var n=te(t,"indices","gatherND","int32"),a=te(e,"x","gatherND");return ye.runKernelFunc(function(r){return r.gatherND(a,n)},{x:a,indices:n},null,"GatherNd")}}),Z9=de({diag_:function(e){var t=te(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return ye.runKernelFunc(function(a){return a.diag(t)},{$x:t}).reshape(n)}}),ez=de({dropout_:function(e,t,n,a){var r=te(e,"x","dropout");if(se(r.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+r.dtype+" tensor instead."}),se(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof zn?r.clone():r;var i=function(u,c){if(c==null)return u.shape.slice();if(Ia(u.shape,c))return c;if(u.shape.length===c.length){for(var d=[],h=0;h<u.shape.length;h++)c[h]==null&&u.shape[h]!=null?d.push(u.shape[h]):d.push(c[h]);return d}return c}(r,n),s=1-t,o=NA(i,0,1,"float32",a).add(s).floor().div(s);return r.mul(o)}});function j6(e,t,n){for(var a=1-e%2,r=new Float32Array(e),i=0;i<e;++i){var s=2*Math.PI*i/(e+a-1);r[i]=t-n*Math.cos(s)}return ha(r,"float32")}var o5=de({hannWindow_:function(e){return j6(e,.5,.5)}}),C6=de({hammingWindow_:function(e){return j6(e,.54,.46)}}),l5=de({frame_:function(e,t,n,a,r){a===void 0&&(a=!1),r===void 0&&(r=0);for(var i=0,s=[];i+t<=e.size;)s.push(Ws(e,i,t)),i+=n;if(a)for(;i<e.size;){var o=i+t-e.size,u=Na([Ws(e,i,t-o),zs([o],r)]);s.push(u),i+=n}return s.length===0?Rl([],[0,t]):Na(s).as2D(s.length,t)}}),A6=de({stft_:function(e,t,n,a,r){var i;r===void 0&&(r=o5),a==null&&(i=t,a=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var s=l5(e,t,n),o=cr(s,r(t)),u=[],c=0;c<s.shape[0];c++)u.push(s5(o.slice([c,0],[1,t]),a));return Na(u)}}),tz=Object.freeze({hannWindow:o5,hammingWindow:C6,frame:l5,stft:A6}),sr,nz=function(e,t,n){return n===void 0&&(n=1),lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h,p,f,g,b,w;return ut(this,function(m){switch(m.label){case 0:return a=te(e,"predictions","inTopK"),r=te(t,"targets","inTopK"),se(a.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+a.rank}),se(a.rank-1===r.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+a.rank+" and targets rank "+r.rank}),sn(a.shape.slice(0,a.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=a.shape[a.shape.length-1],se(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,a.data()];case 1:return s=m.sent(),[4,r.data()];case 2:for(o=m.sent(),u=[s.length/i,i],d=u[1],h=Xf("bool",c=u[0]),p=0;p<c;p++){for(f=p*d,g=s.subarray(f,f+d),b=[],w=0;w<g.length;w++)b.push({value:g[w],index:w});for(b.sort(function(x,y){return y.value-x.value}),h[p]=0,w=0;w<n;w++)if(b[w].index===o[p]){h[p]=1;break}}return e!==a&&a.dispose(),t!==r&&r.dispose(),[2,$a(h,r.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(sr||(sr={}));var az=de({absoluteDifference_:function(e,t,n,a){a===void 0&&(a=sr.SUM_BY_NONZERO_WEIGHTS);var r=te(e,"labels","absoluteDifference"),i=te(t,"predictions","absoluteDifference"),s=null;n!=null&&(s=te(n,"weights","absoluteDifference")),sn(r.shape,i.shape,"Error in absoluteDifference: ");var o=r.sub(i).abs();return Po(o,s,a)}}),Po=de({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=sr.SUM_BY_NONZERO_WEIGHTS);var a=te(e,"losses","computeWeightedLoss"),r=null;t!=null&&(r=te(t,"weights","computeWeightedLoss"));var i=r==null?a:a.mul(r);if(n===sr.NONE)return i;if(n===sr.SUM)return i.sum();if(n===sr.MEAN){if(r==null)return i.mean();var s=a.size/r.size,o=i.sum().div(r.sum());return s>1?o.div(at(s)):o}if(n===sr.SUM_BY_NONZERO_WEIGHTS){if(r==null)return i.sum().div(at(a.size));var u=r.mul(dh(a.shape)).notEqual(at(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),rz=de({cosineDistance_:function(e,t,n,a,r){r===void 0&&(r=sr.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"labels","cosineDistance"),s=te(t,"predictions","cosineDistance"),o=null;a!=null&&(o=te(a,"weights","cosineDistance")),sn(i.shape,s.shape,"Error in cosineDistance: ");var u=at(1).sub(i.mul(s).sum(n,!0));return Po(u,o,r)}}),iz=de({hingeLoss_:function(e,t,n,a){a===void 0&&(a=sr.SUM_BY_NONZERO_WEIGHTS);var r=te(e,"labels","hingeLoss"),i=te(t,"predictions","hingeLoss"),s=null;n!=null&&(s=te(n,"weights","hingeLoss")),sn(r.shape,i.shape,"Error in hingeLoss: ");var o=at(1);r=at(2).mul(r).sub(o);var u=o.sub(r.mul(i)).relu();return Po(u,s,a)}}),sz=de({huberLoss_:function(e,t,n,a,r){a===void 0&&(a=1),r===void 0&&(r=sr.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"labels","huberLoss"),s=te(t,"predictions","huberLoss"),o=null;n!=null&&(o=te(n,"weights","huberLoss")),sn(i.shape,s.shape,"Error in huberLoss: ");var u=at(a),c=s.sub(i).abs(),d=o6(c,u),h=c.sub(d),p=at(.5).mul(d.square()).add(u.mul(h));return Po(p,o,r)}}),oz=de({logLoss_:function(e,t,n,a,r){a===void 0&&(a=1e-7),r===void 0&&(r=sr.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"labels","logLoss"),s=te(t,"predictions","logLoss"),o=null;n!=null&&(o=te(n,"weights","logLoss")),sn(i.shape,s.shape,"Error in logLoss: ");var u=at(1),c=at(a),d=i.mul(s.add(c).log()).neg().sub(u.sub(i).mul(u.sub(s).add(c).log()));return Po(d,o,r)}}),lz=de({meanSquaredError_:function(e,t,n,a){a===void 0&&(a=sr.SUM_BY_NONZERO_WEIGHTS);var r=te(e,"labels","meanSquaredError"),i=te(t,"predictions","meanSquaredError"),s=null;n!=null&&(s=te(n,"weights","meanSquaredError")),sn(r.shape,i.shape,"Error in meanSquaredError: ");var o=r.squaredDifference(i);return Po(o,s,a)}}),uz=de({sigmoidCrossEntropy_:function(e,t,n,a,r){a===void 0&&(a=0),r===void 0&&(r=sr.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"multiClassLabels","sigmoidCrossEntropy"),s=te(t,"logits","sigmoidCrossEntropy"),o=null;if(n!=null&&(o=te(n,"weights","sigmoidCrossEntropy")),sn(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),a>0){var u=at(a),c=at(1),d=at(.5);i=i.mul(c.sub(u)).add(d.mul(u))}var h=function(p,f){var g=te(p,"labels","sigmoidCrossEntropyWithLogits"),b=te(f,"logits","sigmoidCrossEntropyWithLogits");sn(g.shape,b.shape,"Error in sigmoidCrossEntropyWithLogits: ");var w=b.relu(),m=b.mul(g),x=b.abs().neg().exp().log1p();return w.sub(m).add(x)}(i,s);return Po(h,o,r)}}),cz=de({softmaxCrossEntropy_:function(e,t,n,a,r){a===void 0&&(a=0),r===void 0&&(r=sr.SUM_BY_NONZERO_WEIGHTS);var i=te(e,"onehotLabels","softmaxCrossEntropy"),s=te(t,"logits","softmaxCrossEntropy"),o=null;if(n!=null&&(o=te(n,"weights","softmaxCrossEntropy")),sn(i.shape,s.shape,"Error in softmaxCrossEntropy: "),a>0){var u=at(a),c=at(1),d=at(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(d))}var h=function(p,f,g){if(g===void 0&&(g=-1),g===-1&&(g=f.rank-1),g!==f.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+f.rank+" and dim was "+g);return Iv(function(b,w,m){var x=w.logSumExp([g],!0),y=w.toFloat().sub(x);return m([b,y]),{value:y.mul(b).neg().sum([g]),gradFunc:function(N,S){var D=S[0],_=S[1],A=Ur(N.shape,[g]);return[N.reshape(A).mul(D.toFloat().sub(_.exp())),N.reshape(A).mul(_.exp().sub(D.toFloat()))]}}})(p,f)}(i,s);return Po(h,o,r)}}),dz=Object.freeze({get Reduction(){return sr},absoluteDifference:az,computeWeightedLoss:Po,cosineDistance:rz,hingeLoss:iz,huberLoss:sz,logLoss:oz,meanSquaredError:lz,sigmoidCrossEntropy:uz,softmaxCrossEntropy:cz});function G4(e,t){return t===void 0&&(t=!1),ye.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],a=e.shape[1],r=wA(n),i=e.clone(),s=Rl([[1]],[1,1]),o=s.clone(),u=n>=a?a:n,c=function(h){var p,f=i,g=o,b=r;p=ye.tidy(function(){var w=i.slice([h,h],[n-h,1]),m=w.norm(),x=i.slice([h,h],[1,1]),y=Rl([[-1]]).where(x.greater(0),Rl([[1]])),N=x.sub(y.mul(m)),S=w.div(N);o=S.shape[0]===1?s.clone():s.concat(S.slice([1,0],[S.shape[0]-1,S.shape[1]]),0);var D=y.matMul(N).div(m).neg(),_=i.slice([h,0],[n-h,a]),A=D.mul(o);if(h===0)i=_.sub(A.matMul(o.transpose().matMul(_)));else{var L=_.sub(A.matMul(o.transpose().matMul(_)));i=i.slice([0,0],[h,a]).concat(L,0)}var P=r.slice([0,h],[n,r.shape[1]-h]);if(h===0)r=P.sub(P.matMul(o).matMul(A.transpose()));else{var j=P.sub(P.matMul(o).matMul(A.transpose()));r=r.slice([0,0],[n,h]).concat(j,1)}return[o,i,r]}),o=p[0],i=p[1],r=p[2],Br([f,g,b])},d=0;d<u;++d)c(d);return!t&&n>a&&(r=r.slice([0,0],[n,a]),i=i.slice([0,0],[a,a])),[r,i]})}var hz=de({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var a=te(e,"a","bandPart");if(a.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+a.rank+".");var r=a.shape,i=a.shape.slice(-2),s=i[0],o=i[1];if(!(t<=s))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+s+").");if(!(n<=o))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+o+").");t<0&&(t=s),n<0&&(n=o);var u=M0(0,s,1,"int32").reshape([-1,1]),c=M0(0,o,1,"int32"),d=ja(u,c),h=Bv(d.lessEqual(at(+t,"int32")),d.greaterEqual(at(-n,"int32"))),p=An([s,o],a.dtype);return gi(ka(a.reshape([-1,s,o])).map(function(f){return Ku(h,f,p)})).reshape(r)}}),fz=de({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,se(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],a=function(u){se(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},r=1;r<e.length;++r)a(r)}else t=!0,e=Hw(e,e.shape[0],0).map(function(u){return SA(u,[0])});se(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],s=e,o=function(u){i.push(ye.tidy(function(){var c=s[u];if(u>0)for(var d=0;d<u;++d){var h=y6(i[d].mulStrict(c)).mul(i[d]);c=c.sub(h)}return c.div(S6(c,"euclidean"))}))};for(r=0;r<e.length;++r)o(r);return t?gi(i,0):i}}),pz=de({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return G4(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(s,o){return s*o}),a=ka(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],i=[];return a.forEach(function(s){var o=G4(s,t),u=o[0],c=o[1];r.push(u),i.push(c)}),[gi(r,0).reshape(e.shape),gi(i,0).reshape(e.shape)]}}),mz=Object.freeze({bandPart:hz,gramSchmidt:fz,qr:pz});function Wv(e,t,n,a,r,i){a==null&&(a=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);var s=e.shape[0];return n=Math.min(n,s),se(0<=a&&a<=1,function(){return"iouThreshold must be in [0, 1], but was '"+a+"'"}),se(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),se(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),se(t.rank===1,function(){return"scores must be a 1D tensor"}),se(t.shape[0]===s,function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+t.shape[0]}),se(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:i}}var gz=de({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var a=te(e,"images","resizeBilinear");se(a.rank===3||a.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+a.rank+"."}),se(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var r=a,i=!1;a.rank===3&&(i=!0,r=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var s=t[0],o=t[1],u=ye.runKernelFunc(function(c,d){return d([r]),c.resizeBilinear(r,s,o,n)},{x:r},function(c,d){return{x:function(){return ye.runKernelFunc(function(h){return h.resizeBilinearBackprop(c,d[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:s,newWidth:o});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),vz=de({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var a=te(e,"images","resizeNearestNeighbor");se(a.rank===3||a.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+a.rank+"."}),se(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),se(a.dtype==="float32"||a.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var r=a,i=!1;a.rank===3&&(i=!0,r=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var s=t[0],o=t[1],u=ye.runKernelFunc(function(c,d){return d([r]),c.resizeNearestNeighbor(r,s,o,n)},{batchImages:r},function(c,d){return{batchImages:function(){return ye.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(c,d[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),xz=de({nonMaxSuppression_:function(e,t,n,a,r){a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY);var i=te(e,"boxes","nonMaxSuppression"),s=te(t,"scores","nonMaxSuppression"),o=Wv(i,s,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;var u={maxOutputSize:n,iouThreshold:a,scoreThreshold:r};return ye.runKernelFunc(function(c){return c.nonMaxSuppression(i,s,n,a,r)},{boxes:i,scores:s},null,"NonMaxSuppressionV3",u)}}),bz=function(e,t,n,a,r){return a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY),lt(this,void 0,void 0,function(){var i,s,o,u,c,d,h;return ut(this,function(p){switch(p.label){case 0:return i=te(e,"boxes","nonMaxSuppressionAsync"),s=te(t,"scores","nonMaxSuppressionAsync"),o=Wv(i,s,n,a,r),n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return u=p.sent(),c=u[0],d=u[1],h=Kw(c,d,n,a,r),i!==e&&i.dispose(),s!==t&&s.dispose(),[2,h]}})})},yz=de({nonMaxSuppressionWithScore_:function(e,t,n,a,r,i){a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var s=te(e,"boxes","nonMaxSuppression"),o=te(t,"scores","nonMaxSuppression"),u=Wv(s,o,n,a,r,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:a=u.iouThreshold,scoreThreshold:r=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},d=ye.runKernel("NonMaxSuppressionV5",{boxes:s,scores:o},c);return{selectedIndices:d[0],selectedScores:d[1]}}}),wz=function(e,t,n,a,r,i){return a===void 0&&(a=.5),r===void 0&&(r=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),lt(this,void 0,void 0,function(){var s,o,u,c,d,h,p;return ut(this,function(f){switch(f.label){case 0:return s=te(e,"boxes","nonMaxSuppressionAsync"),o=te(t,"scores","nonMaxSuppressionAsync"),u=Wv(s,o,n,a,r,i),n=u.maxOutputSize,a=u.iouThreshold,r=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([s.data(),o.data()])];case 1:return c=f.sent(),d=c[0],h=c[1],p=Yw(d,h,n,a,r,i),s!==e&&s.dispose(),o!==t&&o.dispose(),[2,p]}})})},Nz=de({cropAndResize_:function(e,t,n,a,r,i){var s=te(e,"image","cropAndResize"),o=te(t,"boxes","cropAndResize","float32"),u=te(n,"boxInd","cropAndResize","int32");r=r||"bilinear",i=i||0;var c=o.shape[0];return se(s.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),se(o.rank===2&&o.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+o.shape+"."}),se(u.rank===1&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+o.shape+"."}),se(a.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+a.length+"."}),se(a[0]>=1&&a[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+a}),se(r==="bilinear"||r==="nearest",function(){return"method must be bilinear or nearest, but was "+r}),ye.runKernelFunc(function(d,h){return d.cropAndResize(s,o,u,a,r,i)},{images:s,boxes:o,boxInd:u},null,"CropAndResize",{method:r,extrapolationValue:i,cropSize:a})}}),u5=Object.freeze({resizeBilinear:gz,resizeNearestNeighbor:vz,nonMaxSuppression:xz,nonMaxSuppressionAsync:bz,nonMaxSuppressionWithScore:yz,nonMaxSuppressionWithScoreAsync:wz,cropAndResize:Nz}),c5=function(e,t){return!(e>0)||t==="linear"},d5=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},h5=function(e,t){var n=t,a=_a(e.shape,t.shape);return a.length>0&&(n=n.sum(a)),n.reshape(e.shape)},f5=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Un(e);if(t==="elu")return w6(e);if(t==="relu6")return k6(e);if(t==="prelu")return N6(e,n);throw new Error("Unknown fused activation "+t+".")},kz=de({fusedMatMul_:function(e){var t,n=e.a,a=e.b,r=e.transposeA,i=r!==void 0&&r,s=e.transposeB,o=s!==void 0&&s,u=e.bias,c=e.activation,d=c===void 0?"linear":c,h=e.preluActivationWeights;if(c5(ye.state.gradientDepth,d)===!1){var p=Uv(n,a,i,o);return u!=null&&(p=Ot(p,u)),f5(p,d,h)}var f=te(n,"a","fused matMul"),g=te(a,"b","fused matMul");t=qn(f,g),f=t[0],g=t[1];var b=i?f.shape[f.rank-2]:f.shape[f.rank-1],w=o?g.shape[g.rank-1]:g.shape[g.rank-2],m=i?f.shape[f.rank-1]:f.shape[f.rank-2],x=o?g.shape[g.rank-2]:g.shape[g.rank-1],y=f.shape.slice(0,-2),N=g.shape.slice(0,-2),S=dt(y),D=dt(N);se(f.rank>=2&&g.rank>=2&&f.rank===g.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+g.rank+"."}),se(Ia(y,N),function(){return"Error in fused matMul: outer dimensions ("+y+") and ("+N+") of Tensors with shapes "+f.shape+" and "+g.shape+" must match."}),se(b===w,function(){return"Error in fused matMul: inner shapes ("+b+") and ("+w+") of Tensors with shapes "+f.shape+" and "+g.shape+" and transposeA="+i+" and transposeB="+o+" must match."});var _,A,L=f.shape.slice(0,-2).concat([m,x]),P=i?f.as3D(S,b,m):f.as3D(S,m,b),j=o?g.as3D(D,x,w):g.as3D(D,w,x);u!=null&&zt(L,(_=qn(_=te(u,"bias","fused matMul"),f)[0]).shape),h!=null&&(A=te(h,"prelu weights","fused matMul"));var E={a:P,b:j};u!=null&&(E.bias=_),h!=null&&(E.preluActivationWeights=A);var F=[P,j];return ye.runKernelFunc(function(z,U){var O=z.fusedBatchMatMul({a:P,b:j,transposeA:i,transposeB:o,bias:_,activation:d,preluActivationWeights:A});return U([P,j,O]),O},E,function(z,U){var O=U[0],B=U[1],q=U[2],I=d5(z,q,d),K={};return u!=null&&(K={bias:function(){return h5(_,I)}}),Object.assign(i||o?!i&&o?{a:function(){return I.matMul(B,!1,!1)},b:function(){return I.matMul(O,!0,!1)}}:i&&!o?{a:function(){return B.matMul(I,!1,!0)},b:function(){return O.matMul(I,!1,!1)}}:{a:function(){return B.matMul(I,!0,!0)},b:function(){return I.matMul(O,!0,!0)}}:{a:function(){return I.matMul(B,!1,!0)},b:function(){return O.matMul(I,!0,!1)}},K)},"_FusedMatMul",{transposeA:i,transposeB:o,activation:d},F,[!0]).reshape(L)}}),Sz=de({fusedConv2d_:function(e){var t=e.x,n=e.filter,a=e.strides,r=e.pad,i=e.dataFormat,s=i===void 0?"NHWC":i,o=e.dilations,u=o===void 0?[1,1]:o,c=e.dimRoundingMode,d=e.bias,h=e.activation,p=h===void 0?"linear":h,f=e.preluActivationWeights;if(p=p||"linear",c5(ye.state.gradientDepth,p)===!1){var g=$i(t,n,a,r,s,u,c);return d!=null&&(g=Ot(g,d)),f5(g,p,f)}var b=te(t,"x","conv2d"),w=te(n,"filter","conv2d"),m=b,x=!1;b.rank===3&&(x=!0,m=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),se(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),se(w.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+w.rank+"."}),c!=null&&se(sa(r),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+r+"."}),se(m.shape[3]===w.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+w.shape[2]+"."}),se(qr(a,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+u+"'"}),se(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var y,N,S=rc(m.shape,w.shape,a,u,r,c);d!=null&&(y=qn(y=te(d,"bias","fused conv2d"),b)[0],zt(S.outShape,y.shape)),f!=null&&(N=te(f,"prelu weights","fused conv2d"));var D={x:m,filter:w};d!=null&&(D.bias=y),f!=null&&(D.preluActivationWeights=N);var _=[w,m],A=ye.runKernelFunc(function(L,P){var j=L.fusedConv2d({input:m,filter:w,convInfo:S,bias:y,activation:p,preluActivationWeights:N});return P([w,m,j]),j},D,function(L,P){var j=P,E=j[0],F=j[1],z=j[2],U=d5(L,z,p);se(Xd(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var O={};return d!=null&&(O={bias:function(){return h5(y,U)}}),Object.assign({x:function(){return f6(F.shape,U,E,a,r)},filter:function(){return a5(F,U,E.shape,a,r)}},O)},"FusedConv2D",{convInfo:S,activation:p},_,[!0]);return x?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}}),_z=de({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,a=e.strides,r=e.pad,i=e.dataFormat,s=i===void 0?"NHWC":i,o=e.dilations,u=o===void 0?[1,1]:o,c=e.dimRoundingMode,d=e.bias,h=e.activation,p=h===void 0?"linear":h,f=e.preluActivationWeights;if(c5(ye.state.gradientDepth,p)===!1){var g=zv(t,n,a,r,s,u,c);return d!=null&&(g=Ot(g,d)),f5(g,p,f)}var b=te(t,"x","depthwiseConv2d"),w=te(n,"filter","depthwiseConv2d"),m=b,x=!1;b.rank===3&&(x=!0,m=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),se(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),se(w.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+w.rank+"."}),se(m.shape[3]===w.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+w.shape[2]+"."}),u==null&&(u=[1,1]),se(qr(a,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+u+"'"}),c!=null&&se(sa(r),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+r+"."});var y,N,S=rc(m.shape,w.shape,a,u,r,c,!0);d!=null&&(y=qn(y=te(d,"bias","fused conv2d"),b)[0],zt(S.outShape,y.shape)),f!=null&&(N=te(f,"prelu weights","fused depthwiseConv2d"));var D={x:m,filter:w};d!=null&&(D.bias=y),f!=null&&(D.preluActivationWeights=N);var _=[w,m],A=ye.runKernelFunc(function(L,P){var j=L.fusedDepthwiseConv2D({input:m,filter:w,convInfo:S,bias:y,activation:p,preluActivationWeights:N});return P([w,m,j]),j},D,function(L,P){se(Xd(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var j=P[0],E=P[1],F=P[2],z=d5(L,F,p),U={};return d!=null&&(U={bias:function(){return h5(y,z)}}),Object.assign({x:function(){return p6(E.shape,z,j,S)},filter:function(){return m6(E,z,j.shape,S)}},U)},"FusedDepthwiseConv2D",{convInfo:S,activation:p},_,[!0]);return x?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}}),jz=Object.freeze({matMul:kz,conv2d:Sz,depthwiseConv2d:_z}),Cz=Object.freeze({image:u5,linalg:mz,losses:dz,spectral:X9,fused:jz,signal:tz,square:oB,squaredDifference:JA,conv1d:g9,conv2d:$i,conv3d:v9,depthwiseConv2d:zv,separableConv2d:r5,conv2dTranspose:x9,conv3dTranspose:b9,op:de,batchNormalization2d:IB,batchNormalization3d:FB,batchNormalization4d:BB,batchNormalization:zB,batchNorm:a6,batchNorm2d:UB,batchNorm3d:qB,batchNorm4d:WB,booleanMaskAsync:m9,complex:Va,real:Fi,imag:Es,concat:Na,concat1d:jI,concat2d:CI,concat3d:AI,concat4d:EI,split:Hw,matMul:Uv,dot:y9,outerProduct:w9,reverse:Fp,reverse1d:N9,reverse2d:k9,reverse3d:S9,reverse4d:_9,maxPool:La,avgPool:Bp,pool:j9,maxPool3d:C9,avgPool3d:A9,slice:Ws,slice1d:E9,slice2d:D9,slice3d:x6,slice4d:T9,abs:lB,acos:uB,acosh:cB,asin:dB,asinh:hB,atan:fB,atanh:pB,ceil:mB,clipByValue:e5,cos:gB,cosh:vB,erf:xB,exp:Hy,expm1:bB,floor:yB,log:wB,log1p:NB,logSigmoid:kB,neg:W0,reciprocal:SB,round:_B,rsqrt:QA,sigmoid:ZA,sign:jB,isNaN:CB,isInf:AB,isFinite:EB,sin:DB,sinh:TB,softplus:LB,sqrt:PB,step:RB,tan:MB,tanh:OB,all:L9,any:P9,argMax:R9,argMin:M9,logSumExp:O9,max:qv,mean:I9,min:F9,moments:B9,sum:y6,prod:z9,equal:l6,equalStrict:i9,greater:s9,greaterEqual:u6,greaterEqualStrict:o9,greaterStrict:l9,less:u9,lessEqual:c9,lessEqualStrict:d9,lessStrict:h9,notEqual:f9,notEqualStrict:p9,add:Ot,addN:GB,addStrict:$B,atan2:KB,div:rs,divNoNan:YB,divStrict:XB,floorDiv:s6,maximum:t5,maximumStrict:JB,minimum:o6,minimumStrict:QB,mod:ZB,modStrict:e9,mul:cr,mulStrict:t9,pow:H0,powStrict:n9,squaredDifferenceStrict:a9,sub:ja,subStrict:r9,elu:w6,leakyRelu:U9,prelu:N6,relu:Un,relu6:k6,selu:q9,logicalAnd:Bv,logicalNot:HB,logicalOr:r6,logicalXor:VB,where:Ku,whereAsync:i6,buffer:Et,print:FI,batchToSpaceND:yA,broadcastTo:BI,cast:zI,clone:UI,cumsum:qI,depthToSpace:WI,expandDims:Mi,eye:wA,multinomial:HI,oneHot:zy,pad:ac,pad1d:VI,pad2d:GI,pad3d:$I,pad4d:KI,rand:YI,randomNormal:XI,randomGamma:JI,randomUniform:NA,reshape:is,spaceToBatchND:kA,squeeze:SA,stack:gi,tile:_d,truncatedNormal:QI,unstack:ka,setdiff1dAsync:ZI,fill:zs,linspace:_I,ones:dh,range:M0,scalar:at,tensor:$a,tensor1d:ha,tensor2d:Rl,tensor3d:Ww,tensor4d:Or,tensor5d:NI,tensor6d:kI,variable:SI,zeros:An,onesLike:bA,zerosLike:Yt,transpose:Wl,softmax:Lo,logSoftmax:s7,localResponseNormalization:W9,norm:S6,gather:n5,unsortedSegmentSum:c6,basicLSTMCell:H9,multiRNNCell:V9,movingAverage:G9,stridedSlice:$9,topk:K9,scatterND:Y9,fft:i5,ifft:V0,rfft:s5,irfft:_6,sparseToDense:J9,gatherND:Q9,diag:Z9,dropout:ez,hannWindow:o5,hammingWindow:C6,frame:l5,stft:A6,inTopKAsync:nz});function Ge(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&se(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function e1(e,t,n,a){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,a);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Az=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new TA(n,ye),n}return cs(t,e),t.prototype.write=function(n,a,r){this.firstUse&&(this.firstUse=!1,Be().get("IS_NODE")&&P0(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:r}),i},t.prototype.move=function(n,a,r,i){this.data.set(n,{values:a,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var a=this.data.get(n),r=a.dtype,i=a.complexTensors;return r==="complex64"?Wy(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var a=this.readSync(n.dataId),r=a;if(n.dtype==="string")try{r=a.map(function(i){return D0(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Et(n.shape,n.dtype,r)},t.prototype.makeOutput=function(n,a,r){var i=this.write(n,a,r);return ye.makeTensorFromDataId(i,a,r,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var a=this.data.get(n).complexTensors;a!=null&&(a.real.dispose(),a.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){return a=js(),n(),[2,{kernelMs:js()-a}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,a){var r=this.makeOutput(null,n.shape,"complex64");return this.data.get(r.dataId).complexTensors={real:ye.keep(n.clone()),imag:ye.keep(a.clone())},r},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,a,r){if(Ge(n,"slice"),EA(n.shape,a,r)){var i=DA(a,n.strides),s=dt(r);return $a(this.readSync(n.dataId).subarray(i,i+s),r,n.dtype)}for(var o=Et(r,n.dtype),u=this.bufferSync(n),c=0;c<o.size;++c){var d=o.indexToLoc(c).map(function(h,p){return h+a[p]});o.values[c]=u.get.apply(u,d)}return o.toTensor()},t.prototype.stridedSlice=function(n,a,r,i){Ge(n,"stridedSlice");var s=Gw(a,r,i);if(s.some(function(f){return f===0}))return $a([],s);for(var o=Et(s,n.dtype),u=this.bufferSync(n),c=0;c<o.size;c++){for(var d=o.indexToLoc(c),h=new Array(d.length),p=0;p<h.length;p++)h[p]=d[p]*i[p]+a[p];o.set.apply(o,[u.get.apply(u,h)].concat(d))}return o.toTensor()},t.prototype.diag=function(n){for(var a=this.readSync(n.dataId),r=Et([n.size,n.size],n.dtype),i=r.values,s=0;s<a.length;s++)i[s*n.size+s]=a[s];return r.toTensor()},t.prototype.unstack=function(n,a){for(var r=n.shape[a],i=new Array(n.rank-1),s=0,o=0;o<n.rank;o++)o!==a&&(i[s++]=n.shape[o]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[a]=1;var d=new Array(r);for(o=0;o<d.length;o++)u[a]=o,d[o]=this.slice(n,u,c).reshape(i);return d},t.prototype.reverse=function(n,a){Ge(n,"reverse");for(var r=Et(n.shape,n.dtype),i=this.bufferSync(n),s=function(u){var c=r.indexToLoc(u),d=c.slice();a.forEach(function(h){return d[h]=n.shape[h]-1-d[h]}),r.set.apply(r,[i.get.apply(i,d)].concat(c))},o=0;o<r.size;o++)s(o);return r.toTensor()},t.prototype.concat=function(n,a){var r=this;if(n[0].dtype==="complex64"){var i=n.map(function(f){return Fi(f)}),s=n.map(function(f){return Es(f)});return Va(this.concat(i,a),this.concat(s,a))}var o=n.map(function(f){var g=dt(f.shape.slice(a));return f.as2D(-1,g)}),u=Yd(o.map(function(f){return f.shape}),1),c=Et(u,n[0].dtype).values;if(o[0].shape[0]===1){var d=0;o.forEach(function(f){c.set(r.readSync(f.dataId),d),d+=f.size})}else{var h=0;o.forEach(function(f){for(var g=r.readSync(f.dataId),b=0,w=0;w<f.shape[0];++w)for(var m=w*u[1]+h,x=0;x<f.shape[1];++x)c[m+x]=g[b++];h+=f.shape[1]})}var p=Yd(n.map(function(f){return f.shape}),a);return $a(c,p,n[0].dtype)},t.prototype.neg=function(n){return Ge(n,"neg"),this.multiply(at(-1),n)},t.prototype.add=function(n,a){return n.dtype==="complex64"||a.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),a.cast("complex64"),function(r,i,s,o){return{real:r+s,imag:i+o}}):this.broadcastedBinaryOp(n,a,Ga(n.dtype,a.dtype),function(r,i){return r+i})},t.prototype.addN=function(n){var a=this;Ge(n,"addN");for(var r=n.map(function(d){return a.readSync(d.dataId)}),i=Et(n[0].shape,n[0].dtype),s=i.values,o=0;o<n.length;o++)for(var u=r[o],c=0;c<s.length;c++)s[c]+=u[c];return i.toTensor()},t.prototype.softmax=function(n,a){var r=Ca([a],n.shape),i=this.max(n,r),s=Ur(i.shape,r),o=this.subtract(n,i.reshape(s)),u=this.exp(o),c=this.sum(u,r).reshape(s);return this.realDivide(u,c)},t.prototype.subtract=function(n,a){return n.dtype==="complex64"||a.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),a.cast("complex64"),function(r,i,s,o){return{real:r-s,imag:i-o}}):this.broadcastedBinaryOp(n,a,Ga(n.dtype,a.dtype),function(r,i){return r-i})},t.prototype.pow=function(n,a){return Ge([n,a],"pow"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.pow(r,i)})},t.prototype.batchMatMul=function(n,a,r,i){Ge([n,a],"matMul");for(var s=r?n.shape[1]:n.shape[2],o=r?n.shape[2]:n.shape[1],u=i?a.shape[1]:a.shape[2],c=n.shape[0],d=this.readSync(n.dataId),h=this.readSync(a.dataId),p=r?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],f=p[0],g=p[1],b=p[2],w=i?[1,a.strides[1],a.strides[0]]:[a.strides[1],1,a.strides[0]],m=w[0],x=w[1],y=w[2],N=o*u,S=Et([c,o,u],n.dtype),D=S.values,_=this.blockSize,A=0;A<c;A++)for(var L=0;L<o;L+=_)for(var P=0;P<u;P+=_)for(var j=0;j<s;j+=_)for(var E=Math.min(L+_,o),F=Math.min(P+_,u),z=Math.min(j+_,s),U=L;U<E;U++)for(var O=P;O<F;O++){for(var B=0,q=j;q<z;q++)B+=d[A*f+U*g+q*b]*h[q*m+O*x+A*y];D[A*N+(U*u+O)]+=B}return S.toTensor()},t.prototype.fusedBatchMatMul=function(n){var a=n.a,r=n.b,i=n.transposeA,s=n.transposeB,o=n.bias,u=n.activation,c=n.preluActivationWeights,d=this.batchMatMul(a,r,i,s);return o&&(d=this.add(d,o)),u&&(d=e1(this,d,u,c)),d},t.prototype.multiply=function(n,a){return n.dtype==="complex64"||a.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),a.cast("complex64"),function(r,i,s,o){return{real:r*s-i*o,imag:r*o+i*s}}):this.broadcastedBinaryOp(n,a,Ga(n.dtype,a.dtype),function(r,i){return r*i})},t.prototype.realDivide=function(n,a){return Ge([n,a],"realDivide"),this.broadcastedBinaryOp(n,a,"float32",function(r,i){return r/i})},t.prototype.floorDiv=function(n,a){return Ge([n,a],"floorDiv"),this.broadcastedBinaryOp(n,a,"int32",function(r,i){return Math.floor(r/i)})},t.prototype.sum=function(n,a){Ge(n,"sum"),ri("sum",a,n.rank);for(var r=ar(n.shape,a),i=r[0],s=r[1],o=An(i,Ga(n.dtype,"int32")),u=dt(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=0,g=0;g<u;++g)f+=d[p+g];c[h]=f}return o},t.prototype.prod=function(n,a){Ge(n,"sum");for(var r=ar(n.shape,a),i=r[0],s=r[1],o=An(i,Ga(n.dtype,"int32")),u=dt(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=1,g=0;g<u;++g)f*=d[p+g];c[h]=f}return o},t.prototype.unsortedSegmentSum=function(n,a,r){Ge(n,"unsortedSegmentSum");for(var i=[],s=n.rank-a.rank,o=0;o<s;++o)a=a.expandDims(o+1);for(o=0;o<r;++o){var u=at(o,"int32"),c=l6(u,a).asType("float32").mul(n).sum(0);i.push(c)}return gi(i)},t.prototype.argMin=function(n,a){Ge(n,"argMin");var r=[a];ri("argMin",r,n.rank);for(var i=ar(n.shape,r),s=i[0],o=i[1],u=An(s,"int32"),c=dt(o),d=this.readSync(u.dataId),h=this.readSync(n.dataId),p=0;p<d.length;++p){for(var f=p*c,g=h[f],b=0,w=0;w<c;++w){var m=h[f+w];m<g&&(g=m,b=w)}d[p]=b}return u},t.prototype.argMax=function(n,a){Ge(n,"argMax");var r=[a];ri("argMax",r,n.rank);for(var i=ar(n.shape,r),s=i[0],o=i[1],u=An(s,"int32"),c=dt(o),d=this.readSync(u.dataId),h=this.readSync(n.dataId),p=0;p<d.length;++p){for(var f=p*c,g=h[f],b=0,w=0;w<c;++w){var m=h[f+w];m>g&&(g=m,b=w)}d[p]=b}return u},t.prototype.cumsum=function(n,a,r,i){if(Ge(n,"cumsum"),a!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+a);for(var s=Ga(n.dtype,"int32"),o=An(n.shape,s),u=this.readSync(o.dataId),c=this.readSync(n.dataId),d=n.shape[n.rank-1],h=i?function(w,m){return w+d-m-1}:function(w,m){return w+m},p=0;p<c.length;p+=d)for(var f=0;f<d;f++){var g=h(p,f);if(f===0)u[g]=r?0:c[g];else{var b=h(p,f-1);u[g]=r?c[b]+u[b]:c[g]+u[b]}}return o},t.prototype.equal=function(n,a){return Ge([n,a],"equal"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r===i?1:0})},t.prototype.notEqual=function(n,a){return Ge([n,a],"notEqual"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r!==i?1:0})},t.prototype.less=function(n,a){return Ge([n,a],"less"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r<i?1:0})},t.prototype.lessEqual=function(n,a){return Ge([n,a],"lessEqual"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r<=i?1:0})},t.prototype.greater=function(n,a){return Ge([n,a],"greater"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r>i?1:0})},t.prototype.greaterEqual=function(n,a){return Ge([n,a],"greaterEqual"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r>=i?1:0})},t.prototype.logicalNot=function(n){Ge(n,"logicalNot");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)r[i]=a[i]?0:1;return this.makeOutput(r,n.shape,"bool")},t.prototype.logicalAnd=function(n,a){return Ge([n,a],"logicalAnd"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r&&i})},t.prototype.logicalOr=function(n,a){return Ge([n,a],"logicalOr"),this.broadcastedBinaryOp(n,a,"bool",function(r,i){return r||i})},t.prototype.select=function(n,a,r){Ge([n,a,r],"select");for(var i=this.readSync(n.dataId),s=this.readSync(a.dataId),o=this.readSync(r.dataId),u=An(a.shape,Ga(a.dtype,r.dtype)),c=this.readSync(u.dataId),d=0,h=n.rank===0||n.rank>1||a.rank===1?1:dt(a.shape.slice(1)),p=0;p<i.length;p++)for(var f=0;f<h;f++)i[p]===1?c[d++]=s[p]:c[d++]=o[p];return u},t.prototype.where=function(n){Ge([n],"where");var a=this.readSync(n.dataId);return Xw(n.shape,a)},t.prototype.topk=function(n,a,r){return Ge(n,"topk"),BA(this.readSync(n.dataId),n.shape,n.dtype,a)},t.prototype.min=function(n,a){Ge(n,"min"),ri("min",a,n.rank);for(var r=ar(n.shape,a),i=r[0],s=r[1],o=An(i,n.dtype),u=dt(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];b<f&&(f=b)}c[h]=f}return o},t.prototype.minimum=function(n,a){return Ge([n,a],"minimum"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.min(r,i)})},t.prototype.mod=function(n,a){return Ge([n,a],"mod"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){var s=r%i;return r<0&&i<0||r>=0&&i>=0?s:(s+i)%i})},t.prototype.max=function(n,a){Ge(n,"max"),ri("max",a,n.rank);for(var r=ar(n.shape,a),i=r[0],s=r[1],o=An(i,n.dtype),u=dt(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];b>f&&(f=b)}c[h]=f}return o},t.prototype.maximum=function(n,a){return Ge([n,a],"maximum"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.max(r,i)})},t.prototype.all=function(n,a){Ge(n,"all"),ri("all",a,n.rank);for(var r=ar(n.shape,a),i=r[0],s=r[1],o=An(i,n.dtype),u=dt(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];f=f&&b}c[h]=f}return o},t.prototype.any=function(n,a){Ge(n,"any"),ri("any",a,n.rank);for(var r=ar(n.shape,a),i=r[0],s=r[1],o=An(i,n.dtype),u=dt(s),c=this.readSync(o.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var p=h*u,f=d[p],g=0;g<u;++g){var b=d[p+g];f=f||b}c[h]=f}return o},t.prototype.squaredDifference=function(n,a){return Ge([n,a],"squaredDifference"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){var s=r-i;return s*s})},t.prototype.ceil=function(n){Ge(n,"ceil");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.ceil(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.floor=function(n){Ge(n,"floor");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.floor(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.sign=function(n){Ge(n,"x");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)a[i]<0?r[i]=-1:a[i]>0?r[i]=1:r[i]=0;return this.makeOutput(r,n.shape,"float32")},t.prototype.isNaN=function(n){Ge(n,"x");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)Number.isNaN(a[i])&&(r[i]=1);return this.makeOutput(r,n.shape,"bool")},t.prototype.isInf=function(n){Ge(n,"x");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)Math.abs(a[i])===1/0&&(r[i]=1);return this.makeOutput(r,n.shape,"bool")},t.prototype.isFinite=function(n){Ge(n,"x");for(var a=this.readSync(n.dataId),r=new Uint8Array(a.length),i=0;i<a.length;++i)Number.isFinite(a[i])&&(r[i]=1);return this.makeOutput(r,n.shape,"bool")},t.prototype.round=function(n){Ge(n,"round");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=Math.floor(a[i]);a[i]-s<.5?r[i]=Math.floor(a[i]):a[i]-s>.5?r[i]=Math.ceil(a[i]):r[i]=s%2==0?s:s+1}return this.makeOutput(r,n.shape,"float32")},t.prototype.exp=function(n){Ge(n,"exp");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.exp(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.expm1=function(n){Ge(n,"expm1");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=Math.expm1(a[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.log=function(n){Ge(n,"log");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=Math.log(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.log1p=function(n){Ge(n,"log1p");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=Math.log1p(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.sqrt=function(n){Ge(n,"sqrt");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=Math.sqrt(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.rsqrt=function(n){Ge(n,"rsqrt");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i){var s=a[i];r[i]=1/Math.sqrt(s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.reciprocal=function(n){Ge(n,"reciprocal");for(var a=this.readSync(n.dataId),r=new Float32Array(a.length),i=0;i<a.length;++i)r[i]=1/a[i];return this.makeOutput(r,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){Ge(n,"relu");for(var a=An(n.shape,n.dtype),r=this.readSync(a.dataId),i=this.readSync(n.dataId),s=0;s<i.length;++s)r[s]=Math.max(0,i[s]);return a},t.prototype.relu6=function(n){Ge(n,"relu");for(var a=An(n.shape,n.dtype),r=this.readSync(a.dataId),i=this.readSync(n.dataId),s=0;s<i.length;++s)r[s]=Math.min(Math.max(0,i[s]),6);return a},t.prototype.prelu=function(n,a){return Ge([n,a],"prelu"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return r<0?i*r:r})},t.prototype.elu=function(n){Ge(n,"elu");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i){var s=r[i];a[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(a,n.shape,"float32")},t.prototype.eluDer=function(n,a){Ge([n,a],"eluDer");for(var r=new Float32Array(a.size),i=this.readSync(a.dataId),s=this.readSync(n.dataId),o=0;o<i.length;++o){var u=i[o];r[o]=u>=1?s[o]:s[o]*(u+1)}return this.makeOutput(r,a.shape,"float32")},t.prototype.selu=function(n){Ge(n,"selu");for(var a=Qw,r=Zw,i=new Float32Array(n.size),s=this.readSync(n.dataId),o=0;o<s.length;++o){var u=s[o];i[o]=u>=0?r*u:a*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,a,r){Ge(n,"clip");for(var i=new Float32Array(n.size),s=this.readSync(n.dataId),o=0;o<s.length;++o){var u=s[o];i[o]=u>r?r:u<a?a:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.abs(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<n.size;++i){var s=r[2*i],o=r[2*i+1];a[i]=Math.hypot(s,o)}return this.makeOutput(a,n.shape,"float32")},t.prototype.int=function(n){Ge(n,"int");for(var a=new Int32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=r[i];return this.makeOutput(a,n.shape,"int32")},t.prototype.sigmoid=function(n){Ge(n,"sigmoid");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=1/(1+Math.exp(-r[i]));return this.makeOutput(a,n.shape,"float32")},t.prototype.softplus=function(n){Ge(n,"softplus");for(var a=Math.log(11920928955078125e-23)+2,r=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var o=i[s]>-a,u=i[s]<a,c=Math.exp(i[s]),d=void 0;d=u?c:o?i[s]:Math.log(1+c),r[s]=d}return this.makeOutput(r,n.shape,"float32")},t.prototype.sin=function(n){Ge(n,"sin");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.sin(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.cos=function(n){Ge(n,"cos");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.cos(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.tan=function(n){Ge(n,"tan");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.tan(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.asin=function(n){Ge(n,"asin");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.asin(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.acos=function(n){Ge(n,"acos");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.acos(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.atan=function(n){Ge(n,"atan");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.atan(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.atan2=function(n,a){return Ge([n,a],"atan2"),this.broadcastedBinaryOp(n,a,n.dtype,function(r,i){return Math.atan2(r,i)})},t.prototype.sinh=function(n){Ge(n,"sinh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.sinh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.cosh=function(n){Ge(n,"cosh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.cosh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.tanh=function(n){Ge(n,"tanh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=EO(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.asinh=function(n){Ge(n,"asinh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.asinh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.acosh=function(n){Ge(n,"acosh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.acosh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.atanh=function(n){Ge(n,"atanh");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i)a[i]=Math.atanh(r[i]);return this.makeOutput(a,n.shape,"float32")},t.prototype.erf=function(n){Ge(n,"erf");for(var a=new Float32Array(n.size),r=this.readSync(n.dataId),i=0;i<r.length;++i){var s=Math.sign(r[i]),o=Math.abs(r[i]),u=1/(1+.3275911*o);a[i]=s*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-o*o))}return this.makeOutput(a,n.shape,"float32")},t.prototype.step=function(n,a){a===void 0&&(a=0),Ge(n,"step");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var o=i[s];isNaN(o)?r[s]=NaN:r[s]=o>0?1:a}return this.makeOutput(r,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var a=n.input,r=n.filter,i=n.convInfo,s=n.bias,o=n.activation,u=n.preluActivationWeights,c=this.conv2d(a,r,i);return s&&(c=this.add(c,s)),o&&(c=e1(this,c,o,u)),c},t.prototype.conv2d=function(n,a,r){Ge([n,a],"conv2d");for(var i=r.filterHeight,s=r.filterWidth,o=r.dilationHeight,u=r.dilationWidth,c=r.padInfo.left,d=r.padInfo.top,h=r.dataFormat==="channelsLast",p=Et(r.outShape,n.dtype),f=n.strides[0],g=h?n.strides[1]:n.strides[2],b=h?n.strides[2]:1,w=h?1:n.strides[1],m=p.strides[0],x=h?p.strides[1]:p.strides[2],y=h?p.strides[2]:1,N=h?1:p.strides[1],S=this.readSync(n.dataId),D=this.readSync(a.dataId),_=p.values,A=0;A<r.batchSize;++A)for(var L=A*f,P=A*m,j=0;j<r.outHeight;++j)for(var E=P+j*x,F=j*r.strideHeight-d,z=0;z<i;z++){var U=F+z*o;if(!(U<0||U>=r.inHeight))for(var O=z*a.strides[0],B=L+U*g,q=0;q<r.outWidth;++q)for(var I=E+q*y,K=q*r.strideWidth-c,Z=0;Z<s;Z++){var R=K+Z*u;if(!(R<0||R>=r.inWidth))for(var H=B+R*b,$=O+Z*a.strides[1],X=0;X<r.inChannels;++X){for(var W=S[H+X*w],ie=0;ie<r.outChannels;++ie)_[I+ie*N]+=W*D[$+ie];$+=r.outChannels}}}return p.toTensor()},t.prototype.conv3d=function(n,a,r){for(var i=r.filterDepth,s=r.filterHeight,o=r.filterWidth,u=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,h=r.padInfo.front,p=r.padInfo.left,f=r.padInfo.top,g=Et(r.outShape,n.dtype),b=this.readSync(n.dataId),w=this.readSync(a.dataId),m=g.values,x=0;x<r.batchSize;++x)for(var y=x*n.strides[0],N=x*g.strides[0],S=0;S<r.outDepth;++S)for(var D=N+S*g.strides[1],_=S*r.strideDepth-h,A=0;A<i;A++){var L=_+A*u;if(!(L<0||L>=r.inDepth))for(var P=A*a.strides[0],j=y+L*n.strides[1],E=0;E<r.outHeight;++E)for(var F=D+E*g.strides[2],z=E*r.strideHeight-f,U=0;U<s;U++){var O=z+U*c;if(!(O<0||O>=r.inHeight))for(var B=P+U*a.strides[1],q=j+O*n.strides[2],I=0;I<r.outWidth;++I)for(var K=F+I*r.outChannels,Z=I*r.strideWidth-p,R=0;R<o;R++){var H=Z+R*d;if(!(H<0||H>=r.inWidth))for(var $=B+R*a.strides[2],X=q+H*r.inChannels,W=$,ie=0;ie<r.inChannels;++ie){for(var ce=b[X+ie],ue=0;ue<r.outChannels;++ue)m[K+ue]+=ce*w[W+ue];W+=r.outChannels}}}}return g.toTensor()},t.prototype.conv2dDerInput=function(n,a,r){Ge([n,a],"conv2dDerInput");for(var i=Et(r.inShape,"float32"),s=i.values,o=this.readSync(n.dataId),u=this.readSync(a.dataId),c=a.strides,d=c[0],h=c[1],p=c[2],f=r.batchSize,g=r.filterHeight,b=r.filterWidth,w=r.inChannels,m=r.inHeight,x=r.inWidth,y=r.outChannels,N=r.outHeight,S=r.outWidth,D=r.strideHeight,_=r.strideWidth,A=r.dataFormat,L=g-1-r.padInfo.top,P=b-1-r.padInfo.left,j=A==="channelsLast",E=i.strides[0],F=j?i.strides[1]:i.strides[2],z=j?i.strides[2]:1,U=j?1:i.strides[1],O=n.strides[0],B=j?n.strides[1]:n.strides[2],q=j?n.strides[2]:1,I=j?1:n.strides[1],K=0;K<f;++K)for(var Z=0;Z<w;++Z)for(var R=0;R<m;++R)for(var H=R-L,$=Math.max(0,Math.ceil(H/D)),X=Math.min(N,(g+H)/D),W=0;W<x;++W){for(var ie=W-P,ce=Math.max(0,Math.ceil(ie/_)),ue=Math.min(S,(b+ie)/_),he=0,ge=$;ge<X;++ge)for(var Ee=ge*D-H,Te=ce;Te<ue;++Te)for(var fe=O*K+B*ge+q*Te,me=d*(g-1-Ee)+h*(b-1-(Te*_-ie))+p*Z,ne=0;ne<y;++ne)he+=o[fe+I*ne]*u[me+ne];s[E*K+F*R+z*W+U*Z]=he}return i.toTensor()},t.prototype.conv3dDerInput=function(n,a,r){for(var i=Et(r.inShape,"float32"),s=i.values,o=i.strides,u=o[0],c=o[1],d=o[2],h=o[3],p=this.readSync(n.dataId),f=n.strides,g=f[0],b=f[1],w=f[2],m=f[3],x=this.readSync(a.dataId),y=a.strides,N=y[0],S=y[1],D=y[2],_=y[3],A=r.batchSize,L=r.filterDepth,P=r.filterHeight,j=r.filterWidth,E=r.inChannels,F=r.inDepth,z=r.inHeight,U=r.inWidth,O=r.outChannels,B=r.outDepth,q=r.outHeight,I=r.outWidth,K=r.strideDepth,Z=r.strideHeight,R=r.strideWidth,H=L-1-r.padInfo.front,$=P-1-r.padInfo.top,X=j-1-r.padInfo.left,W=0;W<A;++W)for(var ie=0;ie<E;++ie)for(var ce=0;ce<F;++ce)for(var ue=ce-H,he=Math.max(0,Math.ceil(ue/K)),ge=Math.min(B,(L+ue)/K),Ee=0;Ee<z;++Ee)for(var Te=Ee-$,fe=Math.max(0,Math.ceil(Te/Z)),me=Math.min(q,(P+Te)/Z),ne=0;ne<U;++ne){for(var De=ne-X,Oe=Math.max(0,Math.ceil(De/R)),ke=Math.min(I,(j+De)/R),xe=0,Ae=he;Ae<ge;++Ae)for(var Ce=Ae*K-ue,He=fe;He<me;++He)for(var Qe=He*Z-Te,Ze=Oe;Ze<ke;++Ze)for(var Je=g*W+b*Ae+w*He+m*Ze,le=N*(L-1-Ce)+S*(P-1-Qe)+D*(j-1-(Ze*R-De))+_*ie,Xe=0;Xe<O;++Xe)xe+=p[Je+Xe]*x[le+Xe];s[u*W+c*ce+d*Ee+h*ne+ie]=xe}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,a,r){Ge([n,a],"conv2dDerFilter");for(var i=r.strideHeight,s=r.strideWidth,o=r.filterHeight,u=r.filterWidth,c=r.dataFormat==="channelsLast",d=Et(r.filterShape,"float32"),h=r.padInfo.left,p=r.padInfo.top,f=this.bufferSync(n),g=this.bufferSync(a),b=0;b<o;++b)for(var w=Math.max(0,Math.ceil((p-b)/i)),m=Math.min(r.outHeight,(r.inHeight+p-b)/i),x=0;x<u;++x)for(var y=Math.max(0,Math.ceil((h-x)/s)),N=Math.min(r.outWidth,(r.inWidth+h-x)/s),S=0;S<r.inChannels;++S)for(var D=0;D<r.outChannels;++D){for(var _=0,A=0;A<r.batchSize;++A)for(var L=w;L<m;++L)for(var P=b+L*i-p,j=y;j<N;++j){var E=x+j*s-h;_+=c?f.get(A,P,E,S)*g.get(A,L,j,D):f.get(A,S,P,E)*g.get(A,D,L,j)}d.set(_,b,x,S,D)}return d.toTensor()},t.prototype.conv3dDerFilter=function(n,a,r){for(var i=r.strideDepth,s=r.strideHeight,o=r.strideWidth,u=r.filterDepth,c=r.filterHeight,d=r.filterWidth,h=Et(r.filterShape,"float32"),p=h.values,f=h.strides,g=f[0],b=f[1],w=f[2],m=f[3],x=this.readSync(a.dataId),y=a.strides,N=y[0],S=y[1],D=y[2],_=y[3],A=this.readSync(n.dataId),L=n.strides,P=L[0],j=L[1],E=L[2],F=L[3],z=r.padInfo.front,U=r.padInfo.left,O=r.padInfo.top,B=0;B<u;++B)for(var q=Math.max(0,Math.ceil((z-B)/i)),I=Math.min(r.outDepth,(r.inDepth+z-B)/i),K=B*g,Z=0;Z<c;++Z)for(var R=Math.max(0,Math.ceil((O-Z)/s)),H=Math.min(r.outHeight,(r.inHeight+O-Z)/s),$=Z*b+K,X=0;X<d;++X)for(var W=Math.max(0,Math.ceil((U-X)/o)),ie=Math.min(r.outWidth,(r.inWidth+U-X)/o),ce=X*w+$,ue=0;ue<r.inChannels;++ue)for(var he=ue*m+ce,ge=0;ge<r.outChannels;++ge){for(var Ee=0,Te=0;Te<r.batchSize;++Te)for(var fe=Te*P,me=Te*N,ne=q;ne<I;++ne)for(var De=(B+ne*i-z)*j+fe,Oe=ne*S+me,ke=R;ke<H;++ke)for(var xe=(Z+ke*s-O)*E+De,Ae=ke*D+Oe,Ce=W;Ce<ie;++Ce){var He=Ce*_+Ae;Ee+=A[(X+Ce*o-U)*F+xe+ue]*x[He+ge]}p[he+ge]=Ee}return h.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var a=n.input,r=n.filter,i=n.convInfo,s=n.bias,o=n.activation,u=n.preluActivationWeights,c=this.depthwiseConv2D(a,r,i);return s&&(c=this.add(c,s)),o&&(c=e1(this,c,o,u)),c},t.prototype.depthwiseConv2D=function(n,a,r){Ge([n,a],"depthwiseConv2D");for(var i=r.filterHeight,s=r.filterWidth,o=r.dilationHeight,u=r.dilationWidth,c=r.padInfo.left,d=r.padInfo.top,h=r.outChannels/r.inChannels,p=Et(r.outShape,n.dtype),f=this.readSync(n.dataId),g=this.readSync(a.dataId),b=p.values,w=0;w<r.batchSize;++w)for(var m=w*n.strides[0],x=w*p.strides[0],y=0;y<r.outHeight;++y)for(var N=x+y*p.strides[1],S=y*r.strideHeight-c,D=0;D<i;++D){var _=S+D*o;if(!(_<0||_>=r.inHeight))for(var A=D*a.strides[0],L=m+_*n.strides[1],P=0;P<r.outWidth;++P)for(var j=N+P*p.strides[2],E=P*r.strideWidth-d,F=0;F<s;++F){var z=E+F*u;if(!(z<0||z>=r.inWidth))for(var U=A+F*a.strides[1],O=L+z*r.inChannels,B=j,q=U,I=0;I<r.inChannels;++I){for(var K=f[O+I],Z=0;Z<h;++Z)b[B+Z]+=K*g[q+Z];B+=h,q+=h}}}return p.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,a,r){Ge([n,a],"depthwiseConv2DDerInput");for(var i=Et(r.inShape,"float32"),s=i.values,o=i.strides,u=o[0],c=o[1],d=o[2],h=this.readSync(n.dataId),p=n.strides,f=p[0],g=p[1],b=p[2],w=this.readSync(a.dataId),m=a.strides,x=m[0],y=m[1],N=m[2],S=r.batchSize,D=r.filterHeight,_=r.filterWidth,A=r.inChannels,L=r.inHeight,P=r.inWidth,j=r.outChannels,E=r.outHeight,F=r.outWidth,z=r.strideHeight,U=r.strideWidth,O=D-1-r.padInfo.top,B=_-1-r.padInfo.left,q=j/A,I=0;I<S;++I)for(var K=0;K<A;++K)for(var Z=0;Z<L;++Z)for(var R=Z-O,H=Math.max(0,Math.ceil(R/z)),$=Math.min(E,(D+R)/z),X=0;X<P;++X){for(var W=X-B,ie=Math.max(0,Math.ceil(W/U)),ce=Math.min(F,(_+W)/U),ue=0,he=H;he<$;++he)for(var ge=he*z-R,Ee=ie;Ee<ce;++Ee)for(var Te=f*I+g*he+b*Ee,fe=x*(D-1-ge)+y*(_-1-(Ee*U-W))+N*K,me=0;me<q;++me)ue+=h[Te+(K*q+me)]*w[fe+me];s[u*I+c*Z+d*X+K]=ue}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,a,r){Ge([n,a],"depthwiseConv2DDerFilter");for(var i=r.strideHeight,s=r.strideWidth,o=r.filterHeight,u=r.filterWidth,c=Et(r.filterShape,"float32"),d=r.padInfo.left,h=r.padInfo.top,p=r.outChannels/r.inChannels,f=this.bufferSync(n),g=this.bufferSync(a),b=0;b<o;++b)for(var w=Math.max(0,Math.ceil((h-b)/i)),m=Math.min(r.outHeight,(r.inHeight+h-b)/i),x=0;x<u;++x)for(var y=Math.max(0,Math.ceil((d-x)/s)),N=Math.min(r.outWidth,(r.inWidth+d-x)/s),S=0;S<r.outChannels;++S){for(var D=Math.trunc(S/p),_=S%p,A=0,L=0;L<r.batchSize;++L)for(var P=w;P<m;++P)for(var j=b+P*i-h,E=y;E<N;++E){var F=x+E*s-d;A+=f.get(L,j,F,D)*g.get(L,P,E,S)}c.set(A,b,x,D,_)}return c.toTensor()},t.prototype.tile=function(n,a){return Ge(n,"tile"),FA(this.bufferSync(n),a)},t.prototype.pad=function(n,a,r){Ge(n,"pad");var i=a.map(function(p,f){return p[0]+n.shape[f]+p[1]}),s=a.map(function(p){return p[0]}),o=this.bufferSync(n),u=Et(i,n.dtype);r!==0&&u.values.fill(r);for(var c=0;c<n.size;c++){var d=o.indexToLoc(c),h=d.map(function(p,f){return p+s[f]});u.set.apply(u,[o.get.apply(o,d)].concat(h))}return u.toTensor()},t.prototype.transpose=function(n,a){Ge(n,"transpose");for(var r=new Array(n.rank),i=0;i<r.length;i++)r[i]=n.shape[a[i]];var s=this.readSync(n.dataId),o=Et(r,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var c=u.indexToLoc(i),d=new Array(c.length),h=0;h<d.length;h++)d[h]=c[a[h]];var p=o.locToIndex(d);o.values[p]=s[i]}return o.toTensor()},t.prototype.gather=function(n,a,r){Ge([n,a],"gather");var i=n.shape.slice(),s=this.readSync(a.dataId);i[r]=s.length;for(var o=Et(i,n.dtype),u=this.bufferSync(n),c=0;c<o.size;++c){var d=o.indexToLoc(c),h=d.slice();h[r]=s[d[r]];var p=u.locToIndex(h);o.values[c]=u.values[p]}return o.toTensor()},t.prototype.batchToSpaceND=function(n,a,r){Ge([n],"batchToSpaceND");var i=a.reduce(function(h,p){return h*p}),s=O0(n.shape,a,i),o=I0(s.length,a.length),u=F0(n.shape,a,i),c=_A(r,a.length),d=jA(u,r,a.length);return n.reshape(s).transpose(o).reshape(u).slice(c,d)},t.prototype.spaceToBatchND=function(n,a,r){Ge([n],"spaceToBatchND");var i=a.reduce(function(p,f){return p*f}),s=[[0,0]];s.push.apply(s,r);for(var o=1+a.length;o<n.shape.length;++o)s.push([0,0]);var u=n.pad(s),c=O0(u.shape,a,i,!1),d=I0(c.length,a.length,!1),h=F0(u.shape,a,i,!1);return u.reshape(c).transpose(d).reshape(h)},t.prototype.pool=function(n,a,r){Ge(n,"pool");for(var i=a.strideHeight,s=a.strideWidth,o=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,h=a.padInfo.top,p=a.padInfo.left,f=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(n.dataId),b=Et(a.outShape,n.dtype),w=b.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],x=a.outShape[2]*a.outShape[3],y=a.outShape[3],N=0;N<a.batchSize;++N)for(var S=N*m,D=N*n.strides[0],_=0;_<a.inChannels;++_)for(var A=0;A<a.outHeight;++A)for(var L=A*i-h,P=Math.max(0,L),j=Math.min(a.inHeight,c+L),E=S+A*x,F=0;F<a.outWidth;++F){for(var z=F*s-p,U=Math.max(0,z),O=Math.min(a.inWidth,d+z),B=f,q=0,I=0,K=P;K<j;K+=o){for(var Z=D+K*n.strides[1],R=U;R<O;R+=u){var H=g[Z+R*n.strides[2]+_];r==="max"&&H>B?B=H:r==="avg"&&(q+=H,I++)}if(isNaN(B))break}w[E+F*y+_]=r==="avg"?q/I:B}return b.toTensor()},t.prototype.maxPool=function(n,a){return this.pool(n,a,"max")},t.prototype.maxPoolPositions=function(n,a){for(var r=Et(a.outShape,"int32"),i=a.strideHeight,s=a.strideWidth,o=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,h=a.padInfo.top,p=a.padInfo.left,f=this.bufferSync(n),g=0;g<a.batchSize;++g)for(var b=0;b<a.inChannels;++b)for(var w=0;w<a.outHeight;++w){for(var m=w*i-h,x=m;x<0;)x+=o;for(var y=Math.min(a.inHeight,c+m),N=0;N<a.outWidth;++N){for(var S=N*s-p,D=S;D<0;)D+=u;for(var _=Math.min(a.inWidth,d+S),A=Number.NEGATIVE_INFINITY,L=-1,P=x;P<y;P+=o)for(var j=P-m,E=D;E<_;E+=u){var F=E-S,z=f.get(g,P,E,b);z>A&&(A=z,L=j*d+F)}r.set(L,g,w,N,b)}}return r.toTensor()},t.prototype.maxPoolBackprop=function(n,a,r,i){Ge([a,r],"maxPoolBackprop");for(var s=this.maxPoolPositions(a,i),o=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterHeight,p=i.effectiveFilterWidth,f=p-1-i.padInfo.left,g=h-1-i.padInfo.top,b=Et(a.shape,"float32"),w=this.bufferSync(s),m=this.bufferSync(n),x=0;x<i.batchSize;++x)for(var y=0;y<i.inChannels;++y)for(var N=0;N<i.inHeight;++N)for(var S=0;S<i.inWidth;++S){for(var D=N-g,_=S-f,A=0,L=0;L<h;L+=c){var P=(D+L)/o;if(!(P<0||P>=i.outHeight||Math.floor(P)!==P))for(var j=0;j<p;j+=d){var E=(_+j)/u;if(!(E<0||E>=i.outWidth||Math.floor(E)!==E)){var F=h*p-1-w.get(x,P,E,y)===L*p+j?1:0;F!==0&&(A+=m.get(x,P,E,y)*F)}}}b.set(A,x,N,S,y)}return b.toTensor()},t.prototype.avgPoolBackprop=function(n,a,r){Ge([n,a],"avgPoolBackprop");for(var i=r.strideHeight,s=r.strideWidth,o=r.filterHeight,u=r.filterWidth,c=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=p-1-r.padInfo.left,g=h-1-r.padInfo.top,b=Et(a.shape,"float32"),w=1/(o*u),m=this.bufferSync(n),x=0;x<r.batchSize;++x)for(var y=0;y<r.inChannels;++y)for(var N=0;N<r.inHeight;++N)for(var S=0;S<r.inWidth;++S){for(var D=N-g,_=S-f,A=0,L=0;L<h;L+=c){var P=(D+L)/i;if(!(P<0||P>=r.outHeight||Math.floor(P)!==P))for(var j=0;j<p;j+=d){var E=(_+j)/s;E<0||E>=r.outWidth||Math.floor(E)!==E||(A+=m.get(x,P,E,y))}}b.set(A*w,x,N,S,y)}return b.toTensor()},t.prototype.pool3d=function(n,a,r){Ge(n,"pool3d");for(var i=a.strideDepth,s=a.strideHeight,o=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.front,b=a.padInfo.top,w=a.padInfo.left,m=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=this.readSync(n.dataId),y=Et(a.outShape,n.dtype),N=y.values,S=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],D=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],A=a.outShape[4],L=0;L<a.batchSize;++L)for(var P=L*S,j=L*n.strides[0],E=0;E<a.inChannels;++E)for(var F=0;F<a.outDepth;++F){for(var z=F*i-g,U=z;U<0;)U+=u;for(var O=Math.min(a.inDepth,h+z),B=P+F*D,q=0;q<a.outHeight;++q){for(var I=q*s-b,K=I;K<0;)K+=c;for(var Z=Math.min(a.inHeight,p+I),R=B+q*_,H=0;H<a.outWidth;++H){for(var $=H*o-w,X=$;X<0;)X+=d;for(var W=Math.min(a.inWidth,f+$),ie=R+H*A,ce=m,ue=0,he=0,ge=U;ge<O;ge+=u){for(var Ee=j+ge*n.strides[1],Te=K;Te<Z;Te+=c){for(var fe=Ee+Te*n.strides[2],me=X;me<W;me+=d){var ne=x[fe+me*n.strides[3]+E];if(r==="max"&&ne>ce?ce=ne:r==="avg"&&(ue+=ne,he++),isNaN(ce))break}if(isNaN(ce))break}if(isNaN(ce))break}N[ie+E]=r==="avg"?ue/he:ce}}}return y.toTensor()},t.prototype.avgPool3d=function(n,a){return Ge(n,"avgPool3d"),this.pool3d(n,a,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,a,r){Ge([n,a],"avgPool3dBackprop");for(var i=r.strideDepth,s=r.strideHeight,o=r.strideWidth,u=r.filterDepth,c=r.filterHeight,d=r.filterWidth,h=r.dilationDepth,p=r.dilationHeight,f=r.dilationWidth,g=r.effectiveFilterDepth,b=r.effectiveFilterHeight,w=r.effectiveFilterWidth,m=g-1-r.padInfo.front,x=w-1-r.padInfo.left,y=b-1-r.padInfo.top,N=Et(a.shape,"float32"),S=1/(u*c*d),D=this.bufferSync(n),_=0;_<r.batchSize;++_)for(var A=0;A<r.inChannels;++A)for(var L=0;L<r.inDepth;++L)for(var P=0;P<r.inHeight;++P)for(var j=0;j<r.inWidth;++j){for(var E=L-m,F=P-y,z=j-x,U=0,O=0;O<g;O+=h){var B=(E+O)/i;if(!(B<0||B>=r.outDepth||Math.floor(B)!==B))for(var q=0;q<b;q+=p){var I=(F+q)/s;if(!(I<0||I>=r.outHeight||Math.floor(I)!==I))for(var K=0;K<w;K+=f){var Z=(z+K)/o;Z<0||Z>=r.outWidth||Math.floor(Z)!==Z||(U+=D.get(_,B,I,Z,A))}}}N.set(U*S,_,L,P,j,A)}return N.toTensor()},t.prototype.maxPool3d=function(n,a){return Ge(n,"maxPool3d"),this.pool3d(n,a,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,a){for(var r=Et(a.outShape,"int32"),i=a.strideDepth,s=a.strideHeight,o=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.front,b=a.padInfo.top,w=a.padInfo.left,m=this.bufferSync(n),x=0;x<a.batchSize;++x)for(var y=0;y<a.inChannels;++y)for(var N=0;N<a.outDepth;++N){for(var S=N*i-g,D=S;D<0;)D+=u;for(var _=Math.min(a.inDepth,h+S),A=0;A<a.outHeight;++A){for(var L=A*s-b,P=L;P<0;)P+=c;for(var j=Math.min(a.inHeight,p+L),E=0;E<a.outWidth;++E){for(var F=E*o-w,z=F;z<0;)z+=d;for(var U=Math.min(a.inWidth,f+F),O=Number.NEGATIVE_INFINITY,B=-1,q=D;q<_;q+=u)for(var I=q-S,K=P;K<j;K+=c)for(var Z=K-L,R=z;R<U;R+=d){var H=R-F,$=m.get(x,q,K,R,y);$>=O&&(O=$,B=I*p*f+Z*p+H)}r.set(B,x,N,A,E,y)}}}return r.toTensor()},t.prototype.maxPool3dBackprop=function(n,a,r,i){Ge([a,r],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(a,i),o=i.strideDepth,u=i.strideHeight,c=i.strideWidth,d=i.dilationDepth,h=i.dilationHeight,p=i.dilationWidth,f=i.effectiveFilterDepth,g=i.effectiveFilterHeight,b=i.effectiveFilterWidth,w=f-1-i.padInfo.front,m=b-1-i.padInfo.left,x=g-1-i.padInfo.top,y=Et(a.shape,"float32"),N=this.bufferSync(s),S=this.bufferSync(n),D=0;D<i.batchSize;++D)for(var _=0;_<i.inChannels;++_)for(var A=0;A<i.inDepth;++A)for(var L=0;L<i.inHeight;++L)for(var P=0;P<i.inWidth;++P){for(var j=A-w,E=L-x,F=P-m,z=0,U=0;U<f;U+=d){var O=(j+U)/o;if(!(O<0||O>=i.outDepth||Math.floor(O)!==O))for(var B=0;B<g;B+=h){var q=(E+B)/u;if(!(q<0||q>=i.outHeight||Math.floor(q)!==q))for(var I=0;I<b;I+=p){var K=(F+I)/c;if(!(K<0||K>=i.outWidth||Math.floor(K)!==K)){var Z=f*g*b-1-N.get(D,O,q,K,_)===U*g*b+B*b+I?1:0;Z!==0&&(z+=S.get(D,O,q,K,_)*Z)}}}}y.set(z,D,A,L,P,_)}return y.toTensor()},t.prototype.cast=function(n,a){return RA(n,a,this)},t.prototype.reshape=function(n,a){return qy(n,a)},t.prototype.avgPool=function(n,a){return Ge(n,"avgPool"),this.pool(n,a,"avg").toFloat()},t.prototype.resizeBilinear=function(n,a,r,i){Ge(n,"resizeBilinear");for(var s=n.shape,o=s[0],u=s[1],c=s[2],d=s[3],h=this.readSync(n.dataId),p=new Float32Array(dt([o,a,r,d])),f=[i&&a>1?u-1:u,i&&r>1?c-1:c],g=[i&&a>1?a-1:a,i&&r>1?r-1:r],b=0,w=f[0]/g[0],m=f[1]/g[1],x=0;x<o;x++)for(var y=0;y<a;y++)for(var N=w*y,S=Math.floor(N),D=N-S,_=Math.min(u-1,Math.ceil(N)),A=x*n.strides[0]+S*n.strides[1],L=x*n.strides[0]+_*n.strides[1],P=0;P<r;P++)for(var j=m*P,E=Math.floor(j),F=j-E,z=Math.min(c-1,Math.ceil(j)),U=A+E*n.strides[2],O=L+E*n.strides[2],B=A+z*n.strides[2],q=L+z*n.strides[2],I=0;I<d;I++){var K=h[U+I],Z=h[O+I],R=K+(h[B+I]-K)*F,H=R+(Z+(h[q+I]-Z)*F-R)*D;p[b++]=H}return $a(p,[o,a,r,d])},t.prototype.resizeBilinearBackprop=function(n,a,r){Ge([n,a],"resizeBilinearBackprop");for(var i=a.shape,s=i[0],o=i[1],u=i[2],c=i[3],d=n.shape,h=d[1],p=d[2],f=new Float32Array(s*o*u*c),g=[r&&h>1?o-1:o,r&&p>1?u-1:u],b=[r&&h>1?h-1:h,r&&p>1?p-1:p],w=g[0]/b[0],m=g[1]/b[1],x=this.readSync(n.dataId),y=0,N=0;N<s;N++)for(var S=N*a.strides[0],D=0;D<h;D++)for(var _=D*w,A=Math.floor(_),L=Math.min(Math.ceil(_),o-1),P=S+A*a.strides[1],j=S+L*a.strides[1],E=_-A,F=1-E,z=0;z<p;z++)for(var U=z*m,O=Math.floor(U),B=Math.min(Math.ceil(U),u-1),q=U-O,I=1-q,K=P+O*a.strides[2],Z=P+B*a.strides[2],R=j+O*a.strides[2],H=j+B*a.strides[2],$=F*I,X=F*q,W=E*I,ie=E*q,ce=0;ce<c;ce++){var ue=x[y++];f[K+ce]+=ue*$,f[Z+ce]+=ue*X,f[R+ce]+=ue*W,f[H+ce]+=ue*ie}return Or(f,[s,u,o,c],a.dtype)},t.prototype.resizeNearestNeighbor=function(n,a,r,i){Ge(n,"resizeNearestNeighbor");for(var s=n.shape,o=s[0],u=s[1],c=s[2],d=s[3],h=this.readSync(n.dataId),p=new Float32Array(o*a*r*d),f=[i&&a>1?u-1:u,i&&r>1?c-1:c],g=[i&&a>1?a-1:a,i&&r>1?r-1:r],b=f[0]/g[0],w=f[1]/g[1],m=0,x=0;x<o;x++)for(var y=x*n.strides[0],N=0;N<a;N++)for(var S=b*N,D=y+Math.min(u-1,i?Math.round(S):Math.floor(S))*n.strides[1],_=0;_<r;_++)for(var A=w*_,L=D+Math.min(c-1,i?Math.round(A):Math.floor(A))*n.strides[2],P=0;P<d;P++){var j=h[L+P];p[m++]=j}return $a(p,[o,a,r,d],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,a,r){Ge([n,a],"resizeNearestNeighborBackprop");for(var i=a.shape,s=i[0],o=i[1],u=i[2],c=i[3],d=n.shape,h=d[1],p=d[2],f=new Float32Array(s*o*u*c),g=this.readSync(n.dataId),b=[r&&h>1?o-1:o,r&&p>1?u-1:u],w=[r&&h>1?h-1:h,r&&p>1?p-1:p],m=b[0]/w[0],x=b[1]/w[1],y=1/m,N=1/x,S=2*Math.ceil(y)+2,D=2*Math.ceil(N)+2,_=0;_<s;_++)for(var A=_*a.strides[0],L=0;L<o;L++)for(var P=A+L*a.strides[1],j=Math.floor(L*y),E=Math.floor(j-S/2),F=0;F<u;F++)for(var z=P+F*a.strides[2],U=Math.floor(F*N),O=Math.floor(U-D/2),B=0;B<c;B++){for(var q=0,I=0;I<S;I++){var K=I+E;if(!(K<0||K>=h)){var Z=A+K*n.strides[1],R=K*m;if(L===Math.min(o-1,r?Math.round(R):Math.floor(R)))for(var H=0;H<D;H++){var $=H+O;if(!($<0||$>=p)){var X=Z+$*n.strides[2],W=$*x;F===Math.min(u-1,r?Math.round(W):Math.floor(W))&&(q+=g[X+B])}}}}f[z+B]=q}return Or(f,a.shape,a.dtype)},t.prototype.batchNormalization=function(n,a,r,i,s,o){Ge([n,a,r,s,o],"batchNorm");for(var u=this.readSync(n.dataId),c=this.readSync(a.dataId),d=this.readSync(r.dataId),h=s?this.readSync(s.dataId):new Float32Array([1]),p=o?this.readSync(o.dataId):new Float32Array([0]),f=new Float32Array(u.length),g=p.length,b=h.length,w=d.length,m=c.length,x=0,y=0,N=0,S=0,D=0;D<u.length;++D)f[D]=p[x++]+(u[D]-c[y++])*h[N++]/Math.sqrt(d[S++]+i),x>=g&&(x=0),y>=m&&(y=0),N>=b&&(N=0),S>=w&&(S=0);return Or(f,n.shape)},t.prototype.localResponseNormalization4D=function(n,a,r,i,s){Ge(n,"localResponseNormalization4D");var o=n.shape[3],u=o-1,c=this.readSync(n.dataId),d=n.size,h=new Float32Array(d);function p(w){for(var m=w%o,x=w-m+Math.max(0,m-a),y=w-m+Math.min(m+a,u),N=0;x<=y;x++){var S=c[x];N+=S*S}return N}for(var f=0;f<d;f++){var g=p(f),b=c[f]*Math.pow(r+i*g,-s);h[f]=b}return Or(h,n.shape)},t.prototype.LRNGrad=function(n,a,r,i,s,o,u){Ge(n,"LRNGrad");for(var c=n.shape[3],d=this.readSync(n.dataId),h=this.readSync(a.dataId),p=this.readSync(r.dataId),f=new Float32Array(n.size),g=n.size,b=0;b<g;b++){for(var w=b%c,m=b-w+Math.max(0,w-i),x=b-w+Math.min(c,w+i+1),y=0,N=m;N<x;N++)y+=Math.pow(h[N],2);for(y=o*y+s,N=m;N<x;N++){var S=-2*o*u*h[N]*p[b]/y;b===N&&(S+=Math.pow(y,-u)),S*=d[b],f[N]+=S}}return Or(f,n.shape)},t.prototype.multinomial=function(n,a,r,i){Ge(n,"multinomial");for(var s=a?n:Lo(n),o=s.shape[0],u=s.shape[1],c=An([o,r],"int32"),d=this.readSync(c.dataId),h=this.readSync(s.dataId),p=0;p<o;++p){var f=p*u,g=new Float32Array(u-1);g[0]=h[f];for(var b=1;b<g.length;++b)g[b]=g[b-1]+h[f+b];for(var w=Ov(i.toString()),m=p*r,x=0;x<r;++x){var y=w();d[m+x]=g.length;for(var N=0;N<g.length;N++)if(y<g[N]){d[m+x]=N;break}}}return c},t.prototype.oneHot=function(n,a,r,i){Ge(n,"oneHot");var s=new Float32Array(n.size*a);s.fill(i);for(var o=this.readSync(n.dataId),u=0;u<n.size;++u)o[u]>=0&&o[u]<a&&(s[u*a+o[u]]=r);return Rl(s,[n.size,a],"int32")},t.prototype.nonMaxSuppression=function(n,a,r,i,s){return Ge(n,"nonMaxSuppression"),Kw(this.readSync(n.dataId),this.readSync(a.dataId),r,i,s)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,a){for(var r=n.shape[0],i=n.shape[1],s=Et(n.shape,"float32"),o=Et(n.shape,"float32"),u=Fi(n).as2D(r,i),c=Es(n).as2D(r,i),d=0;d<r;d++)for(var h=u.slice([d,0],[1,i]),p=c.slice([d,0],[1,i]),f=Va(h,p),g=this.readSync(this.fftImpl(f,a).dataId),b=0;b<i;b++){var w=_4(g,b);s.values[d*i+b]=w.real,o.values[d*i+b]=w.imag}return Va(s.toTensor(),o.toTensor()).as2D(r,i)},t.prototype.fftImpl=function(n,a){var r=n.as1D(),i=r.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(r,i,a).as2D(n.shape[0],n.shape[1]);return a&&(s=Va(Fi(s).div(at(i)),Es(s).div(at(i)))),s}var o=this.readSync(n.dataId),u=function(c){for(var d=new Float32Array(c.length/2),h=new Float32Array(c.length/2),p=0;p<c.length;p+=2)d[p/2]=c[p],h[p/2]=c[p+1];return{real:d,imag:h}}(this.fourierTransformByMatmul(o,i,a));return Va(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,a,r){if(a===1)return n;var i=this.readSync(n.dataId),s=a/2,o=function(m){for(var x=Math.ceil(m.length/4),y=new Float32Array(x),N=new Float32Array(x),S=0;S<m.length;S+=4)y[Math.floor(S/4)]=m[S],N[Math.floor(S/4)]=m[S+1];return{real:y,imag:N}}(i),u=Va(o.real,o.imag).as1D(),c=function(m){for(var x=Math.floor(m.length/4),y=new Float32Array(x),N=new Float32Array(x),S=2;S<m.length;S+=4)y[Math.floor(S/4)]=m[S],N[Math.floor(S/4)]=m[S+1];return{real:y,imag:N}}(i),d=Va(c.real,c.imag).as1D();u=this.fftRadix2(u,s,r),d=this.fftRadix2(d,s,r);var h=function(m,x){for(var y=new Float32Array(m/2),N=new Float32Array(m/2),S=0;S<Math.ceil(m/2);S++){var D=(x?2:-2)*Math.PI*(S/m);y[S]=Math.cos(D),N[S]=Math.sin(D)}return{real:y,imag:N}}(a,r),p=Va(h.real,h.imag).mul(d),f=u.add(p),g=u.sub(p),b=Fi(f).concat(Fi(g)),w=Es(f).concat(Es(g));return Va(b,w).as1D()},t.prototype.fourierTransformByMatmul=function(n,a,r){for(var i=new Float32Array(2*a),s=0;s<a;s++){for(var o=0,u=0,c=0;c<a;c++){var d=l7(s*c,a,r),h=_4(n,c);o+=h.real*d.real-h.imag*d.imag,u+=h.real*d.imag+h.imag*d.real}r&&(o/=a,u/=a),o7(i,o,u,s)}return i},t.prototype.depthToSpace=function(n,a,r){se(r==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+r}),se(a>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+a});for(var i=n.shape[0],s=n.shape[1],o=n.shape[2],u=n.shape[3],c=s*a,d=o*a,h=u/(a*a),p=this.readSync(n.dataId),f=new Float32Array(i*c*d*h),g=0,b=0;b<i;++b)for(var w=0;w<c;++w)for(var m=Math.floor(w/a),x=w%a,y=0;y<d;++y)for(var N=Math.floor(y/a),S=(x*a+y%a)*h,D=0;D<h;++D){var _=D+S+u*(N+o*(m+s*b));f[g++]=p[_]}return Or(f,[i,c,d,h])},t.prototype.broadcastedBinaryOp=function(n,a,r,i){var s=zt(n.shape,a.shape),o=Et(s,r),u=this.readSync(n.dataId),c=this.readSync(a.dataId),d=Nl(n.shape,s),h=Nl(a.shape,s),p=o.values;if(d.length+h.length===0)for(var f=0;f<p.length;++f)p[f]=i(u[f%u.length],c[f%c.length]);else{var g=this.bufferSync(n),b=this.bufferSync(a),w=function(m){var x=o.indexToLoc(m),y=x.slice(-n.rank);d.forEach(function(_){return y[_]=0});var N=g.locToIndex(y),S=x.slice(-a.rank);h.forEach(function(_){return S[_]=0});var D=b.locToIndex(S);p[m]=i(u[N],c[D])};for(f=0;f<p.length;++f)w(f)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,a,r){var i=zt(n.shape,a.shape),s=Et(i,"float32"),o=Et(i,"float32"),u=this.readSync(n.dataId),c=this.readSync(a.dataId),d=Nl(n.shape,i),h=Nl(a.shape,i),p=s.values,f=o.values;if(d.length+h.length===0)for(var g=0;g<p.length;g++){var b=g%u.length,w=g%c.length,m=r(u[2*b],u[2*b+1],c[2*w],c[2*w+1]);p[g]=m.real,f[g]=m.imag}else{var x=this.bufferSync(this.data.get(n.dataId).complexTensors.real),y=this.bufferSync(this.data.get(a.dataId).complexTensors.real),N=function(S){var D=s.indexToLoc(S),_=D.slice(-n.rank);d.forEach(function(E){return _[E]=0});var A=x.locToIndex(_),L=D.slice(-a.rank);h.forEach(function(E){return L[E]=0});var P=y.locToIndex(L),j=r(u[2*A],u[2*A+1],c[2*P],c[2*P+1]);p[S]=j.real,f[S]=j.imag};for(g=0;g<p.length;g++)N(g)}return this.complex(s.toTensor(),o.toTensor())},t.prototype.split=function(n,a,r){return IA(n,a,r)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,a,r,i,s,o){for(var u=n.shape,c=u[0],d=u[1],h=u[2],p=u[3],f=a.shape[0],g=i[0],b=i[1],w=Et([f,g,b,p],"float32"),m=this.readSync(a.dataId),x=this.readSync(r.dataId),y=this.readSync(n.dataId),N=n.strides,S=w.strides,D=0;D<f;D++){var _=4*D,A=m[_],L=m[_+1],P=m[_+2],j=m[_+3],E=x[D];if(!(E>=c))for(var F=g>1?(P-A)*(d-1)/(g-1):0,z=b>1?(j-L)*(h-1)/(b-1):0,U=0;U<g;U++){var O=g>1?A*(d-1)+U*F:.5*(A+P)*(d-1);if(O<0||O>d-1)for(var B=0;B<b;B++)for(var q=0;q<p;q++){var I=q+B*S[2]+U*S[1]+D*S[0];w.values[I]=o}else if(s==="bilinear"){var K=Math.floor(O),Z=Math.ceil(O),R=O-K;for(B=0;B<b;B++)if((ge=b>1?L*(h-1)+B*z:.5*(L+j)*(h-1))<0||ge>h-1)for(q=0;q<p;q++)I=q+B*S[2]+U*S[1]+D*S[0],w.values[I]=o;else{var H=Math.floor(ge),$=Math.ceil(ge),X=ge-H;for(q=0;q<p;q++){var W=y[I=q+H*N[2]+K*N[1]+E*N[0]],ie=y[I=q+$*N[2]+K*N[1]+E*N[0]],ce=y[I=q+H*N[2]+Z*N[1]+E*N[0]],ue=W+(ie-W)*X,he=ce+(y[I=q+$*N[2]+Z*N[1]+E*N[0]]-ce)*X;I=q+B*S[2]+U*S[1]+D*S[0],w.values[I]=ue+(he-ue)*R}}}else for(B=0;B<b;++B){var ge;if((ge=b>1?L*(h-1)+B*z:.5*(L+j)*(h-1))<0||ge>h-1)for(q=0;q<p;q++)I=q+B*S[2]+U*S[1]+D*S[0],w.values[I]=o;else{var Ee=Math.round(ge),Te=Math.round(O);for(q=0;q<p;q++){var fe=q+Ee*N[2]+Te*N[1]+E*N[0],me=q+B*S[2]+U*S[1]+D*S[0];w.values[me]=y[fe]}}}}}return w.toTensor()},t.prototype.sparseToDense=function(n,a,r,i){var s=B0(0,n,r),o=s.sliceRank,u=s.numUpdates,c=s.sliceSize,d=s.strides,h=s.outputSize;return this.scatter(n,a,r,h,c,u,o,d,i,!1)},t.prototype.gatherND=function(n,a){var r=a.shape,i=r[r.length-1],s=CA(n,a),o=s[0],u=s[1],c=s[2],d=s[3];if(u===0)return $a([],o,n.dtype);for(var h=new Jf([u,c],n.dtype),p=this.readSync(a.dataId),f=this.readSync(n.dataId),g=0;g<u;g++){for(var b=[],w=0,m=0;m<i;m++){var x=p[g*i+m];w+=x*d[m],b.push(x)}if(w<0||w>=n.size/c)throw new Error("Invalid indices: "+b+" does not index into "+n.shape);for(var y=0;y<c;y++)h.values[g*c+y]=f[w*c+y]}return h.toTensor().reshape(o)},t.prototype.scatterND=function(n,a,r){var i=B0(0,n,r),s=i.sliceRank,o=i.numUpdates,u=i.sliceSize,c=i.strides,d=i.outputSize,h=at(0);return this.scatter(n,a,r,d,u,o,s,c,h,!0)},t.prototype.fill=function(n,a,r){var i=E0(r=r||Pp(a),dt(n));return i.fill(a),ye.makeTensor(i,n,r,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var a=E0(n.dtype,dt(n.shape));return this.makeOutput(a,n.shape,n.dtype)},t.prototype.linspace=function(n,a,r){return MA(n,a,r)},t.prototype.scatter=function(n,a,r,i,s,o,u,c,d,h){var p=[i/s,s],f=this.readSync(n.dataId),g=this.readSync(a.dataId);if(i===0)return $a([],r,a.dtype);var b=new Jf(p,a.dtype);b.values.fill(this.readSync(d.dataId)[0]);for(var w=0;w<o;w++){for(var m=[],x=0,y=0;y<u;y++){var N=f[w*u+y];m.push(N),x+=N*c[y]}if(x<0||x>=i/s)throw new Error("Invalid indices: "+m+" does not index into "+r);for(var S=0;S<s;S++)h?b.values[x*s+S]+=g[w*s+S]:b.values[x*s+S]=a.rank===0?g[0]:g[w*s+S]}return b.toTensor().reshape(r)},t}(LA);ye.registerBackend("cpu",function(){return new Az},1);for(var t1=0,$4=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs,r=t,i=r.boxes,s=r.scores,o=a,u=o.maxOutputSize,c=o.iouThreshold,d=o.scoreThreshold,h=o.softNmsSigma,p=n;Ge(i,"NonMaxSuppressionWithScore");var f=Yw(p.data.get(i.dataId).values,p.data.get(s.dataId).values,u,c,d,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t.x,r=n;Ge(a,"square");for(var i=r.data.get(a.dataId).values,s=new Float32Array(i.length),o=0;o<i.length;++o){var u=i[o];s[o]=u*u}return{dataId:r.write(s,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},{kernelName:ep,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t,r=a.a,i=a.b,s=n;Ge([r,i],ep);var o=s.data.get(r.dataId).values,u=s.data.get(i.dataId).values,c=function(p,f,g,b,w,m){var x=zt(p,f),y=x.length,N=Bs(x),S=Xf(w,dt(x)),D=p.length,_=f.length,A=Bs(p),L=Bs(f),P=Nl(p,x),j=Nl(f,x);if(P.length+j.length===0)for(var E=0;E<S.length;++E)S[E]=m(g[E%g.length],b[E%b.length]);else{var F=function(z){var U=FO(z,y,N),O=U.slice(-D);P.forEach(function(K){return O[K]=0});var B=g4(O,D,A),q=U.slice(-_);j.forEach(function(K){return q[K]=0});var I=g4(q,_,L);S[z]=m(g[B],b[I])};for(E=0;E<S.length;++E)F(E)}return[S,x]}(r.shape,i.shape,o,u,r.dtype,function(p,f){var g=p-f;return g*g}),d=c[0],h=c[1];return{dataId:s.write(d,h,r.dtype),shape:h,dtype:r.dtype}}}];t1<$4.length;t1++)sA($4[t1]);var Fc,Ez=function(e){this.variableNames=["A"];var t=ir(),n=e[0],a=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+a+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},Dz=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=ir(),n=e[0],a=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+a+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var n1=0,K4=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs,r=t.pixels,i=a.numChannels,s=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,u=s?[r.videoWidth,r.videoHeight]:[r.width,r.height],c=u[0],d=u[1],h=[d,c],p=[d,c,i];(o||s)&&(Fc==null&&(Fc=document.createElement("canvas").getContext("2d")),Fc.canvas.width=c,Fc.canvas.height=d,Fc.drawImage(r,0,0,c,d),r=Fc.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=oi.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),r);var g=Be().getBool("WEBGL_PACK")?new Dz(p):new Ez(p),b=n.runWebGLProgram(g,[f],"int32");return n.disposeData(f.dataId),b}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs;P0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var r=t,i=r.boxes,s=r.scores,o=a,u=o.maxOutputSize,c=o.iouThreshold,d=o.scoreThreshold,h=o.softNmsSigma,p=n,f=Yw(p.readSync(i.dataId),p.readSync(s.dataId),u,c,d,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t.x,r=n,i=new Pt(a.shape,"return x * x;");return r.runWebGLProgram(i,[a],a.dtype)}},{kernelName:ep,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=t,r=a.a,i=a.b,s=n,o=Be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("return (a - b) * (a - b);",r.shape,i.shape):new Gn("return (a - b) * (a - b);",r.shape,i.shape);return s.compileAndRun(o,[r,i])}}];n1<K4.length;n1++)sA(K4[n1]);for(var a1=0,Y4=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:ep,gradFunc:function(e,t){var n=t[0],a=t[1],r=at(2);return{a:function(){return cr(e,cr(r,ja(n,a)))},b:function(){return cr(e,cr(r,ja(a,n)))}}}}];a1<Y4.length;a1++)CO(Y4[a1]);var Tz=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();Be().get("IS_BROWSER")&&Be().setPlatform("browser",new Tz);var r1,Lz=function(){return require("node-fetch")},Pz=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return Be().global.fetch!=null?Be().global.fetch(t,n):(r1==null&&(r1=Lz()),r1(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();Be().get("IS_NODE")&&Be().setPlatform("node",new Pz);var Vy={float32:4,int32:4,uint16:2,uint8:1,bool:1},G0=4;function E6(e,t){for(var n={},a=0,r=function(o){var u=o.name,c=o.dtype,d=o.shape,h=dt(d),p=void 0;if("quantization"in o){var f=o.quantization;if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error("Weight "+o.name+" has unknown quantization dtype "+f.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var g=Vy[f.dtype],b=e.slice(a,a+h*g),w=f.dtype==="uint8"?new Uint8Array(b):new Uint16Array(b);if(c==="float32")p=Float32Array.from(w,function(D){return D*f.scale+f.min});else{if(c!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+c);p=Int32Array.from(w,function(D){return Math.round(D*f.scale+f.min)})}a+=h*g}else if(c==="string"){var m=dt(o.shape);p=[];for(var x=0;x<m;x++){var y=new Uint32Array(e.slice(a,a+G0))[0];a+=G0;var N=new Uint8Array(e.slice(a,a+y));p.push(N),a+=y}}else{var S=Vy[c];if(b=e.slice(a,a+h*S),c==="float32")p=new Float32Array(b);else if(c==="int32")p=new Int32Array(b);else{if(c!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+c);p=new Uint8Array(b)}a+=h*S}n[u]=$a(p,d,c)},i=0,s=t;i<s.length;i++)r(s[i]);return n}function Rz(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var a=new Uint8Array(t),r=0;return n.forEach(function(i){a.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),a.buffer}var Gy=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function X4(e){return Gy?Buffer.byteLength(e):new Blob([e]).size}function p5(e){var t=0;e.forEach(function(r){t+=r.byteLength});var n=new Uint8Array(t),a=0;return e.forEach(function(r){n.set(new Uint8Array(r),a),a+=r.byteLength}),n.buffer}function J4(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function zp(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:X4(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:X4(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var li=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,a){var r=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var s=i(t,a);s!==null&&r.push(s)}),r},e}(),Cd="://",Ml=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){se(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Cd)&&(t=t.slice(0,t.indexOf(Cd))),se(t.length>0,function(){return"scheme must not be an empty string."});var a=e.getInstance();se(a.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),a.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Og(e){if(e.indexOf(Cd)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Ml.getSchemes().join(","));return{scheme:e.split(Cd)[0],path:e.split(Cd)[1]}}function Q4(e,t,n){return n===void 0&&(n=!1),lt(this,void 0,void 0,function(){var a,r,i,s,o,u,c,d,h;return ut(this,function(p){switch(p.label){case 0:return se(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),se((a=li.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),se(a.length<2,function(){return"Copying failed because more than one ("+a.length+") load handlers for source URL "+e+"."}),r=a[0],se((i=li.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),se(i.length<2,function(){return"Copying failed because more than one ("+a.length+") save handlers for destination URL "+t+"."}),s=i[0],o=Og(e).scheme,u=Og(e).path,c=o===Og(e).scheme,[4,r.load()];case 1:return d=p.sent(),n&&c?[4,Ml.getManager(o).removeModel(u)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,s.save(d)];case 4:return h=p.sent(),!n||c?[3,6]:[4,Ml.getManager(o).removeModel(u)];case 5:p.sent(),p.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var ku="models_store",kl="model_info_store";function D6(){if(!Be().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function $y(e){var t=e.result;t.createObjectStore(ku,{keyPath:"modelPath"}),t.createObjectStore(kl,{keyPath:"modelPath"})}var Ad=function(){function e(t){if(this.indexedDB=D6(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){return ut(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return lt(this,void 0,void 0,function(){return ut(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var a=this;return new Promise(function(r,i){var s=a.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return $y(s)},s.onsuccess=function(){var o=s.result;if(n==null){var u=o.transaction(ku,"readonly"),c=u.objectStore(ku).get(a.modelPath);c.onsuccess=function(){if(c.result==null)return o.close(),i(new Error("Cannot find model with path '"+a.modelPath+"' in IndexedDB."));r(c.result.modelArtifacts)},c.onerror=function(b){return o.close(),i(c.error)},u.oncomplete=function(){return o.close()}}else{var d,h=zp(n),p=o.transaction(kl,"readwrite"),f=p.objectStore(kl),g=f.put({modelPath:a.modelPath,modelArtifactsInfo:h});g.onsuccess=function(){var b=(d=o.transaction(ku,"readwrite")).objectStore(ku).put({modelPath:a.modelPath,modelArtifacts:n,modelArtifactsInfo:h});b.onsuccess=function(){return r({modelArtifactsInfo:h})},b.onerror=function(w){var m=(f=p.objectStore(kl)).delete(a.modelPath);m.onsuccess=function(){return o.close(),i(b.error)},m.onerror=function(x){return o.close(),i(b.error)}}},g.onerror=function(b){return o.close(),i(g.error)},p.oncomplete=function(){d==null?o.close():d.oncomplete=function(){return o.close()}}}},s.onerror=function(o){return i(s.error)}})},e.URL_SCHEME="indexeddb://",e}(),Z4=function(e){return Be().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ad.URL_SCHEME)?(t=e.slice(Ad.URL_SCHEME.length),new Ad(t)):null;var t};li.registerSaveRouter(Z4),li.registerLoadRouter(Z4);var Mz=function(){function e(){this.indexedDB=D6()}return e.prototype.listModels=function(){return lt(this,void 0,void 0,function(){var t=this;return ut(this,function(n){return[2,new Promise(function(a,r){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return $y(i)},i.onsuccess=function(){var s=i.result,o=s.transaction(kl,"readonly"),u=o.objectStore(kl).getAll();u.onsuccess=function(){for(var c={},d=0,h=u.result;d<h.length;d++){var p=h[d];c[p.modelPath]=p.modelArtifactsInfo}a(c)},u.onerror=function(c){return s.close(),r(u.error)},o.oncomplete=function(){return s.close()}},i.onerror=function(s){return r(i.error)}})]})})},e.prototype.removeModel=function(t){return lt(this,void 0,void 0,function(){var n=this;return ut(this,function(a){var r;return t=(r=t).startsWith(Ad.URL_SCHEME)?r.slice(Ad.URL_SCHEME.length):r,[2,new Promise(function(i,s){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return $y(o)},o.onsuccess=function(){var u,c=o.result,d=c.transaction(kl,"readwrite"),h=d.objectStore(kl),p=h.get(t);p.onsuccess=function(){if(p.result==null)return c.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var f=h.delete(t),g=function(){var b=(u=c.transaction(ku,"readwrite")).objectStore(ku).delete(t);b.onsuccess=function(){return i(p.result.modelArtifactsInfo)},b.onerror=function(w){return s(p.error)}};f.onsuccess=g,f.onerror=function(b){return g(),c.close(),s(p.error)}},p.onerror=function(f){return c.close(),s(p.error)},d.oncomplete=function(){u==null?c.close():u.oncomplete=function(){return c.close()}}},o.onerror=function(u){return s(o.error)}})]})})},e}();if(Be().getBool("IS_BROWSER"))try{Ml.registerManager(Ad.URL_SCHEME,new Mz)}catch{}var go="/",Xc="tensorflowjs_models",T6="info",Oz="model_topology",Iz="weight_specs",Fz="weight_data",Bz="model_metadata";function L6(e){return{info:[Xc,e,T6].join(go),topology:[Xc,e,Oz].join(go),weightSpecs:[Xc,e,Iz].join(go),weightData:[Xc,e,Fz].join(go),modelMetadata:[Xc,e,Bz].join(go)}}function zz(e){var t=e.split(go);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(go)}var Ed=function(){function e(t){if(!Be().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=L6(this.modelPath)}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){var n,a,r;return ut(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),a=JSON.stringify(t.weightSpecs),r=zp(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,a),this.LS.setItem(this.keys.weightData,function(s){if(Gy)return Buffer.from(s).toString("base64");for(var o=new Uint8Array(s),u="",c=0,d=o.length;c<d;c++)u+=String.fromCharCode(o[c]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return lt(this,void 0,void 0,function(){var t,n,a,r,i,s,o;return ut(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(a=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=a,(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=r,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(i),n.format=s.format,n.generatedBy=s.generatedBy,n.convertedBy=s.convertedBy,n.userDefinedMetadata=s.userDefinedMetadata),(o=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(c){if(Gy){var d=Buffer.from(c,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var h=atob(c),p=new Uint8Array(h.length),f=0;f<h.length;++f)p.set([h.charCodeAt(f)],f);return p.buffer}(o),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),ek=function(e){return Be().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ed.URL_SCHEME)?(t=e.slice(Ed.URL_SCHEME.length),new Ed(t)):null;var t};li.registerSaveRouter(ek),li.registerLoadRouter(ek);var Uz=function(){function e(){se(Be().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),se(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return lt(this,void 0,void 0,function(){var t,n,a,r,i,s;return ut(this,function(o){for(t={},n=Xc+go,a=go+T6,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(n)&&i.endsWith(a)&&(s=zz(i),t[s]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return lt(this,void 0,void 0,function(){var n,a;return ut(this,function(r){var i;if(t=(i=t).startsWith(Ed.URL_SCHEME)?i.slice(Ed.URL_SCHEME.length):i,n=L6(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return a=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,a]})})},e}();if(Be().getBool("IS_BROWSER"))try{Ml.registerManager(Ed.URL_SCHEME,new Uz)}catch{}var qz="model",Wz=".json",Hz=".weights.bin";function tk(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var i1=function(){function e(t){if(!Be().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=qz),this.modelTopologyFileName=t+Wz,this.weightDataFileName=t+Hz}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o;return ut(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:a},i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=i,[4,tk(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=n,[4,tk(function(){return o.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:zp(t)}]}})})},e.URL_SCHEME="downloads://",e}(),Vz=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return lt(this,void 0,void 0,function(){var t,n,a=this;return ut(this,function(r){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,s){var o=new FileReader;o.onload=function(u){var c=JSON.parse(u.target.result),d=c.modelTopology;if(d!=null){n.length===0&&i({modelTopology:d});var h=c.weightsManifest;if(h!=null){var p;try{p=a.checkManifestAndWeightFiles(h,n)}catch(w){return void s(w)}var f=[],g=[],b=[];h.forEach(function(w){w.paths.forEach(function(m){g.push(m),b.push(null)}),f.push.apply(f,w.weights)}),h.forEach(function(w){w.paths.forEach(function(m){var x=new FileReader;x.onload=function(y){var N=y.target.result,S=g.indexOf(m);b[S]=N,b.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:f,weightData:p5(b),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},x.onerror=function(y){return s("Failed to weights data from file of path '"+m+"'.")},x.readAsArrayBuffer(p[m])})})}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(u){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var a=[],r=n.map(function(u){return J4(u.name)}),i={},s=0,o=t;s<o.length;s++)o[s].paths.forEach(function(u){var c=J4(u);if(a.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(a.push(c),r.indexOf(c)===-1)throw new Error("Weight file with basename '"+c+"' is not provided.");i[u]=n[r.indexOf(c)]});if(a.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+a.length+") and the number of weight files provided ("+n.length+").");return i},e}();function nk(e,t,n,a){(function(i){se(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,s){se(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),se(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),se(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})}(n=n??0,a=a??1);var r=0;return Promise.all(e.map(function(i){return i.then(function(s){var o=n+ ++r/e.length*(a-n);return t(o),s}),i}))}function P6(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d;return ut(this,function(h){switch(h.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?Be().platform.fetch:t.fetchFunc,a=e.map(function(p){return n(p,t.requestInit,{isBinary:!0})}),r=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(a)];case 1:return s=h.sent(),[3,4];case 2:return[4,nk(a,t.onProgress,r,i)];case 3:s=h.sent(),h.label=4;case 4:return o=s.map(function(p){return p.arrayBuffer()}),u=.5,c=1,t.onProgress!=null?[3,6]:[4,Promise.all(o)];case 5:return d=h.sent(),[3,8];case 6:return[4,nk(o,t.onProgress,u,c)];case 7:d=h.sent(),h.label=8;case 8:return[2,d]}})})}function ak(e){var t=this;return function(n,a,r){return a===void 0&&(a=""),lt(t,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g;return ut(this,function(b){switch(b.label){case 0:if(i=n.map(function(){return!1}),s={},o=r!=null?r.map(function(){return!1}):[],u=[],n.forEach(function(w,m){var x=0;w.weights.forEach(function(y){var N="quantization"in y?y.quantization.dtype:y.dtype,S=Vy[N]*dt(y.shape),D=function(){i[m]=!0,s[m]==null&&(s[m]=[]),s[m].push({manifestEntry:y,groupOffset:x,sizeBytes:S})};r!=null?r.forEach(function(_,A){_===y.name&&(D(),o[A]=!0)}):D(),u.push(y.name),x+=S})}),!o.every(function(w){return w}))throw c=r.filter(function(w,m){return!o[m]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return d=i.reduce(function(w,m,x){return m&&w.push(x),w},[]),h=[],d.forEach(function(w){n[w].paths.forEach(function(m){var x=a+(a.endsWith("/")?"":"/")+m;h.push(x)})}),[4,e(h)];case 1:return p=b.sent(),f={},g=0,d.forEach(function(w){for(var m=n[w].paths.length,x=0,y=0;y<m;y++)x+=p[g+y].byteLength;for(var N=new ArrayBuffer(x),S=new Uint8Array(N),D=0,_=0;_<m;_++){var A=new Uint8Array(p[g+_]);S.set(A,D),D+=A.byteLength}s[w].forEach(function(L){var P=E6(N.slice(L.groupOffset,L.groupOffset+L.sizeBytes),[L.manifestEntry]);for(var j in P)f[j]=P[j]}),g+=m}),[2,f]}})})}}li.registerSaveRouter(function(e){return Be().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(i1.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new i1(t)}(e.slice(i1.URL_SCHEME.length)):null});var R6=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(se(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=Be().platform.fetch,se(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&se(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){var n,a,r,i;return ut(this,function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,a=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:a},n.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:zp(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return lt(this,void 0,void 0,function(){var t,n,a,r,i,s,o,u,c,d,h,p;return ut(this,function(f){switch(f.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=f.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,t.json()];case 3:return n=f.sent(),[3,5];case 4:throw f.sent(),a="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a);case 5:if(r=n.modelTopology,i=n.weightsManifest,s=n.generatedBy,o=n.convertedBy,u=n.format,c=n.userDefinedMetadata,r==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:p=f.sent(),d=p[0],h=p[1],f.label=7;case 7:return[2,{modelTopology:r,weightSpecs:d,weightData:h,userDefinedMetadata:c,generatedBy:s,convertedBy:o,format:u}]}})})},e.prototype.loadWeights=function(t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h,p;return ut(this,function(f){switch(f.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,a=function(g){var b=g.lastIndexOf("/"),w=g.lastIndexOf("?"),m=g.substring(0,b),x=w>b?g.substring(w):"";return[m+"/",x]}(n),r=a[0],i=a[1],s=this.weightPathPrefix||r,o=[],u=0,c=t;u<c.length;u++)d=c[u],o.push.apply(o,d.weights);return h=[],t.forEach(function(g){g.paths.forEach(function(b){h.push(s+b+i)})}),[4,P6(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=f.sent(),[2,[o,p5(p)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Ky(e){return e.match(R6.URL_SCHEME_REGEX)!=null}var rk=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Ky(n)}):Ky(e))?Yy(e,{onProgress:t}):null};function Yy(e,t){return new R6(e,t)}li.registerSaveRouter(rk),li.registerLoadRouter(rk);var s1=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return lt(this,void 0,void 0,function(){return ut(this,function(t){return[2,this.modelArtifacts]})})},e}(),Gz=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return lt(this,void 0,void 0,function(){return ut(this,function(n){return[2,this.saveHandler(t)]})})},e}(),M6=Object.freeze({browserFiles:function(e){return new Vz(e)},browserHTTPRequest:function(e,t){return Yy(e,t)},concatenateArrayBuffers:p5,decodeWeights:E6,encodeWeights:function(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o=this;return ut(this,function(u){switch(u.label){case 0:for(n=[],a=[],r=Array.isArray(e)?e.map(function(c){return c.name}):Object.keys(e),i=function(c){var d=r[c],h=Array.isArray(e)?e[c].tensor:e[d];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+h.dtype);var p={name:d,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var f=new Promise(function(g){return lt(o,void 0,void 0,function(){var b,w,m,x,y,N,S;return ut(this,function(D){switch(D.label){case 0:return[4,h.bytes()];case 1:for(b=D.sent(),w=b.reduce(function(_,A){return _+A.length},0)+G0*b.length,m=new Uint8Array(w),x=0,y=0;y<b.length;y++)N=b[y],S=new Uint8Array(new Uint32Array([N.length]).buffer),m.set(S,x),x+=G0,m.set(N,x),x+=N.length;return g(m),[2]}})})});a.push(f)}else a.push(h.data());t!=null&&(p.group=t),n.push(p)},s=0;s<r.length;++s)i(s);return[4,Promise.all(a)];case 1:return[2,{data:Rz(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,a){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new s1(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new s1({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new s1({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a}))},getLoadHandlers:function(e,t){return li.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:zp,getSaveHandlers:function(e){return li.getSaveHandlers(e)},http:Yy,isHTTPScheme:Ky,loadWeights:function(e,t,n,a){return t===void 0&&(t=""),lt(this,void 0,void 0,function(){return ut(this,function(r){return[2,ak(function(i){return P6(i,{requestInit:a})})(e,t,n)]})})},registerLoadRouter:function(e){return li.registerLoadRouter(e)},registerSaveRouter:function(e){return li.registerSaveRouter(e)},weightsLoaderFactory:ak,withSaveHandler:function(e){return new Gz(e)},copyModel:function(e,t){return lt(this,void 0,void 0,function(){return ut(this,function(n){return[2,Q4(e,t,!1)]})})},listModels:function(){return lt(this,void 0,void 0,function(){var e,t,n,a,r,i,s;return ut(this,function(o){switch(o.label){case 0:e=Ml.getSchemes(),t={},n=0,a=e,o.label=1;case 1:return n<a.length?(r=a[n],[4,Ml.getManager(r).listModels()]):[3,4];case 2:for(s in i=o.sent())t[r+Cd+s]=i[s];o.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return lt(this,void 0,void 0,function(){return ut(this,function(n){return[2,Q4(e,t,!0)]})})},removeModel:function(e){return lt(this,void 0,void 0,function(){var t;return ut(this,function(n){return t=Og(e),[2,Ml.getManager(t.scheme).removeModel(t.path)]})})}}),Bc;de({confusionMatrix_:function(e,t,n){var a=te(e,"labels","confusionMatrix"),r=te(t,"predictions","confusionMatrix");se(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),se(a.rank===1,function(){return"Expected the rank of labels to be 1, but got "+a.rank}),se(r.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+r.rank}),se(a.shape[0]===r.shape[0],function(){return"Mismatch in the number of examples: "+a.shape[0]+" vs. "+r.shape[0]+". Labels and predictions should have the same number of elements."}),se(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=zy(a.asType("int32"),n),s=zy(r.asType("int32"),n);return i.transpose().matMul(s).asType("int32")}});var $z=de({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,a=!1,r=!1,i=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)a=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);s=!0}if(r&&r&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(iA("FromPixels",ye.backendName)!=null)return ye.runKernel("FromPixels",{pixels:e},{numChannels:t});var o,u,c=r?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=c[0],h=c[1];if(s?o=e.getContext("2d").getImageData(0,0,d,h).data:a||n?o=e.data:(i||r)&&(Bc==null&&(Bc=document.createElement("canvas").getContext("2d")),Bc.canvas.width=d,Bc.canvas.height=h,Bc.drawImage(e,0,0,d,h),o=Bc.getImageData(0,0,d,h).data),t===4)u=new Int32Array(o);else{var p=d*h;u=new Int32Array(p*t);for(var f=0;f<p;f++)for(var g=0;g<t;++g)u[f*t+g]=o[4*f+g]}return Ww(u,[h,d,t],"int32")}}),m5=Object.freeze({toPixels:function(e,t){return lt(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,D,_,A;return ut(this,function(L){switch(L.label){case 0:if(n=te(e,"img","toPixels"),e instanceof zn||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(a=n.shape.slice(0,2),r=a[0],i=a[1],(s=n.rank===2?1:n.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return o=L.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(d=L.sent(),h=d[0],p=d[1],f=h[0],g=p[0],u.dispose(),c.dispose(),n.dtype==="float32"){if(f<0||g>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+g+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||g>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+g+"].")}for(b=n.dtype==="float32"?255:1,w=new Uint8ClampedArray(i*r*4),m=0;m<r*i;++m)x=void 0,y=void 0,N=void 0,S=void 0,s===1?(x=o[m]*b,y=o[m]*b,N=o[m]*b,S=255):s===3?(x=o[3*m]*b,y=o[3*m+1]*b,N=o[3*m+2]*b,S=255):s===4&&(x=o[4*m]*b,y=o[4*m+1]*b,N=o[4*m+2]*b,S=o[4*m+3]*b),w[(D=4*m)+0]=Math.round(x),w[D+1]=Math.round(y),w[D+2]=Math.round(N),w[D+3]=Math.round(S);return t!=null&&(t.width=i,t.height=r,_=t.getContext("2d"),A=new ImageData(w,i,r),_.putImageData(A,0,0)),n!==e&&n.dispose(),[2,w]}})})},fromPixels:$z}),Kz=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),Yz=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function ic(e){se(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),se(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),se(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Yz.register(e)}var sc=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return cs(t,e),t.prototype.minimize=function(n,a,r){a===void 0&&(a=!1);var i=this.computeGradients(n,r),s=i.value,o=i.grads;if(r!=null){var u=r.map(function(c){return{name:c.name,tensor:o[c.name]}});this.applyGradients(u)}else this.applyGradients(o);return Br(o),a?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,a){return i7(n,a)},t.prototype.dispose=function(){this.iterations_!=null&&Br(this.iterations_)},t.prototype.saveIterations=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:at(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){switch(r.label){case 0:return a=this,[4,n[0].tensor.data()];case 1:return a.iterations_=r.sent()[0],[2,n.slice(1)]}})})},t}(Kz);Object.defineProperty(sc,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var Xz=function(e){function t(n,a,r){r===void 0&&(r=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=a,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],r==null&&(i.epsilon=ye.backend.epsilon()),i}return cs(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=ye.registeredVariables[r];a.accumulatedGrads[i]==null&&(a.accumulatedGrads[i]={originalName:r+"/accum_grad",variable:st(function(){return Yt(s).variable(!1)})}),a.accumulatedUpdates[i]==null&&(a.accumulatedUpdates[i]={originalName:r+"/accum_var",variable:st(function(){return Yt(s).variable(!1)})});var o=Array.isArray(n)?n[i].tensor:n[r];if(o!=null){var u=a.accumulatedGrads[i].variable,c=a.accumulatedUpdates[i].variable;st(function(){var d=u.mul(a.rho).add(o.square().mul(1-a.rho)),h=c.add(a.epsilon).sqrt().div(u.add(a.epsilon).sqrt()).mul(o),p=c.mul(a.rho).add(h.square().mul(1-a.rho));u.assign(d),c.assign(p);var f=h.mul(-a.learningRate).add(s);s.assign(f)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Br(this.accumulatedGrads.map(function(n){return n.variable})),Br(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){var n;return ut(this,function(a){switch(a.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(n.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),a=n.length/2,this.accumulatedGrads=n.slice(0,a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(a,2*a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,a){return new n(a.learningRate,a.rho,a.epsilon)},t.className="Adadelta",t}(sc);ic(Xz);var Jz=function(e){function t(n,a){a===void 0&&(a=.1);var r=e.call(this)||this;return r.learningRate=n,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return cs(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=ye.registeredVariables[r];a.accumulatedGrads[i]==null&&(a.accumulatedGrads[i]={originalName:r+"/accumulator",variable:st(function(){return zs(s.shape,a.initialAccumulatorValue).variable(!1)})});var o=Array.isArray(n)?n[i].tensor:n[r];if(o!=null){var u=a.accumulatedGrads[i].variable;st(function(){var c=u.add(o.square());u.assign(c);var d=o.div(c.add(ye.backend.epsilon()).sqrt()).mul(-a.learningRate).add(s);s.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Br(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),this.accumulatedGrads=n.map(function(r){return{originalName:r.name,variable:r.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,a){return new n(a.learningRate,a.initialAccumulatorValue)},t.className="Adagrad",t}(sc);ic(Jz);var Qz=function(e){function t(n,a,r,i){i===void 0&&(i=null);var s=e.call(this)||this;return s.learningRate=n,s.beta1=a,s.beta2=r,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],st(function(){s.accBeta1=at(a).variable(),s.accBeta2=at(r).variable()}),i==null&&(s.epsilon=ye.backend.epsilon()),s}return cs(t,e),t.prototype.applyGradients=function(n){var a=this,r=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);st(function(){var i=ja(1,a.accBeta1),s=ja(1,a.accBeta2);r.forEach(function(o,u){var c=ye.registeredVariables[o];a.accumulatedFirstMoment[u]==null&&(a.accumulatedFirstMoment[u]={originalName:o+"/m",variable:st(function(){return Yt(c).variable(!1)})}),a.accumulatedSecondMoment[u]==null&&(a.accumulatedSecondMoment[u]={originalName:o+"/v",variable:st(function(){return Yt(c).variable(!1)})});var d=Array.isArray(n)?n[u].tensor:n[o];if(d!=null){var h=a.accumulatedFirstMoment[u].variable,p=a.accumulatedSecondMoment[u].variable,f=h.mul(a.beta1).add(d.mul(1-a.beta1)),g=p.mul(a.beta2).add(d.square().mul(1-a.beta2)),b=f.div(i),w=g.div(s);h.assign(f),p.assign(g);var m=b.div(w.sqrt().add(a.epsilon)).mul(-a.learningRate).add(c);c.assign(m)}}),a.accBeta1.assign(a.accBeta1.mul(a.beta1)),a.accBeta2.assign(a.accBeta2.mul(a.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Br(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Br(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){var n;return ut(this,function(a){switch(a.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(n.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){var a,r=this;return ut(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),st(function(){r.accBeta1.assign(H0(r.beta1,r.iterations_+1)),r.accBeta2.assign(H0(r.beta2,r.iterations_+1))}),a=n.length/2,this.accumulatedFirstMoment=n.slice(0,a).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(a,2*a).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,a){return new n(a.learningRate,a.beta1,a.beta2,a.epsilon)},t.className="Adam",t}(sc);ic(Qz);var Zz=function(e){function t(n,a,r,i,s){i===void 0&&(i=null),s===void 0&&(s=0);var o=e.call(this)||this;return o.learningRate=n,o.beta1=a,o.beta2=r,o.epsilon=i,o.decay=s,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],st(function(){o.iteration=at(0).variable(),o.accBeta1=at(a).variable()}),i==null&&(o.epsilon=ye.backend.epsilon()),o}return cs(t,e),t.prototype.applyGradients=function(n){var a=this,r=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);st(function(){var i=ja(1,a.accBeta1),s=rs(-a.learningRate,a.iteration.mul(a.decay).add(1));r.forEach(function(o,u){var c=ye.registeredVariables[o];a.accumulatedFirstMoment[u]==null&&(a.accumulatedFirstMoment[u]={originalName:o+"/m",variable:Yt(c).variable(!1)}),a.accumulatedWeightedInfNorm[u]==null&&(a.accumulatedWeightedInfNorm[u]={originalName:o+"/v",variable:Yt(c).variable(!1)});var d=Array.isArray(n)?n[u].tensor:n[o];if(d!=null){var h=a.accumulatedFirstMoment[u].variable,p=a.accumulatedWeightedInfNorm[u].variable,f=h.mul(a.beta1).add(d.mul(1-a.beta1)),g=p.mul(a.beta2),b=d.abs(),w=g.maximum(b);h.assign(f),p.assign(w);var m=s.div(i).mul(f.div(w.add(a.epsilon))).add(c);c.assign(m)}}),a.iteration.assign(a.iteration.add(1)),a.accBeta1.assign(a.accBeta1.mul(a.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Br(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Br(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,a){return new n(a.learningRate,a.beta1,a.beta2,a.epsilon,a.decay)},t.className="Adamax",t}(sc);ic(Zz);var O6=function(e){function t(n){var a=e.call(this)||this;return a.learningRate=n,a.setLearningRate(n),a}return cs(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=Array.isArray(n)?n[i].tensor:n[r];if(s!=null){var o=ye.registeredVariables[r];st(function(){var u=a.c.mul(s).add(o);o.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=bI(at(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=a.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,a){return new n(a.learningRate)},t.className="SGD",t}(sc);ic(O6);var eU=function(e){function t(n,a,r){r===void 0&&(r=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=a,i.useNesterov=r,i.accumulations=[],i.m=at(i.momentum),i}return cs(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=ye.registeredVariables[r];a.accumulations[i]==null&&(a.accumulations[i]={originalName:r+"/momentum",variable:st(function(){return Yt(s).variable(!1)})});var o=a.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[r];u!=null&&st(function(){var c,d=a.m.mul(o).add(u);c=a.useNesterov?a.c.mul(u.add(d.mul(a.m))).add(s):a.c.mul(d).add(s),o.assign(d),s.assign(c)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Br(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){return ut(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){return ut(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),this.accumulations=n.map(function(r){return{originalName:r.name,variable:r.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,a){return new n(a.learningRate,a.momentum,a.useNesterov)},t.className="Momentum",t}(O6);ic(eU);var tU=function(e){function t(n,a,r,i,s){a===void 0&&(a=.9),r===void 0&&(r=0),i===void 0&&(i=null),s===void 0&&(s=!1);var o=e.call(this)||this;if(o.learningRate=n,o.decay=a,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=s,i==null&&(o.epsilon=ye.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return cs(t,e),t.prototype.applyGradients=function(n){var a=this;(Array.isArray(n)?n.map(function(r){return r.name}):Object.keys(n)).forEach(function(r,i){var s=ye.registeredVariables[r];a.accumulatedMeanSquares[i]==null&&(a.accumulatedMeanSquares[i]={originalName:r+"/rms",variable:st(function(){return Yt(s).variable(!1)})}),a.accumulatedMoments[i]==null&&(a.accumulatedMoments[i]={originalName:r+"/momentum",variable:st(function(){return Yt(s).variable(!1)})}),a.accumulatedMeanGrads[i]==null&&a.centered&&(a.accumulatedMeanGrads[i]={originalName:r+"/mg",variable:st(function(){return Yt(s).variable(!1)})});var o=Array.isArray(n)?n[i].tensor:n[r];if(o!=null){var u=a.accumulatedMeanSquares[i].variable,c=a.accumulatedMoments[i].variable;st(function(){var d=u.mul(a.decay).add(o.square().mul(1-a.decay));if(a.centered){var h=a.accumulatedMeanGrads[i].variable,p=h.mul(a.decay).add(o.mul(1-a.decay)),f=c.mul(a.momentum).add(o.mul(a.learningRate).div(d.sub(p.square().add(a.epsilon)).sqrt()));u.assign(d),h.assign(p),c.assign(f);var g=s.sub(f);s.assign(g)}else{var b=u.mul(a.decay).add(o.square().mul(1-a.decay));f=c.mul(a.momentum).add(o.mul(a.learningRate).div(b.add(a.epsilon).sqrt())),u.assign(b),c.assign(f),g=s.sub(f),s.assign(g)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Br(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Br(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Br(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return lt(this,void 0,void 0,function(){var n;return ut(this,function(a){switch(a.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(n.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return lt(this,void 0,void 0,function(){var a;return ut(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),a=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(a,2*a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*a,3*a).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,a){return new n(a.learningRate,a.decay,a.momentum,a.epsilon,a.centered)},t.className="RMSProp",t}(sc);ic(tU);zn.prototype.squaredDifference=function(e){return JA(this,e)},Re=Cz;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Xy=function(e,t){return Xy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)a.hasOwnProperty(r)&&(n[r]=a[r])},Xy(e,t)};function Ct(e,t){Xy(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var rr=function(){return rr=Object.assign||function(t){for(var n,a=1,r=arguments.length;a<r;a++){n=arguments[a];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},rr.apply(this,arguments)};function ft(e,t,n,a){function r(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function o(d){try{c(a.next(d))}catch(h){s(h)}}function u(d){try{c(a.throw(d))}catch(h){s(h)}}function c(d){d.done?i(d.value):r(d.value).then(o,u)}c((a=a.apply(e,[])).next())})}function pt(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,r,i,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(c){return function(d){return u([c,d])}}function u(c){if(a)throw new TypeError("Generator is already executing.");for(;n;)try{if(a=1,r&&(i=c[0]&2?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(d){c=[6,d],r=0}finally{a=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Af(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var a=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],s=0,o=i.length;s<o;s++,r++)a[r]=i[s];return a}var Pu=function(){function e(t,n){if(!Ru(t)||!Ru(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Hv(e,t){return e instanceof zn&&e.shape.length===t}function nU(e){return Hv(e,2)}function Vv(e){return Hv(e,3)}function Ol(e){return Hv(e,4)}function aU(e){return e%1!==0}function ik(e){return e%2===0}function rU(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function sk(e){return e&&e.width&&e.height}function iU(e,t){var n=e.width,a=e.height,r=t/Math.max(a,n);return new Pu(Math.round(n*r),Math.round(a*r))}function g5(e){return e.reduce(function(t,n){return t.add(n)},new an(0,0)).div(new an(e.length,e.length))}function tp(e,t,n){return Array(e).fill(0).map(function(a,r){return t+r*n})}function Ru(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function ok(e){return Ru(e)&&0<=e&&e<=1}var an=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Hl=function(){function e(t,n){n===void 0&&(n=!0);var a=t||{},r=[a.left,a.top,a.right,a.bottom].every(Ru),i=[a.x,a.y,a.width,a.height].every(Ru);if(!i&&!r)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(a));var s=i?[a.x,a.y,a.width,a.height]:[a.left,a.top,a.right-a.left,a.bottom-a.top],o=s[0],u=s[1],c=s[2],d=s[3];e.assertIsValidBox({x:o,y:u,width:c,height:d},"Box.constructor",n),this._x=o,this._y=u,this._width=c,this._height=d}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Ru)},e.assertIsValidBox=function(t,n,a){if(a===void 0&&(a=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!a&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new an(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new an(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new an(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new an(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),n=t[0],a=t[1],r=t[2],i=t[3];return new e({x:n,y:a,width:r,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),n=t[0],a=t[1],r=t[2],i=t[3];return new e({x:n,y:a,width:r,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,a=t.y,r=t.width,i=t.height,s=Math.abs(r-i);return r<i&&(n-=s/2,r+=s),i<r&&(a-=s/2,i+=s),new e({x:n,y:a,width:r,height:i})},e.prototype.rescale=function(t){var n=sk(t)?t.width:t,a=sk(t)?t.height:t;return new e({x:this.x*n,y:this.y*a,width:this.width*n,height:this.height*a})},e.prototype.pad=function(t,n){var a=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],r=a[0],i=a[1],s=a[2],o=a[3];return new e({x:r,y:i,width:s,height:o})},e.prototype.clipAtImageBorders=function(t,n){var a=this,r=a.x,i=a.y,s=a.right,o=a.bottom,u=Math.max(r,0),c=Math.max(i,0),d=s-u,h=o-c,p=Math.min(d,t-u),f=Math.min(h,n-c);return new e({x:u,y:c,width:p,height:f}).floor()},e.prototype.shift=function(t,n){var a=this,r=a.width,i=a.height,s=this.x+t,o=this.y+n;return new e({x:s,y:o,width:r,height:i})},e.prototype.padAtBorders=function(t,n){var a=this.width+1,r=this.height+1,i=1,s=1,o=a,u=r,c=this.left,d=this.top,h=this.right,p=this.bottom;return h>n&&(o=-h+n+a,h=n),p>t&&(u=-p+t+r,p=t),c<1&&(u=2-c,c=1),d<1&&(u=2-d,d=1),{dy:s,edy:u,dx:i,edx:o,y:d,ey:p,x:c,ex:h,w:a,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Gv=function(e){Ct(t,e);function t(n,a,r,i,s){return s===void 0&&(s=!1),e.call(this,{left:n,top:a,right:r,bottom:i},s)||this}return t}(Hl),I6=function(){function e(t,n,a,r,i){this._imageDims=new Pu(i.width,i.height),this._score=t,this._classScore=n,this._className=a,this._box=new Hl(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Hl(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),hs=function(e){Ct(t,e);function t(n,a,r){return e.call(this,n,n,"",a,r)||this}return t.prototype.forSize=function(n,a){var r=e.prototype.forSize.call(this,n,a),i=r.score,s=r.relativeBox,o=r.imageDims;return new t(i,s,o)},t}(I6);function sU(e,t,n){n===void 0&&(n=!0);var a=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),r=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=a*r;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function oU(e){var t=e.map(function(o){return o.x}),n=e.map(function(o){return o.y}),a=t.reduce(function(o,u){return u<o?u:o},1/0),r=n.reduce(function(o,u){return u<o?u:o},1/0),i=t.reduce(function(o,u){return o<u?u:o},0),s=n.reduce(function(o,u){return o<u?u:o},0);return new Gv(a,r,i,s)}function np(e,t,n,a){a===void 0&&(a=!0);for(var r=t.map(function(o,u){return{score:o,boxIndex:u}}).sort(function(o,u){return o.score-u.score}).map(function(o){return o.boxIndex}),i=[],s=function(){var o=r.pop();i.push(o);for(var u=r,c=[],d=0;d<u.length;d++){var h=u[d],p=e[o],f=e[h];c.push(sU(p,f,a))}r=r.filter(function(g,b){return c[b]<=n})};r.length>0;)s();return i}function Up(e,t){return st(function(){var n=t[0],a=t[1],r=t[2],i=zs(Af(e.shape.slice(0,3),[1]),n),s=zs(Af(e.shape.slice(0,3),[1]),a),o=zs(Af(e.shape.slice(0,3),[1]),r),u=Na([i,s,o],3);return ja(e,u)})}function lU(e,t){return t===void 0&&(t=!1),st(function(){var n=e.shape.slice(1),a=n[0],r=n[1];if(a===r)return e;var i=Math.abs(a-r),s=Math.round(i*(t?.5:1)),o=a>r?2:1,u=function(f){var g=e.shape.slice();return g[o]=f,zs(g,0)},c=u(s),d=i-c.shape[o],h=t&&d?u(d):null,p=[h,e,c].filter(function(f){return!!f}).map(function(f){return f.toFloat()});return Na(p,o)})}function o1(e){return 1/(1+Math.exp(-e))}var v5=function(e){Ct(t,e);function t(n,a,r,i,s){return s===void 0&&(s=!1),e.call(this,{x:n,y:a,width:r,height:i},s)||this}return t}(Hl),uU=.5,cU=.43,dU=.45,ap=function(){function e(t,n,a){a===void 0&&(a=new an(0,0));var r=n.width,i=n.height;this._imgDims=new Pu(r,i),this._shift=a,this._positions=t.map(function(s){return s.mul(new an(r,i)).add(a)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new an(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new an(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new an(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var a=t instanceof hs?t.box.floor():new Hl(t);return this.shiftBy(a.x,a.y).align(null,n)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=r.useDlibAlignment,s=r.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(s)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],a=t[1],r=t[2],i=function(h){return r.sub(h).magnitude()},s=(i(n)+i(a))/2,o=Math.floor(s/dU),u=g5(t),c=Math.floor(Math.max(0,u.x-uU*o)),d=Math.floor(Math.max(0,u.y-cU*o));return new v5(c,d,Math.min(o,this.imageWidth+c),Math.min(o,this.imageHeight+d))},e.prototype.alignMinBbox=function(t){var n=oU(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),hU=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],g5([n[3],n[4]])]},t}(ap),fU=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(g5)},t}(ap),lk=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+rU(this.distance)+")":"")},e}(),uk=function(e){Ct(t,e);function t(n,a){var r=e.call(this,n)||this;return r._label=a,r}return t.assertIsValidLabeledBox=function(n,a){if(Hl.assertIsValidBox(n,a),!Ru(n.label))throw new Error(a+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Hl),lg=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(a){return!(a instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(a){return new Float32Array(a)});return new e(t.label,n)},e}();(function(e){Ct(t,e);function t(n,a,r,i){var s=e.call(this,n,a)||this;return s._score=r,s._classScore=i,s}return t.assertIsValidPredictedBox=function(n,a){if(uk.assertIsValidLabeledBox(n,a),!ok(n.score)||!ok(n.classScore))throw new Error(a+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(uk);function F6(e){return e.detection instanceof hs}function rp(e,t){var n={detection:t};return Object.assign({},e,n)}function B6(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function z6(e){var t="";if(!e)try{e=require("fs")}catch(a){t=a.toString()}var n=e?function(a){return new Promise(function(r,i){e.readFile(a,function(s,o){return s?i(s):r(o)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function U6(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},r=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=z6();return rr({Canvas:e||function(){function s(){}return s}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function s(){}return s}(),Image:t||function(){function s(){}return s}(),ImageData:global.ImageData||function(){function s(){}return s}(),Video:global.HTMLVideoElement||function(){function s(){}return s}(),createCanvasElement:n,createImageElement:a,fetch:r},i)}function q6(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function W6(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var va;function pU(){if(!va)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return va}function Jy(e){va=e}function x5(){q6()&&Jy(B6()),W6()&&Jy(U6())}function mU(e){if(va||x5(),!va)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?va.Canvas:t,a=e.Image,r=a===void 0?va.Image:a;va.Canvas=n,va.Image=r,va.createCanvasElement=e.createCanvasElement||function(){return new n},va.createImageElement=e.createImageElement||function(){return new r},va.ImageData=e.ImageData||va.ImageData,va.Video=e.Video||va.Video,va.fetch=e.fetch||va.fetch,va.readFile=e.readFile||va.readFile}var fr={getEnv:pU,setEnv:Jy,initialize:x5,createBrowserEnv:B6,createFileSystem:z6,createNodejsEnv:U6,monkeyPatch:mU,isBrowser:q6,isNodejs:W6};x5();function H6(e){return!fr.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Yu(e){var t=fr.getEnv(),n=t.Canvas,a=t.CanvasRenderingContext2D;if(e instanceof a)return e;var r=H6(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=r.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var ck;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(ck||(ck={}));function V6(e){var t=fr.getEnv(),n=t.Image,a=t.Video;return e instanceof n&&e.complete||e instanceof a&&e.readyState>=3}function gU(e){return new Promise(function(t,n){if(e instanceof fr.getEnv().Canvas||V6(e))return t();function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),t(i))}function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),n(i))}e.addEventListener("load",a),e.addEventListener("error",r)})}function b5(e){var t=fr.getEnv(),n=t.Image,a=t.Video;return e instanceof n?new Pu(e.naturalWidth,e.naturalHeight):e instanceof a?new Pu(e.videoWidth,e.videoHeight):new Pu(e.width,e.height)}function $v(e){var t=e.width,n=e.height,a=fr.getEnv().createCanvasElement,r=a();return r.width=t,r.height=n,r}function y5(e,t){var n=fr.getEnv().ImageData;if(!(e instanceof n)&&!V6(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var a=b5(e),r=a.width,i=a.height,s=$v({width:r,height:i});return e instanceof n?Yu(s).putImageData(e,0,0):Yu(s).drawImage(e,0,0,r,i),s}function vU(e,t){return ft(this,void 0,void 0,function(){var n,a,r,i,s,o;return pt(this,function(u){switch(u.label){case 0:return n=fr.getEnv().createCanvasElement(),a=e.shape.slice(Ol(e)?1:0),r=a[0],i=a[1],s=a[2],o=st(function(){return e.as3D(r,i,s).toInt()}),[4,m5.toPixels(o,n)];case 1:return u.sent(),o.dispose(),[2,n]}})})}function dk(e){var t=fr.getEnv(),n=t.Image,a=t.Canvas,r=t.Video;return e instanceof n||e instanceof a||e instanceof r}function xU(e,t,n){n===void 0&&(n=!1);var a=fr.getEnv(),r=a.Image,i=a.Canvas;if(!(e instanceof r||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=b5(e),o=t/Math.max(s.height,s.width),u=o*s.width,c=o*s.height,d=$v({width:t,height:t}),h=e instanceof i?e:y5(e),p=Math.abs(u-c)/2,f=n&&u<c?p:0,g=n&&c<u?p:0;return Yu(d).drawImage(h,f,g,u,c),d}var $0=function(){function e(t,n){var a=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(r,i){if(Vv(r)){a._imageTensors[i]=r,a._inputDimensions[i]=r.shape;return}if(Ol(r)){var s=r.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");a._imageTensors[i]=r,a._inputDimensions[i]=r.shape.slice(1);return}var o=r instanceof fr.getEnv().Canvas?r:y5(r);a._canvases[i]=o,a._inputDimensions[i]=[o.height,o.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return tp(this.batchSize,0,1).map(function(n,a){return t.getReshapedInputDimensions(a)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),a=this.getInputHeight(t);return iU({width:n,height:a},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var a=this;return n===void 0&&(n=!0),this._inputSize=t,st(function(){var r=tp(a.batchSize,0,1).map(function(s){var o=a.getInput(s);if(o instanceof zn){var u=Ol(o)?o:o.expandDims();return u=lU(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=u5.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(o instanceof fr.getEnv().Canvas)return m5.fromPixels(xU(o,t,n));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)}),i=gi(r.map(function(s){return s.toFloat()})).as4D(a.batchSize,t,t,3);return i})},e}();function Ba(e){return ft(this,void 0,void 0,function(){var t,n,a;return pt(this,function(r){switch(r.label){case 0:if(e instanceof $0)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},a=t.map(H6),a.forEach(function(i,s){if(!dk(i)&&!Vv(i)&&!Ol(i))throw typeof t[s]=="string"?new Error("toNetInput -"+n(s)+" string passed, but could not resolve HTMLElement for element id "+t[s]):new Error("toNetInput -"+n(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ol(i)){var o=i.shape[0];if(o!==1)throw new Error("toNetInput -"+n(s)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}}),[4,Promise.all(a.map(function(i){return dk(i)&&gU(i)}))];case 1:return r.sent(),[2,new $0(a,Array.isArray(e))]}})})}function w5(e,t){return ft(this,void 0,void 0,function(){var n,a,r,i,s,o,u;return pt(this,function(c){switch(c.label){case 0:return n=fr.getEnv().Canvas,a=e,e instanceof n?[3,5]:[4,Ba(e)];case 1:if(r=c.sent(),r.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=r.getInput(0),i instanceof n?(s=i,[3,4]):[3,2];case 2:return[4,vU(i)];case 3:s=c.sent(),c.label=4;case 4:a=s,c.label=5;case 5:return o=Yu(a),u=t.map(function(d){return d instanceof hs?d.forSize(a.width,a.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(a.width,a.height)}),[2,u.map(function(d){var h=d.x,p=d.y,f=d.width,g=d.height,b=$v({width:f,height:g});return Yu(b).putImageData(o.getImageData(h,p,f,g),0,0),b})]}})})}function N5(e,t){return ft(this,void 0,void 0,function(){return pt(this,function(n){if(!Vv(e)&&!Ol(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ol(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,st(function(){var a=e.shape.slice(Ol(e)?1:0),r=a[0],i=a[1],s=a[2],o=t.map(function(c){return c instanceof hs?c.forSize(i,r).box:c}).map(function(c){return c.clipAtImageBorders(i,r)}),u=o.map(function(c){var d=c.x,h=c.y,p=c.width,f=c.height;return x6(e.as3D(r,i,s),[h,d,0],[f,p,s])});return u})]})})}function bU(e,t){return ft(this,void 0,void 0,function(){var n,a;return pt(this,function(r){switch(r.label){case 0:return n=fr.getEnv().fetch,[4,n(e,t)];case 1:if(a=r.sent(),!(a.status<400))throw new Error("failed to fetch: ("+a.status+") "+a.statusText+", from url: "+a.url);return[2,a]}})})}function yU(e){return ft(this,void 0,void 0,function(){return pt(this,function(t){switch(t.label){case 0:return[4,bU(e)];case 1:return[2,t.sent().json()]}})})}function G6(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var a=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(a,"");var r=e.split("/").filter(function(o){return o}),i=e.endsWith(".json")?r[r.length-1]:n,s=a+(e.endsWith(".json")?r.slice(0,r.length-1):r).join("/");return s=e.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+i:s+"/"+i}}function wU(e,t){return ft(this,void 0,void 0,function(){var n,a,r,i;return pt(this,function(s){switch(s.label){case 0:return n=G6(e,t),a=n.manifestUri,r=n.modelBaseUri,[4,yU(a)];case 1:return i=s.sent(),[2,M6.loadWeights(i,r)]}})})}function NU(e,t,n){n===void 0&&(n=!1);var a=n?b5(t):t,r=a.width,i=a.height;return e.width=r,e.height=i,{width:r,height:i}}var Ro=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),a=n.obj,r=n.objProp;return a[r]},e.prototype.reassignParamFromPath=function(t,n){var a=this.traversePropertyPath(t),r=a.obj,i=a.objProp;r[i].dispose(),r[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var a=n.paramPath;return{path:a,tensor:t.getParamFromPath(a)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Kd})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Kd)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var a=n.path,r=n.tensor;t.reassignParamFromPath(a,r.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var a=n.path,r=n.tensor,i=$a(r.dataSync());r.dispose(),t.reassignParamFromPath(a,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return ft(this,void 0,void 0,function(){return pt(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return ft(this,void 0,void 0,function(){var n;return pt(this,function(a){switch(a.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,wU(t,this.getDefaultModelName())];case 1:return n=a.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return ft(this,void 0,void 0,function(){var n,a,r,i,s,o,u,c,d,h;return pt(this,function(p){switch(p.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=fr.getEnv().readFile,a=G6(t,this.getDefaultModelName()),r=a.manifestUri,i=a.modelBaseUri,s=function(f){return Promise.all(f.map(function(g){return n(g).then(function(b){return b.buffer})}))},o=M6.weightsLoaderFactory(s),d=(c=JSON).parse,[4,n(r)];case 1:return u=d.apply(c,[p.sent().toString()]),[4,o(u,i)];case 2:return h=p.sent(),this.loadFromWeightMap(h),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),a=n.paramMappings,r=n.params;this._paramMappings=a,this._params=r},e.prototype.extractWeights=function(t){var n=this.extractParams(t),a=n.paramMappings,r=n.params;this._paramMappings=a,this._params=r},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,s){if(!i.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+t);return{obj:i.nextObj,objProp:s,nextObj:i.nextObj[s]}},{nextObj:this.params}),a=n.obj,r=n.objProp;if(!a||!r||!(a[r]instanceof zn))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:a,objProp:r}},e}();function ui(e,t,n){return st(function(){var a=r5(e,t.depthwise_filter,t.pointwise_filter,n,"same");return a=Ot(a,t.bias),a})}function l1(e,t,n){return n===void 0&&(n=!1),st(function(){var a=Un(n?Ot($i(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):ui(e,t.conv0,[2,2])),r=ui(a,t.conv1,[1,1]),i=Un(Ot(a,r)),s=ui(i,t.conv2,[1,1]);return Un(Ot(a,Ot(r,s)))})}function ug(e,t,n,a){return n===void 0&&(n=!1),a===void 0&&(a=!0),st(function(){var r=Un(n?Ot($i(e,t.conv0.filters,a?[2,2]:[1,1],"same"),t.conv0.bias):ui(e,t.conv0,a?[2,2]:[1,1])),i=ui(r,t.conv1,[1,1]),s=Un(Ot(r,i)),o=ui(s,t.conv2,[1,1]),u=Un(Ot(r,Ot(i,o))),c=ui(u,t.conv3,[1,1]);return Un(Ot(r,Ot(i,Ot(o,c))))})}function os(e,t,n,a){return n===void 0&&(n="same"),a===void 0&&(a=!1),st(function(){var r=Ot($i(e,t.filters,[1,1],n),t.bias);return a?Un(r):r})}function Mo(e,t){Object.keys(e).forEach(function(n){t.some(function(a){return a.originalPath===n})||e[n].dispose()})}function Kv(e,t){return function(n,a,r,i){var s=Or(e(n*a*r*r),[r,r,n,a]),o=ha(e(a));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:s,bias:o}}}function k5(e,t){return function(n,a,r){var i=Rl(e(n*a),[n,a]),s=ha(e(a));return t.push({paramPath:r+"/weights"},{paramPath:r+"/bias"}),{weights:i,bias:s}}}var $6=function(){function e(t,n,a){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=a}return e}();function S5(e,t){return function(n,a,r){var i=Or(e(9*n),[3,3,n,1]),s=Or(e(n*a),[1,1,n,a]),o=ha(e(a));return t.push({paramPath:r+"/depthwise_filter"},{paramPath:r+"/pointwise_filter"},{paramPath:r+"/bias"}),new $6(i,s,o)}}function _5(e){return function(t){var n=e(t+"/depthwise_filter",4),a=e(t+"/pointwise_filter",4),r=e(t+"/bias",1);return new $6(n,a,r)}}function Jl(e,t){return function(n,a,r){var i=e[n];if(!Hv(i,a))throw new Error("expected weightMap["+n+"] to be a Tensor"+a+"D, instead have "+i);return t.push({originalPath:n,paramPath:r||n}),i}}function Oo(e){var t=e;function n(r){var i=t.slice(0,r);return t=t.slice(r),i}function a(){return t}return{extractWeights:n,getRemainingWeights:a}}function K6(e,t){var n=Kv(e,t),a=S5(e,t);function r(s,o,u,c){c===void 0&&(c=!1);var d=c?n(s,o,3,u+"/conv0"):a(s,o,u+"/conv0"),h=a(o,o,u+"/conv1"),p=a(o,o,u+"/conv2");return{conv0:d,conv1:h,conv2:p}}function i(s,o,u,c){c===void 0&&(c=!1);var d=r(s,o,u,c),h=d.conv0,p=d.conv1,f=d.conv2,g=a(o,o,u+"/conv3");return{conv0:h,conv1:p,conv2:f,conv3:g}}return{extractDenseBlock3Params:r,extractDenseBlock4Params:i}}function kU(e){var t=[],n=Oo(e),a=n.extractWeights,r=n.getRemainingWeights,i=K6(a,t).extractDenseBlock4Params,s=i(3,32,"dense0",!0),o=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:t,params:{dense0:s,dense1:o,dense2:u,dense3:c}}}function Y6(e){return function(t){var n=e(t+"/filters",4),a=e(t+"/bias",1);return{filters:n,bias:a}}}function X6(e,t){var n=Jl(e,t),a=Y6(n),r=_5(n);function i(o,u){u===void 0&&(u=!1);var c=u?a(o+"/conv0"):r(o+"/conv0"),d=r(o+"/conv1"),h=r(o+"/conv2");return{conv0:c,conv1:d,conv2:h}}function s(o,u){u===void 0&&(u=!1);var c=u?a(o+"/conv0"):r(o+"/conv0"),d=r(o+"/conv1"),h=r(o+"/conv2"),p=r(o+"/conv3");return{conv0:c,conv1:d,conv2:h,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function SU(e){var t=[],n=X6(e,t).extractDenseBlock4Params,a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Mo(e,t),{params:a,paramMappings:t}}var J6=function(e){Ct(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("FaceFeatureExtractor - load model before inference");return st(function(){var r=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Up(r,i).div(at(255)),o=ug(s,a.dense0,!0);return o=ug(o,a.dense1),o=ug(o,a.dense2),o=ug(o,a.dense3),o=Bp(o,[7,7],[2,2],"valid"),o})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return SU(n)},t.prototype.extractParams=function(n){return kU(n)},t}(Ro);function Ps(e,t){return st(function(){return Ot(Uv(e,t.weights),t.bias)})}function _U(e,t,n){var a=[],r=Oo(e),i=r.extractWeights,s=r.getRemainingWeights,o=k5(i,a),u=o(t,n,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:a,params:{fc:u}}}function jU(e){var t=[],n=Jl(e,t);function a(i){var s=n(i+"/weights",2),o=n(i+"/bias",1);return{weights:s,bias:o}}var r={fc:a("fc")};return Mo(e,t),{params:r,paramMappings:t}}function Q6(e){var t={},n={};return Object.keys(e).forEach(function(a){var r=a.startsWith("fc")?n:t;r[a]=e[a]}),{featureExtractorMap:t,classifierMap:n}}var Z6=function(e){Ct(t,e);function t(n,a){var r=e.call(this,n)||this;return r._faceFeatureExtractor=a,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var a=this,r=this.params;if(!r)throw new Error(this._name+" - load model before inference");return st(function(){var i=n instanceof $0?a.faceFeatureExtractor.forwardInput(n):n;return Ps(i.as2D(i.shape[0],-1),r.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var a=this.extractClassifierParams(n),r=a.params,i=a.paramMappings;this._params=r,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return _U(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var a=Q6(n),r=a.featureExtractorMap,i=a.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r),jU(i)},t.prototype.extractParams=function(n){var a=this.getClassifierChannelsIn(),r=this.getClassifierChannelsOut(),i=r*a+r,s=n.slice(0,n.length-i),o=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(o)},t}(Ro),hk=["neutral","happy","sad","angry","fearful","disgusted","surprised"],CU=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);hk.forEach(function(a,r){n[a]=t[r]})}return e.prototype.asSortedArray=function(){var t=this;return hk.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,a){return a.probability-n.probability})},e}(),AU=function(e){Ct(t,e);function t(n){return n===void 0&&(n=new J6),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var a=this;return st(function(){return Lo(a.runNet(n))})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.predictExpressions=function(n){return ft(this,void 0,void 0,function(){var a,r,i,s,o=this;return pt(this,function(u){switch(u.label){case 0:return[4,Ba(n)];case 1:return a=u.sent(),[4,this.forwardInput(a)];case 2:return r=u.sent(),[4,Promise.all(ka(r).map(function(c){return ft(o,void 0,void 0,function(){var d;return pt(this,function(h){switch(h.label){case 0:return[4,c.data()];case 1:return d=h.sent(),c.dispose(),[2,d]}})})}))];case 3:return i=u.sent(),r.dispose(),s=i.map(function(c){return new CU(c)}),[2,a.isBatchInput?s:s[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Z6);function eE(e,t){var n={expressions:t};return Object.assign({},e,n)}function tE(e){return F6(e)&&e.landmarks instanceof ap&&e.unshiftedLandmarks instanceof ap&&e.alignedRect instanceof hs}function Yv(e,t){var n=e.detection.box,a=t.shiftBy(n.x,n.y),r=a.align(),i=e.detection.imageDims,s=new hs(e.detection.score,r.rescale(i.reverse()),i),o={landmarks:a,unshiftedLandmarks:t,alignedRect:s};return Object.assign({},e,o)}function EU(e,t){var n=Kv(e,t),a=S5(e,t);function r(s,o,u){var c=a(s,o,u+"/separable_conv0"),d=a(o,o,u+"/separable_conv1"),h=n(s,o,1,u+"/expansion_conv");return{separable_conv0:c,separable_conv1:d,expansion_conv:h}}function i(s,o){var u=a(s,s,o+"/separable_conv0"),c=a(s,s,o+"/separable_conv1"),d=a(s,s,o+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:r,extractMainBlockParams:i}}function DU(e,t){var n=[],a=Oo(e),r=a.extractWeights,i=a.getRemainingWeights,s=EU(r,n),o=s.extractConvParams,u=s.extractSeparableConvParams,c=s.extractReductionBlockParams,d=s.extractMainBlockParams,h=o(3,32,3,"entry_flow/conv_in"),p=c(32,64,"entry_flow/reduction_block_0"),f=c(64,128,"entry_flow/reduction_block_1"),g={conv_in:h,reduction_block_0:p,reduction_block_1:f},b={};tp(t,0,1).forEach(function(y){b["main_block_"+y]=d(128,"middle_flow/main_block_"+y)});var w=c(128,256,"exit_flow/reduction_block"),m=u(256,512,"exit_flow/separable_conv"),x={reduction_block:w,separable_conv:m};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:g,middle_flow:b,exit_flow:x}}}function TU(e,t){var n=Jl(e,t),a=Y6(n),r=_5(n);function i(o){var u=r(o+"/separable_conv0"),c=r(o+"/separable_conv1"),d=a(o+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:d}}function s(o){var u=r(o+"/separable_conv0"),c=r(o+"/separable_conv1"),d=r(o+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:d}}return{extractConvParams:a,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:s}}function LU(e,t){var n=[],a=TU(e,n),r=a.extractConvParams,i=a.extractSeparableConvParams,s=a.extractReductionBlockParams,o=a.extractMainBlockParams,u=r("entry_flow/conv_in"),c=s("entry_flow/reduction_block_0"),d=s("entry_flow/reduction_block_1"),h={conv_in:u,reduction_block_0:c,reduction_block_1:d},p={};tp(t,0,1).forEach(function(w){p["main_block_"+w]=o("middle_flow/main_block_"+w)});var f=s("exit_flow/reduction_block"),g=i("exit_flow/separable_conv"),b={reduction_block:f,separable_conv:g};return Mo(e,n),{params:{entry_flow:h,middle_flow:p,exit_flow:b},paramMappings:n}}function nE(e,t,n){return Ot($i(e,t.filters,n,"same"),t.bias)}function u1(e,t,n){n===void 0&&(n=!0);var a=n?Un(e):e;return a=ui(a,t.separable_conv0,[1,1]),a=ui(Un(a),t.separable_conv1,[1,1]),a=La(a,[3,3],[2,2],"same"),a=Ot(a,nE(e,t.expansion_conv,[2,2])),a}function PU(e,t){var n=ui(Un(e),t.separable_conv0,[1,1]);return n=ui(Un(n),t.separable_conv1,[1,1]),n=ui(Un(n),t.separable_conv2,[1,1]),n=Ot(n,e),n}var RU=function(e){Ct(t,e);function t(n){var a=e.call(this,"TinyXception")||this;return a._numMainBlocks=n,a}return t.prototype.forwardInput=function(n){var a=this,r=this.params;if(!r)throw new Error("TinyXception - load model before inference");return st(function(){var i=n.toBatchTensor(112,!0),s=[122.782,117.001,104.298],o=Up(i,s).div(at(256)),u=Un(nE(o,r.entry_flow.conv_in,[2,2]));return u=u1(u,r.entry_flow.reduction_block_0,!1),u=u1(u,r.entry_flow.reduction_block_1),tp(a._numMainBlocks,0,1).forEach(function(c){u=PU(u,r.middle_flow["main_block_"+c])}),u=u1(u,r.exit_flow.reduction_block),u=Un(ui(u,r.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return LU(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return DU(n,this._numMainBlocks)},t}(Ro);function MU(e){var t=[],n=Oo(e),a=n.extractWeights,r=n.getRemainingWeights,i=k5(a,t),s=i(512,1,"fc/age"),o=i(512,2,"fc/gender");if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:t,params:{fc:{age:s,gender:o}}}}function OU(e){var t=[],n=Jl(e,t);function a(i){var s=n(i+"/weights",2),o=n(i+"/bias",1);return{weights:s,bias:o}}var r={fc:{age:a("fc/age"),gender:a("fc/gender")}};return Mo(e,t),{params:r,paramMappings:t}}var K0;(function(e){e.FEMALE="female",e.MALE="male"})(K0||(K0={}));var IU=function(e){Ct(t,e);function t(n){n===void 0&&(n=new RU(2));var a=e.call(this,"AgeGenderNet")||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var a=this,r=this.params;if(!r)throw new Error(this._name+" - load model before inference");return st(function(){var i=n instanceof $0?a.faceFeatureExtractor.forwardInput(n):n,s=Bp(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),o=Ps(s,r.fc.age).as1D(),u=Ps(s,r.fc.gender);return{age:o,gender:u}})},t.prototype.forwardInput=function(n){var a=this;return st(function(){var r=a.runNet(n),i=r.age,s=r.gender;return{age:i,gender:Lo(s)}})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return ft(this,void 0,void 0,function(){var a,r,i,s,o,u,c=this;return pt(this,function(d){switch(d.label){case 0:return[4,Ba(n)];case 1:return a=d.sent(),[4,this.forwardInput(a)];case 2:return r=d.sent(),i=ka(r.age),s=ka(r.gender),o=i.map(function(h,p){return{ageTensor:h,genderTensor:s[p]}}),[4,Promise.all(o.map(function(h){var p=h.ageTensor,f=h.genderTensor;return ft(c,void 0,void 0,function(){var g,b,w,m,x;return pt(this,function(y){switch(y.label){case 0:return[4,p.data()];case 1:return g=y.sent()[0],[4,f.data()];case 2:return b=y.sent()[0],w=b>.5,m=w?K0.MALE:K0.FEMALE,x=w?b:1-b,p.dispose(),f.dispose(),[2,{age:g,gender:m,genderProbability:x}]}})})}))];case 3:return u=d.sent(),r.age.dispose(),r.gender.dispose(),[2,a.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var a=this.extractClassifierParams(n),r=a.params,i=a.paramMappings;this._params=r,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return MU(n)},t.prototype.extractParamsFromWeigthMap=function(n){var a=Q6(n),r=a.featureExtractorMap,i=a.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r),OU(i)},t.prototype.extractParams=function(n){var a=1539,r=n.slice(0,n.length-a),i=n.slice(n.length-a);return this.faceFeatureExtractor.extractWeights(r),this.extractClassifierParams(i)},t}(Ro),aE=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,a,r){var i=r.map(function(o){var u=o.width,c=o.height,d=a/Math.max(c,u);return{width:u*d,height:c*d}}),s=i.length;return st(function(){var o=function(p,f){return gi([zs([68],p),zs([68],f)],1).as2D(1,136).as1D()},u=function(p,f){var g=i[p],b=g.width,w=g.height;return f(b,w)?Math.abs(b-w)/2:0},c=function(p){return u(p,function(f,g){return f<g})},d=function(p){return u(p,function(f,g){return g<f})},h=n.mul(zs([s,136],a)).sub(gi(Array.from(Array(s),function(p,f){return o(c(f),d(f))}))).div(gi(Array.from(Array(s),function(p,f){return o(i[f].width,i[f].height)})));return h})},t.prototype.forwardInput=function(n){var a=this;return st(function(){var r=a.runNet(n);return a.postProcess(r,n.inputSize,n.inputDimensions.map(function(i){var s=i[0],o=i[1];return{height:s,width:o}}))})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.detectLandmarks=function(n){return ft(this,void 0,void 0,function(){var a,r,i,s=this;return pt(this,function(o){switch(o.label){case 0:return[4,Ba(n)];case 1:return a=o.sent(),r=st(function(){return ka(s.forwardInput(a))}),[4,Promise.all(r.map(function(u,c){return ft(s,void 0,void 0,function(){var d,h,p,f,g;return pt(this,function(b){switch(b.label){case 0:return p=(h=Array).from,[4,u.data()];case 1:return d=p.apply(h,[b.sent()]),f=d.filter(function(w,m){return ik(m)}),g=d.filter(function(w,m){return!ik(m)}),[2,new fU(Array(68).fill(0).map(function(w,m){return new an(f[m],g[m])}),{height:a.getInputHeight(c),width:a.getInputWidth(c)})]}})})}))];case 2:return i=o.sent(),r.forEach(function(u){return u.dispose()}),[2,a.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Z6),rE=function(e){Ct(t,e);function t(n){return n===void 0&&(n=new J6),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(aE);function FU(e){var t=[],n=X6(e,t).extractDenseBlock3Params,a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Mo(e,t),{params:a,paramMappings:t}}function BU(e){var t=[],n=Oo(e),a=n.extractWeights,r=n.getRemainingWeights,i=K6(a,t).extractDenseBlock3Params,s=i(3,32,"dense0",!0),o=i(32,64,"dense1"),u=i(64,128,"dense2");if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:t,params:{dense0:s,dense1:o,dense2:u}}}var zU=function(e){Ct(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("TinyFaceFeatureExtractor - load model before inference");return st(function(){var r=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Up(r,i).div(at(255)),o=l1(s,a.dense0,!0);return o=l1(o,a.dense1),o=l1(o,a.dense2),o=Bp(o,[14,14],[2,2],"valid"),o})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return FU(n)},t.prototype.extractParams=function(n){return BU(n)},t}(Ro),UU=function(e){Ct(t,e);function t(n){return n===void 0&&(n=new zU),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(aE);(function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(rE);function qU(e,t){return Ot(cr(e,t.weights),t.biases)}function j5(e,t,n,a,r){r===void 0&&(r="same");var i=t.conv,s=i.filters,o=i.bias,u=$i(e,s,n,r);return u=Ot(u,o),u=qU(u,t.scale),a?Un(u):u}function WU(e,t){return j5(e,t,[1,1],!0)}function iE(e,t){return j5(e,t,[1,1],!1)}function sE(e,t){return j5(e,t,[2,2],!0,"valid")}function HU(e,t){function n(o,u,c){var d=e(o),h=d.length/(u*c*c);if(aU(h))throw new Error("depth has to be an integer: "+h+", weights.length: "+d.length+", numFilters: "+u+", filterSize: "+c);return st(function(){return Wl(Or(d,[u,h,c,c]),[2,3,1,0])})}function a(o,u,c,d){var h=n(o,u,c),p=ha(e(u));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:h,bias:p}}function r(o,u){var c=ha(e(o)),d=ha(e(o));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:d}}function i(o,u,c,d){var h=a(o,u,c,d+"/conv"),p=r(u,d+"/scale");return{conv:h,scale:p}}function s(o,u,c,d,h){h===void 0&&(h=!1);var p=i((h?.5:1)*o,u,c,d+"/conv1"),f=i(o,u,c,d+"/conv2");return{conv1:p,conv2:f}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function VU(e){var t=Oo(e),n=t.extractWeights,a=t.getRemainingWeights,r=[],i=HU(n,r),s=i.extractConvLayerParams,o=i.extractResidualLayerParams,u=s(4704,32,7,"conv32_down"),c=o(9216,32,3,"conv32_1"),d=o(9216,32,3,"conv32_2"),h=o(9216,32,3,"conv32_3"),p=o(36864,64,3,"conv64_down",!0),f=o(36864,64,3,"conv64_1"),g=o(36864,64,3,"conv64_2"),b=o(36864,64,3,"conv64_3"),w=o(147456,128,3,"conv128_down",!0),m=o(147456,128,3,"conv128_1"),x=o(147456,128,3,"conv128_2"),y=o(589824,256,3,"conv256_down",!0),N=o(589824,256,3,"conv256_1"),S=o(589824,256,3,"conv256_2"),D=o(589824,256,3,"conv256_down_out"),_=st(function(){return Wl(Rl(n(256*128),[128,256]),[1,0])});if(r.push({paramPath:"fc"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);var A={conv32_down:u,conv32_1:c,conv32_2:d,conv32_3:h,conv64_down:p,conv64_1:f,conv64_2:g,conv64_3:b,conv128_down:w,conv128_1:m,conv128_2:x,conv256_down:y,conv256_1:N,conv256_2:S,conv256_down_out:D,fc:_};return{params:A,paramMappings:r}}function GU(e,t){var n=Jl(e,t);function a(s){var o=n(s+"/scale/weights",1),u=n(s+"/scale/biases",1);return{weights:o,biases:u}}function r(s){var o=n(s+"/conv/filters",4),u=n(s+"/conv/bias",1),c=a(s);return{conv:{filters:o,bias:u},scale:c}}function i(s){return{conv1:r(s+"/conv1"),conv2:r(s+"/conv2")}}return{extractConvLayerParams:r,extractResidualLayerParams:i}}function $U(e){var t=[],n=GU(e,t),a=n.extractConvLayerParams,r=n.extractResidualLayerParams,i=a("conv32_down"),s=r("conv32_1"),o=r("conv32_2"),u=r("conv32_3"),c=r("conv64_down"),d=r("conv64_1"),h=r("conv64_2"),p=r("conv64_3"),f=r("conv128_down"),g=r("conv128_1"),b=r("conv128_2"),w=r("conv256_down"),m=r("conv256_1"),x=r("conv256_2"),y=r("conv256_down_out"),N=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!nU(N))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+N);var S={conv32_down:i,conv32_1:s,conv32_2:o,conv32_3:u,conv64_down:c,conv64_1:d,conv64_2:h,conv64_3:p,conv128_down:f,conv128_1:g,conv128_2:b,conv256_down:w,conv256_1:m,conv256_2:x,conv256_down_out:y,fc:N};return Mo(e,t),{params:S,paramMappings:t}}function ws(e,t){var n=WU(e,t.conv1);return n=iE(n,t.conv2),n=Ot(n,e),n=Un(n),n}function cg(e,t){var n=sE(e,t.conv1);n=iE(n,t.conv2);var a=Bp(e,2,2,"valid"),r=An(a.shape),i=a.shape[3]!==n.shape[3],s=a.shape[1]!==n.shape[1]||a.shape[2]!==n.shape[2];if(s){var o=Af(n.shape);o[1]=1;var u=An(o);n=Na([n,u],1);var c=Af(n.shape);c[2]=1;var d=An(c);n=Na([n,d],2)}return a=i?Na([a,r],3):a,n=Ot(a,n),n=Un(n),n}var KU=function(e){Ct(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("FaceRecognitionNet - load model before inference");return st(function(){var r=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],s=Up(r,i).div(at(256)),o=sE(s,a.conv32_down);o=La(o,3,2,"valid"),o=ws(o,a.conv32_1),o=ws(o,a.conv32_2),o=ws(o,a.conv32_3),o=cg(o,a.conv64_down),o=ws(o,a.conv64_1),o=ws(o,a.conv64_2),o=ws(o,a.conv64_3),o=cg(o,a.conv128_down),o=ws(o,a.conv128_1),o=ws(o,a.conv128_2),o=cg(o,a.conv256_down),o=ws(o,a.conv256_1),o=ws(o,a.conv256_2),o=cg(o,a.conv256_down_out);var u=o.mean([1,2]),c=Uv(u,a.fc);return c})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return ft(this,void 0,void 0,function(){var a,r,i,s=this;return pt(this,function(o){switch(o.label){case 0:return[4,Ba(n)];case 1:return a=o.sent(),r=st(function(){return ka(s.forwardInput(a))}),[4,Promise.all(r.map(function(u){return u.data()}))];case 2:return i=o.sent(),r.forEach(function(u){return u.dispose()}),[2,a.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return $U(n)},t.prototype.extractParams=function(n){return VU(n)},t}(Ro);function oE(e,t){var n={descriptor:t};return Object.assign({},e,n)}function lE(e,t){var n={age:t};return Object.assign({},e,n)}function uE(e,t,n){var a={gender:t,genderProbability:n};return Object.assign({},e,a)}var cE=function(){function e(t){var n=t===void 0?{}:t,a=n.minFaceSize,r=n.scaleFactor,i=n.maxNumScales,s=n.scoreThresholds,o=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=a||20,this._scaleFactor=r||.709,this._maxNumScales=i||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=o,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function YU(e,t){function n(u,c){var d=Or(e(9*u),[3,3,u,1]),h=ha(e(u)),p=ha(e(u)),f=ha(e(u)),g=ha(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:d,batch_norm_scale:h,batch_norm_offset:p,batch_norm_mean:f,batch_norm_variance:g}}function a(u,c,d,h,p){var f=Or(e(u*c*d*d),[d,d,u,c]),g=ha(e(c));return t.push({paramPath:h+"/filters"},{paramPath:h+"/"+(p?"batch_norm_offset":"bias")}),{filters:f,bias:g}}function r(u,c,d,h){var p=a(u,c,d,h,!0),f=p.filters,g=p.bias;return{filters:f,batch_norm_offset:g}}function i(u,c,d){var h=n(u,d+"/depthwise_conv"),p=r(u,c,1,d+"/pointwise_conv");return{depthwise_conv:h,pointwise_conv:p}}function s(){var u=r(3,32,3,"mobilenetv1/conv_0"),c=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),h=i(128,128,"mobilenetv1/conv_3"),p=i(128,256,"mobilenetv1/conv_4"),f=i(256,256,"mobilenetv1/conv_5"),g=i(256,512,"mobilenetv1/conv_6"),b=i(512,512,"mobilenetv1/conv_7"),w=i(512,512,"mobilenetv1/conv_8"),m=i(512,512,"mobilenetv1/conv_9"),x=i(512,512,"mobilenetv1/conv_10"),y=i(512,512,"mobilenetv1/conv_11"),N=i(512,1024,"mobilenetv1/conv_12"),S=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:c,conv_2:d,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:b,conv_8:w,conv_9:m,conv_10:x,conv_11:y,conv_12:N,conv_13:S}}function o(){var u=r(1024,256,1,"prediction_layer/conv_0"),c=r(256,512,3,"prediction_layer/conv_1"),d=r(512,128,1,"prediction_layer/conv_2"),h=r(128,256,3,"prediction_layer/conv_3"),p=r(256,128,1,"prediction_layer/conv_4"),f=r(128,256,3,"prediction_layer/conv_5"),g=r(256,64,1,"prediction_layer/conv_6"),b=r(64,128,3,"prediction_layer/conv_7"),w=a(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=a(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),x=a(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),y=a(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),N=a(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),S=a(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),D=a(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),_=a(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),A=a(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),L=a(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),P=a(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),j=a(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),E={box_encoding_predictor:w,class_predictor:m},F={box_encoding_predictor:x,class_predictor:y},z={box_encoding_predictor:N,class_predictor:S},U={box_encoding_predictor:D,class_predictor:_},O={box_encoding_predictor:A,class_predictor:L},B={box_encoding_predictor:P,class_predictor:j};return{conv_0:u,conv_1:c,conv_2:d,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:b,box_predictor_0:E,box_predictor_1:F,box_predictor_2:z,box_predictor_3:U,box_predictor_4:O,box_predictor_5:B}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:o}}function XU(e){var t=[],n=Oo(e),a=n.extractWeights,r=n.getRemainingWeights,i=YU(a,t),s=i.extractMobilenetV1Params,o=i.extractPredictionLayerParams,u=s(),c=o(),d=Ww(a(5118*4),[1,5118,4]),h={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:h},paramMappings:t}}function JU(e,t){var n=Jl(e,t);function a(c,d,h){var p=n(c+"/Conv2d_"+d+"_pointwise/weights",4,h+"/filters"),f=n(c+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,h+"/batch_norm_offset");return{filters:p,batch_norm_offset:f}}function r(c){var d="mobilenetv1/conv_"+c,h="MobilenetV1/Conv2d_"+c+"_depthwise",p=d+"/depthwise_conv",f=d+"/pointwise_conv",g=n(h+"/depthwise_weights",4,p+"/filters"),b=n(h+"/BatchNorm/gamma",1,p+"/batch_norm_scale"),w=n(h+"/BatchNorm/beta",1,p+"/batch_norm_offset"),m=n(h+"/BatchNorm/moving_mean",1,p+"/batch_norm_mean"),x=n(h+"/BatchNorm/moving_variance",1,p+"/batch_norm_variance");return{depthwise_conv:{filters:g,batch_norm_scale:b,batch_norm_offset:w,batch_norm_mean:m,batch_norm_variance:x},pointwise_conv:a("MobilenetV1",c,f)}}function i(){return{conv_0:a("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:r(1),conv_2:r(2),conv_3:r(3),conv_4:r(4),conv_5:r(5),conv_6:r(6),conv_7:r(7),conv_8:r(8),conv_9:r(9),conv_10:r(10),conv_11:r(11),conv_12:r(12),conv_13:r(13)}}function s(c,d){var h=n(c+"/weights",4,d+"/filters"),p=n(c+"/biases",1,d+"/bias");return{filters:h,bias:p}}function o(c){var d=s("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),h=s("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor");return{box_encoding_predictor:d,class_predictor:h}}function u(){return{conv_0:a("Prediction",0,"prediction_layer/conv_0"),conv_1:a("Prediction",1,"prediction_layer/conv_1"),conv_2:a("Prediction",2,"prediction_layer/conv_2"),conv_3:a("Prediction",3,"prediction_layer/conv_3"),conv_4:a("Prediction",4,"prediction_layer/conv_4"),conv_5:a("Prediction",5,"prediction_layer/conv_5"),conv_6:a("Prediction",6,"prediction_layer/conv_6"),conv_7:a("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function QU(e){var t=[],n=JU(e,t),a=n.extractMobilenetV1Params,r=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Vv(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var s={mobilenetv1:a(),prediction_layer:r(),output_layer:{extra_dim:i}};return Mo(e,t),{params:s,paramMappings:t}}function Ss(e,t,n){return st(function(){var a=$i(e,t.filters,n,"same");return a=Ot(a,t.batch_norm_offset),e5(a,0,6)})}var ZU=.0010000000474974513;function eq(e,t,n){return st(function(){var a=zv(e,t.filters,n,"same");return a=a6(a,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,ZU),e5(a,0,6)})}function tq(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function nq(e,t){return st(function(){var n=null,a=Ss(e,t.conv_0,[2,2]),r=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(r.forEach(function(i,s){var o=s+1,u=tq(o);a=eq(a,i.depthwise_conv,u),a=Ss(a,i.pointwise_conv,[1,1]),o===11&&(n=a)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:a,conv11:n}})}function aq(e,t,n,a,r){var i=e.shape[0],s=Math.min(n,i),o=t.map(function(d,h){return{score:d,boxIndex:h}}).filter(function(d){return d.score>r}).sort(function(d,h){return h.score-d.score}),u=function(d){return d<=a?1:0},c=[];return o.forEach(function(d){if(!(c.length>=s)){for(var h=d.score,p=c.length-1;p>=0;--p){var f=rq(e,d.boxIndex,c[p]);if(f!==0&&(d.score*=u(f),d.score<=r))break}h===d.score&&c.push(d.boxIndex)}}),c}function rq(e,t,n){var a=e.arraySync(),r=Math.min(a[t][0],a[t][2]),i=Math.min(a[t][1],a[t][3]),s=Math.max(a[t][0],a[t][2]),o=Math.max(a[t][1],a[t][3]),u=Math.min(a[n][0],a[n][2]),c=Math.min(a[n][1],a[n][3]),d=Math.max(a[n][0],a[n][2]),h=Math.max(a[n][1],a[n][3]),p=(s-r)*(o-i),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;var g=Math.max(r,u),b=Math.max(i,c),w=Math.min(s,d),m=Math.min(o,h),x=Math.max(w-g,0)*Math.max(m-b,0);return x/(p+f-x)}function iq(e){var t=ka(Wl(e,[1,0])),n=[ja(t[2],t[0]),ja(t[3],t[1])],a=[Ot(t[0],rs(n[0],at(2))),Ot(t[1],rs(n[1],at(2)))];return{sizes:n,centers:a}}function sq(e,t){var n=iq(e),a=n.sizes,r=n.centers,i=ka(Wl(t,[1,0])),s=rs(cr(Hy(rs(i[2],at(5))),a[0]),at(2)),o=Ot(cr(rs(i[0],at(10)),a[0]),r[0]),u=rs(cr(Hy(rs(i[3],at(5))),a[1]),at(2)),c=Ot(cr(rs(i[1],at(10)),a[1]),r[1]);return Wl(gi([ja(o,s),ja(c,u),Ot(o,s),Ot(c,u)]),[1,0])}function oq(e,t,n){return st(function(){var a=e.shape[0],r=sq(is(_d(n.extra_dim,[a,1,1]),[-1,4]),is(e,[-1,4]));r=is(r,[a,r.shape[0]/a,4]);var i=ZA(Ws(t,[0,0,1],[-1,-1,-1])),s=Ws(i,[0,0,0],[-1,-1,1]);s=is(s,[a,s.shape[1]]);var o=ka(r),u=ka(s);return{boxes:o,scores:u}})}function zc(e,t){return st(function(){var n=e.shape[0],a=is(os(e,t.box_encoding_predictor),[n,-1,1,4]),r=is(os(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:a,classPrediction:r}})}function lq(e,t,n){return st(function(){var a=Ss(e,n.conv_0,[1,1]),r=Ss(a,n.conv_1,[2,2]),i=Ss(r,n.conv_2,[1,1]),s=Ss(i,n.conv_3,[2,2]),o=Ss(s,n.conv_4,[1,1]),u=Ss(o,n.conv_5,[2,2]),c=Ss(u,n.conv_6,[1,1]),d=Ss(c,n.conv_7,[2,2]),h=zc(t,n.box_predictor_0),p=zc(e,n.box_predictor_1),f=zc(r,n.box_predictor_2),g=zc(s,n.box_predictor_3),b=zc(u,n.box_predictor_4),w=zc(d,n.box_predictor_5),m=Na([h.boxPredictionEncoding,p.boxPredictionEncoding,f.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,w.boxPredictionEncoding],1),x=Na([h.classPrediction,p.classPrediction,f.classPrediction,g.classPrediction,b.classPrediction,w.classPrediction],1);return{boxPredictions:m,classPredictions:x}})}var Xv=function(){function e(t){var n=t===void 0?{}:t,a=n.minConfidence,r=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=a||.5,this._maxResults=r||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),dE=function(e){Ct(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var a=this.params;if(!a)throw new Error("SsdMobilenetv1 - load model before inference");return st(function(){var r=n.toBatchTensor(512,!1).toFloat(),i=ja(cr(r,at(.007843137718737125)),at(1)),s=nq(i,a.mobilenetv1),o=lq(s.out,s.conv11,a.prediction_layer),u=o.boxPredictions,c=o.classPredictions;return oq(u,c,a.output_layer)})},t.prototype.forward=function(n){return ft(this,void 0,void 0,function(){var a;return pt(this,function(r){switch(r.label){case 0:return a=this.forwardInput,[4,Ba(n)];case 1:return[2,a.apply(this,[r.sent()])]}})})},t.prototype.locateFaces=function(n,a){return a===void 0&&(a={}),ft(this,void 0,void 0,function(){var r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,D,_,A;return pt(this,function(L){switch(L.label){case 0:return r=new Xv(a),i=r.maxResults,s=r.minConfidence,[4,Ba(n)];case 1:for(o=L.sent(),u=this.forwardInput(o),c=u.boxes,d=u.scores,h=c[0],p=d[0],f=1;f<c.length;f++)c[f].dispose(),d[f].dispose();return w=(b=Array).from,[4,p.data()];case 2:return g=w.apply(b,[L.sent()]),m=.5,x=aq(h,g,i,m,s),y=o.getReshapedInputDimensions(0),N=o.inputSize,S=N/y.width,D=N/y.height,_=h.arraySync(),A=x.map(function(P){var j=[Math.max(0,_[P][0]),Math.min(1,_[P][2])].map(function(B){return B*D}),E=j[0],F=j[1],z=[Math.max(0,_[P][1]),Math.min(1,_[P][3])].map(function(B){return B*S}),U=z[0],O=z[1];return new hs(g[P],new v5(U,E,O-U,F-E),{height:o.getInputHeight(0),width:o.getInputWidth(0)})}),h.dispose(),p.dispose(),[2,A]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return QU(n)},t.prototype.extractParams=function(n){return XU(n)},t}(Ro);(function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(dE);var uq=.4,cq=[new an(.738768,.874946),new an(2.42204,2.65704),new an(4.30971,7.04493),new an(10.246,4.59428),new an(12.6868,11.8741)],dq=[new an(1.603231,2.094468),new an(6.041143,7.080126),new an(2.882459,3.518061),new an(4.266906,5.178857),new an(9.041765,10.66308)],hq=[117.001,114.697,97.404],fq="tiny_yolov2_model",pq="tiny_yolov2_separable_conv_model",dg=function(e){return typeof e=="number"};function mq(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!dg(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return dg(t.x)&&dg(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(dg)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function C5(e){return st(function(){var t=cr(e,at(.10000000149011612));return Ot(Un(ja(e,t)),t)})}function nl(e,t){return st(function(){var n=ac(e,[[0,0],[1,1],[1,1],[0,0]]);return n=$i(n,t.conv.filters,[1,1],"valid"),n=ja(n,t.bn.sub),n=cr(n,t.bn.truediv),n=Ot(n,t.conv.bias),C5(n)})}function al(e,t){return st(function(){var n=ac(e,[[0,0],[1,1],[1,1],[0,0]]);return n=r5(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ot(n,t.bias),C5(n)})}function gq(e,t){var n=Kv(e,t);function a(s,o){var u=ha(e(s)),c=ha(e(s));return t.push({paramPath:o+"/sub"},{paramPath:o+"/truediv"}),{sub:u,truediv:c}}function r(s,o,u){var c=n(s,o,3,u+"/conv"),d=a(o,u+"/bn");return{conv:c,bn:d}}var i=S5(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:r,extractSeparableConvParams:i}}function vq(e,t,n,a){var r=Oo(e),i=r.extractWeights,s=r.getRemainingWeights,o=[],u=gq(i,o),c=u.extractConvParams,d=u.extractConvWithBatchNormParams,h=u.extractSeparableConvParams,p;if(t.withSeparableConvs){var f=a[0],g=a[1],b=a[2],w=a[3],m=a[4],x=a[5],y=a[6],N=a[7],S=a[8],D=t.isFirstLayerConv2d?c(f,g,3,"conv0"):h(f,g,"conv0"),_=h(g,b,"conv1"),A=h(b,w,"conv2"),L=h(w,m,"conv3"),P=h(m,x,"conv4"),j=h(x,y,"conv5"),E=N?h(y,N,"conv6"):void 0,F=S?h(N,S,"conv7"):void 0,z=c(S||N||y,5*n,1,"conv8");p={conv0:D,conv1:_,conv2:A,conv3:L,conv4:P,conv5:j,conv6:E,conv7:F,conv8:z}}else{var f=a[0],g=a[1],b=a[2],w=a[3],m=a[4],x=a[5],y=a[6],N=a[7],S=a[8],D=d(f,g,"conv0"),_=d(g,b,"conv1"),A=d(b,w,"conv2"),L=d(w,m,"conv3"),P=d(m,x,"conv4"),j=d(x,y,"conv5"),E=d(y,N,"conv6"),F=d(N,S,"conv7"),z=c(S,5*n,1,"conv8");p={conv0:D,conv1:_,conv2:A,conv3:L,conv4:P,conv5:j,conv6:E,conv7:F,conv8:z}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:p,paramMappings:o}}function xq(e,t){var n=Jl(e,t);function a(o){var u=n(o+"/sub",1),c=n(o+"/truediv",1);return{sub:u,truediv:c}}function r(o){var u=n(o+"/filters",4),c=n(o+"/bias",1);return{filters:u,bias:c}}function i(o){var u=r(o+"/conv"),c=a(o+"/bn");return{conv:u,bn:c}}var s=_5(n);return{extractConvParams:r,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function bq(e,t){var n=[],a=xq(e,n),r=a.extractConvParams,i=a.extractConvWithBatchNormParams,s=a.extractSeparableConvParams,o;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;o={conv0:t.isFirstLayerConv2d?r("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:r("conv8")}}else o={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:r("conv8")};return Mo(e,n),{params:o,paramMappings:n}}var fk;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(fk||(fk={}));var A5=function(){function e(t){var n=t===void 0?{}:t,a=n.inputSize,r=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=a||416,this._scoreThreshold=r||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),hE=function(e){Ct(t,e);function t(n){var a=e.call(this,"TinyYolov2")||this;return mq(n),a._config=n,a}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,a){var r=nl(n,a.conv0);return r=La(r,[2,2],[2,2],"same"),r=nl(r,a.conv1),r=La(r,[2,2],[2,2],"same"),r=nl(r,a.conv2),r=La(r,[2,2],[2,2],"same"),r=nl(r,a.conv3),r=La(r,[2,2],[2,2],"same"),r=nl(r,a.conv4),r=La(r,[2,2],[2,2],"same"),r=nl(r,a.conv5),r=La(r,[2,2],[1,1],"same"),r=nl(r,a.conv6),r=nl(r,a.conv7),os(r,a.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,a){var r=this.config.isFirstLayerConv2d?C5(os(n,a.conv0,"valid",!1)):al(n,a.conv0);return r=La(r,[2,2],[2,2],"same"),r=al(r,a.conv1),r=La(r,[2,2],[2,2],"same"),r=al(r,a.conv2),r=La(r,[2,2],[2,2],"same"),r=al(r,a.conv3),r=La(r,[2,2],[2,2],"same"),r=al(r,a.conv4),r=La(r,[2,2],[2,2],"same"),r=al(r,a.conv5),r=La(r,[2,2],[1,1],"same"),r=a.conv6?al(r,a.conv6):r,r=a.conv7?al(r,a.conv7):r,os(r,a.conv8,"valid",!1)},t.prototype.forwardInput=function(n,a){var r=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return st(function(){var s=n.toBatchTensor(a,!1).toFloat();return s=r.config.meanRgb?Up(s,r.config.meanRgb):s,s=s.div(at(256)),r.config.withSeparableConvs?r.runMobilenet(s,i):r.runTinyYolov2(s,i)})},t.prototype.forward=function(n,a){return ft(this,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ba(n)];case 1:return[4,r.apply(this,[i.sent(),a])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,a){return a===void 0&&(a={}),ft(this,void 0,void 0,function(){var r,i,s,o,u,c,d,h,p,f,g,b,w,m,x=this;return pt(this,function(y){switch(y.label){case 0:return r=new A5(a),i=r.inputSize,s=r.scoreThreshold,[4,Ba(n)];case 1:return o=y.sent(),[4,this.forwardInput(o,i)];case 2:return u=y.sent(),c=st(function(){return ka(u)[0].expandDims()}),d={width:o.getInputWidth(0),height:o.getInputHeight(0)},[4,this.extractBoxes(c,o.getReshapedInputDimensions(0),s)];case 3:return h=y.sent(),u.dispose(),c.dispose(),p=h.map(function(N){return N.box}),f=h.map(function(N){return N.score}),g=h.map(function(N){return N.classScore}),b=h.map(function(N){return x.config.classes[N.label]}),w=np(p.map(function(N){return N.rescale(i)}),f,this.config.iouThreshold,!0),m=w.map(function(N){return new I6(f[N],g[N],b[N],p[N],d)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return bq(n,this.config)},t.prototype.extractParams=function(n){var a=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=a?a.length:void 0;if(r!==7&&r!==8&&r!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return vq(n,this.config,this.boxEncodingSize,a)},t.prototype.extractBoxes=function(n,a,r){return ft(this,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,D,_,A,L,P,j,E,F,z,U,O,B,q=this;return pt(this,function(I){switch(I.label){case 0:return i=a.width,s=a.height,o=Math.max(i,s),u=o/i,c=o/s,d=n.shape[1],h=this.config.anchors.length,p=st(function(){var K=n.reshape([d,d,h,q.boxEncodingSize]),Z=K.slice([0,0,0,0],[d,d,h,4]),R=K.slice([0,0,0,4],[d,d,h,1]),H=q.withClassScores?Lo(K.slice([0,0,0,5],[d,d,h,q.config.classes.length]),3):at(0);return[Z,R,H]}),f=p[0],g=p[1],b=p[2],w=[],[4,g.array()];case 1:return m=I.sent(),[4,f.array()];case 2:x=I.sent(),y=0,I.label=3;case 3:if(!(y<d))return[3,12];N=0,I.label=4;case 4:if(!(N<d))return[3,11];S=0,I.label=5;case 5:return S<h?(D=o1(m[y][N][S][0]),!r||D>r?(_=(N+o1(x[y][N][S][0]))/d*u,A=(y+o1(x[y][N][S][1]))/d*c,L=Math.exp(x[y][N][S][2])*this.config.anchors[S].x/d*u,P=Math.exp(x[y][N][S][3])*this.config.anchors[S].y/d*c,j=_-L/2,E=A-P/2,F={row:y,col:N,anchor:S},this.withClassScores?[4,this.extractPredictedClass(b,F)]:[3,7]):[3,9]):[3,10];case 6:return B=I.sent(),[3,8];case 7:B={classScore:1,label:0},I.label=8;case 8:z=B,U=z.classScore,O=z.label,w.push(rr({box:new Gv(j,E,j+L,E+P),score:D,classScore:D*U,label:O},F)),I.label=9;case 9:return S++,[3,5];case 10:return N++,[3,4];case 11:return y++,[3,3];case 12:return f.dispose(),g.dispose(),b.dispose(),[2,w]}})})},t.prototype.extractPredictedClass=function(n,a){return ft(this,void 0,void 0,function(){var r,i,s,o;return pt(this,function(u){switch(u.label){case 0:return r=a.row,i=a.col,s=a.anchor,[4,n.array()];case 1:return o=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,d){return o[r][i][s][d]}).map(function(c,d){return{classScore:c,label:d}}).reduce(function(c,d){return c.classScore>d.classScore?c:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Ro),yq=function(e){Ct(t,e);function t(n){n===void 0&&(n=!0);var a=this,r=Object.assign({},{withSeparableConvs:n,iouThreshold:uq,classes:["face"]},n?{anchors:dq,meanRgb:hq}:{anchors:cq,withClassScores:!0});return a=e.call(this,r)||this,a}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,a){return ft(this,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return[4,this.detect(n,a)];case 1:return r=i.sent(),[2,r.map(function(s){return new hs(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?pq:fq},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(hE),fE=function(e){Ct(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(A5),qp=function(){function e(){}return e.prototype.then=function(t){return ft(this,void 0,void 0,function(){var n;return pt(this,function(a){switch(a.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[a.sent()])]}})})},e.prototype.run=function(){return ft(this,void 0,void 0,function(){return pt(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Jv(e,t,n,a,r){return r===void 0&&(r=function(i){var s=i.alignedRect;return s}),ft(this,void 0,void 0,function(){var i,s,o,u,c;return pt(this,function(d){switch(d.label){case 0:return i=e.map(function(h){return tE(h)?r(h):h.detection}),o=a,o?[3,5]:t instanceof zn?[4,N5(t,i)]:[3,2];case 1:return u=d.sent(),[3,4];case 2:return[4,w5(t,i)];case 3:u=d.sent(),d.label=4;case 4:o=u,d.label=5;case 5:return s=o,[4,n(s)];case 6:return c=d.sent(),s.forEach(function(h){return h instanceof zn&&h.dispose()}),[2,c]}})})}function E5(e,t,n,a,r){return ft(this,void 0,void 0,function(){var i=this;return pt(this,function(s){return[2,Jv([e],t,function(o){return ft(i,void 0,void 0,function(){return pt(this,function(u){return[2,n(o[0])]})})},a,r)]})})}function wq(e){return st(function(){return gi(ka(e,3).reverse(),3)})}var hg=2,Y0=12;function Nq(e,t){var n=Kv(e,t),a=k5(e,t);function r(c,d){var h=ha(e(c));return t.push({paramPath:d}),h}function i(c,d,h){h===void 0&&(h=!1);var p=n(c[0],c[1],3,d+"/conv1"),f=r(c[1],d+"/prelu1_alpha"),g=n(c[1],c[2],3,d+"/conv2"),b=r(c[2],d+"/prelu2_alpha"),w=n(c[2],c[3],h?2:3,d+"/conv3"),m=r(c[3],d+"/prelu3_alpha");return{conv1:p,prelu1_alpha:f,conv2:g,prelu2_alpha:b,conv3:w,prelu3_alpha:m}}function s(){var c=i([3,10,16,32],"pnet"),d=n(32,2,1,"pnet/conv4_1"),h=n(32,4,1,"pnet/conv4_2");return rr(rr({},c),{conv4_1:d,conv4_2:h})}function o(){var c=i([3,28,48,64],"rnet",!0),d=a(576,128,"rnet/fc1"),h=r(128,"rnet/prelu4_alpha"),p=a(128,2,"rnet/fc2_1"),f=a(128,4,"rnet/fc2_2");return rr(rr({},c),{fc1:d,prelu4_alpha:h,fc2_1:p,fc2_2:f})}function u(){var c=i([3,32,64,64],"onet"),d=n(64,128,2,"onet/conv4"),h=r(128,"onet/prelu4_alpha"),p=a(1152,256,"onet/fc1"),f=r(256,"onet/prelu5_alpha"),g=a(256,2,"onet/fc2_1"),b=a(256,4,"onet/fc2_2"),w=a(256,10,"onet/fc2_3");return rr(rr({},c),{conv4:d,prelu4_alpha:h,fc1:p,prelu5_alpha:f,fc2_1:g,fc2_2:b,fc2_3:w})}return{extractPNetParams:s,extractRNetParams:o,extractONetParams:u}}function kq(e){var t=Oo(e),n=t.extractWeights,a=t.getRemainingWeights,r=[],i=Nq(n,r),s=i.extractPNetParams,o=i.extractRNetParams,u=i.extractONetParams,c=s(),d=o(),h=u();if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{pnet:c,rnet:d,onet:h},paramMappings:r}}function Sq(e,t){var n=Jl(e,t);function a(d){var h=n(d+"/weights",4,d+"/filters"),p=n(d+"/bias",1);return{filters:h,bias:p}}function r(d){var h=n(d+"/weights",2),p=n(d+"/bias",1);return{weights:h,bias:p}}function i(d){return n(d,1)}function s(d){var h=a(d+"/conv1"),p=i(d+"/prelu1_alpha"),f=a(d+"/conv2"),g=i(d+"/prelu2_alpha"),b=a(d+"/conv3"),w=i(d+"/prelu3_alpha");return{conv1:h,prelu1_alpha:p,conv2:f,prelu2_alpha:g,conv3:b,prelu3_alpha:w}}function o(){var d=s("pnet"),h=a("pnet/conv4_1"),p=a("pnet/conv4_2");return rr(rr({},d),{conv4_1:h,conv4_2:p})}function u(){var d=s("rnet"),h=r("rnet/fc1"),p=i("rnet/prelu4_alpha"),f=r("rnet/fc2_1"),g=r("rnet/fc2_2");return rr(rr({},d),{fc1:h,prelu4_alpha:p,fc2_1:f,fc2_2:g})}function c(){var d=s("onet"),h=a("onet/conv4"),p=i("onet/prelu4_alpha"),f=r("onet/fc1"),g=i("onet/prelu5_alpha"),b=r("onet/fc2_1"),w=r("onet/fc2_2"),m=r("onet/fc2_3");return rr(rr({},d),{conv4:h,prelu4_alpha:p,fc1:f,prelu5_alpha:g,fc2_1:b,fc2_2:w,fc2_3:m})}return{extractPNetParams:o,extractRNetParams:u,extractONetParams:c}}function _q(e){var t=[],n=Sq(e,t),a=n.extractPNetParams,r=n.extractRNetParams,i=n.extractONetParams,s=a(),o=r(),u=i();return Mo(e,t),{params:{pnet:s,rnet:o,onet:u},paramMappings:t}}function Qy(e,t){var n=t[0],a=t[1];return{height:Math.floor(n*e),width:Math.floor(a*e)}}function jq(e,t,n){for(var a=n[0],r=n[1],i=Y0/e,s=[],o=Math.min(a,r)*i,u=0;o>=12;)s.push(i*Math.pow(t,u)),o=o*t,u+=1;return s}var D5=function(e){Ct(t,e);function t(n,a,r,i){return e.call(this,{left:n,top:a,right:r,bottom:i},!0)||this}return t}(Hl);function pE(e){return st(function(){return cr(ja(e,at(127.5)),at(.0078125))})}function Dd(e,t){return st(function(){return Ot(Un(e),cr(t,W0(Un(W0(e)))))})}function T5(e,t,n){return n===void 0&&(n=!1),st(function(){var a=os(e,t.conv1,"valid");return a=Dd(a,t.prelu1_alpha),a=La(a,n?[2,2]:[3,3],[2,2],"same"),a=os(a,t.conv2,"valid"),a=Dd(a,t.prelu2_alpha),a=n?a:La(a,[3,3],[2,2],"valid"),a=os(a,t.conv3,"valid"),a=Dd(a,t.prelu3_alpha),a})}function Cq(e,t){return st(function(){var n=T5(e,t,!0),a=os(n,t.conv4_1,"valid"),r=Mi(qv(a,3),3),i=Lo(ja(a,r),3),s=os(n,t.conv4_2,"valid");return{prob:i,regions:s}})}function Aq(e,t){return st(function(){var n=Qy(t,e.shape.slice(1)),a=n.height,r=n.width,i=u5.resizeBilinear(e,[a,r]),s=pE(i);return Wl(s,[0,2,1,3])})}function Eq(e,t,n,a){for(var r=[],i=e.arraySync(),s=0;s<e.shape[0];s++)for(var o=0;o<e.shape[1];o++)i[s][o]>=a&&r.push(new an(o,s));var u=r.map(function(c){var d=new Gv(Math.round((c.y*hg+1)/n),Math.round((c.x*hg+1)/n),Math.round((c.y*hg+Y0)/n),Math.round((c.x*hg+Y0)/n)),h=i[c.y][c.x],p=t.arraySync(),f=new D5(p[c.y][c.x][0],p[c.y][c.x][1],p[c.y][c.x][2],p[c.y][c.x][3]);return{cell:d,score:h,region:f}});return u}function Dq(e,t,n,a,r){r.stage1=[];var i=t.map(function(p){return st(function(){var f={scale:p},g=Aq(e,p),b=Date.now(),w=Cq(g,a),m=w.prob,x=w.regions;f.pnet=Date.now()-b;var y=ka(ka(m,3)[1])[0],N=ka(x)[0];return{scoresTensor:y,regionsTensor:N,scale:p,statsForScale:f}})}),s=i.map(function(p){var f=p.scoresTensor,g=p.regionsTensor,b=p.scale,w=p.statsForScale,m=Eq(f,g,b,n);if(f.dispose(),g.dispose(),!m.length)return r.stage1.push(w),[];var x=Date.now(),y=np(m.map(function(N){return N.cell}),m.map(function(N){return N.score}),.5);return w.nms=Date.now()-x,w.numBoxes=y.length,r.stage1.push(w),y.map(function(N){return m[N]})}),o=s.reduce(function(p,f){return p.concat(f)},[]),u=[],c=[];if(o.length>0){var d=Date.now(),h=np(o.map(function(p){return p.cell}),o.map(function(p){return p.score}),.7);r.stage1_nms=Date.now()-d,c=h.map(function(p){return o[p].score}),u=h.map(function(p){return o[p]}).map(function(p){var f=p.cell,g=p.region;return new Gv(f.left+g.left*f.width,f.top+g.top*f.height,f.right+g.right*f.width,f.bottom+g.bottom*f.height).toSquare().round()})}return{boxes:u,scores:c}}function mE(e,t,n){var a=n.width,r=n.height;return ft(this,void 0,void 0,function(){var i,s,o,u=this;return pt(this,function(c){switch(c.label){case 0:return i=Yu(e),[4,Promise.all(t.map(function(d){return ft(u,void 0,void 0,function(){var h,p,f,g,b,w,m,x;return pt(this,function(y){return h=d.padAtBorders(e.height,e.width),p=h.y,f=h.ey,g=h.x,b=h.ex,w=g-1,m=p-1,x=i.getImageData(w,m,b-w,f-m),[2,fr.isNodejs()?y5(x):createImageBitmap(x)]})})}))];case 1:return s=c.sent(),o=[],s.forEach(function(d){var h=$v({width:a,height:r}),p=Yu(h);p.drawImage(d,0,0,a,r);for(var f=p.getImageData(0,0,a,r).data,g=[],b=0;b<f.length;b+=4)g.push(f[b+2]),g.push(f[b+1]),g.push(f[b]);o.push(g)}),[2,o.map(function(d){var h=st(function(){var p=Wl(Or(d,[1,a,r,3]),[0,2,1,3]).toFloat();return pE(p)});return h})]}})})}function Tq(e,t){return st(function(){var n=T5(e,t),a=is(n,[n.shape[0],t.fc1.weights.shape[0]]),r=Ps(a,t.fc1),i=Dd(r,t.prelu4_alpha),s=Ps(i,t.fc2_1),o=Mi(qv(s,1),1),u=Lo(ja(s,o),1),c=Ps(i,t.fc2_2),d=ka(u,1)[1];return{scores:d,regions:c}})}function Lq(e,t,n,a,r){return ft(this,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g,b,w,m,x;return pt(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,mE(e,t,{width:24,height:24})];case 1:return s=y.sent(),r.stage2_extractImagePatches=Date.now()-i,i=Date.now(),o=s.map(function(N){var S=Tq(N,a);return N.dispose(),S}),r.stage2_rnet=Date.now()-i,u=o.length>1?Na(o.map(function(N){return N.scores})):o[0].scores,h=(d=Array).from,[4,u.data()];case 2:return c=h.apply(d,[y.sent()]),u.dispose(),p=c.map(function(N,S){return{score:N,idx:S}}).filter(function(N){return N.score>n}).map(function(N){var S=N.idx;return S}),f=p.map(function(N){return t[N]}),g=p.map(function(N){return c[N]}),b=[],w=[],f.length>0&&(i=Date.now(),m=np(f,g,.7),r.stage2_nms=Date.now()-i,x=m.map(function(N){var S=o[p[N]].regions.arraySync();return new D5(S[0][0],S[0][1],S[0][2],S[0][3])}),w=m.map(function(N){return g[N]}),b=m.map(function(N,S){return f[N].calibrate(x[S])})),o.forEach(function(N){N.regions.dispose(),N.scores.dispose()}),[2,{boxes:b,scores:w}]}})})}function Pq(e,t){return st(function(){var n=T5(e,t);n=La(n,[2,2],[2,2],"same"),n=os(n,t.conv4,"valid"),n=Dd(n,t.prelu4_alpha);var a=is(n,[n.shape[0],t.fc1.weights.shape[0]]),r=Ps(a,t.fc1),i=Dd(r,t.prelu5_alpha),s=Ps(i,t.fc2_1),o=Mi(qv(s,1),1),u=Lo(ja(s,o),1),c=Ps(i,t.fc2_2),d=Ps(i,t.fc2_3),h=ka(u,1)[1];return{scores:h,regions:c,points:d}})}function Rq(e,t,n,a,r){return ft(this,void 0,void 0,function(){var i,s,o,u,c,d,h,p,f,g,b,w,m,x,y;return pt(this,function(N){switch(N.label){case 0:return i=Date.now(),[4,mE(e,t,{width:48,height:48})];case 1:return s=N.sent(),r.stage3_extractImagePatches=Date.now()-i,i=Date.now(),o=s.map(function(S){var D=Pq(S,a);return S.dispose(),D}),r.stage3_onet=Date.now()-i,u=o.length>1?Na(o.map(function(S){return S.scores})):o[0].scores,h=(d=Array).from,[4,u.data()];case 2:return c=h.apply(d,[N.sent()]),u.dispose(),p=c.map(function(S,D){return{score:S,idx:D}}).filter(function(S){return S.score>n}).map(function(S){var D=S.idx;return D}),f=p.map(function(S){var D=o[S].regions.arraySync();return new D5(D[0][0],D[0][1],D[0][2],D[0][3])}),g=p.map(function(S,D){return t[S].calibrate(f[D])}),b=p.map(function(S){return c[S]}),w=[],m=[],x=[],g.length>0&&(i=Date.now(),y=np(g,b,.7,!1),r.stage3_nms=Date.now()-i,w=y.map(function(S){return g[S]}),m=y.map(function(S){return b[S]}),x=y.map(function(S,D){return Array(5).fill(0).map(function(_,A){var L=o[S].points.arraySync();return new an(L[0][A]*(w[D].width+1)+w[D].left,L[0][A+5]*(w[D].height+1)+w[D].top)})})),o.forEach(function(S){S.regions.dispose(),S.scores.dispose(),S.points.dispose()}),[2,{boxes:w,scores:m,points:x}]}})})}var Mq=function(e){Ct(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return ft(this,void 0,void 0,function(){return pt(this,function(a){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return ft(this,void 0,void 0,function(){return pt(this,function(a){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,a){return a===void 0&&(a={}),ft(this,void 0,void 0,function(){var r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,D,_,A;return pt(this,function(L){switch(L.label){case 0:if(r=this.params,!r)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},o=Date.now(),u=st(function(){return wq(Mi(m5.fromPixels(i)).toFloat())}),c=function(P){return u.dispose(),s.total=Date.now()-o,P},d=u.shape.slice(1),h=d[0],p=d[1],f=new cE(a),g=f.minFaceSize,b=f.scaleFactor,w=f.maxNumScales,m=f.scoreThresholds,x=f.scaleSteps,y=(x||jq(g,b,[h,p])).filter(function(P){var j=Qy(P,[h,p]);return Math.min(j.width,j.height)>Y0}).slice(0,w),s.scales=y,s.pyramid=y.map(function(P){return Qy(P,[h,p])}),N=Date.now(),[4,Dq(u,y,m[0],r.pnet,s)];case 1:return S=L.sent(),s.total_stage1=Date.now()-N,S.boxes.length?(s.stage2_numInputBoxes=S.boxes.length,N=Date.now(),[4,Lq(i,S.boxes,m[1],r.rnet,s)]):[2,c({results:[],stats:s})];case 2:return D=L.sent(),s.total_stage2=Date.now()-N,D.boxes.length?(s.stage3_numInputBoxes=D.boxes.length,N=Date.now(),[4,Rq(i,D.boxes,m[2],r.onet,s)]):[2,c({results:[],stats:s})];case 3:return _=L.sent(),s.total_stage3=Date.now()-N,A=_.boxes.map(function(P,j){return Yv(rp({},new hs(_.scores[j],new v5(P.left/p,P.top/h,P.width/p,P.height/h),{height:h,width:p})),new hU(_.points[j].map(function(E){return E.sub(new an(P.left,P.top)).div(new an(P.width,P.height))}),{width:P.width,height:P.height}))}),[2,c({results:A,stats:s})]}})})},t.prototype.forward=function(n,a){return a===void 0&&(a={}),ft(this,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ba(n)];case 1:return[4,r.apply(this,[i.sent(),a])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,a){return a===void 0&&(a={}),ft(this,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ba(n)];case 1:return[2,r.apply(this,[i.sent(),a])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return _q(n)},t.prototype.extractParams=function(n){return kq(n)},t}(Ro),Oq=.4,Iq=[new an(1.603231,2.094468),new an(6.041143,7.080126),new an(2.882459,3.518061),new an(4.266906,5.178857),new an(9.041765,10.66308)],Fq=[117.001,114.697,97.404],Bq=function(e){Ct(t,e);function t(){var n=this,a={withSeparableConvs:!0,iouThreshold:Oq,classes:["face"],anchors:Iq,meanRgb:Fq,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,a)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,a){return ft(this,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return[4,this.detect(n,a)];case 1:return r=i.sent(),[2,r.map(function(s){return new hs(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(hE),dr={ssdMobilenetv1:new dE,tinyFaceDetector:new Bq,tinyYolov2:new yq,mtcnn:new Mq,faceLandmark68Net:new rE,faceLandmark68TinyNet:new UU,faceRecognitionNet:new KU,faceExpressionNet:new AU,ageGenderNet:new IU},gE=function(e){Ct(t,e);function t(n,a,r){var i=e.call(this)||this;return i.parentTask=n,i.input=a,i.extractedFaces=r,i}return t}(qp),L5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a,r=this;return pt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Jv(n,this.input,function(s){return ft(r,void 0,void 0,function(){return pt(this,function(o){switch(o.label){case 0:return[4,Promise.all(s.map(function(u){return dr.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,o.sent()]}})})},this.extractedFaces)];case 2:return a=i.sent(),[2,n.map(function(s,o){return eE(s,a[o])})]}})})},t.prototype.withAgeAndGender=function(){return new O5(this,this.input)},t}(gE),P5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a;return pt(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return n=r.sent(),n?[4,E5(n,this.input,function(i){return dr.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return a=r.sent(),[2,eE(n,a)]}})})},t.prototype.withAgeAndGender=function(){return new I5(this,this.input)},t}(gE),R5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new F5(this,this.input)},t.prototype.withFaceDescriptors=function(){return new z5(this,this.input)},t}(L5),M5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new B5(this,this.input)},t.prototype.withFaceDescriptor=function(){return new U5(this,this.input)},t}(P5),vE=function(e){Ct(t,e);function t(n,a,r){var i=e.call(this)||this;return i.parentTask=n,i.input=a,i.extractedFaces=r,i}return t}(qp),O5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a,r=this;return pt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Jv(n,this.input,function(s){return ft(r,void 0,void 0,function(){return pt(this,function(o){switch(o.label){case 0:return[4,Promise.all(s.map(function(u){return dr.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,o.sent()]}})})},this.extractedFaces)];case 2:return a=i.sent(),[2,n.map(function(s,o){var u=a[o],c=u.age,d=u.gender,h=u.genderProbability;return lE(uE(s,d,h),c)})]}})})},t.prototype.withFaceExpressions=function(){return new L5(this,this.input)},t}(vE),I5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a,r,i,s;return pt(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,E5(n,this.input,function(u){return dr.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return a=o.sent(),r=a.age,i=a.gender,s=a.genderProbability,[2,lE(uE(n,i,s),r)]}})})},t.prototype.withFaceExpressions=function(){return new P5(this,this.input)},t}(vE),F5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new R5(this,this.input)},t.prototype.withFaceDescriptors=function(){return new z5(this,this.input)},t}(O5),B5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new M5(this,this.input)},t.prototype.withFaceDescriptor=function(){return new U5(this,this.input)},t}(I5),xE=function(e){Ct(t,e);function t(n,a){var r=e.call(this)||this;return r.parentTask=n,r.input=a,r}return t}(qp),z5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a;return pt(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return n=r.sent(),[4,Jv(n,this.input,function(i){return Promise.all(i.map(function(s){return dr.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return a=r.sent(),[2,a.map(function(i,s){return oE(n[s],i)})]}})})},t.prototype.withFaceExpressions=function(){return new R5(this,this.input)},t.prototype.withAgeAndGender=function(){return new F5(this,this.input)},t}(xE),U5=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a;return pt(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return n=r.sent(),n?[4,E5(n,this.input,function(i){return dr.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return a=r.sent(),[2,oE(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new M5(this,this.input)},t.prototype.withAgeAndGender=function(){return new B5(this,this.input)},t}(xE),bE=function(e){Ct(t,e);function t(n,a,r){var i=e.call(this)||this;return i.parentTask=n,i.input=a,i.useTinyLandmarkNet=r,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?dr.faceLandmark68TinyNet:dr.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(qp),zq=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a,r,i,s,o=this;return pt(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),a=n.map(function(c){return c.detection}),this.input instanceof zn?[4,N5(this.input,a)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,w5(this.input,a)];case 4:i=u.sent(),u.label=5;case 5:return r=i,[4,Promise.all(r.map(function(c){return o.landmarkNet.detectLandmarks(c)}))];case 6:return s=u.sent(),r.forEach(function(c){return c instanceof zn&&c.dispose()}),[2,n.map(function(c,d){return Yv(c,s[d])})]}})})},t.prototype.withFaceExpressions=function(){return new R5(this,this.input)},t.prototype.withAgeAndGender=function(){return new F5(this,this.input)},t.prototype.withFaceDescriptors=function(){return new z5(this,this.input)},t}(bE),Uq=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a,r,i,s;return pt(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?(a=n.detection,this.input instanceof zn?[4,N5(this.input,[a])]:[3,3]):[2];case 2:return i=o.sent(),[3,5];case 3:return[4,w5(this.input,[a])];case 4:i=o.sent(),o.label=5;case 5:return r=i,[4,this.landmarkNet.detectLandmarks(r[0])];case 6:return s=o.sent(),r.forEach(function(u){return u instanceof zn&&u.dispose()}),[2,Yv(n,s)]}})})},t.prototype.withFaceExpressions=function(){return new M5(this,this.input)},t.prototype.withAgeAndGender=function(){return new B5(this,this.input)},t.prototype.withFaceDescriptor=function(){return new U5(this,this.input)},t}(bE),yE=function(e){Ct(t,e);function t(n,a){a===void 0&&(a=new Xv);var r=e.call(this)||this;return r.input=n,r.options=a,r}return t}(qp),wE=function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a,r,i;return pt(this,function(s){switch(s.label){case 0:return n=this,a=n.input,r=n.options,r instanceof cE?[4,dr.mtcnn.forward(a,r)]:[3,2];case 1:return[2,s.sent().map(function(o){return o.detection})];case 2:if(i=r instanceof fE?function(o){return dr.tinyFaceDetector.locateFaces(o,r)}:r instanceof Xv?function(o){return dr.ssdMobilenetv1.locateFaces(o,r)}:r instanceof A5?function(o){return dr.tinyYolov2.locateFaces(o,r)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(a)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(a){return ft(n,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return r=i.sent(),[2,a(r.map(function(s){return rp({},s)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new zq(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new L5(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new O5(this.runAndExtendWithFaceDetections(),this.input)},t}(yE);(function(e){Ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ft(this,void 0,void 0,function(){var n,a;return pt(this,function(r){switch(r.label){case 0:return[4,new wE(this.input,this.options)];case 1:return n=r.sent(),a=n[0],n.forEach(function(i){i.score>a.score&&(a=i)}),[2,a]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(a){return ft(n,void 0,void 0,function(){var r;return pt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return r=i.sent(),[2,a(r?rp({},r):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new Uq(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new P5(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new I5(this.runAndExtendWithFaceDetection(),this.input)},t})(yE);function qq(e,t){return t===void 0&&(t=new Xv),new wE(e,t)}function Wq(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),a=Array.from(t);return Math.sqrt(n.map(function(r,i){return r-a[i]}).reduce(function(r,i){return r+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var a=Array.isArray(t)?t:[t];if(!a.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,i=function(){return"person "+r++};this._labeledDescriptors=a.map(function(s){if(s instanceof lg)return s;if(s instanceof Float32Array)return new lg(i(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new lg(i(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(a){return Wq(a,t)}).reduce(function(a,r){return a+r},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(a){var r=a.descriptors,i=a.label;return new lk(i,n.computeMeanDistance(t,r))}).reduce(function(a,r){return a.distance<r.distance?a:r})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new lk("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(a){return lg.fromJSON(a)});return new e(n,t.distanceThreshold)},e})();function NE(e,t){var n=new Pu(t.width,t.height),a=n.width,r=n.height;if(a<=0||r<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:a,height:r}));if(Array.isArray(e))return e.map(function(o){return NE(o,{width:a,height:r})});if(tE(e)){var i=e.detection.forSize(a,r),s=e.unshiftedLandmarks.forSize(i.box.width,i.box.height);return Yv(rp(e,i),s)}return F6(e)?rp(e,e.detection.forSize(a,r)):e instanceof ap||e instanceof hs?e.forSize(a,r):e}let pk=!1,fg=null;const Hq=async(e={})=>{const{detector:t="ssdMobilenetv1"}=e;return fg||(pk?!0:(fg=(async()=>{try{const n="/haris/models";console.log(`Loading face-api.js models from ${n}...`);const a=[dr.faceLandmark68Net.loadFromUri(n),dr.faceRecognitionNet.loadFromUri(n)];return t==="ssdMobilenetv1"?a.push(dr.ssdMobilenetv1.loadFromUri(n)):a.push(dr.tinyFaceDetector.loadFromUri(n)),await Promise.all(a),pk=!0,console.log(`✅ Face-api.js models (detector: ${t}) loaded successfully`),!0}catch(n){throw console.error("❌ Error loading face-api.js models:",n),console.error("Make sure model files are downloaded to /public/models/"),console.error("Download from: https://github.com/justadudewhohacks/face-api.js/tree/master/weights"),new Error("Failed to load face recognition models. Please check model files.")}})(),fg))},kE=e=>{const{data:t,width:n,height:a}=e,r=[];[4,8,16].forEach(o=>{for(let u=0;u<a;u+=o)for(let c=0;c<n;c+=o){let d=0,h=0;for(let p=0;p<o&&u+p<a;p++)for(let f=0;f<o&&c+f<n;f++){const g=((u+p)*n+(c+f))*4,b=t[g]*.299+t[g+1]*.587+t[g+2]*.114;d+=b,h++}h>0&&r.push(Math.round(d/h))}});const s=r.join(",");return btoa(s).substring(0,128)},SE=e=>{const{data:t,width:n,height:a}=e;let r=0,i=0,s=0,o=0;const u=Math.floor(n/2),c=Math.floor(a/2);for(let y=1;y<a-1;y++)for(let N=1;N<n-1;N++){const S=(y*n+N)*4,D=(t[S]+t[S+1]+t[S+2])/3,_=(t[S-4]+t[S-3]+t[S-2])/3,A=(t[S+4]+t[S+5]+t[S+6])/3,L=(t[(y-1)*n*4+N*4]+t[(y-1)*n*4+N*4+1]+t[(y-1)*n*4+N*4+2])/3,P=(t[(y+1)*n*4+N*4]+t[(y+1)*n*4+N*4+1]+t[(y+1)*n*4+N*4+2])/3,j=Math.abs(A-_),E=Math.abs(P-L);Math.sqrt(j*j+E*E)>10&&r++;const z=Math.max(D,_,A,L,P),U=Math.min(D,_,A,L,P);if(s+=z-U,N<u){const I=n-N-1;if(I<n){const K=(y*n+I)*4,Z=(t[K]+t[K+1]+t[K+2])/3;Math.abs(D-Z)<80&&i++}}const O=Math.sqrt((N-u)**2+(y-c)**2),B=Math.sqrt(u**2+c**2),q=O/B;o+=D*(1-q)}const d=n*a,h=r/d,p=i/(d/2),f=s/d,g=o/d,b=h>.01&&h<.5,w=p>.03,m=f>5,x=g>20&&g<230;return b&&w&&m&&x},Vq=(e,t,n=.9)=>{if(console.log("Fingerprint 1 (absensi):",e),console.log("Fingerprint 2 (database):",t),!e||!t)return!1;try{const a=atob(e).split(",").map(Number),r=atob(t).split(",").map(Number);if(a.length!==r.length)return!1;const i=[];let s=0;for(let x=0;x<a.length;x++)s+=Math.pow(a[x]-r[x],2);s=Math.sqrt(s);const o=Math.sqrt(a.length*Math.pow(255,2)),u=1-s/o;i.push(u);let c=0,d=0,h=0;for(let x=0;x<a.length;x++)c+=a[x]*r[x],d+=a[x]*a[x],h+=r[x]*r[x];const p=c/(Math.sqrt(d)*Math.sqrt(h));i.push(Math.max(0,p));let f=0;const g=120;for(let x=0;x<a.length;x++)Math.abs(a[x]-r[x])<=g&&f++;const b=f/a.length;i.push(b);const w=[.05,.05,.9];let m=0;for(let x=0;x<i.length;x++)m+=i[x]*w[x];return m>=n-.15&&m<n&&console.warn("Wajah benar-benar sangat mirip, tapi belum lolos threshold. Nilai:",m.toFixed(3),"Threshold:",n),console.log("Face comparison results:",{euclidean:u.toFixed(3),cosine:p.toFixed(3),tolerance:b.toFixed(3),weighted:m.toFixed(3),threshold:n,match:m>=n}),m>=n}catch(a){return console.error("Error comparing fingerprints:",a),!1}},Gq=e=>new Promise((t,n)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{try{const r=document.createElement("canvas"),i=r.getContext("2d");r.width=400,r.height=300,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(a,0,0,r.width,r.height);const s=$q(r);if(!s){n(new Error("Gagal memproses gambar wajah"));return}const o=SE(s),u=kE(s);t({fingerprint:u,isValidFace:!0})}catch(r){n(new Error("Gagal memproses gambar: "+r.message))}},a.onerror=()=>{n(new Error("Gagal memuat gambar dari URL"))},a.src=e}),$q=e=>{const t=e.getContext("2d"),{width:n,height:a}=e,r=Math.min(n*.7,350),i=Math.min(a*.85,420),s=(n-r)/2,o=(a-i)/2;try{return t.getImageData(s,o,r,i)}catch(u){return console.error("Error extracting face region:",u),null}},Qv=({onFaceCapture:e,isCapturing:t=!1})=>{const n=ae.useRef(null),a=ae.useRef(null),[r,i]=ae.useState(null),[s,o]=ae.useState("Posisikan wajah Anda di dalam lingkaran."),[u,c]=ae.useState(!1),d=ae.useRef(!1),h=f=>{try{window.speechSynthesis.cancel();const g=new SpeechSynthesisUtterance(f);g.lang="id-ID",window.speechSynthesis.speak(g)}catch(g){console.error("Speech synthesis failed",g)}},p=async()=>{if(n.current){const f=n.current,g=document.createElement("canvas");g.width=f.videoWidth,g.height=f.videoHeight;const b=g.getContext("2d");b.translate(g.width,0),b.scale(-1,1),b.drawImage(f,0,0,g.width,g.height);try{const w=b.getImageData(0,0,g.width,g.height),m=SE(w);g.toBlob(async x=>{if(m){const y=kE(w);await ct.fire({icon:"success",title:"Foto Berhasil",text:"Foto wajah berhasil diambil dan diverifikasi!"}),e(x,y)}else await ct.fire({icon:"warning",title:"Fingerprint Tidak Terdeteksi",text:"Fingerprint wajah tidak terdeteksi, silakan ulangi pengambilan foto."}),e(x,null)},"image/jpeg",.95)}catch{g.toBlob(async m=>{await ct.fire({icon:"error",title:"Gagal Mengambil Foto",text:"Terjadi kesalahan saat mengambil foto."}),e(m,null)},"image/jpeg",.95)}}};return ae.useEffect(()=>{let f=null,g=null;const b=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Kamera tidak didukung oleh browser ini.");f=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}}),n.current&&(n.current.srcObject=f)}catch(y){console.error("Error accessing camera:",y),i(y.message||"Gagal mengakses kamera. Pastikan izin telah diberikan.")}},w=async()=>{const y=n.current,N=a.current;if(y&&N&&y.readyState===4){const S={width:y.clientWidth,height:y.clientHeight};(N.width!==S.width||N.height!==S.height)&&NU(N,S);const D=await qq(y,new fE({inputSize:320})).withFaceLandmarks(),_=NE(D,S),A=N.getContext("2d");A.clearRect(0,0,N.width,N.height);const L=N.width/2,P=N.height/2,j=N.width/3.5,E=N.height/2.5;if(A.beginPath(),A.ellipse(L,P,j,E,0,0,2*Math.PI),A.lineWidth=5,_.length>0){const F=_[0].detection.box,z=F.x+F.width/2,U=F.y+F.height/2,O=Math.abs(z-L)<30&&Math.abs(U-P)<40,B=F.width>100&&F.height>100;if(O&&B)A.strokeStyle="green",c(!0),d.current||(o("Wajah terdeteksi. Silakan ambil foto."),h("Wajah terdeteksi. Silakan ambil foto."),d.current=!0);else if(A.strokeStyle="yellow",c(!1),d.current){const q=B?"Posisikan wajah di tengah lingkaran.":"Mohon lebih dekat ke kamera.";o(q),h(q),d.current=!1}}else A.strokeStyle="red",c(!1),d.current&&(o("Wajah tidak terdeteksi."),h("Wajah tidak terdeteksi."),d.current=!1);A.stroke()}g=requestAnimationFrame(w)};(async()=>{try{await Hq({detector:"tinyFaceDetector"}),await b(),h("Posisikan wajah Anda di dalam lingkaran.")}catch(y){console.error("Initialization failed:",y),i("Gagal memulai kamera atau memuat model. Coba muat ulang halaman.")}})();const x=n.current;return x&&(x.onplay=()=>{w()}),()=>{f&&f.getTracks().forEach(y=>y.stop()),g&&cancelAnimationFrame(g),window.speechSynthesis.cancel()}},[]),r?l.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg text-center",children:["Error: ",r]}):l.jsxs("div",{className:"relative bg-black rounded-lg w-full max-w-md mx-auto overflow-hidden",children:[l.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",transform:"scaleX(-1)"}}),l.jsx("canvas",{ref:a,className:"absolute top-0 left-0",style:{transform:"scaleX(-1)"}}),l.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-full px-4 flex flex-col items-center",children:[l.jsx("div",{className:"bg-black bg-opacity-60 text-white text-center p-2 rounded-md mb-4",children:s}),u&&l.jsx("button",{onClick:p,disabled:t,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full disabled:bg-gray-500",children:t?"Memproses...":"Ambil Foto"})]})]})},Kq=()=>{const e=wr(),[t,n]=ae.useState(1),[a,r]=ae.useState({name:"",email:"",password:"",confirmPassword:"",role:"karyawan"}),[i,s]=ae.useState(null),[o,u]=ae.useState(null),[c,d]=ae.useState(!1),[h,p]=ae.useState(null),[f,g]=ae.useState(null),b=Fg.createRef(),w=P=>{r({...a,[P.target.name]:P.target.value})},m=P=>{if(P.preventDefault(),p(null),!f){p("Silakan verifikasi bahwa Anda bukan robot dengan mencentang reCAPTCHA");return}if(a.password!==a.confirmPassword){p("Password tidak cocok");return}if(a.password.length<6){p("Password minimal 6 karakter");return}if(!bl()){p("Sistem belum dikonfigurasi. Silakan hubungi administrator untuk mengatur koneksi database.");return}a.role==="admin"?S():n(2)},x=P=>{g(P)},y=()=>{g(null)},N=(P,j)=>{s(P),u(j),console.log("✅ Face captured with custom fingerprint for registration")},S=async()=>{if(a.role!=="admin"&&(!i||!o)){p("Silakan ambil foto wajah Anda terlebih dahulu");return}d(!0),p(null);try{if(console.log("Memulai pendaftaran untuk role:",a.role),!bl())throw new Error("Sistem belum dikonfigurasi. Silakan hubungi administrator.");const{data:P,error:j}=await Pe.auth.signUp({email:a.email,password:a.password,options:{data:{name:a.name,role:a.role,full_name:a.name}}});if(j)throw console.error("Auth error:",j),j.message.includes("already registered")?new Error("Email sudah terdaftar"):j.message.includes("Email rate limit exceeded")?new Error("Terlalu banyak percobaan pendaftaran. Silakan coba lagi nanti."):j.message.includes("Password should be at least")?new Error("Password minimal 6 karakter"):new Error(j.message||"Gagal mendaftar");if(!P.user)throw new Error("Pendaftaran gagal - tidak ada data user");const E=P.user.id;let F=null;if(console.log("User berhasil dibuat dengan ID:",E,"Role:",a.role),a.role!=="admin"&&i)try{const q=`${E}-face-${Date.now()}.jpg`;await v0(i,"face-photos",q),F=x0("face-photos",q),console.log("Foto wajah berhasil diupload:",F)}catch(q){console.error("Error upload foto:",q),console.log("Melanjutkan tanpa foto wajah")}await new Promise(q=>setTimeout(q,2e3));const z={id:E,name:a.name,full_name:a.name,email:a.email,role:a.role,title:D(a.role),bio:`${D(a.role)} di sistem absensi`,avatar_url:F,is_face_registered:a.role==="admin"?!0:!!F,status:"active",join_date:new Date().toISOString().split("T")[0],contract_start_date:new Date().toISOString().split("T")[0],contract_type:"permanent",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Membuat profil dengan data:",z);const{data:U,error:O}=await Pe.from("profiles").insert([z]).select().single();if(O){console.error("Error membuat profil:",O);const{data:q,error:I}=await Pe.from("profiles").update(z).eq("id",E).select().single();if(I)throw console.error("Error update profil:",I),new Error("Gagal membuat profil user: "+I.message);console.log("Profil berhasil diupdate:",q)}else console.log("Profil berhasil dibuat:",U);if(a.role==="admin"||a.role==="kepala")try{await Pe.from("temp_admin_users").insert([{user_id:E,role:a.role}]),console.log("Admin/Kepala berhasil ditambahkan ke temp_admin_users")}catch(q){console.error("Error menambahkan ke temp_admin_users:",q)}await Pe.auth.signOut();const B=a.role==="admin"?`Pendaftaran Administrator berhasil! Akun ${a.name} telah dibuat tanpa verifikasi wajah. Silakan masuk untuk mengakses panel admin.`:`Pendaftaran berhasil! Akun ${D(a.role)} ${a.name} telah dibuat dengan verifikasi wajah. Silakan masuk.`;e("/login",{state:{message:B,email:a.email}})}catch(P){console.error("Error pendaftaran:",P);let j="Terjadi kesalahan saat mendaftar";P.message.includes("Email sudah terdaftar")?j="Email sudah terdaftar. Silakan gunakan email lain atau masuk dengan akun yang sudah ada.":P.message.includes("Password minimal")?j="Password minimal 6 karakter":P.message.includes("rate limit")?j="Terlalu banyak percobaan. Silakan coba lagi dalam beberapa menit.":P.message.includes("Sistem belum dikonfigurasi")?j="Sistem belum dikonfigurasi. Silakan hubungi administrator untuk mengatur koneksi database.":j=P.message||"Terjadi kesalahan saat mendaftar",p(j)}finally{d(!1)}},D=P=>{switch(P){case"karyawan":return"Karyawan";case"kepala":return"Kepala Bagian";case"admin":return"Administrator";default:return"Karyawan"}},_=P=>{switch(P){case"karyawan":return"Akses: Absensi pribadi dan riwayat kehadiran";case"kepala":return"Akses: Kelola karyawan dan laporan tim";case"admin":return"Akses: Kelola semua pengguna dan pengaturan sistem (tanpa verifikasi wajah)";default:return"Akses dasar sistem"}},A=P=>{switch(P){case"admin":return l.jsx(Zc,{className:"h-5 w-5"});case"kepala":return l.jsx(vT,{className:"h-5 w-5"});default:return l.jsx(Fl,{className:"h-5 w-5"})}},L=P=>{switch(P){case"admin":return"border-purple-300 bg-purple-50 text-purple-700";case"kepala":return"border-blue-300 bg-blue-50 text-blue-700";default:return"border-green-300 bg-green-50 text-green-700"}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-indigo-800 flex items-center justify-center p-4",children:l.jsxs("div",{className:"max-w-md w-full",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-6 shadow-lg",children:l.jsx(sS,{className:"h-10 w-10 text-blue-600"})}),l.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Portal Karyawan"}),l.jsx("p",{className:"text-blue-100",children:a.role==="admin"?"Buat akun Administrator tanpa verifikasi wajah":"Buat akun dengan verifikasi wajah"})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 backdrop-blur-sm",children:[a.role!=="admin"&&l.jsx("div",{className:"flex items-center justify-center mb-6",children:[1,2].map(P=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${t>=P?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:P<t?l.jsx($t,{className:"h-4 w-4"}):P}),P<2&&l.jsx("div",{className:`w-12 h-1 mx-2 ${t>P?"bg-blue-600":"bg-gray-200"}`})]},P))}),l.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[l.jsx(oS,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t===1?"Informasi Dasar":"Verifikasi Wajah"})]}),h&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(zu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Kesalahan Pendaftaran"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:h})]})]}),t===1?l.jsxs("form",{onSubmit:m,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),l.jsxs("div",{className:"relative",children:[l.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Masukkan nama lengkap Anda"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Alamat Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(ev,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Masukkan email Anda"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-3",children:"Pilih Jabatan"}),l.jsx("div",{className:"grid grid-cols-1 gap-3",children:["karyawan","kepala","admin"].map(P=>l.jsxs("label",{className:"cursor-pointer",children:[l.jsx("input",{type:"radio",name:"role",value:P,checked:a.role===P,onChange:w,className:"sr-only"}),l.jsx("div",{className:`p-4 rounded-lg border-2 transition-all ${a.role===P?L(P):"border-gray-200 hover:border-gray-300"}`,children:l.jsxs("div",{className:"flex items-center space-x-3",children:[A(P),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium text-lg",children:D(P)}),l.jsx("div",{className:"text-sm opacity-75 mt-1",children:_(P)})]}),a.role===P&&l.jsx($t,{className:"h-5 w-5 text-current"})]})})]},P))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(_l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",id:"password",name:"password",value:a.password,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Masukkan password Anda"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(_l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:w,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Konfirmasi password Anda"})]})]}),a.role==="admin"&&l.jsx("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Zc,{className:"h-5 w-5 text-purple-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-purple-800 font-medium",children:"Administrator"}),l.jsx("p",{className:"text-purple-700 text-sm mt-1",children:"Sebagai Administrator, Anda tidak perlu verifikasi wajah dan dapat langsung mengakses semua fitur sistem manajemen."})]})]})}),!bl()&&l.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(zu,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Sistem Belum Dikonfigurasi"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Database belum terhubung. Silakan hubungi administrator untuk mengatur koneksi Supabase."})]})]})}),l.jsx("div",{className:"mt-6",children:l.jsx("div",{className:"flex justify-center",children:l.jsx(kO,{ref:b,sitekey:"6LdVU1srAAAAAHHTvpZWAe6SDWNUgXw80Gh1t8ea",onChange:x,onExpired:y,theme:"light"})})}),l.jsx(V8,{}),l.jsx("button",{type:"submit",disabled:c||!bl()||!f,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:c?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Membuat Akun..."})]}):a.role==="admin"?"Buat Akun Administrator":"Lanjut ke Verifikasi Wajah"})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx(Ld,{className:"h-12 w-12 text-blue-600 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-600",children:"Ambil foto wajah yang jelas untuk verifikasi absensi. Sistem kami menggunakan teknologi pengenalan wajah yang aman dan cepat."})]}),l.jsx(Qv,{onFaceCapture:N,isCapturing:c}),i&&l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 text-green-600 mb-4",children:[l.jsx($t,{className:"h-5 w-5"}),l.jsx("span",{children:"Foto wajah berhasil diambil dan diverifikasi!"})]})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:()=>n(1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Kembali"}),l.jsx("button",{onClick:S,disabled:!i||c,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Membuat Akun..."})]}):"Selesaikan Pendaftaran"})]})]}),t===1&&l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-600",children:["Sudah punya akun?"," ",l.jsx(dT,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Masuk di sini"})]})})]}),l.jsxs("div",{className:"mt-6 p-4 bg-white/20 backdrop-blur-sm rounded-lg text-white",children:[l.jsxs("p",{className:"text-sm font-medium mb-2",children:[l.jsx("span",{className:"bg-blue-500 text-white px-2 py-1 rounded text-xs mr-2",children:"INFO"}),"Sistem Verifikasi Berdasarkan Role"]}),l.jsxs("div",{className:"text-xs space-y-1",children:[l.jsxs("p",{children:["• ",l.jsx("strong",{children:"Administrator:"})," Akses penuh tanpa verifikasi wajah"]}),l.jsxs("p",{children:["• ",l.jsx("strong",{children:"Karyawan & Kepala:"})," Verifikasi wajah untuk keamanan absensi"]}),l.jsx("p",{children:"• Data dienkripsi dan tidak dibagikan ke pihak ketiga"}),l.jsx("p",{children:"• Sistem custom yang aman dan cepat"})]})]})]})})};function Yq(e,t,n,a){const i=p=>p*Math.PI/180,s=i(e),o=i(n),u=i(n-e),c=i(a-t),d=Math.sin(u/2)**2+Math.cos(s)*Math.cos(o)*Math.sin(c/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}function Xq(e,t,n,a,r){return Yq(e,t,n,a)<=r}function Jq(){return new Promise((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(n=>{e({latitude:n.coords.latitude,longitude:n.coords.longitude})},n=>{let a="Unknown location error";switch(n.code){case n.PERMISSION_DENIED:a="Location access denied by user";break;case n.POSITION_UNAVAILABLE:a="Location information unavailable";break;case n.TIMEOUT:a="Location request timed out";break}t(new Error(a))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})}const Qq=({onLocationValidated:e})=>{const[t,n]=ae.useState(null),[a,r]=ae.useState(!1),[i,s]=ae.useState(!1),[o,u]=ae.useState(null),[c,d]=ae.useState(null);ae.useEffect(()=>{h()},[]);const h=async()=>{s(!0),u(null);try{const g=await eC();d(g);const b=await Jq();n(b);const w=Xq(b.latitude,b.longitude,g.latitude,g.longitude,g.radius);r(w),e&&e(w,b)}catch(g){console.error("Location validation error:",g);let b=g.message;b.includes("denied")?b="Akses lokasi ditolak. Silakan izinkan akses lokasi.":b.includes("unavailable")?b="Informasi lokasi tidak tersedia.":b.includes("timeout")?b="Permintaan lokasi timeout.":b.includes("not supported")&&(b="Geolokasi tidak didukung oleh browser ini."),u(b),e&&e(!1,null)}finally{s(!1)}},p=async()=>{await h()},f=g=>g?g.toFixed(6):"Tidak diketahui";return i?l.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-3"}),l.jsx("p",{className:"text-blue-700 font-medium",children:"Mendapatkan lokasi Anda..."}),l.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"Silakan izinkan akses lokasi"})]}):o?l.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-red-50 rounded-lg",children:[l.jsx(zu,{className:"h-8 w-8 text-red-500 mb-3"}),l.jsx("p",{className:"text-red-700 font-medium mb-2",children:"Kesalahan Akses Lokasi"}),l.jsx("p",{className:"text-red-600 text-sm text-center mb-4",children:o}),l.jsx("button",{onClick:p,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Coba Lagi"})]}):l.jsx("div",{className:`p-6 rounded-lg ${a?"bg-green-50":"bg-red-50"}`,children:l.jsxs("div",{className:"flex items-start space-x-4",children:[a?l.jsx($t,{className:"h-8 w-8 text-green-500 flex-shrink-0 mt-1"}):l.jsx(Rn,{className:"h-8 w-8 text-red-500 flex-shrink-0 mt-1"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(qi,{className:"h-5 w-5 text-gray-600"}),l.jsx("h3",{className:`font-semibold ${a?"text-green-700":"text-red-700"}`,children:a?"Lokasi Terverifikasi":"Lokasi Tidak Valid"})]}),l.jsx("p",{className:`text-sm mb-3 ${a?"text-green-600":"text-red-600"}`,children:a?"Anda berada dalam radius yang diizinkan dari kantor.":`Anda harus berada dalam radius ${(c==null?void 0:c.radius)||100} meter dari kantor untuk absen.`}),t&&c&&l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[l.jsxs("div",{className:"bg-white/70 p-3 rounded",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Lokasi Anda"}),l.jsxs("p",{className:"text-gray-600",children:[f(t.latitude),", ",f(t.longitude)]})]}),l.jsxs("div",{className:"bg-white/70 p-3 rounded",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Lokasi Kantor"}),l.jsxs("p",{className:"text-gray-600",children:[f(c.latitude),", ",f(c.longitude)]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:c.address})]})]}),l.jsx("button",{onClick:p,className:`mt-4 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"}`,children:"Perbarui Lokasi"})]})]})})},Zq=({user:e,onAttendanceSubmitted:t,todayAttendance:n=[]})=>{const[a,r]=ae.useState("masuk"),[i,s]=ae.useState(!1),[o,u]=ae.useState(!1),[c,d]=ae.useState(null),[h,p]=ae.useState(null),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(1),[y,N]=ae.useState(null),[S,D]=ae.useState(null),[_,A]=ae.useState(null),[L,P]=ae.useState(!1),[j,E]=ae.useState(!0),[F,z]=ae.useState(null),[U,O]=ae.useState(null),[B,q]=ae.useState(!1);ae.useEffect(()=>{const De=()=>{q(window.innerWidth<768)};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]),ae.useEffect(()=>{R(),H(),Z(),K(),I()},[e,n]);const I=async()=>{try{const De=await eC();z(De)}catch(De){console.error("Error fetching office location:",De)}},K=async()=>{try{const De=await tC();E(De.enabled)}catch(De){console.error("Error fetching camera settings:",De),E(!0)}},Z=()=>{const De=n.some(ke=>ke.type==="masuk"&&ke.status==="berhasil"),Oe=n.some(ke=>ke.type==="keluar"&&ke.status==="berhasil");De?De&&!Oe&&r("keluar"):r("masuk")},R=async()=>{try{const{data:De,error:Oe}=await Pe.from("profiles").select("*").eq("id",e.id).single();if(Oe)throw Oe;if(A(De),De.avatar_url&&j)try{const ke=await Gq(De.avatar_url);w(ke.fingerprint)}catch(ke){console.error("Error loading stored face fingerprint:",ke),N("Gagal memuat data wajah tersimpan. Silakan hubungi administrator.")}else j&&N("Foto profil belum tersedia. Silakan lengkapi profil Anda terlebih dahulu.")}catch(De){console.error("Error fetching user profile:",De),N("Gagal memuat profil pengguna.")}},H=async()=>{try{const{data:De,error:Oe}=await Pe.from("attendance").select("*").eq("user_id",e.id).eq("status","berhasil").order("timestamp",{ascending:!1}).limit(1);if(Oe)throw Oe;De&&De.length>0&&D(De[0])}catch(De){console.error("Error fetching last attendance:",De)}},$=De=>{let Oe="";De>1e3?Oe=`Anda berada ${(De/1e3).toFixed(1)} km dari lokasi kantor.`:Oe="",Oe+="<br/><br/>Silakan datang ke lokasi kantor untuk melakukan absensi.",ct.fire({icon:"error",title:"Hmm, Sistem mendeteksi kamu di luar lokasi kantor",html:Oe,confirmButtonText:"Mengerti",confirmButtonColor:"#3085d6"})},X=(De,Oe,ke)=>{if(O(ke),!De){$(ke),u(!1);return}u(!0),d(Oe),ct.fire({icon:"success",title:"Lokasi Valid",text:"Anda berada di lokasi kantor yang ditentukan",timer:2e3,showConfirmButton:!1}),x(j?2:3)},W=(De,Oe)=>{p(De),g(Oe),ct.fire({icon:"success",title:"Wajah Terverifikasi",text:"Wajah Anda berhasil dikenali",timer:2e3,showConfirmButton:!1}),x(3)},ie=async()=>{if(!j)return!0;if(!f||!b)throw new Error("Data wajah tidak tersedia untuk verifikasi");try{if(!Vq(f,b,.7))throw new Error("Wajah tidak cocok dengan data yang tersimpan. Pastikan Anda adalah orang yang benar dengan pencahayaan yang baik.");return!0}catch(De){throw console.error("Face verification error:",De),De}},ce=()=>{const De=new Date,Oe=De.toTimeString().slice(0,5),ke="08:00";let xe=!1,Ae=0,Ce=0,He=0;if(a==="masuk"){if(xe=Oe>"08:15",xe){const Qe=new Date(`1970-01-01T${ke}:00`),Ze=new Date(`1970-01-01T${Oe}:00`);Ae=Math.floor((Ze-Qe)/6e4)}}else if(a==="keluar"&&S&&S.type==="masuk"){const Qe=new Date(S.timestamp),Je=Math.floor((De-Qe)/6e4);Ce=Math.max(0,Je/60),Ce>9&&(He=Ce-9,Ce=9)}return{isLate:xe,lateMinutes:Ae,workHours:Ce,overtimeHours:He}},ue=async()=>{if(!o||!c){N("Silakan selesaikan verifikasi lokasi");return}if(j&&!f){N("Silakan selesaikan verifikasi wajah");return}if(n.some(Oe=>Oe.type===a&&Oe.status==="berhasil")){ct.fire({icon:"warning",title:"Absensi Sudah Dilakukan",text:`Anda sudah melakukan absensi ${a} hari ini.`,confirmButtonText:"OK"});return}s(!0),N(null);try{j&&await ie();const Oe=new Date,{isLate:ke,lateMinutes:xe,workHours:Ae,overtimeHours:Ce}=ce(),He=_!=null&&_.salary?_.salary/22:0;let Qe=0;if(a==="masuk")if(ke&&xe>15){const Xe=Math.min(xe/60*.1,.5);Qe=He*(1-Xe)}else Qe=He;const Ze={user_id:e.id,type:a,timestamp:Oe.toISOString(),latitude:c.latitude,longitude:c.longitude,status:"berhasil",is_late:ke,late_minutes:xe,work_hours:Ae,overtime_hours:Ce,daily_salary_earned:Qe,notes:`Absensi ${a} berhasil dengan verifikasi ${j?"wajah dan ":""}lokasi. ${ke?`Terlambat ${xe} menit.`:"Tepat waktu."}`};a==="masuk"?Ze.check_in_time=Oe.toISOString():Ze.check_out_time=Oe.toISOString();const{data:Je,error:le}=await Pe.from("attendance").insert([Ze]).select();if(le)throw le;try{await Pe.from("activity_logs").insert([{user_id:e.id,action_type:`attendance_${a}`,action_details:Ze,user_agent:navigator.userAgent}])}catch(Xe){console.error("Failed to log activity:",Xe)}await ct.fire({icon:"success",title:`Absensi ${a==="masuk"?"Masuk":"Keluar"} Berhasil`,html:`
          <div class="text-left">
            <p class="mb-2"><strong>Status:</strong> ${ke?`Terlambat ${xe} menit`:"Tepat Waktu"}</p>
            ${Ae>0?`<p class="mb-2"><strong>Jam Kerja:</strong> ${Ae.toFixed(1)} jam</p>`:""}
            ${Ce>0?`<p class="mb-2"><strong>Lembur:</strong> ${Ce.toFixed(1)} jam</p>`:""}
            ${Qe>0?`<p class="mb-2"><strong>Gaji Harian:</strong> ${Ee(Qe)}</p>`:""}
            <p class="text-sm text-gray-500 mt-3">${Oe.toLocaleString("id-ID")}</p>
          </div>
        `,confirmButtonText:"Selesai",confirmButtonColor:"#10b981",timer:5e3,timerProgressBar:!0,willClose:()=>{t&&t(Je[0]),he()}})}catch(Oe){console.error("Attendance submission error:",Oe);let ke="gagal";Oe.message.includes("wajah")||Oe.message.includes("Verifikasi wajah")?ke=j?"wajah_tidak_valid":"gagal":Oe.message.includes("lokasi")&&(ke="lokasi_tidak_valid");const xe={user_id:e.id,type:a,timestamp:new Date().toISOString(),latitude:(c==null?void 0:c.latitude)||null,longitude:(c==null?void 0:c.longitude)||null,status:ke,notes:`Absensi gagal: ${Oe.message}`};await Pe.from("attendance").insert([xe]),await ct.fire({icon:"error",title:`Absensi ${a==="masuk"?"Masuk":"Keluar"} Gagal`,text:Oe.message||"Terjadi kesalahan saat absensi",confirmButtonText:"OK",confirmButtonColor:"#3085d6"}),N(Oe.message)}finally{s(!1)}},he=()=>{x(1),u(!1),d(null),p(null),g(null),N(null),P(!1),H()},ge=()=>new Date().toLocaleString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),Ee=De=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(De),Te=n.some(De=>De.type==="masuk"&&De.status==="berhasil"),fe=n.some(De=>De.type==="keluar"&&De.status==="berhasil"),me=!Te,ne=Te&&!fe;return j&&!b?y&&y.includes("Foto profil")?l.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Absensi Karyawan"}),l.jsx("p",{className:"opacity-90",children:"Setup diperlukan untuk melanjutkan"})]}),l.jsxs("div",{className:"p-6 text-center",children:[l.jsx("div",{className:"bg-red-100 p-4 rounded-full inline-flex mb-4",children:l.jsx(Rn,{className:"h-12 w-12 text-red-600"})}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Verifikasi Wajah Diperlukan"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Untuk keamanan sistem absensi, Anda perlu menambahkan foto wajah ke profil terlebih dahulu."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>window.location.href="/profile",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(Wi,{className:"h-4 w-4"}),l.jsx("span",{children:"Lengkapi Profil Sekarang"})]}),l.jsx("button",{onClick:()=>E(!1),className:"w-full bg-gray-200 text-gray-800 py-3 px-4 rounded-lg font-medium hover:bg-gray-300 transition-colors text-sm",children:"Gunakan Mode Tanpa Verifikasi Wajah"})]}),l.jsx("div",{className:"mt-6 p-3 bg-blue-50 rounded-lg text-left",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(k1,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Informasi Penting"}),l.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Mode tanpa verifikasi wajah hanya dapat digunakan dengan persetujuan HRD dan memiliki batasan tertentu."})]})]})})]})]}):l.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Absensi Karyawan"}),l.jsx("p",{className:"opacity-90",children:"Memuat data verifikasi..."})]}),l.jsxs("div",{className:"p-8 text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Menyiapkan sistem verifikasi..."})]})]}):l.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white",children:[l.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[l.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:l.jsx(br,{className:"h-6 w-6"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h2",{className:"text-xl md:text-2xl font-bold truncate",children:"Absensi Karyawan"}),l.jsx("p",{className:"text-sm md:text-base opacity-90 truncate",children:(_==null?void 0:_.name)||"Pengguna"})]})]}),l.jsx("p",{className:"text-xs md:text-sm opacity-90",children:ge()}),S&&l.jsx("div",{className:"mt-4 p-3 bg-white/10 rounded-lg",children:l.jsxs("p",{className:"text-xs md:text-sm truncate",children:["Terakhir: ",l.jsx("span",{className:"font-medium",children:S.type==="masuk"?"Masuk":"Keluar"})," ",new Date(S.timestamp).toLocaleString("id-ID",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]})}),l.jsx("div",{className:"mt-4 p-3 bg-white/10 rounded-lg",children:l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs md:text-sm",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Te?"bg-green-400":"bg-yellow-400"}`}),l.jsx("span",{children:"Masuk:"}),l.jsx("span",{className:"font-medium",children:Te?"✓":"○"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${fe?"bg-green-400":"bg-yellow-400"}`}),l.jsx("span",{children:"Keluar:"}),l.jsx("span",{className:"font-medium",children:fe?"✓":"○"})]})]})})]}),l.jsxs("div",{className:"p-4 md:p-6",children:[B&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-medium text-sm ${m>=1?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:m>1?l.jsx($t,{className:"h-4 w-4"}):1}),l.jsx("span",{className:"text-xs mt-1",children:"Lokasi"})]}),l.jsx("div",{className:"flex-1 h-1 mx-2 bg-gray-200 relative",children:l.jsx("div",{className:`absolute top-0 left-0 h-full ${m>1?"bg-blue-600":"bg-gray-200"}`,style:{width:m>1?"100%":"0%"}})}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-medium text-sm ${m>=2?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:m>2?l.jsx($t,{className:"h-4 w-4"}):2}),l.jsx("span",{className:"text-xs mt-1",children:"Wajah"})]}),l.jsx("div",{className:"flex-1 h-1 mx-2 bg-gray-200 relative",children:l.jsx("div",{className:`absolute top-0 left-0 h-full ${m>2?"bg-blue-600":"bg-gray-200"}`,style:{width:m>2?"100%":"0%"}})}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-medium text-sm ${m>=3?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:"3"}),l.jsx("span",{className:"text-xs mt-1",children:"Kirim"})]})]}),!B&&l.jsx("div",{className:"flex items-center justify-between mb-8",children:[1,2,3].map(De=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium ${m>=De?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:De<m?l.jsx($t,{className:"h-5 w-5"}):De}),De<3&&l.jsx("div",{className:`flex-1 h-1 mx-4 ${m>De?"bg-blue-600":"bg-gray-200"}`})]},De))}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Jenis Absensi"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{onClick:()=>r("masuk"),disabled:!me,className:`p-3 md:p-4 rounded-lg border-2 transition-all flex flex-col items-center ${a==="masuk"?"border-blue-600 bg-blue-50 text-blue-700":me?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[l.jsx(ls,{className:"h-5 w-5 md:h-6 md:w-6 mb-2"}),l.jsx("p",{className:"font-medium text-sm md:text-base",children:"Masuk"}),!me&&l.jsx("p",{className:"text-xs mt-1",children:"Sudah dilakukan"})]}),l.jsxs("button",{onClick:()=>r("keluar"),disabled:!ne,className:`p-3 md:p-4 rounded-lg border-2 transition-all flex flex-col items-center ${a==="keluar"?"border-blue-600 bg-blue-50 text-blue-700":ne?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[l.jsx(ls,{className:"h-5 w-5 md:h-6 md:w-6 mb-2"}),l.jsx("p",{className:"font-medium text-sm md:text-base",children:"Keluar"}),!ne&&l.jsx("p",{className:"text-xs mt-1",children:Te?"Sudah dilakukan":"Belum masuk"})]})]})]}),m===1&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(qi,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold",children:"Verifikasi Lokasi"})]}),F&&l.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-700",children:[l.jsx("strong",{children:"Lokasi Kantor:"})," ",F.name,l.jsx("br",{}),l.jsx("strong",{children:"Alamat:"})," ",F.address]})}),l.jsx(Qq,{onLocationValidated:X,officeLocation:F}),l.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:l.jsxs("p",{className:"text-sm text-yellow-700",children:[l.jsx("strong",{children:"Perhatian:"})," Pastikan GPS/Lokasi perangkat Anda aktif dan Anda berada di area kantor."]})})]}),m===2&&j&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(Ld,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold",children:"Verifikasi Wajah"})]}),l.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(k1,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Tips Verifikasi Wajah"}),l.jsxs("ul",{className:"text-xs text-blue-600 mt-1 list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Pastikan pencahayaan cukup terang"}),l.jsx("li",{children:"Hadapkan wajah ke kamera secara lurus"}),l.jsx("li",{children:"Hindari bayangan pada wajah"}),l.jsx("li",{children:"Jangan gunakan masker atau kacamata gelap"})]})]})]})}),l.jsx(Qv,{onFaceCapture:W,isCapturing:i,isMobile:B}),l.jsxs("button",{onClick:()=>x(1),className:"mt-4 text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali ke verifikasi lokasi"]})]}),m===3&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx($t,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold",children:"Konfirmasi Absensi"})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Ringkasan Verifikasi"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Lokasi:"}),l.jsxs("div",{className:"flex items-center text-green-600 font-medium",children:[l.jsx($t,{className:"h-4 w-4 mr-1"}),l.jsx("span",{children:"Terverifikasi"})]})]}),j&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Wajah:"}),l.jsxs("div",{className:"flex items-center text-green-600 font-medium",children:[l.jsx($t,{className:"h-4 w-4 mr-1"}),l.jsx("span",{children:"Terverifikasi"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Jenis Absensi:"}),l.jsx("span",{className:"font-medium",children:a==="masuk"?"Masuk":"Keluar"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Waktu:"}),l.jsx("span",{className:"font-medium",children:new Date().toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})})]}),U&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Jarak dari Kantor:"}),l.jsx("span",{className:"font-medium",children:U>1e3?`${(U/1e3).toFixed(1)} km`:`${Math.round(U)} m`})]})]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:he,className:"flex-1 px-4 py-2 md:py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm md:text-base",children:"Mulai Ulang"}),l.jsx("button",{onClick:ue,disabled:i,className:"flex-1 px-4 py-2 md:py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm md:text-base flex items-center justify-center",children:i?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Mengirim..."]}):"Kirim Absensi"})]})]}),y&&!y.includes("Foto profil")&&l.jsxs("div",{className:"mt-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(zu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Gagal Melakukan Absensi"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:y}),l.jsx("button",{onClick:he,className:"mt-2 text-sm text-red-700 underline hover:text-red-800",children:"Coba Lagi"})]})]})]})]})},_E=({userId:e,userRole:t})=>{const[n,a]=ae.useState([]),[r,i]=ae.useState(!1),[s,o]=ae.useState(0);ae.useEffect(()=>{if(e){u();const g=Pe.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e}`},b=>{a(w=>[b.new,...w]),o(w=>w+1)}).subscribe();return()=>{g.unsubscribe()}}},[e]);const u=async()=>{try{const{data:g,error:b}=await Pe.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(20);if(b)throw b;a(g||[]),o((g==null?void 0:g.filter(w=>!w.is_read).length)||0)}catch(g){console.error("Error fetching notifications:",g)}},c=async g=>{try{const{error:b}=await Pe.from("notifications").update({is_read:!0}).eq("id",g);if(b)throw b;a(w=>w.map(m=>m.id===g?{...m,is_read:!0}:m)),o(w=>Math.max(0,w-1))}catch(b){console.error("Error marking notification as read:",b)}},d=async()=>{try{const{error:g}=await Pe.from("notifications").update({is_read:!0}).eq("user_id",e).eq("is_read",!1);if(g)throw g;a(b=>b.map(w=>({...w,is_read:!0}))),o(0)}catch(g){console.error("Error marking all notifications as read:",g)}},h=g=>{switch(g){case"late_warning":return l.jsx(ls,{className:"h-5 w-5 text-orange-500"});case"absence_warning":return l.jsx(Pn,{className:"h-5 w-5 text-red-500"});case"salary_info":return l.jsx($t,{className:"h-5 w-5 text-green-500"});case"system_alert":return l.jsx(Bl,{className:"h-5 w-5 text-blue-500"});case"general":return l.jsx(br,{className:"h-5 w-5 text-gray-500"});default:return l.jsx(vo,{className:"h-5 w-5 text-gray-500"})}},p=g=>{switch(g){case"late_warning":return"border-l-orange-400 bg-orange-50";case"absence_warning":return"border-l-red-400 bg-red-50";case"salary_info":return"border-l-green-400 bg-green-50";case"system_alert":return"border-l-blue-400 bg-blue-50";case"general":return"border-l-gray-400 bg-gray-50";default:return"border-l-gray-400 bg-gray-50"}},f=g=>{const b=new Date(g),w=new Date,m=(w-b)/(1e3*60*60);if(m<1){const x=Math.floor((w-b)/6e4);return x<=1?"Baru saja":`${x} menit yang lalu`}else return m<24?`${Math.floor(m)} jam yang lalu`:b.toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})};return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>i(!r),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors group",children:[l.jsx(vo,{className:"h-6 w-6 group-hover:scale-110 transition-transform"}),s>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse",children:s>9?"9+":s})]}),r&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>i(!1)}),l.jsxs("div",{className:"fixed md:absolute right-0 mt-2 w-full md:w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-[80vh] md:max-h-96 overflow-hidden md:top-auto bottom-0 md:bottom-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-blue-100",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(vo,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifikasi"}),s>0&&l.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:s})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[s>0&&l.jsx("button",{onClick:d,className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Tandai semua dibaca"}),l.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded transition-colors",children:l.jsx(Ui,{className:"h-4 w-4"})})]})]}),l.jsx("div",{className:"max-h-[calc(80vh-120px)] md:max-h-80 overflow-y-auto",children:n.length>0?n.map(g=>{var b;return l.jsx("div",{className:`p-4 border-l-4 hover:bg-gray-50 cursor-pointer transition-colors ${g.is_read?"border-l-gray-200 bg-white":p(g.type)}`,onClick:()=>!g.is_read&&c(g.id),children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"flex-shrink-0 mt-1",children:h(g.type)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("p",{className:`text-sm font-medium ${g.is_read?"text-gray-700":"text-gray-900"}`,children:g.title}),!g.is_read&&l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:g.message}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[l.jsx(Uu,{className:"h-3 w-3 mr-1"}),f(g.created_at)]}),((b=g.data)==null?void 0:b.letter_number)&&l.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:g.data.letter_number})]})]})]})},g.id)}):l.jsxs("div",{className:"p-8 text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(vo,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 font-medium",children:"Tidak ada notifikasi"}),l.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Notifikasi akan muncul di sini"})]})}),n.length>0&&l.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50 text-center",children:l.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Lihat semua notifikasi"})})]})]})]})};function jE(e){var t,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=jE(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function Zv(){for(var e,t,n=0,a="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=jE(e))&&(a&&(a+=" "),a+=t);return a}const eW=(e,t,n,a)=>{if(n==="length"||n==="prototype"||n==="arguments"||n==="caller")return;const r=Object.getOwnPropertyDescriptor(e,n),i=Object.getOwnPropertyDescriptor(t,n);!tW(r,i)&&a||Object.defineProperty(e,n,i)},tW=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},nW=(e,t)=>{const n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)},aW=(e,t)=>`/* Wrapped ${e}*/
${t}`,rW=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),iW=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),sW=(e,t,n)=>{const a=n===""?"":`with ${n.trim()}() `,r=aW.bind(null,a,t.toString());Object.defineProperty(r,"name",iW);const{writable:i,enumerable:s,configurable:o}=rW;Object.defineProperty(e,"toString",{value:r,writable:i,enumerable:s,configurable:o})};function oW(e,t,{ignoreNonConfigurable:n=!1}={}){const{name:a}=e;for(const r of Reflect.ownKeys(t))eW(e,t,r,n);return nW(e,t),sW(e,t,a),e}const lW=new WeakMap,mk=new WeakMap;function CE(e,{cacheKey:t,cache:n=new Map,maxAge:a}={}){if(a===0)return e;if(typeof a=="number"){if(a>2147483647)throw new TypeError("The `maxAge` option cannot exceed 2147483647.");if(a<0)throw new TypeError("The `maxAge` option should not be a negative number.")}const r=function(...i){var d;const s=t?t(i):i[0],o=n.get(s);if(o)return o.data;const u=e.apply(this,i),c=typeof a=="function"?a(...i):a;if(n.set(s,{data:u,maxAge:c?Date.now()+c:Number.POSITIVE_INFINITY}),c&&c>0&&c!==Number.POSITIVE_INFINITY){const h=setTimeout(()=>{n.delete(s)},c);(d=h.unref)==null||d.call(h);const p=mk.get(e)??new Set;p.add(h),mk.set(e,p)}return u};return oW(r,e,{ignoreNonConfigurable:!0}),lW.set(r,n),r}function uW(e){return typeof e=="string"}function cW(e,t,n){return n.indexOf(e)===t}function dW(e){return e.toLowerCase()===e}function gk(e){return e.indexOf(",")===-1?e:e.split(",")}function Zy(e){if(!e)return e;if(e==="C"||e==="posix"||e==="POSIX")return"en-US";if(e.indexOf(".")!==-1){var t=e.split(".")[0],n=t===void 0?"":t;return Zy(n)}if(e.indexOf("@")!==-1){var a=e.split("@")[0],n=a===void 0?"":a;return Zy(n)}if(e.indexOf("-")===-1||!dW(e))return e;var r=e.split("-"),i=r[0],s=r[1],o=s===void 0?"":s;return"".concat(i,"-").concat(o.toUpperCase())}function hW(e){var t=e===void 0?{}:e,n=t.useFallbackLocale,a=n===void 0?!0:n,r=t.fallbackLocale,i=r===void 0?"en-US":r,s=[];if(typeof navigator<"u"){for(var o=navigator.languages||[],u=[],c=0,d=o;c<d.length;c++){var h=d[c];u=u.concat(gk(h))}var p=navigator.language,f=p&&gk(p);s=s.concat(u,f)}return a&&s.push(i),s.filter(uW).map(Zy).filter(cW)}var fW=CE(hW,{cacheKey:JSON.stringify});function pW(e){return fW(e)[0]||null}var AE=CE(pW,{cacheKey:JSON.stringify});function Io(e,t,n){return function(r,i=n){const s=e(r)+i;return t(s)}}function Wp(e){return function(n){return new Date(e(n).getTime()-1)}}function Hp(e,t){return function(a){return[e(a),t(a)]}}function On(e){if(e instanceof Date)return e.getFullYear();if(typeof e=="number")return e;const t=Number.parseInt(e,10);if(typeof e=="string"&&!Number.isNaN(t))return t;throw new Error(`Failed to get year from date: ${e}.`)}function Ql(e){if(e instanceof Date)return e.getMonth();throw new Error(`Failed to get month from date: ${e}.`)}function ex(e){if(e instanceof Date)return e.getDate();throw new Error(`Failed to get year from date: ${e}.`)}function hh(e){const t=On(e),n=t+(-t+1)%100,a=new Date;return a.setFullYear(n,0,1),a.setHours(0,0,0,0),a}const mW=Io(On,hh,-100),EE=Io(On,hh,100),q5=Wp(EE),gW=Io(On,q5,-100),DE=Hp(hh,q5);function Zl(e){const t=On(e),n=t+(-t+1)%10,a=new Date;return a.setFullYear(n,0,1),a.setHours(0,0,0,0),a}const TE=Io(On,Zl,-10),W5=Io(On,Zl,10),tx=Wp(W5),LE=Io(On,tx,-10),PE=Hp(Zl,tx);function fh(e){const t=On(e),n=new Date;return n.setFullYear(t,0,1),n.setHours(0,0,0,0),n}const RE=Io(On,fh,-1),H5=Io(On,fh,1),nx=Wp(H5),ME=Io(On,nx,-1),vW=Hp(fh,nx);function V5(e,t){return function(a,r=t){const i=On(a),s=Ql(a)+r,o=new Date;return o.setFullYear(i,s,1),o.setHours(0,0,0,0),e(o)}}function oc(e){const t=On(e),n=Ql(e),a=new Date;return a.setFullYear(t,n,1),a.setHours(0,0,0,0),a}const OE=V5(oc,-1),G5=V5(oc,1),Vp=Wp(G5),IE=V5(Vp,-1),xW=Hp(oc,Vp);function bW(e,t){return function(a,r=t){const i=On(a),s=Ql(a),o=ex(a)+r,u=new Date;return u.setFullYear(i,s,o),u.setHours(0,0,0,0),e(u)}}function Gp(e){const t=On(e),n=Ql(e),a=ex(e),r=new Date;return r.setFullYear(t,n,a),r.setHours(0,0,0,0),r}const yW=bW(Gp,1),$5=Wp(yW),wW=Hp(Gp,$5);function FE(e){return ex(Vp(e))}var Ya={GREGORY:"gregory",HEBREW:"hebrew",ISLAMIC:"islamic",ISO_8601:"iso8601"},NW={gregory:["en-CA","en-US","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-SV","es-VE","pt-BR"],hebrew:["he","he-IL"],islamic:["ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LY","ar-OM","ar-QA","ar-SA","ar-SD","ar-SY","ar-YE","dv","dv-MV","ps","ps-AR"]},K5=[0,1,2,3,4,5,6],c1=new Map;function kW(e){return function(n,a){var r=n||AE();c1.has(r)||c1.set(r,new Map);var i=c1.get(r);return i.has(e)||i.set(e,new Intl.DateTimeFormat(r||void 0,e).format),i.get(e)(a)}}function SW(e){var t=new Date(e);return new Date(t.setHours(12))}function lc(e){return function(t,n){return kW(e)(t,SW(n))}}var _W={day:"numeric"},jW={day:"numeric",month:"long",year:"numeric"},CW={month:"long"},AW={month:"long",year:"numeric"},EW={weekday:"short"},DW={weekday:"long"},TW={year:"numeric"},LW=lc(_W),PW=lc(jW),RW=lc(CW),BE=lc(AW),MW=lc(EW),OW=lc(DW),ax=lc(TW),IW=K5[0],FW=K5[5],vk=K5[6];function ip(e,t){t===void 0&&(t=Ya.ISO_8601);var n=e.getDay();switch(t){case Ya.ISO_8601:return(n+6)%7;case Ya.ISLAMIC:return(n+1)%7;case Ya.HEBREW:case Ya.GREGORY:return n;default:throw new Error("Unsupported calendar type.")}}function BW(e){var t=hh(e);return On(t)}function zW(e){var t=Zl(e);return On(t)}function e2(e,t){t===void 0&&(t=Ya.ISO_8601);var n=On(e),a=Ql(e),r=e.getDate()-ip(e,t);return new Date(n,a,r)}function UW(e,t){t===void 0&&(t=Ya.ISO_8601);var n=t===Ya.GREGORY?Ya.GREGORY:Ya.ISO_8601,a=e2(e,t),r=On(e)+1,i,s;do i=new Date(r,0,n===Ya.ISO_8601?4:1),s=e2(i,t),r-=1;while(e<s);return Math.round((a.getTime()-s.getTime())/(864e5*7))+1}function Mu(e,t){switch(e){case"century":return hh(t);case"decade":return Zl(t);case"year":return fh(t);case"month":return oc(t);case"day":return Gp(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function qW(e,t){switch(e){case"century":return mW(t);case"decade":return TE(t);case"year":return RE(t);case"month":return OE(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function zE(e,t){switch(e){case"century":return EE(t);case"decade":return W5(t);case"year":return H5(t);case"month":return G5(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function WW(e,t){switch(e){case"decade":return TE(t,-100);case"year":return RE(t,-10);case"month":return OE(t,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}function HW(e,t){switch(e){case"decade":return W5(t,100);case"year":return H5(t,10);case"month":return G5(t,12);default:throw new Error("Invalid rangeType: ".concat(e))}}function UE(e,t){switch(e){case"century":return q5(t);case"decade":return tx(t);case"year":return nx(t);case"month":return Vp(t);case"day":return $5(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function VW(e,t){switch(e){case"century":return gW(t);case"decade":return LE(t);case"year":return ME(t);case"month":return IE(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function GW(e,t){switch(e){case"decade":return LE(t,-100);case"year":return ME(t,-10);case"month":return IE(t,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}function xk(e,t){switch(e){case"century":return DE(t);case"decade":return PE(t);case"year":return vW(t);case"month":return xW(t);case"day":return wW(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function $W(e,t,n){var a=[t,n].sort(function(r,i){return r.getTime()-i.getTime()});return[Mu(e,a[0]),UE(e,a[1])]}function qE(e,t,n){return n.map(function(a){return(t||ax)(e,a)}).join(" – ")}function KW(e,t,n){return qE(e,t,DE(n))}function WE(e,t,n){return qE(e,t,PE(n))}function YW(e){return e.getDay()===new Date().getDay()}function HE(e,t){t===void 0&&(t=Ya.ISO_8601);var n=e.getDay();switch(t){case Ya.ISLAMIC:case Ya.HEBREW:return n===FW||n===vk;case Ya.ISO_8601:case Ya.GREGORY:return n===vk||n===IW;default:throw new Error("Unsupported calendar type.")}}var Ns="react-calendar__navigation";function XW(e){var t=e.activeStartDate,n=e.drillUp,a=e.formatMonthYear,r=a===void 0?BE:a,i=e.formatYear,s=i===void 0?ax:i,o=e.locale,u=e.maxDate,c=e.minDate,d=e.navigationAriaLabel,h=d===void 0?"":d,p=e.navigationAriaLive,f=e.navigationLabel,g=e.next2AriaLabel,b=g===void 0?"":g,w=e.next2Label,m=w===void 0?"»":w,x=e.nextAriaLabel,y=x===void 0?"":x,N=e.nextLabel,S=N===void 0?"›":N,D=e.prev2AriaLabel,_=D===void 0?"":D,A=e.prev2Label,L=A===void 0?"«":A,P=e.prevAriaLabel,j=P===void 0?"":P,E=e.prevLabel,F=E===void 0?"‹":E,z=e.setActiveStartDate,U=e.showDoubleView,O=e.view,B=e.views,q=B.indexOf(O)>0,I=O!=="century",K=qW(O,t),Z=I?WW(O,t):void 0,R=zE(O,t),H=I?HW(O,t):void 0,$=function(){if(K.getFullYear()<0)return!0;var fe=VW(O,t);return c&&c>=fe}(),X=I&&function(){if(Z.getFullYear()<0)return!0;var fe=GW(O,t);return c&&c>=fe}(),W=u&&u<R,ie=I&&u&&u<H;function ce(){z(K,"prev")}function ue(){z(Z,"prev2")}function he(){z(R,"next")}function ge(){z(H,"next2")}function Ee(fe){var me=function(){switch(O){case"century":return KW(o,s,fe);case"decade":return WE(o,s,fe);case"year":return s(o,fe);case"month":return r(o,fe);default:throw new Error("Invalid view: ".concat(O,"."))}}();return f?f({date:fe,label:me,locale:o||AE()||void 0,view:O}):me}function Te(){var fe="".concat(Ns,"__label");return l.jsxs("button",{"aria-label":h,"aria-live":p,className:fe,disabled:!q,onClick:n,style:{flexGrow:1},type:"button",children:[l.jsx("span",{className:"".concat(fe,"__labelText ").concat(fe,"__labelText--from"),children:Ee(t)}),U?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"".concat(fe,"__divider"),children:" – "}),l.jsx("span",{className:"".concat(fe,"__labelText ").concat(fe,"__labelText--to"),children:Ee(R)})]}):null]})}return l.jsxs("div",{className:Ns,children:[L!==null&&I?l.jsx("button",{"aria-label":_,className:"".concat(Ns,"__arrow ").concat(Ns,"__prev2-button"),disabled:X,onClick:ue,type:"button",children:L}):null,F!==null&&l.jsx("button",{"aria-label":j,className:"".concat(Ns,"__arrow ").concat(Ns,"__prev-button"),disabled:$,onClick:ce,type:"button",children:F}),Te(),S!==null&&l.jsx("button",{"aria-label":y,className:"".concat(Ns,"__arrow ").concat(Ns,"__next-button"),disabled:W,onClick:he,type:"button",children:S}),m!==null&&I?l.jsx("button",{"aria-label":b,className:"".concat(Ns,"__arrow ").concat(Ns,"__next2-button"),disabled:ie,onClick:ge,type:"button",children:m}):null]})}var hd=function(){return hd=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},hd.apply(this,arguments)},JW=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function bk(e){return"".concat(e,"%")}function Y5(e){var t=e.children,n=e.className,a=e.count,r=e.direction,i=e.offset,s=e.style,o=e.wrap,u=JW(e,["children","className","count","direction","offset","style","wrap"]);return l.jsx("div",hd({className:n,style:hd({display:"flex",flexDirection:r,flexWrap:o?"wrap":"nowrap"},s)},u,{children:ae.Children.map(t,function(c,d){var h=i&&d===0?bk(100*i/a):null;return ae.cloneElement(c,hd(hd({},c.props),{style:{flexBasis:bk(100/a),flexShrink:0,flexGrow:0,overflow:"hidden",marginLeft:h,marginInlineStart:h,marginInlineEnd:0}}))})}))}function QW(e,t,n){return t&&t>e?t:n&&n<e?n:e}function sp(e,t){return t[0]<=e&&t[1]>=e}function ZW(e,t){return e[0]<=t[0]&&e[1]>=t[1]}function VE(e,t){return sp(e[0],t)||sp(e[1],t)}function yk(e,t,n){var a=VE(t,e),r=[];if(a){r.push(n);var i=sp(e[0],t),s=sp(e[1],t);i&&r.push("".concat(n,"Start")),s&&r.push("".concat(n,"End")),i&&s&&r.push("".concat(n,"BothEnds"))}return r}function eH(e){return Array.isArray(e)?e[0]!==null&&e[1]!==null:e!==null}function tH(e){if(!e)throw new Error("args is required");var t=e.value,n=e.date,a=e.hover,r="react-calendar__tile",i=[r];if(!n)return i;var s=new Date,o=function(){if(Array.isArray(n))return n;var f=e.dateType;if(!f)throw new Error("dateType is required when date is not an array of two dates");return xk(f,n)}();if(sp(s,o)&&i.push("".concat(r,"--now")),!t||!eH(t))return i;var u=function(){if(Array.isArray(t))return t;var f=e.valueType;if(!f)throw new Error("valueType is required when value is not an array of two dates");return xk(f,t)}();ZW(u,o)?i.push("".concat(r,"--active")):VE(u,o)&&i.push("".concat(r,"--hasActive"));var c=yk(u,o,"".concat(r,"--range"));i.push.apply(i,c);var d=Array.isArray(t)?t:[t];if(a&&d.length===1){var h=a>u[0]?[u[0],a]:[a,u[0]],p=yk(h,o,"".concat(r,"--hover"));i.push.apply(i,p)}return i}function rx(e){for(var t=e.className,n=e.count,a=n===void 0?3:n,r=e.dateTransform,i=e.dateType,s=e.end,o=e.hover,u=e.offset,c=e.renderTile,d=e.start,h=e.step,p=h===void 0?1:h,f=e.value,g=e.valueType,b=[],w=d;w<=s;w+=p){var m=r(w);b.push(c({classes:tH({date:m,dateType:i,hover:o,value:f,valueType:g}),date:m}))}return l.jsx(Y5,{className:t,count:a,offset:u,wrap:!0,children:b})}function ix(e){var t=e.activeStartDate,n=e.children,a=e.classes,r=e.date,i=e.formatAbbr,s=e.locale,o=e.maxDate,u=e.maxDateTransform,c=e.minDate,d=e.minDateTransform,h=e.onClick,p=e.onMouseOver,f=e.style,g=e.tileClassName,b=e.tileContent,w=e.tileDisabled,m=e.view,x=ae.useMemo(function(){var N={activeStartDate:t,date:r,view:m};return typeof g=="function"?g(N):g},[t,r,g,m]),y=ae.useMemo(function(){var N={activeStartDate:t,date:r,view:m};return typeof b=="function"?b(N):b},[t,r,b,m]);return l.jsxs("button",{className:Zv(a,x),disabled:c&&d(c)>r||o&&u(o)<r||(w==null?void 0:w({activeStartDate:t,date:r,view:m})),onClick:h?function(N){return h(r,N)}:void 0,onFocus:p?function(){return p(r)}:void 0,onMouseOver:p?function(){return p(r)}:void 0,style:f,type:"button",children:[i?l.jsx("abbr",{"aria-label":i(s,r),children:n}):n,y]})}var t2=function(){return t2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},t2.apply(this,arguments)},nH=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n},wk="react-calendar__century-view__decades__decade";function aH(e){var t=e.classes,n=t===void 0?[]:t,a=e.currentCentury,r=e.formatYear,i=r===void 0?ax:r,s=nH(e,["classes","currentCentury","formatYear"]),o=s.date,u=s.locale,c=[];return n&&c.push.apply(c,n),c.push(wk),hh(o).getFullYear()!==a&&c.push("".concat(wk,"--neighboringCentury")),l.jsx(ix,t2({},s,{classes:c,maxDateTransform:tx,minDateTransform:Zl,view:"century",children:WE(u,i,o)}))}var n2=function(){return n2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n2.apply(this,arguments)},Nk=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function rH(e){var t=e.activeStartDate,n=e.hover,a=e.showNeighboringCentury,r=e.value,i=e.valueType,s=Nk(e,["activeStartDate","hover","showNeighboringCentury","value","valueType"]),o=BW(t),u=o+(a?119:99);return l.jsx(rx,{className:"react-calendar__century-view__decades",dateTransform:Zl,dateType:"decade",end:u,hover:n,renderTile:function(c){var d=c.date,h=Nk(c,["date"]);return l.jsx(aH,n2({},s,h,{activeStartDate:t,currentCentury:o,date:d}),d.getTime())},start:o,step:10,value:r,valueType:i})}var a2=function(){return a2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},a2.apply(this,arguments)};function iH(e){function t(){return l.jsx(rH,a2({},e))}return l.jsx("div",{className:"react-calendar__century-view",children:t()})}var r2=function(){return r2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r2.apply(this,arguments)},sH=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n},kk="react-calendar__decade-view__years__year";function oH(e){var t=e.classes,n=t===void 0?[]:t,a=e.currentDecade,r=e.formatYear,i=r===void 0?ax:r,s=sH(e,["classes","currentDecade","formatYear"]),o=s.date,u=s.locale,c=[];return n&&c.push.apply(c,n),c.push(kk),Zl(o).getFullYear()!==a&&c.push("".concat(kk,"--neighboringDecade")),l.jsx(ix,r2({},s,{classes:c,maxDateTransform:nx,minDateTransform:fh,view:"decade",children:i(u,o)}))}var i2=function(){return i2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i2.apply(this,arguments)},Sk=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function lH(e){var t=e.activeStartDate,n=e.hover,a=e.showNeighboringDecade,r=e.value,i=e.valueType,s=Sk(e,["activeStartDate","hover","showNeighboringDecade","value","valueType"]),o=zW(t),u=o+(a?11:9);return l.jsx(rx,{className:"react-calendar__decade-view__years",dateTransform:fh,dateType:"year",end:u,hover:n,renderTile:function(c){var d=c.date,h=Sk(c,["date"]);return l.jsx(oH,i2({},s,h,{activeStartDate:t,currentDecade:o,date:d}),d.getTime())},start:o,value:r,valueType:i})}var s2=function(){return s2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},s2.apply(this,arguments)};function uH(e){function t(){return l.jsx(lH,s2({},e))}return l.jsx("div",{className:"react-calendar__decade-view",children:t()})}var o2=function(){return o2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o2.apply(this,arguments)},cH=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n},_k=function(e,t,n){if(n||arguments.length===2)for(var a=0,r=t.length,i;a<r;a++)(i||!(a in t))&&(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))},dH="react-calendar__year-view__months__month";function hH(e){var t=e.classes,n=t===void 0?[]:t,a=e.formatMonth,r=a===void 0?RW:a,i=e.formatMonthYear,s=i===void 0?BE:i,o=cH(e,["classes","formatMonth","formatMonthYear"]),u=o.date,c=o.locale;return l.jsx(ix,o2({},o,{classes:_k(_k([],n,!0),[dH],!1),formatAbbr:s,maxDateTransform:Vp,minDateTransform:oc,view:"year",children:r(c,u)}))}var l2=function(){return l2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},l2.apply(this,arguments)},jk=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function fH(e){var t=e.activeStartDate,n=e.hover,a=e.value,r=e.valueType,i=jk(e,["activeStartDate","hover","value","valueType"]),s=0,o=11,u=On(t);return l.jsx(rx,{className:"react-calendar__year-view__months",dateTransform:function(c){var d=new Date;return d.setFullYear(u,c,1),oc(d)},dateType:"month",end:o,hover:n,renderTile:function(c){var d=c.date,h=jk(c,["date"]);return l.jsx(hH,l2({},i,h,{activeStartDate:t,date:d}),d.getTime())},start:s,value:a,valueType:r})}var u2=function(){return u2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},u2.apply(this,arguments)};function pH(e){function t(){return l.jsx(fH,u2({},e))}return l.jsx("div",{className:"react-calendar__year-view",children:t()})}var c2=function(){return c2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},c2.apply(this,arguments)},mH=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n},d1="react-calendar__month-view__days__day";function gH(e){var t=e.calendarType,n=e.classes,a=n===void 0?[]:n,r=e.currentMonthIndex,i=e.formatDay,s=i===void 0?LW:i,o=e.formatLongDate,u=o===void 0?PW:o,c=mH(e,["calendarType","classes","currentMonthIndex","formatDay","formatLongDate"]),d=c.date,h=c.locale,p=[];return a&&p.push.apply(p,a),p.push(d1),HE(d,t)&&p.push("".concat(d1,"--weekend")),d.getMonth()!==r&&p.push("".concat(d1,"--neighboringMonth")),l.jsx(ix,c2({},c,{classes:p,formatAbbr:u,maxDateTransform:$5,minDateTransform:Gp,view:"month",children:s(h,d)}))}var d2=function(){return d2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},d2.apply(this,arguments)},Ck=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function vH(e){var t=e.activeStartDate,n=e.calendarType,a=e.hover,r=e.showFixedNumberOfWeeks,i=e.showNeighboringMonth,s=e.value,o=e.valueType,u=Ck(e,["activeStartDate","calendarType","hover","showFixedNumberOfWeeks","showNeighboringMonth","value","valueType"]),c=On(t),d=Ql(t),h=r||i,p=ip(t,n),f=h?0:p,g=(h?-p:0)+1,b=function(){if(r)return g+6*7-1;var w=FE(t);if(i){var m=new Date;m.setFullYear(c,d,w),m.setHours(0,0,0,0);var x=7-ip(m,n)-1;return w+x}return w}();return l.jsx(rx,{className:"react-calendar__month-view__days",count:7,dateTransform:function(w){var m=new Date;return m.setFullYear(c,d,w),Gp(m)},dateType:"day",hover:a,end:b,renderTile:function(w){var m=w.date,x=Ck(w,["date"]);return l.jsx(gH,d2({},u,x,{activeStartDate:t,calendarType:n,currentMonthIndex:d,date:m}),m.getTime())},offset:f,start:g,value:s,valueType:o})}var GE="react-calendar__month-view__weekdays",h1="".concat(GE,"__weekday");function xH(e){for(var t=e.calendarType,n=e.formatShortWeekday,a=n===void 0?MW:n,r=e.formatWeekday,i=r===void 0?OW:r,s=e.locale,o=e.onMouseLeave,u=new Date,c=oc(u),d=On(c),h=Ql(c),p=[],f=1;f<=7;f+=1){var g=new Date(d,h,f-ip(c,t)),b=i(s,g);p.push(l.jsx("div",{className:Zv(h1,YW(g)&&"".concat(h1,"--current"),HE(g,t)&&"".concat(h1,"--weekend")),children:l.jsx("abbr",{"aria-label":b,title:b,children:a(s,g).replace(".","")})},f))}return l.jsx(Y5,{className:GE,count:7,onFocus:o,onMouseOver:o,children:p})}var X0=function(){return X0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},X0.apply(this,arguments)},Ak=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n},Ek="react-calendar__tile";function bH(e){var t=e.onClickWeekNumber,n=e.weekNumber,a=l.jsx("span",{children:n});if(t){var r=e.date,i=e.onClickWeekNumber,s=e.weekNumber,o=Ak(e,["date","onClickWeekNumber","weekNumber"]);return l.jsx("button",X0({},o,{className:Ek,onClick:function(u){return i(s,r,u)},type:"button",children:a}))}else{e.date,e.onClickWeekNumber,e.weekNumber;var o=Ak(e,["date","onClickWeekNumber","weekNumber"]);return l.jsx("div",X0({},o,{className:Ek,children:a}))}}function yH(e){var t=e.activeStartDate,n=e.calendarType,a=e.onClickWeekNumber,r=e.onMouseLeave,i=e.showFixedNumberOfWeeks,s=function(){if(i)return 6;var c=FE(t),d=ip(t,n),h=c-(7-d);return 1+Math.ceil(h/7)}(),o=function(){for(var c=On(t),d=Ql(t),h=ex(t),p=[],f=0;f<s;f+=1)p.push(e2(new Date(c,d,h+f*7),n));return p}(),u=o.map(function(c){return UW(c,n)});return l.jsx(Y5,{className:"react-calendar__month-view__weekNumbers",count:s,direction:"column",onFocus:r,onMouseOver:r,style:{flexBasis:"calc(100% * (1 / 8)",flexShrink:0},children:u.map(function(c,d){var h=o[d];if(!h)throw new Error("date is not defined");return l.jsx(bH,{date:h,onClickWeekNumber:a,weekNumber:c},c)})})}var h2=function(){return h2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h2.apply(this,arguments)},wH=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function NH(e){if(e)for(var t=0,n=Object.entries(NW);t<n.length;t++){var a=n[t],r=a[0],i=a[1];if(i.includes(e))return r}return Ya.ISO_8601}function kH(e){var t=e.activeStartDate,n=e.locale,a=e.onMouseLeave,r=e.showFixedNumberOfWeeks,i=e.calendarType,s=i===void 0?NH(n):i,o=e.formatShortWeekday,u=e.formatWeekday,c=e.onClickWeekNumber,d=e.showWeekNumbers,h=wH(e,["calendarType","formatShortWeekday","formatWeekday","onClickWeekNumber","showWeekNumbers"]);function p(){return l.jsx(xH,{calendarType:s,formatShortWeekday:o,formatWeekday:u,locale:n,onMouseLeave:a})}function f(){return d?l.jsx(yH,{activeStartDate:t,calendarType:s,onClickWeekNumber:c,onMouseLeave:a,showFixedNumberOfWeeks:r}):null}function g(){return l.jsx(vH,h2({calendarType:s},h))}var b="react-calendar__month-view";return l.jsx("div",{className:Zv(b,d?"".concat(b,"--weekNumbers"):""),children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-end"},children:[f(),l.jsxs("div",{style:{flexGrow:1,width:"100%"},children:[p(),g()]})]})})}var fd=function(){return fd=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},fd.apply(this,arguments)},pg="react-calendar",Ig=["century","decade","year","month"],SH=["decade","year","month","day"],X5=new Date;X5.setFullYear(1,0,1);X5.setHours(0,0,0,0);var _H=new Date(864e13);function uf(e){return e instanceof Date?e:new Date(e)}function $E(e,t){return Ig.slice(Ig.indexOf(e),Ig.indexOf(t)+1)}function jH(e,t,n){var a=$E(t,n);return a.indexOf(e)!==-1}function J5(e,t,n){return e&&jH(e,t,n)?e:n}function KE(e){var t=Ig.indexOf(e);return SH[t]}function CH(e,t){var n=Array.isArray(e)?e[t]:e;if(!n)return null;var a=uf(n);if(Number.isNaN(a.getTime()))throw new Error("Invalid date: ".concat(e));return a}function YE(e,t){var n=e.value,a=e.minDate,r=e.maxDate,i=e.maxDetail,s=CH(n,t);if(!s)return null;var o=KE(i),u=function(){switch(t){case 0:return Mu(o,s);case 1:return UE(o,s);default:throw new Error("Invalid index value: ".concat(t))}}();return QW(u,a,r)}var Q5=function(e){return YE(e,0)},XE=function(e){return YE(e,1)},AH=function(e){return[Q5,XE].map(function(t){return t(e)})};function JE(e){var t=e.maxDate,n=e.maxDetail,a=e.minDate,r=e.minDetail,i=e.value,s=e.view,o=J5(s,r,n),u=Q5({value:i,minDate:a,maxDate:t,maxDetail:n})||new Date;return Mu(o,u)}function EH(e){var t=e.activeStartDate,n=e.defaultActiveStartDate,a=e.defaultValue,r=e.defaultView,i=e.maxDate,s=e.maxDetail,o=e.minDate,u=e.minDetail,c=e.value,d=e.view,h=J5(d,u,s),p=t||n;return p?Mu(h,p):JE({maxDate:i,maxDetail:s,minDate:o,minDetail:u,value:c||a,view:d||r})}function f1(e){return e&&(!Array.isArray(e)||e.length===1)}function mg(e,t){return e instanceof Date&&t instanceof Date&&e.getTime()===t.getTime()}var DH=ae.forwardRef(function(t,n){var a=t.activeStartDate,r=t.allowPartialRange,i=t.calendarType,s=t.className,o=t.defaultActiveStartDate,u=t.defaultValue,c=t.defaultView,d=t.formatDay,h=t.formatLongDate,p=t.formatMonth,f=t.formatMonthYear,g=t.formatShortWeekday,b=t.formatWeekday,w=t.formatYear,m=t.goToRangeStartOnSelect,x=m===void 0?!0:m,y=t.inputRef,N=t.locale,S=t.maxDate,D=S===void 0?_H:S,_=t.maxDetail,A=_===void 0?"month":_,L=t.minDate,P=L===void 0?X5:L,j=t.minDetail,E=j===void 0?"century":j,F=t.navigationAriaLabel,z=t.navigationAriaLive,U=t.navigationLabel,O=t.next2AriaLabel,B=t.next2Label,q=t.nextAriaLabel,I=t.nextLabel,K=t.onActiveStartDateChange,Z=t.onChange,R=t.onClickDay,H=t.onClickDecade,$=t.onClickMonth,X=t.onClickWeekNumber,W=t.onClickYear,ie=t.onDrillDown,ce=t.onDrillUp,ue=t.onViewChange,he=t.prev2AriaLabel,ge=t.prev2Label,Ee=t.prevAriaLabel,Te=t.prevLabel,fe=t.returnValue,me=fe===void 0?"start":fe,ne=t.selectRange,De=t.showDoubleView,Oe=t.showFixedNumberOfWeeks,ke=t.showNavigation,xe=ke===void 0?!0:ke,Ae=t.showNeighboringCentury,Ce=t.showNeighboringDecade,He=t.showNeighboringMonth,Qe=He===void 0?!0:He,Ze=t.showWeekNumbers,Je=t.tileClassName,le=t.tileContent,Xe=t.tileDisabled,We=t.value,et=t.view,Ke=ae.useState(o),Ht=Ke[0],xt=Ke[1],Xn=ae.useState(null),Mt=Xn[0],xn=Xn[1],Gr=ae.useState(Array.isArray(u)?u.map(function(St){return St!==null?uf(St):null}):u!=null?uf(u):null),Vt=Gr[0],Js=Gr[1],Cn=ae.useState(c),$r=Cn[0],Ni=Cn[1],It=a||Ht||EH({activeStartDate:a,defaultActiveStartDate:o,defaultValue:u,defaultView:c,maxDate:D,maxDetail:A,minDate:P,minDetail:E,value:We,view:et}),mt=function(){var St=function(){return ne&&f1(Vt)?Vt:We!==void 0?We:Vt}();return St?Array.isArray(St)?St.map(function(Wt){return Wt!==null?uf(Wt):null}):St!==null?uf(St):null:null}(),qt=KE(A),Qt=J5(et||$r,E,A),pn=$E(E,A),ki=ne?Mt:null,kr=pn.indexOf(Qt)<pn.length-1,vt=pn.indexOf(Qt)>0,Sr=ae.useCallback(function(St){var Wt=function(){switch(me){case"start":return Q5;case"end":return XE;case"range":return AH;default:throw new Error("Invalid returnValue.")}}();return Wt({maxDate:D,maxDetail:A,minDate:P,value:St})},[D,A,P,me]),_r=ae.useCallback(function(St,Wt){xt(St);var Zt={action:Wt,activeStartDate:St,value:mt,view:Qt};K&&!mg(It,St)&&K(Zt)},[It,K,mt,Qt]),pa=ae.useCallback(function(St,Wt){var Zt=function(){switch(Qt){case"century":return H;case"decade":return W;case"year":return $;case"month":return R;default:throw new Error("Invalid view: ".concat(Qt,"."))}}();Zt&&Zt(St,Wt)},[R,H,$,W,Qt]),In=ae.useCallback(function(St,Wt){if(kr){pa(St,Wt);var Zt=pn[pn.indexOf(Qt)+1];if(!Zt)throw new Error("Attempted to drill down from the lowest view.");xt(St),Ni(Zt);var ma={action:"drillDown",activeStartDate:St,value:mt,view:Zt};K&&!mg(It,St)&&K(ma),ue&&Qt!==Zt&&ue(ma),ie&&ie(ma)}},[It,kr,K,pa,ie,ue,mt,Qt,pn]),Tn=ae.useCallback(function(){if(vt){var St=pn[pn.indexOf(Qt)-1];if(!St)throw new Error("Attempted to drill up from the highest view.");var Wt=Mu(St,It);xt(Wt),Ni(St);var Zt={action:"drillUp",activeStartDate:Wt,value:mt,view:St};K&&!mg(It,Wt)&&K(Zt),ue&&Qt!==St&&ue(Zt),ce&&ce(Zt)}},[It,vt,K,ce,ue,mt,Qt,pn]),Ua=ae.useCallback(function(St,Wt){var Zt=mt;pa(St,Wt);var ma=ne&&!f1(Zt),Aa;if(ne)if(ma)Aa=Mu(qt,St);else{if(!Zt)throw new Error("previousValue is required");if(Array.isArray(Zt))throw new Error("previousValue must not be an array");Aa=$W(qt,Zt,St)}else Aa=Sr(St);var ms=!ne||ma||x?JE({maxDate:D,maxDetail:A,minDate:P,minDetail:E,value:Aa,view:Qt}):null;Wt.persist(),xt(ms),Js(Aa);var Bo={action:"onChange",activeStartDate:ms,value:Aa,view:Qt};if(K&&!mg(It,ms)&&K(Bo),Z)if(ne){var zo=f1(Aa);if(!zo)Z(Aa||null,Wt);else if(r){if(Array.isArray(Aa))throw new Error("value must not be an array");Z([Aa||null,null],Wt)}}else Z(Aa||null,Wt)},[It,r,Sr,x,D,A,P,E,K,Z,pa,ne,mt,qt,Qt]);function Fo(St){xn(St)}function Kr(){xn(null)}ae.useImperativeHandle(n,function(){return{activeStartDate:It,drillDown:In,drillUp:Tn,onChange:Ua,setActiveStartDate:_r,value:mt,view:Qt}},[It,In,Tn,Ua,_r,mt,Qt]);function jr(St){var Wt=St?zE(Qt,It):Mu(Qt,It),Zt=kr?In:Ua,ma={activeStartDate:Wt,hover:ki,locale:N,maxDate:D,minDate:P,onClick:Zt,onMouseOver:ne?Fo:void 0,tileClassName:Je,tileContent:le,tileDisabled:Xe,value:mt,valueType:qt};switch(Qt){case"century":return l.jsx(iH,fd({formatYear:w,showNeighboringCentury:Ae},ma));case"decade":return l.jsx(uH,fd({formatYear:w,showNeighboringDecade:Ce},ma));case"year":return l.jsx(pH,fd({formatMonth:p,formatMonthYear:f},ma));case"month":return l.jsx(kH,fd({calendarType:i,formatDay:d,formatLongDate:h,formatShortWeekday:g,formatWeekday:b,onClickWeekNumber:X,onMouseLeave:ne?Kr:void 0,showFixedNumberOfWeeks:typeof Oe<"u"?Oe:De,showNeighboringMonth:Qe,showWeekNumbers:Ze},ma));default:throw new Error("Invalid view: ".concat(Qt,"."))}}function Yr(){return xe?l.jsx(XW,{activeStartDate:It,drillUp:Tn,formatMonthYear:f,formatYear:w,locale:N,maxDate:D,minDate:P,navigationAriaLabel:F,navigationAriaLive:z,navigationLabel:U,next2AriaLabel:O,next2Label:B,nextAriaLabel:q,nextLabel:I,prev2AriaLabel:he,prev2Label:ge,prevAriaLabel:Ee,prevLabel:Te,setActiveStartDate:_r,showDoubleView:De,view:Qt,views:pn}):null}var Xr=Array.isArray(mt)?mt:[mt];return l.jsxs("div",{className:Zv(pg,ne&&Xr.length===1&&"".concat(pg,"--selectRange"),De&&"".concat(pg,"--doubleView"),s),ref:y,children:[Yr(),l.jsxs("div",{className:"".concat(pg,"__viewContainer"),onBlur:ne?Kr:void 0,onMouseLeave:ne?Kr:void 0,children:[jr(),De?jr(!0):null]})]})});const QE=6048e5,TH=864e5,Dk=Symbol.for("constructDateFrom");function Hs(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Dk in e?e[Dk](t):e instanceof Date?new e.constructor(t):new Date(t)}function Hr(e,t){return Hs(t||e,e)}function Tk(e,t){const n=Hr(e,t==null?void 0:t.in).getDay();return n===0||n===6}let LH={};function sx(){return LH}function op(e,t){var o,u,c,d;const n=sx(),a=(t==null?void 0:t.weekStartsOn)??((u=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((d=(c=n.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,r=Hr(e,t==null?void 0:t.in),i=r.getDay(),s=(i<a?7:0)+i-a;return r.setDate(r.getDate()-s),r.setHours(0,0,0,0),r}function J0(e,t){return op(e,{...t,weekStartsOn:1})}function ZE(e,t){const n=Hr(e,t==null?void 0:t.in),a=n.getFullYear(),r=Hs(n,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const i=J0(r),s=Hs(n,0);s.setFullYear(a,0,4),s.setHours(0,0,0,0);const o=J0(s);return n.getTime()>=i.getTime()?a+1:n.getTime()>=o.getTime()?a:a-1}function Lk(e){const t=Hr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function eD(e,...t){const n=Hs.bind(null,t.find(a=>typeof a=="object"));return t.map(n)}function Q0(e,t){const n=Hr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function PH(e,t,n){const[a,r]=eD(n==null?void 0:n.in,e,t),i=Q0(a),s=Q0(r),o=+i-Lk(i),u=+s-Lk(s);return Math.round((o-u)/TH)}function RH(e,t){const n=ZE(e,t),a=Hs(e,0);return a.setFullYear(n,0,4),a.setHours(0,0,0,0),J0(a)}function MH(e){return Hs(e,Date.now())}function OH(e,t,n){const[a,r]=eD(n==null?void 0:n.in,e,t);return+Q0(a)==+Q0(r)}function IH(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function FH(e){return!(!IH(e)&&typeof e!="number"||isNaN(+Hr(e)))}function BH(e,t){const n=Hr(e,t==null?void 0:t.in),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}function zH(e,t){const n=Hr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function UH(e,t){const n=Hr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const qH={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},WH=(e,t,n)=>{let a;const r=qH[e];return typeof r=="string"?a=r:t===1?a=r.one:a=r.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};function Td(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const HH={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},VH={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},GH={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$H={date:Td({formats:HH,defaultWidth:"full"}),time:Td({formats:VH,defaultWidth:"full"}),dateTime:Td({formats:GH,defaultWidth:"full"})},KH={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},YH=(e,t,n,a)=>KH[e];function Ds(e){return(t,n)=>{const a=n!=null&&n.context?String(n.context):"standalone";let r;if(a==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):s;r=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;r=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return r[i]}}const XH={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},JH={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},QH={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ZH={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nV=(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},aV={ordinalNumber:nV,era:Ds({values:XH,defaultWidth:"wide"}),quarter:Ds({values:JH,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ds({values:QH,defaultWidth:"wide"}),day:Ds({values:ZH,defaultWidth:"wide"}),dayPeriod:Ds({values:eV,defaultWidth:"wide",formattingValues:tV,defaultFormattingWidth:"wide"})};function Ts(e){return(t,n={})=>{const a=n.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(r);if(!i)return null;const s=i[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(o)?iV(o,h=>h.test(s)):rV(o,h=>h.test(s));let c;c=e.valueCallback?e.valueCallback(u):u,c=n.valueCallback?n.valueCallback(c):c;const d=t.slice(s.length);return{value:c,rest:d}}}function rV(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function iV(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function tD(e){return(t,n={})=>{const a=t.match(e.matchPattern);if(!a)return null;const r=a[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=n.valueCallback?n.valueCallback(s):s;const o=t.slice(r.length);return{value:s,rest:o}}}const sV=/^(\d+)(th|st|nd|rd)?/i,oV=/\d+/i,lV={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},uV={any:[/^b/i,/^(a|c)/i]},cV={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},dV={any:[/1/i,/2/i,/3/i,/4/i]},hV={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fV={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},pV={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},mV={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},gV={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},vV={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xV={ordinalNumber:tD({matchPattern:sV,parsePattern:oV,valueCallback:e=>parseInt(e,10)}),era:Ts({matchPatterns:lV,defaultMatchWidth:"wide",parsePatterns:uV,defaultParseWidth:"any"}),quarter:Ts({matchPatterns:cV,defaultMatchWidth:"wide",parsePatterns:dV,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ts({matchPatterns:hV,defaultMatchWidth:"wide",parsePatterns:fV,defaultParseWidth:"any"}),day:Ts({matchPatterns:pV,defaultMatchWidth:"wide",parsePatterns:mV,defaultParseWidth:"any"}),dayPeriod:Ts({matchPatterns:gV,defaultMatchWidth:"any",parsePatterns:vV,defaultParseWidth:"any"})},bV={code:"en-US",formatDistance:WH,formatLong:$H,formatRelative:YH,localize:aV,match:xV,options:{weekStartsOn:0,firstWeekContainsDate:1}};function yV(e,t){const n=Hr(e,t==null?void 0:t.in);return PH(n,UH(n))+1}function wV(e,t){const n=Hr(e,t==null?void 0:t.in),a=+J0(n)-+RH(n);return Math.round(a/QE)+1}function nD(e,t){var d,h,p,f;const n=Hr(e,t==null?void 0:t.in),a=n.getFullYear(),r=sx(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,s=Hs((t==null?void 0:t.in)||e,0);s.setFullYear(a+1,0,i),s.setHours(0,0,0,0);const o=op(s,t),u=Hs((t==null?void 0:t.in)||e,0);u.setFullYear(a,0,i),u.setHours(0,0,0,0);const c=op(u,t);return+n>=+o?a+1:+n>=+c?a:a-1}function NV(e,t){var o,u,c,d;const n=sx(),a=(t==null?void 0:t.firstWeekContainsDate)??((u=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(c=n.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,r=nD(e,t),i=Hs((t==null?void 0:t.in)||e,0);return i.setFullYear(r,0,a),i.setHours(0,0,0,0),op(i,t)}function kV(e,t){const n=Hr(e,t==null?void 0:t.in),a=+op(n,t)-+NV(n,t);return Math.round(a/QE)+1}function un(e,t){const n=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return n+a}const rl={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return un(t==="yy"?a%100:a,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):un(n+1,2)},d(e,t){return un(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return un(e.getHours()%12||12,t.length)},H(e,t){return un(e.getHours(),t.length)},m(e,t){return un(e.getMinutes(),t.length)},s(e,t){return un(e.getSeconds(),t.length)},S(e,t){const n=t.length,a=e.getMilliseconds(),r=Math.trunc(a*Math.pow(10,n-3));return un(r,t.length)}},Uc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Pk={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});case"GGGG":default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const a=e.getFullYear(),r=a>0?a:1-a;return n.ordinalNumber(r,{unit:"year"})}return rl.y(e,t)},Y:function(e,t,n,a){const r=nD(e,a),i=r>0?r:1-r;if(t==="YY"){const s=i%100;return un(s,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):un(i,t.length)},R:function(e,t){const n=ZE(e);return un(n,t.length)},u:function(e,t){const n=e.getFullYear();return un(n,t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return un(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return un(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return rl.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return un(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const r=kV(e,a);return t==="wo"?n.ordinalNumber(r,{unit:"week"}):un(r,t.length)},I:function(e,t,n){const a=wV(e);return t==="Io"?n.ordinalNumber(a,{unit:"week"}):un(a,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):rl.d(e,t)},D:function(e,t,n){const a=yV(e);return t==="Do"?n.ordinalNumber(a,{unit:"dayOfYear"}):un(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});case"EEEE":default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const r=e.getDay(),i=(r-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return un(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const r=e.getDay(),i=(r-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return un(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),r=a===0?7:a;switch(t){case"i":return String(r);case"ii":return un(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});case"iiii":default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let r;switch(a===12?r=Uc.noon:a===0?r=Uc.midnight:r=a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let r;switch(a>=17?r=Uc.evening:a>=12?r=Uc.afternoon:a>=4?r=Uc.morning:r=Uc.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),n.ordinalNumber(a,{unit:"hour"})}return rl.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):rl.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return t==="Ko"?n.ordinalNumber(a,{unit:"hour"}):un(a,t.length)},k:function(e,t,n){let a=e.getHours();return a===0&&(a=24),t==="ko"?n.ordinalNumber(a,{unit:"hour"}):un(a,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):rl.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):rl.s(e,t)},S:function(e,t){return rl.S(e,t)},X:function(e,t,n){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return Mk(a);case"XXXX":case"XX":return bu(a);case"XXXXX":case"XXX":default:return bu(a,":")}},x:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"x":return Mk(a);case"xxxx":case"xx":return bu(a);case"xxxxx":case"xxx":default:return bu(a,":")}},O:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Rk(a,":");case"OOOO":default:return"GMT"+bu(a,":")}},z:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Rk(a,":");case"zzzz":default:return"GMT"+bu(a,":")}},t:function(e,t,n){const a=Math.trunc(+e/1e3);return un(a,t.length)},T:function(e,t,n){return un(+e,t.length)}};function Rk(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.trunc(a/60),i=a%60;return i===0?n+String(r):n+String(r)+t+un(i,2)}function Mk(e,t){return e%60===0?(e>0?"-":"+")+un(Math.abs(e)/60,2):bu(e,t)}function bu(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=un(Math.trunc(a/60),2),i=un(a%60,2);return n+r+t+i}const Ok=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},aD=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},SV=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],r=n[2];if(!r)return Ok(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Ok(a,t)).replace("{{time}}",aD(r,t))},_V={p:aD,P:SV},jV=/^D+$/,CV=/^Y+$/,AV=["D","DD","YY","YYYY"];function EV(e){return jV.test(e)}function DV(e){return CV.test(e)}function TV(e,t,n){const a=LV(e,t,n);if(console.warn(a),AV.includes(e))throw new RangeError(a)}function LV(e,t,n){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const PV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MV=/^'([^]*?)'?$/,OV=/''/g,IV=/[a-zA-Z]/;function gg(e,t,n){var d,h,p,f,g,b,w,m;const a=sx(),r=(n==null?void 0:n.locale)??a.locale??bV,i=(n==null?void 0:n.firstWeekContainsDate)??((h=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((f=(p=a.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,s=(n==null?void 0:n.weekStartsOn)??((b=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:b.weekStartsOn)??a.weekStartsOn??((m=(w=a.locale)==null?void 0:w.options)==null?void 0:m.weekStartsOn)??0,o=Hr(e,n==null?void 0:n.in);if(!FH(o))throw new RangeError("Invalid time value");let u=t.match(RV).map(x=>{const y=x[0];if(y==="p"||y==="P"){const N=_V[y];return N(x,r.formatLong)}return x}).join("").match(PV).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:FV(x)};if(Pk[y])return{isToken:!0,value:x};if(y.match(IV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});r.localize.preprocessor&&(u=r.localize.preprocessor(o,u));const c={firstWeekContainsDate:i,weekStartsOn:s,locale:r};return u.map(x=>{if(!x.isToken)return x.value;const y=x.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&DV(y)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&EV(y))&&TV(y,t,String(e));const N=Pk[y[0]];return N(o,y,r.localize,c)}).join("")}function FV(e){const t=e.match(MV);return t?t[1].replace(OV,"'"):e}function Ik(e,t){return OH(Hs(e,e),MH(e))}const BV={lessThanXSeconds:{one:"kurang dari 1 detik",other:"kurang dari {{count}} detik"},xSeconds:{one:"1 detik",other:"{{count}} detik"},halfAMinute:"setengah menit",lessThanXMinutes:{one:"kurang dari 1 menit",other:"kurang dari {{count}} menit"},xMinutes:{one:"1 menit",other:"{{count}} menit"},aboutXHours:{one:"sekitar 1 jam",other:"sekitar {{count}} jam"},xHours:{one:"1 jam",other:"{{count}} jam"},xDays:{one:"1 hari",other:"{{count}} hari"},aboutXWeeks:{one:"sekitar 1 minggu",other:"sekitar {{count}} minggu"},xWeeks:{one:"1 minggu",other:"{{count}} minggu"},aboutXMonths:{one:"sekitar 1 bulan",other:"sekitar {{count}} bulan"},xMonths:{one:"1 bulan",other:"{{count}} bulan"},aboutXYears:{one:"sekitar 1 tahun",other:"sekitar {{count}} tahun"},xYears:{one:"1 tahun",other:"{{count}} tahun"},overXYears:{one:"lebih dari 1 tahun",other:"lebih dari {{count}} tahun"},almostXYears:{one:"hampir 1 tahun",other:"hampir {{count}} tahun"}},zV=(e,t,n)=>{let a;const r=BV[e];return typeof r=="string"?a=r:t===1?a=r.one:a=r.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"dalam waktu "+a:a+" yang lalu":a},UV={full:"EEEE, d MMMM yyyy",long:"d MMMM yyyy",medium:"d MMM yyyy",short:"d/M/yyyy"},qV={full:"HH.mm.ss",long:"HH.mm.ss",medium:"HH.mm",short:"HH.mm"},WV={full:"{{date}} 'pukul' {{time}}",long:"{{date}} 'pukul' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},HV={date:Td({formats:UV,defaultWidth:"full"}),time:Td({formats:qV,defaultWidth:"full"}),dateTime:Td({formats:WV,defaultWidth:"full"})},VV={lastWeek:"eeee 'lalu pukul' p",yesterday:"'Kemarin pukul' p",today:"'Hari ini pukul' p",tomorrow:"'Besok pukul' p",nextWeek:"eeee 'pukul' p",other:"P"},GV=(e,t,n,a)=>VV[e],$V={narrow:["SM","M"],abbreviated:["SM","M"],wide:["Sebelum Masehi","Masehi"]},KV={narrow:["1","2","3","4"],abbreviated:["K1","K2","K3","K4"],wide:["Kuartal ke-1","Kuartal ke-2","Kuartal ke-3","Kuartal ke-4"]},YV={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"],wide:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]},XV={narrow:["M","S","S","R","K","J","S"],short:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],abbreviated:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],wide:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},JV={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},QV={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},ZV=(e,t)=>"ke-"+Number(e),eG={ordinalNumber:ZV,era:Ds({values:$V,defaultWidth:"wide"}),quarter:Ds({values:KV,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ds({values:YV,defaultWidth:"wide"}),day:Ds({values:XV,defaultWidth:"wide"}),dayPeriod:Ds({values:JV,defaultWidth:"wide",formattingValues:QV,defaultFormattingWidth:"wide"})},tG=/^ke-(\d+)?/i,nG=/\d+/i,aG={narrow:/^(sm|m)/i,abbreviated:/^(s\.?\s?m\.?|s\.?\s?e\.?\s?u\.?|m\.?|e\.?\s?u\.?)/i,wide:/^(sebelum masehi|sebelum era umum|masehi|era umum)/i},rG={any:[/^s/i,/^(m|e)/i]},iG={narrow:/^[1234]/i,abbreviated:/^K-?\s[1234]/i,wide:/^Kuartal ke-?\s?[1234]/i},sG={any:[/1/i,/2/i,/3/i,/4/i]},oG={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|mei|jun|jul|agt|sep|okt|nov|des)/i,wide:/^(januari|februari|maret|april|mei|juni|juli|agustus|september|oktober|november|desember)/i},lG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^ma/i,/^ap/i,/^me/i,/^jun/i,/^jul/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},uG={narrow:/^[srkjm]/i,short:/^(min|sen|sel|rab|kam|jum|sab)/i,abbreviated:/^(min|sen|sel|rab|kam|jum|sab)/i,wide:/^(minggu|senin|selasa|rabu|kamis|jumat|sabtu)/i},cG={narrow:[/^m/i,/^s/i,/^s/i,/^r/i,/^k/i,/^j/i,/^s/i],any:[/^m/i,/^sen/i,/^sel/i,/^r/i,/^k/i,/^j/i,/^sa/i]},dG={narrow:/^(a|p|tengah m|tengah h|(di(\swaktu)?) (pagi|siang|sore|malam))/i,any:/^([ap]\.?\s?m\.?|tengah malam|tengah hari|(di(\swaktu)?) (pagi|siang|sore|malam))/i},hG={any:{am:/^a/i,pm:/^pm/i,midnight:/^tengah m/i,noon:/^tengah h/i,morning:/pagi/i,afternoon:/siang/i,evening:/sore/i,night:/malam/i}},fG={ordinalNumber:tD({matchPattern:tG,parsePattern:nG,valueCallback:e=>parseInt(e,10)}),era:Ts({matchPatterns:aG,defaultMatchWidth:"wide",parsePatterns:rG,defaultParseWidth:"any"}),quarter:Ts({matchPatterns:iG,defaultMatchWidth:"wide",parsePatterns:sG,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ts({matchPatterns:oG,defaultMatchWidth:"wide",parsePatterns:lG,defaultParseWidth:"any"}),day:Ts({matchPatterns:uG,defaultMatchWidth:"wide",parsePatterns:cG,defaultParseWidth:"any"}),dayPeriod:Ts({matchPatterns:dG,defaultMatchWidth:"any",parsePatterns:hG,defaultParseWidth:"any"})},Fk={code:"id",formatDistance:zV,formatLong:HV,formatRelative:GV,localize:eG,match:fG,options:{weekStartsOn:1,firstWeekContainsDate:1}},rD=()=>{var B,q;const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState([]),[o,u]=ae.useState([]),[c,d]=ae.useState(!0),[h,p]=ae.useState([]),[f,g]=ae.useState(null),[b,w]=ae.useState("all"),[m,x]=ae.useState({startDate:"",endDate:"",type:"",status:"",employeeId:""});ae.useEffect(()=>{y()},[]),ae.useEffect(()=>{_()},[i,m,b]);const y=async()=>{try{const{data:{user:I}}=await Pe.auth.getUser();if(!I){e("/login");return}n(I);const{data:K,error:Z}=await Pe.from("profiles").select("role").eq("id",I.id).single();if(Z)throw Z;r(K.role),K.role==="admin"?(await N(),await S()):await D(I.id)}catch(I){console.error("Error checking user:",I),e("/login")}finally{d(!1)}},N=async()=>{try{const{data:I,error:K}=await Pe.from("profiles").select("id, name, email, employee_id, department").order("name");if(K)throw K;p(I||[])}catch(I){console.error("Error fetching employees:",I)}},S=async()=>{try{const{data:I,error:K}=await Pe.from("attendance").select(`
          *,
          profiles:user_id(id, name, email, employee_id, department)
        `).order("timestamp",{ascending:!1}).limit(500);if(K)throw K;s(I||[])}catch(I){console.error("Error fetching all attendance:",I)}},D=async I=>{try{const{data:K,error:Z}=await Pe.from("attendance").select("*").eq("user_id",I).order("timestamp",{ascending:!1});if(Z)throw Z;s(K||[])}catch(K){console.error("Error fetching attendance history:",K)}},_=()=>{let I=[...i];if(a==="admin"&&b!=="all"&&(I=I.filter(Z=>Z.user_id===b)),m.startDate&&(I=I.filter(Z=>new Date(Z.timestamp)>=new Date(m.startDate))),m.endDate){const Z=new Date(m.endDate);Z.setHours(23,59,59,999),I=I.filter(R=>new Date(R.timestamp)<=Z)}m.type&&(I=I.filter(Z=>Z.type===m.type)),m.status&&(I=I.filter(Z=>Z.status===m.status));const K=new Set;I=I.filter(Z=>{if(Z.status!=="tidak_hadir")return!0;const R=`${Z.timestamp}|${Z.status}|${Z.latitude||""}|${Z.longitude||""}`;return K.has(R)?!1:(K.add(R),!0)}),u(I)},A=I=>{x({...m,[I.target.name]:I.target.value})},L=I=>{w(I.target.value)},P=()=>{x({startDate:"",endDate:"",type:"",status:""}),w("all")},j=async()=>{d(!0),a==="admin"?await S():await D(t.id),d(!1)},E=()=>{if(o.length===0){ct.fire({icon:"info",title:"Tidak Ada Data",text:"Tidak ada data absensi untuk diexport."});return}try{const K=[a==="admin"?["Tanggal","Waktu","Karyawan","Departemen","Jenis","Status","Terlambat","Menit Terlambat","Jam Kerja","Lembur","Latitude","Longitude"]:["Tanggal","Waktu","Jenis","Status","Terlambat","Menit Terlambat","Jam Kerja","Lembur","Latitude","Longitude"],...o.map($=>{var ce,ue;const X=new Date($.timestamp),W=X.toLocaleDateString("id-ID"),ie=X.toLocaleTimeString("id-ID");return a==="admin"?[W,ie,((ce=$.profiles)==null?void 0:ce.name)||"Unknown",((ue=$.profiles)==null?void 0:ue.department)||"-",$.type==="masuk"?"Masuk":$.type==="keluar"?"Keluar":"Tidak Hadir",$.status,$.is_late?"Ya":"Tidak",$.late_minutes||"0",$.work_hours||"0",$.overtime_hours||"0",$.latitude||"",$.longitude||""]:[W,ie,$.type==="masuk"?"Masuk":$.type==="keluar"?"Keluar":"Tidak Hadir",$.status,$.is_late?"Ya":"Tidak",$.late_minutes||"0",$.work_hours||"0",$.overtime_hours||"0",$.latitude||"",$.longitude||""]})].map($=>$.join(",")).join(`
`),Z=new Blob([K],{type:"text/csv;charset=utf-8;"}),R=document.createElement("a"),H=URL.createObjectURL(Z);R.setAttribute("href",H),R.setAttribute("download",`attendance_report_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(H),ct.fire({icon:"success",title:"Export Berhasil",text:"Data absensi berhasil diexport ke CSV."})}catch{ct.fire({icon:"error",title:"Export Gagal",text:"Terjadi kesalahan saat export data absensi."})}},F=I=>{switch(I){case"berhasil":return"text-green-600 bg-green-100";case"wajah_tidak_valid":return"text-red-600 bg-red-100";case"lokasi_tidak_valid":return"text-yellow-600 bg-yellow-100";case"tidak_hadir":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},z=I=>{switch(I){case"berhasil":return l.jsx($t,{className:"h-4 w-4"});case"wajah_tidak_valid":case"lokasi_tidak_valid":return l.jsx(Rn,{className:"h-4 w-4"});case"tidak_hadir":return l.jsx(Rn,{className:"h-4 w-4"});default:return l.jsx(Pn,{className:"h-4 w-4"})}},U=I=>{switch(I){case"berhasil":return"Berhasil";case"wajah_tidak_valid":return"Wajah Invalid";case"lokasi_tidak_valid":return"Lokasi Invalid";case"tidak_hadir":return"Tidak Hadir";default:return"Gagal"}},O=I=>{const K=new Date(I);return{date:K.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}),time:K.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}};return c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data absensi..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between py-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>e(a==="admin"?"/admin":"/dashboard"),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:l.jsx(lS,{className:"h-5 w-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Laporan Absensi"}),l.jsx("p",{className:"text-sm text-blue-100",children:a==="admin"?"Lihat dan export laporan absensi semua karyawan":"Lihat dan export riwayat absensi Anda"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("button",{onClick:j,className:"flex items-center space-x-2 px-3 py-1.5 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-colors",title:"Refresh Data",children:[l.jsx(_2,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),l.jsxs("button",{onClick:E,disabled:o.length===0,className:"flex items-center space-x-2 px-4 py-2 bg-white text-blue-700 rounded-lg hover:bg-white/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(cp,{className:"h-4 w-4"}),l.jsx("span",{children:"Export CSV"})]})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-6",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(uS,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Filter Laporan"})]})}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"grid grid-cols-1 gap-4 md:hidden",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Absensi"}),l.jsxs("select",{name:"type",value:m.type,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Jenis"}),l.jsx("option",{value:"masuk",children:"Masuk"}),l.jsx("option",{value:"keluar",children:"Keluar"}),l.jsx("option",{value:"absent",children:"Tidak Hadir"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),l.jsxs("select",{name:"status",value:m.status,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"berhasil",children:"Berhasil"}),l.jsx("option",{value:"wajah_tidak_valid",children:"Wajah Invalid"}),l.jsx("option",{value:"lokasi_tidak_valid",children:"Lokasi Invalid"}),l.jsx("option",{value:"tidak_hadir",children:"Tidak Hadir"})]})]})]}),l.jsxs("div",{className:"hidden md:grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a==="admin"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Karyawan"}),l.jsxs("div",{className:"relative",children:[l.jsx(Fl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsxs("select",{value:b,onChange:L,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"Semua Karyawan"}),h.map(I=>l.jsxs("option",{value:I.id,children:[I.name," ",I.employee_id?`(${I.employee_id})`:""]},I.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal Mulai"}),l.jsx("input",{type:"date",name:"startDate",value:m.startDate,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal Akhir"}),l.jsx("input",{type:"date",name:"endDate",value:m.endDate,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Absensi"}),l.jsxs("select",{name:"type",value:m.type,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Jenis"}),l.jsx("option",{value:"masuk",children:"Masuk"}),l.jsx("option",{value:"keluar",children:"Keluar"}),l.jsx("option",{value:"absent",children:"Tidak Hadir"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),l.jsxs("select",{name:"status",value:m.status,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"berhasil",children:"Berhasil"}),l.jsx("option",{value:"wajah_tidak_valid",children:"Wajah Invalid"}),l.jsx("option",{value:"lokasi_tidak_valid",children:"Lokasi Invalid"}),l.jsx("option",{value:"tidak_hadir",children:"Tidak Hadir"})]})]})]}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx("button",{onClick:P,className:"px-4 py-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:"Reset Filter"})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Uu,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Data Absensi (",o.length,")"]})]}),a==="admin"&&l.jsx("div",{className:"text-sm text-gray-500",children:b==="all"?"Menampilkan semua karyawan":`Menampilkan ${((B=h.find(I=>I.id===b))==null?void 0:B.name)||"karyawan"}`})]})}),o.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal & Waktu"}),a==="admin"&&l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jenis"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterlambatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jam Kerja"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lokasi"})]})}),l.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[o.map(I=>{var Z,R;const K=O(I.timestamp);return l.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer transition",onClick:()=>g(I),children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.date}),l.jsx("div",{className:"text-sm text-gray-500",children:K.time})]})}),a==="admin"&&l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Z=I.profiles)==null?void 0:Z.name)||"Unknown"}),l.jsx("div",{className:"text-sm text-gray-500",children:((R=I.profiles)==null?void 0:R.department)||"-"})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize",children:I.type==="masuk"?"Masuk":I.type==="keluar"?"Keluar":"Tidak Hadir"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:`inline-flex items-center space-x-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${F(I.status)}`,children:[z(I.status),l.jsx("span",{children:U(I.status)})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.is_late?l.jsx("div",{className:"text-sm text-red-600",children:l.jsxs("span",{className:"font-medium",children:[I.late_minutes," menit"]})}):l.jsx("div",{className:"text-sm text-green-600",children:l.jsx("span",{className:"font-medium",children:"Tepat Waktu"})})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:I.work_hours>0?l.jsxs("span",{children:[I.work_hours," jam"]}):l.jsx("span",{children:"-"})}),I.overtime_hours>0&&l.jsxs("div",{className:"text-xs text-blue-600",children:["Lembur: ",I.overtime_hours," jam"]})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:I.latitude&&I.longitude?l.jsxs("div",{className:"flex items-center",children:[l.jsx(qi,{className:"h-4 w-4 mr-1 text-gray-400"}),l.jsxs("span",{children:[I.latitude.toFixed(4),", ",I.longitude.toFixed(4)]})]}):l.jsx("span",{className:"text-gray-400",children:"Tidak ada lokasi"})})]},I.id)}),f&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-6 relative animate-fade-in",children:[l.jsx("button",{onClick:()=>g(null),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",title:"Tutup",children:l.jsx(Rn,{className:"h-6 w-6"})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Detail Absensi"}),l.jsxs("div",{className:"mb-4 text-sm text-gray-500",children:[O(f.timestamp).date," • ",O(f.timestamp).time]}),l.jsxs("div",{className:"space-y-2",children:[a==="admin"&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Karyawan:"})," ",((q=f.profiles)==null?void 0:q.name)||"Unknown"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Jenis:"})," ",f.type==="masuk"?"Masuk":f.type==="keluar"?"Keluar":"Tidak Hadir"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Status:"})," ",l.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${F(f.status)}`,children:[z(f.status)," ",U(f.status)]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Keterlambatan:"})," ",f.is_late?`${f.late_minutes} menit`:"Tepat Waktu"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Jam Kerja:"})," ",f.work_hours>0?`${f.work_hours} jam`:"-"]}),f.overtime_hours>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Lembur:"})," ",f.overtime_hours," jam"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Lokasi:"})," ",f.latitude&&f.longitude?`${f.latitude.toFixed(4)}, ${f.longitude.toFixed(4)}`:"Tidak ada lokasi"]})]})]})})]})]})}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Uu,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada data absensi ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan filter atau periksa kembali nanti"})]})]})]})]})},pG=()=>{var Oe,ke;const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState([]),[o,u]=ae.useState(null),[c,d]=ae.useState([]),[h,p]=ae.useState({thisMonth:0,onTime:0,late:0,totalHours:0,expectedSalary:0,currentMonthSalary:0,dailySalaryEarned:0}),[f,g]=ae.useState(!0),[b,w]=ae.useState(!1),[m,x]=ae.useState(!1),[y,N]=ae.useState(!1),[S,D]=ae.useState(!0),[_,A]=ae.useState(new Date),[L,P]=ae.useState({}),[j,E]=ae.useState(!0),[F,z]=ae.useState(null);ae.useMemo(()=>(a==null?void 0:a.role)==="admin",[a==null?void 0:a.role]);const U=ae.useCallback(async()=>{try{const{data:{user:xe}}=await Pe.auth.getUser();if(!xe){e("/login");return}n(xe),await Pe.from("profiles").update({last_login:new Date().toISOString(),device_info:{user_agent:navigator.userAgent,timestamp:new Date().toISOString()}}).eq("id",xe.id),await Promise.all([O(xe.id),K(xe.id),B(xe.id),I(xe.id),$(),q(xe.id)]).then(()=>{xe&&X(xe.id,_)})}catch(xe){console.error("Error checking user:",xe),e("/login")}finally{g(!1)}},[e]);ae.useEffect(()=>{U()},[U]);const O=ae.useCallback(async xe=>{try{const{data:Ae,error:Ce}=await Pe.from("profiles").select(`
          *,
          positions(name_id, department, base_salary)
        `).eq("id",xe).maybeSingle();if(Ce&&Ce.code!=="PGRST116")throw Ce;if(Ae)r(Ae),Ae.role==="admin"&&e("/admin");else{const{data:He}=await Pe.auth.getUser();if(He.user){const Qe={id:xe,name:He.user.email.split("@")[0],full_name:He.user.email.split("@")[0],email:He.user.email,role:"karyawan",title:"Karyawan",bio:"Karyawan sistem absensi",department:"General",employee_id:`EMP${Date.now().toString().slice(-6)}`,status:"active",salary:35e5,join_date:new Date().toISOString().split("T")[0],contract_start_date:new Date().toISOString().split("T")[0],contract_type:"permanent",is_face_registered:!1},{data:Ze,error:Je}=await Pe.from("profiles").insert([Qe]).select().maybeSingle();!Je&&Ze&&r(Ze)}}}catch(Ae){console.error("Error in fetchUserProfile:",Ae)}},[e]),B=ae.useCallback(async xe=>{try{const{data:Ae,error:Ce}=await Pe.from("employee_salaries").select("*").eq("user_id",xe).eq("is_active",!0).maybeSingle();Ce&&Ce.code!=="PGRST116"?console.error("Salary fetch error:",Ce):Ae&&u(Ae)}catch(Ae){console.error("Error fetching salary info:",Ae)}},[]),q=ae.useCallback(async xe=>{try{const{data:Ae,error:Ce}=await Pe.from("profiles").select(`
          bank_id,
          bank_account_number,
          bank_account_name,
          bank_info(bank_name)
        `).eq("id",xe).maybeSingle();if(Ce&&Ce.code!=="PGRST116")throw Ce;z(Ae)}catch(Ae){console.error("Error fetching bank info:",Ae)}},[]),I=ae.useCallback(async xe=>{try{const{data:Ae,error:Ce}=await Pe.from("attendance_warnings").select("*").eq("user_id",xe).eq("is_resolved",!1).order("created_at",{ascending:!1}).limit(5);if(Ce)throw Ce;d(Ae||[])}catch(Ae){console.error("Error fetching warnings:",Ae)}},[]),K=ae.useCallback(async xe=>{try{const Ae=new Date().toISOString().split("T")[0],{data:Ce,error:He}=await Pe.from("attendance").select("*").eq("user_id",xe).gte("timestamp",`${Ae}T00:00:00`).lte("timestamp",`${Ae}T23:59:59`).order("timestamp",{ascending:!1});if(He)throw He;s(Ce||[]),Z(Ce||[])}catch(Ae){console.error("Error fetching attendance:",Ae)}},[]),Z=ae.useCallback(xe=>{const Ae=new Date;Ae.setDate(1);const Ce=xe.filter(We=>new Date(We.timestamp)>=Ae&&We.status==="berhasil"),He=Ce.filter(We=>We.type==="masuk"&&!We.is_late),Qe=Ce.filter(We=>We.type==="masuk"&&We.is_late),Ze=Ce.filter(We=>We.type==="masuk").length;let Je=o?o.daily_salary*22:(a==null?void 0:a.salary)||0;const le=a!=null&&a.salary?a.salary/22*Ze:0,Xe=xe.filter(We=>We.type==="masuk"&&We.status==="berhasil").reduce((We,et)=>We+(et.daily_salary_earned||0),0);p({thisMonth:Ze,onTime:He.length,late:Qe.length,totalHours:Math.round(Ce.length*8/2),expectedSalary:Je,currentMonthSalary:le,dailySalaryEarned:Xe})},[o,a==null?void 0:a.salary]),R=ae.useCallback(async()=>{try{await Pe.auth.signOut(),e("/login")}catch(xe){console.error("Failed to log out:",xe)}},[e]),H=ae.useCallback(xe=>{s(Ae=>[xe,...Ae]),w(!1),t&&K(t.id)},[t,K]),$=ae.useCallback(async()=>{try{const xe=await tC();D(xe.enabled)}catch(xe){console.error("Error fetching camera settings:",xe),D(!0)}},[]),X=ae.useCallback(async(xe,Ae)=>{try{const Ce=zH(Ae),He=BH(Ae),{data:Qe,error:Ze}=await Pe.from("attendance").select("*").eq("user_id",xe).eq("status","berhasil").gte("timestamp",Ce.toISOString()).lte("timestamp",He.toISOString()).order("timestamp",{ascending:!0});if(Ze)throw Ze;const Je={};Qe==null||Qe.forEach(le=>{const Xe=gg(new Date(le.timestamp),"yyyy-MM-dd");Je[Xe]||(Je[Xe]=[]),Je[Xe].push(le)}),P(Je)}catch(Ce){console.error("Error fetching monthly attendance:",Ce)}},[]),W=ae.useCallback(xe=>{A(xe),t&&X(t.id,xe)},[t,X]),ie=ae.useCallback(()=>{if(S&&!(a!=null&&a.is_face_registered)){x(!0);return}const xe=i.some(Ce=>Ce.type==="masuk"&&Ce.status==="berhasil"),Ae=i.some(Ce=>Ce.type==="keluar"&&Ce.status==="berhasil");if(xe&&Ae){ct.fire({icon:"info",title:"Informasi",text:"Anda sudah melakukan absensi masuk dan keluar hari ini."});return}w(!0)},[a==null?void 0:a.is_face_registered,i,S]),ce=({date:xe,view:Ae})=>{if(Ae!=="month")return null;const Ce=gg(xe,"yyyy-MM-dd"),He=L[Ce]||[],Qe=He.some(Je=>Je.type==="masuk"),Ze=He.some(Je=>Je.type==="keluar");return Tk(xe)?l.jsx("div",{className:"text-[0.65rem] text-gray-400 mt-1",children:"Akhir pekan"}):Qe&&Ze?l.jsxs("div",{className:"text-[0.65rem] text-green-600 mt-1",children:[l.jsx($t,{className:"h-2.5 w-2.5 inline mr-0.5"}),"Lengkap"]}):Qe?l.jsxs("div",{className:"text-[0.65rem] text-orange-500 mt-1",children:[l.jsx(Pn,{className:"h-2.5 w-2.5 inline mr-0.5"}),"Hanya masuk"]}):Ze?l.jsxs("div",{className:"text-[0.65rem] text-blue-500 mt-1",children:[l.jsx(Pn,{className:"h-2.5 w-2.5 inline mr-0.5"}),"Hanya keluar"]}):xe<new Date&&!Ik(xe)?l.jsxs("div",{className:"text-[0.65rem] text-red-500 mt-1",children:[l.jsx(Rn,{className:"h-2.5 w-2.5 inline mr-0.5"}),"Absen"]}):null},ue=({date:xe,view:Ae})=>{if(Ae!=="month")return"";const Ce=gg(xe,"yyyy-MM-dd"),He=L[Ce]||[],Qe=He.some(Je=>Je.type==="masuk"),Ze=He.some(Je=>Je.type==="keluar");return Tk(xe)?"bg-gray-50":Qe&&Ze?"bg-green-50 border border-green-200":Qe?"bg-orange-50 border border-orange-200":xe<new Date&&!Ik(xe)?"bg-red-50 border border-red-200":""},he=ae.useCallback(xe=>{switch(xe){case"berhasil":return"text-green-600 bg-green-100";case"wajah_tidak_valid":return"text-red-600 bg-red-100";case"lokasi_tidak_valid":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}},[]),ge=ae.useCallback(xe=>{switch(xe){case"berhasil":return l.jsx($t,{className:"h-4 w-4"});case"wajah_tidak_valid":case"lokasi_tidak_valid":return l.jsx(Rn,{className:"h-4 w-4"});default:return l.jsx(Pn,{className:"h-4 w-4"})}},[]),Ee=ae.useCallback(xe=>{switch(xe){case"karyawan":return"Karyawan";case"admin":return"Administrator";default:return"Karyawan"}},[]),Te=ae.useCallback(xe=>{switch(xe){case 1:return"bg-yellow-100 text-yellow-800 border-yellow-200";case 2:return"bg-orange-100 text-orange-800 border-orange-200";case 3:return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},[]),fe=ae.useCallback(xe=>new Date(xe).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),[]);ae.useCallback(xe=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(xe),[]);const me=i.some(xe=>xe.type==="masuk"&&xe.status==="berhasil"),ne=i.some(xe=>xe.type==="keluar"&&xe.status==="berhasil"),De=!me||me&&!ne;return f?l.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4 text-sm font-medium",children:"Memuat dashboard..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-200 flex flex-col",children:[l.jsx("div",{className:"bg-white shadow-lg border-b sticky top-0 z-10",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-md",children:l.jsx(br,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate",children:(a==null?void 0:a.full_name)||(a==null?void 0:a.name)||"Karyawan"}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx("span",{className:"font-medium",children:Ee(a==null?void 0:a.role)}),((Oe=a==null?void 0:a.positions)==null?void 0:Oe.name_id)&&l.jsxs("span",{className:"hidden sm:inline",children:["• ",a.positions.name_id]}),(a==null?void 0:a.employee_id)&&l.jsxs("span",{className:"hidden sm:inline",children:["• ID: ",a.employee_id]})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(_E,{userId:t==null?void 0:t.id,userRole:a==null?void 0:a.role}),l.jsx("button",{onClick:()=>x(!0),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors duration-300 hover:shadow-md",title:"Edit Profil",children:l.jsx(Wi,{className:"h-5 w-5"})}),l.jsx("button",{onClick:()=>N(!0),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors duration-300 hover:shadow-md",title:"Riwayat Absensi",children:l.jsx(DN,{className:"h-5 w-5"})}),l.jsx("button",{onClick:R,className:"p-2 text-red-600 hover:bg-red-100 rounded-full transition-colors duration-300 hover:shadow-md",title:"Keluar",children:l.jsx(cS,{className:"h-5 w-5"})})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex-1",children:[!(a!=null&&a.is_face_registered)&&l.jsx("div",{className:"mb-6 p-4 bg-yellow-50 rounded-xl border border-yellow-200 shadow-lg animate-pulse",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-yellow-800 font-semibold text-sm",children:"Profil Belum Lengkap"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Tambahkan foto wajah untuk absensi dengan verifikasi wajah."}),l.jsx("button",{onClick:()=>x(!0),className:"mt-2 text-sm text-yellow-800 underline hover:text-yellow-900 font-medium",children:"Lengkapi Profil Sekarang"})]})]})}),c.length>0&&l.jsx("div",{className:"mb-6 p-4 bg-red-50 rounded-xl border border-red-200 shadow-lg animate-pulse",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(vo,{className:"h-6 w-6 text-red-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("p",{className:"text-red-800 font-semibold text-sm",children:["Peringatan Aktif (",c.length,")"]}),l.jsx("div",{className:"mt-2 space-y-2",children:c.slice(0,2).map(xe=>l.jsxs("div",{className:`text-xs p-3 rounded-lg border ${Te(xe.warning_level)} shadow-sm`,children:[l.jsxs("span",{className:"font-medium",children:["SP ",xe.warning_level,":"]})," ",xe.description,xe.sp_number&&l.jsxs("span",{className:"ml-2 text-[0.65rem]",children:["(",xe.sp_number,")"]})]},xe.id))}),c.length>2&&l.jsxs("p",{className:"text-red-600 text-xs mt-2 font-medium",children:["+",c.length-2," peringatan lainnya"]})]})]})}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[l.jsx(vg,{icon:Uu,title:"Hadir",value:`${h.thisMonth} hari`,color:"blue"}),l.jsx(vg,{icon:$t,title:"Tepat Waktu",value:h.onTime,color:"green"}),l.jsx(vg,{icon:Pn,title:"Terlambat",value:h.late,color:"orange"}),l.jsx(vg,{icon:Rf,title:"Jam Kerja",value:`${h.totalHours} jam`,color:"purple"})]}),l.jsxs("div",{className:"mb-6 bg-gradient-to-br from-indigo-600 to-blue-600 text-white rounded-xl shadow-xl p-6 transform hover:scale-[1.01] transition-all duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-full",children:l.jsx(qu,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Informasi Bank"}),l.jsx("p",{className:"text-sm opacity-80",children:((ke=F==null?void 0:F.bank_info)==null?void 0:ke.bank_name)||"Belum ada bank terdaftar"})]})]}),l.jsx("button",{onClick:()=>x(!0),className:"text-white bg-white bg-opacity-20 hover:bg-opacity-30 p-2 rounded-lg transition-colors duration-200",title:"Edit Bank",children:l.jsx(Wi,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs opacity-80",children:"Nomor Rekening"}),l.jsx("p",{className:"text-sm font-medium",children:(F==null?void 0:F.bank_account_number)||"-"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs opacity-80",children:"Nama Pemilik"}),l.jsx("p",{className:"text-sm font-medium",children:(F==null?void 0:F.bank_account_name)||"-"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 mb-6 border border-gray-100",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ls,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Absensi Hari Ini"})]}),l.jsx("button",{onClick:()=>E(!j),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:j?"Sembunyikan Kalender":"Tampilkan Kalender"})]}),l.jsxs("div",{className:"space-y-4",children:[(()=>{const xe=i.find(Ce=>Ce.type==="masuk"&&Ce.status==="berhasil"),Ae=i.find(Ce=>Ce.type==="keluar"&&Ce.status==="berhasil");return!xe&&!Ae?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ls,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Belum ada absensi hari ini"})]}):l.jsxs("div",{className:"space-y-3",children:[xe&&l.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg shadow-sm hover:bg-gray-100 transition-colors duration-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ${he(xe.status)}`,children:[ge(xe.status),l.jsx("span",{className:"capitalize",children:"Masuk"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm text-gray-600",children:fe(xe.timestamp)}),xe.is_late&&l.jsxs("span",{className:"ml-2 text-xs text-red-600 bg-red-100 px-2 py-1 rounded",children:["Terlambat ",xe.late_minutes," menit"]})]})]})}),Ae&&l.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg shadow-sm hover:bg-gray-100 transition-colors duration-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ${he(Ae.status)}`,children:[ge(Ae.status),l.jsx("span",{className:"capitalize",children:"Keluar"})]}),l.jsx("div",{children:l.jsx("span",{className:"text-sm text-gray-600",children:fe(Ae.timestamp)})})]})}),l.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg shadow-sm",children:l.jsxs("div",{className:"text-sm grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Masuk:"}),l.jsx("span",{className:me?"text-green-600":"text-gray-600",children:me?"✓ Sudah":"○ Belum"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Keluar:"}),l.jsx("span",{className:ne?"text-green-600":"text-gray-600",children:ne?"✓ Sudah":"○ Belum"})]})]})})]})})(),De&&l.jsx("button",{onClick:ie,className:"w-full mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 transform hover:scale-[1.02] shadow-md",children:me?"Absen Keluar":"Absen Masuk"}),!De&&l.jsx("div",{className:"w-full mt-4 bg-gray-100 text-gray-500 py-3 px-4 rounded-lg font-medium text-center shadow-sm",children:"Absensi hari ini sudah selesai"})]})]}),j&&l.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 border border-gray-100",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(DN,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Kalender Absensi"})]}),l.jsx(DH,{onChange:W,value:_,tileContent:ce,tileClassName:ue,locale:Fk,className:"w-full border-0 text-sm",prevLabel:l.jsx(_1,{className:"h-5 w-5 text-gray-600"}),nextLabel:l.jsx(xT,{className:"h-5 w-5 text-gray-600"}),navigationLabel:({date:xe})=>l.jsx("span",{className:"text-base font-semibold",children:gg(xe,"MMMM yyyy",{locale:Fk})})}),l.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg shadow-sm",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Keterangan:"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-4 h-4 bg-green-50 border border-green-200 rounded mr-2"}),l.jsx("span",{children:"Absensi Lengkap"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-4 h-4 bg-orange-50 border border-orange-200 rounded mr-2"}),l.jsx("span",{children:"Hanya Masuk"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-4 h-4 bg-red-50 border border-red-200 rounded mr-2"}),l.jsx("span",{children:"Tidak Hadir"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-4 h-4 bg-gray-50 rounded mr-2"}),l.jsx("span",{children:"Akhir Pekan"})]})]})]})]})]}),m&&l.jsx(mG,{user:t,profile:a,onClose:()=>{x(!1),O(t.id),q(t.id)}}),b&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-xl shadow-2xl max-h-[90vh] overflow-y-auto animate-fade-in",children:[l.jsx("button",{onClick:()=>w(!1),className:"absolute top-4 right-4 z-10 bg-white rounded-full p-2 shadow-lg hover:bg-gray-50",children:l.jsx(Rn,{className:"h-6 w-6 text-gray-600"})}),l.jsx(Zq,{user:{id:t.id,avatar_url:a==null?void 0:a.avatar_url},onAttendanceSubmitted:H,todayAttendance:i})]})}),y&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"max-w-5xl w-full bg-white rounded-xl shadow-2xl max-h-[90vh] overflow-y-auto animate-fade-in",children:[l.jsx("button",{onClick:()=>N(!1),className:"absolute top-4 right-4 z-10 bg-white rounded-full p-2 shadow-lg hover:bg-gray-50",children:l.jsx(Rn,{className:"h-6 w-6 text-gray-600"})}),l.jsx(rD,{})]})})]})},vg=({icon:e,title:t,value:n,color:a})=>{const r={blue:{bg:"bg-blue-100",text:"text-blue-600",gradient:"bg-gradient-to-r from-blue-500 to-indigo-600"},green:{bg:"bg-green-100",text:"text-green-600",gradient:"bg-gradient-to-r from-green-500 to-emerald-600"},orange:{bg:"bg-orange-100",text:"text-orange-600",gradient:"bg-gradient-to-r from-orange-500 to-amber-600"},purple:{bg:"bg-purple-100",text:"text-purple-600",gradient:"bg-gradient-to-r from-purple-500 to-indigo-600"}},i=r[a]||r.blue;return l.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-12 h-12 ${i.gradient} rounded-lg flex items-center justify-center flex-shrink-0 shadow-md`,children:l.jsx(e,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("p",{className:"text-xs font-medium text-gray-600 truncate",children:t}),l.jsx("p",{className:"text-base font-bold text-gray-900 truncate",children:n})]})]})})},mG=({user:e,profile:t,onClose:n})=>{const[a,r]=ae.useState("profile"),[i,s]=ae.useState(!1),[o,u]=ae.useState([]),[c,d]=ae.useState({name:(t==null?void 0:t.name)||"",full_name:(t==null?void 0:t.full_name)||"",phone:(t==null?void 0:t.phone)||"",location:(t==null?void 0:t.location)||"",bio:(t==null?void 0:t.bio)||""}),[h,p]=ae.useState({bank_id:(t==null?void 0:t.bank_id)||"",bank_account_number:(t==null?void 0:t.bank_account_number)||"",bank_account_name:(t==null?void 0:t.bank_account_name)||(t==null?void 0:t.full_name)||""}),[f,g]=ae.useState({newPassword:"",confirmPassword:""});ae.useEffect(()=>{(async()=>{try{const{data:y,error:N}=await Pe.from("bank_info").select("*").eq("is_active",!0).order("bank_name");if(N)throw N;u(y||[])}catch(y){console.error("Error fetching banks:",y)}})()},[]);const b=async x=>{x.preventDefault(),s(!0);try{const{error:y}=await Pe.from("profiles").update({full_name:c.full_name,phone:c.phone,updated_at:new Date().toISOString()}).eq("id",e.id);if(y)throw y;await ct.fire({icon:"success",title:"Berhasil",text:"Profil berhasil diperbarui!"}),n()}catch(y){await ct.fire({icon:"error",title:"Gagal",text:y.message||"Gagal memperbarui profil."})}finally{s(!1)}},w=async x=>{x.preventDefault(),s(!0);try{const{error:y}=await Pe.from("profiles").update({bank_id:h.bank_id,bank_account_number:h.bank_account_number,bank_account_name:h.bank_account_name,updated_at:new Date().toISOString()}).eq("id",e.id);if(y)throw y;await ct.fire({icon:"success",title:"Berhasil",text:"Data bank berhasil diperbarui!"}),n()}catch(y){await ct.fire({icon:"error",title:"Gagal",text:y.message||"Gagal memperbarui data bank."})}finally{s(!1)}},m=async x=>{if(x.preventDefault(),s(!0),f.newPassword!==f.confirmPassword){await ct.fire({icon:"error",title:"Gagal",text:"Password dan konfirmasi tidak sama."}),s(!1);return}try{const{error:y}=await Pe.auth.updateUser({password:f.newPassword});if(y)throw y;await ct.fire({icon:"success",title:"Berhasil",text:"Password berhasil diubah!"}),g({newPassword:"",confirmPassword:""}),n()}catch(y){await ct.fire({icon:"error",title:"Gagal",text:y.message||"Gagal mengubah password."})}finally{s(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md sm:max-w-lg max-h-[90vh] flex flex-col animate-fade-in",children:[l.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200 flex justify-between items-center",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Kelola Profil"}),l.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100 transition-colors duration-200","aria-label":"Tutup",children:l.jsx(Rn,{className:"h-6 w-6 text-gray-500"})})]}),l.jsx("div",{className:"flex border-b border-gray-200 px-4 sm:px-6",children:["profile","bank","password"].map(x=>l.jsx("button",{className:`flex-1 px-2 sm:px-4 py-3 text-sm font-medium transition-colors duration-200 ${a===x?"border-b-2 border-blue-600 text-blue-700":"text-gray-500 hover:text-gray-700"}`,onClick:()=>r(x),children:x==="profile"?"Profil":x==="bank"?"Bank":"Password"},x))}),l.jsxs("div",{className:"p-4 sm:p-6",children:[a==="profile"&&l.jsxs("form",{onSubmit:b,className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:c.full_name,onChange:x=>d({...c,full_name:x.target.value}),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-500 cursor-not-allowed",value:(t==null?void 0:t.email)||"",disabled:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No. Telepon"}),l.jsx("input",{type:"tel",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:c.phone,onChange:x=>d({...c,phone:x.target.value})})]})]}),a==="bank"&&l.jsxs("form",{onSubmit:w,className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Bank"}),l.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:h.bank_id,onChange:x=>p({...h,bank_id:x.target.value}),children:[l.jsx("option",{value:"",children:"Pilih Bank"}),o.map(x=>l.jsx("option",{value:x.id,children:x.bank_name},x.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No. Rekening"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:h.bank_account_number,onChange:x=>p({...h,bank_account_number:x.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Pemilik Rekening"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:h.bank_account_name,onChange:x=>p({...h,bank_account_name:x.target.value})})]})]}),a==="password"&&l.jsxs("form",{onSubmit:m,className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Baru"}),l.jsx("input",{type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:f.newPassword,onChange:x=>g({...f,newPassword:x.target.value}),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Konfirmasi Password"}),l.jsx("input",{type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",value:f.confirmPassword,onChange:x=>g({...f,confirmPassword:x.target.value}),required:!0})]})]})]}),l.jsxs("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 sticky bottom-0",children:[l.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors duration-200",children:"Batal"}),a!=="password"&&l.jsx("button",{onClick:a==="profile"?b:w,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02]",disabled:i,children:i?"Menyimpan...":"Simpan"}),a==="password"&&l.jsx("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02]",disabled:i,children:i?"Menyimpan...":"Simpan"})]})]})})};function hn(e){"@babel/helpers - typeof";return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(e)}var or=Uint8Array,ci=Uint16Array,Z5=Int32Array,ox=new or([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lx=new or([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),f2=new or([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iD=function(e,t){for(var n=new ci(31),a=0;a<31;++a)n[a]=t+=1<<e[a-1];for(var r=new Z5(n[30]),a=1;a<30;++a)for(var i=n[a];i<n[a+1];++i)r[i]=i-n[a]<<5|a;return{b:n,r}},sD=iD(ox,2),oD=sD.b,p2=sD.r;oD[28]=258,p2[258]=28;var lD=iD(lx,0),gG=lD.b,Bk=lD.r,m2=new ci(32768);for(var En=0;En<32768;++En){var il=(En&43690)>>1|(En&21845)<<1;il=(il&52428)>>2|(il&13107)<<2,il=(il&61680)>>4|(il&3855)<<4,m2[En]=((il&65280)>>8|(il&255)<<8)>>1}var Us=function(e,t,n){for(var a=e.length,r=0,i=new ci(t);r<a;++r)e[r]&&++i[e[r]-1];var s=new ci(t);for(r=1;r<t;++r)s[r]=s[r-1]+i[r-1]<<1;var o;if(n){o=new ci(1<<t);var u=15-t;for(r=0;r<a;++r)if(e[r])for(var c=r<<4|e[r],d=t-e[r],h=s[e[r]-1]++<<d,p=h|(1<<d)-1;h<=p;++h)o[m2[h]>>u]=c}else for(o=new ci(a),r=0;r<a;++r)e[r]&&(o[r]=m2[s[e[r]-1]++]>>15-e[r]);return o},Vl=new or(288);for(var En=0;En<144;++En)Vl[En]=8;for(var En=144;En<256;++En)Vl[En]=9;for(var En=256;En<280;++En)Vl[En]=7;for(var En=280;En<288;++En)Vl[En]=8;var lp=new or(32);for(var En=0;En<32;++En)lp[En]=5;var vG=Us(Vl,9,0),xG=Us(Vl,9,1),bG=Us(lp,5,0),yG=Us(lp,5,1),p1=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},es=function(e,t,n){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&n},m1=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},eN=function(e){return(e+7)/8|0},uD=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new or(e.subarray(t,n))},wG=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ns=function(e,t,n){var a=new Error(t||wG[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,ns),!n)throw a;return a},NG=function(e,t,n,a){var r=e.length,i=0;if(!r||t.f&&!t.l)return n||new or(0);var s=!n,o=s||t.i!=2,u=t.i;s&&(n=new or(r*3));var c=function(ge){var Ee=n.length;if(ge>Ee){var Te=new or(Math.max(Ee*2,ge));Te.set(n),n=Te}},d=t.f||0,h=t.p||0,p=t.b||0,f=t.l,g=t.d,b=t.m,w=t.n,m=r*8;do{if(!f){d=es(e,h,1);var x=es(e,h+1,3);if(h+=3,x)if(x==1)f=xG,g=yG,b=9,w=5;else if(x==2){var D=es(e,h,31)+257,_=es(e,h+10,15)+4,A=D+es(e,h+5,31)+1;h+=14;for(var L=new or(A),P=new or(19),j=0;j<_;++j)P[f2[j]]=es(e,h+j*3,7);h+=_*3;for(var E=p1(P),F=(1<<E)-1,z=Us(P,E,1),j=0;j<A;){var U=z[es(e,h,F)];h+=U&15;var y=U>>4;if(y<16)L[j++]=y;else{var O=0,B=0;for(y==16?(B=3+es(e,h,3),h+=2,O=L[j-1]):y==17?(B=3+es(e,h,7),h+=3):y==18&&(B=11+es(e,h,127),h+=7);B--;)L[j++]=O}}var q=L.subarray(0,D),I=L.subarray(D);b=p1(q),w=p1(I),f=Us(q,b,1),g=Us(I,w,1)}else ns(1);else{var y=eN(h)+4,N=e[y-4]|e[y-3]<<8,S=y+N;if(S>r){u&&ns(0);break}o&&c(p+N),n.set(e.subarray(y,S),p),t.b=p+=N,t.p=h=S*8,t.f=d;continue}if(h>m){u&&ns(0);break}}o&&c(p+131072);for(var K=(1<<b)-1,Z=(1<<w)-1,R=h;;R=h){var O=f[m1(e,h)&K],H=O>>4;if(h+=O&15,h>m){u&&ns(0);break}if(O||ns(2),H<256)n[p++]=H;else if(H==256){R=h,f=null;break}else{var $=H-254;if(H>264){var j=H-257,X=ox[j];$=es(e,h,(1<<X)-1)+oD[j],h+=X}var W=g[m1(e,h)&Z],ie=W>>4;W||ns(3),h+=W&15;var I=gG[ie];if(ie>3){var X=lx[ie];I+=m1(e,h)&(1<<X)-1,h+=X}if(h>m){u&&ns(0);break}o&&c(p+131072);var ce=p+$;if(p<I){var ue=i-I,he=Math.min(I,ce);for(ue+p<0&&ns(3);p<he;++p)n[p]=a[ue+p]}for(;p<ce;++p)n[p]=n[p-I]}}t.l=f,t.p=R,t.b=p,t.f=d,f&&(d=1,t.m=b,t.d=g,t.n=w)}while(!d);return p!=n.length&&s?uD(n,0,p):n.subarray(0,p)},ho=function(e,t,n){n<<=t&7;var a=t/8|0;e[a]|=n,e[a+1]|=n>>8},nf=function(e,t,n){n<<=t&7;var a=t/8|0;e[a]|=n,e[a+1]|=n>>8,e[a+2]|=n>>16},g1=function(e,t){for(var n=[],a=0;a<e.length;++a)e[a]&&n.push({s:a,f:e[a]});var r=n.length,i=n.slice();if(!r)return{t:dD,l:0};if(r==1){var s=new or(n[0].s+1);return s[n[0].s]=1,{t:s,l:1}}n.sort(function(S,D){return S.f-D.f}),n.push({s:-1,f:25001});var o=n[0],u=n[1],c=0,d=1,h=2;for(n[0]={s:-1,f:o.f+u.f,l:o,r:u};d!=r-1;)o=n[n[c].f<n[h].f?c++:h++],u=n[c!=d&&n[c].f<n[h].f?c++:h++],n[d++]={s:-1,f:o.f+u.f,l:o,r:u};for(var p=i[0].s,a=1;a<r;++a)i[a].s>p&&(p=i[a].s);var f=new ci(p+1),g=g2(n[d-1],f,0);if(g>t){var a=0,b=0,w=g-t,m=1<<w;for(i.sort(function(D,_){return f[_.s]-f[D.s]||D.f-_.f});a<r;++a){var x=i[a].s;if(f[x]>t)b+=m-(1<<g-f[x]),f[x]=t;else break}for(b>>=w;b>0;){var y=i[a].s;f[y]<t?b-=1<<t-f[y]++-1:++a}for(;a>=0&&b;--a){var N=i[a].s;f[N]==t&&(--f[N],++b)}g=t}return{t:new or(f),l:g}},g2=function(e,t,n){return e.s==-1?Math.max(g2(e.l,t,n+1),g2(e.r,t,n+1)):t[e.s]=n},zk=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new ci(++t),a=0,r=e[0],i=1,s=function(u){n[a++]=u},o=1;o<=t;++o)if(e[o]==r&&o!=t)++i;else{if(!r&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(r),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(r);i=1,r=e[o]}return{c:n.subarray(0,a),n:t}},af=function(e,t){for(var n=0,a=0;a<t.length;++a)n+=e[a]*t[a];return n},cD=function(e,t,n){var a=n.length,r=eN(t+2);e[r]=a&255,e[r+1]=a>>8,e[r+2]=e[r]^255,e[r+3]=e[r+1]^255;for(var i=0;i<a;++i)e[r+i+4]=n[i];return(r+4+a)*8},Uk=function(e,t,n,a,r,i,s,o,u,c,d){ho(t,d++,n),++r[256];for(var h=g1(r,15),p=h.t,f=h.l,g=g1(i,15),b=g.t,w=g.l,m=zk(p),x=m.c,y=m.n,N=zk(b),S=N.c,D=N.n,_=new ci(19),A=0;A<x.length;++A)++_[x[A]&31];for(var A=0;A<S.length;++A)++_[S[A]&31];for(var L=g1(_,7),P=L.t,j=L.l,E=19;E>4&&!P[f2[E-1]];--E);var F=c+5<<3,z=af(r,Vl)+af(i,lp)+s,U=af(r,p)+af(i,b)+s+14+3*E+af(_,P)+2*_[16]+3*_[17]+7*_[18];if(u>=0&&F<=z&&F<=U)return cD(t,d,e.subarray(u,u+c));var O,B,q,I;if(ho(t,d,1+(U<z)),d+=2,U<z){O=Us(p,f,0),B=p,q=Us(b,w,0),I=b;var K=Us(P,j,0);ho(t,d,y-257),ho(t,d+5,D-1),ho(t,d+10,E-4),d+=14;for(var A=0;A<E;++A)ho(t,d+3*A,P[f2[A]]);d+=3*E;for(var Z=[x,S],R=0;R<2;++R)for(var H=Z[R],A=0;A<H.length;++A){var $=H[A]&31;ho(t,d,K[$]),d+=P[$],$>15&&(ho(t,d,H[A]>>5&127),d+=H[A]>>12)}}else O=vG,B=Vl,q=bG,I=lp;for(var A=0;A<o;++A){var X=a[A];if(X>255){var $=X>>18&31;nf(t,d,O[$+257]),d+=B[$+257],$>7&&(ho(t,d,X>>23&31),d+=ox[$]);var W=X&31;nf(t,d,q[W]),d+=I[W],W>3&&(nf(t,d,X>>5&8191),d+=lx[W])}else nf(t,d,O[X]),d+=B[X]}return nf(t,d,O[256]),d+B[256]},kG=new Z5([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),dD=new or(0),SG=function(e,t,n,a,r,i){var s=i.z||e.length,o=new or(a+s+5*(1+Math.ceil(s/7e3))+r),u=o.subarray(a,o.length-r),c=i.l,d=(i.r||0)&7;if(t){d&&(u[0]=i.r>>3);for(var h=kG[t-1],p=h>>13,f=h&8191,g=(1<<n)-1,b=i.p||new ci(32768),w=i.h||new ci(g+1),m=Math.ceil(n/3),x=2*m,y=function(fe){return(e[fe]^e[fe+1]<<m^e[fe+2]<<x)&g},N=new Z5(25e3),S=new ci(288),D=new ci(32),_=0,A=0,L=i.i||0,P=0,j=i.w||0,E=0;L+2<s;++L){var F=y(L),z=L&32767,U=w[F];if(b[z]=U,w[F]=z,j<=L){var O=s-L;if((_>7e3||P>24576)&&(O>423||!c)){d=Uk(e,u,0,N,S,D,A,P,E,L-E,d),P=_=A=0,E=L;for(var B=0;B<286;++B)S[B]=0;for(var B=0;B<30;++B)D[B]=0}var q=2,I=0,K=f,Z=z-U&32767;if(O>2&&F==y(L-Z))for(var R=Math.min(p,O)-1,H=Math.min(32767,L),$=Math.min(258,O);Z<=H&&--K&&z!=U;){if(e[L+q]==e[L+q-Z]){for(var X=0;X<$&&e[L+X]==e[L+X-Z];++X);if(X>q){if(q=X,I=Z,X>R)break;for(var W=Math.min(Z,X-2),ie=0,B=0;B<W;++B){var ce=L-Z+B&32767,ue=b[ce],he=ce-ue&32767;he>ie&&(ie=he,U=ce)}}}z=U,U=b[z],Z+=z-U&32767}if(I){N[P++]=268435456|p2[q]<<18|Bk[I];var ge=p2[q]&31,Ee=Bk[I]&31;A+=ox[ge]+lx[Ee],++S[257+ge],++D[Ee],j=L+q,++_}else N[P++]=e[L],++S[e[L]]}}for(L=Math.max(L,j);L<s;++L)N[P++]=e[L],++S[e[L]];d=Uk(e,u,c,N,S,D,A,P,E,L-E,d),c||(i.r=d&7|u[d/8|0]<<3,d-=7,i.h=w,i.p=b,i.i=L,i.w=j)}else{for(var L=i.w||0;L<s+c;L+=65535){var Te=L+65535;Te>=s&&(u[d/8|0]=c,Te=s),d=cD(u,d+1,e.subarray(L,Te))}i.i=s}return uD(o,0,a+eN(d)+r)},hD=function(){var e=1,t=0;return{p:function(n){for(var a=e,r=t,i=n.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)r+=a+=n[s];a=(a&65535)+15*(a>>16),r=(r&65535)+15*(r>>16)}e=a,t=r},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},_G=function(e,t,n,a,r){if(!r&&(r={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new or(i.length+e.length);s.set(i),s.set(e,i.length),e=s,r.w=i.length}return SG(e,t.level==null?6:t.level,t.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,a,r)},fD=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},jG=function(e,t){var n=t.level,a=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var r=hD();r.p(t.dictionary),fD(e,2,r.d())}},CG=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ns(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&ns(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function v2(e,t){t||(t={});var n=hD();n.p(e);var a=_G(e,t,t.dictionary?6:2,4);return jG(a,t),fD(a,a.length-4,n.d()),a}function AG(e,t){return NG(e.subarray(CG(e,t),-4),{i:2},t,t)}var EG=typeof TextDecoder<"u"&&new TextDecoder,DG=0;try{EG.decode(dD,{stream:!0}),DG=1}catch{}var Nt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function v1(){Nt.console&&typeof Nt.console.log=="function"&&Nt.console.log.apply(Nt.console,arguments)}var yn={log:v1,warn:function(e){Nt.console&&(typeof Nt.console.warn=="function"?Nt.console.warn.apply(Nt.console,arguments):v1.call(null,arguments))},error:function(e){Nt.console&&(typeof Nt.console.error=="function"?Nt.console.error.apply(Nt.console,arguments):v1(e))}};function x1(e,t,n){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){yu(a.response,t,n)},a.onerror=function(){yn.error("could not download file")},a.send()}function qk(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function xg(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Ef,x2,yu=Nt.saveAs||((typeof window>"u"?"undefined":hn(window))!=="object"||window!==Nt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var a=Nt.URL||Nt.webkitURL,r=document.createElement("a");t=t||e.name||"download",r.download=t,r.rel="noopener",typeof e=="string"?(r.href=e,r.origin!==location.origin?qk(r.href)?x1(e,t,n):xg(r,r.target="_blank"):xg(r)):(r.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(r.href)},4e4),setTimeout(function(){xg(r)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(qk(e))x1(e,t,n);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){xg(a)})}else navigator.msSaveOrOpenBlob(function(r,i){return i===void 0?i={autoBom:!1}:hn(i)!=="object"&&(yn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}(e,n),t)}:function(e,t,n,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return x1(e,t,n);var r=e.type==="application/octet-stream",i=/constructor/i.test(Nt.HTMLElement)||Nt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||r&&i)&&(typeof FileReader>"u"?"undefined":hn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=s?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=d:location=d,a=null},o.readAsDataURL(e)}else{var u=Nt.URL||Nt.webkitURL,c=u.createObjectURL(e);a?a.location=c:location.href=c,a=null,setTimeout(function(){u.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function pD(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],a=0;a<n.length;a++){var r=n[a].re,i=n[a].process,s=r.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),c.length==1&&(c="0"+c),"#"+o+u+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function b1(e,t){var n=e[0],a=e[1],r=e[2],i=e[3];n=Za(n,a,r,i,t[0],7,-680876936),i=Za(i,n,a,r,t[1],12,-389564586),r=Za(r,i,n,a,t[2],17,606105819),a=Za(a,r,i,n,t[3],22,-1044525330),n=Za(n,a,r,i,t[4],7,-176418897),i=Za(i,n,a,r,t[5],12,1200080426),r=Za(r,i,n,a,t[6],17,-1473231341),a=Za(a,r,i,n,t[7],22,-45705983),n=Za(n,a,r,i,t[8],7,1770035416),i=Za(i,n,a,r,t[9],12,-1958414417),r=Za(r,i,n,a,t[10],17,-42063),a=Za(a,r,i,n,t[11],22,-1990404162),n=Za(n,a,r,i,t[12],7,1804603682),i=Za(i,n,a,r,t[13],12,-40341101),r=Za(r,i,n,a,t[14],17,-1502002290),n=er(n,a=Za(a,r,i,n,t[15],22,1236535329),r,i,t[1],5,-165796510),i=er(i,n,a,r,t[6],9,-1069501632),r=er(r,i,n,a,t[11],14,643717713),a=er(a,r,i,n,t[0],20,-373897302),n=er(n,a,r,i,t[5],5,-701558691),i=er(i,n,a,r,t[10],9,38016083),r=er(r,i,n,a,t[15],14,-660478335),a=er(a,r,i,n,t[4],20,-405537848),n=er(n,a,r,i,t[9],5,568446438),i=er(i,n,a,r,t[14],9,-1019803690),r=er(r,i,n,a,t[3],14,-187363961),a=er(a,r,i,n,t[8],20,1163531501),n=er(n,a,r,i,t[13],5,-1444681467),i=er(i,n,a,r,t[2],9,-51403784),r=er(r,i,n,a,t[7],14,1735328473),n=tr(n,a=er(a,r,i,n,t[12],20,-1926607734),r,i,t[5],4,-378558),i=tr(i,n,a,r,t[8],11,-2022574463),r=tr(r,i,n,a,t[11],16,1839030562),a=tr(a,r,i,n,t[14],23,-35309556),n=tr(n,a,r,i,t[1],4,-1530992060),i=tr(i,n,a,r,t[4],11,1272893353),r=tr(r,i,n,a,t[7],16,-155497632),a=tr(a,r,i,n,t[10],23,-1094730640),n=tr(n,a,r,i,t[13],4,681279174),i=tr(i,n,a,r,t[0],11,-358537222),r=tr(r,i,n,a,t[3],16,-722521979),a=tr(a,r,i,n,t[6],23,76029189),n=tr(n,a,r,i,t[9],4,-640364487),i=tr(i,n,a,r,t[12],11,-421815835),r=tr(r,i,n,a,t[15],16,530742520),n=nr(n,a=tr(a,r,i,n,t[2],23,-995338651),r,i,t[0],6,-198630844),i=nr(i,n,a,r,t[7],10,1126891415),r=nr(r,i,n,a,t[14],15,-1416354905),a=nr(a,r,i,n,t[5],21,-57434055),n=nr(n,a,r,i,t[12],6,1700485571),i=nr(i,n,a,r,t[3],10,-1894986606),r=nr(r,i,n,a,t[10],15,-1051523),a=nr(a,r,i,n,t[1],21,-2054922799),n=nr(n,a,r,i,t[8],6,1873313359),i=nr(i,n,a,r,t[15],10,-30611744),r=nr(r,i,n,a,t[6],15,-1560198380),a=nr(a,r,i,n,t[13],21,1309151649),n=nr(n,a,r,i,t[4],6,-145523070),i=nr(i,n,a,r,t[11],10,-1120210379),r=nr(r,i,n,a,t[2],15,718787259),a=nr(a,r,i,n,t[9],21,-343485551),e[0]=Sl(n,e[0]),e[1]=Sl(a,e[1]),e[2]=Sl(r,e[2]),e[3]=Sl(i,e[3])}function ux(e,t,n,a,r,i){return t=Sl(Sl(t,e),Sl(a,i)),Sl(t<<r|t>>>32-r,n)}function Za(e,t,n,a,r,i,s){return ux(t&n|~t&a,e,t,r,i,s)}function er(e,t,n,a,r,i,s){return ux(t&a|n&~a,e,t,r,i,s)}function tr(e,t,n,a,r,i,s){return ux(t^n^a,e,t,r,i,s)}function nr(e,t,n,a,r,i,s){return ux(n^(t|~a),e,t,r,i,s)}function mD(e){var t,n=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)b1(a,TG(e.substring(t-64,t)));e=e.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(b1(a,r),t=0;t<16;t++)r[t]=0;return r[14]=8*n,b1(a,r),a}function TG(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}Ef=Nt.atob.bind(Nt),x2=Nt.btoa.bind(Nt);var Wk="0123456789abcdef".split("");function LG(e){for(var t="",n=0;n<4;n++)t+=Wk[e>>8*n+4&15]+Wk[e>>8*n&15];return t}function PG(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function b2(e){return mD(e).map(PG).join("")}var RG=function(e){for(var t=0;t<e.length;t++)e[t]=LG(e[t]);return e.join("")}(mD("hello"))!="5d41402abc4b2a76b9719d911017c592";function Sl(e,t){if(RG){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function y2(e,t){var n,a,r,i;if(e!==n){for(var s=(r=e,i=1+(256/e.length>>0),new Array(i+1).join(r)),o=[],u=0;u<256;u++)o[u]=u;var c=0;for(u=0;u<256;u++){var d=o[u];c=(c+d+s.charCodeAt(u))%256,o[u]=o[c],o[c]=d}n=e,a=o}else o=a;var h=t.length,p=0,f=0,g="";for(u=0;u<h;u++)f=(f+(d=o[p=(p+1)%256]))%256,o[p]=o[f],o[f]=d,s=o[(o[p]+o[f])%256],g+=String.fromCharCode(t.charCodeAt(u)^s);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Hk={print:4,modify:8,copy:16,"annot-forms":32};function Jc(e,t,n,a){this.v=1,this.r=2;var r=192;e.forEach(function(o){if(Hk.perm!==void 0)throw new Error("Invalid permission: "+o);r+=Hk[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),s=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^r)),this.encryptionKey=b2(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=y2(this.encryptionKey,this.padding)}function Qc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,a=0;a<n;a++){var r=e.charCodeAt(a);r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?t+="#"+("0"+r.toString(16)).slice(-2):t+=e[a]}return t}function Vk(e){if(hn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,a,r){if(r=r||!1,typeof n!="string"||typeof a!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var i=Math.random().toString(35);return t[n][i]=[a,!!r],i},this.unsubscribe=function(n){for(var a in t)if(t[a][n])return delete t[a][n],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var a=Array.prototype.slice.call(arguments,1),r=[];for(var i in t[n]){var s=t[n][i];try{s[0].apply(e,a)}catch(o){Nt.console&&yn.error("jsPDF PubSub Error",o.message,o)}s[1]&&r.push(i)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function up(e){if(!(this instanceof up))return new up(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function gD(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function pl(e,t,n,a,r){if(!(this instanceof pl))return new pl(e,t,n,a,r);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,gD.call(this,a,r)}function Su(e,t,n,a,r){if(!(this instanceof Su))return new Su(e,t,n,a,r);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,gD.call(this,a,r)}function yt(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],r=arguments[2],i=arguments[3],s=[],o=1,u=16,c="S",d=null;hn(e=e||{})==="object"&&(n=e.orientation,a=e.unit||a,r=e.format||r,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),a=a||"mm",n=(""+(n||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=Vk;var g="1.3",b=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(C){g=C};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return w};var m=f.__private__.getPageFormat=function(C){return w[C]};r=r||"a4";var x={COMPAT:"compat",ADVANCED:"advanced"},y=x.COMPAT;function N(){this.saveGraphicsState(),ne(new vt(Ke,0,0,-Ke,0,Wo()*Ke).toString()+" cm"),this.setFontSize(this.getFontSize()/Ke),c="n",y=x.ADVANCED}function S(){this.restoreGraphicsState(),c="S",y=x.COMPAT}var D=f.__private__.combineFontStyleAndFontWeight=function(C,G){if(C=="bold"&&G=="normal"||C=="bold"&&G==400||C=="normal"&&G=="italic"||C=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(C=G==400||G==="normal"?C==="italic"?"italic":"normal":G!=700&&G!=="bold"||C!=="normal"?(G==700?"bold":G)+""+C:"bold"),C};f.advancedAPI=function(C){var G=y===x.COMPAT;return G&&N.call(this),typeof C!="function"||(C(this),G&&S.call(this)),this},f.compatAPI=function(C){var G=y===x.ADVANCED;return G&&S.call(this),typeof C!="function"||(C(this),G&&N.call(this)),this},f.isAdvancedAPI=function(){return y===x.ADVANCED};var _,A=function(C){if(y!==x.ADVANCED)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},L=f.roundToPrecision=f.__private__.roundToPrecision=function(C,G){var oe=t||G;if(isNaN(C)||isNaN(oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(oe).replace(/0+$/,"")};_=f.hpf=f.__private__.hpf=typeof u=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return L(C,u)}:u==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return L(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return L(C,16)};var P=f.f2=f.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return L(C,2)},j=f.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return L(C,3)},E=f.scale=f.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return y===x.COMPAT?C*Ke:y===x.ADVANCED?C:void 0},F=function(C){return y===x.COMPAT?Wo()-C:y===x.ADVANCED?C:void 0},z=function(C){return E(F(C))};f.__private__.setPrecision=f.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(t=parseInt(C,10))};var U,O="00000000000000000000000000000000",B=f.__private__.getFileId=function(){return O},q=f.__private__.setFileId=function(C){return O=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():O.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ja=new Jc(d.userPermissions,d.userPassword,d.ownerPassword,O)),O};f.setFileId=function(C){return q(C),this},f.getFileId=function(){return B()};var I=f.__private__.convertDateToPDFDate=function(C){var G=C.getTimezoneOffset(),oe=G<0?"+":"-",pe=Math.floor(Math.abs(G/60)),Se=Math.abs(G%60),Fe=[oe,$(pe),"'",$(Se),"'"].join("");return["D:",C.getFullYear(),$(C.getMonth()+1),$(C.getDate()),$(C.getHours()),$(C.getMinutes()),$(C.getSeconds()),Fe].join("")},K=f.__private__.convertPDFDateToDate=function(C){var G=parseInt(C.substr(2,4),10),oe=parseInt(C.substr(6,2),10)-1,pe=parseInt(C.substr(8,2),10),Se=parseInt(C.substr(10,2),10),Fe=parseInt(C.substr(12,2),10),Ye=parseInt(C.substr(14,2),10);return new Date(G,oe,pe,Se,Fe,Ye,0)},Z=f.__private__.setCreationDate=function(C){var G;if(C===void 0&&(C=new Date),C instanceof Date)G=I(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=C}return U=G},R=f.__private__.getCreationDate=function(C){var G=U;return C==="jsDate"&&(G=K(U)),G};f.setCreationDate=function(C){return Z(C),this},f.getCreationDate=function(C){return R(C)};var H,$=f.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},X=f.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},W=0,ie=[],ce=[],ue=0,he=[],ge=[],Ee=!1,Te=ce,fe=function(){W=0,ue=0,ce=[],ie=[],he=[],Kr=Tn(),jr=Tn()};f.__private__.setCustomOutputDestination=function(C){Ee=!0,Te=C};var me=function(C){Ee||(Te=C)};f.__private__.resetCustomOutputDestination=function(){Ee=!1,Te=ce};var ne=f.__private__.out=function(C){return C=C.toString(),ue+=C.length+1,Te.push(C),Te},De=f.__private__.write=function(C){return ne(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},Oe=f.__private__.getArrayBuffer=function(C){for(var G=C.length,oe=new ArrayBuffer(G),pe=new Uint8Array(oe);G--;)pe[G]=C.charCodeAt(G);return oe},ke=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ke};var xe=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(C){return xe=y===x.ADVANCED?C/Ke:C,this};var Ae,Ce=f.__private__.getFontSize=f.getFontSize=function(){return y===x.COMPAT?xe:xe*Ke},He=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(C){return He=C,this},f.__private__.getR2L=f.getR2L=function(){return He};var Qe,Ze=f.__private__.setZoomMode=function(C){var G=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))Ae=C;else if(isNaN(C)){if(G.indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');Ae=C}else Ae=parseInt(C,10)};f.__private__.getZoomMode=function(){return Ae};var Je,le=f.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');Qe=C};f.__private__.getPageMode=function(){return Qe};var Xe=f.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');Je=C};f.__private__.getLayoutMode=function(){return Je},f.__private__.setDisplayMode=f.setDisplayMode=function(C,G,oe){return Ze(C),Xe(G),le(oe),this};var We={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(C){if(Object.keys(We).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return We[C]},f.__private__.getDocumentProperties=function(){return We},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(C){for(var G in We)We.hasOwnProperty(G)&&C[G]&&(We[G]=C[G]);return this},f.__private__.setDocumentProperty=function(C,G){if(Object.keys(We).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return We[C]=G};var et,Ke,Ht,xt,Xn,Mt={},xn={},Gr=[],Vt={},Js={},Cn={},$r={},Ni=null,It=0,mt=[],qt=new Vk(f),Qt=e.hotfixes||[],pn={},ki={},kr=[],vt=function C(G,oe,pe,Se,Fe,Ye){if(!(this instanceof C))return new C(G,oe,pe,Se,Fe,Ye);isNaN(G)&&(G=1),isNaN(oe)&&(oe=0),isNaN(pe)&&(pe=0),isNaN(Se)&&(Se=1),isNaN(Fe)&&(Fe=0),isNaN(Ye)&&(Ye=0),this._matrix=[G,oe,pe,Se,Fe,Ye]};Object.defineProperty(vt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(vt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(vt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(vt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(vt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(vt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(vt.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(vt.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(vt.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(vt.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(vt.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(vt.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(vt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vt.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(_).join(C)},vt.prototype.multiply=function(C){var G=C.sx*this.sx+C.shy*this.shx,oe=C.sx*this.shy+C.shy*this.sy,pe=C.shx*this.sx+C.sy*this.shx,Se=C.shx*this.shy+C.sy*this.sy,Fe=C.tx*this.sx+C.ty*this.shx+this.tx,Ye=C.tx*this.shy+C.ty*this.sy+this.ty;return new vt(G,oe,pe,Se,Fe,Ye)},vt.prototype.decompose=function(){var C=this.sx,G=this.shy,oe=this.shx,pe=this.sy,Se=this.tx,Fe=this.ty,Ye=Math.sqrt(C*C+G*G),rt=(C/=Ye)*oe+(G/=Ye)*pe;oe-=C*rt,pe-=G*rt;var gt=Math.sqrt(oe*oe+pe*pe);return rt/=gt,C*(pe/=gt)<G*(oe/=gt)&&(C=-C,G=-G,rt=-rt,Ye=-Ye),{scale:new vt(Ye,0,0,gt,0,0),translate:new vt(1,0,0,1,Se,Fe),rotate:new vt(C,G,-G,C,0,0),skew:new vt(1,0,rt,1,0,0)}},vt.prototype.toString=function(C){return this.join(" ")},vt.prototype.inversed=function(){var C=this.sx,G=this.shy,oe=this.shx,pe=this.sy,Se=this.tx,Fe=this.ty,Ye=1/(C*pe-G*oe),rt=pe*Ye,gt=-G*Ye,Tt=-oe*Ye,At=C*Ye;return new vt(rt,gt,Tt,At,-rt*Se-Tt*Fe,-gt*Se-At*Fe)},vt.prototype.applyToPoint=function(C){var G=C.x*this.sx+C.y*this.shx+this.tx,oe=C.x*this.shy+C.y*this.sy+this.ty;return new xc(G,oe)},vt.prototype.applyToRectangle=function(C){var G=this.applyToPoint(C),oe=this.applyToPoint(new xc(C.x+C.w,C.y+C.h));return new Sh(G.x,G.y,oe.x-G.x,oe.y-G.y)},vt.prototype.clone=function(){var C=this.sx,G=this.shy,oe=this.shx,pe=this.sy,Se=this.tx,Fe=this.ty;return new vt(C,G,oe,pe,Se,Fe)},f.Matrix=vt;var Sr=f.matrixMult=function(C,G){return G.multiply(C)},_r=new vt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=_r;var pa=function(C,G){if(!Js[C]){var oe=(G instanceof pl?"Sh":"P")+(Object.keys(Vt).length+1).toString(10);G.id=oe,Js[C]=oe,Vt[oe]=G,qt.publish("addPattern",G)}};f.ShadingPattern=pl,f.TilingPattern=Su,f.addShadingPattern=function(C,G){return A("addShadingPattern()"),pa(C,G),this},f.beginTilingPattern=function(C){A("beginTilingPattern()"),dm(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},f.endTilingPattern=function(C,G){A("endTilingPattern()"),G.stream=ge[H].join(`
`),pa(C,G),qt.publish("endTilingPattern",G),kr.pop().restore()};var In=f.__private__.newObject=function(){var C=Tn();return Ua(C,!0),C},Tn=f.__private__.newObjectDeferred=function(){return W++,ie[W]=function(){return ue},W},Ua=function(C,G){return G=typeof G=="boolean"&&G,ie[C]=ue,G&&ne(C+" 0 obj"),C},Fo=f.__private__.newAdditionalObject=function(){var C={objId:Tn(),content:""};return he.push(C),C},Kr=Tn(),jr=Tn(),Yr=f.__private__.decodeColorString=function(C){var G=C.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length===5&&(G[4]==="k"||G[4]==="K")&&(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var oe=parseFloat(G[0]);G=[oe,oe,oe,"r"]}for(var pe="#",Se=0;Se<3;Se++)pe+=("0"+Math.floor(255*parseFloat(G[Se])).toString(16)).slice(-2);return pe},Xr=f.__private__.encodeColorString=function(C){var G;typeof C=="string"&&(C={ch1:C});var oe=C.ch1,pe=C.ch2,Se=C.ch3,Fe=C.ch4,Ye=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof oe=="string"&&oe.charAt(0)!=="#"){var rt=new pD(oe);if(rt.ok)oe=rt.toHex();else if(!/^\d*\.?\d*$/.test(oe))throw new Error('Invalid color "'+oe+'" passed to jsPDF.encodeColorString.')}if(typeof oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(oe)&&(oe="#"+oe[1]+oe[1]+oe[2]+oe[2]+oe[3]+oe[3]),typeof oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(oe)){var gt=parseInt(oe.substr(1),16);oe=gt>>16&255,pe=gt>>8&255,Se=255&gt}if(pe===void 0||Fe===void 0&&oe===pe&&pe===Se)if(typeof oe=="string")G=oe+" "+Ye[0];else switch(C.precision){case 2:G=P(oe/255)+" "+Ye[0];break;case 3:default:G=j(oe/255)+" "+Ye[0]}else if(Fe===void 0||hn(Fe)==="object"){if(Fe&&!isNaN(Fe.a)&&Fe.a===0)return G=["1.","1.","1.",Ye[1]].join(" ");if(typeof oe=="string")G=[oe,pe,Se,Ye[1]].join(" ");else switch(C.precision){case 2:G=[P(oe/255),P(pe/255),P(Se/255),Ye[1]].join(" ");break;default:case 3:G=[j(oe/255),j(pe/255),j(Se/255),Ye[1]].join(" ")}}else if(typeof oe=="string")G=[oe,pe,Se,Fe,Ye[2]].join(" ");else switch(C.precision){case 2:G=[P(oe),P(pe),P(Se),P(Fe),Ye[2]].join(" ");break;case 3:default:G=[j(oe),j(pe),j(Se),j(Fe),Ye[2]].join(" ")}return G},St=f.__private__.getFilters=function(){return s},Wt=f.__private__.putStream=function(C){var G=(C=C||{}).data||"",oe=C.filters||St(),pe=C.alreadyAppliedFilters||[],Se=C.addLength1||!1,Fe=G.length,Ye=C.objectId,rt=function(Qa){return Qa};if(d!==null&&Ye===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(rt=Ja.encryptor(Ye,0));var gt={};oe===!0&&(oe=["FlateEncode"]);var Tt=C.additionalKeyValues||[],At=(gt=yt.API.processDataByFilters!==void 0?yt.API.processDataByFilters(G,oe):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(pe)?pe.join(" "):pe.toString());if(gt.data.length!==0&&(Tt.push({key:"Length",value:gt.data.length}),Se===!0&&Tt.push({key:"Length1",value:Fe})),At.length!=0)if(At.split("/").length-1==1)Tt.push({key:"Filter",value:At});else{Tt.push({key:"Filter",value:"["+At+"]"});for(var Gt=0;Gt<Tt.length;Gt+=1)if(Tt[Gt].key==="DecodeParms"){for(var Fn=[],Wn=0;Wn<gt.reverseChain.split("/").length-1;Wn+=1)Fn.push("null");Fn.push(Tt[Gt].value),Tt[Gt].value="["+Fn.join(" ")+"]"}}ne("<<");for(var la=0;la<Tt.length;la++)ne("/"+Tt[la].key+" "+Tt[la].value);ne(">>"),gt.data.length!==0&&(ne("stream"),ne(rt(gt.data)),ne("endstream"))},Zt=f.__private__.putPage=function(C){var G=C.number,oe=C.data,pe=C.objId,Se=C.contentsObjId;Ua(pe,!0),ne("<</Type /Page"),ne("/Parent "+C.rootDictionaryObjId+" 0 R"),ne("/Resources "+C.resourceDictionaryObjId+" 0 R"),ne("/MediaBox ["+parseFloat(_(C.mediaBox.bottomLeftX))+" "+parseFloat(_(C.mediaBox.bottomLeftY))+" "+_(C.mediaBox.topRightX)+" "+_(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&ne("/CropBox ["+_(C.cropBox.bottomLeftX)+" "+_(C.cropBox.bottomLeftY)+" "+_(C.cropBox.topRightX)+" "+_(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&ne("/BleedBox ["+_(C.bleedBox.bottomLeftX)+" "+_(C.bleedBox.bottomLeftY)+" "+_(C.bleedBox.topRightX)+" "+_(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&ne("/TrimBox ["+_(C.trimBox.bottomLeftX)+" "+_(C.trimBox.bottomLeftY)+" "+_(C.trimBox.topRightX)+" "+_(C.trimBox.topRightY)+"]"),C.artBox!==null&&ne("/ArtBox ["+_(C.artBox.bottomLeftX)+" "+_(C.artBox.bottomLeftY)+" "+_(C.artBox.topRightX)+" "+_(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&ne("/UserUnit "+C.userUnit),qt.publish("putPage",{objId:pe,pageContext:mt[G],pageNumber:G,page:oe}),ne("/Contents "+Se+" 0 R"),ne(">>"),ne("endobj");var Fe=oe.join(`
`);return y===x.ADVANCED&&(Fe+=`
Q`),Ua(Se,!0),Wt({data:Fe,filters:St(),objectId:Se}),ne("endobj"),pe},ma=f.__private__.putPages=function(){var C,G,oe=[];for(C=1;C<=It;C++)mt[C].objId=Tn(),mt[C].contentsObjId=Tn();for(C=1;C<=It;C++)oe.push(Zt({number:C,data:ge[C],objId:mt[C].objId,contentsObjId:mt[C].contentsObjId,mediaBox:mt[C].mediaBox,cropBox:mt[C].cropBox,bleedBox:mt[C].bleedBox,trimBox:mt[C].trimBox,artBox:mt[C].artBox,userUnit:mt[C].userUnit,rootDictionaryObjId:Kr,resourceDictionaryObjId:jr}));Ua(Kr,!0),ne("<</Type /Pages");var pe="/Kids [";for(G=0;G<It;G++)pe+=oe[G]+" 0 R ";ne(pe+"]"),ne("/Count "+It),ne(">>"),ne("endobj"),qt.publish("postPutPages")},Aa=function(C){qt.publish("putFont",{font:C,out:ne,newObject:In,putStream:Wt}),C.isAlreadyPutted!==!0&&(C.objectNumber=In(),ne("<<"),ne("/Type /Font"),ne("/BaseFont /"+Qc(C.postScriptName)),ne("/Subtype /Type1"),typeof C.encoding=="string"&&ne("/Encoding /"+C.encoding),ne("/FirstChar 32"),ne("/LastChar 255"),ne(">>"),ne("endobj"))},ms=function(){for(var C in Mt)Mt.hasOwnProperty(C)&&(h===!1||h===!0&&p.hasOwnProperty(C))&&Aa(Mt[C])},Bo=function(C){C.objectNumber=In();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[_(C.x),_(C.y),_(C.x+C.width),_(C.y+C.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var oe=C.pages[1].join(`
`);Wt({data:oe,additionalKeyValues:G,objectId:C.objectNumber}),ne("endobj")},zo=function(){for(var C in pn)pn.hasOwnProperty(C)&&Bo(pn[C])},$p=function(C,G){var oe,pe=[],Se=1/(G-1);for(oe=0;oe<1;oe+=Se)pe.push(oe);if(pe.push(1),C[0].offset!=0){var Fe={offset:0,color:C[0].color};C.unshift(Fe)}if(C[C.length-1].offset!=1){var Ye={offset:1,color:C[C.length-1].color};C.push(Ye)}for(var rt="",gt=0,Tt=0;Tt<pe.length;Tt++){for(oe=pe[Tt];oe>C[gt+1].offset;)gt++;var At=C[gt].offset,Gt=(oe-At)/(C[gt+1].offset-At),Fn=C[gt].color,Wn=C[gt+1].color;rt+=X(Math.round((1-Gt)*Fn[0]+Gt*Wn[0]).toString(16))+X(Math.round((1-Gt)*Fn[1]+Gt*Wn[1]).toString(16))+X(Math.round((1-Gt)*Fn[2]+Gt*Wn[2]).toString(16))}return rt.trim()},cx=function(C,G){G||(G=21);var oe=In(),pe=$p(C.colors,G),Se=[];Se.push({key:"FunctionType",value:"0"}),Se.push({key:"Domain",value:"[0.0 1.0]"}),Se.push({key:"Size",value:"["+G+"]"}),Se.push({key:"BitsPerSample",value:"8"}),Se.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Se.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Wt({data:pe,additionalKeyValues:Se,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:oe}),ne("endobj"),C.objectNumber=In(),ne("<< /ShadingType "+C.type),ne("/ColorSpace /DeviceRGB");var Fe="/Coords ["+_(parseFloat(C.coords[0]))+" "+_(parseFloat(C.coords[1]))+" ";C.type===2?Fe+=_(parseFloat(C.coords[2]))+" "+_(parseFloat(C.coords[3])):Fe+=_(parseFloat(C.coords[2]))+" "+_(parseFloat(C.coords[3]))+" "+_(parseFloat(C.coords[4]))+" "+_(parseFloat(C.coords[5])),ne(Fe+="]"),C.matrix&&ne("/Matrix ["+C.matrix.toString()+"]"),ne("/Function "+oe+" 0 R"),ne("/Extend [true true]"),ne(">>"),ne("endobj")},dx=function(C,G){var oe=Tn(),pe=In();G.push({resourcesOid:oe,objectOid:pe}),C.objectNumber=pe;var Se=[];Se.push({key:"Type",value:"/Pattern"}),Se.push({key:"PatternType",value:"1"}),Se.push({key:"PaintType",value:"1"}),Se.push({key:"TilingType",value:"1"}),Se.push({key:"BBox",value:"["+C.boundingBox.map(_).join(" ")+"]"}),Se.push({key:"XStep",value:_(C.xStep)}),Se.push({key:"YStep",value:_(C.yStep)}),Se.push({key:"Resources",value:oe+" 0 R"}),C.matrix&&Se.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),Wt({data:C.stream,additionalKeyValues:Se,objectId:C.objectNumber}),ne("endobj")},cc=function(C){var G;for(G in Vt)Vt.hasOwnProperty(G)&&(Vt[G]instanceof pl?cx(Vt[G]):Vt[G]instanceof Su&&dx(Vt[G],C))},Kp=function(C){for(var G in C.objectNumber=In(),ne("<<"),C)switch(G){case"opacity":ne("/ca "+P(C[G]));break;case"stroke-opacity":ne("/CA "+P(C[G]))}ne(">>"),ne("endobj")},hx=function(){var C;for(C in Cn)Cn.hasOwnProperty(C)&&Kp(Cn[C])},ph=function(){for(var C in ne("/XObject <<"),pn)pn.hasOwnProperty(C)&&pn[C].objectNumber>=0&&ne("/"+C+" "+pn[C].objectNumber+" 0 R");qt.publish("putXobjectDict"),ne(">>")},fx=function(){Ja.oid=In(),ne("<<"),ne("/Filter /Standard"),ne("/V "+Ja.v),ne("/R "+Ja.r),ne("/U <"+Ja.toHexString(Ja.U)+">"),ne("/O <"+Ja.toHexString(Ja.O)+">"),ne("/P "+Ja.P),ne(">>"),ne("endobj")},Yp=function(){for(var C in ne("/Font <<"),Mt)Mt.hasOwnProperty(C)&&(h===!1||h===!0&&p.hasOwnProperty(C))&&ne("/"+C+" "+Mt[C].objectNumber+" 0 R");ne(">>")},px=function(){if(Object.keys(Vt).length>0){for(var C in ne("/Shading <<"),Vt)Vt.hasOwnProperty(C)&&Vt[C]instanceof pl&&Vt[C].objectNumber>=0&&ne("/"+C+" "+Vt[C].objectNumber+" 0 R");qt.publish("putShadingPatternDict"),ne(">>")}},dc=function(C){if(Object.keys(Vt).length>0){for(var G in ne("/Pattern <<"),Vt)Vt.hasOwnProperty(G)&&Vt[G]instanceof f.TilingPattern&&Vt[G].objectNumber>=0&&Vt[G].objectNumber<C&&ne("/"+G+" "+Vt[G].objectNumber+" 0 R");qt.publish("putTilingPatternDict"),ne(">>")}},mx=function(){if(Object.keys(Cn).length>0){var C;for(C in ne("/ExtGState <<"),Cn)Cn.hasOwnProperty(C)&&Cn[C].objectNumber>=0&&ne("/"+C+" "+Cn[C].objectNumber+" 0 R");qt.publish("putGStateDict"),ne(">>")}},Jn=function(C){Ua(C.resourcesOid,!0),ne("<<"),ne("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Yp(),px(),dc(C.objectOid),mx(),ph(),ne(">>"),ne("endobj")},Xp=function(){var C=[];ms(),hx(),zo(),cc(C),qt.publish("putResources"),C.forEach(Jn),Jn({resourcesOid:jr,objectOid:Number.MAX_SAFE_INTEGER}),qt.publish("postPutResources")},Jp=function(){qt.publish("putAdditionalObjects");for(var C=0;C<he.length;C++){var G=he[C];Ua(G.objId,!0),ne(G.content),ne("endobj")}qt.publish("postPutAdditionalObjects")},Qp=function(C){xn[C.fontName]=xn[C.fontName]||{},xn[C.fontName][C.fontStyle]=C.id},mh=function(C,G,oe,pe,Se){var Fe={id:"F"+(Object.keys(Mt).length+1).toString(10),postScriptName:C,fontName:G,fontStyle:oe,encoding:pe,isStandardFont:Se||!1,metadata:{}};return qt.publish("addFont",{font:Fe,instance:this}),Mt[Fe.id]=Fe,Qp(Fe),Fe.id},gx=function(C){for(var G=0,oe=ke.length;G<oe;G++){var pe=mh.call(this,C[G][0],C[G][1],C[G][2],ke[G][3],!0);h===!1&&(p[pe]=!0);var Se=C[G][0].split("-");Qp({id:pe,fontName:Se[0],fontStyle:Se[1]||""})}qt.publish("addFonts",{fonts:Mt,dictionary:xn})},Ki=function(C){return C.foo=function(){try{return C.apply(this,arguments)}catch(pe){var G=pe.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var oe="Error in function "+G.split(`
`)[0].split("<")[0]+": "+pe.message;if(!Nt.console)throw new Error(oe);Nt.console.error(oe,pe),Nt.alert&&alert(oe)}},C.foo.bar=C,C.foo},hc=function(C,G){var oe,pe,Se,Fe,Ye,rt,gt,Tt,At;if(Se=(G=G||{}).sourceEncoding||"Unicode",Ye=G.outputEncoding,(G.autoencode||Ye)&&Mt[et].metadata&&Mt[et].metadata[Se]&&Mt[et].metadata[Se].encoding&&(Fe=Mt[et].metadata[Se].encoding,!Ye&&Mt[et].encoding&&(Ye=Mt[et].encoding),!Ye&&Fe.codePages&&(Ye=Fe.codePages[0]),typeof Ye=="string"&&(Ye=Fe[Ye]),Ye)){for(gt=!1,rt=[],oe=0,pe=C.length;oe<pe;oe++)(Tt=Ye[C.charCodeAt(oe)])?rt.push(String.fromCharCode(Tt)):rt.push(C[oe]),rt[oe].charCodeAt(0)>>8&&(gt=!0);C=rt.join("")}for(oe=C.length;gt===void 0&&oe!==0;)C.charCodeAt(oe-1)>>8&&(gt=!0),oe--;if(!gt)return C;for(rt=G.noBOM?[]:[254,255],oe=0,pe=C.length;oe<pe;oe++){if((At=(Tt=C.charCodeAt(oe))>>8)>>8)throw new Error("Character at position "+oe+" of string '"+C+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");rt.push(At),rt.push(Tt-(At<<8))}return String.fromCharCode.apply(void 0,rt)},Cr=f.__private__.pdfEscape=f.pdfEscape=function(C,G){return hc(C,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},gh=f.__private__.beginPage=function(C){ge[++It]=[],mt[It]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},em(It),me(ge[H])},Zp=function(C,G){var oe,pe,Se;switch(n=G||n,typeof C=="string"&&(oe=m(C.toLowerCase()),Array.isArray(oe)&&(pe=oe[0],Se=oe[1])),Array.isArray(C)&&(pe=C[0]*Ke,Se=C[1]*Ke),isNaN(pe)&&(pe=r[0],Se=r[1]),(pe>14400||Se>14400)&&(yn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),pe=Math.min(14400,pe),Se=Math.min(14400,Se)),r=[pe,Se],n.substr(0,1)){case"l":Se>pe&&(r=[Se,pe]);break;case"p":pe>Se&&(r=[Se,pe])}gh(r),sm(yh),ne(Yi),Nh!==0&&ne(Nh+" J"),kh!==0&&ne(kh+" j"),qt.publish("addPage",{pageNumber:It})},vx=function(C){C>0&&C<=It&&(ge.splice(C,1),mt.splice(C,1),It--,H>It&&(H=It),this.setPage(H))},em=function(C){C>0&&C<=It&&(H=C)},xx=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return ge.length-1},tm=function(C,G,oe){var pe,Se=void 0;return oe=oe||{},C=C!==void 0?C:Mt[et].fontName,G=G!==void 0?G:Mt[et].fontStyle,pe=C.toLowerCase(),xn[pe]!==void 0&&xn[pe][G]!==void 0?Se=xn[pe][G]:xn[C]!==void 0&&xn[C][G]!==void 0?Se=xn[C][G]:oe.disableWarning===!1&&yn.warn("Unable to look up font label for font '"+C+"', '"+G+"'. Refer to getFontList() for available fonts."),Se||oe.noFallback||(Se=xn.times[G])==null&&(Se=xn.times.normal),Se},bx=f.__private__.putInfo=function(){var C=In(),G=function(pe){return pe};for(var oe in d!==null&&(G=Ja.encryptor(C,0)),ne("<<"),ne("/Producer ("+Cr(G("jsPDF "+yt.version))+")"),We)We.hasOwnProperty(oe)&&We[oe]&&ne("/"+oe.substr(0,1).toUpperCase()+oe.substr(1)+" ("+Cr(G(We[oe]))+")");ne("/CreationDate ("+Cr(G(U))+")"),ne(">>"),ne("endobj")},vh=f.__private__.putCatalog=function(C){var G=(C=C||{}).rootDictionaryObjId||Kr;switch(In(),ne("<<"),ne("/Type /Catalog"),ne("/Pages "+G+" 0 R"),Ae||(Ae="fullwidth"),Ae){case"fullwidth":ne("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ne("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ne("/OpenAction [3 0 R /Fit]");break;case"original":ne("/OpenAction [3 0 R /XYZ null null 1]");break;default:var oe=""+Ae;oe.substr(oe.length-1)==="%"&&(Ae=parseInt(Ae)/100),typeof Ae=="number"&&ne("/OpenAction [3 0 R /XYZ null null "+P(Ae)+"]")}switch(Je||(Je="continuous"),Je){case"continuous":ne("/PageLayout /OneColumn");break;case"single":ne("/PageLayout /SinglePage");break;case"two":case"twoleft":ne("/PageLayout /TwoColumnLeft");break;case"tworight":ne("/PageLayout /TwoColumnRight")}Qe&&ne("/PageMode /"+Qe),qt.publish("putCatalog"),ne(">>"),ne("endobj")},yx=f.__private__.putTrailer=function(){ne("trailer"),ne("<<"),ne("/Size "+(W+1)),ne("/Root "+W+" 0 R"),ne("/Info "+(W-1)+" 0 R"),d!==null&&ne("/Encrypt "+Ja.oid+" 0 R"),ne("/ID [ <"+O+"> <"+O+"> ]"),ne(">>")},wx=f.__private__.putHeader=function(){ne("%PDF-"+g),ne("%ºß¬à")},Nx=f.__private__.putXRef=function(){var C="0000000000";ne("xref"),ne("0 "+(W+1)),ne("0000000000 65535 f ");for(var G=1;G<=W;G++)typeof ie[G]=="function"?ne((C+ie[G]()).slice(-10)+" 00000 n "):ie[G]!==void 0?ne((C+ie[G]).slice(-10)+" 00000 n "):ne("0000000000 00000 n ")},Qs=f.__private__.buildDocument=function(){fe(),me(ce),qt.publish("buildDocument"),wx(),ma(),Jp(),Xp(),d!==null&&fx(),bx(),vh();var C=ue;return Nx(),yx(),ne("startxref"),ne(""+C),ne("%%EOF"),me(ge[H]),ce.join(`
`)},fc=f.__private__.getBlob=function(C){return new Blob([Oe(C)],{type:"application/pdf"})},pc=f.output=f.__private__.output=Ki(function(C,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",C){case void 0:return Qs();case"save":f.save(G.filename);break;case"arraybuffer":return Oe(Qs());case"blob":return fc(Qs());case"bloburi":case"bloburl":if(Nt.URL!==void 0&&typeof Nt.URL.createObjectURL=="function")return Nt.URL&&Nt.URL.createObjectURL(fc(Qs()))||void 0;yn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var oe="",pe=Qs();try{oe=x2(pe)}catch{oe=x2(unescape(encodeURIComponent(pe)))}return"data:application/pdf;filename="+G.filename+";base64,"+oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Nt)==="[object Window]"){var Se="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Fe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(Se=G.pdfObjectUrl,Fe="");var Ye='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Se+'"'+Fe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",rt=Nt.open();return rt!==null&&rt.document.write(Ye),rt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Nt)==="[object Window]"){var gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',Tt=Nt.open();if(Tt!==null){Tt.document.write(gt);var At=this;Tt.document.documentElement.querySelector("#pdfViewer").onload=function(){Tt.document.title=G.filename,Tt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(At.output("bloburl"))}}return Tt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Nt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',Fn=Nt.open();if(Fn!==null&&(Fn.document.write(Gt),Fn.document.title=G.filename),Fn||typeof safari>"u")return Fn;break;case"datauri":case"dataurl":return Nt.document.location.href=this.output("datauristring",G);default:return null}}),nm=function(C){return Array.isArray(Qt)===!0&&Qt.indexOf(C)>-1};switch(a){case"pt":Ke=1;break;case"mm":Ke=72/25.4;break;case"cm":Ke=72/2.54;break;case"in":Ke=72;break;case"px":Ke=nm("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ke=12;break;case"ex":Ke=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Ke=a}var Ja=null;Z(),q();var kx=function(C){return d!==null?Ja.encryptor(C,0):function(G){return G}},am=f.__private__.getPageInfo=f.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:mt[C].objId,pageNumber:C,pageContext:mt[C]}},jt=f.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in mt)if(mt[G].objId===C)break;return am(G)},Sx=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:mt[H].objId,pageNumber:H,pageContext:mt[H]}};f.addPage=function(){return Zp.apply(this,arguments),this},f.setPage=function(){return em.apply(this,arguments),me.call(this,ge[H]),this},f.insertPage=function(C){return this.addPage(),this.movePage(H,C),this},f.movePage=function(C,G){var oe,pe;if(C>G){oe=ge[C],pe=mt[C];for(var Se=C;Se>G;Se--)ge[Se]=ge[Se-1],mt[Se]=mt[Se-1];ge[G]=oe,mt[G]=pe,this.setPage(G)}else if(C<G){oe=ge[C],pe=mt[C];for(var Fe=C;Fe<G;Fe++)ge[Fe]=ge[Fe+1],mt[Fe]=mt[Fe+1];ge[G]=oe,mt[G]=pe,this.setPage(G)}return this},f.deletePage=function(){return vx.apply(this,arguments),this},f.__private__.text=f.text=function(C,G,oe,pe,Se){var Fe,Ye,rt,gt,Tt,At,Gt,Fn,Wn,la=(pe=pe||{}).scope||this;if(typeof C=="number"&&typeof G=="number"&&(typeof oe=="string"||Array.isArray(oe))){var Qa=oe;oe=G,G=C,C=Qa}if(arguments[3]instanceof vt?(A("The transform parameter of text() with a Matrix value"),Wn=Se):(rt=arguments[4],gt=arguments[5],hn(Gt=arguments[3])==="object"&&Gt!==null||(typeof rt=="string"&&(gt=rt,rt=null),typeof Gt=="string"&&(gt=Gt,Gt=null),typeof Gt=="number"&&(rt=Gt,Gt=null),pe={flags:Gt,angle:rt,align:gt})),isNaN(G)||isNaN(oe)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return la;var Ea="",Xi=!1,Jr=typeof pe.lineHeightFactor=="number"?pe.lineHeightFactor:nu,xs=la.internal.scaleFactor;function hm(Nn){return Nn=Nn.split("	").join(Array(pe.TabLen||9).join(" ")),Cr(Nn,Gt)}function Ah(Nn){for(var kn,Zn=Nn.concat(),ga=[],ao=Zn.length;ao--;)typeof(kn=Zn.shift())=="string"?ga.push(kn):Array.isArray(Nn)&&(kn.length===1||kn[1]===void 0&&kn[2]===void 0)?ga.push(kn[0]):ga.push([kn[0],kn[1],kn[2]]);return ga}function Eh(Nn,kn){var Zn;if(typeof Nn=="string")Zn=kn(Nn)[0];else if(Array.isArray(Nn)){for(var ga,ao,Ih=Nn.concat(),Ec=[],vm=Ih.length;vm--;)typeof(ga=Ih.shift())=="string"?Ec.push(kn(ga)[0]):Array.isArray(ga)&&typeof ga[0]=="string"&&(ao=kn(ga[0],ga[1],ga[2]),Ec.push([ao[0],ao[1],ao[2]]));Zn=Ec}return Zn}var yc=!1,Dh=!0;if(typeof C=="string")yc=!0;else if(Array.isArray(C)){var Th=C.concat();Ye=[];for(var wc,qa=Th.length;qa--;)(typeof(wc=Th.shift())!="string"||Array.isArray(wc)&&typeof wc[0]!="string")&&(Dh=!1);yc=Dh}if(yc===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var Nc=xe/la.internal.scaleFactor,kc=Nc*(Jr-1);switch(pe.baseline){case"bottom":oe-=kc;break;case"top":oe+=Nc-kc;break;case"hanging":oe+=Nc-2*kc;break;case"middle":oe+=Nc/2-kc}if((At=pe.maxWidth||0)>0&&(typeof C=="string"?C=la.splitTextToSize(C,At):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(Nn,kn){return Nn.concat(la.splitTextToSize(kn,At))},[]))),Fe={text:C,x:G,y:oe,options:pe,mutex:{pdfEscape:Cr,activeFontKey:et,fonts:Mt,activeFontSize:xe}},qt.publish("preProcessText",Fe),C=Fe.text,rt=(pe=Fe.options).angle,!(Wn instanceof vt)&&rt&&typeof rt=="number"){rt*=Math.PI/180,pe.rotationDirection===0&&(rt=-rt),y===x.ADVANCED&&(rt=-rt);var Sc=Math.cos(rt),Lh=Math.sin(rt);Wn=new vt(Sc,Lh,-Lh,Sc,0,0)}else rt&&rt instanceof vt&&(Wn=rt);y!==x.ADVANCED||Wn||(Wn=_r),(Tt=pe.charSpace||vc)!==void 0&&(Ea+=_(E(Tt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Fn=pe.horizontalScale)!==void 0&&(Ea+=_(100*Fn)+` Tz
`),pe.lang;var Ar=-1,Rx=pe.renderingMode!==void 0?pe.renderingMode:pe.stroke,Ph=la.internal.getCurrentPageInfo().pageContext;switch(Rx){case 0:case!1:case"fill":Ar=0;break;case 1:case!0:case"stroke":Ar=1;break;case 2:case"fillThenStroke":Ar=2;break;case 3:case"invisible":Ar=3;break;case 4:case"fillAndAddForClipping":Ar=4;break;case 5:case"strokeAndAddPathForClipping":Ar=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ar=6;break;case 7:case"addToPathForClipping":Ar=7}var fm=Ph.usedRenderingMode!==void 0?Ph.usedRenderingMode:-1;Ar!==-1?Ea+=Ar+` Tr
`:fm!==-1&&(Ea+=`0 Tr
`),Ar!==-1&&(Ph.usedRenderingMode=Ar),gt=pe.align||"left";var Si,_c=xe*Jr,pm=la.internal.pageSize.getWidth(),mm=Mt[et];Tt=pe.charSpace||vc,At=pe.maxWidth||0,Gt=Object.assign({autoencode:!0,noBOM:!0},pe.flags);var Ho=[],iu=function(Nn){return la.getStringUnitWidth(Nn,{font:mm,charSpace:Tt,fontSize:xe,doKerning:!1})*xe/xs};if(Object.prototype.toString.call(C)==="[object Array]"){var Er;Ye=Ah(C),gt!=="left"&&(Si=Ye.map(iu));var pr,Vo=0;if(gt==="right"){G-=Si[0],C=[],qa=Ye.length;for(var eo=0;eo<qa;eo++)eo===0?(pr=vs(G),Er=Zs(oe)):(pr=E(Vo-Si[eo]),Er=-_c),C.push([Ye[eo],pr,Er]),Vo=Si[eo]}else if(gt==="center"){G-=Si[0]/2,C=[],qa=Ye.length;for(var to=0;to<qa;to++)to===0?(pr=vs(G),Er=Zs(oe)):(pr=E((Vo-Si[to])/2),Er=-_c),C.push([Ye[to],pr,Er]),Vo=Si[to]}else if(gt==="left"){C=[],qa=Ye.length;for(var jc=0;jc<qa;jc++)C.push(Ye[jc])}else if(gt==="justify"&&mm.encoding==="Identity-H"){C=[],qa=Ye.length,At=At!==0?At:pm;for(var no=0,Qn=0;Qn<qa;Qn++)if(Er=Qn===0?Zs(oe):-_c,pr=Qn===0?vs(G):no,Qn<qa-1){var Rh=E((At-Si[Qn])/(Ye[Qn].split(" ").length-1)),mr=Ye[Qn].split(" ");C.push([mr[0]+" ",pr,Er]),no=0;for(var _i=1;_i<mr.length;_i++){var Cc=(iu(mr[_i-1]+" "+mr[_i])-iu(mr[_i]))*xs+Rh;_i==mr.length-1?C.push([mr[_i],Cc,0]):C.push([mr[_i]+" ",Cc,0]),no-=Cc}}else C.push([Ye[Qn],pr,Er]);C.push(["",no,0])}else{if(gt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],qa=Ye.length,At=At!==0?At:pm,Qn=0;Qn<qa;Qn++)Er=Qn===0?Zs(oe):-_c,pr=Qn===0?vs(G):0,Qn<qa-1?Ho.push(_(E((At-Si[Qn])/(Ye[Qn].split(" ").length-1)))):Ho.push(0),C.push([Ye[Qn],pr,Er])}}var gm=typeof pe.R2L=="boolean"?pe.R2L:He;gm===!0&&(C=Eh(C,function(Nn,kn,Zn){return[Nn.split("").reverse().join(""),kn,Zn]})),Fe={text:C,x:G,y:oe,options:pe,mutex:{pdfEscape:Cr,activeFontKey:et,fonts:Mt,activeFontSize:xe}},qt.publish("postProcessText",Fe),C=Fe.text,Xi=Fe.mutex.isHex||!1;var Mh=Mt[et].encoding;Mh!=="WinAnsiEncoding"&&Mh!=="StandardEncoding"||(C=Eh(C,function(Nn,kn,Zn){return[hm(Nn),kn,Zn]})),Ye=Ah(C),C=[];for(var su,ou,Go,lu=0,Ac=1,uu=Array.isArray(Ye[0])?Ac:lu,$o="",Oh=function(Nn,kn,Zn){var ga="";return Zn instanceof vt?(Zn=typeof pe.angle=="number"?Sr(Zn,new vt(1,0,0,1,Nn,kn)):Sr(new vt(1,0,0,1,Nn,kn),Zn),y===x.ADVANCED&&(Zn=Sr(new vt(1,0,0,-1,0,0),Zn)),ga=Zn.join(" ")+` Tm
`):ga=_(Nn)+" "+_(kn)+` Td
`,ga},ji=0;ji<Ye.length;ji++){switch($o="",uu){case Ac:Go=(Xi?"<":"(")+Ye[ji][0]+(Xi?">":")"),su=parseFloat(Ye[ji][1]),ou=parseFloat(Ye[ji][2]);break;case lu:Go=(Xi?"<":"(")+Ye[ji]+(Xi?">":")"),su=vs(G),ou=Zs(oe)}Ho!==void 0&&Ho[ji]!==void 0&&($o=Ho[ji]+` Tw
`),ji===0?C.push($o+Oh(su,ou,Wn)+Go):uu===lu?C.push($o+Go):uu===Ac&&C.push($o+Oh(su,ou,Wn)+Go)}C=uu===lu?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var Ci=`BT
/`;return Ci+=et+" "+xe+` Tf
`,Ci+=_(xe*Jr)+` TL
`,Ci+=au+`
`,Ci+=Ea,Ci+=C,ne(Ci+="ET"),p[et]=!0,la};var _x=f.__private__.clip=f.clip=function(C){return ne(C==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return _x("evenodd")},f.__private__.discardPath=f.discardPath=function(){return ne("n"),this};var gs=f.__private__.isValidStyle=function(C){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(G=!0),G};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(C){return gs(C)&&(c=C),this};var rm=f.__private__.getStyle=f.getStyle=function(C){var G=c;switch(C){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=C}return G},im=f.close=function(){return ne("h"),this};f.stroke=function(){return ne("S"),this},f.fill=function(C){return mc("f",C),this},f.fillEvenOdd=function(C){return mc("f*",C),this},f.fillStroke=function(C){return mc("B",C),this},f.fillStrokeEvenOdd=function(C){return mc("B*",C),this};var mc=function(C,G){hn(G)==="object"?Cx(G,C):ne(C)},xh=function(C){C===null||y===x.ADVANCED&&C===void 0||(C=rm(C),ne(C))};function jx(C,G,oe,pe,Se){var Fe=new Su(G||this.boundingBox,oe||this.xStep,pe||this.yStep,this.gState,Se||this.matrix);Fe.stream=this.stream;var Ye=C+"$$"+this.cloneIndex+++"$$";return pa(Ye,Fe),Fe}var Cx=function(C,G){var oe=Js[C.key],pe=Vt[oe];if(pe instanceof pl)ne("q"),ne(Ax(G)),pe.gState&&f.setGState(pe.gState),ne(C.matrix.toString()+" cm"),ne("/"+oe+" sh"),ne("Q");else if(pe instanceof Su){var Se=new vt(1,0,0,-1,0,Wo());C.matrix&&(Se=Se.multiply(C.matrix||_r),oe=jx.call(pe,C.key,C.boundingBox,C.xStep,C.yStep,Se).id),ne("q"),ne("/Pattern cs"),ne("/"+oe+" scn"),pe.gState&&f.setGState(pe.gState),ne(G),ne("Q")}},Ax=function(C){switch(C){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},bh=f.moveTo=function(C,G){return ne(_(E(C))+" "+_(z(G))+" m"),this},tu=f.lineTo=function(C,G){return ne(_(E(C))+" "+_(z(G))+" l"),this},Uo=f.curveTo=function(C,G,oe,pe,Se,Fe){return ne([_(E(C)),_(z(G)),_(E(oe)),_(z(pe)),_(E(Se)),_(z(Fe)),"c"].join(" ")),this};f.__private__.line=f.line=function(C,G,oe,pe,Se){if(isNaN(C)||isNaN(G)||isNaN(oe)||isNaN(pe)||!gs(Se))throw new Error("Invalid arguments passed to jsPDF.line");return y===x.COMPAT?this.lines([[oe-C,pe-G]],C,G,[1,1],Se||"S"):this.lines([[oe-C,pe-G]],C,G,[1,1]).stroke()},f.__private__.lines=f.lines=function(C,G,oe,pe,Se,Fe){var Ye,rt,gt,Tt,At,Gt,Fn,Wn,la,Qa,Ea,Xi;if(typeof C=="number"&&(Xi=oe,oe=G,G=C,C=Xi),pe=pe||[1,1],Fe=Fe||!1,isNaN(G)||isNaN(oe)||!Array.isArray(C)||!Array.isArray(pe)||!gs(Se)||typeof Fe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(bh(G,oe),Ye=pe[0],rt=pe[1],Tt=C.length,Qa=G,Ea=oe,gt=0;gt<Tt;gt++)(At=C[gt]).length===2?(Qa=At[0]*Ye+Qa,Ea=At[1]*rt+Ea,tu(Qa,Ea)):(Gt=At[0]*Ye+Qa,Fn=At[1]*rt+Ea,Wn=At[2]*Ye+Qa,la=At[3]*rt+Ea,Qa=At[4]*Ye+Qa,Ea=At[5]*rt+Ea,Uo(Gt,Fn,Wn,la,Qa,Ea));return Fe&&im(),xh(Se),this},f.path=function(C){for(var G=0;G<C.length;G++){var oe=C[G],pe=oe.c;switch(oe.op){case"m":bh(pe[0],pe[1]);break;case"l":tu(pe[0],pe[1]);break;case"c":Uo.apply(this,pe);break;case"h":im()}}return this},f.__private__.rect=f.rect=function(C,G,oe,pe,Se){if(isNaN(C)||isNaN(G)||isNaN(oe)||isNaN(pe)||!gs(Se))throw new Error("Invalid arguments passed to jsPDF.rect");return y===x.COMPAT&&(pe=-pe),ne([_(E(C)),_(z(G)),_(E(oe)),_(E(pe)),"re"].join(" ")),xh(Se),this},f.__private__.triangle=f.triangle=function(C,G,oe,pe,Se,Fe,Ye){if(isNaN(C)||isNaN(G)||isNaN(oe)||isNaN(pe)||isNaN(Se)||isNaN(Fe)||!gs(Ye))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[oe-C,pe-G],[Se-oe,Fe-pe],[C-Se,G-Fe]],C,G,[1,1],Ye,!0),this},f.__private__.roundedRect=f.roundedRect=function(C,G,oe,pe,Se,Fe,Ye){if(isNaN(C)||isNaN(G)||isNaN(oe)||isNaN(pe)||isNaN(Se)||isNaN(Fe)||!gs(Ye))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var rt=4/3*(Math.SQRT2-1);return Se=Math.min(Se,.5*oe),Fe=Math.min(Fe,.5*pe),this.lines([[oe-2*Se,0],[Se*rt,0,Se,Fe-Fe*rt,Se,Fe],[0,pe-2*Fe],[0,Fe*rt,-Se*rt,Fe,-Se,Fe],[2*Se-oe,0],[-Se*rt,0,-Se,-Fe*rt,-Se,-Fe],[0,2*Fe-pe],[0,-Fe*rt,Se*rt,-Fe,Se,-Fe]],C+Se,G,[1,1],Ye,!0),this},f.__private__.ellipse=f.ellipse=function(C,G,oe,pe,Se){if(isNaN(C)||isNaN(G)||isNaN(oe)||isNaN(pe)||!gs(Se))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Fe=4/3*(Math.SQRT2-1)*oe,Ye=4/3*(Math.SQRT2-1)*pe;return bh(C+oe,G),Uo(C+oe,G-Ye,C+Fe,G-pe,C,G-pe),Uo(C-Fe,G-pe,C-oe,G-Ye,C-oe,G),Uo(C-oe,G+Ye,C-Fe,G+pe,C,G+pe),Uo(C+Fe,G+pe,C+oe,G+Ye,C+oe,G),xh(Se),this},f.__private__.circle=f.circle=function(C,G,oe,pe){if(isNaN(C)||isNaN(G)||isNaN(oe)||!gs(pe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,G,oe,oe,pe)},f.setFont=function(C,G,oe){return oe&&(G=D(G,oe)),et=tm(C,G,{disableWarning:!1}),this};var Ex=f.__private__.getFont=f.getFont=function(){return Mt[tm.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var C,G,oe={};for(C in xn)if(xn.hasOwnProperty(C))for(G in oe[C]=[],xn[C])xn[C].hasOwnProperty(G)&&oe[C].push(G);return oe},f.addFont=function(C,G,oe,pe,Se){var Fe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Fe.indexOf(arguments[3])!==-1?Se=arguments[3]:arguments[3]&&Fe.indexOf(arguments[3])==-1&&(oe=D(oe,pe)),Se=Se||"Identity-H",mh.call(this,C,G,oe,Se)};var nu,yh=e.lineWidth||.200025,gc=f.__private__.getLineWidth=f.getLineWidth=function(){return yh},sm=f.__private__.setLineWidth=f.setLineWidth=function(C){return yh=C,ne(_(E(C))+" w"),this};f.__private__.setLineDash=yt.API.setLineDash=yt.API.setLineDashPattern=function(C,G){if(C=C||[],G=G||0,isNaN(G)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map(function(oe){return _(E(oe))}).join(" "),G=_(E(G)),ne("["+C+"] "+G+" d"),this};var om=f.__private__.getLineHeight=f.getLineHeight=function(){return xe*nu};f.__private__.getLineHeight=f.getLineHeight=function(){return xe*nu};var lm=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(nu=C),this},um=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return nu};lm(e.lineHeight);var vs=f.__private__.getHorizontalCoordinate=function(C){return E(C)},Zs=f.__private__.getVerticalCoordinate=function(C){return y===x.ADVANCED?C:mt[H].mediaBox.topRightY-mt[H].mediaBox.bottomLeftY-E(C)},Dx=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(C){return _(vs(C))},qo=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(C){return _(Zs(C))},Yi=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Yr(Yi)},f.__private__.setStrokeColor=f.setDrawColor=function(C,G,oe,pe){return Yi=Xr({ch1:C,ch2:G,ch3:oe,ch4:pe,pdfColorType:"draw",precision:2}),ne(Yi),this};var wh=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Yr(wh)},f.__private__.setFillColor=f.setFillColor=function(C,G,oe,pe){return wh=Xr({ch1:C,ch2:G,ch3:oe,ch4:pe,pdfColorType:"fill",precision:2}),ne(wh),this};var au=e.textColor||"0 g",Tx=f.__private__.getTextColor=f.getTextColor=function(){return Yr(au)};f.__private__.setTextColor=f.setTextColor=function(C,G,oe,pe){return au=Xr({ch1:C,ch2:G,ch3:oe,ch4:pe,pdfColorType:"text",precision:3}),this};var vc=e.charSpace,Lx=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(vc||0)};f.__private__.setCharSpace=f.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return vc=C,this};var Nh=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(C){var G=f.CapJoinStyles[C];if(G===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nh=G,ne(G+" J"),this};var kh=0;f.__private__.setLineJoin=f.setLineJoin=function(C){var G=f.CapJoinStyles[C];if(G===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return kh=G,ne(G+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ne(_(E(C))+" M"),this},f.GState=up,f.setGState=function(C){(C=typeof C=="string"?Cn[$r[C]]:cm(null,C)).equals(Ni)||(ne("/"+C.id+" gs"),Ni=C)};var cm=function(C,G){if(!C||!$r[C]){var oe=!1;for(var pe in Cn)if(Cn.hasOwnProperty(pe)&&Cn[pe].equals(G)){oe=!0;break}if(oe)G=Cn[pe];else{var Se="GS"+(Object.keys(Cn).length+1).toString(10);Cn[Se]=G,G.id=Se}return C&&($r[C]=G.id),qt.publish("addGState",G),G}};f.addGState=function(C,G){return cm(C,G),this},f.saveGraphicsState=function(){return ne("q"),Gr.push({key:et,size:xe,color:au}),this},f.restoreGraphicsState=function(){ne("Q");var C=Gr.pop();return et=C.key,xe=C.size,au=C.color,Ni=null,this},f.setCurrentTransformationMatrix=function(C){return ne(C.toString()+" cm"),this},f.comment=function(C){return ne("#"+C),this};var xc=function(C,G){var oe=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return oe},set:function(Fe){isNaN(Fe)||(oe=parseFloat(Fe))}});var pe=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return pe},set:function(Fe){isNaN(Fe)||(pe=parseFloat(Fe))}});var Se="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Se},set:function(Fe){Se=Fe.toString()}}),this},Sh=function(C,G,oe,pe){xc.call(this,C,G),this.type="rect";var Se=oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Se},set:function(Ye){isNaN(Ye)||(Se=parseFloat(Ye))}});var Fe=pe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Fe},set:function(Ye){isNaN(Ye)||(Fe=parseFloat(Ye))}}),this},_h=function(){this.page=It,this.currentPage=H,this.pages=ge.slice(0),this.pagesContext=mt.slice(0),this.x=Ht,this.y=xt,this.matrix=Xn,this.width=ru(H),this.height=Wo(H),this.outputDestination=Te,this.id="",this.objectNumber=-1};_h.prototype.restore=function(){It=this.page,H=this.currentPage,mt=this.pagesContext,ge=this.pages,Ht=this.x,xt=this.y,Xn=this.matrix,jh(H,this.width),Ch(H,this.height),Te=this.outputDestination};var dm=function(C,G,oe,pe,Se){kr.push(new _h),It=H=0,ge=[],Ht=C,xt=G,Xn=Se,gh([oe,pe])},Px=function(C){if(ki[C])kr.pop().restore();else{var G=new _h,oe="Xo"+(Object.keys(pn).length+1).toString(10);G.id=oe,ki[C]=oe,pn[oe]=G,qt.publish("addFormObject",G),kr.pop().restore()}};for(var bc in f.beginFormObject=function(C,G,oe,pe,Se){return dm(C,G,oe,pe,Se),this},f.endFormObject=function(C){return Px(C),this},f.doFormObject=function(C,G){var oe=pn[ki[C]];return ne("q"),ne(G.toString()+" cm"),ne("/"+oe.id+" Do"),ne("Q"),this},f.getFormObject=function(C){var G=pn[ki[C]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},f.save=function(C,G){return C=C||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(yu(fc(Qs()),C),typeof yu.unload=="function"&&Nt.setTimeout&&setTimeout(yu.unload,911),this):new Promise(function(oe,pe){try{var Se=yu(fc(Qs()),C);typeof yu.unload=="function"&&Nt.setTimeout&&setTimeout(yu.unload,911),oe(Se)}catch(Fe){pe(Fe.message)}})},yt.API)yt.API.hasOwnProperty(bc)&&(bc==="events"&&yt.API.events.length?function(C,G){var oe,pe,Se;for(Se=G.length-1;Se!==-1;Se--)oe=G[Se][0],pe=G[Se][1],C.subscribe.apply(C,[oe].concat(typeof pe=="function"?[pe]:pe))}(qt,yt.API.events):f[bc]=yt.API[bc]);var ru=f.getPageWidth=function(C){return(mt[C=C||H].mediaBox.topRightX-mt[C].mediaBox.bottomLeftX)/Ke},jh=f.setPageWidth=function(C,G){mt[C].mediaBox.topRightX=G*Ke+mt[C].mediaBox.bottomLeftX},Wo=f.getPageHeight=function(C){return(mt[C=C||H].mediaBox.topRightY-mt[C].mediaBox.bottomLeftY)/Ke},Ch=f.setPageHeight=function(C,G){mt[C].mediaBox.topRightY=G*Ke+mt[C].mediaBox.bottomLeftY};return f.internal={pdfEscape:Cr,getStyle:rm,getFont:Ex,getFontSize:Ce,getCharSpace:Lx,getTextColor:Tx,getLineHeight:om,getLineHeightFactor:um,getLineWidth:gc,write:De,getHorizontalCoordinate:vs,getVerticalCoordinate:Zs,getCoordinateString:Dx,getVerticalCoordinateString:qo,collections:{},newObject:In,newAdditionalObject:Fo,newObjectDeferred:Tn,newObjectDeferredBegin:Ua,getFilters:St,putStream:Wt,events:qt,scaleFactor:Ke,pageSize:{getWidth:function(){return ru(H)},setWidth:function(C){jh(H,C)},getHeight:function(){return Wo(H)},setHeight:function(C){Ch(H,C)}},encryptionOptions:d,encryption:Ja,getEncryptor:kx,output:pc,getNumberOfPages:xx,pages:ge,out:ne,f2:P,f3:j,getPageInfo:am,getPageInfoByObjId:jt,getCurrentPageInfo:Sx,getPDFVersion:b,Point:xc,Rectangle:Sh,Matrix:vt,hasHotfix:nm},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ru(H)},set:function(C){jh(H,C)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Wo(H)},set:function(C){Ch(H,C)},enumerable:!0,configurable:!0}),gx.call(f,ke),et="F1",Zp(r,n),qt.publish("initialized"),f}Jc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Jc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Jc.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Jc.prototype.processOwnerPassword=function(e,t){return y2(b2(t).substr(0,5),e)},Jc.prototype.encryptor=function(e,t){var n=b2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return y2(n,a)}},up.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||hn(e)!==hn(this))return!1;var a=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&a--;return a===0},yt.API={events:[]},yt.version="2.5.2";var $n=yt.API,tN=1,uc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Dt=function(e){return e.toFixed(2)},sl=function(e){return e.toFixed(5)};$n.__acroform__={};var Vr=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Gk=function(e){return e*tN},ks=function(e){var t=new xD,n=ot.internal.getHeight(e)||0,a=ot.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Dt(a)),Number(Dt(n))],t},MG=$n.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},OG=$n.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},IG=$n.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},aa=$n.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return IG(e,t-1)},ra=$n.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return MG(e,t-1)},ia=$n.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return OG(e,t-1)},FG=$n.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,r=e[0],i=e[1],s=e[2],o=e[3],u={};return u.lowerLeft_X=n(r)||0,u.lowerLeft_Y=a(i+o)||0,u.upperRight_X=n(r+s)||0,u.upperRight_Y=a(i)||0,[Number(Dt(u.lowerLeft_X)),Number(Dt(u.lowerLeft_Y)),Number(Dt(u.upperRight_X)),Number(Dt(u.upperRight_Y))]},BG=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,a=w2(e,n),r=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+r+" "+Dt(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=ks(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},w2=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},r=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");r=e.multiline?r.map(function(j){return j.split(`
`)}):r.map(function(j){return[j]});var i=n,s=ot.internal.getHeight(e)||0;s=s<0?-s:s;var o=ot.internal.getWidth(e)||0;o=o<0?-o:o;var u=function(j,E,F){if(j+1<r.length){var z=E+" "+r[j+1][0];return bg(z,e,F).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,d,h=bg("3",e,i).height,p=e.multiline?s-i:(s-h)/2,f=p+=2,g=0,b=0,w=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+bg(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var m="",x=0,y=0;y<r.length;y++)if(r.hasOwnProperty(y)){var N=!1;if(r[y].length!==1&&w!==r[y].length-1){if((h+2)*(x+2)+2>s)continue e;m+=r[y][w],N=!0,b=y,y--}else{m=(m+=r[y][w]+" ").substr(m.length-1)==" "?m.substr(0,m.length-1):m;var S=parseInt(y),D=u(S,m,i),_=y>=r.length-1;if(D&&!_){m+=" ",w=0;continue}if(D||_){if(_)b=S;else if(e.multiline&&(h+2)*(x+2)+2>s)continue e}else{if(!e.multiline||(h+2)*(x+2)+2>s)continue e;b=S}}for(var A="",L=g;L<=b;L++){var P=r[L];if(e.multiline){if(L===b){A+=P[w]+" ",w=(w+1)%P.length;continue}if(L===g){A+=P[P.length-1]+" ";continue}}A+=P[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,d=bg(A,e,i).width,e.textAlign){case"right":c=o-d-2;break;case"center":c=(o-d)/2;break;case"left":default:c=2}t+=Dt(c)+" "+Dt(f)+` Td
`,t+="("+uc(A)+`) Tj
`,t+=-Dt(c)+` 0 Td
`,f=-(i+2),d=0,g=N?b:b+1,x++,m=""}break}return a.text=t,a.fontSize=i,a},bg=function(e,t,n){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),r=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},zG={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},UG=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===n.type&&a.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},qG=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var a=n,r=e[n];t.internal.newObjectDeferredBegin(r.objId,!0),hn(r)==="object"&&typeof r.putStream=="function"&&r.putStream(),delete e[a]}},WG=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(fs.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(zG)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");tN=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new bD,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in a)if(a.hasOwnProperty(r)){var i=a[r];i.objId=void 0,i.hasAnnotation&&UG(i,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(a,r){var i=!a;for(var s in a||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(s)){var o=a[s],u=[],c=o.Rect;if(o.Rect&&(o.Rect=FG(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ot.createDefaultAppearanceStream(o),hn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=BG(o);u.push({key:"AP",value:"<</N "+d+">>"}),r.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var f=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var g=f[s];typeof g=="function"&&(g=g.call(r,o)),h+="/"+s+" "+g+" ",r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(r,o)),h+="/"+s+" "+g,r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g);h+=">>"}u.push({key:"AP",value:`<<
`+h+">>"})}r.internal.putStream({additionalKeyValues:u,objectId:o.objId}),r.internal.out("endobj")}i&&qG(r.internal.acroformPlugin.xForms,r)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},vD=$n.__acroform__.arrayToPdfArray=function(e,t,n){var a=function(s){return s};if(Array.isArray(e)){for(var r="[",i=0;i<e.length;i++)switch(i!==0&&(r+=" "),hn(e[i])){case"boolean":case"number":case"object":r+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&n&&(a=n.internal.getEncryptor(t)),r+="("+uc(a(e[i].toString()))+")"):r+=e[i].toString()}return r+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},y1=function(e,t,n){var a=function(r){return r};return t!==void 0&&n&&(a=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+uc(a(e))+")"},Rs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Rs.prototype.toString=function(){return this.objId+" 0 R"},Rs.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Rs.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var a=t[n],r=this[a];r&&(Array.isArray(r)?e.push({key:a,value:vD(r,this.objId,this.scope)}):r instanceof Rs?(r.scope=this.scope,e.push({key:a,value:r.objId+" 0 R"})):typeof r!="function"&&e.push({key:a,value:r}))}return e};var xD=function(){Rs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Vr(xD,Rs);var bD=function(){Rs.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(a){return a};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+uc(n(e))+")"}},set:function(n){e=n}})};Vr(bD,Rs);var fs=function e(){Rs.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute F supplied.');t=m}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!aa(t,3)},set:function(m){m?this.F=ra(t,3):this.F=ia(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute Ff supplied.');n=m}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(m){a=m!==void 0?m:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(m){a[0]=m}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(m){a[1]=m}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(m){a[2]=m}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(m){a[3]=m}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(m){switch(m){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=m;break;default:throw new Error('Invalid value "'+m+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Z0)return;i="FieldObject"+e.FieldNum++}var m=function(x){return x};return this.scope&&(m=this.scope.internal.getEncryptor(this.objId)),"("+uc(m(i))+")"},set:function(m){i=m.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(m){i=m}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(m){s=m}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(m){o=m}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(m){u=m}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/tN:c},set:function(m){c=m}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(m){d=m}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Z0||this instanceof Il))return y1(h,this.objId,this.scope)},set:function(m){m=m.toString(),h=m}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof xa?p:y1(p,this.objId,this.scope)},set:function(m){m=m.toString(),p=this instanceof xa?m:m.substr(0,1)==="("?qc(m.substr(1,m.length-2)):qc(m)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof xa?qc(p.substr(1,p.length-1)):p},set:function(m){m=m.toString(),p=this instanceof xa?"/"+m:m}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(m){this.V=m}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof xa?f:y1(f,this.objId,this.scope)},set:function(m){m=m.toString(),f=this instanceof xa?m:m.substr(0,1)==="("?qc(m.substr(1,m.length-2)):qc(m)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof xa?qc(f.substr(1,f.length-1)):f},set:function(m){m=m.toString(),f=this instanceof xa?"/"+m:m}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(m){m=!!m,b=m}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(m){g=m}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,1)},set:function(m){m?this.Ff=ra(this.Ff,1):this.Ff=ia(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,2)},set:function(m){m?this.Ff=ra(this.Ff,2):this.Ff=ia(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,3)},set:function(m){m?this.Ff=ra(this.Ff,3):this.Ff=ia(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(m){if([0,1,2].indexOf(m)===-1)throw new Error('Invalid value "'+m+'" for attribute Q supplied.');w=m}}),Object.defineProperty(this,"textAlign",{get:function(){var m;switch(w){case 0:default:m="left";break;case 1:m="center";break;case 2:m="right"}return m},configurable:!0,enumerable:!0,set:function(m){switch(m){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Vr(fs,Rs);var Ou=function(){fs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return vD(t,this.objId,this.scope)},set:function(n){var a,r;r=[],typeof(a=n)=="string"&&(r=function(i,s,o){o||(o=1);for(var u,c=[];u=s.exec(i);)c.push(u[o]);return c}(a,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,a){for(a=a||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,18)},set:function(n){n?this.Ff=ra(this.Ff,18):this.Ff=ia(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=ra(this.Ff,19):this.Ff=ia(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,20)},set:function(n){n?(this.Ff=ra(this.Ff,20),t.sort()):this.Ff=ia(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,22)},set:function(n){n?this.Ff=ra(this.Ff,22):this.Ff=ia(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,23)},set:function(n){n?this.Ff=ra(this.Ff,23):this.Ff=ia(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,27)},set:function(n){n?this.Ff=ra(this.Ff,27):this.Ff=ia(this.Ff,27)}}),this.hasAppearanceStream=!1};Vr(Ou,fs);var Iu=function(){Ou.call(this),this.fontName="helvetica",this.combo=!1};Vr(Iu,Ou);var Fu=function(){Iu.call(this),this.combo=!0};Vr(Fu,Iu);var Df=function(){Fu.call(this),this.edit=!0};Vr(Df,Fu);var xa=function(){fs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,15)},set:function(n){n?this.Ff=ra(this.Ff,15):this.Ff=ia(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,16)},set:function(n){n?this.Ff=ra(this.Ff,16):this.Ff=ia(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,17)},set:function(n){n?this.Ff=ra(this.Ff,17):this.Ff=ia(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,26)},set:function(n){n?this.Ff=ra(this.Ff,26):this.Ff=ia(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,r=[];for(a in r.push("<<"),t)r.push("/"+a+" ("+uc(n(t[a]))+")");return r.push(">>"),r.join(`
`)}},set:function(n){hn(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Vr(xa,fs);var Tf=function(){xa.call(this),this.pushButton=!0};Vr(Tf,xa);var Bu=function(){xa.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Vr(Bu,xa);var Z0=function(){var e,t;fs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(r){t=r}});var n,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),a)s.push("/"+i+" ("+uc(r(a[i]))+")");return s.push(">>"),s.join(`
`)},set:function(r){hn(r)==="object"&&(a=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(r){typeof r=="string"&&(a.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ot.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Vr(Z0,fs),Bu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Bu.prototype.createOption=function(e){var t=new Z0;return t.Parent=this,t.optionName=e,this.Kids.push(t),HG.call(this.scope,t),t};var Lf=function(){xa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ot.CheckBox.createAppearanceStream()};Vr(Lf,xa);var Il=function(){fs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,13)},set:function(t){t?this.Ff=ra(this.Ff,13):this.Ff=ia(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,21)},set:function(t){t?this.Ff=ra(this.Ff,21):this.Ff=ia(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,23)},set:function(t){t?this.Ff=ra(this.Ff,23):this.Ff=ia(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,24)},set:function(t){t?this.Ff=ra(this.Ff,24):this.Ff=ia(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,25)},set:function(t){t?this.Ff=ra(this.Ff,25):this.Ff=ia(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,26)},set:function(t){t?this.Ff=ra(this.Ff,26):this.Ff=ia(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Vr(Il,fs);var Pf=function(){Il.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!aa(this.Ff,14)},set:function(e){e?this.Ff=ra(this.Ff,14):this.Ff=ia(this.Ff,14)}}),this.password=!0};Vr(Pf,Il);var ot={CheckBox:{createAppearanceStream:function(){return{N:{On:ot.CheckBox.YesNormal},D:{On:ot.CheckBox.YesPushDown,Off:ot.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=ks(e);t.scope=e.scope;var n=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=w2(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+a+" "+Dt(i.fontSize)+" Tf "+r),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=ks(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),r=[],i=ot.internal.getHeight(e),s=ot.internal.getWidth(e),o=w2(e,e.caption);return r.push("1 g"),r.push("0 0 "+Dt(s)+" "+Dt(i)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Dt(s-1)+" "+Dt(i-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+Dt(o.fontSize)+" Tf "+a),r.push(o.text),r.push("ET"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=ks(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ot.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ot.RadioButton.Circle.YesNormal,t.D[e]=ot.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=ks(e);t.scope=e.scope;var n=[],a=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var r=ot.internal.Bezier_C,i=Number((a*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+sl(ot.internal.getWidth(e)/2)+" "+sl(ot.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=ks(e);t.scope=e.scope;var n=[],a=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var r=Number((2*a).toFixed(5)),i=Number((r*ot.internal.Bezier_C).toFixed(5)),s=Number((a*ot.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+sl(ot.internal.getWidth(e)/2)+" "+sl(ot.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+sl(ot.internal.getWidth(e)/2)+" "+sl(ot.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),n.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),n.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),n.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=ks(e);t.scope=e.scope;var n=[],a=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var r=Number((2*a).toFixed(5)),i=Number((r*ot.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+sl(ot.internal.getWidth(e)/2)+" "+sl(ot.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ot.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ot.RadioButton.Cross.YesNormal,t.D[e]=ot.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=ks(e);t.scope=e.scope;var n=[],a=ot.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+Dt(ot.internal.getWidth(e)-2)+" "+Dt(ot.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Dt(a.x1.x)+" "+Dt(a.x1.y)+" m"),n.push(Dt(a.x2.x)+" "+Dt(a.x2.y)+" l"),n.push(Dt(a.x4.x)+" "+Dt(a.x4.y)+" m"),n.push(Dt(a.x3.x)+" "+Dt(a.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=ks(e);t.scope=e.scope;var n=ot.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Dt(ot.internal.getWidth(e)-2)+" "+Dt(ot.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Dt(n.x1.x)+" "+Dt(n.x1.y)+" m"),a.push(Dt(n.x2.x)+" "+Dt(n.x2.y)+" l"),a.push(Dt(n.x4.x)+" "+Dt(n.x4.y)+" m"),a.push(Dt(n.x3.x)+" "+Dt(n.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=ks(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(ot.internal.getWidth(e))+" "+Dt(ot.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};ot.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ot.internal.getWidth(e),n=ot.internal.getHeight(e),a=Math.min(t,n);return{x1:{x:(t-a)/2,y:(n-a)/2+a},x2:{x:(t-a)/2+a,y:(n-a)/2},x3:{x:(t-a)/2,y:(n-a)/2},x4:{x:(t-a)/2+a,y:(n-a)/2+a}}}},ot.internal.getWidth=function(e){var t=0;return hn(e)==="object"&&(t=Gk(e.Rect[2])),t},ot.internal.getHeight=function(e){var t=0;return hn(e)==="object"&&(t=Gk(e.Rect[3])),t};var HG=$n.addField=function(e){if(WG(this,e),!(e instanceof fs))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};$n.AcroFormChoiceField=Ou,$n.AcroFormListBox=Iu,$n.AcroFormComboBox=Fu,$n.AcroFormEditBox=Df,$n.AcroFormButton=xa,$n.AcroFormPushButton=Tf,$n.AcroFormRadioButton=Bu,$n.AcroFormCheckBox=Lf,$n.AcroFormTextField=Il,$n.AcroFormPasswordField=Pf,$n.AcroFormAppearance=ot,$n.AcroForm={ChoiceField:Ou,ListBox:Iu,ComboBox:Fu,EditBox:Df,Button:xa,PushButton:Tf,RadioButton:Bu,CheckBox:Lf,TextField:Il,PasswordField:Pf,Appearance:ot},yt.AcroForm={ChoiceField:Ou,ListBox:Iu,ComboBox:Fu,EditBox:Df,Button:xa,PushButton:Tf,RadioButton:Bu,CheckBox:Lf,TextField:Il,PasswordField:Pf,Appearance:ot};var VG=yt.AcroForm;function yD(e){return e.reduce(function(t,n,a){return t[n]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(j,E){var F,z,U,O,B,q=t;if((E=E||t)==="RGBA"||j.data!==void 0&&j.data instanceof Uint8ClampedArray&&"height"in j&&"width"in j)return"RGBA";if(D(j))for(B in n)for(U=n[B],F=0;F<U.length;F+=1){for(O=!0,z=0;z<U[F].length;z+=1)if(U[F][z]!==void 0&&U[F][z]!==j[z]){O=!1;break}if(O===!0){q=B;break}}else for(B in n)for(U=n[B],F=0;F<U.length;F+=1){for(O=!0,z=0;z<U[F].length;z+=1)if(U[F][z]!==void 0&&U[F][z]!==j.charCodeAt(z)){O=!1;break}if(O===!0){q=B;break}}return q===t&&E!==t&&(q=E),q},r=function j(E){for(var F=this.internal.write,z=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);E.objectId=this.internal.newObject();var O=[];if(O.push({key:"Type",value:"/XObject"}),O.push({key:"Subtype",value:"/Image"}),O.push({key:"Width",value:E.width}),O.push({key:"Height",value:E.height}),E.colorSpace===w.INDEXED?O.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(E.palette.length/3-1)+" "+("sMask"in E&&E.sMask!==void 0?E.objectId+2:E.objectId+1)+" 0 R]"}):(O.push({key:"ColorSpace",value:"/"+E.colorSpace}),E.colorSpace===w.DEVICE_CMYK&&O.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),O.push({key:"BitsPerComponent",value:E.bitsPerComponent}),"decodeParameters"in E&&E.decodeParameters!==void 0&&O.push({key:"DecodeParms",value:"<<"+E.decodeParameters+">>"}),"transparency"in E&&Array.isArray(E.transparency)){for(var B="",q=0,I=E.transparency.length;q<I;q++)B+=E.transparency[q]+" "+E.transparency[q]+" ";O.push({key:"Mask",value:"["+B+"]"})}E.sMask!==void 0&&O.push({key:"SMask",value:E.objectId+1+" 0 R"});var K=E.filter!==void 0?["/"+E.filter]:void 0;if(z({data:E.data,additionalKeyValues:O,alreadyAppliedFilters:K,objectId:E.objectId}),F("endobj"),"sMask"in E&&E.sMask!==void 0){var Z="/Predictor "+E.predictor+" /Colors 1 /BitsPerComponent "+E.bitsPerComponent+" /Columns "+E.width,R={width:E.width,height:E.height,colorSpace:"DeviceGray",bitsPerComponent:E.bitsPerComponent,decodeParameters:Z,data:E.sMask};"filter"in E&&(R.filter=E.filter),j.call(this,R)}if(E.colorSpace===w.INDEXED){var H=this.internal.newObject();z({data:A(new Uint8Array(E.palette)),objectId:H}),F("endobj")}},i=function(){var j=this.internal.collections.addImage_images;for(var E in j)r.call(this,j[E])},s=function(){var j,E=this.internal.collections.addImage_images,F=this.internal.write;for(var z in E)F("/I"+(j=E[z]).index,j.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},u=function(){var j=this.internal.collections.addImage_images;return o.call(this),j},c=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(j){return typeof e["process"+j.toUpperCase()]=="function"},h=function(j){return hn(j)==="object"&&j.nodeType===1},p=function(j,E){if(j.nodeName==="IMG"&&j.hasAttribute("src")){var F=""+j.getAttribute("src");if(F.indexOf("data:image/")===0)return Ef(unescape(F).split("base64,").pop());var z=e.loadFile(F,!0);if(z!==void 0)return z}if(j.nodeName==="CANVAS"){if(j.width===0||j.height===0)throw new Error("Given canvas must have data. Canvas width: "+j.width+", height: "+j.height);var U;switch(E){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;case"JPEG":case"JPG":default:U="image/jpeg"}return Ef(j.toDataURL(U,1).split("base64,").pop())}},f=function(j){var E=this.internal.collections.addImage_images;if(E){for(var F in E)if(j===E[F].alias)return E[F]}},g=function(j,E,F){return j||E||(j=-96,E=-96),j<0&&(j=-1*F.width*72/j/this.internal.scaleFactor),E<0&&(E=-1*F.height*72/E/this.internal.scaleFactor),j===0&&(j=E*F.width/F.height),E===0&&(E=j*F.height/F.width),[j,E]},b=function(j,E,F,z,U,O){var B=g.call(this,F,z,U),q=this.internal.getCoordinateString,I=this.internal.getVerticalCoordinateString,K=u.call(this);if(F=B[0],z=B[1],K[U.index]=U,O){O*=Math.PI/180;var Z=Math.cos(O),R=Math.sin(O),H=function(X){return X.toFixed(4)},$=[H(Z),H(R),H(-1*R),H(Z),0,0,"cm"]}this.internal.write("q"),O?(this.internal.write([1,"0","0",1,q(j),I(E+z),"cm"].join(" ")),this.internal.write($.join(" ")),this.internal.write([q(F),"0","0",q(z),"0","0","cm"].join(" "))):this.internal.write([q(F),"0","0",q(z),q(j),I(E+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},w=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var m=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},x=e.__addimage__.sHashCode=function(j){var E,F,z=0;if(typeof j=="string")for(F=j.length,E=0;E<F;E++)z=(z<<5)-z+j.charCodeAt(E),z|=0;else if(D(j))for(F=j.byteLength/2,E=0;E<F;E++)z=(z<<5)-z+j[E],z|=0;return z},y=e.__addimage__.validateStringAsBase64=function(j){(j=j||"").toString().trim();var E=!0;return j.length===0&&(E=!1),j.length%4!=0&&(E=!1),/^[A-Za-z0-9+/]+$/.test(j.substr(0,j.length-2))===!1&&(E=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(j.substr(-2))===!1&&(E=!1),E},N=e.__addimage__.extractImageFromDataUrl=function(j){var E=(j=j||"").split("base64,"),F=null;if(E.length===2){var z=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(E[0]);Array.isArray(z)&&(F={mimeType:z[1],charset:z[2],data:E[1]})}return F},S=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(j){return S()&&j instanceof ArrayBuffer};var D=e.__addimage__.isArrayBufferView=function(j){return S()&&typeof Uint32Array<"u"&&(j instanceof Int8Array||j instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&j instanceof Uint8ClampedArray||j instanceof Int16Array||j instanceof Uint16Array||j instanceof Int32Array||j instanceof Uint32Array||j instanceof Float32Array||j instanceof Float64Array)},_=e.__addimage__.binaryStringToUint8Array=function(j){for(var E=j.length,F=new Uint8Array(E),z=0;z<E;z++)F[z]=j.charCodeAt(z);return F},A=e.__addimage__.arrayBufferToBinaryString=function(j){for(var E="",F=D(j)?j:new Uint8Array(j),z=0;z<F.length;z+=8192)E+=String.fromCharCode.apply(null,F.subarray(z,z+8192));return E};e.addImage=function(){var j,E,F,z,U,O,B,q,I;if(typeof arguments[1]=="number"?(E=t,F=arguments[1],z=arguments[2],U=arguments[3],O=arguments[4],B=arguments[5],q=arguments[6],I=arguments[7]):(E=arguments[1],F=arguments[2],z=arguments[3],U=arguments[4],O=arguments[5],B=arguments[6],q=arguments[7],I=arguments[8]),hn(j=arguments[0])==="object"&&!h(j)&&"imageData"in j){var K=j;j=K.imageData,E=K.format||E||t,F=K.x||F||0,z=K.y||z||0,U=K.w||K.width||U,O=K.h||K.height||O,B=K.alias||B,q=K.compression||q,I=K.rotation||K.angle||I}var Z=this.internal.getFilters();if(q===void 0&&Z.indexOf("FlateEncode")!==-1&&(q="SLOW"),isNaN(F)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var R=L.call(this,j,E,B,q);return b.call(this,F,z,U,O,R,I),this};var L=function(j,E,F,z){var U,O,B;if(typeof j=="string"&&a(j)===t){j=unescape(j);var q=P(j,!1);(q!==""||(q=e.loadFile(j,!0))!==void 0)&&(j=q)}if(h(j)&&(j=p(j,E)),E=a(j,E),!d(E))throw new Error("addImage does not support files of type '"+E+"', please ensure that a plugin for '"+E+"' support is added.");if(((B=F)==null||B.length===0)&&(F=function(I){return typeof I=="string"||D(I)?x(I):D(I.data)?x(I.data):null}(j)),(U=f.call(this,F))||(S()&&(j instanceof Uint8Array||E==="RGBA"||(O=j,j=_(j))),U=this["process"+E.toUpperCase()](j,c.call(this),F,function(I){return I&&typeof I=="string"&&(I=I.toUpperCase()),I in e.image_compression?I:m.NONE}(z),O)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},P=e.__addimage__.convertBase64ToBinaryString=function(j,E){var F;E=typeof E!="boolean"||E;var z,U="";if(typeof j=="string"){z=(F=N(j))!==null?F.data:j;try{U=Ef(z)}catch(O){if(E)throw y(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+O.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return U};e.getImageProperties=function(j){var E,F,z="";if(h(j)&&(j=p(j)),typeof j=="string"&&a(j)===t&&((z=P(j,!1))===""&&(z=e.loadFile(j)||""),j=z),F=a(j),!d(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(!S()||j instanceof Uint8Array||(j=_(j)),!(E=this["process"+F.toUpperCase()](j)))throw new Error("An unknown error occurred whilst processing the image");return E.fileType=F,E}})(yt.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};yt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var a,r,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(n.objId),c=n.pageContext.annotations,d=!1,h=0;h<c.length&&!d;h++)switch((a=c[h]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){a=c[p];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(n.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(b.objId),x=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(r="/Rect ["+s(a.bounds.x)+" "+o(a.bounds.y+a.bounds.h)+" "+s(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y)+"] ")+"/Contents ("+f(m(a.contents))+")",i+=" /Popup "+w.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+f(m(x))+") >>",b.content=i;var y=b.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+s(a.bounds.x+30)+" "+o(a.bounds.y+a.bounds.h)+" "+s(a.bounds.x+a.bounds.w+30)+" "+o(a.bounds.y)+"] ")+" /Parent "+y,a.open&&(i+=" /Open true"),i+=" >>",w.content=i,this.internal.write(b.objId,"0 R",w.objId,"0 R");break;case"freetext":r="/Rect ["+s(a.bounds.x)+" "+o(a.bounds.y)+" "+s(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y+a.bounds.h)+"] ";var N=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+f(g(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var S=this.annotations._nameMap[a.options.name];a.options.pageNumber=S.page,a.options.top=S.y}else a.options.top||(a.options.top=0);if(r="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var D=o(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+D+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var a=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":a.pageContext.annotations.push(n)}},e.link=function(n,a,r,i,s){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(n),y:c(a),w:u(n+r),h:c(a+i)},options:s,type:"link"})},e.textWithLink=function(n,a,r,i){var s,o,u=this.getTextWidth(n),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var d=this.splitTextToSize(n,o).length;s=Math.ceil(c*d)}else o=u,s=c;return this.text(n,a,r,i),r+=.2*c,i.align==="center"&&(a-=u/2),i.align==="right"&&(a-=u),this.link(a,r-c,o,s,i),u},e.getTextWidth=function(n){var a=this.internal.getFontSize();return this.getStringUnitWidth(n)*a/this.internal.scaleFactor}}(yt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(b){return t[b.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},o=e.__arabicParser__.isArabicEndLetter=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(b){return s(b)&&r.indexOf(b.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(b){var w=0,m=n,x="",y=0;for(w=0;w<b.length;w+=1)m[b.charCodeAt(w)]!==void 0?(y++,typeof(m=m[b.charCodeAt(w)])=="number"&&(x+=String.fromCharCode(m),m=n,y=0),w===b.length-1&&(m=n,x+=b.charAt(w-(y-1)),w-=y-1,y=0)):(m=n,x+=b.charAt(w-y),w-=y,y=0);return x};e.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&a[b.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(b,w,m){return s(b)?i(b)===!1?-1:!c(b)||!s(w)&&!s(m)||!s(m)&&o(w)||o(b)&&!s(w)||o(b)&&u(w)||o(b)&&o(w)?0:d(b)&&s(w)&&!o(w)&&s(m)&&c(m)?3:o(b)||!s(m)?1:2:-1},f=function(b){var w=0,m=0,x=0,y="",N="",S="",D=(b=b||"").split("\\s+"),_=[];for(w=0;w<D.length;w+=1){for(_.push(""),m=0;m<D[w].length;m+=1)y=D[w][m],N=D[w][m-1],S=D[w][m+1],s(y)?(x=p(y,N,S),_[w]+=x!==-1?String.fromCharCode(t[y.charCodeAt(0)][x]):y):_[w]+=y;_[w]=h(_[w])}return _.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var b,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,m=[];if(Array.isArray(w)){var x=0;for(m=[],x=0;x<w.length;x+=1)Array.isArray(w[x])?m.push([f(w[x][0]),w[x][1],w[x][2]]):m.push([f(w[x])]);b=m}else b=f(w);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};e.events.push(["preProcessText",g])}(yt.API),yt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,a){var r;if((n=n||"2d")!=="2d")return null;for(r in a)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=a[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(yt.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(b){c=b}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(b){f=b}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(b){g=b}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,c){a.call(this);var d=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,f=0,g=0,b=0,w=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var m=c.maxWidth;m>0?typeof u=="string"?u=this.splitTextToSize(u,m):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(y,N){return y.concat(w.splitTextToSize(N,m))},[])):u=Array.isArray(u)?u:[u];for(var x=0;x<u.length;x++)f<(b=this.getStringUnitWidth(u[x],{font:h})*d)&&(f=b);return f!==0&&(g=u.length),{w:f/=p,h:Math.max((g*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var c=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===u.lineNumber?(u.x=(c.x||0)+(c.width||0),u.y=c.y||0):c.y+c.height+u.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=h.top,f&&p&&(this.printHeaderRow(u.lineNumber,!0),u.y+=p[0].height)):u.y=c.y+c.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,n===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-d,u.y+d,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+d,{align:"center",baseline:"top",maxWidth:u.width-d-d}):this.text(u.text,u.x+d,u.y+d,{align:"left",baseline:"top",maxWidth:u.width-d-d})),this.internal.__cell__.lastCell=u,this};e.table=function(u,c,d,h,p){if(a.call(this),!d)throw new Error("No data for PDF table.");var f,g,b,w,m=[],x=[],y=[],N={},S={},D=[],_=[],A=(p=p||{}).autoSize||!1,L=p.printHeaders!==!1,P=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,j=p.margins||Object.assign({width:this.getPageWidth()},t),E=typeof p.padding=="number"?p.padding:3,F=p.headerBackgroundColor||"#c8c8c8",z=p.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=j,this.internal.__cell__.table_font_size=P,this.internal.__cell__.padding=E,this.internal.__cell__.headerBackgroundColor=F,this.internal.__cell__.headerTextColor=z,this.setFontSize(P),h==null)x=m=Object.keys(d[0]),y=m.map(function(){return"left"});else if(Array.isArray(h)&&hn(h[0])==="object")for(m=h.map(function(K){return K.name}),x=h.map(function(K){return K.prompt||K.name||""}),y=h.map(function(K){return K.align||"left"}),f=0;f<h.length;f+=1)S[h[f].name]=h[f].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(x=m=h,y=m.map(function(){return"left"}));if(A||Array.isArray(h)&&typeof h[0]=="string")for(f=0;f<m.length;f+=1){for(N[w=m[f]]=d.map(function(K){return K[w]}),this.setFont(void 0,"bold"),D.push(this.getTextDimensions(x[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=N[w],this.setFont(void 0,"normal"),b=0;b<g.length;b+=1)D.push(this.getTextDimensions(g[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);S[w]=Math.max.apply(null,D)+E+E,D=[]}if(L){var U={};for(f=0;f<m.length;f+=1)U[m[f]]={},U[m[f]].text=x[f],U[m[f]].align=y[f];var O=o.call(this,U,S);_=m.map(function(K){return new i(u,c,S[K],O,U[K].text,void 0,U[K].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var B=h.reduce(function(K,Z){return K[Z.name]=Z.align,K},{});for(f=0;f<d.length;f+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:f,data:d[f]},this);var q=o.call(this,d[f],S);for(b=0;b<m.length;b+=1){var I=d[f][m[b]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:f,col:b,data:I},this),s.call(this,new i(u,c,S[m[b]],q,I,f+2,B[m[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=c,this};var o=function(u,c){var d=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(u).map(function(f){var g=u[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,c[f]-d-d)},this).map(function(f){return this.getLineHeightFactor()*f.length*h/p+d+d},this).reduce(function(f,g){return Math.max(f,g)},0)};e.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,c){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){d=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=u;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,d),this.setTextColor(g)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),n=!1}}(yt.API);var wD={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ND=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],N2=yD(ND),kD=[100,200,300,400,500,600,700,800,900],GG=yD(kD);function k2(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(i){return wD[i=i||"normal"]?i:"normal"}(e.style),a=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),r=function(i){return typeof N2[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:n,weight:a,stretch:r,src:e.src||[],ref:e.ref||{name:t,style:[r,n,a].join(" ")}}}function $k(e,t,n,a){var r;for(r=n;r>=0&&r<t.length;r+=a)if(e[t[r]])return e[t[r]];for(r=n;r>=0&&r<t.length;r-=a)if(e[t[r]])return e[t[r]]}var $G={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Kk={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Yk(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function KG(e,t,n){for(var a=(n=n||{}).defaultFontFamily||"times",r=Object.assign({},$G,n.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(r[(i=k2(t[o])).family]&&(i.family=r[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[a]))throw new Error("Could not find a font-family for the rule '"+Yk(i)+"' and default family '"+a+"'.");if(s=function(u,c){if(c[u])return c[u];var d=N2[u],h=d<=N2.normal?-1:1,p=$k(c,ND,d,h);if(!p)throw new Error("Could not find a matching font-stretch value for "+u);return p}(i.stretch,s),s=function(u,c){if(c[u])return c[u];for(var d=wD[u],h=0;h<d.length;++h)if(c[d[h]])return c[d[h]];throw new Error("Could not find a matching font-style for "+u)}(i.style,s),!(s=function(u,c){if(c[u])return c[u];if(u===400&&c[500])return c[500];if(u===500&&c[400])return c[400];var d=GG[u],h=$k(c,kD,d,u<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+u);return h}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+Yk(i)+"'.");return s}function Xk(e){return e.trimLeft()}function YG(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function XG(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var yg,Jk,Qk,w1=["times"];(function(e){var t,n,a,r,i,s,o,u,c,d=function(R){return R=R||{},this.isStrokeTransparent=R.isStrokeTransparent||!1,this.strokeOpacity=R.strokeOpacity||1,this.strokeStyle=R.strokeStyle||"#000000",this.fillStyle=R.fillStyle||"#000000",this.isFillTransparent=R.isFillTransparent||!1,this.fillOpacity=R.fillOpacity||1,this.font=R.font||"10px sans-serif",this.textBaseline=R.textBaseline||"alphabetic",this.textAlign=R.textAlign||"left",this.lineWidth=R.lineWidth||1,this.lineJoin=R.lineJoin||"miter",this.lineCap=R.lineCap||"butt",this.path=R.path||[],this.transform=R.transform!==void 0?R.transform.clone():new u,this.globalCompositeOperation=R.globalCompositeOperation||"normal",this.globalAlpha=R.globalAlpha||1,this.clip_path=R.clip_path||[],this.currentPoint=R.currentPoint||new s,this.miterLimit=R.miterLimit||10,this.lastPoint=R.lastPoint||new s,this.lineDashOffset=R.lineDashOffset||0,this.lineDash=R.lineDash||[],this.margin=R.margin||[0,0,0,0],this.prevPageLastElemOffset=R.prevPageLastElemOffset||0,this.ignoreClearRect=typeof R.ignoreClearRect!="boolean"||R.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,n=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,c=new d}]);var h=function(R){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=R;Object.defineProperty(this,"pdf",{get:function(){return H}});var $=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return $},set:function(me){$=!!me}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(me){X=!!me}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(me){isNaN(me)||(W=me)}});var ie=0;Object.defineProperty(this,"posY",{get:function(){return ie},set:function(me){isNaN(me)||(ie=me)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(me){var ne;typeof me=="number"?ne=[me,me,me,me]:((ne=new Array(4))[0]=me[0],ne[1]=me.length>=2?me[1]:ne[0],ne[2]=me.length>=3?me[2]:ne[0],ne[3]=me.length>=4?me[3]:ne[1]),c.margin=ne}});var ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ce},set:function(me){ce=me}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(me){ue=me}});var he=[];Object.defineProperty(this,"pageBreaks",{get:function(){return he},set:function(me){he=me}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(me){me instanceof d&&(c=me)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(me){c.path=me}});var ge=[];Object.defineProperty(this,"ctxStack",{get:function(){return ge},set:function(me){ge=me}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(me){var ne;ne=p(me),this.ctx.fillStyle=ne.style,this.ctx.isFillTransparent=ne.a===0,this.ctx.fillOpacity=ne.a,this.pdf.setFillColor(ne.r,ne.g,ne.b,{a:ne.a}),this.pdf.setTextColor(ne.r,ne.g,ne.b,{a:ne.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(me){var ne=p(me);this.ctx.strokeStyle=ne.style,this.ctx.isStrokeTransparent=ne.a===0,this.ctx.strokeOpacity=ne.a,ne.a===0?this.pdf.setDrawColor(255,255,255):(ne.a,this.pdf.setDrawColor(ne.r,ne.g,ne.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(me){["butt","round","square"].indexOf(me)!==-1&&(this.ctx.lineCap=me,this.pdf.setLineCap(me))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(me){isNaN(me)||(this.ctx.lineWidth=me,this.pdf.setLineWidth(me))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(me){["bevel","round","miter"].indexOf(me)!==-1&&(this.ctx.lineJoin=me,this.pdf.setLineJoin(me))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(me){isNaN(me)||(this.ctx.miterLimit=me,this.pdf.setMiterLimit(me))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(me){this.ctx.textBaseline=me}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(me){["right","end","center","left","start"].indexOf(me)!==-1&&(this.ctx.textAlign=me)}});var Ee=null;function Te(me,ne){if(Ee===null){var De=function(Oe){var ke=[];return Object.keys(Oe).forEach(function(xe){Oe[xe].forEach(function(Ae){var Ce=null;switch(Ae){case"bold":Ce={family:xe,weight:"bold"};break;case"italic":Ce={family:xe,style:"italic"};break;case"bolditalic":Ce={family:xe,weight:"bold",style:"italic"};break;case"":case"normal":Ce={family:xe}}Ce!==null&&(Ce.ref={name:xe,style:Ae},ke.push(Ce))})}),ke}(me.getFontList());Ee=function(Oe){for(var ke={},xe=0;xe<Oe.length;++xe){var Ae=k2(Oe[xe]),Ce=Ae.family,He=Ae.stretch,Qe=Ae.style,Ze=Ae.weight;ke[Ce]=ke[Ce]||{},ke[Ce][He]=ke[Ce][He]||{},ke[Ce][He][Qe]=ke[Ce][He][Qe]||{},ke[Ce][He][Qe][Ze]=Ae}return ke}(De.concat(ne))}return Ee}var fe=null;Object.defineProperty(this,"fontFaces",{get:function(){return fe},set:function(me){Ee=null,fe=me}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(me){var ne;if(this.ctx.font=me,(ne=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(me))!==null){var De=ne[1],Oe=(ne[2],ne[3]),ke=ne[4],xe=(ne[5],ne[6]),Ae=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ke)[2];ke=Math.floor(Ae==="px"?parseFloat(ke)*this.pdf.internal.scaleFactor:Ae==="em"?parseFloat(ke)*this.pdf.getFontSize():parseFloat(ke)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ke);var Ce=function(We){var et,Ke,Ht=[],xt=We.trim();if(xt==="")return w1;if(xt in Kk)return[Kk[xt]];for(;xt!=="";){switch(Ke=null,et=(xt=Xk(xt)).charAt(0)){case'"':case"'":Ke=YG(xt.substring(1),et);break;default:Ke=XG(xt)}if(Ke===null||(Ht.push(Ke[0]),(xt=Xk(Ke[1]))!==""&&xt.charAt(0)!==","))return w1;xt=xt.replace(/^,/,"")}return Ht}(xe);if(this.fontFaces){var He=KG(Te(this.pdf,this.fontFaces),Ce.map(function(We){return{family:We,stretch:"normal",weight:Oe,style:De}}));this.pdf.setFont(He.ref.name,He.ref.style)}else{var Qe="";(Oe==="bold"||parseInt(Oe,10)>=700||De==="bold")&&(Qe="bold"),De==="italic"&&(Qe+="italic"),Qe.length===0&&(Qe="normal");for(var Ze="",Je={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},le=0;le<Ce.length;le++){if(this.pdf.internal.getFont(Ce[le],Qe,{noFallback:!0,disableWarning:!0})!==void 0){Ze=Ce[le];break}if(Qe==="bolditalic"&&this.pdf.internal.getFont(Ce[le],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ze=Ce[le],Qe="bold";else if(this.pdf.internal.getFont(Ce[le],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ze=Ce[le],Qe="normal";break}}if(Ze===""){for(var Xe=0;Xe<Ce.length;Xe++)if(Je[Ce[Xe]]){Ze=Je[Ce[Xe]];break}}Ze=Ze===""?"Times":Ze,this.pdf.setFont(Ze,Qe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(me){this.ctx.globalCompositeOperation=me}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(me){this.ctx.globalAlpha=me}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(me){this.ctx.lineDashOffset=me,Z.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(me){this.ctx.lineDash=me,Z.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(me){this.ctx.ignoreClearRect=!!me}})};h.prototype.setLineDash=function(R){this.lineDash=R},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){N.call(this,"fill",!1)},h.prototype.stroke=function(){N.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(R,H){if(isNaN(R)||isNaN(H))throw yn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var $=this.ctx.transform.applyToPoint(new s(R,H));this.path.push({type:"mt",x:$.x,y:$.y}),this.ctx.lastPoint=new s(R,H)},h.prototype.closePath=function(){var R=new s(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&hn(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){R=new s(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(R.x,R.y)},h.prototype.lineTo=function(R,H){if(isNaN(R)||isNaN(H))throw yn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var $=this.ctx.transform.applyToPoint(new s(R,H));this.path.push({type:"lt",x:$.x,y:$.y}),this.ctx.lastPoint=new s($.x,$.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},h.prototype.quadraticCurveTo=function(R,H,$,X){if(isNaN($)||isNaN(X)||isNaN(R)||isNaN(H))throw yn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new s($,X)),ie=this.ctx.transform.applyToPoint(new s(R,H));this.path.push({type:"qct",x1:ie.x,y1:ie.y,x:W.x,y:W.y}),this.ctx.lastPoint=new s(W.x,W.y)},h.prototype.bezierCurveTo=function(R,H,$,X,W,ie){if(isNaN(W)||isNaN(ie)||isNaN(R)||isNaN(H)||isNaN($)||isNaN(X))throw yn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ce=this.ctx.transform.applyToPoint(new s(W,ie)),ue=this.ctx.transform.applyToPoint(new s(R,H)),he=this.ctx.transform.applyToPoint(new s($,X));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:he.x,y2:he.y,x:ce.x,y:ce.y}),this.ctx.lastPoint=new s(ce.x,ce.y)},h.prototype.arc=function(R,H,$,X,W,ie){if(isNaN(R)||isNaN(H)||isNaN($)||isNaN(X)||isNaN(W))throw yn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ie=!!ie,!this.ctx.transform.isIdentity){var ce=this.ctx.transform.applyToPoint(new s(R,H));R=ce.x,H=ce.y;var ue=this.ctx.transform.applyToPoint(new s(0,$)),he=this.ctx.transform.applyToPoint(new s(0,0));$=Math.sqrt(Math.pow(ue.x-he.x,2)+Math.pow(ue.y-he.y,2))}Math.abs(W-X)>=2*Math.PI&&(X=0,W=2*Math.PI),this.path.push({type:"arc",x:R,y:H,radius:$,startAngle:X,endAngle:W,counterclockwise:ie})},h.prototype.arcTo=function(R,H,$,X,W){throw new Error("arcTo not implemented.")},h.prototype.rect=function(R,H,$,X){if(isNaN(R)||isNaN(H)||isNaN($)||isNaN(X))throw yn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(R,H),this.lineTo(R+$,H),this.lineTo(R+$,H+X),this.lineTo(R,H+X),this.lineTo(R,H),this.lineTo(R+$,H),this.lineTo(R,H)},h.prototype.fillRect=function(R,H,$,X){if(isNaN(R)||isNaN(H)||isNaN($)||isNaN(X))throw yn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(R,H,$,X),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},h.prototype.strokeRect=function(R,H,$,X){if(isNaN(R)||isNaN(H)||isNaN($)||isNaN(X))throw yn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(R,H,$,X),this.stroke())},h.prototype.clearRect=function(R,H,$,X){if(isNaN(R)||isNaN(H)||isNaN($)||isNaN(X))throw yn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(R,H,$,X))},h.prototype.save=function(R){R=typeof R!="boolean"||R;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,$=0;$<this.pdf.internal.getNumberOfPages();$++)this.pdf.setPage($+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),R){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},h.prototype.restore=function(R){R=typeof R!="boolean"||R;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,$=0;$<this.pdf.internal.getNumberOfPages();$++)this.pdf.setPage($+1),this.pdf.internal.out("Q");this.pdf.setPage(H),R&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(R){var H,$,X,W;if(R.isCanvasGradient===!0&&(R=R.getColor()),!R)return{r:0,g:0,b:0,a:0,style:R};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(R))H=0,$=0,X=0,W=0;else{var ie=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(R);if(ie!==null)H=parseInt(ie[1]),$=parseInt(ie[2]),X=parseInt(ie[3]),W=1;else if((ie=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(R))!==null)H=parseInt(ie[1]),$=parseInt(ie[2]),X=parseInt(ie[3]),W=parseFloat(ie[4]);else{if(W=1,typeof R=="string"&&R.charAt(0)!=="#"){var ce=new pD(R);R=ce.ok?ce.toHex():"#000000"}R.length===4?(H=R.substring(1,2),H+=H,$=R.substring(2,3),$+=$,X=R.substring(3,4),X+=X):(H=R.substring(1,3),$=R.substring(3,5),X=R.substring(5,7)),H=parseInt(H,16),$=parseInt($,16),X=parseInt(X,16)}}return{r:H,g:$,b:X,a:W,style:R}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(R,H,$,X){if(isNaN(H)||isNaN($)||typeof R!="string")throw yn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!f.call(this)){var W=q(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;E.call(this,{text:R,x:H,y:$,scale:ie,angle:W,align:this.textAlign,maxWidth:X})}},h.prototype.strokeText=function(R,H,$,X){if(isNaN(H)||isNaN($)||typeof R!="string")throw yn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){X=isNaN(X)?void 0:X;var W=q(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;E.call(this,{text:R,x:H,y:$,scale:ie,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:X})}},h.prototype.measureText=function(R){if(typeof R!="string")throw yn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,$=this.pdf.internal.scaleFactor,X=H.internal.getFontSize(),W=H.getStringUnitWidth(R)*X/H.internal.scaleFactor,ie=function(ce){var ue=(ce=ce||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ue}}),this};return new ie({width:W*=Math.round(96*$/72*1e4)/1e4})},h.prototype.scale=function(R,H){if(isNaN(R)||isNaN(H))throw yn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var $=new u(R,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply($)},h.prototype.rotate=function(R){if(isNaN(R))throw yn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new u(Math.cos(R),Math.sin(R),-Math.sin(R),Math.cos(R),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},h.prototype.translate=function(R,H){if(isNaN(R)||isNaN(H))throw yn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var $=new u(1,0,0,1,R,H);this.ctx.transform=this.ctx.transform.multiply($)},h.prototype.transform=function(R,H,$,X,W,ie){if(isNaN(R)||isNaN(H)||isNaN($)||isNaN(X)||isNaN(W)||isNaN(ie))throw yn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ce=new u(R,H,$,X,W,ie);this.ctx.transform=this.ctx.transform.multiply(ce)},h.prototype.setTransform=function(R,H,$,X,W,ie){R=isNaN(R)?1:R,H=isNaN(H)?0:H,$=isNaN($)?0:$,X=isNaN(X)?1:X,W=isNaN(W)?0:W,ie=isNaN(ie)?0:ie,this.ctx.transform=new u(R,H,$,X,W,ie)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(R,H,$,X,W,ie,ce,ue,he){var ge=this.pdf.getImageProperties(R),Ee=1,Te=1,fe=1,me=1;X!==void 0&&ue!==void 0&&(fe=ue/X,me=he/W,Ee=ge.width/X*ue/X,Te=ge.height/W*he/W),ie===void 0&&(ie=H,ce=$,H=0,$=0),X!==void 0&&ue===void 0&&(ue=X,he=W),X===void 0&&ue===void 0&&(ue=ge.width,he=ge.height);for(var ne,De=this.ctx.transform.decompose(),Oe=q(De.rotate.shx),ke=new u,xe=(ke=(ke=(ke=ke.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new o(ie-H*fe,ce-$*me,X*Ee,W*Te)),Ae=w.call(this,xe),Ce=[],He=0;He<Ae.length;He+=1)Ce.indexOf(Ae[He])===-1&&Ce.push(Ae[He]);if(y(Ce),this.autoPaging)for(var Qe=Ce[0],Ze=Ce[Ce.length-1],Je=Qe;Je<Ze+1;Je++){this.pdf.setPage(Je);var le=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Xe=Je===1?this.posY+this.margin[0]:this.margin[0],We=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ke=Je===1?0:We+(Je-2)*et;if(this.ctx.clip_path.length!==0){var Ht=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(ne,this.posX+this.margin[3],-Ke+Xe+this.ctx.prevPageLastElemOffset),S.call(this,"fill",!0),this.path=Ht}var xt=JSON.parse(JSON.stringify(xe));xt=x([xt],this.posX+this.margin[3],-Ke+Xe+this.ctx.prevPageLastElemOffset)[0];var Xn=(Je>Qe||Je<Ze)&&b.call(this);Xn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],le,et,null).clip().discardPath()),this.pdf.addImage(R,"JPEG",xt.x,xt.y,xt.w,xt.h,null,null,Oe),Xn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(R,"JPEG",xe.x,xe.y,xe.w,xe.h,null,null,Oe)};var w=function(R,H,$){var X=[];H=H||this.pdf.internal.pageSize.width,$=$||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(R.type){default:case"mt":case"lt":X.push(Math.floor((R.y+W)/$)+1);break;case"arc":X.push(Math.floor((R.y+W-R.radius)/$)+1),X.push(Math.floor((R.y+W+R.radius)/$)+1);break;case"qct":var ie=I(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x,R.y);X.push(Math.floor((ie.y+W)/$)+1),X.push(Math.floor((ie.y+ie.h+W)/$)+1);break;case"bct":var ce=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x2,R.y2,R.x,R.y);X.push(Math.floor((ce.y+W)/$)+1),X.push(Math.floor((ce.y+ce.h+W)/$)+1);break;case"rect":X.push(Math.floor((R.y+W)/$)+1),X.push(Math.floor((R.y+R.h+W)/$)+1)}for(var ue=0;ue<X.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<X[ue];)m.call(this);return X},m=function(){var R=this.fillStyle,H=this.strokeStyle,$=this.font,X=this.lineCap,W=this.lineWidth,ie=this.lineJoin;this.pdf.addPage(),this.fillStyle=R,this.strokeStyle=H,this.font=$,this.lineCap=X,this.lineWidth=W,this.lineJoin=ie},x=function(R,H,$){for(var X=0;X<R.length;X++)switch(R[X].type){case"bct":R[X].x2+=H,R[X].y2+=$;case"qct":R[X].x1+=H,R[X].y1+=$;case"mt":case"lt":case"arc":default:R[X].x+=H,R[X].y+=$}return R},y=function(R){return R.sort(function(H,$){return H-$})},N=function(R,H){for(var $,X,W=this.fillStyle,ie=this.strokeStyle,ce=this.lineCap,ue=this.lineWidth,he=Math.abs(ue*this.ctx.transform.scaleX),ge=this.lineJoin,Ee=JSON.parse(JSON.stringify(this.path)),Te=JSON.parse(JSON.stringify(this.path)),fe=[],me=0;me<Te.length;me++)if(Te[me].x!==void 0)for(var ne=w.call(this,Te[me]),De=0;De<ne.length;De+=1)fe.indexOf(ne[De])===-1&&fe.push(ne[De]);for(var Oe=0;Oe<fe.length;Oe++)for(;this.pdf.internal.getNumberOfPages()<fe[Oe];)m.call(this);if(y(fe),this.autoPaging)for(var ke=fe[0],xe=fe[fe.length-1],Ae=ke;Ae<xe+1;Ae++){this.pdf.setPage(Ae),this.fillStyle=W,this.strokeStyle=ie,this.lineCap=ce,this.lineWidth=he,this.lineJoin=ge;var Ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],He=Ae===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Je=Ae===1?0:Qe+(Ae-2)*Ze;if(this.ctx.clip_path.length!==0){var le=this.path;$=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x($,this.posX+this.margin[3],-Je+He+this.ctx.prevPageLastElemOffset),S.call(this,R,!0),this.path=le}if(X=JSON.parse(JSON.stringify(Ee)),this.path=x(X,this.posX+this.margin[3],-Je+He+this.ctx.prevPageLastElemOffset),H===!1||Ae===0){var Xe=(Ae>ke||Ae<xe)&&b.call(this);Xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,Ze,null).clip().discardPath()),S.call(this,R,H),Xe&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=he,S.call(this,R,H),this.lineWidth=ue;this.path=Ee},S=function(R,H){if((R!=="stroke"||H||!g.call(this))&&(R==="stroke"||H||!f.call(this))){for(var $,X,W=[],ie=this.path,ce=0;ce<ie.length;ce++){var ue=ie[ce];switch(ue.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:ue,deltas:[],abs:[]});break;case"lt":var he=W.length;if(ie[ce-1]&&!isNaN(ie[ce-1].x)&&($=[ue.x-ie[ce-1].x,ue.y-ie[ce-1].y],he>0)){for(;he>=0;he--)if(W[he-1].close!==!0&&W[he-1].begin!==!0){W[he-1].deltas.push($),W[he-1].abs.push(ue);break}}break;case"bct":$=[ue.x1-ie[ce-1].x,ue.y1-ie[ce-1].y,ue.x2-ie[ce-1].x,ue.y2-ie[ce-1].y,ue.x-ie[ce-1].x,ue.y-ie[ce-1].y],W[W.length-1].deltas.push($);break;case"qct":var ge=ie[ce-1].x+2/3*(ue.x1-ie[ce-1].x),Ee=ie[ce-1].y+2/3*(ue.y1-ie[ce-1].y),Te=ue.x+2/3*(ue.x1-ue.x),fe=ue.y+2/3*(ue.y1-ue.y),me=ue.x,ne=ue.y;$=[ge-ie[ce-1].x,Ee-ie[ce-1].y,Te-ie[ce-1].x,fe-ie[ce-1].y,me-ie[ce-1].x,ne-ie[ce-1].y],W[W.length-1].deltas.push($);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(ue)}}X=H?null:R==="stroke"?"stroke":"fill";for(var De=!1,Oe=0;Oe<W.length;Oe++)if(W[Oe].arc)for(var ke=W[Oe].abs,xe=0;xe<ke.length;xe++){var Ae=ke[xe];Ae.type==="arc"?A.call(this,Ae.x,Ae.y,Ae.radius,Ae.startAngle,Ae.endAngle,Ae.counterclockwise,void 0,H,!De):F.call(this,Ae.x,Ae.y),De=!0}else if(W[Oe].close===!0)this.pdf.internal.out("h"),De=!1;else if(W[Oe].begin!==!0){var Ce=W[Oe].start.x,He=W[Oe].start.y;z.call(this,W[Oe].deltas,Ce,He),De=!0}X&&L.call(this,X),H&&P.call(this)}},D=function(R){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,$=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return R-$;case"top":return R+H-$;case"hanging":return R+H-2*$;case"middle":return R+H/2-$;case"ideographic":return R;case"alphabetic":default:return R}},_=function(R){return R+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var R=function(){};return R.colorStops=[],R.addColorStop=function(H,$){this.colorStops.push([H,$])},R.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},R.isCanvasGradient=!0,R},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(R,H,$,X,W,ie,ce,ue,he){for(var ge=O.call(this,$,X,W,ie),Ee=0;Ee<ge.length;Ee++){var Te=ge[Ee];Ee===0&&(he?j.call(this,Te.x1+R,Te.y1+H):F.call(this,Te.x1+R,Te.y1+H)),U.call(this,R,H,Te.x2,Te.y2,Te.x3,Te.y3,Te.x4,Te.y4)}ue?P.call(this):L.call(this,ce)},L=function(R){switch(R){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},P=function(){this.pdf.clip(),this.pdf.discardPath()},j=function(R,H){this.pdf.internal.out(n(R)+" "+a(H)+" m")},E=function(R){var H;switch(R.align){case"right":case"end":H="right";break;case"center":H="center";break;case"left":case"start":default:H="left"}var $=this.pdf.getTextDimensions(R.text),X=D.call(this,R.y),W=_.call(this,X)-$.h,ie=this.ctx.transform.applyToPoint(new s(R.x,X)),ce=this.ctx.transform.decompose(),ue=new u;ue=(ue=(ue=ue.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale);for(var he,ge,Ee,Te=this.ctx.transform.applyToRectangle(new o(R.x,X,$.w,$.h)),fe=ue.applyToRectangle(new o(R.x,W,$.w,$.h)),me=w.call(this,fe),ne=[],De=0;De<me.length;De+=1)ne.indexOf(me[De])===-1&&ne.push(me[De]);if(y(ne),this.autoPaging)for(var Oe=ne[0],ke=ne[ne.length-1],xe=Oe;xe<ke+1;xe++){this.pdf.setPage(xe);var Ae=xe===1?this.posY+this.margin[0]:this.margin[0],Ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[2],Qe=He-this.margin[0],Ze=this.pdf.internal.pageSize.width-this.margin[1],Je=Ze-this.margin[3],le=xe===1?0:Ce+(xe-2)*Qe;if(this.ctx.clip_path.length!==0){var Xe=this.path;he=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(he,this.posX+this.margin[3],-1*le+Ae),S.call(this,"fill",!0),this.path=Xe}var We=x([JSON.parse(JSON.stringify(fe))],this.posX+this.margin[3],-le+Ae+this.ctx.prevPageLastElemOffset)[0];R.scale>=.01&&(ge=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ge*R.scale),Ee=this.lineWidth,this.lineWidth=Ee*R.scale);var et=this.autoPaging!=="text";if(et||We.y+We.h<=He){if(et||We.y>=Ae&&We.x<=Ze){var Ke=et?R.text:this.pdf.splitTextToSize(R.text,R.maxWidth||Ze-We.x)[0],Ht=x([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-le+Ae+this.ctx.prevPageLastElemOffset)[0],xt=et&&(xe>Oe||xe<ke)&&b.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,Qe,null).clip().discardPath()),this.pdf.text(Ke,Ht.x,Ht.y,{angle:R.angle,align:H,renderingMode:R.renderingMode}),xt&&this.pdf.restoreGraphicsState()}}else We.y<He&&(this.ctx.prevPageLastElemOffset+=He-We.y);R.scale>=.01&&(this.pdf.setFontSize(ge),this.lineWidth=Ee)}else R.scale>=.01&&(ge=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ge*R.scale),Ee=this.lineWidth,this.lineWidth=Ee*R.scale),this.pdf.text(R.text,ie.x+this.posX,ie.y+this.posY,{angle:R.angle,align:H,renderingMode:R.renderingMode,maxWidth:R.maxWidth}),R.scale>=.01&&(this.pdf.setFontSize(ge),this.lineWidth=Ee)},F=function(R,H,$,X){$=$||0,X=X||0,this.pdf.internal.out(n(R+$)+" "+a(H+X)+" l")},z=function(R,H,$){return this.pdf.lines(R,H,$,null,null)},U=function(R,H,$,X,W,ie,ce,ue){this.pdf.internal.out([t(r($+R)),t(i(X+H)),t(r(W+R)),t(i(ie+H)),t(r(ce+R)),t(i(ue+H)),"c"].join(" "))},O=function(R,H,$,X){for(var W=2*Math.PI,ie=Math.PI/2;H>$;)H-=W;var ce=Math.abs($-H);ce<W&&X&&(ce=W-ce);for(var ue=[],he=X?-1:1,ge=H;ce>1e-5;){var Ee=ge+he*Math.min(ce,ie);ue.push(B.call(this,R,ge,Ee)),ce-=Math.abs(Ee-ge),ge=Ee}return ue},B=function(R,H,$){var X=($-H)/2,W=R*Math.cos(X),ie=R*Math.sin(X),ce=W,ue=-ie,he=ce*ce+ue*ue,ge=he+ce*W+ue*ie,Ee=4/3*(Math.sqrt(2*he*ge)-ge)/(ce*ie-ue*W),Te=ce-Ee*ue,fe=ue+Ee*ce,me=Te,ne=-fe,De=X+H,Oe=Math.cos(De),ke=Math.sin(De);return{x1:R*Math.cos(H),y1:R*Math.sin(H),x2:Te*Oe-fe*ke,y2:Te*ke+fe*Oe,x3:me*Oe-ne*ke,y3:me*ke+ne*Oe,x4:R*Math.cos($),y4:R*Math.sin($)}},q=function(R){return 180*R/Math.PI},I=function(R,H,$,X,W,ie){var ce=R+.5*($-R),ue=H+.5*(X-H),he=W+.5*($-W),ge=ie+.5*(X-ie),Ee=Math.min(R,W,ce,he),Te=Math.max(R,W,ce,he),fe=Math.min(H,ie,ue,ge),me=Math.max(H,ie,ue,ge);return new o(Ee,fe,Te-Ee,me-fe)},K=function(R,H,$,X,W,ie,ce,ue){var he,ge,Ee,Te,fe,me,ne,De,Oe,ke,xe,Ae,Ce,He,Qe=$-R,Ze=X-H,Je=W-$,le=ie-X,Xe=ce-W,We=ue-ie;for(ge=0;ge<41;ge++)Oe=(ne=(Ee=R+(he=ge/40)*Qe)+he*((fe=$+he*Je)-Ee))+he*(fe+he*(W+he*Xe-fe)-ne),ke=(De=(Te=H+he*Ze)+he*((me=X+he*le)-Te))+he*(me+he*(ie+he*We-me)-De),ge==0?(xe=Oe,Ae=ke,Ce=Oe,He=ke):(xe=Math.min(xe,Oe),Ae=Math.min(Ae,ke),Ce=Math.max(Ce,Oe),He=Math.max(He,ke));return new o(Math.round(xe),Math.round(Ae),Math.round(Ce-xe),Math.round(He-Ae))},Z=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var R,H,$=(R=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:R,lineDashOffset:H}));this.prevLineDash!==$&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=$)}}})(yt.API),function(e){var t=function(i){var s,o,u,c,d,h,p,f,g,b;for(o=[],u=0,c=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;c>u;u+=4)(d=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(h=(d=((d=((d=((d=(d-(b=d%85))/85)-(g=d%85))/85)-(f=d%85))/85)-(p=d%85))/85)%85,o.push(h+33,p+33,f+33,g+33,b+33)):o.push(122);return function(w,m){for(var x=m;x>0;x--)w.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},n=function(i){var s,o,u,c,d,h=String,p="length",f=255,g="charCodeAt",b="slice",w="replace";for(i[b](-2),i=i[b](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),u=[],c=0,d=(i+=s="uuuuu"[b](i[p]%5||5))[p];d>c;c+=5)o=52200625*(i[g](c)-33)+614125*(i[g](c+1)-33)+7225*(i[g](c+2)-33)+85*(i[g](c+3)-33)+(i[g](c+4)-33),u.push(f&o>>24,f&o>>16,f&o>>8,f&o);return function(m,x){for(var y=x;y>0;y--)m.pop()}(u,s[p]),h.fromCharCode.apply(h,u)},a=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",u=0;u<i.length;u+=2)o+=String.fromCharCode("0x"+(i[u]+i[u+1]));return o},r=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=v2(s)).reduce(function(u,c){return u+String.fromCharCode(c)},"")};e.processDataByFilters=function(i,s){var o=0,u=i||"",c=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=r(u),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:u,reverseChain:c.reverse().join(" ")}}}(yt.API),function(e){e.loadFile=function(t,n,a){return function(r,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(u,c,d){var h=new XMLHttpRequest,p=0,f=function(g){var b=g.length,w=[],m=String.fromCharCode;for(p=0;p<b;p+=1)w.push(m(255&g.charCodeAt(p)));return w.join("")};if(h.open("GET",u,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?d(f(this.responseText)):d(void 0)}),h.send(null),c&&h.status===200)return f(h.responseText)}(r,i,s)}catch{}return o}(t,n,a)},e.loadImageFile=e.loadFile}(yt.API),function(e){function t(){return(Nt.html2canvas?Promise.resolve(Nt.html2canvas):Bg(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function n(){return(Nt.DOMPurify?Promise.resolve(Nt.DOMPurify):Bg(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var a=function(s){var o=hn(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},r=function(s,o){var u=document.createElement(s);for(var c in o.className&&(u.className=o.className),o.innerHTML&&o.dompurify&&(u.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)u.style[c]=o.style[c];return u},i=function s(o){var u=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),c=s.convert(Promise.resolve(),u);return c=(c=c.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(u){switch(a(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(n).then(function(u){return this.set({src:r("div",{innerHTML:s,dompurify:u})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function u(c,d){for(var h=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(u(p,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(h.value=c.value),h.addEventListener("load",function(){h.scrollTop=c.scrollTop,h.scrollLeft=c.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,o(this.prop.container,u)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var u=this.opt.jsPDF,c=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var f=c[p],g=f.src.find(function(b){return b.format==="truetype"});g&&u.addFont(g.url,f.ref.name,f.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),o(this.prop.container,h)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(a(s)!=="object")return this;var o=Object.keys(s||{}).map(function(u){if(u in i.template.prop)return function(){this.prop[u]=s[u]};switch(u){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[u]=s[u]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var u=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(u):u})},i.prototype.setMargin=function(s){return this.then(function(){switch(a(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(u,c){return Math.floor(u*c/72*96)}return this.then(function(){(s=s||yt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,u,c){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),u!=null&&(this.progress.n=u),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,u,c){return this.setProgress(s?this.progress.val+s:null,o||null,u?this.progress.n+u:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(s,o){var u=this;return this.thenCore(s,o,function(c,d){return u.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(h){return u.updateProgress(null,c),h}).then(c,d).then(function(h){return u.updateProgress(1),h})})},i.prototype.thenCore=function(s,o,u){u=u||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=u.call(c,s,o);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(u){o=o.thenCore(u)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,yt.getPageSize=function(s,o,u){if(hn(s)==="object"){var c=s;s=c.orientation,o=c.unit||o,u=c.format||u}o=o||"mm",u=u||"a4",s=(""+(s||"P")).toLowerCase();var d,h=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+o}var f,g=0,b=0;if(p.hasOwnProperty(h))g=p[h][1]/d,b=p[h][0]/d;else try{g=u[1],b=u[0]}catch{throw new Error("Invalid format: "+u)}if(s==="p"||s==="portrait")s="p",b>g&&(f=b,b=g,g=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",g>b&&(f=b,b=g,g=f)}return{width:b,height:g,unit:o,k:d,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(k2):null;var u=new i(o);return o.worker?u:u.from(s).doCallback()}}(yt.API),yt.API.addJS=function(e){return Qk=e,this.internal.events.subscribe("postPutResources",function(){yg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(yg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Jk=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Qk+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){yg!==void 0&&Jk!==void 0&&this.internal.out("/Names <</JavaScript "+yg+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=n.outline.render().split(/\r\n/),i=0;i<r.length;i++){var s=r[i],o=a.exec(s);if(o!=null){var u=o[1];n.internal.newObjectDeferredBegin(u,!1)}n.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,d=[];for(i=0;i<c;i++){var h=n.internal.newObject();d.push(h);var p=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var f=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<d.length;i++)n.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+f+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(a,r,i){var s={title:r,options:i,children:[]};return a==null&&(a=this.root),a.children.push(s),s},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(a){a.id=n.internal.newObjectDeferred();for(var r=0;r<a.children.length;r++)this.genIds_r(a.children[r])},n.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},n.outline.renderItems=function(a){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var s=a.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var u=n.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<a.children.length;c++)this.renderItems(a.children[c])},n.outline.line=function(a){this.ctx.val+=a+`\r
`},n.outline.makeRef=function(a){return a.id+" 0 R"},n.outline.makeString=function(a){return"("+n.internal.pdfEscape(a)+")"},n.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(a,r){for(var i=0;i<r.children.length;i++)a.count++,this.count_r(a,r.children[i]);return a.count}}])}(yt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,a,r,i,s,o){var u,c=this.decode.DCT_DECODE,d=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=s||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(u=function(h){for(var p,f=256*h.charCodeAt(4)+h.charCodeAt(5),g=h.length,b={width:0,height:0,numcomponents:1},w=4;w<g;w+=2){if(w+=f,t.indexOf(h.charCodeAt(w+1))!==-1){p=256*h.charCodeAt(w+5)+h.charCodeAt(w+6),b={width:256*h.charCodeAt(w+7)+h.charCodeAt(w+8),height:p,numcomponents:h.charCodeAt(w+9)};break}f=256*h.charCodeAt(w+2)+h.charCodeAt(w+3)}return b}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:n,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:c,index:a,alias:r}}return d}}(yt.API);var Wc,wg,Zk,eS,tS,JG=function(){var e,t,n;function a(i){var s,o,u,c,d,h,p,f,g,b,w,m,x,y;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(s=this.readUInt32(),g=(function(){var N,S;for(S=[],N=0;N<4;++N)S.push(String.fromCharCode(this.data[this.pos++]));return S}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),c=this.readUInt16()||100,h.delay=1e3*d/c,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,s-=4),i=(h!=null?h.data:void 0)||this.imgData,m=0;0<=s?m<s:m>s;0<=s?++m:--m)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((b=u-this.transparency.indexed.length)>0)for(x=0;0<=b?x<b:x>b;0<=b?++x:--x)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(w=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,w.slice(0,p)),this.text[f]=String.fromCharCode.apply(String,w.slice(p+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(y=this.colorType)===4||y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),u=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(h,p,f,g){var b,w,m,x,y,N,S,D,_,A,L,P,j,E,F,z,U,O,B,q,I,K=Math.ceil((c.width-h)/f),Z=Math.ceil((c.height-p)/g),R=c.width==K&&c.height==Z;for(E=s*K,P=R?o:new Uint8Array(E*Z),N=i.length,j=0,w=0;j<Z&&u<N;){switch(i[u++]){case 0:for(x=U=0;U<E;x=U+=1)P[w++]=i[u++];break;case 1:for(x=O=0;O<E;x=O+=1)b=i[u++],y=x<s?0:P[w-s],P[w++]=(b+y)%256;break;case 2:for(x=B=0;B<E;x=B+=1)b=i[u++],m=(x-x%s)/s,F=j&&P[(j-1)*E+m*s+x%s],P[w++]=(F+b)%256;break;case 3:for(x=q=0;q<E;x=q+=1)b=i[u++],m=(x-x%s)/s,y=x<s?0:P[w-s],F=j&&P[(j-1)*E+m*s+x%s],P[w++]=(b+Math.floor((y+F)/2))%256;break;case 4:for(x=I=0;I<E;x=I+=1)b=i[u++],m=(x-x%s)/s,y=x<s?0:P[w-s],j===0?F=z=0:(F=P[(j-1)*E+m*s+x%s],z=m&&P[(j-1)*E+(m-1)*s+x%s]),S=y+F-z,D=Math.abs(S-y),A=Math.abs(S-F),L=Math.abs(S-z),_=D<=A&&D<=L?y:A<=L?F:z,P[w++]=(b+_)%256;break;default:throw new Error("Invalid filter algorithm: "+i[u-1])}if(!R){var H=((p+j*g)*c.width+h)*s,$=j*E;for(x=0;x<K;x+=1){for(var X=0;X<s;X+=1)o[H++]=P[$++];H+=(f-1)*s}}j++}}return i=AG(i),c.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),o},a.prototype.decodePalette=function(){var i,s,o,u,c,d,h,p,f;for(o=this.palette,d=this.transparency.indexed||[],c=new Uint8Array((d.length||0)+o.length),u=0,i=0,s=h=0,p=o.length;h<p;s=h+=3)c[u++]=o[s],c[u++]=o[s+1],c[u++]=o[s+2],c[u++]=(f=d[i++])!=null?f:255;return c},a.prototype.copyToImageData=function(i,s){var o,u,c,d,h,p,f,g,b,w,m;if(u=this.colors,b=null,o=this.hasAlphaChannel,this.palette.length&&(b=(m=this._decodedPalette)!=null?m:this._decodedPalette=this.decodePalette(),u=4,o=!0),g=(c=i.data||i).length,h=b||s,d=p=0,u===1)for(;d<g;)f=b?4*s[d/4]:p,w=h[f++],c[d++]=w,c[d++]=w,c[d++]=w,c[d++]=o?h[f++]:255,p=f;else for(;d<g;)f=b?4*s[d/4]:p,c[d++]=h[f++],c[d++]=h[f++],c[d++]=h[f++],c[d++]=o?h[f++]:255,p=f},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var r=function(){if(Object.prototype.toString.call(Nt)==="[object Window]"){try{t=Nt.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return r(),e=function(i){var s;if(r()===!0)return n.width=i.width,n.height=i.height,n.clearRect(0,0,i.width,i.height),n.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var s,o,u,c,d,h,p,f;if(this.animation){for(f=[],o=d=0,h=(p=this.animation.frames).length;d<h;o=++d)s=p[o],u=i.createImageData(s.width,s.height),c=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(u,c),s.imageData=u,f.push(s.image=e(u));return f}},a.prototype.renderFrame=function(i,s){var o,u,c;return o=(u=this.animation.frames)[s],c=u[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},a.prototype.animate=function(i){var s,o,u,c,d,h,p=this;return o=0,h=this.animation,c=h.numFrames,u=h.frames,d=h.numPlays,(s=function(){var f,g;if(f=o++%c,g=u[f],p.renderFrame(i,f),c>1&&o/c<d)return p.animation._timeout=setTimeout(s,g.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function QG(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,r=e[t++],i=r>>7,s=1<<(7&r)+1;e[t++],e[t++];var o=null,u=null;i&&(o=t,u=s,t+=3*s);var c=!0,d=[],h=0,p=null,f=0,g=null;for(this.width=n,this.height=a;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var b=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],!(1&b)&&(p=null),f=b>>2&7,t++;break;case 254:for(;;){if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var w=e[t++]|e[t++]<<8,m=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,N=e[t++],S=N>>6&1,D=1<<(7&N)+1,_=o,A=u,L=!1;N>>7&&(L=!0,_=t,A=D,t+=3*D);var P=t;for(t++;;){var j;if(!((j=e[t++])>=0))throw Error("Invalid block size");if(j===0)break;t+=j}d.push({x:w,y:m,width:x,height:y,has_local_palette:L,palette_offset:_,palette_size:A,data_offset:P,data_length:t-P,transparent_index:p,interlaced:!!S,delay:h,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return g},this.frameInfo=function(E){if(E<0||E>=d.length)throw new Error("Frame index out of range.");return d[E]},this.decodeAndBlitFrameBGRA=function(E,F){var z=this.frameInfo(E),U=z.width*z.height,O=new Uint8Array(U);nS(e,z.data_offset,O,U);var B=z.palette_offset,q=z.transparent_index;q===null&&(q=256);var I=z.width,K=n-I,Z=I,R=4*(z.y*n+z.x),H=4*((z.y+z.height)*n+z.x),$=R,X=4*K;z.interlaced===!0&&(X+=4*n*7);for(var W=8,ie=0,ce=O.length;ie<ce;++ie){var ue=O[ie];if(Z===0&&(Z=I,($+=X)>=H&&(X=4*K+4*n*(W-1),$=R+(I+K)*(W<<1),W>>=1)),ue===q)$+=4;else{var he=e[B+3*ue],ge=e[B+3*ue+1],Ee=e[B+3*ue+2];F[$++]=Ee,F[$++]=ge,F[$++]=he,F[$++]=255}--Z}},this.decodeAndBlitFrameRGBA=function(E,F){var z=this.frameInfo(E),U=z.width*z.height,O=new Uint8Array(U);nS(e,z.data_offset,O,U);var B=z.palette_offset,q=z.transparent_index;q===null&&(q=256);var I=z.width,K=n-I,Z=I,R=4*(z.y*n+z.x),H=4*((z.y+z.height)*n+z.x),$=R,X=4*K;z.interlaced===!0&&(X+=4*n*7);for(var W=8,ie=0,ce=O.length;ie<ce;++ie){var ue=O[ie];if(Z===0&&(Z=I,($+=X)>=H&&(X=4*K+4*n*(W-1),$=R+(I+K)*(W<<1),W>>=1)),ue===q)$+=4;else{var he=e[B+3*ue],ge=e[B+3*ue+1],Ee=e[B+3*ue+2];F[$++]=he,F[$++]=ge,F[$++]=Ee,F[$++]=255}--Z}}}function nS(e,t,n,a){for(var r=e[t++],i=1<<r,s=i+1,o=s+1,u=r+1,c=(1<<u)-1,d=0,h=0,p=0,f=e[t++],g=new Int32Array(4096),b=null;;){for(;d<16&&f!==0;)h|=e[t++]<<d,d+=8,f===1?f=e[t++]:--f;if(d<u)break;var w=h&c;if(h>>=u,d-=u,w!==i){if(w===s)break;for(var m=w<o?w:b,x=0,y=m;y>i;)y=g[y]>>8,++x;var N=y;if(p+x+(m!==w?1:0)>a)return void yn.log("Warning, gif stream longer than expected.");n[p++]=N;var S=p+=x;for(m!==w&&(n[p++]=N),y=m;x--;)y=g[y],n[--S]=255&y,y>>=8;b!==null&&o<4096&&(g[o++]=b<<8|N,o>=c+1&&u<12&&(++u,c=c<<1|1)),b=w}else o=s+1,c=(1<<(u=r+1))-1,b=null}return p!==a&&yn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function N1(e){var t,n,a,r,i,s=Math.floor,o=new Array(64),u=new Array(64),c=new Array(64),d=new Array(64),h=new Array(65535),p=new Array(65535),f=new Array(64),g=new Array(64),b=[],w=0,m=7,x=new Array(64),y=new Array(64),N=new Array(64),S=new Array(256),D=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],P=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],j=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],E=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function O(R,H){for(var $=0,X=0,W=new Array,ie=1;ie<=16;ie++){for(var ce=1;ce<=R[ie];ce++)W[H[X]]=[],W[H[X]][0]=$,W[H[X]][1]=ie,X++,$++;$*=2}return W}function B(R){for(var H=R[0],$=R[1]-1;$>=0;)H&1<<$&&(w|=1<<m),$--,--m<0&&(w==255?(q(255),q(0)):q(w),m=7,w=0)}function q(R){b.push(R)}function I(R){q(R>>8&255),q(255&R)}function K(R,H,$,X,W){for(var ie,ce=W[0],ue=W[240],he=function(ke,xe){var Ae,Ce,He,Qe,Ze,Je,le,Xe,We,et,Ke=0;for(We=0;We<8;++We){Ae=ke[Ke],Ce=ke[Ke+1],He=ke[Ke+2],Qe=ke[Ke+3],Ze=ke[Ke+4],Je=ke[Ke+5],le=ke[Ke+6];var Ht=Ae+(Xe=ke[Ke+7]),xt=Ae-Xe,Xn=Ce+le,Mt=Ce-le,xn=He+Je,Gr=He-Je,Vt=Qe+Ze,Js=Qe-Ze,Cn=Ht+Vt,$r=Ht-Vt,Ni=Xn+xn,It=Xn-xn;ke[Ke]=Cn+Ni,ke[Ke+4]=Cn-Ni;var mt=.707106781*(It+$r);ke[Ke+2]=$r+mt,ke[Ke+6]=$r-mt;var qt=.382683433*((Cn=Js+Gr)-(It=Mt+xt)),Qt=.5411961*Cn+qt,pn=1.306562965*It+qt,ki=.707106781*(Ni=Gr+Mt),kr=xt+ki,vt=xt-ki;ke[Ke+5]=vt+Qt,ke[Ke+3]=vt-Qt,ke[Ke+1]=kr+pn,ke[Ke+7]=kr-pn,Ke+=8}for(Ke=0,We=0;We<8;++We){Ae=ke[Ke],Ce=ke[Ke+8],He=ke[Ke+16],Qe=ke[Ke+24],Ze=ke[Ke+32],Je=ke[Ke+40],le=ke[Ke+48];var Sr=Ae+(Xe=ke[Ke+56]),_r=Ae-Xe,pa=Ce+le,In=Ce-le,Tn=He+Je,Ua=He-Je,Fo=Qe+Ze,Kr=Qe-Ze,jr=Sr+Fo,Yr=Sr-Fo,Xr=pa+Tn,St=pa-Tn;ke[Ke]=jr+Xr,ke[Ke+32]=jr-Xr;var Wt=.707106781*(St+Yr);ke[Ke+16]=Yr+Wt,ke[Ke+48]=Yr-Wt;var Zt=.382683433*((jr=Kr+Ua)-(St=In+_r)),ma=.5411961*jr+Zt,Aa=1.306562965*St+Zt,ms=.707106781*(Xr=Ua+In),Bo=_r+ms,zo=_r-ms;ke[Ke+40]=zo+ma,ke[Ke+24]=zo-ma,ke[Ke+8]=Bo+Aa,ke[Ke+56]=Bo-Aa,Ke++}for(We=0;We<64;++We)et=ke[We]*xe[We],f[We]=et>0?et+.5|0:et-.5|0;return f}(R,H),ge=0;ge<64;++ge)g[_[ge]]=he[ge];var Ee=g[0]-$;$=g[0],Ee==0?B(X[0]):(B(X[p[ie=32767+Ee]]),B(h[ie]));for(var Te=63;Te>0&&g[Te]==0;)Te--;if(Te==0)return B(ce),$;for(var fe,me=1;me<=Te;){for(var ne=me;g[me]==0&&me<=Te;)++me;var De=me-ne;if(De>=16){fe=De>>4;for(var Oe=1;Oe<=fe;++Oe)B(ue);De&=15}ie=32767+g[me],B(W[(De<<4)+p[ie]]),B(h[ie]),me++}return Te!=63&&B(ce),$}function Z(R){R=Math.min(Math.max(R,1),100),i!=R&&(function(H){for(var $=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var W=s(($[X]*H+50)/100);W=Math.min(Math.max(W,1),255),o[_[X]]=W}for(var ie=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ce=0;ce<64;ce++){var ue=s((ie[ce]*H+50)/100);ue=Math.min(Math.max(ue,1),255),u[_[ce]]=ue}for(var he=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ge=0,Ee=0;Ee<8;Ee++)for(var Te=0;Te<8;Te++)c[ge]=1/(o[_[ge]]*he[Ee]*he[Te]*8),d[ge]=1/(u[_[ge]]*he[Ee]*he[Te]*8),ge++}(R<50?Math.floor(5e3/R):Math.floor(200-2*R)),i=R)}this.encode=function(R,H){H&&Z(H),b=new Array,w=0,m=7,I(65496),I(65504),I(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),I(1),I(1),q(0),q(0),function(){I(65499),I(132),q(0);for(var Ce=0;Ce<64;Ce++)q(o[Ce]);q(1);for(var He=0;He<64;He++)q(u[He])}(),function(Ce,He){I(65472),I(17),q(8),I(He),I(Ce),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(R.width,R.height),function(){I(65476),I(418),q(0);for(var Ce=0;Ce<16;Ce++)q(A[Ce+1]);for(var He=0;He<=11;He++)q(L[He]);q(16);for(var Qe=0;Qe<16;Qe++)q(P[Qe+1]);for(var Ze=0;Ze<=161;Ze++)q(j[Ze]);q(1);for(var Je=0;Je<16;Je++)q(E[Je+1]);for(var le=0;le<=11;le++)q(F[le]);q(17);for(var Xe=0;Xe<16;Xe++)q(z[Xe+1]);for(var We=0;We<=161;We++)q(U[We])}(),I(65498),I(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var $=0,X=0,W=0;w=0,m=7,this.encode.displayName="_encode_";for(var ie,ce,ue,he,ge,Ee,Te,fe,me,ne=R.data,De=R.width,Oe=R.height,ke=4*De,xe=0;xe<Oe;){for(ie=0;ie<ke;){for(ge=ke*xe+ie,Te=-1,fe=0,me=0;me<64;me++)Ee=ge+(fe=me>>3)*ke+(Te=4*(7&me)),xe+fe>=Oe&&(Ee-=ke*(xe+1+fe-Oe)),ie+Te>=ke&&(Ee-=ie+Te-ke+4),ce=ne[Ee++],ue=ne[Ee++],he=ne[Ee++],x[me]=(D[ce]+D[ue+256>>0]+D[he+512>>0]>>16)-128,y[me]=(D[ce+768>>0]+D[ue+1024>>0]+D[he+1280>>0]>>16)-128,N[me]=(D[ce+1280>>0]+D[ue+1536>>0]+D[he+1792>>0]>>16)-128;$=K(x,c,$,t,a),X=K(y,d,X,n,r),W=K(N,d,W,n,r),ie+=32}xe+=8}if(m>=0){var Ae=[];Ae[1]=m+1,Ae[0]=(1<<m+1)-1,B(Ae)}return I(65497),new Uint8Array(b)},e=e||50,function(){for(var R=String.fromCharCode,H=0;H<256;H++)S[H]=R(H)}(),t=O(A,L),n=O(E,F),a=O(P,j),r=O(z,U),function(){for(var R=1,H=2,$=1;$<=15;$++){for(var X=R;X<H;X++)p[32767+X]=$,h[32767+X]=[],h[32767+X][1]=$,h[32767+X][0]=X;for(var W=-(H-1);W<=-R;W++)p[32767+W]=$,h[32767+W]=[],h[32767+W][1]=$,h[32767+W][0]=H-1+W;R<<=1,H<<=1}}(),function(){for(var R=0;R<256;R++)D[R]=19595*R,D[R+256>>0]=38470*R,D[R+512>>0]=7471*R+32768,D[R+768>>0]=-11059*R,D[R+1024>>0]=-21709*R,D[R+1280>>0]=32768*R+8421375,D[R+1536>>0]=-27439*R,D[R+1792>>0]=-5329*R}(),Z(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ts(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function aS(e){function t(A){if(!A)throw Error("assert :P")}function n(A,L,P){for(var j=0;4>j;j++)if(A[L+j]!=P.charCodeAt(j))return!0;return!1}function a(A,L,P,j,E){for(var F=0;F<E;F++)A[L+F]=P[j+F]}function r(A,L,P,j){for(var E=0;E<j;E++)A[L+E]=P}function i(A){return new Int32Array(A)}function s(A,L){for(var P=[],j=0;j<A;j++)P.push(new L);return P}function o(A,L){var P=[];return function j(E,F,z){for(var U=z[F],O=0;O<U&&(E.push(z.length>F+1?[]:new L),!(z.length<F+1));O++)j(E[O],F+1,z)}(P,0,A),P}var u=function(){var A=this;function L(v,k){for(var T=1<<k-1>>>0;v&T;)T>>>=1;return T?(v&T-1)+T:v}function P(v,k,T,M,V){t(!(M%T));do v[k+(M-=T)]=V;while(0<M)}function j(v,k,T,M,V){if(t(2328>=V),512>=V)var Y=i(512);else if((Y=i(V))==null)return 0;return function(J,Q,ee,re,ve,_e){var je,Ne,qe=Q,Me=1<<ee,be=i(16),we=i(16);for(t(ve!=0),t(re!=null),t(J!=null),t(0<ee),Ne=0;Ne<ve;++Ne){if(15<re[Ne])return 0;++be[re[Ne]]}if(be[0]==ve)return 0;for(we[1]=0,je=1;15>je;++je){if(be[je]>1<<je)return 0;we[je+1]=we[je]+be[je]}for(Ne=0;Ne<ve;++Ne)je=re[Ne],0<re[Ne]&&(_e[we[je]++]=Ne);if(we[15]==1)return(re=new E).g=0,re.value=_e[0],P(J,qe,1,Me,re),Me;var ze,$e=-1,Ue=Me-1,it=0,tt=1,bt=1,nt=1<<ee;for(Ne=0,je=1,ve=2;je<=ee;++je,ve<<=1){if(tt+=bt<<=1,0>(bt-=be[je]))return 0;for(;0<be[je];--be[je])(re=new E).g=je,re.value=_e[Ne++],P(J,qe+it,ve,nt,re),it=L(it,je)}for(je=ee+1,ve=2;15>=je;++je,ve<<=1){if(tt+=bt<<=1,0>(bt-=be[je]))return 0;for(;0<be[je];--be[je]){if(re=new E,(it&Ue)!=$e){for(qe+=nt,ze=1<<($e=je)-ee;15>$e&&!(0>=(ze-=be[$e]));)++$e,ze<<=1;Me+=nt=1<<(ze=$e-ee),J[Q+($e=it&Ue)].g=ze+ee,J[Q+$e].value=qe-Q-$e}re.g=je-ee,re.value=_e[Ne++],P(J,qe+(it>>ee),ve,nt,re),it=L(it,je)}}return tt!=2*we[15]-1?0:Me}(v,k,T,M,V,Y)}function E(){this.value=this.g=0}function F(){this.value=this.g=0}function z(){this.G=s(5,E),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(qa,F)}function U(v,k,T,M){t(v!=null),t(k!=null),t(2147483648>M),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=k,v.pa=T,v.Jd=k,v.Yc=T+M,v.Zc=4<=M?T+M-4+1:T,ie(v)}function O(v,k){for(var T=0;0<k--;)T|=ue(v,128)<<k;return T}function B(v,k){var T=O(v,k);return ce(v)?-T:T}function q(v,k,T,M){var V,Y=0;for(t(v!=null),t(k!=null),t(4294967288>M),v.Sb=M,v.Ra=0,v.u=0,v.h=0,4<M&&(M=4),V=0;V<M;++V)Y+=k[T+V]<<8*V;v.Ra=Y,v.bb=M,v.oa=k,v.pa=T}function I(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Sc-8>>>0,++v.bb,v.u-=8;$(v)&&(v.h=1,v.u=0)}function K(v,k){if(t(0<=k),!v.h&&k<=kc){var T=H(v)&Nc[k];return v.u+=k,I(v),T}return v.h=1,v.u=0}function Z(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(v){return v.Ra>>>(v.u&Sc-1)>>>0}function $(v){return t(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Sc}function X(v,k){v.u=k,v.h=$(v)}function W(v){v.u>=Lh&&(t(v.u>=Lh),I(v))}function ie(v){t(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(t(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function ce(v){return O(v,1)}function ue(v,k){var T=v.Ca;0>v.b&&ie(v);var M=v.b,V=T*k>>>8,Y=(v.I>>>M>V)+0;for(Y?(T-=V,v.I-=V+1<<M>>>0):T=V+1,M=T,V=0;256<=M;)V+=8,M>>=8;return M=7^V+Ar[M],v.b-=M,v.Ca=(T<<M)-1,Y}function he(v,k,T){v[k+0]=T>>24&255,v[k+1]=T>>16&255,v[k+2]=T>>8&255,v[k+3]=T>>0&255}function ge(v,k){return v[k+0]<<0|v[k+1]<<8}function Ee(v,k){return ge(v,k)|v[k+2]<<16}function Te(v,k){return ge(v,k)|ge(v,k+2)<<16}function fe(v,k){var T=1<<k;return t(v!=null),t(0<k),v.X=i(T),v.X==null?0:(v.Mb=32-k,v.Xa=k,1)}function me(v,k){t(v!=null),t(k!=null),t(v.Xa==k.Xa),a(k.X,0,v.X,0,1<<k.Xa)}function ne(){this.X=[],this.Xa=this.Mb=0}function De(v,k,T,M){t(T!=null),t(M!=null);var V=T[0],Y=M[0];return V==0&&(V=(v*Y+k/2)/k),Y==0&&(Y=(k*V+v/2)/v),0>=V||0>=Y?0:(T[0]=V,M[0]=Y,1)}function Oe(v,k){return v+(1<<k)-1>>>k}function ke(v,k){return((4278255360&v)+(4278255360&k)>>>0&4278255360)+((16711935&v)+(16711935&k)>>>0&16711935)>>>0}function xe(v,k){A[k]=function(T,M,V,Y,J,Q,ee){var re;for(re=0;re<J;++re){var ve=A[v](Q[ee+re-1],V,Y+re);Q[ee+re]=ke(T[M+re],ve)}}}function Ae(){this.ud=this.hd=this.jd=0}function Ce(v,k){return((4278124286&(v^k))>>>1)+(v&k)>>>0}function He(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Qe(v,k){return He(v+(v-k+.5>>1))}function Ze(v,k,T){return Math.abs(k-T)-Math.abs(v-T)}function Je(v,k,T,M,V,Y,J){for(M=Y[J-1],T=0;T<V;++T)Y[J+T]=M=ke(v[k+T],M)}function le(v,k,T,M,V){var Y;for(Y=0;Y<T;++Y){var J=v[k+Y],Q=J>>8&255,ee=16711935&(ee=(ee=16711935&J)+((Q<<16)+Q));M[V+Y]=(4278255360&J)+ee>>>0}}function Xe(v,k){k.jd=v>>0&255,k.hd=v>>8&255,k.ud=v>>16&255}function We(v,k,T,M,V,Y){var J;for(J=0;J<M;++J){var Q=k[T+J],ee=Q>>>8,re=Q,ve=255&(ve=(ve=Q>>>16)+((v.jd<<24>>24)*(ee<<24>>24)>>>5));re=255&(re=(re=re+((v.hd<<24>>24)*(ee<<24>>24)>>>5))+((v.ud<<24>>24)*(ve<<24>>24)>>>5)),V[Y+J]=(4278255360&Q)+(ve<<16)+re}}function et(v,k,T,M,V){A[k]=function(Y,J,Q,ee,re,ve,_e,je,Ne){for(ee=_e;ee<je;++ee)for(_e=0;_e<Ne;++_e)re[ve++]=V(Q[M(Y[J++])])},A[v]=function(Y,J,Q,ee,re,ve,_e){var je=8>>Y.b,Ne=Y.Ea,qe=Y.K[0],Me=Y.w;if(8>je)for(Y=(1<<Y.b)-1,Me=(1<<je)-1;J<Q;++J){var be,we=0;for(be=0;be<Ne;++be)be&Y||(we=M(ee[re++])),ve[_e++]=V(qe[we&Me]),we>>=je}else A["VP8LMapColor"+T](ee,re,qe,Me,ve,_e,J,Q,Ne)}}function Ke(v,k,T,M,V){for(T=k+T;k<T;){var Y=v[k++];M[V++]=Y>>16&255,M[V++]=Y>>8&255,M[V++]=Y>>0&255}}function Ht(v,k,T,M,V){for(T=k+T;k<T;){var Y=v[k++];M[V++]=Y>>16&255,M[V++]=Y>>8&255,M[V++]=Y>>0&255,M[V++]=Y>>24&255}}function xt(v,k,T,M,V){for(T=k+T;k<T;){var Y=(J=v[k++])>>16&240|J>>12&15,J=J>>0&240|J>>28&15;M[V++]=Y,M[V++]=J}}function Xn(v,k,T,M,V){for(T=k+T;k<T;){var Y=(J=v[k++])>>16&248|J>>13&7,J=J>>5&224|J>>3&31;M[V++]=Y,M[V++]=J}}function Mt(v,k,T,M,V){for(T=k+T;k<T;){var Y=v[k++];M[V++]=Y>>0&255,M[V++]=Y>>8&255,M[V++]=Y>>16&255}}function xn(v,k,T,M,V,Y){if(Y==0)for(T=k+T;k<T;)he(M,((Y=v[k++])[0]>>24|Y[1]>>8&65280|Y[2]<<8&16711680|Y[3]<<24)>>>0),V+=32;else a(M,V,v,k,T)}function Gr(v,k){A[k][0]=A[v+"0"],A[k][1]=A[v+"1"],A[k][2]=A[v+"2"],A[k][3]=A[v+"3"],A[k][4]=A[v+"4"],A[k][5]=A[v+"5"],A[k][6]=A[v+"6"],A[k][7]=A[v+"7"],A[k][8]=A[v+"8"],A[k][9]=A[v+"9"],A[k][10]=A[v+"10"],A[k][11]=A[v+"11"],A[k][12]=A[v+"12"],A[k][13]=A[v+"13"],A[k][14]=A[v+"0"],A[k][15]=A[v+"0"]}function Vt(v){return v==Ix||v==Fx||v==km||v==Bx}function Js(){this.eb=[],this.size=this.A=this.fb=0}function Cn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function $r(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Js,this.f.kb=new Cn,this.sd=null}function Ni(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function It(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function mt(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function qt(v,k){var T=v.T,M=k.ba.f.RGBA,V=M.eb,Y=M.fb+v.ka*M.A,J=Ei[k.ba.S],Q=v.y,ee=v.O,re=v.f,ve=v.N,_e=v.ea,je=v.W,Ne=k.cc,qe=k.dc,Me=k.Mc,be=k.Nc,we=v.ka,ze=v.ka+v.T,$e=v.U,Ue=$e+1>>1;for(we==0?J(Q,ee,null,null,re,ve,_e,je,re,ve,_e,je,V,Y,null,null,$e):(J(k.ec,k.fc,Q,ee,Ne,qe,Me,be,re,ve,_e,je,V,Y-M.A,V,Y,$e),++T);we+2<ze;we+=2)Ne=re,qe=ve,Me=_e,be=je,ve+=v.Rc,je+=v.Rc,Y+=2*M.A,J(Q,(ee+=2*v.fa)-v.fa,Q,ee,Ne,qe,Me,be,re,ve,_e,je,V,Y-M.A,V,Y,$e);return ee+=v.fa,v.j+ze<v.o?(a(k.ec,k.fc,Q,ee,$e),a(k.cc,k.dc,re,ve,Ue),a(k.Mc,k.Nc,_e,je,Ue),T--):1&ze||J(Q,ee,null,null,re,ve,_e,je,re,ve,_e,je,V,Y+M.A,null,null,$e),T}function Qt(v,k,T){var M=v.F,V=[v.J];if(M!=null){var Y=v.U,J=k.ba.S,Q=J==Nm||J==km;k=k.ba.f.RGBA;var ee=[0],re=v.ka;ee[0]=v.T,v.Kb&&(re==0?--ee[0]:(--re,V[0]-=v.width),v.j+v.ka+v.T==v.o&&(ee[0]=v.o-v.j-re));var ve=k.eb;re=k.fb+re*k.A,v=kn(M,V[0],v.width,Y,ee,ve,re+(Q?0:3),k.A),t(T==ee),v&&Vt(J)&&Ci(ve,re,Q,Y,ee,k.A)}return 0}function pn(v){var k=v.ma,T=k.ba.S,M=11>T,V=T==ym||T==wm||T==Nm||T==Ox||T==12||Vt(T);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!Dh(k.Oa,v,V?11:12))return 0;if(V&&Vt(T)&&Ye(),v.da)alert("todo:use_scaling");else{if(M){if(k.Ib=mt,v.Kb){if(T=v.U+1>>1,k.memory=i(v.U+2*T),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+v.U,k.Mc=k.cc,k.Nc=k.dc+T,k.Ib=qt,Ye()}}else alert("todo:EmitYUV");V&&(k.Jb=Qt,M&&Se())}if(M&&!hN){for(v=0;256>v;++v)HD[v]=89858*(v-128)+_m>>Sm,$D[v]=-22014*(v-128)+_m,GD[v]=-45773*(v-128),VD[v]=113618*(v-128)+_m>>Sm;for(v=Bh;v<qx;++v)k=76283*(v-16)+_m>>Sm,KD[v-Bh]=Jr(k,255),YD[v-Bh]=Jr(k+8>>4,15);hN=1}return 1}function ki(v){var k=v.ma,T=v.U,M=v.T;return t(!(1&v.ka)),0>=T||0>=M?0:(T=k.Ib(v,k),k.Jb!=null&&k.Jb(v,k,T),k.Dc+=T,1)}function kr(v){v.ma.memory=null}function vt(v,k,T,M){return K(v,8)!=47?0:(k[0]=K(v,14)+1,T[0]=K(v,14)+1,M[0]=K(v,1),K(v,3)!=0?0:!v.h)}function Sr(v,k){if(4>v)return v+1;var T=v-2>>1;return(2+(1&v)<<T)+K(k,T)+1}function _r(v,k){return 120<k?k-120:1<=(T=((T=DD[k-1])>>4)*v+(8-(15&T)))?T:1;var T}function pa(v,k,T){var M=H(T),V=v[k+=255&M].g-8;return 0<V&&(X(T,T.u+8),M=H(T),k+=v[k].value,k+=M&(1<<V)-1),X(T,T.u+v[k].g),v[k].value}function In(v,k,T){return T.g+=v.g,T.value+=v.value<<k>>>0,t(8>=T.g),v.g}function Tn(v,k,T){var M=v.xc;return t((k=M==0?0:v.vc[v.md*(T>>M)+(k>>M)])<v.Wb),v.Ya[k]}function Ua(v,k,T,M){var V=v.ab,Y=v.c*k,J=v.C;k=J+k;var Q=T,ee=M;for(M=v.Ta,T=v.Ua;0<V--;){var re=v.gc[V],ve=J,_e=k,je=Q,Ne=ee,qe=(ee=M,Q=T,re.Ea);switch(t(ve<_e),t(_e<=re.nc),re.hc){case 2:fm(je,Ne,(_e-ve)*qe,ee,Q);break;case 0:var Me=ve,be=_e,we=ee,ze=Q,$e=(nt=re).Ea;Me==0&&(Rx(je,Ne,null,null,1,we,ze),Je(je,Ne+1,0,0,$e-1,we,ze+1),Ne+=$e,ze+=$e,++Me);for(var Ue=1<<nt.b,it=Ue-1,tt=Oe($e,nt.b),bt=nt.K,nt=nt.w+(Me>>nt.b)*tt;Me<be;){var en=bt,on=nt,Xt=1;for(Ph(je,Ne,we,ze-$e,1,we,ze);Xt<$e;){var Ut=(Xt&~it)+Ue;Ut>$e&&(Ut=$e),(0,Ho[en[on++]>>8&15])(je,Ne+ +Xt,we,ze+Xt-$e,Ut-Xt,we,ze+Xt),Xt=Ut}Ne+=$e,ze+=$e,++Me&it||(nt+=tt)}_e!=re.nc&&a(ee,Q-qe,ee,Q+(_e-ve-1)*qe,qe);break;case 1:for(qe=je,be=Ne,$e=(je=re.Ea)-(ze=je&~(we=(Ne=1<<re.b)-1)),Me=Oe(je,re.b),Ue=re.K,re=re.w+(ve>>re.b)*Me;ve<_e;){for(it=Ue,tt=re,bt=new Ae,nt=be+ze,en=be+je;be<nt;)Xe(it[tt++],bt),iu(bt,qe,be,Ne,ee,Q),be+=Ne,Q+=Ne;be<en&&(Xe(it[tt++],bt),iu(bt,qe,be,$e,ee,Q),be+=$e,Q+=$e),++ve&we||(re+=Me)}break;case 3:if(je==ee&&Ne==Q&&0<re.b){for(be=ee,je=qe=Q+(_e-ve)*qe-(ze=(_e-ve)*Oe(re.Ea,re.b)),Ne=ee,we=Q,Me=[],ze=($e=ze)-1;0<=ze;--ze)Me[ze]=Ne[we+ze];for(ze=$e-1;0<=ze;--ze)be[je+ze]=Me[ze];Si(re,ve,_e,ee,qe,ee,Q)}else Si(re,ve,_e,je,Ne,ee,Q)}Q=M,ee=T}ee!=T&&a(M,T,Q,ee,Y)}function Fo(v,k){var T=v.V,M=v.Ba+v.c*v.C,V=k-v.C;if(t(k<=v.l.o),t(16>=V),0<V){var Y=v.l,J=v.Ta,Q=v.Ua,ee=Y.width;if(Ua(v,V,T,M),V=Q=[Q],t((T=v.C)<(M=k)),t(Y.v<Y.va),M>Y.o&&(M=Y.o),T<Y.j){var re=Y.j-T;T=Y.j,V[0]+=re*ee}if(T>=M?T=0:(V[0]+=4*Y.v,Y.ka=T-Y.j,Y.U=Y.va-Y.v,Y.T=M-T,T=1),T){if(Q=Q[0],11>(T=v.ca).S){var ve=T.f.RGBA,_e=(M=T.S,V=Y.U,Y=Y.T,re=ve.eb,ve.A),je=Y;for(ve=ve.fb+v.Ma*ve.A;0<je--;){var Ne=J,qe=Q,Me=V,be=re,we=ve;switch(M){case bm:Er(Ne,qe,Me,be,we);break;case ym:pr(Ne,qe,Me,be,we);break;case Ix:pr(Ne,qe,Me,be,we),Ci(be,we,0,Me,1,0);break;case nN:to(Ne,qe,Me,be,we);break;case wm:xn(Ne,qe,Me,be,we,1);break;case Fx:xn(Ne,qe,Me,be,we,1),Ci(be,we,0,Me,1,0);break;case Nm:xn(Ne,qe,Me,be,we,0);break;case km:xn(Ne,qe,Me,be,we,0),Ci(be,we,1,Me,1,0);break;case Ox:Vo(Ne,qe,Me,be,we);break;case Bx:Vo(Ne,qe,Me,be,we),Nn(be,we,Me,1,0);break;case aN:eo(Ne,qe,Me,be,we);break;default:t(0)}Q+=ee,ve+=_e}v.Ma+=Y}else alert("todo:EmitRescaledRowsYUVA");t(v.Ma<=T.height)}}v.C=k,t(v.C<=v.i)}function Kr(v){var k;if(0<v.ua)return 0;for(k=0;k<v.Wb;++k){var T=v.Ya[k].G,M=v.Ya[k].H;if(0<T[1][M[1]+0].g||0<T[2][M[2]+0].g||0<T[3][M[3]+0].g)return 0}return 1}function jr(v,k,T,M,V,Y){if(v.Z!=0){var J=v.qd,Q=v.rd;for(t(Yo[v.Z]!=null);k<T;++k)Yo[v.Z](J,Q,M,V,M,V,Y),J=M,Q=V,V+=Y;v.qd=J,v.rd=Q}}function Yr(v,k){var T=v.l.ma,M=T.Z==0||T.Z==1?v.l.j:v.C;if(M=v.C<M?M:v.C,t(k<=v.l.o),k>M){var V=v.l.width,Y=T.ca,J=T.tb+V*M,Q=v.V,ee=v.Ba+v.c*M,re=v.gc;t(v.ab==1),t(re[0].hc==3),pm(re[0],M,k,Q,ee,Y,J),jr(T,M,k,Y,J,V)}v.C=v.Ma=k}function Xr(v,k,T,M,V,Y,J){var Q=v.$/M,ee=v.$%M,re=v.m,ve=v.s,_e=T+v.$,je=_e;V=T+M*V;var Ne=T+M*Y,qe=280+ve.ua,Me=v.Pb?Q:16777216,be=0<ve.ua?ve.Wa:null,we=ve.wc,ze=_e<Ne?Tn(ve,ee,Q):null;t(v.C<Y),t(Ne<=V);var $e=!1;e:for(;;){for(;$e||_e<Ne;){var Ue=0;if(Q>=Me){var it=_e-T;t((Me=v).Pb),Me.wd=Me.m,Me.xd=it,0<Me.s.ua&&me(Me.s.Wa,Me.s.vb),Me=Q+LD}if(ee&we||(ze=Tn(ve,ee,Q)),t(ze!=null),ze.Qb&&(k[_e]=ze.qb,$e=!0),!$e)if(W(re),ze.jc){Ue=re,it=k;var tt=_e,bt=ze.pd[H(Ue)&qa-1];t(ze.jc),256>bt.g?(X(Ue,Ue.u+bt.g),it[tt]=bt.value,Ue=0):(X(Ue,Ue.u+bt.g-256),t(256<=bt.value),Ue=bt.value),Ue==0&&($e=!0)}else Ue=pa(ze.G[0],ze.H[0],re);if(re.h)break;if($e||256>Ue){if(!$e)if(ze.nd)k[_e]=(ze.qb|Ue<<8)>>>0;else{if(W(re),$e=pa(ze.G[1],ze.H[1],re),W(re),it=pa(ze.G[2],ze.H[2],re),tt=pa(ze.G[3],ze.H[3],re),re.h)break;k[_e]=(tt<<24|$e<<16|Ue<<8|it)>>>0}if($e=!1,++_e,++ee>=M&&(ee=0,++Q,J!=null&&Q<=Y&&!(Q%16)&&J(v,Q),be!=null))for(;je<_e;)Ue=k[je++],be.X[(506832829*Ue&4294967295)>>>be.Mb]=Ue}else if(280>Ue){if(Ue=Sr(Ue-256,re),it=pa(ze.G[4],ze.H[4],re),W(re),it=_r(M,it=Sr(it,re)),re.h)break;if(_e-T<it||V-_e<Ue)break e;for(tt=0;tt<Ue;++tt)k[_e+tt]=k[_e+tt-it];for(_e+=Ue,ee+=Ue;ee>=M;)ee-=M,++Q,J!=null&&Q<=Y&&!(Q%16)&&J(v,Q);if(t(_e<=V),ee&we&&(ze=Tn(ve,ee,Q)),be!=null)for(;je<_e;)Ue=k[je++],be.X[(506832829*Ue&4294967295)>>>be.Mb]=Ue}else{if(!(Ue<qe))break e;for($e=Ue-280,t(be!=null);je<_e;)Ue=k[je++],be.X[(506832829*Ue&4294967295)>>>be.Mb]=Ue;Ue=_e,t(!($e>>>(it=be).Xa)),k[Ue]=it.X[$e],$e=!0}$e||t(re.h==$(re))}if(v.Pb&&re.h&&_e<V)t(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&me(v.s.vb,v.s.Wa);else{if(re.h)break e;J!=null&&J(v,Q>Y?Y:Q),v.a=0,v.$=_e-T}return 1}return v.a=3,0}function St(v){t(v!=null),v.vc=null,v.yc=null,v.Ya=null;var k=v.Wa;k!=null&&(k.X=null),v.vb=null,t(v!=null)}function Wt(){var v=new Px;return v==null?null:(v.a=0,v.xb=sN,Gr("Predictor","VP8LPredictors"),Gr("Predictor","VP8LPredictors_C"),Gr("PredictorAdd","VP8LPredictorsAdd"),Gr("PredictorAdd","VP8LPredictorsAdd_C"),fm=le,iu=We,Er=Ke,pr=Ht,Vo=xt,eo=Xn,to=Mt,A.VP8LMapColor32b=_c,A.VP8LMapColor8b=mm,v)}function Zt(v,k,T,M,V){var Y=1,J=[v],Q=[k],ee=M.m,re=M.s,ve=null,_e=0;e:for(;;){if(T)for(;Y&&K(ee,1);){var je=J,Ne=Q,qe=M,Me=1,be=qe.m,we=qe.gc[qe.ab],ze=K(be,2);if(qe.Oc&1<<ze)Y=0;else{switch(qe.Oc|=1<<ze,we.hc=ze,we.Ea=je[0],we.nc=Ne[0],we.K=[null],++qe.ab,t(4>=qe.ab),ze){case 0:case 1:we.b=K(be,3)+2,Me=Zt(Oe(we.Ea,we.b),Oe(we.nc,we.b),0,qe,we.K),we.K=we.K[0];break;case 3:var $e,Ue=K(be,8)+1,it=16<Ue?0:4<Ue?1:2<Ue?2:3;if(je[0]=Oe(we.Ea,it),we.b=it,$e=Me=Zt(Ue,1,0,qe,we.K)){var tt,bt=Ue,nt=we,en=1<<(8>>nt.b),on=i(en);if(on==null)$e=0;else{var Xt=nt.K[0],Ut=nt.w;for(on[0]=nt.K[0][0],tt=1;tt<1*bt;++tt)on[tt]=ke(Xt[Ut+tt],on[tt-1]);for(;tt<4*en;++tt)on[tt]=0;nt.K[0]=null,nt.K[0]=on,$e=1}}Me=$e;break;case 2:break;default:t(0)}Y=Me}}if(J=J[0],Q=Q[0],Y&&K(ee,1)&&!(Y=1<=(_e=K(ee,4))&&11>=_e)){M.a=3;break e}var bn;if(bn=Y)t:{var mn,Lt,ua,Dr=M,ca=J,Tr=Q,ln=_e,Zr=T,ei=Dr.m,Da=Dr.s,Wa=[null],gr=1,Di=0,bs=TD[ln];n:for(;;){if(Zr&&K(ei,1)){var Ta=K(ei,3)+2,io=Oe(ca,Ta),cu=Oe(Tr,Ta),Dc=io*cu;if(!Zt(io,cu,0,Dr,Wa))break n;for(Wa=Wa[0],Da.xc=Ta,mn=0;mn<Dc;++mn){var Xo=Wa[mn]>>8&65535;Wa[mn]=Xo,Xo>=gr&&(gr=Xo+1)}}if(ei.h)break n;for(Lt=0;5>Lt;++Lt){var Hn=rN[Lt];!Lt&&0<ln&&(Hn+=1<<ln),Di<Hn&&(Di=Hn)}var Wx=s(gr*bs,E),mN=gr,gN=s(mN,z);if(gN==null)var Cm=null;else t(65536>=mN),Cm=gN;var zh=i(Di);if(Cm==null||zh==null||Wx==null){Dr.a=1;break n}var Am=Wx;for(mn=ua=0;mn<gr;++mn){var Qi=Cm[mn],Tc=Qi.G,Lc=Qi.H,vN=0,Em=1,xN=0;for(Lt=0;5>Lt;++Lt){Hn=rN[Lt],Tc[Lt]=Am,Lc[Lt]=ua,!Lt&&0<ln&&(Hn+=1<<ln);r:{var Dm,Hx=Hn,Tm=Dr,Uh=zh,QD=Am,ZD=ua,Vx=0,Jo=Tm.m,eT=K(Jo,1);if(r(Uh,0,0,Hx),eT){var tT=K(Jo,1)+1,nT=K(Jo,1),bN=K(Jo,nT==0?1:8);Uh[bN]=1,tT==2&&(Uh[bN=K(Jo,8)]=1);var Lm=1}else{var yN=i(19),wN=K(Jo,4)+4;if(19<wN){Tm.a=3;var Pm=0;break r}for(Dm=0;Dm<wN;++Dm)yN[ED[Dm]]=K(Jo,3);var Gx=void 0,qh=void 0,NN=Tm,aT=yN,Rm=Hx,kN=Uh,$x=0,Qo=NN.m,SN=8,_N=s(128,E);a:for(;j(_N,0,7,aT,19);){if(K(Qo,1)){var rT=2+2*K(Qo,3);if((Gx=2+K(Qo,rT))>Rm)break a}else Gx=Rm;for(qh=0;qh<Rm&&Gx--;){W(Qo);var jN=_N[0+(127&H(Qo))];X(Qo,Qo.u+jN.g);var Pc=jN.value;if(16>Pc)kN[qh++]=Pc,Pc!=0&&(SN=Pc);else{var iT=Pc==16,CN=Pc-16,sT=CD[CN],AN=K(Qo,jD[CN])+sT;if(qh+AN>Rm)break a;for(var oT=iT?SN:0;0<AN--;)kN[qh++]=oT}}$x=1;break a}$x||(NN.a=3),Lm=$x}(Lm=Lm&&!Jo.h)&&(Vx=j(QD,ZD,8,Uh,Hx)),Lm&&Vx!=0?Pm=Vx:(Tm.a=3,Pm=0)}if(Pm==0)break n;if(Em&&AD[Lt]==1&&(Em=Am[ua].g==0),vN+=Am[ua].g,ua+=Pm,3>=Lt){var Wh,Kx=zh[0];for(Wh=1;Wh<Hn;++Wh)zh[Wh]>Kx&&(Kx=zh[Wh]);xN+=Kx}}if(Qi.nd=Em,Qi.Qb=0,Em&&(Qi.qb=(Tc[3][Lc[3]+0].value<<24|Tc[1][Lc[1]+0].value<<16|Tc[2][Lc[2]+0].value)>>>0,vN==0&&256>Tc[0][Lc[0]+0].value&&(Qi.Qb=1,Qi.qb+=Tc[0][Lc[0]+0].value<<8)),Qi.jc=!Qi.Qb&&6>xN,Qi.jc){var Mm,so=Qi;for(Mm=0;Mm<qa;++Mm){var Zo=Mm,el=so.pd[Zo],Om=so.G[0][so.H[0]+Zo];256<=Om.value?(el.g=Om.g+256,el.value=Om.value):(el.g=0,el.value=0,Zo>>=In(Om,8,el),Zo>>=In(so.G[1][so.H[1]+Zo],16,el),Zo>>=In(so.G[2][so.H[2]+Zo],0,el),In(so.G[3][so.H[3]+Zo],24,el))}}}Da.vc=Wa,Da.Wb=gr,Da.Ya=Cm,Da.yc=Wx,bn=1;break t}bn=0}if(!(Y=bn)){M.a=3;break e}if(0<_e){if(re.ua=1<<_e,!fe(re.Wa,_e)){M.a=1,Y=0;break e}}else re.ua=0;var Yx=M,EN=J,lT=Q,Xx=Yx.s,Jx=Xx.xc;if(Yx.c=EN,Yx.i=lT,Xx.md=Oe(EN,Jx),Xx.wc=Jx==0?-1:(1<<Jx)-1,T){M.xb=BD;break e}if((ve=i(J*Q))==null){M.a=1,Y=0;break e}Y=(Y=Xr(M,ve,0,J,Q,Q,null))&&!ee.h;break e}return Y?(V!=null?V[0]=ve:(t(ve==null),t(T)),M.$=0,T||St(re)):St(re),Y}function ma(v,k){var T=v.c*v.i,M=T+k+16*k;return t(v.c<=k),v.V=i(M),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+T+k,1)}function Aa(v,k){var T=v.C,M=k-T,V=v.V,Y=v.Ba+v.c*T;for(t(k<=v.l.o);0<M;){var J=16<M?16:M,Q=v.l.ma,ee=v.l.width,re=ee*J,ve=Q.ca,_e=Q.tb+ee*T,je=v.Ta,Ne=v.Ua;Ua(v,J,V,Y),Zn(je,Ne,ve,_e,re),jr(Q,T,T+J,ve,_e,ee),M-=J,V+=J*v.c,T+=J}t(T==k),v.C=v.Ma=k}function ms(){this.ub=this.yd=this.td=this.Rb=0}function Bo(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function zo(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function $p(){this.Yb=function(){var v=[];return function k(T,M,V){for(var Y=V[M],J=0;J<Y&&(T.push(V.length>M+1?[]:0),!(V.length<M+1));J++)k(T[J],M+1,V)}(v,0,[3,11]),v}()}function cx(){this.jb=i(3),this.Wc=o([4,8],$p),this.Xc=o([4,17],$p)}function dx(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function cc(){this.ld=this.La=this.dd=this.tc=0}function Kp(){this.Na=this.la=0}function hx(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ph(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function fx(){this.uc=this.M=this.Nb=0,this.wa=Array(new cc),this.Y=0,this.ya=Array(new ph),this.aa=0,this.l=new dc}function Yp(){this.y=i(16),this.f=i(8),this.ea=i(8)}function px(){this.cb=this.a=0,this.sc="",this.m=new Z,this.Od=new ms,this.Kc=new Bo,this.ed=new dx,this.Qa=new zo,this.Ic=this.$c=this.Aa=0,this.D=new fx,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,Z),this.ia=0,this.pb=s(4,hx),this.Pa=new cx,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Yp),this.Hd=0,this.rb=Array(new Kp),this.sb=0,this.wa=Array(new cc),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ph),this.L=this.aa=0,this.gd=o([4,2],cc),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function dc(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function mx(){var v=new px;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Fh||(Fh=Qp)),v}function Jn(v,k,T){return v.a==0&&(v.a=k,v.sc=T,v.cb=0),0}function Xp(v,k,T){return 3<=T&&v[k+0]==157&&v[k+1]==1&&v[k+2]==42}function Jp(v,k){if(v==null)return 0;if(v.a=0,v.sc="OK",k==null)return Jn(v,2,"null VP8Io passed to VP8GetHeaders()");var T=k.data,M=k.w,V=k.ha;if(4>V)return Jn(v,7,"Truncated header.");var Y=T[M+0]|T[M+1]<<8|T[M+2]<<16,J=v.Od;if(J.Rb=!(1&Y),J.td=Y>>1&7,J.yd=Y>>4&1,J.ub=Y>>5,3<J.td)return Jn(v,3,"Incorrect keyframe parameters.");if(!J.yd)return Jn(v,4,"Frame not displayable.");M+=3,V-=3;var Q=v.Kc;if(J.Rb){if(7>V)return Jn(v,7,"cannot parse picture header");if(!Xp(T,M,V))return Jn(v,3,"Bad code word");Q.c=16383&(T[M+4]<<8|T[M+3]),Q.Td=T[M+4]>>6,Q.i=16383&(T[M+6]<<8|T[M+5]),Q.Ud=T[M+6]>>6,M+=7,V-=7,v.za=Q.c+15>>4,v.Ub=Q.i+15>>4,k.width=Q.c,k.height=Q.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,r((Y=v.Pa).jb,0,255,Y.jb.length),t((Y=v.Qa)!=null),Y.Cb=0,Y.Bb=0,Y.Fb=1,r(Y.Zb,0,0,Y.Zb.length),r(Y.Lb,0,0,Y.Lb)}if(J.ub>V)return Jn(v,7,"bad partition length");U(Y=v.m,T,M,J.ub),M+=J.ub,V-=J.ub,J.Rb&&(Q.Ld=ce(Y),Q.Kd=ce(Y)),Q=v.Qa;var ee,re=v.Pa;if(t(Y!=null),t(Q!=null),Q.Cb=ce(Y),Q.Cb){if(Q.Bb=ce(Y),ce(Y)){for(Q.Fb=ce(Y),ee=0;4>ee;++ee)Q.Zb[ee]=ce(Y)?B(Y,7):0;for(ee=0;4>ee;++ee)Q.Lb[ee]=ce(Y)?B(Y,6):0}if(Q.Bb)for(ee=0;3>ee;++ee)re.jb[ee]=ce(Y)?O(Y,8):255}else Q.Bb=0;if(Y.Ka)return Jn(v,3,"cannot parse segment header");if((Q=v.ed).zd=ce(Y),Q.Tb=O(Y,6),Q.wb=O(Y,3),Q.Pc=ce(Y),Q.Pc&&ce(Y)){for(re=0;4>re;++re)ce(Y)&&(Q.vd[re]=B(Y,6));for(re=0;4>re;++re)ce(Y)&&(Q.od[re]=B(Y,6))}if(v.L=Q.Tb==0?0:Q.zd?1:2,Y.Ka)return Jn(v,3,"cannot parse filter header");var ve=V;if(V=ee=M,M=ee+ve,Q=ve,v.Xb=(1<<O(v.m,2))-1,ve<3*(re=v.Xb))T=7;else{for(ee+=3*re,Q-=3*re,ve=0;ve<re;++ve){var _e=T[V+0]|T[V+1]<<8|T[V+2]<<16;_e>Q&&(_e=Q),U(v.Jc[+ve],T,ee,_e),ee+=_e,Q-=_e,V+=3}U(v.Jc[+re],T,ee,Q),T=ee<M?0:5}if(T!=0)return Jn(v,T,"cannot parse partitions");for(T=O(ee=v.m,7),V=ce(ee)?B(ee,4):0,M=ce(ee)?B(ee,4):0,Q=ce(ee)?B(ee,4):0,re=ce(ee)?B(ee,4):0,ee=ce(ee)?B(ee,4):0,ve=v.Qa,_e=0;4>_e;++_e){if(ve.Cb){var je=ve.Zb[_e];ve.Fb||(je+=T)}else{if(0<_e){v.pb[_e]=v.pb[0];continue}je=T}var Ne=v.pb[_e];Ne.Sc[0]=zx[Jr(je+V,127)],Ne.Sc[1]=Ux[Jr(je+0,127)],Ne.Eb[0]=2*zx[Jr(je+M,127)],Ne.Eb[1]=101581*Ux[Jr(je+Q,127)]>>16,8>Ne.Eb[1]&&(Ne.Eb[1]=8),Ne.Qc[0]=zx[Jr(je+re,117)],Ne.Qc[1]=Ux[Jr(je+ee,127)],Ne.lc=je+ee}if(!J.Rb)return Jn(v,4,"Not a key frame.");for(ce(Y),J=v.Pa,T=0;4>T;++T){for(V=0;8>V;++V)for(M=0;3>M;++M)for(Q=0;11>Q;++Q)re=ue(Y,ID[T][V][M][Q])?O(Y,8):MD[T][V][M][Q],J.Wc[T][V].Yb[M][Q]=re;for(V=0;17>V;++V)J.Xc[T][V]=J.Wc[T][FD[V]]}return v.kc=ce(Y),v.kc&&(v.Bd=O(Y,8)),v.cb=1}function Qp(v,k,T,M,V,Y,J){var Q=k[V].Yb[T];for(T=0;16>V;++V){if(!ue(v,Q[T+0]))return V;for(;!ue(v,Q[T+1]);)if(Q=k[++V].Yb[0],T=0,V==16)return 16;var ee=k[V+1].Yb;if(ue(v,Q[T+2])){var re=v,ve=0;if(ue(re,(je=Q)[(_e=T)+3]))if(ue(re,je[_e+6])){for(Q=0,_e=2*(ve=ue(re,je[_e+8]))+(je=ue(re,je[_e+9+ve])),ve=0,je=PD[_e];je[Q];++Q)ve+=ve+ue(re,je[Q]);ve+=3+(8<<_e)}else ue(re,je[_e+7])?(ve=7+2*ue(re,165),ve+=ue(re,145)):ve=5+ue(re,159);else ve=ue(re,je[_e+4])?3+ue(re,je[_e+5]):2;Q=ee[2]}else ve=1,Q=ee[1];ee=J+RD[V],0>(re=v).b&&ie(re);var _e,je=re.b,Ne=(_e=re.Ca>>1)-(re.I>>je)>>31;--re.b,re.Ca+=Ne,re.Ca|=1,re.I-=(_e+1&Ne)<<je,Y[ee]=((ve^Ne)-Ne)*M[(0<V)+0]}return 16}function mh(v){var k=v.rb[v.sb-1];k.la=0,k.Na=0,r(v.zc,0,0,v.zc.length),v.ja=0}function gx(v,k){if(v==null)return 0;if(k==null)return Jn(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!Jp(v,k))return 0;if(t(v.cb),k.ac==null||k.ac(k)){k.ob&&(v.L=0);var T=jm[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=k.v-T>>4,v.zb=k.j-T>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=k.o+15+T>>4,v.Hb=k.va+15+T>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var M=v.ed;for(T=0;4>T;++T){var V;if(v.Qa.Cb){var Y=v.Qa.Lb[T];v.Qa.Fb||(Y+=M.Tb)}else Y=M.Tb;for(V=0;1>=V;++V){var J=v.gd[T][V],Q=Y;if(M.Pc&&(Q+=M.vd[0],V&&(Q+=M.od[0])),0<(Q=0>Q?0:63<Q?63:Q)){var ee=Q;0<M.wb&&(ee=4<M.wb?ee>>2:ee>>1)>9-M.wb&&(ee=9-M.wb),1>ee&&(ee=1),J.dd=ee,J.tc=2*Q+ee,J.ld=40<=Q?2:15<=Q?1:0}else J.tc=0;J.La=V}}}T=0}else Jn(v,6,"Frame setup failed"),T=v.a;if(T=T==0){if(T){v.$c=0,0<v.Aa||(v.Ic=JD);e:{T=v.Ic,M=4*(ee=v.za);var re=32*ee,ve=ee+1,_e=0<v.L?ee*(0<v.Aa?2:1):0,je=(v.Aa==2?2:1)*ee;if((J=M+832+(V=3*(16*T+jm[v.L])/2*re)+(Y=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=J)T=0;else{if(J>v.Vb){if(v.Vb=0,v.Ec=i(J),v.Fc=0,v.Ec==null){T=Jn(v,1,"no memory during frame initialization.");break e}v.Vb=J}J=v.Ec,Q=v.Fc,v.Ac=J,v.Bc=Q,Q+=M,v.Gd=s(re,Yp),v.Hd=0,v.rb=s(ve+1,Kp),v.sb=1,v.wa=_e?s(_e,cc):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=ee),t(!0),v.oc=J,v.pc=Q,Q+=832,v.ya=s(je,ph),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=ee),v.R=16*ee,v.B=8*ee,ee=(re=jm[v.L])*v.R,re=re/2*v.B,v.sa=J,v.ta=Q+ee,v.qa=v.sa,v.ra=v.ta+16*T*v.R+re,v.Ha=v.qa,v.Ia=v.ra+8*T*v.B+re,v.$c=0,Q+=V,v.mb=Y?J:null,v.nb=Y?Q:null,t(Q+Y<=v.Fc+v.Vb),mh(v),r(v.Ac,v.Bc,0,M),T=1}}if(T){if(k.ka=0,k.y=v.sa,k.O=v.ta,k.f=v.qa,k.N=v.ra,k.ea=v.Ha,k.Vd=v.Ia,k.fa=v.R,k.Rc=v.B,k.F=null,k.J=0,!vm){for(T=-255;255>=T;++T)ga[255+T]=0>T?-T:T;for(T=-1020;1020>=T;++T)ao[1020+T]=-128>T?-128:127<T?127:T;for(T=-112;112>=T;++T)Ih[112+T]=-16>T?-16:15<T?15:T;for(T=-255;510>=T;++T)Ec[255+T]=0>T?0:255<T?255:T;vm=1}jc=bx,no=vx,Rh=em,mr=xx,_i=tm,Qn=Zp,Cc=wh,gm=au,Mh=Lx,su=Nh,ou=Tx,Go=vc,lu=kh,Ac=cm,uu=um,$o=vs,Oh=Zs,ji=Dx,Ji[0]=gs,Ji[1]=yx,Ji[2]=Sx,Ji[3]=_x,Ji[4]=rm,Ji[5]=mc,Ji[6]=im,Ji[7]=xh,Ji[8]=Cx,Ji[9]=jx,Ko[0]=nm,Ko[1]=Nx,Ko[2]=Qs,Ko[3]=fc,Ko[4]=Ja,Ko[5]=kx,Ko[6]=am,ro[0]=Uo,ro[1]=wx,ro[2]=Ax,ro[3]=bh,ro[4]=nu,ro[5]=Ex,ro[6]=yh,T=1}else T=0}T&&(T=function(Ne,qe){for(Ne.M=0;Ne.M<Ne.Va;++Ne.M){var Me,be=Ne.Jc[Ne.M&Ne.Xb],we=Ne.m,ze=Ne;for(Me=0;Me<ze.za;++Me){var $e=we,Ue=ze,it=Ue.Ac,tt=Ue.Bc+4*Me,bt=Ue.zc,nt=Ue.ya[Ue.aa+Me];if(Ue.Qa.Bb?nt.$b=ue($e,Ue.Pa.jb[0])?2+ue($e,Ue.Pa.jb[2]):ue($e,Ue.Pa.jb[1]):nt.$b=0,Ue.kc&&(nt.Ad=ue($e,Ue.Bd)),nt.Za=!ue($e,145)+0,nt.Za){var en=nt.Ob,on=0;for(Ue=0;4>Ue;++Ue){var Xt,Ut=bt[0+Ue];for(Xt=0;4>Xt;++Xt){Ut=OD[it[tt+Xt]][Ut];for(var bn=iN[ue($e,Ut[0])];0<bn;)bn=iN[2*bn+ue($e,Ut[bn])];Ut=-bn,it[tt+Xt]=Ut}a(en,on,it,tt,4),on+=4,bt[0+Ue]=Ut}}else Ut=ue($e,156)?ue($e,128)?1:3:ue($e,163)?2:0,nt.Ob[0]=Ut,r(it,tt,Ut,4),r(bt,0,Ut,4);nt.Dd=ue($e,142)?ue($e,114)?ue($e,183)?1:3:2:0}if(ze.m.Ka)return Jn(Ne,7,"Premature end-of-partition0 encountered.");for(;Ne.ja<Ne.za;++Ne.ja){if(ze=be,$e=(we=Ne).rb[we.sb-1],it=we.rb[we.sb+we.ja],Me=we.ya[we.aa+we.ja],tt=we.kc?Me.Ad:0)$e.la=it.la=0,Me.Za||($e.Na=it.Na=0),Me.Hc=0,Me.Gc=0,Me.ia=0;else{var mn,Lt;if($e=it,it=ze,tt=we.Pa.Xc,bt=we.ya[we.aa+we.ja],nt=we.pb[bt.$b],Ue=bt.ad,en=0,on=we.rb[we.sb-1],Ut=Xt=0,r(Ue,en,0,384),bt.Za)var ua=0,Dr=tt[3];else{bn=i(16);var ca=$e.Na+on.Na;if(ca=Fh(it,tt[1],ca,nt.Eb,0,bn,0),$e.Na=on.Na=(0<ca)+0,1<ca)jc(bn,0,Ue,en);else{var Tr=bn[0]+3>>3;for(bn=0;256>bn;bn+=16)Ue[en+bn]=Tr}ua=1,Dr=tt[0]}var ln=15&$e.la,Zr=15&on.la;for(bn=0;4>bn;++bn){var ei=1&Zr;for(Tr=Lt=0;4>Tr;++Tr)ln=ln>>1|(ei=(ca=Fh(it,Dr,ca=ei+(1&ln),nt.Sc,ua,Ue,en))>ua)<<7,Lt=Lt<<2|(3<ca?3:1<ca?2:Ue[en+0]!=0),en+=16;ln>>=4,Zr=Zr>>1|ei<<7,Xt=(Xt<<8|Lt)>>>0}for(Dr=ln,ua=Zr>>4,mn=0;4>mn;mn+=2){for(Lt=0,ln=$e.la>>4+mn,Zr=on.la>>4+mn,bn=0;2>bn;++bn){for(ei=1&Zr,Tr=0;2>Tr;++Tr)ca=ei+(1&ln),ln=ln>>1|(ei=0<(ca=Fh(it,tt[2],ca,nt.Qc,0,Ue,en)))<<3,Lt=Lt<<2|(3<ca?3:1<ca?2:Ue[en+0]!=0),en+=16;ln>>=2,Zr=Zr>>1|ei<<5}Ut|=Lt<<4*mn,Dr|=ln<<4<<mn,ua|=(240&Zr)<<mn}$e.la=Dr,on.la=ua,bt.Hc=Xt,bt.Gc=Ut,bt.ia=43690&Ut?0:nt.ia,tt=!(Xt|Ut)}if(0<we.L&&(we.wa[we.Y+we.ja]=we.gd[Me.$b][Me.Za],we.wa[we.Y+we.ja].La|=!tt),ze.Ka)return Jn(Ne,7,"Premature end-of-file encountered.")}if(mh(Ne),we=qe,ze=1,Me=(be=Ne).D,$e=0<be.L&&be.M>=be.zb&&be.M<=be.Va,be.Aa==0)e:{if(Me.M=be.M,Me.uc=$e,Eh(be,Me),ze=1,Me=(Lt=be.D).Nb,$e=(Ut=jm[be.L])*be.R,it=Ut/2*be.B,bn=16*Me*be.R,Tr=8*Me*be.B,tt=be.sa,bt=be.ta-$e+bn,nt=be.qa,Ue=be.ra-it+Tr,en=be.Ha,on=be.Ia-it+Tr,Zr=(ln=Lt.M)==0,Xt=ln>=be.Va-1,be.Aa==2&&Eh(be,Lt),Lt.uc)for(ei=(ca=be).D.M,t(ca.D.uc),Lt=ca.yb;Lt<ca.Hb;++Lt){ua=Lt,Dr=ei;var Da=(Wa=(Hn=ca).D).Nb;mn=Hn.R;var Wa=Wa.wa[Wa.Y+ua],gr=Hn.sa,Di=Hn.ta+16*Da*mn+16*ua,bs=Wa.dd,Ta=Wa.tc;if(Ta!=0)if(t(3<=Ta),Hn.L==1)0<ua&&$o(gr,Di,mn,Ta+4),Wa.La&&ji(gr,Di,mn,Ta),0<Dr&&uu(gr,Di,mn,Ta+4),Wa.La&&Oh(gr,Di,mn,Ta);else{var io=Hn.B,cu=Hn.qa,Dc=Hn.ra+8*Da*io+8*ua,Xo=Hn.Ha,Hn=Hn.Ia+8*Da*io+8*ua;Da=Wa.ld,0<ua&&(gm(gr,Di,mn,Ta+4,bs,Da),su(cu,Dc,Xo,Hn,io,Ta+4,bs,Da)),Wa.La&&(Go(gr,Di,mn,Ta,bs,Da),Ac(cu,Dc,Xo,Hn,io,Ta,bs,Da)),0<Dr&&(Cc(gr,Di,mn,Ta+4,bs,Da),Mh(cu,Dc,Xo,Hn,io,Ta+4,bs,Da)),Wa.La&&(ou(gr,Di,mn,Ta,bs,Da),lu(cu,Dc,Xo,Hn,io,Ta,bs,Da))}}if(be.ia&&alert("todo:DitherRow"),we.put!=null){if(Lt=16*ln,ln=16*(ln+1),Zr?(we.y=be.sa,we.O=be.ta+bn,we.f=be.qa,we.N=be.ra+Tr,we.ea=be.Ha,we.W=be.Ia+Tr):(Lt-=Ut,we.y=tt,we.O=bt,we.f=nt,we.N=Ue,we.ea=en,we.W=on),Xt||(ln-=Ut),ln>we.o&&(ln=we.o),we.F=null,we.J=null,be.Fa!=null&&0<be.Fa.length&&Lt<ln&&(we.J=Ch(be,we,Lt,ln-Lt),we.F=be.mb,we.F==null&&we.F.length==0)){ze=Jn(be,3,"Could not decode alpha data.");break e}Lt<we.j&&(Ut=we.j-Lt,Lt=we.j,t(!(1&Ut)),we.O+=be.R*Ut,we.N+=be.B*(Ut>>1),we.W+=be.B*(Ut>>1),we.F!=null&&(we.J+=we.width*Ut)),Lt<ln&&(we.O+=we.v,we.N+=we.v>>1,we.W+=we.v>>1,we.F!=null&&(we.J+=we.v),we.ka=Lt-we.j,we.U=we.va-we.v,we.T=ln-Lt,ze=we.put(we))}Me+1!=be.Ic||Xt||(a(be.sa,be.ta-$e,tt,bt+16*be.R,$e),a(be.qa,be.ra-it,nt,Ue+8*be.B,it),a(be.Ha,be.Ia-it,en,on+8*be.B,it))}if(!ze)return Jn(Ne,6,"Output aborted.")}return 1}(v,k)),k.bc!=null&&k.bc(k),T&=1}return T?(v.cb=0,T):0}function Ki(v,k,T,M,V){V=v[k+T+32*M]+(V>>3),v[k+T+32*M]=-256&V?0>V?0:255:V}function hc(v,k,T,M,V,Y){Ki(v,k,0,T,M+V),Ki(v,k,1,T,M+Y),Ki(v,k,2,T,M-Y),Ki(v,k,3,T,M-V)}function Cr(v){return(20091*v>>16)+v}function gh(v,k,T,M){var V,Y=0,J=i(16);for(V=0;4>V;++V){var Q=v[k+0]+v[k+8],ee=v[k+0]-v[k+8],re=(35468*v[k+4]>>16)-Cr(v[k+12]),ve=Cr(v[k+4])+(35468*v[k+12]>>16);J[Y+0]=Q+ve,J[Y+1]=ee+re,J[Y+2]=ee-re,J[Y+3]=Q-ve,Y+=4,k++}for(V=Y=0;4>V;++V)Q=(v=J[Y+0]+4)+J[Y+8],ee=v-J[Y+8],re=(35468*J[Y+4]>>16)-Cr(J[Y+12]),Ki(T,M,0,0,Q+(ve=Cr(J[Y+4])+(35468*J[Y+12]>>16))),Ki(T,M,1,0,ee+re),Ki(T,M,2,0,ee-re),Ki(T,M,3,0,Q-ve),Y++,M+=32}function Zp(v,k,T,M){var V=v[k+0]+4,Y=35468*v[k+4]>>16,J=Cr(v[k+4]),Q=35468*v[k+1]>>16;hc(T,M,0,V+J,v=Cr(v[k+1]),Q),hc(T,M,1,V+Y,v,Q),hc(T,M,2,V-Y,v,Q),hc(T,M,3,V-J,v,Q)}function vx(v,k,T,M,V){gh(v,k,T,M),V&&gh(v,k+16,T,M+4)}function em(v,k,T,M){no(v,k+0,T,M,1),no(v,k+32,T,M+128,1)}function xx(v,k,T,M){var V;for(v=v[k+0]+4,V=0;4>V;++V)for(k=0;4>k;++k)Ki(T,M,k,V,v)}function tm(v,k,T,M){v[k+0]&&mr(v,k+0,T,M),v[k+16]&&mr(v,k+16,T,M+4),v[k+32]&&mr(v,k+32,T,M+128),v[k+48]&&mr(v,k+48,T,M+128+4)}function bx(v,k,T,M){var V,Y=i(16);for(V=0;4>V;++V){var J=v[k+0+V]+v[k+12+V],Q=v[k+4+V]+v[k+8+V],ee=v[k+4+V]-v[k+8+V],re=v[k+0+V]-v[k+12+V];Y[0+V]=J+Q,Y[8+V]=J-Q,Y[4+V]=re+ee,Y[12+V]=re-ee}for(V=0;4>V;++V)J=(v=Y[0+4*V]+3)+Y[3+4*V],Q=Y[1+4*V]+Y[2+4*V],ee=Y[1+4*V]-Y[2+4*V],re=v-Y[3+4*V],T[M+0]=J+Q>>3,T[M+16]=re+ee>>3,T[M+32]=J-Q>>3,T[M+48]=re-ee>>3,M+=64}function vh(v,k,T){var M,V=k-32,Y=Qr,J=255-v[V-1];for(M=0;M<T;++M){var Q,ee=Y,re=J+v[k-1];for(Q=0;Q<T;++Q)v[k+Q]=ee[re+v[V+Q]];k+=32}}function yx(v,k){vh(v,k,4)}function wx(v,k){vh(v,k,8)}function Nx(v,k){vh(v,k,16)}function Qs(v,k){var T;for(T=0;16>T;++T)a(v,k+32*T,v,k-32,16)}function fc(v,k){var T;for(T=16;0<T;--T)r(v,k,v[k-1],16),k+=32}function pc(v,k,T){var M;for(M=0;16>M;++M)r(k,T+32*M,v,16)}function nm(v,k){var T,M=16;for(T=0;16>T;++T)M+=v[k-1+32*T]+v[k+T-32];pc(M>>5,v,k)}function Ja(v,k){var T,M=8;for(T=0;16>T;++T)M+=v[k-1+32*T];pc(M>>4,v,k)}function kx(v,k){var T,M=8;for(T=0;16>T;++T)M+=v[k+T-32];pc(M>>4,v,k)}function am(v,k){pc(128,v,k)}function jt(v,k,T){return v+2*k+T+2>>2}function Sx(v,k){var T,M=k-32;for(M=new Uint8Array([jt(v[M-1],v[M+0],v[M+1]),jt(v[M+0],v[M+1],v[M+2]),jt(v[M+1],v[M+2],v[M+3]),jt(v[M+2],v[M+3],v[M+4])]),T=0;4>T;++T)a(v,k+32*T,M,0,M.length)}function _x(v,k){var T=v[k-1],M=v[k-1+32],V=v[k-1+64],Y=v[k-1+96];he(v,k+0,16843009*jt(v[k-1-32],T,M)),he(v,k+32,16843009*jt(T,M,V)),he(v,k+64,16843009*jt(M,V,Y)),he(v,k+96,16843009*jt(V,Y,Y))}function gs(v,k){var T,M=4;for(T=0;4>T;++T)M+=v[k+T-32]+v[k-1+32*T];for(M>>=3,T=0;4>T;++T)r(v,k+32*T,M,4)}function rm(v,k){var T=v[k-1+0],M=v[k-1+32],V=v[k-1+64],Y=v[k-1-32],J=v[k+0-32],Q=v[k+1-32],ee=v[k+2-32],re=v[k+3-32];v[k+0+96]=jt(M,V,v[k-1+96]),v[k+1+96]=v[k+0+64]=jt(T,M,V),v[k+2+96]=v[k+1+64]=v[k+0+32]=jt(Y,T,M),v[k+3+96]=v[k+2+64]=v[k+1+32]=v[k+0+0]=jt(J,Y,T),v[k+3+64]=v[k+2+32]=v[k+1+0]=jt(Q,J,Y),v[k+3+32]=v[k+2+0]=jt(ee,Q,J),v[k+3+0]=jt(re,ee,Q)}function im(v,k){var T=v[k+1-32],M=v[k+2-32],V=v[k+3-32],Y=v[k+4-32],J=v[k+5-32],Q=v[k+6-32],ee=v[k+7-32];v[k+0+0]=jt(v[k+0-32],T,M),v[k+1+0]=v[k+0+32]=jt(T,M,V),v[k+2+0]=v[k+1+32]=v[k+0+64]=jt(M,V,Y),v[k+3+0]=v[k+2+32]=v[k+1+64]=v[k+0+96]=jt(V,Y,J),v[k+3+32]=v[k+2+64]=v[k+1+96]=jt(Y,J,Q),v[k+3+64]=v[k+2+96]=jt(J,Q,ee),v[k+3+96]=jt(Q,ee,ee)}function mc(v,k){var T=v[k-1+0],M=v[k-1+32],V=v[k-1+64],Y=v[k-1-32],J=v[k+0-32],Q=v[k+1-32],ee=v[k+2-32],re=v[k+3-32];v[k+0+0]=v[k+1+64]=Y+J+1>>1,v[k+1+0]=v[k+2+64]=J+Q+1>>1,v[k+2+0]=v[k+3+64]=Q+ee+1>>1,v[k+3+0]=ee+re+1>>1,v[k+0+96]=jt(V,M,T),v[k+0+64]=jt(M,T,Y),v[k+0+32]=v[k+1+96]=jt(T,Y,J),v[k+1+32]=v[k+2+96]=jt(Y,J,Q),v[k+2+32]=v[k+3+96]=jt(J,Q,ee),v[k+3+32]=jt(Q,ee,re)}function xh(v,k){var T=v[k+0-32],M=v[k+1-32],V=v[k+2-32],Y=v[k+3-32],J=v[k+4-32],Q=v[k+5-32],ee=v[k+6-32],re=v[k+7-32];v[k+0+0]=T+M+1>>1,v[k+1+0]=v[k+0+64]=M+V+1>>1,v[k+2+0]=v[k+1+64]=V+Y+1>>1,v[k+3+0]=v[k+2+64]=Y+J+1>>1,v[k+0+32]=jt(T,M,V),v[k+1+32]=v[k+0+96]=jt(M,V,Y),v[k+2+32]=v[k+1+96]=jt(V,Y,J),v[k+3+32]=v[k+2+96]=jt(Y,J,Q),v[k+3+64]=jt(J,Q,ee),v[k+3+96]=jt(Q,ee,re)}function jx(v,k){var T=v[k-1+0],M=v[k-1+32],V=v[k-1+64],Y=v[k-1+96];v[k+0+0]=T+M+1>>1,v[k+2+0]=v[k+0+32]=M+V+1>>1,v[k+2+32]=v[k+0+64]=V+Y+1>>1,v[k+1+0]=jt(T,M,V),v[k+3+0]=v[k+1+32]=jt(M,V,Y),v[k+3+32]=v[k+1+64]=jt(V,Y,Y),v[k+3+64]=v[k+2+64]=v[k+0+96]=v[k+1+96]=v[k+2+96]=v[k+3+96]=Y}function Cx(v,k){var T=v[k-1+0],M=v[k-1+32],V=v[k-1+64],Y=v[k-1+96],J=v[k-1-32],Q=v[k+0-32],ee=v[k+1-32],re=v[k+2-32];v[k+0+0]=v[k+2+32]=T+J+1>>1,v[k+0+32]=v[k+2+64]=M+T+1>>1,v[k+0+64]=v[k+2+96]=V+M+1>>1,v[k+0+96]=Y+V+1>>1,v[k+3+0]=jt(Q,ee,re),v[k+2+0]=jt(J,Q,ee),v[k+1+0]=v[k+3+32]=jt(T,J,Q),v[k+1+32]=v[k+3+64]=jt(M,T,J),v[k+1+64]=v[k+3+96]=jt(V,M,T),v[k+1+96]=jt(Y,V,M)}function Ax(v,k){var T;for(T=0;8>T;++T)a(v,k+32*T,v,k-32,8)}function bh(v,k){var T;for(T=0;8>T;++T)r(v,k,v[k-1],8),k+=32}function tu(v,k,T){var M;for(M=0;8>M;++M)r(k,T+32*M,v,8)}function Uo(v,k){var T,M=8;for(T=0;8>T;++T)M+=v[k+T-32]+v[k-1+32*T];tu(M>>4,v,k)}function Ex(v,k){var T,M=4;for(T=0;8>T;++T)M+=v[k+T-32];tu(M>>3,v,k)}function nu(v,k){var T,M=4;for(T=0;8>T;++T)M+=v[k-1+32*T];tu(M>>3,v,k)}function yh(v,k){tu(128,v,k)}function gc(v,k,T){var M=v[k-T],V=v[k+0],Y=3*(V-M)+Mx[1020+v[k-2*T]-v[k+T]],J=xm[112+(Y+4>>3)];v[k-T]=Qr[255+M+xm[112+(Y+3>>3)]],v[k+0]=Qr[255+V-J]}function sm(v,k,T,M){var V=v[k+0],Y=v[k+T];return Ai[255+v[k-2*T]-v[k-T]]>M||Ai[255+Y-V]>M}function om(v,k,T,M){return 4*Ai[255+v[k-T]-v[k+0]]+Ai[255+v[k-2*T]-v[k+T]]<=M}function lm(v,k,T,M,V){var Y=v[k-3*T],J=v[k-2*T],Q=v[k-T],ee=v[k+0],re=v[k+T],ve=v[k+2*T],_e=v[k+3*T];return 4*Ai[255+Q-ee]+Ai[255+J-re]>M?0:Ai[255+v[k-4*T]-Y]<=V&&Ai[255+Y-J]<=V&&Ai[255+J-Q]<=V&&Ai[255+_e-ve]<=V&&Ai[255+ve-re]<=V&&Ai[255+re-ee]<=V}function um(v,k,T,M){var V=2*M+1;for(M=0;16>M;++M)om(v,k+M,T,V)&&gc(v,k+M,T)}function vs(v,k,T,M){var V=2*M+1;for(M=0;16>M;++M)om(v,k+M*T,1,V)&&gc(v,k+M*T,1)}function Zs(v,k,T,M){var V;for(V=3;0<V;--V)um(v,k+=4*T,T,M)}function Dx(v,k,T,M){var V;for(V=3;0<V;--V)vs(v,k+=4,T,M)}function qo(v,k,T,M,V,Y,J,Q){for(Y=2*Y+1;0<V--;){if(lm(v,k,T,Y,J))if(sm(v,k,T,Q))gc(v,k,T);else{var ee=v,re=k,ve=T,_e=ee[re-2*ve],je=ee[re-ve],Ne=ee[re+0],qe=ee[re+ve],Me=ee[re+2*ve],be=27*(ze=Mx[1020+3*(Ne-je)+Mx[1020+_e-qe]])+63>>7,we=18*ze+63>>7,ze=9*ze+63>>7;ee[re-3*ve]=Qr[255+ee[re-3*ve]+ze],ee[re-2*ve]=Qr[255+_e+we],ee[re-ve]=Qr[255+je+be],ee[re+0]=Qr[255+Ne-be],ee[re+ve]=Qr[255+qe-we],ee[re+2*ve]=Qr[255+Me-ze]}k+=M}}function Yi(v,k,T,M,V,Y,J,Q){for(Y=2*Y+1;0<V--;){if(lm(v,k,T,Y,J))if(sm(v,k,T,Q))gc(v,k,T);else{var ee=v,re=k,ve=T,_e=ee[re-ve],je=ee[re+0],Ne=ee[re+ve],qe=xm[112+((Me=3*(je-_e))+4>>3)],Me=xm[112+(Me+3>>3)],be=qe+1>>1;ee[re-2*ve]=Qr[255+ee[re-2*ve]+be],ee[re-ve]=Qr[255+_e+Me],ee[re+0]=Qr[255+je-qe],ee[re+ve]=Qr[255+Ne-be]}k+=M}}function wh(v,k,T,M,V,Y){qo(v,k,T,1,16,M,V,Y)}function au(v,k,T,M,V,Y){qo(v,k,1,T,16,M,V,Y)}function Tx(v,k,T,M,V,Y){var J;for(J=3;0<J;--J)Yi(v,k+=4*T,T,1,16,M,V,Y)}function vc(v,k,T,M,V,Y){var J;for(J=3;0<J;--J)Yi(v,k+=4,1,T,16,M,V,Y)}function Lx(v,k,T,M,V,Y,J,Q){qo(v,k,V,1,8,Y,J,Q),qo(T,M,V,1,8,Y,J,Q)}function Nh(v,k,T,M,V,Y,J,Q){qo(v,k,1,V,8,Y,J,Q),qo(T,M,1,V,8,Y,J,Q)}function kh(v,k,T,M,V,Y,J,Q){Yi(v,k+4*V,V,1,8,Y,J,Q),Yi(T,M+4*V,V,1,8,Y,J,Q)}function cm(v,k,T,M,V,Y,J,Q){Yi(v,k+4,1,V,8,Y,J,Q),Yi(T,M+4,1,V,8,Y,J,Q)}function xc(){this.ba=new $r,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new It,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Sh(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function _h(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function dm(){this.ua=0,this.Wa=new ne,this.vb=new ne,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new E}function Px(){this.xb=this.a=0,this.l=new dc,this.ca=new $r,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new dm,this.ab=0,this.gc=s(4,_h),this.Oc=0}function bc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new dc,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ru(v,k,T,M,V,Y,J){for(v=v==null?0:v[k+0],k=0;k<J;++k)V[Y+k]=v+T[M+k]&255,v=V[Y+k]}function jh(v,k,T,M,V,Y,J){var Q;if(v==null)ru(null,null,T,M,V,Y,J);else for(Q=0;Q<J;++Q)V[Y+Q]=v[k+Q]+T[M+Q]&255}function Wo(v,k,T,M,V,Y,J){if(v==null)ru(null,null,T,M,V,Y,J);else{var Q,ee=v[k+0],re=ee,ve=ee;for(Q=0;Q<J;++Q)re=ve+(ee=v[k+Q])-re,ve=T[M+Q]+(-256&re?0>re?0:255:re)&255,re=ee,V[Y+Q]=ve}}function Ch(v,k,T,M){var V=k.width,Y=k.o;if(t(v!=null&&k!=null),0>T||0>=M||T+M>Y)return null;if(!v.Cc){if(v.ga==null){var J;if(v.ga=new bc,(J=v.ga==null)||(J=k.width*k.o,t(v.Gb.length==0),v.Gb=i(J),v.Uc=0,v.Gb==null?J=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,J=1),J=!J),!J){J=v.ga;var Q=v.Fa,ee=v.P,re=v.qc,ve=v.mb,_e=v.nb,je=ee+1,Ne=re-1,qe=J.l;if(t(Q!=null&&ve!=null&&k!=null),Yo[0]=null,Yo[1]=ru,Yo[2]=jh,Yo[3]=Wo,J.ca=ve,J.tb=_e,J.c=k.width,J.i=k.height,t(0<J.c&&0<J.i),1>=re)k=0;else if(J.$a=Q[ee+0]>>0&3,J.Z=Q[ee+0]>>2&3,J.Lc=Q[ee+0]>>4&3,ee=Q[ee+0]>>6&3,0>J.$a||1<J.$a||4<=J.Z||1<J.Lc||ee)k=0;else if(qe.put=ki,qe.ac=pn,qe.bc=kr,qe.ma=J,qe.width=k.width,qe.height=k.height,qe.Da=k.Da,qe.v=k.v,qe.va=k.va,qe.j=k.j,qe.o=k.o,J.$a)e:{t(J.$a==1),k=Wt();t:for(;;){if(k==null){k=0;break e}if(t(J!=null),J.mc=k,k.c=J.c,k.i=J.i,k.l=J.l,k.l.ma=J,k.l.width=J.c,k.l.height=J.i,k.a=0,q(k.m,Q,je,Ne),!Zt(J.c,J.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&Kr(k.s)?(J.ic=1,Q=k.c*k.i,k.Ta=null,k.Ua=0,k.V=i(Q),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(J.ic=0,k=ma(k,J.c)),!k))break t;k=1;break e}J.mc=null,k=0}else k=Ne>=J.c*J.i;J=!k}if(J)return null;v.ga.Lc!=1?v.Ga=0:M=Y-T}t(v.ga!=null),t(T+M<=Y);e:{if(k=(Q=v.ga).c,Y=Q.l.o,Q.$a==0){if(je=v.rc,Ne=v.Vc,qe=v.Fa,ee=v.P+1+T*k,re=v.mb,ve=v.nb+T*k,t(ee<=v.P+v.qc),Q.Z!=0)for(t(Yo[Q.Z]!=null),J=0;J<M;++J)Yo[Q.Z](je,Ne,qe,ee,re,ve,k),je=re,Ne=ve,ve+=k,ee+=k;else for(J=0;J<M;++J)a(re,ve,qe,ee,k),je=re,Ne=ve,ve+=k,ee+=k;v.rc=je,v.Vc=Ne}else{if(t(Q.mc!=null),k=T+M,t((J=Q.mc)!=null),t(k<=J.i),J.C>=k)k=1;else if(Q.ic||Se(),Q.ic){Q=J.V,je=J.Ba,Ne=J.c;var Me=J.i,be=(qe=1,ee=J.$/Ne,re=J.$%Ne,ve=J.m,_e=J.s,J.$),we=Ne*Me,ze=Ne*k,$e=_e.wc,Ue=be<ze?Tn(_e,re,ee):null;t(be<=we),t(k<=Me),t(Kr(_e));t:for(;;){for(;!ve.h&&be<ze;){if(re&$e||(Ue=Tn(_e,re,ee)),t(Ue!=null),W(ve),256>(Me=pa(Ue.G[0],Ue.H[0],ve)))Q[je+be]=Me,++be,++re>=Ne&&(re=0,++ee<=k&&!(ee%16)&&Yr(J,ee));else{if(!(280>Me)){qe=0;break t}Me=Sr(Me-256,ve);var it,tt=pa(Ue.G[4],Ue.H[4],ve);if(W(ve),!(be>=(tt=_r(Ne,tt=Sr(tt,ve)))&&we-be>=Me)){qe=0;break t}for(it=0;it<Me;++it)Q[je+be+it]=Q[je+be+it-tt];for(be+=Me,re+=Me;re>=Ne;)re-=Ne,++ee<=k&&!(ee%16)&&Yr(J,ee);be<ze&&re&$e&&(Ue=Tn(_e,re,ee))}t(ve.h==$(ve))}Yr(J,ee>k?k:ee);break t}!qe||ve.h&&be<we?(qe=0,J.a=ve.h?5:3):J.$=be,k=qe}else k=Xr(J,J.V,J.Ba,J.c,J.i,k,Aa);if(!k){M=0;break e}}T+M>=Y&&(v.Cc=1),M=1}if(!M)return null;if(v.Cc&&((M=v.ga)!=null&&(M.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+T*V}function C(v,k,T,M,V,Y){for(;0<V--;){var J,Q=v,ee=k+(T?1:0),re=v,ve=k+(T?0:3);for(J=0;J<M;++J){var _e=re[ve+4*J];_e!=255&&(_e*=32897,Q[ee+4*J+0]=Q[ee+4*J+0]*_e>>23,Q[ee+4*J+1]=Q[ee+4*J+1]*_e>>23,Q[ee+4*J+2]=Q[ee+4*J+2]*_e>>23)}k+=Y}}function G(v,k,T,M,V){for(;0<M--;){var Y;for(Y=0;Y<T;++Y){var J=v[k+2*Y+0],Q=15&(re=v[k+2*Y+1]),ee=4369*Q,re=(240&re|re>>4)*ee>>16;v[k+2*Y+0]=(240&J|J>>4)*ee>>16&240|(15&J|J<<4)*ee>>16>>4&15,v[k+2*Y+1]=240&re|Q}k+=V}}function oe(v,k,T,M,V,Y,J,Q){var ee,re,ve=255;for(re=0;re<V;++re){for(ee=0;ee<M;++ee){var _e=v[k+ee];Y[J+4*ee]=_e,ve&=_e}k+=T,J+=Q}return ve!=255}function pe(v,k,T,M,V){var Y;for(Y=0;Y<V;++Y)T[M+Y]=v[k+Y]>>8}function Se(){Ci=C,Nn=G,kn=oe,Zn=pe}function Fe(v,k,T){A[v]=function(M,V,Y,J,Q,ee,re,ve,_e,je,Ne,qe,Me,be,we,ze,$e){var Ue,it=$e-1>>1,tt=Q[ee+0]|re[ve+0]<<16,bt=_e[je+0]|Ne[qe+0]<<16;t(M!=null);var nt=3*tt+bt+131074>>2;for(k(M[V+0],255&nt,nt>>16,Me,be),Y!=null&&(nt=3*bt+tt+131074>>2,k(Y[J+0],255&nt,nt>>16,we,ze)),Ue=1;Ue<=it;++Ue){var en=Q[ee+Ue]|re[ve+Ue]<<16,on=_e[je+Ue]|Ne[qe+Ue]<<16,Xt=tt+en+bt+on+524296,Ut=Xt+2*(en+bt)>>3;nt=Ut+tt>>1,tt=(Xt=Xt+2*(tt+on)>>3)+en>>1,k(M[V+2*Ue-1],255&nt,nt>>16,Me,be+(2*Ue-1)*T),k(M[V+2*Ue-0],255&tt,tt>>16,Me,be+(2*Ue-0)*T),Y!=null&&(nt=Xt+bt>>1,tt=Ut+on>>1,k(Y[J+2*Ue-1],255&nt,nt>>16,we,ze+(2*Ue-1)*T),k(Y[J+2*Ue+0],255&tt,tt>>16,we,ze+(2*Ue+0)*T)),tt=en,bt=on}1&$e||(nt=3*tt+bt+131074>>2,k(M[V+$e-1],255&nt,nt>>16,Me,be+($e-1)*T),Y!=null&&(nt=3*bt+tt+131074>>2,k(Y[J+$e-1],255&nt,nt>>16,we,ze+($e-1)*T)))}}function Ye(){Ei[bm]=zD,Ei[ym]=oN,Ei[nN]=UD,Ei[wm]=lN,Ei[Nm]=uN,Ei[Ox]=cN,Ei[aN]=qD,Ei[Ix]=oN,Ei[Fx]=lN,Ei[km]=uN,Ei[Bx]=cN}function rt(v){return v&~WD?0>v?0:255:v>>dN}function gt(v,k){return rt((19077*v>>8)+(26149*k>>8)-14234)}function Tt(v,k,T){return rt((19077*v>>8)-(6419*k>>8)-(13320*T>>8)+8708)}function At(v,k){return rt((19077*v>>8)+(33050*k>>8)-17685)}function Gt(v,k,T,M,V){M[V+0]=gt(v,T),M[V+1]=Tt(v,k,T),M[V+2]=At(v,k)}function Fn(v,k,T,M,V){M[V+0]=At(v,k),M[V+1]=Tt(v,k,T),M[V+2]=gt(v,T)}function Wn(v,k,T,M,V){var Y=Tt(v,k,T);k=Y<<3&224|At(v,k)>>3,M[V+0]=248&gt(v,T)|Y>>5,M[V+1]=k}function la(v,k,T,M,V){var Y=240&At(v,k)|15;M[V+0]=240&gt(v,T)|Tt(v,k,T)>>4,M[V+1]=Y}function Qa(v,k,T,M,V){M[V+0]=255,Gt(v,k,T,M,V+1)}function Ea(v,k,T,M,V){Fn(v,k,T,M,V),M[V+3]=255}function Xi(v,k,T,M,V){Gt(v,k,T,M,V),M[V+3]=255}function Jr(v,k){return 0>v?0:v>k?k:v}function xs(v,k,T){A[v]=function(M,V,Y,J,Q,ee,re,ve,_e){for(var je=ve+(-2&_e)*T;ve!=je;)k(M[V+0],Y[J+0],Q[ee+0],re,ve),k(M[V+1],Y[J+0],Q[ee+0],re,ve+T),V+=2,++J,++ee,ve+=2*T;1&_e&&k(M[V+0],Y[J+0],Q[ee+0],re,ve)}}function hm(v,k,T){return T==0?v==0?k==0?6:5:k==0?4:0:T}function Ah(v,k,T,M,V){switch(v>>>30){case 3:no(k,T,M,V,0);break;case 2:Qn(k,T,M,V);break;case 1:mr(k,T,M,V)}}function Eh(v,k){var T,M,V=k.M,Y=k.Nb,J=v.oc,Q=v.pc+40,ee=v.oc,re=v.pc+584,ve=v.oc,_e=v.pc+600;for(T=0;16>T;++T)J[Q+32*T-1]=129;for(T=0;8>T;++T)ee[re+32*T-1]=129,ve[_e+32*T-1]=129;for(0<V?J[Q-1-32]=ee[re-1-32]=ve[_e-1-32]=129:(r(J,Q-32-1,127,21),r(ee,re-32-1,127,9),r(ve,_e-32-1,127,9)),M=0;M<v.za;++M){var je=k.ya[k.aa+M];if(0<M){for(T=-1;16>T;++T)a(J,Q+32*T-4,J,Q+32*T+12,4);for(T=-1;8>T;++T)a(ee,re+32*T-4,ee,re+32*T+4,4),a(ve,_e+32*T-4,ve,_e+32*T+4,4)}var Ne=v.Gd,qe=v.Hd+M,Me=je.ad,be=je.Hc;if(0<V&&(a(J,Q-32,Ne[qe].y,0,16),a(ee,re-32,Ne[qe].f,0,8),a(ve,_e-32,Ne[qe].ea,0,8)),je.Za){var we=J,ze=Q-32+16;for(0<V&&(M>=v.za-1?r(we,ze,Ne[qe].y[15],4):a(we,ze,Ne[qe+1].y,0,4)),T=0;4>T;T++)we[ze+128+T]=we[ze+256+T]=we[ze+384+T]=we[ze+0+T];for(T=0;16>T;++T,be<<=2)we=J,ze=Q+fN[T],Ji[je.Ob[T]](we,ze),Ah(be,Me,16*+T,we,ze)}else if(we=hm(M,V,je.Ob[0]),Ko[we](J,Q),be!=0)for(T=0;16>T;++T,be<<=2)Ah(be,Me,16*+T,J,Q+fN[T]);for(T=je.Gc,we=hm(M,V,je.Dd),ro[we](ee,re),ro[we](ve,_e),be=Me,we=ee,ze=re,255&(je=T>>0)&&(170&je?Rh(be,256,we,ze):_i(be,256,we,ze)),je=ve,be=_e,255&(T>>=8)&&(170&T?Rh(Me,320,je,be):_i(Me,320,je,be)),V<v.Ub-1&&(a(Ne[qe].y,0,J,Q+480,16),a(Ne[qe].f,0,ee,re+224,8),a(Ne[qe].ea,0,ve,_e+224,8)),T=8*Y*v.B,Ne=v.sa,qe=v.ta+16*M+16*Y*v.R,Me=v.qa,je=v.ra+8*M+T,be=v.Ha,we=v.Ia+8*M+T,T=0;16>T;++T)a(Ne,qe+T*v.R,J,Q+32*T,16);for(T=0;8>T;++T)a(Me,je+T*v.B,ee,re+32*T,8),a(be,we+T*v.B,ve,_e+32*T,8)}}function yc(v,k,T,M,V,Y,J,Q,ee){var re=[0],ve=[0],_e=0,je=ee!=null?ee.kd:0,Ne=ee??new Sh;if(v==null||12>T)return 7;Ne.data=v,Ne.w=k,Ne.ha=T,k=[k],T=[T],Ne.gb=[Ne.gb];e:{var qe=k,Me=T,be=Ne.gb;if(t(v!=null),t(Me!=null),t(be!=null),be[0]=0,12<=Me[0]&&!n(v,qe[0],"RIFF")){if(n(v,qe[0]+8,"WEBP")){be=3;break e}var we=Te(v,qe[0]+4);if(12>we||4294967286<we){be=3;break e}if(je&&we>Me[0]-8){be=7;break e}be[0]=we,qe[0]+=12,Me[0]-=12}be=0}if(be!=0)return be;for(we=0<Ne.gb[0],T=T[0];;){e:{var ze=v;Me=k,be=T;var $e=re,Ue=ve,it=qe=[0];if((nt=_e=[_e])[0]=0,8>be[0])be=7;else{if(!n(ze,Me[0],"VP8X")){if(Te(ze,Me[0]+4)!=10){be=3;break e}if(18>be[0]){be=7;break e}var tt=Te(ze,Me[0]+8),bt=1+Ee(ze,Me[0]+12);if(2147483648<=bt*(ze=1+Ee(ze,Me[0]+15))){be=3;break e}it!=null&&(it[0]=tt),$e!=null&&($e[0]=bt),Ue!=null&&(Ue[0]=ze),Me[0]+=18,be[0]-=18,nt[0]=1}be=0}}if(_e=_e[0],qe=qe[0],be!=0)return be;if(Me=!!(2&qe),!we&&_e)return 3;if(Y!=null&&(Y[0]=!!(16&qe)),J!=null&&(J[0]=Me),Q!=null&&(Q[0]=0),J=re[0],qe=ve[0],_e&&Me&&ee==null){be=0;break}if(4>T){be=7;break}if(we&&_e||!we&&!_e&&!n(v,k[0],"ALPH")){T=[T],Ne.na=[Ne.na],Ne.P=[Ne.P],Ne.Sa=[Ne.Sa];e:{tt=v,be=k,we=T;var nt=Ne.gb;$e=Ne.na,Ue=Ne.P,it=Ne.Sa,bt=22,t(tt!=null),t(we!=null),ze=be[0];var en=we[0];for(t($e!=null),t(it!=null),$e[0]=null,Ue[0]=null,it[0]=0;;){if(be[0]=ze,we[0]=en,8>en){be=7;break e}var on=Te(tt,ze+4);if(4294967286<on){be=3;break e}var Xt=8+on+1&-2;if(bt+=Xt,0<nt&&bt>nt){be=3;break e}if(!n(tt,ze,"VP8 ")||!n(tt,ze,"VP8L")){be=0;break e}if(en[0]<Xt){be=7;break e}n(tt,ze,"ALPH")||($e[0]=tt,Ue[0]=ze+8,it[0]=on),ze+=Xt,en-=Xt}}if(T=T[0],Ne.na=Ne.na[0],Ne.P=Ne.P[0],Ne.Sa=Ne.Sa[0],be!=0)break}T=[T],Ne.Ja=[Ne.Ja],Ne.xa=[Ne.xa];e:if(nt=v,be=k,we=T,$e=Ne.gb[0],Ue=Ne.Ja,it=Ne.xa,tt=be[0],ze=!n(nt,tt,"VP8 "),bt=!n(nt,tt,"VP8L"),t(nt!=null),t(we!=null),t(Ue!=null),t(it!=null),8>we[0])be=7;else{if(ze||bt){if(nt=Te(nt,tt+4),12<=$e&&nt>$e-12){be=3;break e}if(je&&nt>we[0]-8){be=7;break e}Ue[0]=nt,be[0]+=8,we[0]-=8,it[0]=bt}else it[0]=5<=we[0]&&nt[tt+0]==47&&!(nt[tt+4]>>5),Ue[0]=we[0];be=0}if(T=T[0],Ne.Ja=Ne.Ja[0],Ne.xa=Ne.xa[0],k=k[0],be!=0)break;if(4294967286<Ne.Ja)return 3;if(Q==null||Me||(Q[0]=Ne.xa?2:1),J=[J],qe=[qe],Ne.xa){if(5>T){be=7;break}Q=J,je=qe,Me=Y,v==null||5>T?v=0:5<=T&&v[k+0]==47&&!(v[k+4]>>5)?(we=[0],nt=[0],$e=[0],q(Ue=new R,v,k,T),vt(Ue,we,nt,$e)?(Q!=null&&(Q[0]=we[0]),je!=null&&(je[0]=nt[0]),Me!=null&&(Me[0]=$e[0]),v=1):v=0):v=0}else{if(10>T){be=7;break}Q=qe,v==null||10>T||!Xp(v,k+3,T-3)?v=0:(je=v[k+0]|v[k+1]<<8|v[k+2]<<16,Me=16383&(v[k+7]<<8|v[k+6]),v=16383&(v[k+9]<<8|v[k+8]),1&je||3<(je>>1&7)||!(je>>4&1)||je>>5>=Ne.Ja||!Me||!v?v=0:(J&&(J[0]=Me),Q&&(Q[0]=v),v=1))}if(!v||(J=J[0],qe=qe[0],_e&&(re[0]!=J||ve[0]!=qe)))return 3;ee!=null&&(ee[0]=Ne,ee.offset=k-ee.w,t(4294967286>k-ee.w),t(ee.offset==ee.ha-T));break}return be==0||be==7&&_e&&ee==null?(Y!=null&&(Y[0]|=Ne.na!=null&&0<Ne.na.length),M!=null&&(M[0]=J),V!=null&&(V[0]=qe),0):be}function Dh(v,k,T){var M=k.width,V=k.height,Y=0,J=0,Q=M,ee=V;if(k.Da=v!=null&&0<v.Da,k.Da&&(Q=v.cd,ee=v.bd,Y=v.v,J=v.j,11>T||(Y&=-2,J&=-2),0>Y||0>J||0>=Q||0>=ee||Y+Q>M||J+ee>V))return 0;if(k.v=Y,k.j=J,k.va=Y+Q,k.o=J+ee,k.U=Q,k.T=ee,k.da=v!=null&&0<v.da,k.da){if(!De(Q,ee,T=[v.ib],Y=[v.hb]))return 0;k.ib=T[0],k.hb=Y[0]}return k.ob=v!=null&&v.ob,k.Kb=v==null||!v.Sd,k.da&&(k.ob=k.ib<3*M/4&&k.hb<3*V/4,k.Kb=0),1}function Th(v){if(v==null)return 2;if(11>v.S){var k=v.f.RGBA;k.fb+=(v.height-1)*k.A,k.A=-k.A}else k=v.f.kb,v=v.height,k.O+=(v-1)*k.fa,k.fa=-k.fa,k.N+=(v-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(v-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(v-1)*k.lb,k.lb=-k.lb);return 0}function wc(v,k,T,M){if(M==null||0>=v||0>=k)return 2;if(T!=null){if(T.Da){var V=T.cd,Y=T.bd,J=-2&T.v,Q=-2&T.j;if(0>J||0>Q||0>=V||0>=Y||J+V>v||Q+Y>k)return 2;v=V,k=Y}if(T.da){if(!De(v,k,V=[T.ib],Y=[T.hb]))return 2;v=V[0],k=Y[0]}}M.width=v,M.height=k;e:{var ee=M.width,re=M.height;if(v=M.S,0>=ee||0>=re||!(v>=bm&&13>v))v=2;else{if(0>=M.Rd&&M.sd==null){J=Y=V=k=0;var ve=(Q=ee*pN[v])*re;if(11>v||(Y=(re+1)/2*(k=(ee+1)/2),v==12&&(J=(V=ee)*re)),(re=i(ve+2*Y+J))==null){v=1;break e}M.sd=re,11>v?((ee=M.f.RGBA).eb=re,ee.fb=0,ee.A=Q,ee.size=ve):((ee=M.f.kb).y=re,ee.O=0,ee.fa=Q,ee.Fd=ve,ee.f=re,ee.N=0+ve,ee.Ab=k,ee.Cd=Y,ee.ea=re,ee.W=0+ve+Y,ee.Db=k,ee.Ed=Y,v==12&&(ee.F=re,ee.J=0+ve+2*Y),ee.Tc=J,ee.lb=V)}if(k=1,V=M.S,Y=M.width,J=M.height,V>=bm&&13>V)if(11>V)v=M.f.RGBA,k&=(Q=Math.abs(v.A))*(J-1)+Y<=v.size,k&=Q>=Y*pN[V],k&=v.eb!=null;else{v=M.f.kb,Q=(Y+1)/2,ve=(J+1)/2,ee=Math.abs(v.fa),re=Math.abs(v.Ab);var _e=Math.abs(v.Db),je=Math.abs(v.lb),Ne=je*(J-1)+Y;k&=ee*(J-1)+Y<=v.Fd,k&=re*(ve-1)+Q<=v.Cd,k=(k&=_e*(ve-1)+Q<=v.Ed)&ee>=Y&re>=Q&_e>=Q,k&=v.y!=null,k&=v.f!=null,k&=v.ea!=null,V==12&&(k&=je>=Y,k&=Ne<=v.Tc,k&=v.F!=null)}else k=0;v=k?0:2}}return v!=0||T!=null&&T.fd&&(v=Th(M)),v}var qa=64,Nc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],kc=24,Sc=32,Lh=8,Ar=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];xe("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(v){return v},A.Predictor2=function(v,k,T){return k[T+0]},A.Predictor3=function(v,k,T){return k[T+1]},A.Predictor4=function(v,k,T){return k[T-1]},A.Predictor5=function(v,k,T){return Ce(Ce(v,k[T+1]),k[T+0])},A.Predictor6=function(v,k,T){return Ce(v,k[T-1])},A.Predictor7=function(v,k,T){return Ce(v,k[T+0])},A.Predictor8=function(v,k,T){return Ce(k[T-1],k[T+0])},A.Predictor9=function(v,k,T){return Ce(k[T+0],k[T+1])},A.Predictor10=function(v,k,T){return Ce(Ce(v,k[T-1]),Ce(k[T+0],k[T+1]))},A.Predictor11=function(v,k,T){var M=k[T+0];return 0>=Ze(M>>24&255,v>>24&255,(k=k[T-1])>>24&255)+Ze(M>>16&255,v>>16&255,k>>16&255)+Ze(M>>8&255,v>>8&255,k>>8&255)+Ze(255&M,255&v,255&k)?M:v},A.Predictor12=function(v,k,T){var M=k[T+0];return(He((v>>24&255)+(M>>24&255)-((k=k[T-1])>>24&255))<<24|He((v>>16&255)+(M>>16&255)-(k>>16&255))<<16|He((v>>8&255)+(M>>8&255)-(k>>8&255))<<8|He((255&v)+(255&M)-(255&k)))>>>0},A.Predictor13=function(v,k,T){var M=k[T-1];return(Qe((v=Ce(v,k[T+0]))>>24&255,M>>24&255)<<24|Qe(v>>16&255,M>>16&255)<<16|Qe(v>>8&255,M>>8&255)<<8|Qe(v>>0&255,M>>0&255))>>>0};var Rx=A.PredictorAdd0;A.PredictorAdd1=Je,xe("Predictor2","PredictorAdd2"),xe("Predictor3","PredictorAdd3"),xe("Predictor4","PredictorAdd4"),xe("Predictor5","PredictorAdd5"),xe("Predictor6","PredictorAdd6"),xe("Predictor7","PredictorAdd7"),xe("Predictor8","PredictorAdd8"),xe("Predictor9","PredictorAdd9"),xe("Predictor10","PredictorAdd10"),xe("Predictor11","PredictorAdd11"),xe("Predictor12","PredictorAdd12"),xe("Predictor13","PredictorAdd13");var Ph=A.PredictorAdd2;et("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),et("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var fm,Si=A.ColorIndexInverseTransform,_c=A.MapARGB,pm=A.VP8LColorIndexInverseTransformAlpha,mm=A.MapAlpha,Ho=A.VP8LPredictorsAdd=[];Ho.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var iu,Er,pr,Vo,eo,to,jc,no,Qn,Rh,mr,_i,Cc,gm,Mh,su,ou,Go,lu,Ac,uu,$o,Oh,ji,Ci,Nn,kn,Zn,ga=i(511),ao=i(2041),Ih=i(225),Ec=i(767),vm=0,Mx=ao,xm=Ih,Qr=Ec,Ai=ga,bm=0,ym=1,nN=2,wm=3,Nm=4,Ox=5,aN=6,Ix=7,Fx=8,km=9,Bx=10,jD=[2,3,7],CD=[3,3,11],rN=[280,256,256,256,40],AD=[0,1,1,1,0],ED=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],DD=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],TD=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],LD=8,zx=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ux=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Fh=null,PD=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],RD=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],iN=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],MD=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],OD=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ID=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],FD=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ko=[],Ji=[],ro=[],BD=1,sN=2,Yo=[],Ei=[];Fe("UpsampleRgbLinePair",Gt,3),Fe("UpsampleBgrLinePair",Fn,3),Fe("UpsampleRgbaLinePair",Xi,4),Fe("UpsampleBgraLinePair",Ea,4),Fe("UpsampleArgbLinePair",Qa,4),Fe("UpsampleRgba4444LinePair",la,2),Fe("UpsampleRgb565LinePair",Wn,2);var zD=A.UpsampleRgbLinePair,UD=A.UpsampleBgrLinePair,oN=A.UpsampleRgbaLinePair,lN=A.UpsampleBgraLinePair,uN=A.UpsampleArgbLinePair,cN=A.UpsampleRgba4444LinePair,qD=A.UpsampleRgb565LinePair,Sm=16,_m=1<<Sm-1,Bh=-227,qx=482,dN=6,WD=(256<<dN)-1,hN=0,HD=i(256),VD=i(256),GD=i(256),$D=i(256),KD=i(qx-Bh),YD=i(qx-Bh);xs("YuvToRgbRow",Gt,3),xs("YuvToBgrRow",Fn,3),xs("YuvToRgbaRow",Xi,4),xs("YuvToBgraRow",Ea,4),xs("YuvToArgbRow",Qa,4),xs("YuvToRgba4444Row",la,2),xs("YuvToRgb565Row",Wn,2);var fN=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],jm=[0,2,8],XD=[8,7,6,4,4,2,2,2,1,1,1,1],JD=1;this.WebPDecodeRGBA=function(v,k,T,M,V){var Y=ym,J=new xc,Q=new $r;J.ba=Q,Q.S=Y,Q.width=[Q.width],Q.height=[Q.height];var ee=Q.width,re=Q.height,ve=new Ni;if(ve==null||v==null)var _e=2;else t(ve!=null),_e=yc(v,k,T,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(_e!=0?ee=0:(ee!=null&&(ee[0]=ve.width[0]),re!=null&&(re[0]=ve.height[0]),ee=1),ee){Q.width=Q.width[0],Q.height=Q.height[0],M!=null&&(M[0]=Q.width),V!=null&&(V[0]=Q.height);e:{if(M=new dc,(V=new Sh).data=v,V.w=k,V.ha=T,V.kd=1,k=[0],t(V!=null),((v=yc(V.data,V.w,V.ha,null,null,null,k,null,V))==0||v==7)&&k[0]&&(v=4),(k=v)==0){if(t(J!=null),M.data=V.data,M.w=V.w+V.offset,M.ha=V.ha-V.offset,M.put=ki,M.ac=pn,M.bc=kr,M.ma=J,V.xa){if((v=Wt())==null){J=1;break e}if(function(je,Ne){var qe=[0],Me=[0],be=[0];t:for(;;){if(je==null)return 0;if(Ne==null)return je.a=2,0;if(je.l=Ne,je.a=0,q(je.m,Ne.data,Ne.w,Ne.ha),!vt(je.m,qe,Me,be)){je.a=3;break t}if(je.xb=sN,Ne.width=qe[0],Ne.height=Me[0],!Zt(qe[0],Me[0],1,je,null))break t;return 1}return t(je.a!=0),0}(v,M)){if(M=(k=wc(M.width,M.height,J.Oa,J.ba))==0){t:{M=v;n:for(;;){if(M==null){M=0;break t}if(t(M.s.yc!=null),t(M.s.Ya!=null),t(0<M.s.Wb),t((T=M.l)!=null),t((V=T.ma)!=null),M.xb!=0){if(M.ca=V.ba,M.tb=V.tb,t(M.ca!=null),!Dh(V.Oa,T,wm)){M.a=2;break n}if(!ma(M,T.width)||T.da)break n;if((T.da||Vt(M.ca.S))&&Se(),11>M.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),M.ca.f.kb.F!=null&&Se()),M.Pb&&0<M.s.ua&&M.s.vb.X==null&&!fe(M.s.vb,M.s.Wa.Xa)){M.a=1;break n}M.xb=0}if(!Xr(M,M.V,M.Ba,M.c,M.i,T.o,Fo))break n;V.Dc=M.Ma,M=1;break t}t(M.a!=0),M=0}M=!M}M&&(k=v.a)}else k=v.a}else{if((v=new mx)==null){J=1;break e}if(v.Fa=V.na,v.P=V.P,v.qc=V.Sa,Jp(v,M)){if((k=wc(M.width,M.height,J.Oa,J.ba))==0){if(v.Aa=0,T=J.Oa,t((V=v)!=null),T!=null){if(0<(ee=0>(ee=T.Md)?0:100<ee?255:255*ee/100)){for(re=ve=0;4>re;++re)12>(_e=V.pb[re]).lc&&(_e.ia=ee*XD[0>_e.lc?0:_e.lc]>>3),ve|=_e.ia;ve&&(alert("todo:VP8InitRandom"),V.ia=1)}V.Ga=T.Id,100<V.Ga?V.Ga=100:0>V.Ga&&(V.Ga=0)}gx(v,M)||(k=v.a)}}else k=v.a}k==0&&J.Oa!=null&&J.Oa.fd&&(k=Th(J.ba))}J=k}Y=J!=0?null:11>Y?Q.f.RGBA.eb:Q.f.kb.y}else Y=null;return Y};var pN=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(A,L){for(var P="",j=0;j<4;j++)P+=String.fromCharCode(A[L++]);return P}function d(A,L){return(A[L+0]<<0|A[L+1]<<8|A[L+2]<<16)>>>0}function h(A,L){return(A[L+0]<<0|A[L+1]<<8|A[L+2]<<16|A[L+3]<<24)>>>0}new u;var p=[0],f=[0],g=[],b=new u,w=e,m=function(A,L){var P={},j=0,E=!1,F=0,z=0;if(P.frames=[],!function(H,$,X,W){for(var ie=0;ie<W;ie++)if(H[$+ie]!=X.charCodeAt(ie))return!0;return!1}(A,L,"RIFF",4)){var U,O;for(h(A,L+=4),L+=8;L<A.length;){var B=c(A,L),q=h(A,L+=4);L+=4;var I=q+(1&q);switch(B){case"VP8 ":case"VP8L":P.frames[j]===void 0&&(P.frames[j]={}),(R=P.frames[j]).src_off=E?z:L-8,R.src_size=F+q+8,j++,E&&(E=!1,F=0,z=0);break;case"VP8X":(R=P.header={}).feature_flags=A[L];var K=L+4;R.canvas_width=1+d(A,K),K+=3,R.canvas_height=1+d(A,K),K+=3;break;case"ALPH":E=!0,F=I+8,z=L-8;break;case"ANIM":(R=P.header).bgcolor=h(A,L),K=L+4,R.loop_count=(U=A)[(O=K)+0]<<0|U[O+1]<<8,K+=2;break;case"ANMF":var Z,R;(R=P.frames[j]={}).offset_x=2*d(A,L),L+=3,R.offset_y=2*d(A,L),L+=3,R.width=1+d(A,L),L+=3,R.height=1+d(A,L),L+=3,R.duration=d(A,L),L+=3,Z=A[L++],R.dispose=1&Z,R.blend=Z>>1&1}B!="ANMF"&&(L+=I)}return P}}(w,0);m.response=w,m.rgbaoutput=!0,m.dataurl=!1;var x=m.header?m.header:null,y=m.frames?m.frames:null;if(x){x.loop_counter=x.loop_count,p=[x.canvas_height],f=[x.canvas_width];for(var N=0;N<y.length&&y[N].blend!=0;N++);}var S=y[0],D=b.WebPDecodeRGBA(w,S.src_off,S.src_size,f,p);S.rgba=D,S.imgwidth=f[0],S.imgheight=p[0];for(var _=0;_<f[0]*p[0]*4;_++)g[_]=D[_];return this.width=f,this.height=p,this.data=g,this}(function(e){var t=function(){return typeof v2=="function"},n=function(p,f,g,b){var w=4,m=s;switch(b){case e.image_compression.FAST:w=1,m=i;break;case e.image_compression.MEDIUM:w=6,m=o;break;case e.image_compression.SLOW:w=9,m=u}p=a(p,f,g,m);var x=v2(p,{level:w});return e.__addimage__.arrayBufferToBinaryString(x)},a=function(p,f,g,b){for(var w,m,x,y=p.length/f,N=new Uint8Array(p.length+y),S=d(),D=0;D<y;D+=1){if(x=D*f,w=p.subarray(x,x+f),b)N.set(b(w,g,m),x+D);else{for(var _,A=S.length,L=[];_<A;_+=1)L[_]=S[_](w,g,m);var P=h(L.concat());N.set(L[P],x+D)}m=w}return N},r=function(p){var f=Array.apply([],p);return f.unshift(0),f},i=function(p,f){var g,b=[],w=p.length;b[0]=1;for(var m=0;m<w;m+=1)g=p[m-f]||0,b[m+1]=p[m]-g+256&255;return b},s=function(p,f,g){var b,w=[],m=p.length;w[0]=2;for(var x=0;x<m;x+=1)b=g&&g[x]||0,w[x+1]=p[x]-b+256&255;return w},o=function(p,f,g){var b,w,m=[],x=p.length;m[0]=3;for(var y=0;y<x;y+=1)b=p[y-f]||0,w=g&&g[y]||0,m[y+1]=p[y]+256-(b+w>>>1)&255;return m},u=function(p,f,g){var b,w,m,x,y=[],N=p.length;y[0]=4;for(var S=0;S<N;S+=1)b=p[S-f]||0,w=g&&g[S]||0,m=g&&g[S-f]||0,x=c(b,w,m),y[S+1]=p[S]-x+256&255;return y},c=function(p,f,g){if(p===f&&f===g)return p;var b=Math.abs(f-g),w=Math.abs(p-g),m=Math.abs(p+f-g-g);return b<=w&&b<=m?p:w<=m?f:g},d=function(){return[r,i,s,o,u]},h=function(p){var f=p.map(function(g){return g.reduce(function(b,w){return b+Math.abs(w)},0)});return f.indexOf(Math.min.apply(null,f))};e.processPNG=function(p,f,g,b){var w,m,x,y,N,S,D,_,A,L,P,j,E,F,z,U=this.decode.FLATE_DECODE,O="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(x=new JG(p)).imgData,m=x.bits,w=x.colorSpace,N=x.colors,[4,6].indexOf(x.colorType)!==-1){if(x.bits===8){A=(_=x.pixelBitlength==32?new Uint32Array(x.decodePixels().buffer):x.pixelBitlength==16?new Uint16Array(x.decodePixels().buffer):new Uint8Array(x.decodePixels().buffer)).length,P=new Uint8Array(A*x.colors),L=new Uint8Array(A);var B,q=x.pixelBitlength-x.bits;for(F=0,z=0;F<A;F++){for(E=_[F],B=0;B<q;)P[z++]=E>>>B&255,B+=x.bits;L[F]=E>>>B&255}}if(x.bits===16){A=(_=new Uint32Array(x.decodePixels().buffer)).length,P=new Uint8Array(A*(32/x.pixelBitlength)*x.colors),L=new Uint8Array(A*(32/x.pixelBitlength)),j=x.colors>1,F=0,z=0;for(var I=0;F<A;)E=_[F++],P[z++]=E>>>0&255,j&&(P[z++]=E>>>16&255,E=_[F++],P[z++]=E>>>0&255),L[I++]=E>>>16&255;m=8}b!==e.image_compression.NONE&&t()?(p=n(P,x.width*x.colors,x.colors,b),D=n(L,x.width,1,b)):(p=P,D=L,U=void 0)}if(x.colorType===3&&(w=this.color_spaces.INDEXED,S=x.palette,x.transparency.indexed)){var K=x.transparency.indexed,Z=0;for(F=0,A=K.length;F<A;++F)Z+=K[F];if((Z/=255)===A-1&&K.indexOf(0)!==-1)y=[K.indexOf(0)];else if(Z!==A){for(_=x.decodePixels(),L=new Uint8Array(_.length),F=0,A=_.length;F<A;F++)L[F]=K[_[F]];D=n(L,x.width,1)}}var R=function(H){var $;switch(H){case e.image_compression.FAST:$=11;break;case e.image_compression.MEDIUM:$=13;break;case e.image_compression.SLOW:$=14;break;default:$=12}return $}(b);return U===this.decode.FLATE_DECODE&&(O="/Predictor "+R+" "),O+="/Colors "+N+" /BitsPerComponent "+m+" /Columns "+x.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(D&&this.__addimage__.isArrayBuffer(D)||this.__addimage__.isArrayBufferView(D))&&(D=this.__addimage__.arrayBufferToBinaryString(D)),{alias:g,data:p,index:f,filter:U,decodeParameters:O,transparency:y,palette:S,sMask:D,predictor:R,width:x.width,height:x.height,bitsPerComponent:m,colorSpace:w}}}})(yt.API),function(e){e.processGIF89A=function(t,n,a,r){var i=new QG(t),s=i.width,o=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var c={data:u,width:s,height:o},d=new N1(100).encode(c,100);return e.processJPEG.call(this,d,n,a,r)},e.processGIF87A=e.processGIF89A}(yt.API),ts.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:r,green:a,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ts.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){yn.log("bit decode error:"+n)}},ts.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,r=0;r<t;r++)for(var i=this.datav.getUint8(this.pos++,!0),s=a*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var u=this.palette[i>>7-o&1];this.data[s+4*o]=u.blue,this.data[s+4*o+1]=u.green,this.data[s+4*o+2]=u.red,this.data[s+4*o+3]=255}n!==0&&(this.pos+=4-n)}},ts.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,r=0;r<e;r++){var i=this.datav.getUint8(this.pos++,!0),s=a*this.width*4+2*r*4,o=i>>4,u=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*r+1>=this.width)break;c=this.palette[u],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},ts.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var r=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*a;if(r<this.palette.length){var s=this.palette[r];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},ts.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,u=(i>>10&t)/t*255|0,c=i>>15?255:0,d=a*this.width*4+4*r;this.data[d]=u,this.data[d+1]=o,this.data[d+2]=s,this.data[d+3]=c}this.pos+=e}},ts.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var r=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,u=(s>>5&n)/n*255|0,c=(s>>11)/t*255|0,d=r*this.width*4+4*i;this.data[d]=c,this.data[d+1]=u,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},ts.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;this.data[s]=i,this.data[s+1]=r,this.data[s+2]=a,this.data[s+3]=255}this.pos+=this.width%4}},ts.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=i,this.data[o+1]=r,this.data[o+2]=a,this.data[o+3]=s}},ts.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,a,r){var i=new ts(t,!1),s=i.width,o=i.height,u={data:i.getData(),width:s,height:o},c=new N1(100).encode(u,100);return e.processJPEG.call(this,c,n,a,r)}}(yt.API),aS.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,a,r){var i=new aS(t),s=i.width,o=i.height,u={data:i.getData(),width:s,height:o},c=new N1(100).encode(u,100);return e.processJPEG.call(this,c,n,a,r)}}(yt.API),yt.API.processRGBA=function(e,t,n){for(var a=e.data,r=a.length,i=new Uint8Array(r/4*3),s=new Uint8Array(r/4),o=0,u=0,c=0;c<r;c+=4){var d=a[c],h=a[c+1],p=a[c+2],f=a[c+3];i[o++]=d,i[o++]=h,i[o++]=p,s[u++]=f}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:g,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},yt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wc=yt.API,wg=Wc.getCharWidthsArray=function(e,t){var n,a,r=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:r.metadata.Unicode.widths,u=o.fof?o.fof:1,c=t.kerning?t.kerning:r.metadata.Unicode.kerning,d=c.fof?c.fof:1,h=t.doKerning!==!1,p=0,f=e.length,g=0,b=o[0]||u,w=[];for(n=0;n<f;n++)a=e.charCodeAt(n),typeof r.metadata.widthOfString=="function"?w.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(a))+s*(1e3/i)||0)/1e3):(p=h&&hn(c[a])==="object"&&!isNaN(parseInt(c[a][g],10))?c[a][g]/d:0,w.push((o[a]||b)/u+p)),g=a;return w},Zk=Wc.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),r=t.charSpace||this.internal.getCharSpace();return Wc.processArabic&&(e=Wc.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,n,r)/n:wg.apply(this,arguments).reduce(function(i,s){return i+s},0)},eS=function(e,t,n,a){for(var r=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<n;)o+=t[i],i++;r.push(e.slice(0,i));var u=i;for(o=0;i!==s;)o+t[i]>a&&(r.push(e.slice(u,i)),o=0,u=i),o+=t[i],i++;return u!==i&&r.push(e.slice(u,i)),r},tS=function(e,t,n){n||(n={});var a,r,i,s,o,u,c,d=[],h=[d],p=n.textIndent||0,f=0,g=0,b=e.split(" "),w=wg.apply(this,[" ",n])[0];if(u=n.lineIndent===-1?b[0].length+2:n.lineIndent||0){var m=Array(u).join(" "),x=[];b.map(function(N){(N=N.split(/\s*\n/)).length>1?x=x.concat(N.map(function(S,D){return(D&&S.length?`
`:"")+S})):x.push(N[0])}),b=x,u=Zk.apply(this,[m,n])}for(i=0,s=b.length;i<s;i++){var y=0;if(a=b[i],u&&a[0]==`
`&&(a=a.substr(1),y=1),p+f+(g=(r=wg.apply(this,[a,n])).reduce(function(N,S){return N+S},0))>t||y){if(g>t){for(o=eS.apply(this,[a,r,t-(p+f),t]),d.push(o.shift()),d=[o.pop()];o.length;)h.push([o.shift()]);g=r.slice(a.length-(d[0]?d[0].length:0)).reduce(function(N,S){return N+S},0)}else d=[a];h.push(d),p=g+u,f=w}else d.push(a),p+=f+g,f=w}return c=u?function(N,S){return(S?m:"")+N.join(" ")}:function(N){return N.join(" ")},h.map(c)},Wc.splitTextToSize=function(e,t,n){var a,r=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var h=this.internal.getFont(d.fontName,d.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/r;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,i.lineIndent=n.lineIndent;var o,u,c=[];for(o=0,u=a.length;o<u;o++)c=c.concat(tS.apply(this,[a[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},a={},r=0;r<t.length;r++)n[t[r]]="0123456789abcdef"[r],a["0123456789abcdef"[r]]=t[r];var i=function(h){return"0x"+parseInt(h,10).toString(16)},s=e.__fontmetrics__.compress=function(h){var p,f,g,b,w=["{"];for(var m in h){if(p=h[m],isNaN(parseInt(m,10))?f="'"+m+"'":(m=parseInt(m,10),f=(f=i(m).slice(2)).slice(0,-1)+a[f.slice(-1)]),typeof p=="number")p<0?(g=i(p).slice(3),b="-"):(g=i(p).slice(2),b=""),g=b+g.slice(0,-1)+a[g.slice(-1)];else{if(hn(p)!=="object")throw new Error("Don't know what to do with value type "+hn(p)+".");g=s(p)}w.push(f+g)}return w.push("}"),w.join("")},o=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,f,g,b,w={},m=1,x=w,y=[],N="",S="",D=h.length-1,_=1;_<D;_+=1)(b=h[_])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(b):b=="{"?(y.push([x,g]),x={},g=void 0):b=="}"?((f=y.pop())[0][f[1]]=x,g=void 0,x=f[0]):b=="-"?m=-1:g===void 0?n.hasOwnProperty(b)?(N+=n[b],g=parseInt(N,16)*m,m=1,N=""):N+=b:n.hasOwnProperty(b)?(S+=n[b],x[g]=parseInt(S,16)*m,m=1,g=void 0,S=""):S+=b;return w},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},d={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var p=h.font,f=d.Unicode[p.postScriptName];f&&(p.metadata.Unicode={},p.metadata.Unicode.widths=f.widths,p.metadata.Unicode.kerning=f.kerning);var g=c.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(yt.API),function(e){var t=function(n){for(var a=n.length,r=new Uint8Array(a),i=0;i<a;i++)r[i]=n.charCodeAt(i);return r};e.API.events.push(["addFont",function(n){var a=void 0,r=n.font,i=n.instance;if(!r.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(a=i.existsFileInVFS(r.postScriptName)===!1?i.loadFile(r.postScriptName):i.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Ef(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(r,a)}}])}(yt),function(e){function t(){return(Nt.canvg?Promise.resolve(Nt.canvg):Bg(()=>import("./index.es-DkLo0d7-.js"),__vite__mapDeps([5,1,2,3,4]))).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}yt.API.addSvgAsImage=function(n,a,r,i,s,o,u,c){if(isNaN(a)||isNaN(r))throw yn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw yn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=s;var h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return t().then(function(g){return g.fromString(h,n,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(p)}).then(function(){f.addImage(d.toDataURL("image/jpeg",1),a,r,i,s,u,c)})}}(),yt.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var r=0;r<this.internal.pages[a].length;r++)this.internal.pages[a][r]=this.internal.pages[a][r].replace(t,n);return this},yt.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var a,r,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),u=[],c=0,d=0,h=0;function p(g,b){var w,m=!1;for(w=0;w<g.length;w+=1)g[w]===b&&(m=!0);return m}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var f=o.length;for(h=0;h<f;h+=1)n[o[h]].value=n[o[h]].defaultValue,n[o[h]].explicitSet=!1}if(hn(e)==="object"){for(r in e)if(i=e[r],p(o,r)&&i!==void 0){if(n[r].type==="boolean"&&typeof i=="boolean")n[r].value=i;else if(n[r].type==="name"&&p(n[r].valueSet,i))n[r].value=i;else if(n[r].type==="integer"&&Number.isInteger(i))n[r].value=i;else if(n[r].type==="array"){for(c=0;c<i.length;c+=1)if(a=!0,i[c].length===1&&typeof i[c][0]=="number")u.push(String(i[c]-1));else if(i[c].length>1){for(d=0;d<i[c].length;d+=1)typeof i[c][d]!="number"&&(a=!1);a===!0&&u.push([i[c][0]-1,i[c][1]-1].join(" "))}n[r].value="["+u.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,b=[];for(g in n)n[g].explicitSet===!0&&(n[g].type==="name"?b.push("/"+g+" /"+n[g].value):b.push("/"+g+" "+n[g].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+r.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(r+i+s+o+u),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(yt.API),function(e){var t=e.API,n=t.pdfEscape16=function(i,s){for(var o,u=s.metadata.Unicode.widths,c=["","0","00","000","0000"],d=[""],h=0,p=i.length;h<p;++h){if(o=s.metadata.characterToGlyph(i.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(h),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(c[4-o.length],o)}return d.join("")},a=function(i){var s,o,u,c,d,h,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],h=0,p=(o=Object.keys(i).sort(function(f,g){return f-g})).length;h<p;h++)s=o[h],u.length>=100&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+c+">"));return u.length&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,u=s.out,c=s.newObject,d=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",g=0;g<p.length;g++)f+=String.fromCharCode(p[g]);var b=c();d({data:f,addLength1:!0,objectId:b}),u("endobj");var w=c();d({data:a(o.metadata.toUnicode),addLength1:!0,objectId:w}),u("endobj");var m=c();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Qc(o.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var x=c();u("<<"),u("/Type /Font"),u("/BaseFont /"+Qc(o.fontName)),u("/FontDescriptor "+m+" 0 R"),u("/W "+e.API.PDFObject.convert(h)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=c(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+w+" 0 R"),u("/BaseFont /"+Qc(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+x+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,u=s.out,c=s.newObject,d=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",f=0;f<h.length;f++)p+=String.fromCharCode(h[f]);var g=c();d({data:p,addLength1:!0,objectId:g}),u("endobj");var b=c();d({data:a(o.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var w=c();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+g+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+Qc(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=c();for(var m=0;m<o.metadata.hmtx.widths.length;m++)o.metadata.hmtx.widths[m]=parseInt(o.metadata.hmtx.widths[m]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+Qc(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]);var r=function(i){var s,o=i.text||"",u=i.x,c=i.y,d=i.options||{},h=i.mutex||{},p=h.pdfEscape,f=h.activeFontKey,g=h.fonts,b=f,w="",m=0,x="",y=g[b].encoding;if(g[b].encoding!=="Identity-H")return{text:o,x:u,y:c,options:d,mutex:h};for(x=o,b=f,Array.isArray(o)&&(x=o[0]),m=0;m<x.length;m+=1)g[b].metadata.hasOwnProperty("cmap")&&(s=g[b].metadata.cmap.unicode.codeMap[x[m].charCodeAt(0)]),s||x[m].charCodeAt(0)<256&&g[b].metadata.hasOwnProperty("Unicode")?w+=x[m]:w+="";var N="";return parseInt(b.slice(1))<14||y==="WinAnsiEncoding"?N=p(w,b).split("").map(function(S){return S.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(N=n(w,g[b])),h.isHex=!0,{text:N,x:u,y:c,options:d,mutex:h}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],u={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([r(Object.assign({},u,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(r(Object.assign({},u,{text:s[c]})).text);i.text=o}else i.text=r(Object.assign({},u,{text:s})).text}])}(yt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,a){return t.call(this),this.internal.vFS[n]=a,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(yt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var r,i,s,o,u,c,d,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,y=0;this.__bidiEngine__={};var N=function(j){var E=j.charCodeAt(),F=E>>8,z=b[F];return z!==void 0?h[256*z+(255&E)]:F===252||F===253?"AL":m.test(F)?"L":F===8?"R":"N"},S=function(j){for(var E,F=0;F<j.length;F++){if((E=N(j.charAt(F)))==="L")return!1;if(E==="R")return!0}return!1},D=function(j,E,F,z){var U,O,B,q,I=E[z];switch(I){case"L":case"R":x=!1;break;case"N":case"AN":break;case"EN":x&&(I="AN");break;case"AL":x=!0,I="R";break;case"WS":I="N";break;case"CS":z<1||z+1>=E.length||(U=F[z-1])!=="EN"&&U!=="AN"||(O=E[z+1])!=="EN"&&O!=="AN"?I="N":x&&(O="AN"),I=O===U?O:"N";break;case"ES":I=(U=z>0?F[z-1]:"B")==="EN"&&z+1<E.length&&E[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&F[z-1]==="EN"){I="EN";break}if(x){I="N";break}for(B=z+1,q=E.length;B<q&&E[B]==="ET";)B++;I=B<q&&E[B]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(q=E.length,B=z+1;B<q&&E[B]==="NSM";)B++;if(B<q){var K=j[z],Z=K>=1425&&K<=2303||K===64286;if(U=E[B],Z&&(U==="R"||U==="AL")){I="R";break}}}I=z<1||(U=E[z-1])==="B"?"N":F[z-1];break;case"B":x=!1,r=!0,I=y;break;case"S":i=!0,I="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"BN":I="N"}return I},_=function(j,E,F){var z=j.split("");return F&&A(z,F,{hiLevel:y}),z.reverse(),E&&E.reverse(),z.join("")},A=function(j,E,F){var z,U,O,B,q,I=-1,K=j.length,Z=0,R=[],H=y?f:p,$=[];for(x=!1,r=!1,i=!1,U=0;U<K;U++)$[U]=N(j[U]);for(O=0;O<K;O++){if(q=Z,R[O]=D(j,$,R,O),z=240&(Z=H[q][g[R[O]]]),Z&=15,E[O]=B=H[Z][5],z>0)if(z===16){for(U=I;U<O;U++)E[U]=1;I=-1}else I=-1;if(H[Z][6])I===-1&&(I=O);else if(I>-1){for(U=I;U<O;U++)E[U]=B;I=-1}$[O]==="B"&&(E[O]=0),F.hiLevel|=B}i&&function(X,W,ie){for(var ce=0;ce<ie;ce++)if(X[ce]==="S"){W[ce]=y;for(var ue=ce-1;ue>=0&&X[ue]==="WS";ue--)W[ue]=y}}($,E,K)},L=function(j,E,F,z,U){if(!(U.hiLevel<j)){if(j===1&&y===1&&!r)return E.reverse(),void(F&&F.reverse());for(var O,B,q,I,K=E.length,Z=0;Z<K;){if(z[Z]>=j){for(q=Z+1;q<K&&z[q]>=j;)q++;for(I=Z,B=q-1;I<B;I++,B--)O=E[I],E[I]=E[B],E[B]=O,F&&(O=F[I],F[I]=F[B],F[B]=O);Z=q}Z++}}},P=function(j,E,F){var z=j.split(""),U={hiLevel:y};return F||(F=[]),A(z,F,U),function(O,B,q){if(q.hiLevel!==0&&d)for(var I,K=0;K<O.length;K++)B[K]===1&&(I=w.indexOf(O[K]))>=0&&(O[K]=w[I+1])}(z,F,U),L(2,z,E,F,U),L(1,z,E,F,U),z.join("")};return this.__bidiEngine__.doBidiReorder=function(j,E,F){if(function(U,O){if(O)for(var B=0;B<U.length;B++)O[B]=B;o===void 0&&(o=S(U)),c===void 0&&(c=S(U))}(j,E),s||!u||c)if(s&&u&&o^c)y=o?1:0,j=_(j,E,F);else if(!s&&u&&c)y=o?1:0,j=P(j,E,F),j=_(j,E);else if(!s||o||u||c){if(s&&!u&&o^c)j=_(j,E),o?(y=0,j=P(j,E,F)):(y=1,j=P(j,E,F),j=_(j,E));else if(s&&o&&!u&&c)y=1,j=P(j,E,F),j=_(j,E);else if(!s&&!u&&o^c){var z=d;o?(y=1,j=P(j,E,F),y=0,d=!1,j=P(j,E,F),d=z):(y=0,j=P(j,E,F),j=_(j,E),y=1,d=!1,j=P(j,E,F),d=z,j=_(j,E))}}else y=0,j=P(j,E,F);else y=o?1:0,j=P(j,E,F);return j},this.__bidiEngine__.setOptions=function(j){j&&(s=j.isInputVisual,u=j.isOutputVisual,o=j.isInputRtl,c=j.isOutputRtl,d=j.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var r=a.text,i=(a.x,a.y,a.options||{}),s=(a.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(s=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?s.push([n.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):s.push([n.doBidiReorder(r[o])]);a.text=s}else a.text=n.doBidiReorder(r);n.setOptions({isInputVisual:!0})}])}(yt),yt.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new Gl(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new f$(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new ZG(this.contents),this.head=new t$(this),this.name=new s$(this),this.cmap=new SD(this),this.toUnicode={},this.hhea=new n$(this),this.maxp=new o$(this),this.hmtx=new l$(this),this.post=new r$(this),this.os2=new a$(this),this.loca=new h$(this),this.glyf=new u$(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,a,r,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,u,c;for(c=[],s=0,o=(u=this.bbox).length;s<o;s++)t=u[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(a=255&(r=this.post.italic_angle),32768&(n=r>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,a){var r,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)r=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(r))+a*(1e3/n)||0;return s*(n/1e3)},e.prototype.lineHeight=function(t,n){var a;return n==null&&(n=!1),a=n?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var ps,Gl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,a;for(a=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)a[n]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var n,a,r;for(r=[],n=0,a=t.length;0<=a?n<a:n>a;n=0<=a?++n:--n)r.push(this.writeByte(t.charCodeAt(n)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,a,r,i,s,o,u;return t=this.readByte(),n=this.readByte(),a=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^a)+4294967296*(255^r)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^u)+1):72057594037927940*t+281474976710656*n+1099511627776*a+4294967296*r+16777216*i+65536*s+256*o+u},e.prototype.writeLongLong=function(t){var n,a;return n=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,a;for(n=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)n.push(this.readByte());return n},e.prototype.write=function(t){var n,a,r,i;for(i=[],a=0,r=t.length;a<r;a++)n=t[a],i.push(this.writeByte(n));return i},e}(),ZG=function(){var e;function t(n){var a,r,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},r=0,i=this.tableCount;0<=i?r<i:r>i;r=0<=i?++r:--r)a={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(n){var a,r,i,s,o,u,c,d,h,p,f,g,b;for(b in f=Object.keys(n).length,u=Math.log(2),h=16*Math.floor(Math.log(f)/u),s=Math.floor(h/u),d=16*f-h,(r=new Gl).writeInt(this.scalarType),r.writeShort(f),r.writeShort(h),r.writeShort(s),r.writeShort(d),i=16*f,c=r.pos+i,o=null,g=[],n)for(p=n[b],r.writeString(b),r.writeInt(e(p)),r.writeInt(c),r.writeInt(p.length),g=g.concat(p),b==="head"&&(o=c),c+=p.length;c%4;)g.push(0),c++;return r.write(g),a=2981146554-e(r.data),r.pos=o+8,r.writeUInt32(a),r.data},e=function(n){var a,r,i,s;for(n=_D.call(n);n.length%4;)n.push(0);for(i=new Gl(n),r=0,a=0,s=n.length;a<s;a=a+=4)r+=i.readUInt32();return 4294967295&r},t}(),e$={}.hasOwnProperty,Xs=function(e,t){for(var n in t)e$.call(t,n)&&(e[n]=t[n]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};ps=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var t$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var a;return(a=new Gl).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(n),a.writeShort(this.glyphDataFormat),a.data},t}(),rS=function(){function e(t,n){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(f=t.readUInt16(),p=f/2,t.pos+=6,i=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),t.pos+=2,b=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),c=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),d=function(){var N,S;for(S=[],u=N=0;0<=p?N<p:N>p;u=0<=p?++N:--N)S.push(t.readUInt16());return S}(),r=(this.length-t.pos+this.offset)/2,o=function(){var N,S;for(S=[],u=N=0;0<=r?N<r:N>r;u=0<=r?++N:--N)S.push(t.readUInt16());return S}(),u=m=0,y=i.length;m<y;u=++m)for(w=i[u],a=x=g=b[u];g<=w?x<=w:x>=w;a=g<=w?++x:--x)d[u]===0?s=a+c[u]:(s=o[d[u]/2+(a-g)-(p-u)]||0)!==0&&(s+=c[u]),this.codeMap[a]=65535&s}t.pos=h}return e.encode=function(t,n){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m,x,y,N,S,D,_,A,L,P,j,E,F,z,U,O,B,q,I,K,Z,R,H,$,X,W,ie,ce,ue,he,ge,Ee;switch(z=new Gl,s=Object.keys(t).sort(function(Te,fe){return Te-fe}),n){case"macroman":for(b=0,w=function(){var Te=[];for(g=0;g<256;++g)Te.push(0);return Te}(),x={0:0},i={},U=0,I=s.length;U<I;U++)x[ue=t[r=s[U]]]==null&&(x[ue]=++b),i[r]={old:t[r],new:x[t[r]]},w[r]=x[t[r]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(w),{charMap:i,subtable:z.data,maxGlyphID:b+1};case"unicode":for(E=[],h=[],y=0,x={},a={},m=c=null,O=0,K=s.length;O<K;O++)x[S=t[r=s[O]]]==null&&(x[S]=++y),a[r]={old:S,new:x[S]},o=x[S]-r,m!=null&&o===c||(m&&h.push(m),E.push(r),c=o),m=r;for(m&&h.push(m),h.push(65535),E.push(65535),P=2*(L=E.length),A=2*Math.pow(Math.log(L)/Math.LN2,2),p=Math.log(A/2)/Math.LN2,_=2*L-A,u=[],D=[],f=[],g=B=0,Z=E.length;B<Z;g=++B){if(j=E[g],d=h[g],j===65535){u.push(0),D.push(0);break}if(j-(F=a[j].new)>=32768)for(u.push(0),D.push(2*(f.length+L-g)),r=q=j;j<=d?q<=d:q>=d;r=j<=d?++q:--q)f.push(a[r].new);else u.push(F-j),D.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*L+2*f.length),z.writeUInt16(0),z.writeUInt16(P),z.writeUInt16(A),z.writeUInt16(p),z.writeUInt16(_),ie=0,R=h.length;ie<R;ie++)r=h[ie],z.writeUInt16(r);for(z.writeUInt16(0),ce=0,H=E.length;ce<H;ce++)r=E[ce],z.writeUInt16(r);for(he=0,$=u.length;he<$;he++)o=u[he],z.writeUInt16(o);for(ge=0,X=D.length;ge<X;ge++)N=D[ge],z.writeUInt16(N);for(Ee=0,W=f.length;Ee<W;Ee++)b=f[Ee],z.writeUInt16(b);return{charMap:a,subtable:z.data,maxGlyphID:y+1}}},e}(),SD=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="cmap",t.prototype.parse=function(n){var a,r,i;for(n.pos=this.offset,this.version=n.readUInt16(),i=n.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)a=new rS(n,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(n,a){var r,i;return a==null&&(a="macroman"),r=rS.encode(n,a),(i=new Gl).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),n$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),a$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var a,r;for(r=[],a=0;a<10;++a)r.push(n.readByte());return r}(),this.charRange=function(){var a,r;for(r=[],a=0;a<4;++a)r.push(n.readInt());return r}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var a,r;for(r=[],a=0;a<2;a=++a)r.push(n.readInt());return r}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),r$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="post",t.prototype.parse=function(n){var a,r,i;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var s;for(r=n.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],i=[];n.pos<this.offset+this.length;)a=n.readByte(),i.push(this.names.push(n.readString(a)));return i;case 151552:return r=n.readUInt16(),this.offsets=n.read(r);case 196608:break;case 262144:return this.map=(function(){var o,u,c;for(c=[],s=o=0,u=this.file.maxp.numGlyphs;0<=u?o<u:o>u;s=0<=u?++o:--o)c.push(n.readUInt32());return c}).call(this)}},t}(),i$=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},s$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="name",t.prototype.parse=function(n){var a,r,i,s,o,u,c,d,h,p,f;for(n.pos=this.offset,n.readShort(),a=n.readShort(),u=n.readShort(),r=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)r.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+u+n.readShort()});for(c={},s=h=0,p=r.length;h<p;s=++h)i=r[s],n.pos=i.offset,d=n.readString(i.length),o=new i$(d,i),c[f=i.nameID]==null&&(c[f]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),o$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),l$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="hmtx",t.prototype.parse=function(n){var a,r,i,s,o,u,c;for(n.pos=this.offset,this.metrics=[],a=0,u=this.file.hhea.numberOfMetrics;0<=u?a<u:a>u;a=0<=u?++a:--a)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,h;for(h=[],a=d=0;0<=i?d<i:d>i;a=0<=i?++d:--d)h.push(n.readInt16());return h}(),this.widths=(function(){var d,h,p,f;for(f=[],d=0,h=(p=this.metrics).length;d<h;d++)s=p[d],f.push(s.advance);return f}).call(this),r=this.widths[this.widths.length-1],c=[],a=o=0;0<=i?o<i:o>i;a=0<=i?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),_D=[].slice,u$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var a,r,i,s,o,u,c,d,h,p;return n in this.cache?this.cache[n]:(s=this.file.loca,a=this.file.contents,r=s.indexOf(n),(i=s.lengthOf(n))===0?this.cache[n]=null:(a.pos=this.offset+r,o=(u=new Gl(a.read(i))).readShort(),d=u.readShort(),p=u.readShort(),c=u.readShort(),h=u.readShort(),this.cache[n]=o===-1?new d$(u,d,p,c,h):new c$(u,o,d,p,c,h),this.cache[n]))},t.prototype.encode=function(n,a,r){var i,s,o,u,c;for(o=[],s=[],u=0,c=a.length;u<c;u++)i=n[a[u]],s.push(o.length),i&&(o=o.concat(i.encode(r)));return s.push(o.length),{table:o,offsets:s}},t}(),c$=function(){function e(t,n,a,r,i,s){this.raw=t,this.numberOfContours=n,this.xMin=a,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),d$=function(){function e(t,n,a,r,i){var s,o;for(this.raw=t,this.xMin=n,this.yMin=a,this.xMax=r,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,n,a;for(n=new Gl(_D.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),h$=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Xs(t,ps),t.prototype.tag="loca",t.prototype.parse=function(n){var a,r;return n.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*n.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(n.readUInt32());return s}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,a){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<r.length;++o)if(r[o]=i,s<a.length&&a[s]==o){++s,r[o]=i;var u=this.offsets[o],c=this.offsets[o+1]-u;c>0&&(i+=c)}for(var d=new Array(4*r.length),h=0;h<r.length;++h)d[4*h+3]=255&r[h],d[4*h+2]=(65280&r[h])>>8,d[4*h+1]=(16711680&r[h])>>16,d[4*h]=(4278190080&r[h])>>24;return d},t}(),f$=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,a,r,i;for(n in r=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[n],t[n]=r[a];return t},e.prototype.glyphsFor=function(t){var n,a,r,i,s,o,u;for(r={},s=0,o=t.length;s<o;s++)r[i=t[s]]=this.font.glyf.glyphFor(i);for(i in n=[],r)(a=r[i])!=null&&a.compound&&n.push.apply(n,a.glyphIDs);if(n.length>0)for(i in u=this.glyphsFor(n))a=u[i],r[i]=a;return r},e.prototype.encode=function(t,n){var a,r,i,s,o,u,c,d,h,p,f,g,b,w,m;for(r in a=SD.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),f={0:0},m=a.charMap)f[(u=m[r]).old]=u.new;for(g in p=a.maxGlyphID,s)g in f||(f[g]=p++);return d=function(x){var y,N;for(y in N={},x)N[x[y]]=y;return N}(f),h=Object.keys(d).sort(function(x,y){return x-y}),b=function(){var x,y,N;for(N=[],x=0,y=h.length;x<y;x++)o=h[x],N.push(d[o]);return N}(),i=this.font.glyf.encode(s,b,f),c=this.font.loca.encode(i.offsets,b),w={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},e}();yt.API.PDFObject=function(){var e;function t(){}return e=function(n,a){return(Array(a+1).join("0")+n).slice(-a)},t.convert=function(n){var a,r,i,s;if(Array.isArray(n))return"["+function(){var o,u,c;for(c=[],o=0,u=n.length;o<u;o++)a=n[o],c.push(t.convert(a));return c}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(r in i=["<<"],n)s=n[r],i.push("/"+r+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+n},t}();const p$=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:VG,AcroFormAppearance:ot,AcroFormButton:xa,AcroFormCheckBox:Lf,AcroFormChoiceField:Ou,AcroFormComboBox:Fu,AcroFormEditBox:Df,AcroFormListBox:Iu,AcroFormPasswordField:Pf,AcroFormPushButton:Tf,AcroFormRadioButton:Bu,AcroFormTextField:Il,GState:up,ShadingPattern:pl,TilingPattern:Su,default:yt,jsPDF:yt},Symbol.toStringTag,{value:"Module"}));var m$={exports:{}};const g$=cT(p$);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(a,r){e.exports=r(function(){try{return g$}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Qx<"u"?Qx:typeof window<"u"?window:typeof self<"u"?self:Qx,function(n){return function(){var a={172:function(o,u){var c=this&&this.__extends||function(){var p=function(f,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var m in w)Object.prototype.hasOwnProperty.call(w,m)&&(b[m]=w[m])},p(f,g)};return function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");p(f,g);function b(){this.constructor=f}f.prototype=g===null?Object.create(g):(b.prototype=g.prototype,new b)}}();Object.defineProperty(u,"__esModule",{value:!0}),u.CellHookData=u.HookData=void 0;var d=function(){function p(f,g,b){this.table=g,this.pageNumber=g.pageNumber,this.pageCount=this.pageNumber,this.settings=g.settings,this.cursor=b,this.doc=f.getDocument()}return p}();u.HookData=d;var h=function(p){c(f,p);function f(g,b,w,m,x,y){var N=p.call(this,g,b,y)||this;return N.cell=w,N.row=m,N.column=x,N.section=m.section,N}return f}(d);u.CellHookData=h},340:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0});var d=c(4),h=c(136),p=c(744),f=c(776),g=c(664),b=c(972);function w(m){m.API.autoTable=function(){for(var x=[],y=0;y<arguments.length;y++)x[y]=arguments[y];var N;x.length===1?N=x[0]:(console.error("Use of deprecated autoTable initiation"),N=x[2]||{},N.columns=x[0],N.body=x[1]);var S=(0,f.parseInput)(this,N),D=(0,b.createTable)(this,S);return(0,g.drawTable)(this,D),this},m.API.lastAutoTable=!1,m.API.previousAutoTable=!1,m.API.autoTable.previous=!1,m.API.autoTableText=function(x,y,N,S){(0,h.default)(x,y,N,S,this)},m.API.autoTableSetDefaults=function(x){return p.DocHandler.setDefaults(x,this),this},m.autoTableSetDefaults=function(x,y){p.DocHandler.setDefaults(x,y)},m.API.autoTableHtmlToJson=function(x,y){var N;if(y===void 0&&(y=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var S=new p.DocHandler(this),D=(0,d.parseHtml)(S,x,window,y,!1),_=D.head,A=D.body,L=((N=_[0])===null||N===void 0?void 0:N.map(function(P){return P.content}))||[];return{columns:L,rows:A,data:A}},m.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var x=this.lastAutoTable;return x&&x.finalY?x.finalY:0},m.API.autoTableAddPageContent=function(x){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),m.API.autoTable.globalDefaults||(m.API.autoTable.globalDefaults={}),m.API.autoTable.globalDefaults.addPageContent=x,this},m.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}u.default=w},136:function(o,u){Object.defineProperty(u,"__esModule",{value:!0});function c(d,h,p,f,g){f=f||{};var b=1.15,w=g.internal.scaleFactor,m=g.internal.getFontSize()/w,x=g.getLineHeightFactor?g.getLineHeightFactor():b,y=m*x,N=/\r\n|\r|\n/g,S="",D=1;if((f.valign==="middle"||f.valign==="bottom"||f.halign==="center"||f.halign==="right")&&(S=typeof d=="string"?d.split(N):d,D=S.length||1),p+=m*(2-b),f.valign==="middle"?p-=D/2*y:f.valign==="bottom"&&(p-=D*y),f.halign==="center"||f.halign==="right"){var _=m;if(f.halign==="center"&&(_*=.5),S&&D>=1){for(var A=0;A<S.length;A++)g.text(S[A],h-g.getStringUnitWidth(S[A])*_,p),p+=y;return g}h-=g.getStringUnitWidth(d)*_}return f.halign==="justify"?g.text(d,h,p,{maxWidth:f.maxWidth||100,align:"justify"}):g.text(d,h,p),g}u.default=c},420:function(o,u){Object.defineProperty(u,"__esModule",{value:!0}),u.getPageAvailableWidth=u.parseSpacing=u.getFillStyle=u.addTableBorder=u.getStringWidth=void 0;function c(g,b,w){w.applyStyles(b,!0);var m=Array.isArray(g)?g:[g],x=m.map(function(y){return w.getTextWidth(y)}).reduce(function(y,N){return Math.max(y,N)},0);return x}u.getStringWidth=c;function d(g,b,w,m){var x=b.settings.tableLineWidth,y=b.settings.tableLineColor;g.applyStyles({lineWidth:x,lineColor:y});var N=h(x,!1);N&&g.rect(w.x,w.y,b.getWidth(g.pageSize().width),m.y-w.y,N)}u.addTableBorder=d;function h(g,b){var w=g>0,m=b||b===0;return w&&m?"DF":w?"S":m?"F":null}u.getFillStyle=h;function p(g,b){var w,m,x,y;if(g=g||b,Array.isArray(g)){if(g.length>=4)return{top:g[0],right:g[1],bottom:g[2],left:g[3]};if(g.length===3)return{top:g[0],right:g[1],bottom:g[2],left:g[1]};if(g.length===2)return{top:g[0],right:g[1],bottom:g[0],left:g[1]};g.length===1?g=g[0]:g=b}return typeof g=="object"?(typeof g.vertical=="number"&&(g.top=g.vertical,g.bottom=g.vertical),typeof g.horizontal=="number"&&(g.right=g.horizontal,g.left=g.horizontal),{left:(w=g.left)!==null&&w!==void 0?w:b,top:(m=g.top)!==null&&m!==void 0?m:b,right:(x=g.right)!==null&&x!==void 0?x:b,bottom:(y=g.bottom)!==null&&y!==void 0?y:b}):(typeof g!="number"&&(g=b),{top:g,right:g,bottom:g,left:g})}u.parseSpacing=p;function f(g,b){var w=p(b.settings.margin,0);return g.pageSize().width-(w.left+w.right)}u.getPageAvailableWidth=f},796:function(o,u){var c=this&&this.__extends||function(){var f=function(g,b){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,m){w.__proto__=m}||function(w,m){for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(w[x]=m[x])},f(g,b)};return function(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");f(g,b);function w(){this.constructor=g}g.prototype=b===null?Object.create(b):(w.prototype=b.prototype,new w)}}();Object.defineProperty(u,"__esModule",{value:!0}),u.getTheme=u.defaultStyles=u.HtmlRowInput=void 0;var d=function(f){c(g,f);function g(b){var w=f.call(this)||this;return w._element=b,w}return g}(Array);u.HtmlRowInput=d;function h(f){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/f,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}u.defaultStyles=h;function p(f){var g={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return g[f]}u.getTheme=p},903:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.parseCss=void 0;var d=c(420);function h(w,m,x,y,N){var S={},D=1.3333333333333333,_=f(m,function(I){return N.getComputedStyle(I).backgroundColor});_!=null&&(S.fillColor=_);var A=f(m,function(I){return N.getComputedStyle(I).color});A!=null&&(S.textColor=A);var L=b(y,x);L&&(S.cellPadding=L);var P="borderTopColor",j=D*x,E=y.borderTopWidth;if(y.borderBottomWidth===E&&y.borderRightWidth===E&&y.borderLeftWidth===E){var F=(parseFloat(E)||0)/j;F&&(S.lineWidth=F)}else S.lineWidth={top:(parseFloat(y.borderTopWidth)||0)/j,right:(parseFloat(y.borderRightWidth)||0)/j,bottom:(parseFloat(y.borderBottomWidth)||0)/j,left:(parseFloat(y.borderLeftWidth)||0)/j},S.lineWidth.top||(S.lineWidth.right?P="borderRightColor":S.lineWidth.bottom?P="borderBottomColor":S.lineWidth.left&&(P="borderLeftColor"));var z=f(m,function(I){return N.getComputedStyle(I)[P]});z!=null&&(S.lineColor=z);var U=["left","right","center","justify"];U.indexOf(y.textAlign)!==-1&&(S.halign=y.textAlign),U=["middle","bottom","top"],U.indexOf(y.verticalAlign)!==-1&&(S.valign=y.verticalAlign);var O=parseInt(y.fontSize||"");isNaN(O)||(S.fontSize=O/D);var B=p(y);B&&(S.fontStyle=B);var q=(y.fontFamily||"").toLowerCase();return w.indexOf(q)!==-1&&(S.font=q),S}u.parseCss=h;function p(w){var m="";return(w.fontWeight==="bold"||w.fontWeight==="bolder"||parseInt(w.fontWeight)>=700)&&(m="bold"),(w.fontStyle==="italic"||w.fontStyle==="oblique")&&(m+="italic"),m}function f(w,m){var x=g(w,m);if(!x)return null;var y=x.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!y||!Array.isArray(y))return null;var N=[parseInt(y[1]),parseInt(y[2]),parseInt(y[3])],S=parseInt(y[4]);return S===0||isNaN(N[0])||isNaN(N[1])||isNaN(N[2])?null:N}function g(w,m){var x=m(w);return x==="rgba(0, 0, 0, 0)"||x==="transparent"||x==="initial"||x==="inherit"?w.parentElement==null?null:g(w.parentElement,m):x}function b(w,m){var x=[w.paddingTop,w.paddingRight,w.paddingBottom,w.paddingLeft],y=96/(72/m),N=(parseInt(w.lineHeight)-parseInt(w.fontSize))/m/2,S=x.map(function(_){return parseInt(_||"0")/y}),D=(0,d.parseSpacing)(S,0);return N>D.top&&(D.top=N),N>D.bottom&&(D.bottom=N),D}},744:function(o,u){Object.defineProperty(u,"__esModule",{value:!0}),u.DocHandler=void 0;var c={},d=function(){function h(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return h.setDefaults=function(p,f){f===void 0&&(f=null),f?f.__autoTableDocumentDefaults=p:c=p},h.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},h.prototype.applyStyles=function(p,f){var g,b,w;f===void 0&&(f=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var m=this.jsPDFDocument.internal.getFont(),x=m.fontStyle,y=m.fontName;if(p.font&&(y=p.font),p.fontStyle){x=p.fontStyle;var N=this.getFontList()[y];N&&N.indexOf(x)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(N[0]),x=N[0])}if(this.jsPDFDocument.setFont(y,x),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!f){var S=h.unifyColor(p.fillColor);S&&(g=this.jsPDFDocument).setFillColor.apply(g,S),S=h.unifyColor(p.textColor),S&&(b=this.jsPDFDocument).setTextColor.apply(b,S),S=h.unifyColor(p.lineColor),S&&(w=this.jsPDFDocument).setDrawColor.apply(w,S),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},h.prototype.splitTextToSize=function(p,f,g){return this.jsPDFDocument.splitTextToSize(p,f,g)},h.prototype.rect=function(p,f,g,b,w){return this.jsPDFDocument.rect(p,f,g,b,w)},h.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},h.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},h.prototype.getDocument=function(){return this.jsPDFDocument},h.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},h.prototype.addPage=function(){return this.jsPDFDocument.addPage()},h.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},h.prototype.getGlobalOptions=function(){return c||{}},h.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},h.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},h.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},h.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},h.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},h.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},h}();u.DocHandler=d},4:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.parseHtml=void 0;var d=c(903),h=c(796);function p(b,w,m,x,y){var N,S;x===void 0&&(x=!1),y===void 0&&(y=!1);var D;typeof w=="string"?D=m.document.querySelector(w):D=w;var _=Object.keys(b.getFontList()),A=b.scaleFactor(),L=[],P=[],j=[];if(!D)return console.error("Html table could not be found with input: ",w),{head:L,body:P,foot:j};for(var E=0;E<D.rows.length;E++){var F=D.rows[E],z=(S=(N=F==null?void 0:F.parentElement)===null||N===void 0?void 0:N.tagName)===null||S===void 0?void 0:S.toLowerCase(),U=f(_,A,m,F,x,y);U&&(z==="thead"?L.push(U):z==="tfoot"?j.push(U):P.push(U))}return{head:L,body:P,foot:j}}u.parseHtml=p;function f(b,w,m,x,y,N){for(var S=new h.HtmlRowInput(x),D=0;D<x.cells.length;D++){var _=x.cells[D],A=m.getComputedStyle(_);if(y||A.display!=="none"){var L=void 0;N&&(L=(0,d.parseCss)(b,_,w,A,m)),S.push({rowSpan:_.rowSpan,colSpan:_.colSpan,styles:L,_element:_,content:g(_)})}}var P=m.getComputedStyle(x);if(S.length>0&&(y||P.display!=="none"))return S}function g(b){var w=b.cloneNode(!0);return w.innerHTML=w.innerHTML.replace(/\n/g,"").replace(/ +/g," "),w.innerHTML=w.innerHTML.split(/<br.*?>/).map(function(m){return m.trim()}).join(`
`),w.innerText||w.textContent||""}},776:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.parseInput=void 0;var d=c(4),h=c(356),p=c(420),f=c(744),g=c(792);function b(D,_){var A=new f.DocHandler(D),L=A.getDocumentOptions(),P=A.getGlobalOptions();(0,g.default)(A,P,L,_);var j=(0,h.assign)({},P,L,_),E;typeof window<"u"&&(E=window);var F=w(P,L,_),z=m(P,L,_),U=x(A,j),O=N(A,j,E);return{id:_.tableId,content:O,hooks:z,styles:F,settings:U}}u.parseInput=b;function w(D,_,A){for(var L={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},P=function(z){if(z==="columnStyles"){var U=D[z],O=_[z],B=A[z];L.columnStyles=(0,h.assign)({},U,O,B)}else{var q=[D,_,A],I=q.map(function(K){return K[z]||{}});L[z]=(0,h.assign)({},I[0],I[1],I[2])}},j=0,E=Object.keys(L);j<E.length;j++){var F=E[j];P(F)}return L}function m(D,_,A){for(var L=[D,_,A],P={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},j=0,E=L;j<E.length;j++){var F=E[j];F.didParseCell&&P.didParseCell.push(F.didParseCell),F.willDrawCell&&P.willDrawCell.push(F.willDrawCell),F.didDrawCell&&P.didDrawCell.push(F.didDrawCell),F.willDrawPage&&P.willDrawPage.push(F.willDrawPage),F.didDrawPage&&P.didDrawPage.push(F.didDrawPage)}return P}function x(D,_){var A,L,P,j,E,F,z,U,O,B,q,I,K=(0,p.parseSpacing)(_.margin,40/D.scaleFactor()),Z=(A=y(D,_.startY))!==null&&A!==void 0?A:K.top,R;_.showFoot===!0?R="everyPage":_.showFoot===!1?R="never":R=(L=_.showFoot)!==null&&L!==void 0?L:"everyPage";var H;_.showHead===!0?H="everyPage":_.showHead===!1?H="never":H=(P=_.showHead)!==null&&P!==void 0?P:"everyPage";var $=(j=_.useCss)!==null&&j!==void 0?j:!1,X=_.theme||($?"plain":"striped"),W=!!_.horizontalPageBreak,ie=(E=_.horizontalPageBreakRepeat)!==null&&E!==void 0?E:null;return{includeHiddenHtml:(F=_.includeHiddenHtml)!==null&&F!==void 0?F:!1,useCss:$,theme:X,startY:Z,margin:K,pageBreak:(z=_.pageBreak)!==null&&z!==void 0?z:"auto",rowPageBreak:(U=_.rowPageBreak)!==null&&U!==void 0?U:"auto",tableWidth:(O=_.tableWidth)!==null&&O!==void 0?O:"auto",showHead:H,showFoot:R,tableLineWidth:(B=_.tableLineWidth)!==null&&B!==void 0?B:0,tableLineColor:(q=_.tableLineColor)!==null&&q!==void 0?q:200,horizontalPageBreak:W,horizontalPageBreakRepeat:ie,horizontalPageBreakBehaviour:(I=_.horizontalPageBreakBehaviour)!==null&&I!==void 0?I:"afterAllRows"}}function y(D,_){var A=D.getLastAutoTable(),L=D.scaleFactor(),P=D.pageNumber(),j=!1;if(A&&A.startPageNumber){var E=A.startPageNumber+A.pageNumber-1;j=E===P}return typeof _=="number"?_:(_==null||_===!1)&&j&&(A==null?void 0:A.finalY)!=null?A.finalY+20/L:null}function N(D,_,A){var L=_.head||[],P=_.body||[],j=_.foot||[];if(_.html){var E=_.includeHiddenHtml;if(A){var F=(0,d.parseHtml)(D,_.html,A,E,_.useCss)||{};L=F.head||L,P=F.body||L,j=F.foot||L}else console.error("Cannot parse html in non browser environment")}var z=_.columns||S(L,P,j);return{columns:z,head:L,body:P,foot:j}}function S(D,_,A){var L=D[0]||_[0]||A[0]||[],P=[];return Object.keys(L).filter(function(j){return j!=="_element"}).forEach(function(j){var E=1,F;Array.isArray(L)?F=L[parseInt(j)]:F=L[j],typeof F=="object"&&!Array.isArray(F)&&(E=(F==null?void 0:F.colSpan)||1);for(var z=0;z<E;z++){var U=void 0;Array.isArray(L)?U=P.length:U=j+(z>0?"_".concat(z):"");var O={dataKey:U};P.push(O)}}),P}},792:function(o,u){Object.defineProperty(u,"__esModule",{value:!0});function c(h,p,f,g){for(var b=function(y){y&&typeof y!="object"&&console.error("The options parameter should be of type object, is: "+typeof y),typeof y.extendWidth<"u"&&(y.tableWidth=y.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof y.margins<"u"&&(typeof y.margin>"u"&&(y.margin=y.margins),console.error("Use of deprecated option: margins, use margin instead.")),y.startY&&typeof y.startY!="number"&&(console.error("Invalid value for startY option",y.startY),delete y.startY),!y.didDrawPage&&(y.afterPageContent||y.beforePageContent||y.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),y.didDrawPage=function(j){h.applyStyles(h.userStyles),y.beforePageContent&&y.beforePageContent(j),h.applyStyles(h.userStyles),y.afterPageContent&&y.afterPageContent(j),h.applyStyles(h.userStyles),y.afterPageAdd&&j.pageNumber>1&&j.afterPageAdd(j),h.applyStyles(h.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(j){y[j]&&console.error('The "'.concat(j,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(j){var E=j[0],F=j[1];y[F]&&(console.error("Use of deprecated option ".concat(F,". Use ").concat(E," instead")),y[E]=y[F])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(j){var E=typeof j=="string"?j:j[0],F=typeof j=="string"?j:j[1];typeof y[E]<"u"&&(typeof y.styles[F]>"u"&&(y.styles[F]=y[E]),console.error("Use of deprecated option: "+E+", use the style "+F+" instead."))});for(var N=0,S=["styles","bodyStyles","headStyles","footStyles"];N<S.length;N++){var D=S[N];d(y[D]||{})}for(var _=y.columnStyles||{},A=0,L=Object.keys(_);A<L.length;A++){var P=L[A];d(_[P]||{})}},w=0,m=[p,f,g];w<m.length;w++){var x=m[w];b(x)}}u.default=c;function d(h){h.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),h.minCellHeight||(h.minCellHeight=h.rowHeight)):h.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),h.cellWidth||(h.cellWidth=h.columnWidth))}},260:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.Column=u.Cell=u.Row=u.Table=void 0;var d=c(796),h=c(172),p=c(420),f=function(){function m(x,y){this.pageNumber=1,this.pageCount=1,this.id=x.id,this.settings=x.settings,this.styles=x.styles,this.hooks=x.hooks,this.columns=y.columns,this.head=y.head,this.body=y.body,this.foot=y.foot}return m.prototype.getHeadHeight=function(x){return this.head.reduce(function(y,N){return y+N.getMaxCellHeight(x)},0)},m.prototype.getFootHeight=function(x){return this.foot.reduce(function(y,N){return y+N.getMaxCellHeight(x)},0)},m.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},m.prototype.callCellHooks=function(x,y,N,S,D,_){for(var A=0,L=y;A<L.length;A++){var P=L[A],j=new h.CellHookData(x,this,N,S,D,_),E=P(j)===!1;if(N.text=Array.isArray(N.text)?N.text:[N.text],E)return!1}return!0},m.prototype.callEndPageHooks=function(x,y){x.applyStyles(x.userStyles);for(var N=0,S=this.hooks.didDrawPage;N<S.length;N++){var D=S[N];D(new h.HookData(x,this,y))}},m.prototype.callWillDrawPageHooks=function(x,y){for(var N=0,S=this.hooks.willDrawPage;N<S.length;N++){var D=S[N];D(new h.HookData(x,this,y))}},m.prototype.getWidth=function(x){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var y=this.columns.reduce(function(S,D){return S+D.wrappedWidth},0);return y}else{var N=this.settings.margin;return x-N.left-N.right}},m}();u.Table=f;var g=function(){function m(x,y,N,S,D){D===void 0&&(D=!1),this.height=0,this.raw=x,x instanceof d.HtmlRowInput&&(this.raw=x._element,this.element=x._element),this.index=y,this.section=N,this.cells=S,this.spansMultiplePages=D}return m.prototype.getMaxCellHeight=function(x){var y=this;return x.reduce(function(N,S){var D;return Math.max(N,((D=y.cells[S.index])===null||D===void 0?void 0:D.height)||0)},0)},m.prototype.hasRowSpan=function(x){var y=this;return x.filter(function(N){var S=y.cells[N.index];return S?S.rowSpan>1:!1}).length>0},m.prototype.canEntireRowFit=function(x,y){return this.getMaxCellHeight(y)<=x},m.prototype.getMinimumRowHeight=function(x,y){var N=this;return x.reduce(function(S,D){var _=N.cells[D.index];if(!_)return 0;var A=y.getLineHeight(_.styles.fontSize),L=_.padding("vertical"),P=L+A;return P>S?P:S},0)},m}();u.Row=g;var b=function(){function m(x,y,N){var S,D;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=y,this.section=N,this.raw=x;var _=x;x!=null&&typeof x=="object"&&!Array.isArray(x)?(this.rowSpan=x.rowSpan||1,this.colSpan=x.colSpan||1,_=(D=(S=x.content)!==null&&S!==void 0?S:x.title)!==null&&D!==void 0?D:x,x._element&&(this.raw=x._element)):(this.rowSpan=1,this.colSpan=1);var A=_!=null?""+_:"",L=/\r\n|\r|\n/g;this.text=A.split(L)}return m.prototype.getTextPos=function(){var x;if(this.styles.valign==="top")x=this.y+this.padding("top");else if(this.styles.valign==="bottom")x=this.y+this.height-this.padding("bottom");else{var y=this.height-this.padding("vertical");x=this.y+y/2+this.padding("top")}var N;if(this.styles.halign==="right")N=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var S=this.width-this.padding("horizontal");N=this.x+S/2+this.padding("left")}else N=this.x+this.padding("left");return{x:N,y:x}},m.prototype.getContentHeight=function(x,y){y===void 0&&(y=1.15);var N=Array.isArray(this.text)?this.text.length:1,S=this.styles.fontSize/x*y,D=N*S+this.padding("vertical");return Math.max(D,this.styles.minCellHeight)},m.prototype.padding=function(x){var y=(0,p.parseSpacing)(this.styles.cellPadding,0);return x==="vertical"?y.top+y.bottom:x==="horizontal"?y.left+y.right:y[x]},m}();u.Cell=b;var w=function(){function m(x,y,N){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=x,this.raw=y,this.index=N}return m.prototype.getMaxCustomCellWidth=function(x){for(var y=0,N=0,S=x.allRows();N<S.length;N++){var D=S[N],_=D.cells[this.index];_&&typeof _.styles.cellWidth=="number"&&(y=Math.max(y,_.styles.cellWidth))}return y},m}();u.Column=w},356:function(o,u){Object.defineProperty(u,"__esModule",{value:!0}),u.assign=void 0;function c(d,h,p,f,g){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(d),w=1;w<arguments.length;w++){var m=arguments[w];if(m!=null)for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(b[x]=m[x])}return b}u.assign=c},972:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.createTable=void 0;var d=c(744),h=c(260),p=c(324),f=c(796),g=c(356);function b(D,_){var A=new d.DocHandler(D),L=w(_,A.scaleFactor()),P=new h.Table(_,L);return(0,p.calculateWidths)(A,P),A.applyStyles(A.userStyles),P}u.createTable=b;function w(D,_){var A=D.content,L=N(A.columns);if(A.head.length===0){var P=x(L,"head");P&&A.head.push(P)}if(A.foot.length===0){var P=x(L,"foot");P&&A.foot.push(P)}var j=D.settings.theme,E=D.styles;return{columns:L,head:m("head",A.head,L,E,j,_),body:m("body",A.body,L,E,j,_),foot:m("foot",A.foot,L,E,j,_)}}function m(D,_,A,L,P,j){var E={},F=_.map(function(z,U){for(var O=0,B={},q=0,I=0,K=0,Z=A;K<Z.length;K++){var R=Z[K];if(E[R.index]==null||E[R.index].left===0)if(I===0){var H=void 0;Array.isArray(z)?H=z[R.index-q-O]:H=z[R.dataKey];var $={};typeof H=="object"&&!Array.isArray(H)&&($=(H==null?void 0:H.styles)||{});var X=S(D,R,U,P,L,j,$),W=new h.Cell(H,X,D);B[R.dataKey]=W,B[R.index]=W,I=W.colSpan-1,E[R.index]={left:W.rowSpan-1,times:I}}else I--,q++;else E[R.index].left--,I=E[R.index].times,O++}return new h.Row(z,U,D,B)});return F}function x(D,_){var A={};return D.forEach(function(L){if(L.raw!=null){var P=y(_,L.raw);P!=null&&(A[L.dataKey]=P)}}),Object.keys(A).length>0?A:null}function y(D,_){if(D==="head"){if(typeof _=="object")return _.header||_.title||null;if(typeof _=="string"||typeof _=="number")return _}else if(D==="foot"&&typeof _=="object")return _.footer;return null}function N(D){return D.map(function(_,A){var L,P,j;return typeof _=="object"?j=(P=(L=_.dataKey)!==null&&L!==void 0?L:_.key)!==null&&P!==void 0?P:A:j=A,new h.Column(j,_,A)})}function S(D,_,A,L,P,j,E){var F=(0,f.getTheme)(L),z;D==="head"?z=P.headStyles:D==="body"?z=P.bodyStyles:D==="foot"&&(z=P.footStyles);var U=(0,g.assign)({},F.table,F[D],P.styles,z),O=P.columnStyles[_.dataKey]||P.columnStyles[_.index]||{},B=D==="body"?O:{},q=D==="body"&&A%2===0?(0,g.assign)({},F.alternateRow,P.alternateRowStyles):{},I=(0,f.defaultStyles)(j),K=(0,g.assign)({},I,U,q,B);return(0,g.assign)(K,E)}},664:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.addPage=u.drawTable=void 0;var d=c(420),h=c(260),p=c(744),f=c(356),g=c(136),b=c(224);function w(O,B){var q=B.settings,I=q.startY,K=q.margin,Z={x:K.left,y:I},R=B.getHeadHeight(B.columns)+B.getFootHeight(B.columns),H=I+K.bottom+R;if(q.pageBreak==="avoid"){var $=B.body,X=$.reduce(function(ce,ue){return ce+ue.height},0);H+=X}var W=new p.DocHandler(O);(q.pageBreak==="always"||q.startY!=null&&H>W.pageSize().height)&&(U(W),Z.y=K.top),B.callWillDrawPageHooks(W,Z);var ie=(0,f.assign)({},Z);B.startPageNumber=W.pageNumber(),q.horizontalPageBreak?m(W,B,ie,Z):(W.applyStyles(W.userStyles),(q.showHead==="firstPage"||q.showHead==="everyPage")&&B.head.forEach(function(ce){return P(W,B,ce,Z,B.columns)}),W.applyStyles(W.userStyles),B.body.forEach(function(ce,ue){var he=ue===B.body.length-1;L(W,B,ce,he,ie,Z,B.columns)}),W.applyStyles(W.userStyles),(q.showFoot==="lastPage"||q.showFoot==="everyPage")&&B.foot.forEach(function(ce){return P(W,B,ce,Z,B.columns)})),(0,d.addTableBorder)(W,B,ie,Z),B.callEndPageHooks(W,Z),B.finalY=Z.y,O.lastAutoTable=B,O.previousAutoTable=B,O.autoTable&&(O.autoTable.previous=B),W.applyStyles(W.userStyles)}u.drawTable=w;function m(O,B,q,I){var K=(0,b.calculateAllColumnsCanFitInPage)(O,B),Z=B.settings;if(Z.horizontalPageBreakBehaviour==="afterAllRows")K.forEach(function(X,W){O.applyStyles(O.userStyles),W>0?z(O,B,q,I,X.columns,!0):x(O,B,I,X.columns),y(O,B,q,I,X.columns),S(O,B,I,X.columns)});else for(var R=-1,H=K[0],$=function(){var X=R;if(H){O.applyStyles(O.userStyles);var W=H.columns;R>=0?z(O,B,q,I,W,!0):x(O,B,I,W),X=N(O,B,R+1,I,W),S(O,B,I,W)}var ie=X-R;K.slice(1).forEach(function(ce){O.applyStyles(O.userStyles),z(O,B,q,I,ce.columns,!0),N(O,B,R+1,I,ce.columns,ie),S(O,B,I,ce.columns)}),R=X};R<B.body.length-1;)$()}function x(O,B,q,I){var K=B.settings;O.applyStyles(O.userStyles),(K.showHead==="firstPage"||K.showHead==="everyPage")&&B.head.forEach(function(Z){return P(O,B,Z,q,I)})}function y(O,B,q,I,K){O.applyStyles(O.userStyles),B.body.forEach(function(Z,R){var H=R===B.body.length-1;L(O,B,Z,H,q,I,K)})}function N(O,B,q,I,K,Z){O.applyStyles(O.userStyles),Z=Z??B.body.length;var R=Math.min(q+Z,B.body.length),H=-1;return B.body.slice(q,R).forEach(function($,X){var W=q+X===B.body.length-1,ie=F(O,B,W,I);$.canEntireRowFit(ie,K)&&(P(O,B,$,I,K),H=q+X)}),H}function S(O,B,q,I){var K=B.settings;O.applyStyles(O.userStyles),(K.showFoot==="lastPage"||K.showFoot==="everyPage")&&B.foot.forEach(function(Z){return P(O,B,Z,q,I)})}function D(O,B,q){var I=q.getLineHeight(O.styles.fontSize),K=O.padding("vertical"),Z=Math.floor((B-K)/I);return Math.max(0,Z)}function _(O,B,q,I){var K={};O.spansMultiplePages=!0,O.height=0;for(var Z=0,R=0,H=q.columns;R<H.length;R++){var $=H[R],X=O.cells[$.index];if(X){Array.isArray(X.text)||(X.text=[X.text]);var W=new h.Cell(X.raw,X.styles,X.section);W=(0,f.assign)(W,X),W.text=[];var ie=D(X,B,I);X.text.length>ie&&(W.text=X.text.splice(ie,X.text.length));var ce=I.scaleFactor(),ue=I.getLineHeightFactor();X.contentHeight=X.getContentHeight(ce,ue),X.contentHeight>=B&&(X.contentHeight=B,W.styles.minCellHeight-=B),X.contentHeight>O.height&&(O.height=X.contentHeight),W.contentHeight=W.getContentHeight(ce,ue),W.contentHeight>Z&&(Z=W.contentHeight),K[$.index]=W}}var he=new h.Row(O.raw,-1,O.section,K,!0);he.height=Z;for(var ge=0,Ee=q.columns;ge<Ee.length;ge++){var $=Ee[ge],W=he.cells[$.index];W&&(W.height=he.height);var X=O.cells[$.index];X&&(X.height=O.height)}return he}function A(O,B,q,I){var K=O.pageSize().height,Z=I.settings.margin,R=Z.top+Z.bottom,H=K-R;B.section==="body"&&(H-=I.getHeadHeight(I.columns)+I.getFootHeight(I.columns));var $=B.getMinimumRowHeight(I.columns,O),X=$<q;if($>H)return console.error("Will not be able to print row ".concat(B.index," correctly since it's minimum height is larger than page height")),!0;if(!X)return!1;var W=B.hasRowSpan(I.columns),ie=B.getMaxCellHeight(I.columns)>H;return ie?(W&&console.error("The content of row ".concat(B.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(W||I.settings.rowPageBreak==="avoid")}function L(O,B,q,I,K,Z,R){var H=F(O,B,I,Z);if(q.canEntireRowFit(H,R))P(O,B,q,Z,R);else if(A(O,q,H,B)){var $=_(q,H,B,O);P(O,B,q,Z,R),z(O,B,K,Z,R),L(O,B,$,I,K,Z,R)}else z(O,B,K,Z,R),L(O,B,q,I,K,Z,R)}function P(O,B,q,I,K){I.x=B.settings.margin.left;for(var Z=0,R=K;Z<R.length;Z++){var H=R[Z],$=q.cells[H.index];if(!$){I.x+=H.width;continue}O.applyStyles($.styles),$.x=I.x,$.y=I.y;var X=B.callCellHooks(O,B.hooks.willDrawCell,$,q,H,I);if(X===!1){I.x+=H.width;continue}j(O,$,I);var W=$.getTextPos();(0,g.default)($.text,W.x,W.y,{halign:$.styles.halign,valign:$.styles.valign,maxWidth:Math.ceil($.width-$.padding("left")-$.padding("right"))},O.getDocument()),B.callCellHooks(O,B.hooks.didDrawCell,$,q,H,I),I.x+=H.width}I.y+=q.height}function j(O,B,q){var I=B.styles;if(O.getDocument().setFillColor(O.getDocument().getFillColor()),typeof I.lineWidth=="number"){var K=(0,d.getFillStyle)(I.lineWidth,I.fillColor);K&&O.rect(B.x,q.y,B.width,B.height,K)}else typeof I.lineWidth=="object"&&(I.fillColor&&O.rect(B.x,q.y,B.width,B.height,"F"),E(O,B,q,I.lineWidth))}function E(O,B,q,I){var K,Z,R,H;I.top&&(K=q.x,Z=q.y,R=q.x+B.width,H=q.y,I.right&&(R+=.5*I.right),I.left&&(K-=.5*I.left),$(I.top,K,Z,R,H)),I.bottom&&(K=q.x,Z=q.y+B.height,R=q.x+B.width,H=q.y+B.height,I.right&&(R+=.5*I.right),I.left&&(K-=.5*I.left),$(I.bottom,K,Z,R,H)),I.left&&(K=q.x,Z=q.y,R=q.x,H=q.y+B.height,I.top&&(Z-=.5*I.top),I.bottom&&(H+=.5*I.bottom),$(I.left,K,Z,R,H)),I.right&&(K=q.x+B.width,Z=q.y,R=q.x+B.width,H=q.y+B.height,I.top&&(Z-=.5*I.top),I.bottom&&(H+=.5*I.bottom),$(I.right,K,Z,R,H));function $(X,W,ie,ce,ue){O.getDocument().setLineWidth(X),O.getDocument().line(W,ie,ce,ue,"S")}}function F(O,B,q,I){var K=B.settings.margin.bottom,Z=B.settings.showFoot;return(Z==="everyPage"||Z==="lastPage"&&q)&&(K+=B.getFootHeight(B.columns)),O.pageSize().height-I.y-K}function z(O,B,q,I,K,Z){K===void 0&&(K=[]),Z===void 0&&(Z=!1),O.applyStyles(O.userStyles),B.settings.showFoot==="everyPage"&&!Z&&B.foot.forEach(function(H){return P(O,B,H,I,K)}),B.callEndPageHooks(O,I);var R=B.settings.margin;(0,d.addTableBorder)(O,B,q,I),U(O),B.pageNumber++,B.pageCount++,I.x=R.left,I.y=R.top,q.y=R.top,B.callWillDrawPageHooks(O,I),B.settings.showHead==="everyPage"&&(B.head.forEach(function(H){return P(O,B,H,I,K)}),O.applyStyles(O.userStyles))}u.addPage=z;function U(O){var B=O.pageNumber();O.setPage(B+1);var q=O.pageNumber();return q===B?(O.addPage(),!0):!1}},224:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.calculateAllColumnsCanFitInPage=void 0;var d=c(420);function h(f,g,b){var w;b===void 0&&(b={});var m=(0,d.getPageAvailableWidth)(f,g),x=new Map,y=[],N=[],S=[];g.settings.horizontalPageBreakRepeat,Array.isArray(g.settings.horizontalPageBreakRepeat)?S=g.settings.horizontalPageBreakRepeat:(typeof g.settings.horizontalPageBreakRepeat=="string"||typeof g.settings.horizontalPageBreakRepeat=="number")&&(S=[g.settings.horizontalPageBreakRepeat]),S.forEach(function(L){var P=g.columns.find(function(j){return j.dataKey===L||j.index===L});P&&!x.has(P.index)&&(x.set(P.index,!0),y.push(P.index),N.push(g.columns[P.index]),m-=P.wrappedWidth)});for(var D=!0,_=(w=b==null?void 0:b.start)!==null&&w!==void 0?w:0;_<g.columns.length;){if(x.has(_)){_++;continue}var A=g.columns[_].wrappedWidth;if(D||m>=A)D=!1,y.push(_),N.push(g.columns[_]),m-=A;else break;_++}return{colIndexes:y,columns:N,lastIndex:_-1}}function p(f,g){for(var b=[],w=0;w<g.columns.length;w++){var m=h(f,g,{start:w});m.columns.length&&(b.push(m),w=m.lastIndex)}return b}u.calculateAllColumnsCanFitInPage=p},324:function(o,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.ellipsize=u.resizeColumns=u.calculateWidths=void 0;var d=c(420);function h(y,N){p(y,N);var S=[],D=0;N.columns.forEach(function(A){var L=A.getMaxCustomCellWidth(N);L?A.width=L:(A.width=A.wrappedWidth,S.push(A)),D+=A.width});var _=N.getWidth(y.pageSize().width)-D;_&&(_=f(S,_,function(A){return Math.max(A.minReadableWidth,A.minWidth)})),_&&(_=f(S,_,function(A){return A.minWidth})),_=Math.abs(_),!N.settings.horizontalPageBreak&&_>.1/y.scaleFactor()&&(_=_<1?_:Math.round(_),console.warn("Of the table content, ".concat(_," units width could not fit page"))),b(N),w(N,y),g(N)}u.calculateWidths=h;function p(y,N){var S=y.scaleFactor(),D=N.settings.horizontalPageBreak,_=(0,d.getPageAvailableWidth)(y,N);N.allRows().forEach(function(A){for(var L=0,P=N.columns;L<P.length;L++){var j=P[L],E=A.cells[j.index];if(E){var F=N.hooks.didParseCell;N.callCellHooks(y,F,E,A,j,null);var z=E.padding("horizontal");E.contentWidth=(0,d.getStringWidth)(E.text,E.styles,y)+z;var U=(0,d.getStringWidth)(E.text.join(" ").split(/[^\S\u00A0]+/),E.styles,y);if(E.minReadableWidth=U+E.padding("horizontal"),typeof E.styles.cellWidth=="number")E.minWidth=E.styles.cellWidth,E.wrappedWidth=E.styles.cellWidth;else if(E.styles.cellWidth==="wrap"||D===!0)E.contentWidth>_?(E.minWidth=_,E.wrappedWidth=_):(E.minWidth=E.contentWidth,E.wrappedWidth=E.contentWidth);else{var O=10/S;E.minWidth=E.styles.minCellWidth||O,E.wrappedWidth=E.contentWidth,E.minWidth>E.wrappedWidth&&(E.wrappedWidth=E.minWidth)}}}}),N.allRows().forEach(function(A){for(var L=0,P=N.columns;L<P.length;L++){var j=P[L],E=A.cells[j.index];if(E&&E.colSpan===1)j.wrappedWidth=Math.max(j.wrappedWidth,E.wrappedWidth),j.minWidth=Math.max(j.minWidth,E.minWidth),j.minReadableWidth=Math.max(j.minReadableWidth,E.minReadableWidth);else{var F=N.styles.columnStyles[j.dataKey]||N.styles.columnStyles[j.index]||{},z=F.cellWidth||F.minCellWidth;z&&typeof z=="number"&&(j.minWidth=z,j.wrappedWidth=z)}E&&(E.colSpan>1&&!j.minWidth&&(j.minWidth=E.minWidth),E.colSpan>1&&!j.wrappedWidth&&(j.wrappedWidth=E.minWidth))}})}function f(y,N,S){for(var D=N,_=y.reduce(function(O,B){return O+B.wrappedWidth},0),A=0;A<y.length;A++){var L=y[A],P=L.wrappedWidth/_,j=D*P,E=L.width+j,F=S(L),z=E<F?F:E;N-=z-L.width,L.width=z}if(N=Math.round(N*1e10)/1e10,N){var U=y.filter(function(O){return N<0?O.width>S(O):!0});U.length&&(N=f(U,N,S))}return N}u.resizeColumns=f;function g(y){for(var N={},S=1,D=y.allRows(),_=0;_<D.length;_++)for(var A=D[_],L=0,P=y.columns;L<P.length;L++){var j=P[L],E=N[j.index];if(S>1)S--,delete A.cells[j.index];else if(E)E.cell.height+=A.height,S=E.cell.colSpan,delete A.cells[j.index],E.left--,E.left<=1&&delete N[j.index];else{var F=A.cells[j.index];if(!F)continue;if(F.height=A.height,F.rowSpan>1){var z=D.length-_,U=F.rowSpan>z?z:F.rowSpan;N[j.index]={cell:F,left:U,row:A}}}}}function b(y){for(var N=y.allRows(),S=0;S<N.length;S++)for(var D=N[S],_=null,A=0,L=0,P=0;P<y.columns.length;P++){var j=y.columns[P];if(L-=1,L>1&&y.columns[P+1])A+=j.width,delete D.cells[j.index];else if(_){var E=_;delete D.cells[j.index],_=null,E.width=j.width+A}else{var E=D.cells[j.index];if(!E)continue;if(L=E.colSpan,A=0,E.colSpan>1){_=E,A+=j.width;continue}E.width=j.width+A}}}function w(y,N){for(var S={count:0,height:0},D=0,_=y.allRows();D<_.length;D++){for(var A=_[D],L=0,P=y.columns;L<P.length;L++){var j=P[L],E=A.cells[j.index];if(E){N.applyStyles(E.styles,!0);var F=E.width-E.padding("horizontal");if(E.styles.overflow==="linebreak")E.text=N.splitTextToSize(E.text,F+1/N.scaleFactor(),{fontSize:E.styles.fontSize});else if(E.styles.overflow==="ellipsize")E.text=m(E.text,F,E.styles,N,"...");else if(E.styles.overflow==="hidden")E.text=m(E.text,F,E.styles,N,"");else if(typeof E.styles.overflow=="function"){var z=E.styles.overflow(E.text,F);typeof z=="string"?E.text=[z]:E.text=z}E.contentHeight=E.getContentHeight(N.scaleFactor(),N.getLineHeightFactor());var U=E.contentHeight/E.rowSpan;E.rowSpan>1&&S.count*S.height<U*E.rowSpan?S={height:U,count:E.rowSpan}:S&&S.count>0&&S.height>U&&(U=S.height),U>A.height&&(A.height=U)}}S.count--}}function m(y,N,S,D,_){return y.map(function(A){return x(A,N,S,D,_)})}u.ellipsize=m;function x(y,N,S,D,_){var A=1e4*D.scaleFactor();if(N=Math.ceil(N*A)/A,N>=(0,d.getStringWidth)(y,S,D))return y;for(;N<(0,d.getStringWidth)(y+_,S,D)&&!(y.length<=1);)y=y.substring(0,y.length-1);return y.trim()+_}},964:function(o){if(typeof n>"u"){var u=new Error("Cannot find module 'undefined'");throw u.code="MODULE_NOT_FOUND",u}o.exports=n}},r={};function i(o){var u=r[o];if(u!==void 0)return u.exports;var c=r[o]={exports:{}};return a[o].call(c.exports,c,c.exports,i),c.exports}var s={};return function(){var o=s;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var u=i(340),c=i(776),d=i(664),h=i(972),p=i(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return p.Table}});var f=i(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return f.CellHookData}});var g=i(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return g.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return g.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return g.Row}});function b(N){(0,u.default)(N)}o.applyPlugin=b;function w(N,S){var D=(0,c.parseInput)(N,S),_=(0,h.createTable)(N,D);(0,d.drawTable)(N,_)}function m(N,S){var D=(0,c.parseInput)(N,S);return(0,h.createTable)(N,D)}o.__createTable=m;function x(N,S){(0,d.drawTable)(N,S)}o.__drawTable=x;try{var y=i(964);y.jsPDF&&(y=y.jsPDF),b(y)}catch{}o.default=w}(),s}()})})(m$);const v$=({employee:e,onClose:t,onGenerated:n,issuedByUserId:a})=>{if(!e||!e.name||!a)return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 text-center",children:[l.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Data Tidak Lengkap"}),l.jsxs("p",{className:"text-gray-700 mb-6",children:["Tidak dapat menampilkan form surat peringatan.",l.jsx("br",{}),"Pastikan data karyawan dan user pengeluar surat sudah benar."]}),l.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded-lg",children:"Tutup"})]})});const[r,i]=ae.useState("SP1"),[s,o]=ae.useState(""),[u,c]=ae.useState(""),[d,h]=ae.useState(!1),[p,f]=ae.useState(null),[g,b]=ae.useState(!1),w=[{value:"SP1",label:"Surat Peringatan 1",color:"yellow"},{value:"SP2",label:"Surat Peringatan 2",color:"orange"},{value:"SP3",label:"Surat Peringatan 3",color:"red"},{value:"termination",label:"Surat Pemberhentian",color:"red"}],m=["Keterlambatan berulang","Tidak hadir tanpa keterangan","Melanggar peraturan perusahaan","Kinerja tidak memuaskan","Tidak mengikuti prosedur kerja","Pelanggaran disiplin kerja"],x=async()=>{if(!s.trim()){ct.fire({icon:"warning",title:"Alasan wajib diisi",text:"Alasan peringatan harus diisi."});return}if(!a){ct.fire({icon:"error",title:"Gagal",text:"Tidak dapat menentukan pengguna yang mengeluarkan surat."});return}h(!0);try{const{data:_,error:A}=await Pe.rpc("generate_warning_letter",{p_user_id:e.id,p_warning_type:r,p_reason:s,p_description:u,p_issued_by:a});if(A)throw A;const{data:L,error:P}=await Pe.from("warning_letters").select("*").eq("id",_).single();if(P)throw P;f(L),n&&n(L),b(!0)}catch(_){console.error("Error generating warning letter:",_),ct.fire({icon:"error",title:"Gagal",text:"Gagal membuat surat peringatan: "+_.message})}finally{h(!1)}},y=()=>{if(!p){ct.fire({icon:"error",title:"Gagal",text:"Surat belum digenerate."});return}try{const _=new yt;_.setFontSize(16),_.setFont("helvetica","bold"),_.text("PT. COMPANY NAME",105,20,{align:"center"}),_.setFontSize(12),_.setFont("helvetica","normal"),_.text("Jl. Contoh Alamat No. 123, Jakarta Selatan",105,28,{align:"center"}),_.text("Telp: (021) 1234-5678 | Email: info@company.com",105,34,{align:"center"}),_.setLineWidth(.5),_.line(20,38,190,38),_.setFontSize(14),_.setFont("helvetica","bold"),_.text(`SURAT PERINGATAN ${p.warning_type}`,105,50,{align:"center"}),_.setFontSize(12),_.text(`Nomor: ${p.letter_number}`,105,58,{align:"center"}),_.setFontSize(12),_.setFont("helvetica","normal"),_.text("Kepada Yth:",20,70),_.text(`Nama: ${e.name}`,20,78),_.text(`Jabatan: ${e.title||"Karyawan"}`,20,86),_.text(`Departemen: ${e.department||"-"}`,20,94),_.text(`Tanggal: ${new Date(p.issue_date).toLocaleDateString("id-ID")}`,20,102),_.text("Dengan ini kami memberikan surat peringatan dengan alasan:",20,116);const A=_.splitTextToSize(p.reason,150);_.setFont("helvetica","bold"),_.text(A,30,124);let L=124+A.length*8;if(p.description){_.setFont("helvetica","normal");const E=_.splitTextToSize(p.description,150);_.text(E,20,L),L+=E.length*8+8}else L+=16;_.setFont("helvetica","normal");const j=_.splitTextToSize("Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama. Apabila pelanggaran ini terulang kembali, maka perusahaan akan mengambil tindakan lebih lanjut sesuai dengan peraturan perusahaan yang berlaku.",170);_.text(j,20,L),L+=j.length*8+16,_.text("Demikian surat peringatan ini dibuat untuk dapat diperhatikan dan dilaksanakan dengan sebaik-baiknya.",20,L),L+=24,_.text("Hormat kami,",20,L),_.text("Manajemen Perusahaan",20,L+8),L+=40,_.text("_____________________",20,L),_.text("Tanda Tangan & Stempel",20,L+8),_.text("Diterima oleh,",140,L-40),_.text("Karyawan",140,L-32),_.text("_____________________",140,L),_.text(`(${e.name})`,140,L+8),_.save(`SP_${p.warning_type}_${e.name}_${p.letter_number.replace(/\//g,"_")}.pdf`)}catch(_){console.error("Error generating PDF:",_),alert("Gagal membuat file PDF: "+_.message)}},N=()=>{if(!p)return;const _=`
SURAT PERINGATAN ${p.warning_type}
Nomor: ${p.letter_number}

Kepada: ${e.name}
Jabatan: ${e.title||"Karyawan"}
Tanggal: ${new Date(p.issue_date).toLocaleDateString("id-ID")}

Dengan ini kami memberikan surat peringatan ${p.warning_type} atas:
${p.reason}

${p.description}

Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama.

Apabila pelanggaran ini terulang kembali, maka perusahaan akan mengambil tindakan lebih lanjut sesuai dengan peraturan perusahaan yang berlaku.

Demikian surat peringatan ini dibuat untuk dapat diperhatikan dan dilaksanakan dengan sebaik-baiknya.

Hormat kami,
Manajemen Perusahaan


_____________________
Tanda Tangan & Stempel
    `,A=new Blob([_],{type:"text/plain"}),L=URL.createObjectURL(A),P=document.createElement("a");P.href=L,P.download=`SP_${p.warning_type}_${e.name}_${p.letter_number.replace(/\//g,"_")}.txt`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(L)},S=_=>{const A=w.find(L=>L.value===_);return(A==null?void 0:A.color)||"gray"},D=()=>{if(!p)return;const _=window.open("","_blank");_.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Surat Peringatan ${p.warning_type}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 40px;
            line-height: 1.5;
          }
          .header {
            text-align: center;
            margin-bottom: 30px;
          }
          .company-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .company-address {
            font-size: 14px;
            margin-bottom: 5px;
          }
          .divider {
            border-top: 2px solid #000;
            margin: 20px 0;
          }
          .letter-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .letter-number {
            text-align: center;
            font-size: 14px;
            margin-bottom: 30px;
          }
          .recipient {
            margin-bottom: 20px;
          }
          .content {
            margin-bottom: 30px;
          }
          .reason {
            margin-left: 20px;
            font-weight: bold;
            margin-bottom: 20px;
          }
          .description {
            margin-bottom: 20px;
          }
          .warning {
            margin-bottom: 30px;
          }
          .closing {
            margin-bottom: 30px;
          }
          .signature {
            display: flex;
            justify-content: space-between;
          }
          .signature-block {
            width: 45%;
          }
          .signature-line {
            border-top: 1px solid #000;
            margin-top: 50px;
            width: 80%;
          }
          @media print {
            .no-print {
              display: none;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">PT. COMPANY NAME</div>
          <div class="company-address">Jl. Contoh Alamat No. 123, Jakarta Selatan</div>
          <div class="company-address">Telp: (021) 1234-5678 | Email: info@company.com</div>
        </div>
        
        <div class="divider"></div>
        
        <div class="letter-title">SURAT PERINGATAN ${p.warning_type}</div>
        <div class="letter-number">Nomor: ${p.letter_number}</div>
        
        <div class="recipient">
          <div>Kepada Yth:</div>
          <div>Nama: ${e.name}</div>
          <div>Jabatan: ${e.title||"Karyawan"}</div>
          <div>Departemen: ${e.department||"-"}</div>
          <div>Tanggal: ${new Date(p.issue_date).toLocaleDateString("id-ID")}</div>
        </div>
        
        <div class="content">
          <div>Dengan ini kami memberikan surat peringatan dengan alasan:</div>
          <div class="reason">${p.reason}</div>
          
          ${p.description?`<div class="description">${p.description}</div>`:""}
          
          <div class="warning">
            Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama. 
            Apabila pelanggaran ini terulang kembali, maka perusahaan akan mengambil tindakan lebih lanjut 
            sesuai dengan peraturan perusahaan yang berlaku.
          </div>
          
          <div class="closing">
            Demikian surat peringatan ini dibuat untuk dapat diperhatikan dan dilaksanakan dengan sebaik-baiknya.
          </div>
        </div>
        
        <div class="signature">
          <div class="signature-block">
            <div>Hormat kami,</div>
            <div>Manajemen Perusahaan</div>
            <div class="signature-line"></div>
            <div>Tanda Tangan & Stempel</div>
          </div>
          
          <div class="signature-block">
            <div>Diterima oleh,</div>
            <div>Karyawan</div>
            <div class="signature-line"></div>
            <div>(${e.name})</div>
          </div>
        </div>
        
        <div class="no-print" style="text-align: center; margin-top: 30px;">
          <button onclick="window.print()" style="padding: 10px 20px; background: #4F46E5; color: white; border: none; border-radius: 5px; cursor: pointer;">
            Print Surat Peringatan
          </button>
        </div>
      </body>
      </html>
    `),_.document.close(),_.onload=function(){_.focus(),setTimeout(()=>{_.print()},500)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Bl,{className:"h-6 w-6 text-red-600"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Buat Surat Peringatan"})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ui,{className:"h-6 w-6"})})]}),g?l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Bl,{className:"h-6 w-6 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-green-800 font-medium",children:"Surat Peringatan Berhasil Dibuat"}),l.jsxs("p",{className:"text-green-700 text-sm",children:["Nomor: ",p.letter_number]})]})]})}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["SURAT PERINGATAN ",p.warning_type]}),l.jsxs("p",{className:"text-gray-600",children:["Nomor: ",p.letter_number]})]}),l.jsxs("div",{className:"space-y-4 text-sm",children:[l.jsxs("div",{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Kepada:"})," ",e.name]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Jabatan:"})," ",e.title||"Karyawan"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tanggal:"})," ",new Date(p.issue_date).toLocaleDateString("id-ID")]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsxs("p",{className:"mb-2",children:["Dengan ini kami memberikan surat peringatan ",p.warning_type," atas:"]}),l.jsx("p",{className:"font-medium",children:p.reason})]}),p.description&&l.jsx("div",{className:"border-t pt-4",children:l.jsx("p",{children:p.description})}),l.jsx("div",{className:"border-t pt-4",children:l.jsx("p",{children:"Harap untuk lebih memperhatikan kedisiplinan kerja dan tidak mengulangi pelanggaran yang sama."})})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Tutup"}),l.jsx("button",{onClick:N,className:"px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(cp,{className:"h-4 w-4"}),l.jsx("span",{children:"Download TXT"})]})}),l.jsx("button",{onClick:y,className:"px-4 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:"Download PDF"})]})}),l.jsx("button",{onClick:D,className:"px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(bT,{className:"h-4 w-4"}),l.jsx("span",{children:"Print Surat"})]})}),l.jsx("button",{onClick:()=>ct.fire({icon:"info",title:"Segera Tersedia",text:"Fitur kirim email akan segera tersedia."}),className:"px-4 py-3 bg-yellow-600 text-white rounded-lg font-medium hover:bg-yellow-700 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ev,{className:"h-4 w-4"}),l.jsx("span",{children:"Kirim Email"})]})})]})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Informasi Karyawan"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Nama:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Jabatan:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.title||"Karyawan"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Departemen:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.department||"-"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"ID:"}),l.jsx("span",{className:"ml-2 font-medium",children:e.employee_id||"-"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Jenis Peringatan"}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:w.map(_=>l.jsx("button",{type:"button",onClick:()=>i(_.value),className:`p-3 rounded-lg border-2 transition-all text-left ${r===_.value?`border-${_.color}-500 bg-${_.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Pn,{className:`h-4 w-4 text-${_.color}-500`}),l.jsx("span",{className:"font-medium",children:_.label})]})},_.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alasan Peringatan *"}),l.jsxs("select",{value:s,onChange:_=>o(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-2",children:[l.jsx("option",{value:"",children:"Pilih alasan..."}),m.map(_=>l.jsx("option",{value:_,children:_},_)),l.jsx("option",{value:"custom",children:"Alasan lainnya..."})]}),(s==="custom"||!m.includes(s))&&l.jsx("input",{type:"text",value:s==="custom"?"":s,onChange:_=>o(_.target.value),placeholder:"Masukkan alasan peringatan...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Tambahan"}),l.jsx("textarea",{value:u,onChange:_=>c(_.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Jelaskan detail pelanggaran atau tindakan yang diharapkan..."})]}),l.jsx("div",{className:`p-4 rounded-lg border-l-4 border-${S(r)}-500 bg-${S(r)}-50`,children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Pn,{className:`h-5 w-5 text-${S(r)}-600 flex-shrink-0 mt-0.5`}),l.jsxs("div",{children:[l.jsx("p",{className:`text-${S(r)}-800 font-medium`,children:"Peringatan Penting"}),l.jsx("p",{className:`text-${S(r)}-700 text-sm mt-1`,children:"Surat peringatan akan dikirim ke karyawan dan tersimpan dalam sistem. Pastikan informasi yang dimasukkan sudah benar."})]})]})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"button",onClick:x,disabled:!s.trim()||d,className:"flex-1 bg-red-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Membuat Surat..."})]}):l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(zg,{className:"h-4 w-4"}),l.jsx("span",{children:"Buat & Kirim Surat"})]})})]})]})]})})})},eu=({user:e,profile:t,isCollapsed:n,setIsCollapsed:a})=>{const r=wr(),i=S2(),[s,o]=ae.useState(!1),u=async()=>{try{await Pe.auth.signOut(),await window.Swal.fire({icon:"success",title:"Logout Berhasil",text:"Anda telah berhasil logout."}),r("/login")}catch(f){console.error("Failed to log out:",f)}},c=[{title:"Dashboard",icon:l.jsx(yT,{className:"h-5 w-5"}),path:"/admin",active:i.pathname==="/admin"},{title:"Master Data",icon:l.jsx(cf,{className:"h-5 w-5"}),submenu:[{title:"Kelola Pengguna",icon:l.jsx(oS,{className:"h-5 w-5"}),path:"/admin/users",active:i.pathname==="/admin/users"},{title:"Kelola Departemen",icon:l.jsx(ya,{className:"h-5 w-5"}),path:"/admin/departments",active:i.pathname==="/admin/departments"},{title:"Kelola Jabatan",icon:l.jsx(df,{className:"h-5 w-5"}),path:"/admin/positions",active:i.pathname==="/admin/positions"},{title:"Kelola Bank",icon:l.jsx(cf,{className:"h-5 w-5"}),path:"/admin/bank",active:i.pathname==="/admin/bank"}]},{title:"Kelola Absensi",icon:l.jsx(Uu,{className:"h-5 w-5"}),path:"/admin/attendance",active:i.pathname==="/admin/attendance"},{title:"Kelola Pembayaran",icon:l.jsx(qu,{className:"h-5 w-5"}),path:"/admin/salary-payment",active:i.pathname==="/admin/salary-payment"},{title:"Lokasi Kantor",icon:l.jsx(qi,{className:"h-5 w-5"}),path:"/admin/location",active:i.pathname==="/admin/location"}],[d,h]=ae.useState(["Master Data"]),p=f=>{h(g=>g.includes(f)?g.filter(b=>b!==f):[...g,f])};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50 print:hidden",children:l.jsx("button",{onClick:()=>o(!s),className:"p-2 rounded-lg bg-white shadow-lg text-gray-600 hover:bg-gray-200 transition-colors",children:s?l.jsx(Ui,{className:"h-6 w-6"}):l.jsx(wT,{className:"h-6 w-6"})})}),l.jsx("div",{className:`lg:hidden fixed inset-0 bg-black/60 z-40 transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>o(!1)}),l.jsx("div",{className:`fixed inset-y-0 left-0 z-40 bg-white shadow-2xl transition-all duration-300 ease-in-out
          ${n?"w-16":"w-64"}
          ${s?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          max-w-xs lg:max-w-none print:hidden
        `,children:l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between h-16 bg-gradient-to-r from-blue-700 to-indigo-600 text-white px-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ya,{className:"h-7 w-7 flex-shrink-0"}),!n&&l.jsx("span",{className:"ml-2 text-lg font-semibold tracking-tight",children:"   Admin Panel"})]}),l.jsx("button",{onClick:()=>a(!n),className:"hidden lg:block p-1 rounded-full hover:bg-blue-800 transition-colors",children:l.jsx(_1,{className:`h-5 w-5 transform transition-transform ${n?"rotate-180":""}`})})]}),l.jsxs("div",{className:`flex items-center ${n?"justify-center py-3":"px-4 py-4"} border-b border-gray-200 bg-gray-50/50`,children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center overflow-hidden",children:t!=null&&t.avatar_url?l.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-full h-full object-cover"}):l.jsx(Fl,{className:"h-6 w-6 text-blue-600"})}),!n&&l.jsxs("div",{className:"ml-3 overflow-hidden",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.name)||"Admin"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:(t==null?void 0:t.email)||(e==null?void 0:e.email)})]})]}),l.jsx("nav",{className:"flex-1 overflow-y-auto py-4 px-2 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:l.jsx("ul",{className:"space-y-1",children:c.map(f=>l.jsx("li",{children:f.submenu?l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>p(f.title),className:`w-full flex items-center ${n?"justify-center":"justify-between px-3"} py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200`,children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500",children:f.icon}),!n&&l.jsx("span",{className:"ml-3",children:f.title})]}),!n&&l.jsx(_1,{className:`h-4 w-4 text-gray-400 transform transition-transform duration-200 ${d.includes(f.title)?"rotate-90":""}`})]}),!n&&d.includes(f.title)&&l.jsx("ul",{className:"ml-4 space-y-1 mt-1",children:f.submenu.map(g=>l.jsx("li",{children:l.jsxs("button",{onClick:()=>{r(g.path),window.innerWidth<1024&&o(!1)},className:`w-full flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200
                                  ${g.active?"text-blue-600 bg-blue-50 font-semibold":"text-gray-600 hover:bg-gray-100"}`,children:[l.jsx("span",{className:`${g.active?"text-blue-600":"text-gray-400"}`,children:g.icon}),l.jsx("span",{className:"ml-3",children:g.title})]})},g.path))})]}):l.jsxs("button",{onClick:()=>{r(f.path),window.innerWidth<1024&&o(!1)},className:`w-full flex items-center ${n?"justify-center":"justify-start px-3"} py-2.5 text-sm font-medium rounded-lg transition-colors duration-200
                        ${f.active?"text-blue-600 bg-blue-50 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx("span",{className:`${f.active?"text-blue-600":"text-gray-500"}`,children:f.icon}),!n&&l.jsx("span",{className:"ml-3",children:f.title})]})},f.title))})}),l.jsx("div",{className:"p-3 border-t border-gray-200",children:l.jsxs("button",{onClick:u,className:`w-full flex items-center ${n?"justify-center":"justify-start px-3"} py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200`,children:[l.jsx(cS,{className:"h-5 w-5"}),!n&&l.jsx("span",{className:"ml-3",children:"Logout"})]})})]})})]})},x$=()=>{var $;const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState({totalUsers:0,totalAttendance:0,todayAttendance:0,activeUsers:0,totalSalaryPaid:0,avgDailySalary:0,lateEmployees:0,activeWarnings:0,totalPositions:0,activeDepartments:0,absentToday:0}),[h,p]=ae.useState([]),[f,g]=ae.useState([]),[b,w]=ae.useState([]),[m,x]=ae.useState({}),[y,N]=ae.useState(!1),[S,D]=ae.useState(null),[_,A]=ae.useState(!1),[L,P]=ae.useState(!1),[j,E]=ae.useState(!1),[F,z]=ae.useState({enabled:!0,required_for_admin:!1});ae.useEffect(()=>{U()},[]);const U=async()=>{try{const{data:{user:X}}=await Pe.auth.getUser();if(!X){e("/login");return}const{data:W}=await Pe.from("profiles").select("*").eq("id",X.id).single();if(!W||W.role!=="admin"){e("/dashboard");return}n(X),r(W),await O()}catch(X){console.error("Error checking access:",X),e("/login")}finally{s(!1)}},O=async()=>{var X,W;try{const ie=new Date().toISOString().split("T")[0],[ce,ue,he,ge]=await Promise.all([Pe.from("profiles").select("id, role, status",{count:"exact"}),Pe.from("attendance").select("id",{count:"exact"}),Pe.from("attendance").select("*").gte("timestamp",`${ie}T00:00:00`).lte("timestamp",`${ie}T23:59:59`),Pe.from("positions").select("id, department",{count:"exact"})]),{data:Ee}=await Pe.from("profiles").select("id, name, email, avatar_url, employee_id, department, role, status").eq("role","karyawan").eq("status","active"),{data:Te}=await Pe.from("attendance").select(`
          *,
          profiles!inner(id, name, email, avatar_url, employee_id, department, role)
        `).gte("timestamp",`${ie}T00:00:00`).lte("timestamp",`${ie}T23:59:59`).eq("status","berhasil"),fe=(Te==null?void 0:Te.filter(Je=>Je.type==="masuk").map(Je=>Je.user_id))||[],me=(Ee==null?void 0:Ee.filter(Je=>!fe.includes(Je.id)&&Je.role!=="admin"))||[];if(me.length>0){const Je=me.map(le=>({user_id:le.id,type:"absent",timestamp:new Date().toISOString(),status:"tidak_hadir",notes:"Tidak hadir - tidak melakukan absensi masuk",is_late:!1,late_minutes:0,work_hours:0}));await Pe.from("attendance").upsert(Je,{onConflict:"user_id,timestamp",ignoreDuplicates:!0})}const ne=(Te==null?void 0:Te.filter(Je=>Je.type==="masuk"&&Je.is_late))||[],{data:De}=await Pe.from("employee_salaries").select("daily_salary").eq("is_active",!0),Oe=(De==null?void 0:De.reduce((Je,le)=>Je+le.daily_salary*22,0))||0,ke=(De==null?void 0:De.length)>0?De.reduce((Je,le)=>Je+le.daily_salary,0)/De.length:0,{data:xe}=await Pe.from("attendance_warnings").select("id").eq("is_resolved",!1),Ae=[...new Set((X=ge.data)==null?void 0:X.map(Je=>Je.department).filter(Boolean))];d({totalUsers:ce.count||0,totalAttendance:ue.count||0,todayAttendance:fe.length,activeUsers:((W=ce.data)==null?void 0:W.filter(Je=>Je.status==="active").length)||0,totalSalaryPaid:Oe,avgDailySalary:ke,lateEmployees:ne.length,activeWarnings:(xe==null?void 0:xe.length)||0,totalPositions:ge.count||0,activeDepartments:Ae.length,absentToday:me.length}),g(ne),w(me);const{data:Ce}=await Pe.from("attendance").select(`
          *,
          profiles!inner(name, role, department, avatar_url, employee_id)
        `).order("timestamp",{ascending:!1}).limit(15);p(Ce||[]);const{data:He}=await Pe.from("system_settings").select("*"),Qe={};He==null||He.forEach(Je=>{Qe[Je.setting_key]=Je.setting_value}),x(Qe);const Ze=He==null?void 0:He.find(Je=>Je.setting_key==="camera_verification");Ze!=null&&Ze.setting_value&&z(Ze.setting_value)}catch(ie){console.error("Error fetching dashboard data:",ie)}},B=async()=>{try{const{error:X}=await Pe.from("system_settings").upsert({setting_key:"camera_verification",setting_value:{...F,updated_by:t.id,updated_at:new Date().toISOString()},description:"Controls whether face verification is required for attendance",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(X)throw X;await ct.fire({icon:"success",title:"Berhasil",text:"Pengaturan verifikasi kamera berhasil disimpan!"}),E(!1)}catch(X){console.error("Error saving camera settings:",X),await ct.fire({icon:"error",title:"Gagal",text:"Gagal menyimpan pengaturan verifikasi kamera"})}},q=X=>{D(X),N(!0)},I=async X=>{N(!1),await ct.fire({icon:"success",title:"Surat Peringatan",text:`Surat peringatan ${X.warning_type} berhasil dibuat dan dikirim ke ${S.name}`}),O()},K=async X=>{X?(D(X),A(!0)):(console.error("Attempted to view details for a null/undefined employee."),await ct.fire({icon:"error",title:"Gagal",text:"Gagal menampilkan detail: data karyawan tidak ditemukan."}))},Z=async(X,W,ie,ce)=>{try{await Pe.from("notifications").insert([{user_id:X,admin_id:t.id,type:W,title:ie,message:ce,data:{timestamp:new Date().toISOString(),sent_by:a.name},is_read:!1}])}catch(ue){console.error("Error sending notification:",ue)}},R=async X=>{var W;try{await Z(X.user_id||X.id,"late_warning","Peringatan Keterlambatan",`Anda terlambat ${X.late_minutes} menit hari ini. Harap lebih memperhatikan kedisiplinan waktu.`),await ct.fire({icon:"success",title:"Notifikasi Dikirim",text:`Notifikasi peringatan telah dikirim ke ${((W=X.profiles)==null?void 0:W.name)||X.name}`})}catch{await ct.fire({icon:"error",title:"Gagal",text:"Gagal mengirim notifikasi"})}},H=async X=>{try{await Z(X.id,"absence_warning","Peringatan Ketidakhadiran","Anda tidak hadir hari ini tanpa keterangan. Harap segera menghubungi atasan atau HR."),await ct.fire({icon:"success",title:"Notifikasi Dikirim",text:`Notifikasi peringatan telah dikirim ke ${X.name}`})}catch{await ct.fire({icon:"error",title:"Gagal",text:"Gagal mengirim notifikasi"})}};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat dashboard admin..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(eu,{user:t,profile:a,isCollapsed:o,setIsCollapsed:u}),l.jsxs("div",{className:`flex-1 transition-all duration-300 ease-in-out 
          ${o?"lg:ml-16":"lg:ml-64"} 
          pt-16 lg:pt-0`,children:[l.jsx("div",{className:"bg-white shadow-sm border-b fixed top-0 left-0 right-0 lg:relative z-30",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between py-3 lg:py-4",children:[l.jsx("div",{className:"lg:hidden"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"Dashboard Admin"}),l.jsx("p",{className:"hidden md:block text-sm text-gray-600",children:"Ringkasan aktivitas dan statistik sistem"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{onClick:()=>E(!0),className:"p-2 lg:px-3 lg:py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:[l.jsx(dS,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden lg:inline ml-2",children:"Pengaturan"})]}),l.jsxs("button",{onClick:()=>P(!0),className:"p-2 lg:px-3 lg:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[l.jsx(cp,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden lg:inline ml-2",children:"Export"})]}),l.jsx(_E,{userId:t==null?void 0:t.id,userRole:a==null?void 0:a.role})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-8",children:[l.jsx(Ng,{icon:Fl,title:"Karyawan",value:c.totalUsers,footer:`${c.activeUsers} aktif`,color:"blue"}),l.jsx(Ng,{icon:$t,title:"Hadir",value:c.todayAttendance,footer:`${c.absentToday} absen`,color:"green"}),l.jsx(Ng,{icon:Pn,title:"Terlambat",value:c.lateEmployees,footer:"Hari ini",color:"orange"}),l.jsx(Ng,{icon:vo,title:"Peringatan",value:c.activeWarnings,footer:"Aktif",color:"red"})]}),(f.length>0||b.length>0)&&l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[f.length>0&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-orange-50",children:l.jsxs("h2",{className:"text-lg font-medium text-orange-900",children:["Karyawan Terlambat Hari Ini (",f.length,")"]})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-3",children:f.slice(0,5).map(X=>{var W;return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:l.jsx(br,{className:"h-4 w-4 text-orange-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:(W=X.profiles)==null?void 0:W.name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Terlambat ",X.late_minutes," menit"]})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>K(X.profiles),className:"text-blue-600 hover:text-blue-800 p-1",title:"Lihat Detail",children:l.jsx(S1,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>R(X),className:"text-orange-600 hover:text-orange-800 p-1",title:"Kirim Peringatan",children:l.jsx(vo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>q(X.profiles),className:"text-red-600 hover:text-red-800 p-1",title:"Buat SP",children:l.jsx(Bl,{className:"h-4 w-4"})})]})]},X.id)})})})]}),b.length>0&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-red-50",children:l.jsxs("h2",{className:"text-lg font-medium text-red-900",children:["Karyawan Tidak Hadir Hari Ini (",b.length,")"]})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-3",children:b.slice(0,5).map(X=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:l.jsx(br,{className:"h-4 w-4 text-red-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:X.name}),l.jsx("p",{className:"text-sm text-gray-600",children:X.department||"Tidak ada departemen"})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>K(X),className:"text-blue-600 hover:text-blue-800 p-1",title:"Lihat Detail",children:l.jsx(S1,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>H(X),className:"text-red-600 hover:text-red-800 p-1",title:"Kirim Peringatan",children:l.jsx(vo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>q(X),className:"text-red-600 hover:text-red-800 p-1",title:"Buat SP",children:l.jsx(Bl,{className:"h-4 w-4"})})]})]},X.id))})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(cf,{className:"h-5 w-5 text-blue-600"}),l.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Informasi Sistem"})]})}),l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(cf,{className:"h-8 w-8 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Database"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Supabase PostgreSQL"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ls,{className:"h-8 w-8 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Jam Kerja"}),l.jsx("p",{className:"text-sm text-gray-600",children:"08:00 - 17:00"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(qi,{className:"h-8 w-8 text-purple-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Radius Kantor"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[(($=m.office_location)==null?void 0:$.radius)||100," meter"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Ld,{className:"h-8 w-8 text-orange-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Verifikasi Wajah"}),l.jsx("p",{className:"text-sm text-gray-600",children:F.enabled?"Aktif":"Nonaktif"})]})]})]})})]})]})]}),y&&S&&l.jsx(v$,{employee:S,onClose:()=>N(!1),onGenerated:I,issuedByUserId:t.id}),L&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Export Database"}),l.jsx("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-blue-50 p-6 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx(cf,{className:"h-8 w-8 text-blue-600 flex-shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Export Database Supabase"}),l.jsx("p",{className:"text-blue-700 mb-4",children:"Untuk mengekspor seluruh database Supabase termasuk skema, data, dan storage, ikuti langkah-langkah berikut:"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"1. Akses Dashboard Supabase"}),l.jsxs("p",{className:"text-sm text-blue-700",children:["Login ke dashboard Supabase project Anda di ",l.jsx("a",{href:"https://app.supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"app.supabase.com"})]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"2. Buka Menu Database"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Pilih menu "Database" → "Backups" dari sidebar'})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"3. Generate Backup"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Klik tombol "Generate backup" untuk membuat backup terbaru dari database Anda'})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"4. Download Backup"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Setelah backup selesai dibuat, klik tombol "Download" untuk mengunduh file SQL'})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"5. Export Storage (Opsional)"}),l.jsx("p",{className:"text-sm text-blue-700",children:'Untuk mengekspor file storage (seperti foto wajah), gunakan menu "Storage" dan download setiap bucket secara terpisah'})]})]})]})]})}),l.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Catatan Penting"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Backup database berisi semua data sensitif. Pastikan untuk menyimpannya dengan aman dan tidak membagikannya kepada pihak yang tidak berwenang."})]})]})}),l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Tutup"})})]})]})})}),j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pengaturan Sistem"}),l.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Verifikasi Kamera"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"camera-enabled",checked:F.enabled,onChange:X=>z(W=>({...W,enabled:X.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{htmlFor:"camera-enabled",className:"ml-2 block text-sm text-gray-900",children:"Aktifkan verifikasi wajah untuk absensi"})]}),l.jsx("div",{className:"p-3 bg-white rounded-lg",children:l.jsx("p",{className:"text-sm text-gray-600",children:F.enabled?"Karyawan harus melakukan verifikasi wajah saat absensi":"Karyawan dapat absensi tanpa verifikasi wajah"})}),l.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(Pn,{className:"h-4 w-4 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-yellow-700",children:"Menonaktifkan verifikasi wajah akan mengurangi keamanan sistem absensi, tetapi dapat berguna jika terjadi masalah dengan kamera atau perangkat."})]})})]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Batal"}),l.jsx("button",{onClick:B,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Pengaturan"})]})})]})]})]})})})]})},Ng=({icon:e,title:t,value:n,footer:a,color:r})=>{const i={blue:{bg:"bg-blue-50",text:"text-blue-700"},green:{bg:"bg-green-50",text:"text-green-700"},orange:{bg:"bg-orange-50",text:"text-orange-700"},red:{bg:"bg-red-50",text:"text-red-700"}},s=i[r]||i.blue;return l.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-10 h-10 ${s.bg} rounded-full flex items-center justify-center`,children:l.jsx(e,{className:`h-5 w-5 ${s.text}`})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700",children:t}),l.jsx("p",{className:"text-xl font-bold text-gray-900",children:n}),l.jsx("p",{className:`text-xs ${s.text}`,children:a})]})]})})},b$=({profile:e,onClose:t})=>e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative animate-fadeIn",children:[l.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-2xl",children:"×"}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("img",{src:e.avatar_url||"/default-bank.png",alt:"Avatar",className:"w-28 h-28 rounded-full border-4 border-blue-200 shadow mb-4 object-cover"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:e.name}),l.jsx("p",{className:"text-gray-500 mb-2",children:e.position||e.title||"-"}),l.jsx("p",{className:"text-gray-400 mb-4",children:e.department||"-"}),l.jsx("div",{className:"w-full border-t pt-4 mt-4",children:l.jsxs("div",{className:"flex flex-col gap-2 text-sm text-gray-700",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Email:"})," ",e.email]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"No. Pegawai:"})," ",e.employee_id||"-"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Telepon:"})," ",e.phone||"-"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Alamat:"})," ",e.address||"-"]})]})})]})]})}):null,y$=()=>{const e=wr(),[t,n]=ae.useState([]),[a,r]=ae.useState([]),[i,s]=ae.useState([]),[o,u]=ae.useState(!0),[c,d]=ae.useState(!1),[h,p]=ae.useState(!1);ae.useState(!1);const[f,g]=ae.useState("add"),[b,w]=ae.useState(""),[m,x]=ae.useState(""),[y,N]=ae.useState(""),[S,D]=ae.useState(null),[_,A]=ae.useState(null),[L,P]=ae.useState(!1),[j,E]=ae.useState({id:"",name:"",email:"",password:"",phone:"",location:"",title:"",bio:"",role:"karyawan",position_id:"",employee_id:"",department:"",salary:0,bank_id:"",bank_account_number:"",bank_account_name:"",status:"active"}),[F,z]=ae.useState(null),[U,O]=ae.useState(null),[B,q]=ae.useState(1),[I,K]=ae.useState(!1),[Z,R]=ae.useState(null),[H,$]=ae.useState(null);ae.useEffect(()=>{X()},[]);const X=async()=>{try{const{data:{user:le}}=await Pe.auth.getUser();if(!le){e("/login");return}const{data:Xe}=await Pe.from("profiles").select("role").eq("id",le.id).single();if(!Xe||Xe.role!=="admin"){e("/dashboard");return}D(le),A(Xe),await Promise.all([W(),ie(),ce()])}catch(le){console.error("Error checking access:",le),e("/login")}finally{u(!1)}},W=async()=>{d(!0);try{const{data:le,error:Xe}=await Pe.from("profiles").select(`
          *,
          positions(name_id, department, base_salary),
          bank_info(bank_name, bank_logo)
        `).order("created_at",{ascending:!1});if(Xe)throw Xe;n(le||[])}catch(le){console.error("Error fetching users:",le),R("Gagal memuat data pengguna")}finally{d(!1)}},ie=async()=>{try{const{data:le,error:Xe}=await Pe.from("positions").select("*").eq("is_active",!0).order("name_id");if(Xe)throw Xe;r(le||[])}catch(le){console.error("Error fetching positions:",le)}},ce=async()=>{try{const{data:le,error:Xe}=await Pe.from("bank_info").select("*").eq("is_active",!0).order("bank_name");if(Xe)throw Xe;s(le||[])}catch(le){console.error("Error fetching banks:",le)}},ue=le=>{const{name:Xe,value:We}=le.target;if(Xe==="position_id"){const et=a.find(Ke=>Ke.id===We);if(et){const Ke=et.name_id.substring(0,3).toUpperCase(),Ht=Date.now().toString().slice(-4),xt=f==="add"?`${Ke}${Ht}`:j.employee_id;E(Xn=>({...Xn,position_id:We,title:et.name_id,department:et.department||"",salary:et.base_salary||0,employee_id:xt}))}else E(Ke=>({...Ke,position_id:We,title:"",department:"",salary:0,employee_id:""}))}else E(Xe==="name"||Xe==="full_name"?et=>({...et,[Xe]:We,bank_account_name:We}):et=>({...et,[Xe]:We}))},he=(le,Xe)=>{z(le),O(Xe),console.log("✅ Face captured",{photoBlob:le,fingerprint:Xe})},ge=le=>{if(le.preventDefault(),f==="add"&&j.password.length<6){ct.fire({icon:"error",title:"Gagal",text:"Password minimal 6 karakter"});return}if(!j.position_id){ct.fire({icon:"error",title:"Gagal",text:"Silakan pilih jabatan"});return}j.role==="admin"||f==="edit"?f==="add"?Ee():Te():q(2)},Ee=async()=>{if(j.role!=="admin"&&!F){ct.fire({icon:"error",title:"Gagal",text:"Silakan ambil foto wajah terlebih dahulu"});return}if(j.role!=="admin"&&!U){ct.fire({icon:"error",title:"Gagal",text:"Fingerprint wajah tidak terdeteksi, silakan ulangi pengambilan foto."});return}K(!0);try{const{data:le,error:Xe}=await Pe.auth.signUp({email:j.email,password:j.password,options:{data:{name:j.name,role:j.role}}});if(Xe)throw Xe;if(!le.user)throw new Error("Pendaftaran gagal");const We=le.user.id;let et=null;if(j.role!=="admin"&&F){const Mt=`${We}-face-${Date.now()}.jpg`;await v0(F,"face-photos",Mt),et=x0("face-photos",Mt)}const Ke={id:We,name:j.name,full_name:j.name,email:j.email,phone:j.phone,location:j.location,title:j.title,bio:j.bio||`${ke(j.role)} di sistem absensi`,avatar_url:et,role:j.role,position_id:j.position_id,employee_id:j.employee_id,department:j.department,salary:j.salary,bank_id:j.bank_id||null,bank_account_number:j.bank_account_number||null,bank_account_name:j.bank_account_name||j.name,is_face_registered:j.role==="admin"?!0:!!et,status:"active",join_date:new Date().toISOString().split("T")[0],contract_start_date:new Date().toISOString().split("T")[0],contract_type:"permanent",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:Ht}=await Pe.from("profiles").insert([Ke]);if(Ht){const{error:Mt}=await Pe.from("profiles").update(Ke).eq("id",We);if(Mt)throw new Error("Gagal membuat profil user")}const xt={user_id:We,daily_salary:j.salary/22,overtime_rate:1.5,bonus:0,deduction:0,effective_date:new Date().toISOString().split("T")[0],is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:Xn}=await Pe.from("employee_salaries").insert([xt]);ct.fire({icon:"success",title:"Berhasil",html:`<b>${j.name}</b> (${ke(j.role)}) berhasil ditambahkan!`,showConfirmButton:!0}),ne(),await W()}catch(le){ct.fire({icon:"error",title:"Gagal",text:le.message||"Terjadi kesalahan saat membuat user"})}finally{K(!1)}},Te=async()=>{K(!0);try{let le=j.avatar_url;if(j.role!=="admin"&&F){const Ht=`${j.id}-face-${Date.now()}.jpg`;await v0(F,"face-photos",Ht),le=x0("face-photos",Ht)}const Xe={name:j.name,full_name:j.name,email:j.email,phone:j.phone,location:j.location,title:j.title,bio:j.bio||`${ke(j.role)} di sistem absensi`,avatar_url:le,role:j.role,position_id:j.position_id,employee_id:j.employee_id,department:j.department,salary:j.salary,bank_id:j.bank_id||null,bank_account_number:j.bank_account_number||null,bank_account_name:j.bank_account_name||j.name,is_face_registered:j.role==="admin"?!0:!!le,status:j.status,updated_at:new Date().toISOString()},{error:We}=await Pe.from("profiles").update(Xe).eq("id",j.id);if(We)throw We;const et={user_id:j.id,daily_salary:j.salary/22,overtime_rate:1.5,bonus:0,deduction:0,effective_date:new Date().toISOString().split("T")[0],is_active:!0,updated_at:new Date().toISOString()},{error:Ke}=await Pe.from("employee_salaries").update(et).eq("user_id",j.id).eq("is_active",!0);if(Ke&&!Ke.message.includes("0 rows")){const{error:Ht}=await Pe.from("employee_salaries").insert([et]);if(Ht)throw Ht}ct.fire({icon:"success",title:"Berhasil",html:`<b>${j.name}</b> berhasil diperbarui!`,showConfirmButton:!0}),ne(),await W()}catch(le){ct.fire({icon:"error",title:"Gagal",text:le.message||"Terjadi kesalahan saat memperbarui user"})}finally{K(!1)}},fe=async()=>{if(j.password.length<6){ct.fire({icon:"error",title:"Gagal",text:"Password baru minimal 6 karakter"});return}K(!0);try{const le=await fetch("https://<your-project-ref>.supabase.co/functions/v1/reset-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Pe.auth.getSession().then(({data:We})=>{var et;return(et=We.session)==null?void 0:et.access_token})}`},body:JSON.stringify({user_id:j.id,new_password:j.password,admin_id:S.id})}),Xe=await le.json();if(!le.ok)throw new Error(Xe.error||"Gagal mereset password");ct.fire({icon:"success",title:"Berhasil",text:`Password untuk ${j.name} berhasil diperbarui!`,showConfirmButton:!0}),ne()}catch(le){ct.fire({icon:"error",title:"Gagal",text:le.message||"Terjadi kesalahan saat mereset password"})}finally{K(!1)}},me=async(le,Xe,We)=>{const et=Xe==="active"?"inactive":"active",Ke=et==="active"?"mengaktifkan":"menonaktifkan";if((await ct.fire({title:`${et==="active"?"Aktifkan":"Nonaktifkan"} User?`,text:`Apakah Anda yakin ingin ${Ke} user ${We}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:`Ya, ${Ke}`,cancelButtonText:"Batal"})).isConfirmed){d(!0);try{const{error:xt}=await Pe.from("profiles").update({status:et,updated_at:new Date().toISOString()}).eq("id",le);if(xt)throw xt;await W(),ct.fire({icon:"success",title:"Berhasil",text:`User ${We} berhasil ${et==="active"?"diaktifkan":"dinonaktifkan"}`})}catch{ct.fire({icon:"error",title:"Gagal",text:`Gagal ${Ke} user`})}finally{d(!1)}}},ne=()=>{E({id:"",name:"",email:"",password:"",phone:"",location:"",title:"",bio:"",role:"karyawan",position_id:"",employee_id:"",department:"",salary:0,bank_id:"",bank_account_number:"",bank_account_name:"",status:"active"}),z(null),O(null),q(1),p(!1),g("add"),R(null),$(null)},De=le=>{var Xe,We,et;E({id:le.id,name:le.name,email:le.email,phone:le.phone||"",location:le.location||"",title:le.title||((Xe=le.positions)==null?void 0:Xe.name_id)||"",bio:le.bio||"",role:le.role,position_id:le.position_id||"",employee_id:le.employee_id||"",department:le.department||((We=le.positions)==null?void 0:We.department)||"",salary:le.salary||((et=le.positions)==null?void 0:et.base_salary)||0,bank_id:le.bank_id||"",bank_account_number:le.bank_account_number||"",bank_account_name:le.bank_account_name||le.name,status:le.status||"active",avatar_url:le.avatar_url||""}),z(null),O(null),g("edit"),q(1),p(!0)},Oe=le=>{E({id:le.id,name:le.name,email:le.email,password:"",phone:"",location:"",title:"",bio:"",role:le.role,position_id:"",employee_id:"",department:"",salary:0,bank_id:"",bank_account_number:"",bank_account_name:"",status:le.status}),g("password"),p(!0)},ke=le=>{switch(le){case"admin":return"Administrator";case"karyawan":return"Karyawan";default:return"Karyawan"}},xe=le=>{switch(le){case"admin":return l.jsx(Zc,{className:"h-4 w-4"});default:return l.jsx(br,{className:"h-4 w-4"})}},Ae=le=>{switch(le){case"admin":return"bg-blue-100 text-blue-800";default:return"bg-green-100 text-green-800"}},Ce=le=>le==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",He=le=>(S==null?void 0:S.id)!==le,Qe=le=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(le),Ze=()=>[...new Set(t.map(Xe=>{var We;return Xe.department||((We=Xe.positions)==null?void 0:We.department)}).filter(Boolean))],Je=t.filter(le=>{var Ke,Ht,xt;const Xe=((Ke=le.name)==null?void 0:Ke.toLowerCase().includes(b.toLowerCase()))||((Ht=le.email)==null?void 0:Ht.toLowerCase().includes(b.toLowerCase()))||le.employee_id&&le.employee_id.toLowerCase().includes(b.toLowerCase()),We=m===""||le.department===m||((xt=le.positions)==null?void 0:xt.department)===m,et=y===""||le.role===y;return Xe&&We&&et});return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data pengguna..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row",children:[l.jsx(eu,{user:S,profile:_,className:"w-full md:w-64 md:fixed md:h-screen"}),l.jsxs("div",{className:"flex-1 md:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Pengguna"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, reset password, dan kelola status pengguna sistem"})]}),l.jsxs("button",{onClick:()=>{g("add"),p(!0)},className:"flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[l.jsx(tv,{className:"h-5 w-5"}),l.jsx("span",{children:"Tambah User"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[H&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:H}),l.jsx("button",{onClick:()=>$(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),Z&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:Z}),l.jsx("button",{onClick:()=>R(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative",children:[l.jsx(Jd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari berdasarkan nama, email, atau ID karyawan...",value:b,onChange:le=>w(le.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("div",{className:"w-full sm:w-40",children:l.jsxs("select",{value:m,onChange:le=>x(le.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),Ze().map(le=>l.jsx("option",{value:le,children:le},le))]})}),l.jsx("div",{className:"w-full sm:w-40",children:l.jsxs("select",{value:y,onChange:le=>N(le.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Role"}),l.jsx("option",{value:"karyawan",children:"Karyawan"}),l.jsx("option",{value:"admin",children:"Administrator"})]})})]})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Fl,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base font-medium text-gray-900",children:["Daftar Pengguna (",Je.length,")"]})]})}),c?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):Je.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(br,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada pengguna ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau filter Anda"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pengguna"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jabatan & Departemen"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gaji"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kontak"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role & Status"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Je.map(le=>{var Xe,We,et;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:le.avatar_url?l.jsx("img",{src:le.avatar_url,alt:le.name,className:"w-8 h-8 rounded-full object-cover"}):l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${Ae(le.role)}`,children:xe(le.role)})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.jsx("span",{className:"cursor-pointer text-blue-700 hover:underline",onClick:()=>{A(le),P(!0)},children:le.name})}),l.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",le.employee_id||"Belum diatur"]})]})]})}),l.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Xe=le.positions)==null?void 0:Xe.name_id)||le.title||ke(le.role)}),l.jsx("div",{className:"text-sm text-gray-500",children:((We=le.positions)==null?void 0:We.department)||le.department||"Belum diatur"})]}),l.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:Qe(((et=le.positions)==null?void 0:et.base_salary)||le.salary||0)}),l.jsx("div",{className:"text-sm text-gray-500",children:"per bulan"})]}),l.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[l.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[l.jsx(ev,{className:"h-4 w-4 mr-2 text-gray-400"}),l.jsx("span",{className:"cursor-pointer text-blue-700 hover:underline",onClick:()=>{A(le),P(!0)},children:le.email})]}),le.phone&&l.jsxs("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[l.jsx(hS,{className:"h-4 w-4 mr-2 text-gray-400"}),le.phone]})]}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"space-y-1",children:[l.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${Ae(le.role)}`,children:[le.role==="admin"&&l.jsx(Zc,{className:"h-3 w-3 mr-1"}),ke(le.role)]}),l.jsx("div",{className:"text-xs text-gray-500",children:l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${Ce(le.status)}`,children:le.status==="active"?"Aktif":"Nonaktif"})}),le.bank_info&&l.jsx("div",{className:"text-xs text-gray-500",children:l.jsxs("span",{className:"text-blue-600",children:["Bank: ",le.bank_info.bank_name]})})]})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:l.jsx("div",{className:"flex space-x-2",children:He(le.id)?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>De(le),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit User",children:l.jsx(Wi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>Oe(le),className:"text-yellow-600 hover:text-yellow-900 p-1 hover:bg-yellow-50 rounded",title:"Reset Password",children:l.jsx(_l,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>me(le.id,le.status,le.name),className:"text-purple-600 hover:text-purple-900 p-1 hover:bg-purple-50 rounded",title:le.status==="active"?"Nonaktifkan":"Aktifkan",children:le.status==="active"?l.jsx(TN,{className:"h-4 w-4"}):l.jsx(LN,{className:"h-4 w-4"})})]}):l.jsx("span",{className:"text-gray-400 text-xs",children:"Akun Anda"})})})]},le.id)})})]}),l.jsx("div",{className:"md:hidden p-4 space-y-4",children:Je.map(le=>{var Xe,We,et;return l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-5 border border-gray-100 transition-transform transform hover:scale-[1.02]",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:le.avatar_url?l.jsx("img",{src:le.avatar_url,alt:le.name,className:"w-12 h-12 rounded-full object-cover"}):l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${Ae(le.role)}`,children:xe(le.role)})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-base font-semibold text-gray-900 cursor-pointer text-blue-700 hover:underline",onClick:()=>{A(le),P(!0)},children:le.name}),l.jsx("p",{className:"text-sm text-gray-600",children:((Xe=le.positions)==null?void 0:Xe.name_id)||le.title||ke(le.role)})]})]}),l.jsx("div",{className:"flex space-x-2",children:He(le.id)?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>De(le),className:"text-blue-600 hover:text-blue-900 p-2 rounded-full hover:bg-blue-50",children:l.jsx(Wi,{className:"h-6 w-6"})}),l.jsx("button",{onClick:()=>Oe(le),className:"text-yellow-600 hover:text-yellow-900 p-2 rounded-full hover:bg-yellow-50",children:l.jsx(_l,{className:"h-6 w-6"})}),l.jsx("button",{onClick:()=>me(le.id,le.status,le.name),className:"text-purple-600 hover:text-purple-900 p-2 rounded-full hover:bg-purple-50",children:le.status==="active"?l.jsx(TN,{className:"h-6 w-6"}):l.jsx(LN,{className:"h-6 w-6"})})]}):l.jsx("span",{className:"text-gray-400 text-sm",children:"Akun Anda"})})]}),l.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"ID:"})," ",le.employee_id||"Belum diatur"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Departemen:"})," ",((We=le.positions)==null?void 0:We.department)||le.department||"Belum diatur"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Gaji:"})," ",Qe(((et=le.positions)==null?void 0:et.base_salary)||le.salary||0)]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Email:"})," ",le.email]}),le.phone&&l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Telepon:"})," ",le.phone]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Role:"})," ",l.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${Ae(le.role)}`,children:[le.role==="admin"&&l.jsx(Zc,{className:"h-4 w-4 mr-1"}),ke(le.role)]})]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${Ce(le.status)}`,children:le.status==="active"?"Aktif":"Nonaktif"})]}),le.bank_info&&l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Bank:"})," ",le.bank_info.bank_name]})]})]},le.id)})})]})]}),L&&l.jsx(b$,{profile:_,onClose:()=>P(!1)})]})]}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md sm:max-w-lg bg-white rounded-xl shadow-2xl max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-5 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:f==="add"?"Tambah Pengguna Baru":f==="edit"?"Edit Pengguna":"Reset Password"}),l.jsx("button",{onClick:ne,className:"text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100",children:l.jsx(Ui,{className:"h-6 w-6"})})]}),f!=="password"&&l.jsx("div",{className:"flex items-center justify-center mb-4",children:[1,2].map(le=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${B>=le?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:B>le?l.jsx($t,{className:"h-5 w-5"}):le}),le<2&&l.jsx("div",{className:`w-10 h-1 mx-2 ${B>le?"bg-blue-600":"bg-gray-200"}`})]},le))}),f==="password"?l.jsxs("form",{onSubmit:le=>{le.preventDefault(),fe()},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Pengguna"}),l.jsx("input",{type:"text",value:j.name,readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Baru *"}),l.jsx("input",{type:"password",name:"password",value:j.password,onChange:ue,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Minimal 6 karakter"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:ne,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Batal"}),l.jsx("button",{type:"submit",disabled:I,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(_l,{className:"h-5 w-5"}),l.jsx("span",{children:"Reset Password"})]})})]})]}):B===1?l.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Pilih Jabatan"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jabatan *"}),l.jsxs("select",{name:"position_id",value:j.position_id,onChange:ue,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Pilih Jabatan..."}),a.map(le=>l.jsxs("option",{value:le.id,children:[le.name_id," - ",le.department," (",Qe(le.base_salary||0),")"]},le.id))]})]}),j.position_id&&l.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Karyawan"}),l.jsx("input",{type:"text",value:j.employee_id,readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gaji Bulanan"}),l.jsx("input",{type:"text",value:Qe(j.salary),readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap *"}),l.jsx("input",{type:"text",name:"name",value:j.name,onChange:ue,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Masukkan nama lengkap"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),l.jsx("input",{type:"email",name:"email",value:j.email,onChange:ue,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Masukkan email"})]})]}),f==="add"&&l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),l.jsx("input",{type:"password",name:"password",value:j.password,onChange:ue,required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Minimal 6 karakter"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),l.jsxs("select",{name:"role",value:j.role,onChange:ue,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"karyawan",children:"Karyawan"}),l.jsx("option",{value:"admin",children:"Administrator"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No. Telepon"}),l.jsx("input",{type:"tel",name:"phone",value:j.phone,onChange:ue,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: +62-21-1234567"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lokasi"}),l.jsx("input",{type:"text",name:"location",value:j.location,onChange:ue,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: Jakarta, Indonesia"})]})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-green-900 mb-3",children:"Informasi Bank (Opsional)"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Bank"}),l.jsxs("select",{name:"bank_id",value:j.bank_id,onChange:ue,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Pilih Bank..."}),i.map(le=>l.jsx("option",{value:le.id,children:le.bank_name},le.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor Rekening"}),l.jsx("input",{type:"text",name:"bank_account_number",value:j.bank_account_number,onChange:ue,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Nomor rekening"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Pemilik Rekening"}),l.jsx("input",{type:"text",value:j.bank_account_name,readOnly:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg bg-gray-50 text-sm",placeholder:"Otomatis sesuai nama lengkap"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),l.jsx("textarea",{name:"bio",value:j.bio,onChange:ue,rows:4,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Deskripsi singkat tentang pengguna"})]}),f==="edit"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),l.jsxs("select",{name:"status",value:j.status,onChange:ue,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"active",children:"Aktif"}),l.jsx("option",{value:"inactive",children:"Nonaktif"})]})]}),j.role==="admin"&&l.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Zc,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Administrator"}),l.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Administrator tidak memerlukan verifikasi wajah dan dapat langsung mengakses semua fitur sistem."})]})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:ne,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Batal"}),l.jsx("button",{type:"submit",disabled:I,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-5 w-5"}),l.jsx("span",{children:f==="add"&&j.role==="admin"?"Buat Administrator":f==="add"?"Lanjut ke Foto Wajah":"Perbarui Pengguna"})]})})]})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center mb-4",children:[l.jsx(Ld,{className:"h-12 w-12 text-blue-600 mx-auto mb-2"}),l.jsx("p",{className:"text-gray-600 text-sm",children:"Ambil foto wajah yang jelas untuk verifikasi absensi. Sistem kami menggunakan teknologi pengenalan wajah yang aman dan cepat."})]}),l.jsx(Qv,{onFaceCapture:he,isCapturing:I}),F&&U&&l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 text-green-600 mb-4",children:[l.jsx($t,{className:"h-5 w-5"}),l.jsx("span",{children:"Foto wajah berhasil diambil dan diverifikasi!"})]})}),F&&!U&&l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 text-yellow-600 mb-4",children:[l.jsx(Pn,{className:"h-5 w-5"}),l.jsx("span",{children:"Fingerprint wajah tidak terdeteksi, silakan ulangi pengambilan foto."})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3",children:[l.jsx("button",{onClick:()=>q(1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Kembali"}),l.jsx("button",{onClick:f==="add"?Ee:Te,disabled:!F||!U||I,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsx("div",{className:"flex items-center justify-center space-x-2",children:I?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(di,{className:"h-5 w-5"}),l.jsx("span",{children:f==="add"?"Buat Pengguna":"Perbarui Pengguna"})]})})})]})]})]})})})]})},w$=({employee:e,onClose:t,onPaymentProcessed:n})=>{var S;const[a,r]=ae.useState(!1),[i,s]=ae.useState(null),[o,u]=ae.useState(null),[c,d]=ae.useState([]),[h,p]=ae.useState(!1),[f,g]=ae.useState({amount:0,payment_method:"bank_transfer",payment_reference:"",payment_period_start:new Date().toISOString().split("T")[0],payment_period_end:new Date().toISOString().split("T")[0],notes:""});ae.useEffect(()=>{var D;if(e){let _=0;(D=e.positions)!=null&&D.base_salary?_=e.positions.base_salary:e.employee_salaries&&e.employee_salaries.length>0?_=e.employee_salaries[0].daily_salary*22||0:_=e.salary||0,g(A=>({...A,amount:_,notes:`Gaji bulan ${new Date().toLocaleString("id-ID",{month:"long",year:"numeric"})} untuk ${e.name}`})),b()}},[e]);const b=async()=>{if(e)try{const{data:D,error:_}=await Pe.from("salary_payments").select("*").eq("user_id",e.id).order("payment_date",{ascending:!1}).limit(5);if(_)throw _;d(D||[])}catch(D){console.error("Error fetching payment history:",D)}},w=D=>{const{name:_,value:A}=D.target;g({...f,[_]:A})},m=async D=>{var _,A,L,P,j;D.preventDefault(),r(!0),s(null),u(null);try{if(!e){ct.fire({icon:"error",title:"Gagal",text:"Karyawan tidak ditemukan"});return}if(!f.amount||f.amount<=0){ct.fire({icon:"warning",title:"Jumlah tidak valid",text:"Jumlah pembayaran harus lebih dari 0"});return}if(f.payment_method==="bank_transfer"&&(!e.bank_info||!e.bank_account_number)){ct.fire({icon:"warning",title:"Rekening belum diatur",text:"Karyawan belum mengatur rekening bank. Gunakan metode pembayaran lain atau minta karyawan untuk mengatur rekening bank."});return}const{data:E,error:F}=await Pe.from("salary_payments").insert([{user_id:e.id,salary_id:(A=(_=e.employee_salaries)==null?void 0:_[0])==null?void 0:A.id,payment_date:new Date().toISOString().split("T")[0],payment_amount:parseFloat(f.amount),payment_method:f.payment_method,payment_status:"completed",payment_reference:f.payment_reference,payment_period_start:f.payment_period_start,payment_period_end:f.payment_period_end,notes:f.notes,created_by:(L=(await Pe.auth.getUser()).data.user)==null?void 0:L.id,payment_details:{processed_at:new Date().toISOString(),payment_method_details:f.payment_method==="bank_transfer"?{bank_name:(P=e.bank_info)==null?void 0:P.bank_name,account_number:e.bank_account_number}:{method:f.payment_method}}}]).select();if(F)throw F;if(e.employee_salaries&&e.employee_salaries.length>0){const{error:z}=await Pe.from("employee_salaries").update({payment_status:"paid",last_payment_date:new Date().toISOString().split("T")[0],payment_notes:f.notes,updated_at:new Date().toISOString()}).eq("id",e.employee_salaries[0].id);z&&console.error("Error updating salary status:",z)}else{const z=N()/22,{error:U}=await Pe.from("employee_salaries").insert([{user_id:e.id,daily_salary:z,overtime_rate:1.5,effective_date:new Date().toISOString().split("T")[0],payment_status:"paid",last_payment_date:new Date().toISOString().split("T")[0],payment_notes:f.notes,is_active:!0}]);U&&console.error("Error creating salary record:",U)}try{await Pe.from("notifications").insert([{user_id:e.id,admin_id:(j=(await Pe.auth.getUser()).data.user)==null?void 0:j.id,type:"salary_info",title:"Pembayaran Gaji",message:`Gaji Anda sebesar ${x(f.amount)} telah dibayarkan melalui ${f.payment_method==="bank_transfer"?"transfer bank":f.payment_method==="cash"?"tunai":"metode lainnya"}.`,data:{payment_id:E[0].id,amount:f.amount,payment_date:new Date().toISOString().split("T")[0],payment_method:f.payment_method},is_read:!1}])}catch(z){console.error("Error sending notification:",z)}u(`Pembayaran gaji sebesar ${x(f.amount)} untuk ${e.name} berhasil diproses!`),ct.fire({icon:"success",title:"Berhasil",text:`Pembayaran gaji sebesar ${x(f.amount)} untuk ${e.name} berhasil diproses!`}),await b(),n&&n({employeeId:e.id,amount:f.amount,paymentMethod:f.payment_method,paymentDate:new Date().toISOString()}),setTimeout(()=>{u(null),g({amount:0,payment_method:"bank_transfer",payment_reference:"",payment_period_start:new Date().toISOString().split("T")[0],payment_period_end:new Date().toISOString().split("T")[0],notes:""})},3e3)}catch(E){console.error("Error processing payment:",E),ct.fire({icon:"error",title:"Gagal",text:E.message||"Gagal memproses pembayaran"})}finally{r(!1)}},x=D=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(D),y=D=>new Date(D).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),N=()=>{var D;return(D=e.positions)!=null&&D.base_salary?e.positions.base_salary:e.employee_salaries&&e.employee_salaries.length>0?(e.employee_salaries[0].daily_salary||0)*22:e.salary||0};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full bg-white rounded-xl shadow-lg max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Proses Pembayaran Gaji"}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ui,{className:"h-6 w-6"})})]}),o&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-green-700 font-medium",children:"Pembayaran Berhasil!"}),l.jsx("p",{className:"text-green-600 text-sm mt-1",children:o})]})]}),i&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Pembayaran Gagal"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:i})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Informasi Karyawan"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(br,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Nama"}),l.jsx("p",{className:"font-medium text-blue-900",children:e.name})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(df,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Jabatan"}),l.jsx("p",{className:"font-medium text-blue-900",children:((S=e.positions)==null?void 0:S.name_id)||e.title||"Karyawan"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ya,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Departemen"}),l.jsx("p",{className:"font-medium text-blue-900",children:e.department||"-"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Rf,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Gaji Bulanan"}),l.jsx("p",{className:"font-medium text-blue-900",children:x(N())})]})]})]})]}),l.jsxs("div",{className:`p-4 rounded-lg ${e.bank_info?"bg-green-50":"bg-yellow-50"}`,children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Informasi Rekening"}),e.bank_info?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ya,{className:"h-5 w-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Bank"}),l.jsx("p",{className:"font-medium text-gray-900",children:e.bank_info.bank_name})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(qu,{className:"h-5 w-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Nomor Rekening"}),l.jsx("p",{className:"font-medium text-gray-900",children:e.bank_account_number})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(br,{className:"h-5 w-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Atas Nama"}),l.jsx("p",{className:"font-medium text-gray-900",children:e.bank_account_name||e.name})]})]})]}):l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-yellow-500"}),l.jsx("p",{className:"text-yellow-700",children:"Karyawan belum mengatur informasi rekening bank"})]})]}),l.jsxs("form",{onSubmit:m,children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Detail Pembayaran"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jumlah Pembayaran (IDR) *"}),l.jsxs("div",{className:"relative",children:[l.jsx(Rf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"number",name:"amount",value:f.amount,onChange:w,required:!0,min:"1",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: 5000000"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Metode Pembayaran *"}),l.jsxs("select",{name:"payment_method",value:f.payment_method,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"bank_transfer",children:"Transfer Bank"}),l.jsx("option",{value:"cash",children:"Tunai"}),l.jsx("option",{value:"other",children:"Lainnya"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referensi Pembayaran"}),l.jsx("input",{type:"text",name:"payment_reference",value:f.payment_reference,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: TRF/2025/06/001"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal Pembayaran"}),l.jsxs("div",{className:"relative",children:[l.jsx(Uu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"date",name:"payment_date",value:new Date().toISOString().split("T")[0],readOnly:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),l.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Periode Awal"}),l.jsx("input",{type:"date",name:"payment_period_start",value:f.payment_period_start,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Periode Akhir"}),l.jsx("input",{type:"date",name:"payment_period_end",value:f.payment_period_end,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catatan"}),l.jsx("textarea",{name:"notes",value:f.notes,onChange:w,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Catatan tambahan tentang pembayaran ini..."})]})]}),l.jsxs("div",{className:"mt-6 p-4 bg-green-50 rounded-lg border border-green-200",children:[l.jsx("h3",{className:"font-medium text-green-900 mb-3",children:"Ringkasan Pembayaran"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Total Pembayaran:"}),l.jsx("span",{className:"font-bold text-green-900",children:x(f.amount)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Metode Pembayaran:"}),l.jsx("span",{className:"font-medium text-green-900",children:f.payment_method==="bank_transfer"?"Transfer Bank":f.payment_method==="cash"?"Tunai":"Lainnya"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Penerima:"}),l.jsx("span",{className:"font-medium text-green-900",children:e.name})]}),f.payment_method==="bank_transfer"&&e.bank_info&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Rekening Tujuan:"}),l.jsxs("span",{className:"font-medium text-green-900",children:[e.bank_info.bank_name," - ",e.bank_account_number]})]})]})]}),l.jsxs("div",{className:"flex space-x-3 mt-6",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Memproses..."})]}):l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(zg,{className:"h-4 w-4"}),l.jsx("span",{children:"Proses Pembayaran"})]})})]})]}),l.jsx("div",{className:"mt-6",children:l.jsxs("button",{onClick:()=>p(!h),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800 transition-colors",children:[l.jsx(ls,{className:"h-4 w-4"}),l.jsx("span",{children:h?"Sembunyikan Riwayat":"Lihat Riwayat Pembayaran"})]})}),h&&l.jsxs("div",{className:"mt-4 space-y-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:"Riwayat Pembayaran"}),c.length>0?l.jsx("div",{className:"space-y-3",children:c.map(D=>l.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Uu,{className:"h-4 w-4 text-gray-500"}),l.jsx("span",{className:"font-medium text-gray-900",children:y(D.payment_date)})]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D.payment_status==="completed"?"bg-green-100 text-green-800":D.payment_status==="pending"?"bg-yellow-100 text-yellow-800":D.payment_status==="processing"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:D.payment_status==="completed"?"Selesai":D.payment_status==="pending"?"Tertunda":D.payment_status==="processing"?"Diproses":"Gagal"})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("p",{className:"text-sm text-gray-600",children:[D.payment_method==="bank_transfer"?"Transfer Bank":D.payment_method==="cash"?"Tunai":"Lainnya",D.payment_reference&&` (${D.payment_reference})`]}),D.notes&&l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:D.notes})]}),l.jsx("p",{className:"font-bold text-gray-900",children:x(D.payment_amount)})]})]},D.id))}):l.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[l.jsx(Bl,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-500",children:"Belum ada riwayat pembayaran"})]})]})]})]})})}):null},N$=()=>{const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState([]),[h,p]=ae.useState([]),[f,g]=ae.useState(""),[b,w]=ae.useState(""),[m,x]=ae.useState(""),[y,N]=ae.useState(null),[S,D]=ae.useState(!1),[_,A]=ae.useState(null),[L,P]=ae.useState(null),[j,E]=ae.useState({totalPaid:0,pendingPayments:0,totalEmployees:0,paidEmployees:0});ae.useEffect(()=>{F()},[]);const F=async()=>{try{const{data:{user:W}}=await Pe.auth.getUser();if(!W){e("/login");return}const{data:ie}=await Pe.from("profiles").select("role").eq("id",W.id).single();if(!ie||ie.role!=="admin"){e("/dashboard");return}n(W),r(ie),await Promise.all([z(),U()])}catch(W){console.error("Error checking access:",W),e("/login")}finally{s(!1)}},z=async()=>{u(!0);try{const{data:W,error:ie}=await Pe.from("profiles").select(`
          *,
          employee_salaries(*),
          positions(*),
          bank_info(*)
        `).order("name");if(ie)throw ie;d(W||[]);const ce=(W==null?void 0:W.length)||0,ue=(W==null?void 0:W.filter(he=>{var ge,Ee;return((Ee=(ge=he.employee_salaries)==null?void 0:ge[0])==null?void 0:Ee.payment_status)==="paid"}).length)||0;E(he=>({...he,totalEmployees:ce,paidEmployees:ue}))}catch(W){console.error("Error fetching employees:",W),A("Gagal memuat data karyawan")}finally{u(!1)}},U=async()=>{u(!0);try{const{data:W,error:ie}=await Pe.from("salary_payments").select(`
          *,
          profiles:user_id(name, email, department, title, employee_id)
        `).order("payment_date",{ascending:!1}).limit(100);if(ie)throw ie;p(W||[]);const ce=(W==null?void 0:W.reduce((he,ge)=>he+(ge.payment_amount||0),0))||0,ue=(W==null?void 0:W.filter(he=>he.payment_status==="pending"||he.payment_status==="processing").length)||0;E(he=>({...he,totalPaid:ce,pendingPayments:ue}))}catch(W){console.error("Error fetching payments:",W),A("Gagal memuat data pembayaran")}finally{u(!1)}},O=async W=>{P(`Pembayaran gaji untuk ${y.name} berhasil diproses!`),D(!1),await Promise.all([z(),U()]),setTimeout(()=>{P(null)},3e3)},B=W=>{N(W),D(!0)},q=W=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(W),I=W=>new Date(W).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),K=W=>{switch(W){case"paid":return"bg-green-100 text-green-800";case"unpaid":return"bg-red-100 text-red-800";case"processing":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Z=W=>{switch(W){case"paid":return"Dibayar";case"unpaid":return"Belum Dibayar";case"processing":return"Diproses";case"failed":return"Gagal";default:return"Tidak Diketahui"}},R=W=>{var ie;return(ie=W.positions)!=null&&ie.base_salary?W.positions.base_salary:W.employee_salaries&&W.employee_salaries.length>0?(W.employee_salaries[0].daily_salary||0)*22:W.salary||0},H=c.filter(W=>{var he,ge,Ee,Te,fe;const ie=((he=W.name)==null?void 0:he.toLowerCase().includes(f.toLowerCase()))||((ge=W.email)==null?void 0:ge.toLowerCase().includes(f.toLowerCase()))||((Ee=W.employee_id)==null?void 0:Ee.toLowerCase().includes(f.toLowerCase())),ce=!b||W.department===b,ue=!m||((fe=(Te=W.employee_salaries)==null?void 0:Te[0])==null?void 0:fe.payment_status)===m;return ie&&ce&&ue}),$=()=>[...new Set(c.map(ie=>ie.department).filter(Boolean))],X=()=>{if(h.length===0)return;const ie=[["Tanggal","Karyawan","Departemen","Jumlah","Metode","Status","Referensi","Catatan"],...h.map(ge=>{var Ee,Te;return[I(ge.payment_date),((Ee=ge.profiles)==null?void 0:Ee.name)||"Unknown",((Te=ge.profiles)==null?void 0:Te.department)||"-",ge.payment_amount,ge.payment_method==="bank_transfer"?"Transfer Bank":ge.payment_method==="cash"?"Tunai":"Lainnya",ge.payment_status,ge.payment_reference||"-",ge.notes||"-"]})].map(ge=>ge.join(",")).join(`
`),ce=new Blob([ie],{type:"text/csv;charset=utf-8;"}),ue=document.createElement("a"),he=URL.createObjectURL(ce);ue.setAttribute("href",he),ue.setAttribute("download",`salary_payments_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),URL.revokeObjectURL(he)};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4 text-sm sm:text-base",children:"Memuat data pembayaran..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(eu,{user:t,profile:a}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 space-y-4 sm:space-y-0",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Pembayaran Gaji"}),l.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Proses pembayaran gaji karyawan dan lihat riwayat transaksi"})]}),l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[l.jsxs("button",{onClick:()=>{u(!0),Promise.all([z(),U()]).finally(()=>u(!1))},className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",title:"Refresh Data",children:[l.jsx(_2,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),l.jsxs("button",{onClick:X,disabled:h.length===0,className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:[l.jsx(cp,{className:"h-4 w-4"}),l.jsx("span",{children:"Export CSV"})]})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[L&&l.jsxs("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-green-50 rounded-lg flex items-start space-x-2 sm:space-x-3",children:[l.jsx($t,{className:"h-4 sm:h-5 w-4 sm:w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700 text-sm sm:text-base",children:L}),l.jsx("button",{onClick:()=>P(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),_&&l.jsxs("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-red-50 rounded-lg flex items-start space-x-2 sm:space-x-3",children:[l.jsx(Pn,{className:"h-4 sm:h-5 w-4 sm:w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700 text-sm sm:text-base",children:_}),l.jsx("button",{onClick:()=>A(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Rf,{className:"h-5 sm:h-6 w-5 sm:w-6 text-green-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Dibayarkan"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:q(j.totalPaid)})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(br,{className:"h-5 sm:h-6 w-5 sm:w-6 text-blue-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Karyawan Dibayar"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:j.paidEmployees}),l.jsxs("p",{className:"text-xs text-blue-600",children:["dari ",j.totalEmployees," karyawan"]})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:l.jsx(ls,{className:"h-5 sm:h-6 w-5 sm:w-6 text-yellow-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Pembayaran Tertunda"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:j.pendingPayments})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-full flex items-center justify-center",children:l.jsx(qu,{className:"h-5 sm:h-6 w-5 sm:w-6 text-red-600"})}),l.jsxs("div",{className:"ml-3 sm:ml-4",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Belum Dibayar"}),l.jsx("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:j.totalEmployees-j.paidEmployees}),l.jsx("p",{className:"text-xs text-red-600",children:"karyawan"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"flex flex-col space-y-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:space-y-0",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Jd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 sm:h-5 w-4 sm:w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari nama, email, atau ID...",value:f,onChange:W=>g(W.target.value),className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("select",{value:b,onChange:W=>w(W.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),$().map(W=>l.jsx("option",{value:W,children:W},W))]}),l.jsxs("select",{value:m,onChange:W=>x(W.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"paid",children:"Sudah Dibayar"}),l.jsx("option",{value:"unpaid",children:"Belum Dibayar"}),l.jsx("option",{value:"processing",children:"Sedang Diproses"})]})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:[l.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(qu,{className:"h-4 sm:h-5 w-4 sm:w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:["Daftar Gaji Karyawan (",H.length,")"]})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):H.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"sm:hidden divide-y divide-gray-200",children:H.map(W=>{var ce,ue;const ie=(ce=W.employee_salaries)==null?void 0:ce[0];return R(W),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-sm",children:W.name.charAt(0).toUpperCase()})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:W.name}),l.jsx("div",{className:"text-xs text-gray-500",children:W.email})]})]}),l.jsxs("button",{onClick:()=>B(W),className:"flex items-center space-x-1 px-2 py-1 bg-green-600 text-white rounded text-xs",children:[l.jsx(zg,{className:"h-3 w-3"}),l.jsx("span",{children:"Bayar"})]})]}),l.jsxs("div",{className:"mt-3 text-xs text-gray-500 space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Jabatan:"})," ",((ue=W.positions)==null?void 0:ue.name_id)||W.title||"Karyawan"," - ",W.department||"Belum diatur"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Rekening:"})," ",W.bank_info?`${W.bank_info.bank_name} (${W.bank_account_number})`:l.jsx("span",{className:"text-yellow-600",children:"Belum diatur"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${K((ie==null?void 0:ie.payment_status)||"unpaid")}`,children:Z((ie==null?void 0:ie.payment_status)||"unpaid")}),(ie==null?void 0:ie.last_payment_date)&&l.jsxs("span",{className:"ml-2",children:["(",I(ie.last_payment_date),")"]})]})]})]},W.id)})}),l.jsx("div",{className:"hidden sm:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jabatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rekening Bank"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Pembayaran"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(W=>{var ce,ue;const ie=(ce=W.employee_salaries)==null?void 0:ce[0];return R(W),l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium",children:W.name.charAt(0).toUpperCase()})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:W.name}),l.jsx("div",{className:"text-sm text-gray-500",children:W.email}),W.employee_id&&l.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",W.employee_id]})]})]})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:((ue=W.positions)==null?void 0:ue.name_id)||W.title||"Karyawan"}),l.jsx("div",{className:"text-sm text-gray-500",children:W.department||"Belum diatur"})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:W.bank_info?l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:W.bank_info.bank_name}),l.jsx("div",{className:"text-sm text-gray-500",children:W.bank_account_number})]}):l.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:"Belum diatur"})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${K((ie==null?void 0:ie.payment_status)||"unpaid")}`,children:Z((ie==null?void 0:ie.payment_status)||"unpaid")}),(ie==null?void 0:ie.last_payment_date)&&l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Terakhir: ",I(ie.last_payment_date)]})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("button",{onClick:()=>B(W),className:"inline-flex items-center px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:[l.jsx(zg,{className:"h-3.5 w-3.5 mr-1"}),l.jsx("span",{children:"Bayar"})]})})]},W.id)})})]})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-12 sm:w-16 h-12 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(br,{className:"h-6 sm:h-8 w-6 sm:w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-base sm:text-lg mb-2",children:"Tidak ada karyawan ditemukan"}),l.jsx("p",{className:"text-gray-400 text-sm",children:"Coba sesuaikan pencarian atau filter Anda"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ls,{className:"h-4 sm:h-5 w-4 sm:w-5 text-blue-600"}),l.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Riwayat Pembayaran Terbaru"})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):h.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"sm:hidden divide-y divide-gray-200",children:h.slice(0,10).map(W=>{var ie;return l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((ie=W.profiles)==null?void 0:ie.name)||"Unknown"}),l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${W.payment_status==="completed"?"bg-green-100 text-green-800":W.payment_status==="pending"?"bg-yellow-100 text-yellow-800":W.payment_status==="processing"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:W.payment_status==="completed"?"Selesai":W.payment_status==="pending"?"Tertunda":W.payment_status==="processing"?"Diproses":"Gagal"})]}),l.jsxs("div",{className:"mt-3 text-xs text-gray-500 space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Tanggal:"})," ",I(W.payment_date)," ",new Date(W.created_at).toLocaleTimeString("id-ID")]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Jumlah:"})," ",q(W.payment_amount)]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Metode:"})," ",W.payment_method==="bank_transfer"?"Transfer Bank":W.payment_method==="cash"?"Tunai":"Lainnya"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Referensi:"})," ",W.payment_reference||"-"]}),W.notes&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Catatan:"})," ",W.notes]})]})]},W.id)})}),l.jsx("div",{className:"hidden sm:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jumlah"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Metode"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Referensi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.slice(0,10).map(W=>{var ie,ce;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:I(W.payment_date)}),l.jsx("div",{className:"text-xs text-gray-500",children:new Date(W.created_at).toLocaleTimeString("id-ID")})]}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:((ie=W.profiles)==null?void 0:ie.name)||"Unknown"}),l.jsx("div",{className:"text-xs text-gray-500",children:((ce=W.profiles)==null?void 0:ce.department)||"-"})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:q(W.payment_amount)})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:W.payment_method==="bank_transfer"?"Transfer Bank":W.payment_method==="cash"?"Tunai":"Lainnya"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${W.payment_status==="completed"?"bg-green-100 text-green-800":W.payment_status==="pending"?"bg-yellow-100 text-yellow-800":W.payment_status==="processing"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:W.payment_status==="completed"?"Selesai":W.payment_status==="pending"?"Tertunda":W.payment_status==="processing"?"Diproses":"Gagal"})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:W.payment_reference||"-"}),W.notes&&l.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:W.notes})]})]},W.id)})})]})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-12 sm:w-16 h-12 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Bl,{className:"h-6 sm:h-8 w-6 sm:w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-base sm:text-lg mb-2",children:"Belum ada riwayat pembayaran"}),l.jsx("p",{className:"text-gray-400 text-sm",children:"Pembayaran yang diproses akan muncul di sini"})]})]})]})]}),S&&y&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-md sm:max-w-lg max-h-[90vh] overflow-y-auto",children:l.jsx(w$,{employee:y,onClose:()=>D(!1),onPaymentProcessed:O})})})]})},k$=()=>{const e=wr(),[t,n]=ae.useState([]),[a,r]=ae.useState(!0),[i,s]=ae.useState(!1),[o,u]=ae.useState(""),[c,d]=ae.useState(!1),[h,p]=ae.useState(null),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(null),[S,D]=ae.useState({name:"",description:"",head_name:"",is_active:!0});ae.useEffect(()=>{_()},[]);const _=async()=>{try{const{data:{user:U}}=await Pe.auth.getUser();if(!U){e("/login");return}const{data:O}=await Pe.from("profiles").select("role").eq("id",U.id).single();if(!O||O.role!=="admin"){e("/dashboard");return}x(U),N(O),await A()}catch(U){console.error("Error checking access:",U),e("/login")}finally{r(!1)}},A=async()=>{s(!0);try{const{data:U,error:O}=await Pe.from("departments").select("*").order("name");if(O)throw O;n(U||[])}catch(U){console.error("Error fetching departments:",U),g("Gagal memuat data departemen")}finally{s(!1)}},L=U=>{const{name:O,value:B,type:q,checked:I}=U.target;D(K=>({...K,[O]:q==="checkbox"?I:B}))},P=()=>{D({name:"",description:"",head_name:"",is_active:!0}),p(null),d(!1),g(null)},j=async U=>{if(U.preventDefault(),g(null),!S.name.trim()){g("Nama departemen harus diisi");return}s(!0);try{const O={...S,updated_at:new Date().toISOString()};if(h){const{error:B}=await Pe.from("departments").update(O).eq("id",h.id);if(B)throw B;w("Departemen berhasil diperbarui!")}else{O.created_at=new Date().toISOString();const{error:B}=await Pe.from("departments").insert([O]);if(B)throw B;w("Departemen berhasil ditambahkan!")}P(),await A(),setTimeout(()=>w(null),3e3)}catch(O){console.error("Error saving department:",O),g("Gagal menyimpan departemen: "+O.message)}finally{s(!1)}},E=U=>{D({name:U.name,description:U.description||"",head_name:U.head_name||"",is_active:U.is_active}),p(U),d(!0)},F=async U=>{var O;if(confirm("Apakah Anda yakin ingin menghapus departemen ini?")){s(!0);try{const{data:B,error:q}=await Pe.from("positions").select("id").eq("department",(O=t.find(K=>K.id===U))==null?void 0:O.name).limit(1);if(q)throw q;if(B&&B.length>0){g("Departemen tidak dapat dihapus karena masih digunakan oleh jabatan");return}const{error:I}=await Pe.from("departments").delete().eq("id",U);if(I)throw I;w("Departemen berhasil dihapus!"),await A(),setTimeout(()=>w(null),3e3)}catch(B){console.error("Error deleting department:",B),g("Gagal menghapus departemen: "+B.message)}finally{s(!1)}}},z=t.filter(U=>U.name.toLowerCase().includes(o.toLowerCase())||U.description&&U.description.toLowerCase().includes(o.toLowerCase())||U.head_name&&U.head_name.toLowerCase().includes(o.toLowerCase()));return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data departemen..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row",children:[l.jsx(eu,{user:m,profile:y,className:"w-full md:w-64 md:fixed md:h-screen"}),l.jsxs("div",{className:"flex-1 md:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Departemen"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, dan kelola departemen perusahaan"})]}),l.jsxs("button",{onClick:()=>d(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[l.jsx(tv,{className:"h-4 w-4"}),l.jsx("span",{children:"Tambah Departemen"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[b&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:b}),l.jsx("button",{onClick:()=>w(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),f&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:f}),l.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ya,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Departemen"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx($t,{className:"h-5 w-5 text-green-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Departemen Aktif"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.filter(U=>U.is_active).length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(Fl,{className:"h-5 w-5 text-purple-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dengan Kepala"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.filter(U=>U.head_name).length})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(Jd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari departemen...",value:o,onChange:U=>u(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ya,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base font-medium text-gray-900",children:["Daftar Departemen (",z.length,")"]})]})}),i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):z.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ya,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada departemen ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau tambah departemen baru"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Departemen"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kepala Departemen"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(U=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ya,{className:"h-4 w-4 text-blue-600"})}),l.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name})]})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:U.description||"-"}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Fl,{className:"h-4 w-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-900",children:U.head_name||"Belum diatur"})]})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>E(U),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit Departemen",children:l.jsx(Wi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>F(U.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",title:"Hapus Departemen",children:l.jsx(Mf,{className:"h-4 w-4"})})]})})]},U.id))})]}),l.jsx("div",{className:"md:hidden p-4 space-y-4",children:z.map(U=>l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ya,{className:"h-4 w-4 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.name}),U.description&&l.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:U.description})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>E(U),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",children:l.jsx(Wi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>F(U.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",children:l.jsx(Mf,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Kepala:"})," ",U.head_name||"Belum diatur"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})]})]})]},U.id))})]})]})]})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md sm:max-w-lg bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:h?"Edit Departemen":"Tambah Departemen Baru"}),l.jsx("button",{onClick:P,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ui,{className:"h-5 w-5"})})]}),l.jsxs("form",{onSubmit:j,className:"space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Informasi Departemen"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Departemen *"}),l.jsx("input",{type:"text",name:"name",value:S.name,onChange:L,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: IT, HR, Finance"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),l.jsx("textarea",{name:"description",value:S.description,onChange:L,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Deskripsi singkat tentang departemen..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kepala Departemen"}),l.jsx("input",{type:"text",name:"head_name",value:S.head_name,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Nama kepala departemen"})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_active",checked:S.is_active,onChange:L,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Departemen aktif"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Batal"}),l.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:h?"Perbarui Departemen":"Simpan Departemen"})]})})]})]})]})})})]})},S$=()=>{const e=wr(),[t,n]=ae.useState([]),[a,r]=ae.useState([]),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState(""),[h,p]=ae.useState(""),[f,g]=ae.useState(!1),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(null),[S,D]=ae.useState(null),[_,A]=ae.useState(null),[L,P]=ae.useState({name_id:"",name_en:"",description_id:"",description_en:"",base_salary:0,min_salary:0,max_salary:0,department:"",is_active:!0});ae.useEffect(()=>{j()},[]);const j=async()=>{try{const{data:{user:Z}}=await Pe.auth.getUser();if(!Z){e("/login");return}const{data:R}=await Pe.from("profiles").select("role").eq("id",Z.id).single();if(!R||R.role!=="admin"){e("/dashboard");return}D(Z),A(R),await Promise.all([E(),F()])}catch(Z){console.error("Error checking access:",Z),e("/login")}finally{s(!1)}},E=async()=>{u(!0);try{const{data:Z,error:R}=await Pe.from("positions").select("*").order("created_at",{ascending:!1});if(R)throw R;n(Z||[])}catch(Z){console.error("Error fetching positions:",Z),x("Gagal memuat data jabatan")}finally{u(!1)}},F=async()=>{try{const{data:Z,error:R}=await Pe.from("departments").select("*").eq("is_active",!0).order("name");if(R)throw R;r(Z||[])}catch(Z){console.error("Error fetching departments:",Z)}},z=Z=>{const{name:R,value:H,type:$,checked:X}=Z.target;P(W=>({...W,[R]:$==="checkbox"?X:H}))},U=()=>{P({name_id:"",name_en:"",description_id:"",description_en:"",base_salary:0,min_salary:0,max_salary:0,department:"",is_active:!0}),w(null),g(!1),x(null)},O=async Z=>{if(Z.preventDefault(),x(null),!L.name_id.trim()||!L.name_en.trim()){x("Nama jabatan (Indonesia dan English) harus diisi");return}if(!L.department){x("Departemen harus dipilih");return}if(L.min_salary>L.max_salary){x("Gaji minimum tidak boleh lebih besar dari gaji maksimum");return}u(!0);try{const R={name_id:L.name_id,name_en:L.name_en,description_id:L.description_id||null,description_en:L.description_en||null,base_salary:parseFloat(L.base_salary)||0,min_salary:parseFloat(L.min_salary)||0,max_salary:parseFloat(L.max_salary)||0,department:L.department,is_active:L.is_active,updated_at:new Date().toISOString()};if(b){const{error:H}=await Pe.from("positions").update(R).eq("id",b.id);if(H)throw H;N("Jabatan berhasil diperbarui!")}else{R.created_at=new Date().toISOString();const{error:H}=await Pe.from("positions").insert([R]);if(H)throw H;N("Jabatan berhasil ditambahkan!")}U(),await E(),setTimeout(()=>N(null),3e3)}catch(R){console.error("Error saving position:",R),x("Gagal menyimpan jabatan: "+R.message)}finally{u(!1)}},B=Z=>{P({name_id:Z.name_id,name_en:Z.name_en,description_id:Z.description_id||"",description_en:Z.description_en||"",base_salary:Z.base_salary||0,min_salary:Z.min_salary||0,max_salary:Z.max_salary||0,department:Z.department||"",is_active:Z.is_active}),w(Z),g(!0)},q=async Z=>{if(confirm("Apakah Anda yakin ingin menghapus jabatan ini?")){u(!0);try{const{data:R,error:H}=await Pe.from("profiles").select("id").eq("position_id",Z).limit(1);if(H)throw H;if(R&&R.length>0){x("Jabatan tidak dapat dihapus karena masih digunakan oleh karyawan");return}const{error:$}=await Pe.from("positions").delete().eq("id",Z);if($)throw $;N("Jabatan berhasil dihapus!"),await E(),setTimeout(()=>N(null),3e3)}catch(R){console.error("Error deleting position:",R),x("Gagal menghapus jabatan: "+R.message)}finally{u(!1)}}},I=Z=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(Z),K=t.filter(Z=>{var $;const R=Z.name_id.toLowerCase().includes(c.toLowerCase())||Z.name_en.toLowerCase().includes(c.toLowerCase())||Z.department&&Z.department.toLowerCase().includes(c.toLowerCase()),H=h===""||Z.department===(($=a.find(X=>X.id===h))==null?void 0:$.name);return R&&H});return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data jabatan..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(eu,{user:S,profile:_}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kelola Jabatan"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, dan kelola jabatan beserta struktur gaji"})]}),l.jsxs("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(tv,{className:"h-4 w-4"}),l.jsx("span",{children:"Tambah Jabatan"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[y&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:y}),l.jsx("button",{onClick:()=>N(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),m&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:m}),l.jsx("button",{onClick:()=>x(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(df,{className:"h-6 w-6 text-blue-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Jabatan"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Fl,{className:"h-6 w-6 text-green-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Jabatan Aktif"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(Z=>Z.is_active).length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(Rf,{className:"h-6 w-6 text-purple-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rata-rata Gaji"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.length>0?I(t.reduce((Z,R)=>Z+(R.base_salary||0),0)/t.length):I(0)})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative",children:[l.jsx(Jd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari jabatan atau departemen...",value:c,onChange:Z=>d(Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),l.jsx("div",{className:"sm:w-48",children:l.jsxs("select",{value:h,onChange:Z=>p(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),a.map(Z=>l.jsx("option",{value:Z.id,children:Z.name},Z.id))]})})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(df,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Daftar Jabatan (",K.length,")"]})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):K.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jabatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departemen"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gaji Pokok"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rentang Gaji"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(Z=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:Z.name_id}),l.jsx("div",{className:"text-sm text-gray-500",children:Z.name_en}),Z.description_id&&l.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Z.description_id})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:Z.department||"Tidak ada"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:I(Z.base_salary||0)})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"text-sm text-gray-900",children:[I(Z.min_salary||0)," - ",I(Z.max_salary||0)]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Z.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Z.is_active?"Aktif":"Tidak Aktif"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>B(Z),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit Jabatan",children:l.jsx(Wi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>q(Z.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",title:"Hapus Jabatan",children:l.jsx(Mf,{className:"h-4 w-4"})})]})})]},Z.id))})]})}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(df,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada jabatan ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau tambah jabatan baru"})]})]})]})]}),f&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:b?"Edit Jabatan":"Tambah Jabatan Baru"}),l.jsx("button",{onClick:U,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ui,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:O,className:"space-y-6",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informasi Dasar"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Jabatan (Indonesia) *"}),l.jsx("input",{type:"text",name:"name_id",value:L.name_id,onChange:z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: Manager IT"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Jabatan (English) *"}),l.jsx("input",{type:"text",name:"name_en",value:L.name_en,onChange:z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Example: IT Manager"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departemen *"}),l.jsxs("select",{name:"department",value:L.department,onChange:z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Pilih Departemen..."}),a.map(Z=>l.jsx("option",{value:Z.name,children:Z.name},Z.id))]})]})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Deskripsi Jabatan"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi (Indonesia)"}),l.jsx("textarea",{name:"description_id",value:L.description_id,onChange:z,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Deskripsi tugas dan tanggung jawab..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi (English)"}),l.jsx("textarea",{name:"description_en",value:L.description_en,onChange:z,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Job description and responsibilities..."})]})]})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informasi Gaji"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gaji Pokok (IDR)"}),l.jsx("input",{type:"number",name:"base_salary",value:L.base_salary,onChange:z,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"5000000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gaji Minimum (IDR)"}),l.jsx("input",{type:"number",name:"min_salary",value:L.min_salary,onChange:z,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"4000000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gaji Maksimum (IDR)"}),l.jsx("input",{type:"number",name:"max_salary",value:L.max_salary,onChange:z,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"8000000"})]})]}),l.jsx("div",{className:"mt-3 p-3 bg-white rounded border",children:l.jsxs("div",{className:"text-sm text-gray-600",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Gaji Pokok:"})," ",I(L.base_salary||0)]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Rentang:"})," ",I(L.min_salary||0)," - ",I(L.max_salary||0)]})]})})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_active",checked:L.is_active,onChange:z,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Jabatan aktif (dapat dipilih saat menambah karyawan)"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:U,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),l.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:b?"Perbarui Jabatan":"Simpan Jabatan"})]})})]})]})]})})})]})},_$=()=>{var ie,ce,ue;const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState([]),[o,u]=ae.useState(!0),[c,d]=ae.useState(!1),[h,p]=ae.useState("face"),[f,g]=ae.useState(!1),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(!1),[S,D]=ae.useState(null),[_,A]=ae.useState(null),[L,P]=ae.useState({name:"",full_name:"",phone:"",location:"",bio:""}),[j,E]=ae.useState({bank_id:"",bank_account_number:"",bank_account_name:""}),[F,z]=ae.useState({currentPassword:"",newPassword:"",confirmPassword:""});ae.useEffect(()=>{U()},[]);const U=async()=>{try{const{data:{user:he}}=await Pe.auth.getUser();if(!he){e("/login");return}n(he),await Promise.all([O(he.id),B()])}catch(he){console.error("Error checking user:",he),e("/login")}finally{u(!1)}},O=async he=>{try{const{data:ge,error:Ee}=await Pe.from("profiles").select(`
          *,
          positions(name_id, department),
          bank_info(id, bank_name, bank_logo)
        `).eq("id",he).maybeSingle();if(Ee&&Ee.code!=="PGRST116")throw Ee;ge&&(r(ge),d(ge.role==="admin"),P({name:ge.name||"",full_name:ge.full_name||"",phone:ge.phone||"",location:ge.location||"",bio:ge.bio||""}),E({bank_id:ge.bank_id||"",bank_account_number:ge.bank_account_number||"",bank_account_name:ge.bank_account_name||ge.full_name||ge.name||""}))}catch(ge){console.error("Error fetching profile:",ge)}},B=async()=>{try{const{data:he,error:ge}=await Pe.from("bank_info").select("*").eq("is_active",!0).order("bank_name");if(ge)throw ge;s(he||[])}catch(he){console.error("Error fetching banks:",he)}},q=(he,ge)=>{w(he),x(ge),D(null),console.log("✅ Face captured with custom fingerprint")},I=async()=>{if(!b||!m){D("Silakan ambil foto wajah terlebih dahulu");return}N(!0),D(null);try{console.log("Starting face photo save process...");const he=Date.now(),ge=`${t.id}-face-${he}.jpg`;console.log("Uploading face photo with filename:",ge),await v0(b,"face-photos",ge);const Ee=x0("face-photos",ge);console.log("Photo uploaded successfully, URL:",Ee);const{error:Te}=await Pe.from("profiles").update({avatar_url:Ee,is_face_registered:!0,updated_at:new Date().toISOString()}).eq("id",t.id);if(Te)throw console.error("Profile update error:",Te),new Error(`Gagal menyimpan profil: ${Te.message}`);console.log("Profile updated successfully"),A("Foto wajah berhasil disimpan!"),await O(t.id),w(null),x(null)}catch(he){console.error("Error saving face photo:",he),D(he.message||"Gagal menyimpan foto wajah. Silakan coba lagi.")}finally{N(!1)}},K=async()=>{N(!0),D(null);try{const{error:he}=await Pe.from("profiles").update({...L,updated_at:new Date().toISOString()}).eq("id",t.id);if(he)throw he;A("Profil berhasil diperbarui!"),await O(t.id)}catch(he){console.error("Error updating profile:",he),D("Gagal memperbarui profil. Silakan coba lagi.")}finally{N(!1)}},Z=async()=>{if(!j.bank_id){D("Silakan pilih bank terlebih dahulu");return}if(!j.bank_account_number){D("Nomor rekening harus diisi");return}N(!0),D(null);try{const{error:he}=await Pe.from("profiles").update({bank_id:j.bank_id,bank_account_number:j.bank_account_number,bank_account_name:j.bank_account_name,updated_at:new Date().toISOString()}).eq("id",t.id);if(he)throw he;A("Informasi rekening berhasil diperbarui!"),await O(t.id)}catch(he){console.error("Error updating bank info:",he),D("Gagal memperbarui informasi rekening. Silakan coba lagi.")}finally{N(!1)}},R=async()=>{if(F.newPassword!==F.confirmPassword){D("Password baru dan konfirmasi password tidak cocok");return}if(F.newPassword.length<6){D("Password baru minimal 6 karakter");return}N(!0),D(null);try{const{error:he}=await Pe.auth.updateUser({password:F.newPassword});if(he)throw he;await Pe.from("password_changes").insert([{user_id:t.id,changed_by:t.id,change_type:"self_change",ip_address:"unknown",user_agent:navigator.userAgent}]),A("Password berhasil diubah!"),z({currentPassword:"",newPassword:"",confirmPassword:""})}catch(he){console.error("Error changing password:",he),D("Gagal mengubah password. Silakan coba lagi.")}finally{N(!1)}},H=he=>{const{name:ge,value:Ee}=he.target;P(Te=>({...Te,[ge]:Ee}))},$=he=>{const{name:ge,value:Ee}=he.target;E(Te=>({...Te,[ge]:Ee}))},X=he=>{const{name:ge,value:Ee}=he.target;z(Te=>({...Te,[ge]:Ee}))},W=()=>i.find(he=>he.id===j.bank_id);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat profil..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-700 to-blue-500 shadow-md border-b",children:l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex items-center justify-between py-6",children:l.jsxs("div",{className:"flex items-center space-x-5",children:[l.jsx("button",{onClick:()=>e("/dashboard"),className:"p-2 bg-white/30 hover:bg-white/50 rounded-full shadow transition-colors",title:"Kembali ke Dashboard",children:l.jsx(lS,{className:"h-6 w-6 text-blue-700"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-extrabold text-white tracking-tight drop-shadow",children:"Kelola Profil"}),l.jsx("p",{className:"text-base text-blue-100 mt-1",children:"Atur foto wajah, data pribadi, dan keamanan akun Anda"})]})]})})})}),l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-green-700 font-medium",children:"Berhasil!"}),l.jsx("p",{className:"text-green-600 text-sm mt-1",children:_})]})]}),S&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-red-700 font-medium",children:"Error"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:S})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-8 border border-gray-100 flex flex-col md:flex-row items-center md:items-start gap-8",children:[l.jsx("div",{className:"w-28 h-28 bg-blue-100 rounded-full flex items-center justify-center overflow-hidden shadow border-4 border-white",children:a!=null&&a.avatar_url?l.jsx("img",{src:a.avatar_url,alt:"Profile",className:"w-full h-full object-cover"}):l.jsx(br,{className:"h-12 w-12 text-blue-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 truncate",children:(a==null?void 0:a.full_name)||(a==null?void 0:a.name)||((ie=t==null?void 0:t.email)==null?void 0:ie.split("@")[0])||"Pengguna"}),l.jsx("button",{onClick:()=>g(!0),className:"ml-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-full shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400",title:"Edit Profil",children:"Edit"})]}),f&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-lg p-8 relative animate-fade-in",children:[l.jsx("button",{onClick:()=>g(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10",title:"Tutup Edit Profil",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Profil"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:(a==null?void 0:a.full_name)||""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:(a==null?void 0:a.email)||"",disabled:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No. Telepon"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:(a==null?void 0:a.phone)||""})]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200",children:"Batal"}),l.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:"Simpan"})]})]})]})}),l.jsx("p",{className:"text-base text-gray-500 mb-2 truncate",children:(a==null?void 0:a.email)||(t==null?void 0:t.email)}),l.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[((ce=a==null?void 0:a.positions)==null?void 0:ce.name_id)&&l.jsx("span",{className:"text-sm text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full",children:a.positions.name_id}),((ue=a==null?void 0:a.positions)==null?void 0:ue.department)&&l.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:a.positions.department}),(a==null?void 0:a.employee_id)&&l.jsxs("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:["ID: ",a.employee_id]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[l.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium shadow-sm ${a!=null&&a.is_face_registered?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:[l.jsx(Ld,{className:"h-4 w-4"}),l.jsx("span",{children:a!=null&&a.is_face_registered?"Wajah Terdaftar":"Wajah Belum Terdaftar"})]}),(a==null?void 0:a.bank_info)&&l.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 font-medium shadow-sm",children:[l.jsx(ya,{className:"h-4 w-4"}),l.jsxs("span",{children:["Rekening ",a.bank_info.bank_name]})]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100",children:[l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"flex flex-wrap",children:[l.jsxs("button",{onClick:()=>{(c||!(a!=null&&a.is_face_registered))&&p("face")},className:`px-6 py-4 text-sm font-medium ${h==="face"?"border-b-2 border-blue-500 text-blue-600":a!=null&&a.is_face_registered&&!c?"text-gray-400 cursor-not-allowed":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(Ld,{className:"h-4 w-4 inline mr-2"}),"Foto Wajah"]}),l.jsxs("button",{onClick:()=>p("profile"),className:`px-6 py-4 text-sm font-medium ${h==="profile"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(Wi,{className:"h-4 w-4 inline mr-2"}),"Informasi Pribadi"]}),l.jsxs("button",{onClick:()=>p("bank"),className:`px-6 py-4 text-sm font-medium ${h==="bank"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(ya,{className:"h-4 w-4 inline mr-2"}),"Rekening Bank"]}),l.jsxs("button",{onClick:()=>p("password"),className:`px-6 py-4 text-sm font-medium ${h==="password"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[l.jsx(_l,{className:"h-4 w-4 inline mr-2"}),"Ubah Password"]})]})}),l.jsxs("div",{className:"p-6",children:[h==="face"&&l.jsx("div",{children:a!=null&&a.is_face_registered&&!c?l.jsxs("div",{className:"text-center py-8",children:[l.jsxs("div",{className:"w-24 h-24 mx-auto mb-4 relative",children:[a.avatar_url?l.jsx("img",{src:a.avatar_url,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-green-100"}):l.jsx("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(br,{className:"h-12 w-12 text-blue-600"})}),l.jsx("div",{className:"absolute bottom-0 right-0 bg-green-500 text-white p-1 rounded-full",children:l.jsx($t,{className:"h-5 w-5"})})]}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Wajah Terverifikasi"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Foto wajah Anda telah terdaftar dan terverifikasi dalam sistem. Anda dapat menggunakan verifikasi wajah untuk absensi."}),l.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg text-left",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-yellow-800 font-medium",children:"Perhatian"}),l.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Foto wajah yang sudah terverifikasi tidak dapat diubah oleh pengguna. Jika Anda perlu mengubah foto wajah, silakan hubungi administrator."})]})]})})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Setup Foto Wajah"}),l.jsx("p",{className:"text-gray-600",children:"Foto wajah digunakan untuk verifikasi absensi yang aman dan akurat"})]}),l.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"✨ Keunggulan Sistem Kami"}),l.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[l.jsx("li",{children:"• Teknologi pengenalan wajah yang aman dan cepat"}),l.jsx("li",{children:"• Tidak memerlukan download model AI eksternal"}),l.jsx("li",{children:"• Analisis pola wajah dengan algoritma custom"}),l.jsx("li",{children:"• Data tersimpan aman dengan enkripsi"})]})]}),l.jsx(Qv,{onFaceCapture:q,isCapturing:y}),b&&l.jsxs("div",{className:"mt-6 text-center",children:[l.jsxs("div",{className:"inline-flex items-center space-x-2 text-green-600 mb-4",children:[l.jsx($t,{className:"h-5 w-5"}),l.jsx("span",{children:"Foto wajah berhasil diambil dan diverifikasi!"})]}),l.jsx("button",{onClick:I,disabled:y,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Foto Wajah"})]})})]})]})}),h==="profile"&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informasi Pribadi"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Panggilan"}),l.jsx("input",{type:"text",name:"name",value:L.name,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nama panggilan"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),l.jsx("input",{type:"text",name:"full_name",value:L.full_name,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nama lengkap"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(hS,{className:"h-4 w-4 inline mr-1"}),"Nomor Telepon"]}),l.jsx("input",{type:"tel",name:"phone",value:L.phone,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+62-21-1234567"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(qi,{className:"h-4 w-4 inline mr-1"}),"Lokasi"]}),l.jsx("input",{type:"text",name:"location",value:L.location,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Jakarta, Indonesia"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),l.jsx("textarea",{name:"bio",value:L.bio,onChange:H,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ceritakan sedikit tentang diri Anda..."})]}),l.jsx("button",{onClick:K,disabled:y,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Perubahan"})]})})]})]}),h==="bank"&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informasi Rekening Bank"}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-100 mb-6",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(ya,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Informasi Rekening untuk Gaji"}),l.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Informasi rekening bank Anda digunakan untuk pembayaran gaji dan tunjangan. Pastikan data yang dimasukkan sudah benar."})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(ya,{className:"h-4 w-4 inline mr-1"}),"Pilih Bank *"]}),l.jsx("div",{className:"relative",children:l.jsxs("select",{name:"bank_id",value:j.bank_id,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Pilih Bank..."}),i.map(he=>l.jsx("option",{value:he.id,children:he.bank_name},he.id))]})}),W()&&l.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-sm text-gray-600",children:[W().bank_logo&&l.jsx("img",{src:W().bank_logo,alt:W().bank_name,className:"w-6 h-6 object-contain",onError:he=>{he.target.onerror=null,he.target.src="",he.target.parentElement.innerHTML=`
                                  <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600">
                                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    </svg>
                                  </div>
                                `}}),W()&&l.jsxs("span",{children:["Bank ",W().bank_name]})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(qu,{className:"h-4 w-4 inline mr-1"}),"Nomor Rekening *"]}),l.jsx("input",{type:"text",name:"bank_account_number",value:j.bank_account_number,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan nomor rekening tanpa spasi"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.jsx(br,{className:"h-4 w-4 inline mr-1"}),"Nama Pemilik Rekening"]}),l.jsx("input",{type:"text",name:"bank_account_name",value:j.bank_account_name,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50",placeholder:"Nama sesuai saat pendaftaran",readOnly:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nama pemilik rekening otomatis menggunakan nama lengkap dari profil Anda"})]}),l.jsx("button",{onClick:Z,disabled:y,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Menyimpan..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Informasi Rekening"})]})}),l.jsxs("div",{className:"mt-8",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Bank Tersedia"}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:i.map(he=>l.jsx("div",{className:`p-4 rounded-xl border transition-all cursor-pointer ${j.bank_id===he.id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,onClick:()=>E(ge=>({...ge,bank_id:he.id})),children:l.jsxs("div",{className:"flex flex-col items-center text-center",children:[he.bank_logo?l.jsx("img",{src:he.bank_logo,alt:he.bank_name,className:"w-12 h-12 object-contain mb-3"}):l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-3",children:l.jsx(ya,{className:"h-5 w-5 text-blue-600"})}),l.jsx("span",{className:"text-sm font-medium text-gray-800",children:he.bank_name}),j.bank_id===he.id&&l.jsxs("div",{className:"mt-2 text-xs text-blue-600 flex items-center",children:[l.jsx($t,{className:"h-3 w-3 mr-1"}),"Dipilih"]})]})},he.id))})]})]})]}),h==="password"&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Ubah Password"}),l.jsxs("div",{className:"space-y-6 max-w-md",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Saat Ini"}),l.jsx("input",{type:"password",name:"currentPassword",value:F.currentPassword,onChange:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan password saat ini"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Baru"}),l.jsx("input",{type:"password",name:"newPassword",value:F.newPassword,onChange:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan password baru (min. 6 karakter)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Password Baru"}),l.jsx("input",{type:"password",name:"confirmPassword",value:F.confirmPassword,onChange:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Konfirmasi password baru"})]}),l.jsx("button",{onClick:R,disabled:y||!F.newPassword||!F.confirmPassword,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("span",{children:"Mengubah..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(_l,{className:"h-4 w-4"}),l.jsx("span",{children:"Ubah Password"})]})})]}),l.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-100",children:[l.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"🔒 Tips Keamanan Password"}),l.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[l.jsx("p",{children:"• Gunakan minimal 6 karakter"}),l.jsx("p",{children:"• Kombinasikan huruf besar, kecil, dan angka"}),l.jsx("p",{children:"• Jangan gunakan informasi pribadi yang mudah ditebak"}),l.jsx("p",{children:"• Ubah password secara berkala"})]})]})]})]})]}),l.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl border border-gray-200",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"🔒 Keamanan & Privasi"}),l.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[l.jsx("p",{children:"• Foto wajah dienkripsi dan disimpan dengan aman"}),l.jsx("p",{children:"• Menggunakan algoritma fingerprinting custom yang aman"}),l.jsx("p",{children:"• Hanya digunakan untuk verifikasi absensi"}),l.jsx("p",{children:"• Data rekening bank hanya digunakan untuk pembayaran gaji"}),l.jsx("p",{children:"• Data tidak dibagikan kepada pihak ketiga"}),l.jsx("p",{children:"• Anda dapat mengubah informasi kapan saja"})]})]})]})]})},j$=({initialLocation:e,onLocationSelect:t,onCancel:n,radius:a=100})=>{const[r,i]=ae.useState(e||{lat:-6.2,lng:106.816666}),[s,o]=ae.useState(""),[u,c]=ae.useState(!1),[d,h]=ae.useState(null),[p,f]=ae.useState(null);ae.useEffect(()=>{e&&(i(e),o(e.address||""))},[e]);const g=()=>{if(!navigator.geolocation){h("Geolokasi tidak didukung oleh browser ini.");return}c(!0),h(null),navigator.geolocation.getCurrentPosition(N=>{const S={lat:N.coords.latitude,lng:N.coords.longitude};i(S),o(`${S.lat.toFixed(6)}, ${S.lng.toFixed(6)}`),f("Lokasi saat ini berhasil didapatkan!"),c(!1)},N=>{console.error("Geolocation error:",N);let S="Gagal mendapatkan lokasi saat ini.";switch(N.code){case N.PERMISSION_DENIED:S="Akses lokasi ditolak. Silakan izinkan akses lokasi.";break;case N.POSITION_UNAVAILABLE:S="Informasi lokasi tidak tersedia.";break;case N.TIMEOUT:S="Permintaan lokasi timeout.";break}h(S),c(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},b=(N,S)=>{const D=parseFloat(S);isNaN(D)||(i(_=>({..._,[N]:D})),h(null))},w=()=>!r.lat||!r.lng?(h("Koordinat latitude dan longitude harus diisi."),!1):r.lat<-90||r.lat>90?(h("Latitude harus antara -90 dan 90."),!1):r.lng<-180||r.lng>180?(h("Longitude harus antara -180 dan 180."),!1):s.trim()?!0:(h("Alamat kantor harus diisi."),!1),m=()=>{w()&&t&&t({latitude:r.lat,longitude:r.lng,address:s.trim(),radius:a})},x=[{name:"Jakarta Pusat",lat:-6.2,lng:106.816666,address:"Jakarta Pusat, DKI Jakarta, Indonesia"},{name:"Surabaya",lat:-7.257472,lng:112.75209,address:"Surabaya, Jawa Timur, Indonesia"},{name:"Bandung",lat:-6.917464,lng:107.619123,address:"Bandung, Jawa Barat, Indonesia"},{name:"Medan",lat:3.595196,lng:98.672226,address:"Medan, Sumatera Utara, Indonesia"},{name:"Yogyakarta",lat:-7.797068,lng:110.370529,address:"Yogyakarta, DI Yogyakarta, Indonesia"}],y=N=>{i({lat:N.lat,lng:N.lng}),o(N.address),f(`Lokasi ${N.name} dipilih!`),h(null)};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(qi,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Atur Lokasi Kantor"}),l.jsx("p",{className:"text-gray-600",children:"Tentukan koordinat dan alamat lokasi kantor untuk sistem absensi"})]}),p&&l.jsxs("div",{className:"p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:p})]}),d&&l.jsxs("div",{className:"p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(zu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:d})]}),l.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-blue-900",children:"Gunakan Lokasi Saat Ini"}),l.jsx("p",{className:"text-sm text-blue-700",children:"Otomatis mengisi koordinat berdasarkan GPS"})]}),l.jsxs("button",{onClick:g,disabled:u,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(fS,{className:`h-4 w-4 ${u?"animate-spin":""}`}),l.jsx("span",{children:u?"Mencari...":"Gunakan GPS"})]})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Lokasi Populer"}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:x.map(N=>l.jsxs("button",{onClick:()=>y(N),className:"p-3 text-left bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:[l.jsx("div",{className:"font-medium text-gray-900",children:N.name}),l.jsxs("div",{className:"text-xs text-gray-500",children:[N.lat.toFixed(4),", ",N.lng.toFixed(4)]})]},N.name))})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Input Manual Koordinat"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alamat Kantor *"}),l.jsx("input",{type:"text",value:s,onChange:N=>o(N.target.value),placeholder:"Contoh: Jl. Sudirman No. 1, Jakarta Pusat",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude *"}),l.jsx("input",{type:"number",step:"any",value:r.lat||"",onChange:N=>b("lat",N.target.value),placeholder:"-6.200000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Rentang: -90 hingga 90"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude *"}),l.jsx("input",{type:"number",step:"any",value:r.lng||"",onChange:N=>b("lng",N.target.value),placeholder:"106.816666",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Rentang: -180 hingga 180"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Radius Absensi (meter)"}),l.jsx("input",{type:"number",value:a,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Karyawan harus berada dalam radius ini untuk dapat absen"})]})]})]}),r.lat&&r.lng&&l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Preview Lokasi"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(qi,{className:"h-4 w-4 text-gray-500 mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"text-gray-700",children:s||"Alamat belum diisi"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Latitude:"})," ",r.lat.toFixed(6)]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Longitude:"})," ",r.lng.toFixed(6)]})]}),l.jsxs("div",{className:"text-gray-600",children:[l.jsx("span",{className:"font-medium",children:"Radius Absensi:"})," ",a," meter"]})]})]}),l.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"💡 Tips Mencari Koordinat"}),l.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[l.jsx("p",{children:"• Buka Google Maps di browser"}),l.jsx("p",{children:"• Cari alamat kantor Anda"}),l.jsx("p",{children:"• Klik kanan pada lokasi yang tepat"}),l.jsx("p",{children:"• Pilih koordinat yang muncul (contoh: -6.200000, 106.816666)"}),l.jsx("p",{children:"• Copy dan paste ke form di atas"})]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:n,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Ui,{className:"h-4 w-4"}),l.jsx("span",{children:"Batal"})]})}),l.jsx("button",{onClick:m,disabled:!r.lat||!r.lng||!s.trim(),className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:"Simpan Lokasi"})]})})]})]})},C$=()=>{const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(null),[c,d]=ae.useState(!1),[h,p]=ae.useState(100),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(!1);ae.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:{user:A}}=await Pe.auth.getUser();if(!A){e("/login");return}const{data:L}=await Pe.from("profiles").select("role").eq("id",A.id).single();if(!L||L.role!=="admin"){e("/dashboard");return}n(A),r(L),await N()}catch(A){console.error("Error checking access:",A),e("/login")}finally{s(!1)}},N=async()=>{try{const{data:A,error:L}=await Pe.from("system_settings").select("setting_value").eq("setting_key","office_location").maybeSingle();if(L&&L.code!=="PGRST116")throw L;A!=null&&A.setting_value?(u(A.setting_value),p(A.setting_value.radius||100)):u({latitude:-6.2,longitude:106.816666,address:"Jakarta, Indonesia",radius:100})}catch(A){console.error("Error fetching office location:",A),g("Gagal memuat pengaturan lokasi kantor")}},S=async A=>{x(!0),g(null);try{const L={latitude:A.latitude,longitude:A.longitude,address:A.address,radius:h},{error:P}=await Pe.from("system_settings").upsert({setting_key:"office_location",setting_value:L,description:"Lokasi kantor utama dan radius absensi",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(P)throw P;u(L),d(!1),w("Lokasi kantor berhasil diperbarui!"),setTimeout(()=>w(null),3e3)}catch(L){console.error("Error saving office location:",L),g("Gagal menyimpan lokasi kantor")}finally{x(!1)}},D=async A=>{if(o){x(!0),g(null);try{const L={...o,radius:parseInt(A)},{error:P}=await Pe.from("system_settings").upsert({setting_key:"office_location",setting_value:L,description:"Lokasi kantor utama dan radius absensi",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(P)throw P;u(L),p(parseInt(A)),w("Radius absensi berhasil diperbarui!"),setTimeout(()=>w(null),3e3)}catch(L){console.error("Error updating radius:",L),g("Gagal memperbarui radius absensi")}finally{x(!1)}}},_=()=>{if(o){const A=`https://www.google.com/maps?q=${o.latitude},${o.longitude}`;window.open(A,"_blank")}};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat pengaturan lokasi..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(eu,{user:t,profile:a}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex items-center justify-between py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pengaturan Lokasi Kantor"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Kelola lokasi kantor dan radius absensi tanpa Google Maps"})]})})})}),l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[b&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:b})]}),f&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(zu,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:f})]}),c?l.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:l.jsx(j$,{initialLocation:o?{lat:o.latitude,lng:o.longitude,address:o.address}:null,radius:h,onLocationSelect:S,onCancel:()=>d(!1)})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Lokasi Kantor Saat Ini"}),l.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Wi,{className:"h-4 w-4"}),l.jsx("span",{children:"Edit Lokasi"})]})]}),o?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(qi,{className:"h-5 w-5 text-blue-600 mt-1 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Alamat"}),l.jsx("p",{className:"text-gray-600",children:o.address})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Koordinat"}),l.jsxs("p",{className:"text-gray-600",children:[o.latitude.toFixed(6),", ",o.longitude.toFixed(6)]})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Radius Absensi"}),l.jsxs("p",{className:"text-gray-600",children:[o.radius," meter"]})]})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{onClick:_,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(fS,{className:"h-4 w-4"}),l.jsx("span",{children:"Lihat di Google Maps"})]})})]}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(qi,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500",children:"Lokasi kantor belum diatur"}),l.jsx("button",{onClick:()=>d(!0),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Atur Lokasi Sekarang"})]})]}),o&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Pengaturan Radius Absensi"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Radius Absensi (meter)"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("input",{type:"range",min:"50",max:"500",step:"10",value:h,onChange:A=>p(parseInt(A.target.value)),className:"flex-1"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"number",min:"50",max:"500",value:h,onChange:A=>p(parseInt(A.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("span",{className:"text-gray-600",children:"m"})]})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Karyawan harus berada dalam radius ini untuk dapat melakukan absensi"})]}),l.jsxs("button",{onClick:()=>D(h),disabled:m||h===o.radius,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:m?"Menyimpan...":"Simpan Radius"})]})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[l.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"✨ Keunggulan Sistem Tanpa Google Maps"}),l.jsxs("div",{className:"space-y-2 text-sm text-blue-700",children:[l.jsx("p",{children:"• Tidak memerlukan API key Google Maps yang berbayar"}),l.jsx("p",{children:"• Sistem tetap akurat menggunakan koordinat GPS"}),l.jsx("p",{children:"• Mudah digunakan dengan preset lokasi populer"}),l.jsx("p",{children:"• Dapat menggunakan GPS untuk mendapatkan lokasi saat ini"}),l.jsx("p",{children:"• Koordinat dapat dicari manual dari Google Maps"}),l.jsx("p",{children:"• Sistem validasi radius tetap berfungsi dengan sempurna"})]})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"📋 Cara Menggunakan"}),l.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"1. Gunakan GPS:"}),' Klik "Gunakan GPS" untuk otomatis mengisi koordinat lokasi saat ini']}),l.jsxs("p",{children:[l.jsx("strong",{children:"2. Pilih Preset:"})," Pilih dari lokasi populer yang sudah tersedia"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"3. Input Manual:"})," Cari koordinat di Google Maps dan input manual"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"4. Atur Radius:"})," Sesuaikan radius absensi sesuai kebutuhan (50-500 meter)"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"5. Simpan:"})," Klik simpan untuk menerapkan pengaturan"]})]})]})]})]})]})]})},A$=()=>{const e=wr(),[t,n]=ae.useState([]),[a,r]=ae.useState(!0),[i,s]=ae.useState(!1),[o,u]=ae.useState(""),[c,d]=ae.useState(!1),[h,p]=ae.useState(null),[f,g]=ae.useState(null),[b,w]=ae.useState(null),[m,x]=ae.useState(null),[y,N]=ae.useState(null),[S,D]=ae.useState({bank_name:"",bank_code:"",bank_logo:"",description:"",is_active:!0});ae.useEffect(()=>{_()},[]);const _=async()=>{try{const{data:{user:U}}=await Pe.auth.getUser();if(!U){e("/login");return}const{data:O}=await Pe.from("profiles").select("role").eq("id",U.id).single();if(!O||O.role!=="admin"){e("/dashboard");return}x(U),N(O),await A()}catch(U){console.error("Error checking access:",U),e("/login")}finally{r(!1)}},A=async()=>{s(!0);try{const{data:U,error:O}=await Pe.from("bank_info").select("*").order("bank_name");if(O)throw O;n(U||[])}catch(U){console.error("Error fetching banks:",U),g("Gagal memuat data bank")}finally{s(!1)}},L=U=>{const{name:O,value:B,type:q,checked:I}=U.target;D(K=>({...K,[O]:q==="checkbox"?I:B}))},P=()=>{D({bank_name:"",bank_code:"",bank_logo:"",description:"",is_active:!0}),p(null),d(!1),g(null)},j=async U=>{if(U.preventDefault(),g(null),!S.bank_name.trim()){g("Nama bank harus diisi");return}s(!0);try{const O={...S,updated_at:new Date().toISOString()};if(h){const{error:B}=await Pe.from("bank_info").update(O).eq("id",h.id);if(B)throw B;w("Bank berhasil diperbarui!")}else{O.created_at=new Date().toISOString();const{error:B}=await Pe.from("bank_info").insert([O]);if(B)throw B;w("Bank berhasil ditambahkan!")}P(),await A(),setTimeout(()=>w(null),3e3)}catch(O){console.error("Error saving bank:",O),g("Gagal menyimpan bank: "+O.message)}finally{s(!1)}},E=U=>{D({bank_name:U.bank_name,bank_code:U.bank_code||"",bank_logo:U.bank_logo||"",description:U.description||"",is_active:U.is_active}),p(U),d(!0)},F=async U=>{if(confirm("Apakah Anda yakin ingin menghapus bank ini?")){s(!0);try{const{data:O,error:B}=await Pe.from("profiles").select("id").eq("bank_id",U).limit(1);if(B)throw B;if(O&&O.length>0){g("Bank tidak dapat dihapus karena masih digunakan oleh karyawan");return}const{error:q}=await Pe.from("bank_info").delete().eq("id",U);if(q)throw q;w("Bank berhasil dihapus!"),await A(),setTimeout(()=>w(null),3e3)}catch(O){console.error("Error deleting bank:",O),g("Gagal menghapus bank: "+O.message)}finally{s(!1)}}},z=t.filter(U=>U.bank_name.toLowerCase().includes(o.toLowerCase())||U.bank_code&&U.bank_code.toLowerCase().includes(o.toLowerCase())||U.description&&U.description.toLowerCase().includes(o.toLowerCase()));return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat data bank..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row",children:[l.jsx(eu,{user:m,profile:y,className:"w-full md:w-64 md:fixed md:h-screen"}),l.jsxs("div",{className:"flex-1 md:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kelola Bank"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tambah, edit, dan kelola daftar bank untuk pembayaran gaji"})]}),l.jsxs("button",{onClick:()=>d(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[l.jsx(tv,{className:"h-4 w-4"}),l.jsx("span",{children:"Tambah Bank"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[b&&l.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-green-700",children:b}),l.jsx("button",{onClick:()=>w(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),f&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-red-700",children:f}),l.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Rn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ya,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Bank"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx($t,{className:"h-5 w-5 text-green-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bank Aktif"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.filter(U=>U.is_active).length})]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(qu,{className:"h-5 w-5 text-purple-600"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pembayaran"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:"Transfer Bank"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(Jd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari bank...",value:o,onChange:U=>u(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ya,{className:"h-5 w-5 text-blue-600"}),l.jsxs("h2",{className:"text-base font-medium text-gray-900",children:["Daftar Bank (",z.length,")"]})]})}),i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):z.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(ya,{className:"h-8 w-8 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Tidak ada bank ditemukan"}),l.jsx("p",{className:"text-gray-400",children:"Coba sesuaikan pencarian atau tambah bank baru"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Bank"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kode Bank"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(U=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:U.bank_logo?l.jsx("img",{src:U.bank_logo,alt:U.bank_name,className:"h-6 w-6 object-contain"}):l.jsx(ya,{className:"h-4 w-4 text-blue-600"})}),l.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.bank_name})]})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(NT,{className:"h-4 w-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-900",children:U.bank_code||"-"})]})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:U.description||"-"}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>E(U),className:"text-blue-600 hover:text-blue-900 p-1 hover:bg-blue-50 rounded",title:"Edit Bank",children:l.jsx(Wi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>F(U.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",title:"Hapus Bank",children:l.jsx(Mf,{className:"h-4 w-4"})})]})})]},U.id))})]}),l.jsx("div",{className:"md:hidden p-4 space-y-4",children:z.map(U=>l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:U.bank_logo?l.jsx("img",{src:U.bank_logo,alt:U.bank_name,className:"h-6 w-6 object-contain"}):l.jsx(ya,{className:"h-4 w-4 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.bank_name}),U.description&&l.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:U.description})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>E(U),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",children:l.jsx(Wi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>F(U.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",children:l.jsx(Mf,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Kode Bank:"})," ",U.bank_code||"-"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Status:"})," ",l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${U.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.is_active?"Aktif":"Tidak Aktif"})]})]})]},U.id))})]})]})]})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md sm:max-w-lg bg-white rounded-xl shadow-lg",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:h?"Edit Bank":"Tambah Bank Baru"}),l.jsx("button",{onClick:P,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ui,{className:"h-5 w-5"})})]}),l.jsxs("form",{onSubmit:j,className:"space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Informasi Bank"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Bank *"}),l.jsx("input",{type:"text",name:"bank_name",value:S.bank_name,onChange:L,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: BCA, Mandiri, BNI"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kode Bank"}),l.jsx("input",{type:"text",name:"bank_code",value:S.bank_code,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Contoh: 014, 008, 009"})]})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL Logo Bank"}),l.jsx("input",{type:"text",name:"bank_logo",value:S.bank_logo,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"https://example.com/logo.png"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Masukkan URL gambar logo bank (opsional)"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),l.jsx("textarea",{name:"description",value:S.description,onChange:L,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Deskripsi singkat tentang bank..."})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_active",checked:S.is_active,onChange:L,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Bank aktif"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Batal"}),l.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-4 w-4"}),l.jsx("span",{children:h?"Perbarui Bank":"Simpan Bank"})]})})]})]})]})})})]})},E$=()=>{const e=wr(),[t,n]=ae.useState(null),[a,r]=ae.useState(null),[i,s]=ae.useState(!0),[o,u]=ae.useState(!1),[c,d]=ae.useState([]),[h,p]=ae.useState([]),[f,g]=ae.useState(""),[b,w]=ae.useState(""),[m,x]=ae.useState(""),[y,N]=ae.useState(""),[S,D]=ae.useState(new Date),[_,A]=ae.useState(null),[L,P]=ae.useState(null),[j,E]=ae.useState(!1),[F,z]=ae.useState({startTime:"08:00",endTime:"17:00",lateThreshold:15,earlyLeaveThreshold:15,breakDuration:60}),[U,O]=ae.useState(!1),[B,q]=ae.useState(window.innerWidth<768);ae.useEffect(()=>{const fe=()=>{q(window.innerWidth<768)};return window.addEventListener("resize",fe),()=>window.removeEventListener("resize",fe)},[]),ae.useEffect(()=>{I()},[]),ae.useEffect(()=>{t&&K()},[t]),ae.useEffect(()=>{S&&t&&H(S)},[S,t]);const I=async()=>{try{const{data:{user:fe}}=await Pe.auth.getUser();if(!fe){e("/login");return}const{data:me}=await Pe.from("profiles").select("role").eq("id",fe.id).single();if(!me||me.role!=="admin"){e("/dashboard");return}n(fe),r(me),await Promise.all([R(),H(new Date)])}catch(fe){console.error("Error checking access:",fe),e("/login")}finally{s(!1)}},K=async()=>{try{const{data:fe,error:me}=await Pe.from("system_settings").select("setting_value").eq("setting_key","work_hours").single();if(me&&me.code!=="PGRST116")throw me;fe!=null&&fe.setting_value&&z(ne=>({...ne,...fe.setting_value}))}catch(fe){console.error("Error fetching work hours settings:",fe)}},Z=async()=>{try{const{error:fe}=await Pe.from("system_settings").upsert({setting_key:"work_hours",setting_value:F,description:"Standard working hours configuration",is_enabled:!0,updated_at:new Date().toISOString()},{onConflict:"setting_key"});if(fe)throw fe;P("Pengaturan jam kerja berhasil disimpan!"),E(!1),setTimeout(()=>P(null),3e3)}catch(fe){console.error("Error saving work hours settings:",fe),A("Gagal menyimpan pengaturan jam kerja")}},R=async()=>{try{const{data:fe,error:me}=await Pe.from("profiles").select("id, name, email, employee_id, department, role, status").order("name");if(me)throw me;p(fe||[])}catch(fe){console.error("Error fetching employees:",fe)}},H=async fe=>{u(!0);try{const me=fe.toISOString().split("T")[0],ne=`${me}T00:00:00`,De=`${me}T23:59:59`,{data:Oe,error:ke}=await Pe.from("attendance").select(`
          *,
          profiles:user_id(id, name, email, employee_id, department, role, status)
        `).gte("timestamp",ne).lte("timestamp",De).order("timestamp",{ascending:!1});if(ke)throw ke;const{data:xe,error:Ae}=await Pe.from("profiles").select("id, name, email, employee_id, department, role, status").eq("status","active").neq("role","admin");if(Ae)throw Ae;const Ce=new Set(Oe.filter(We=>We.type==="masuk"&&We.status==="berhasil").map(We=>We.user_id)),He=new Date,Qe=me===He.toISOString().split("T")[0],Ze=fe<He,Je=He.getHours(),le=F.endTime?parseInt(F.endTime.split(":")[0]):17,Xe=!Qe||Qe&&Je>=le;if(Qe&&Xe||Ze){const et=xe.filter(Ke=>!Ce.has(Ke.id)&&Ke.role!=="admin").map(Ke=>({id:`absent-${Ke.id}-${me}`,user_id:Ke.id,type:"absent",timestamp:`${me}T${F.endTime||"17:00"}:00`,status:"tidak_hadir",is_late:!1,late_minutes:0,work_hours:0,overtime_hours:0,profiles:Ke,notes:"Tidak hadir - tidak melakukan absensi masuk"}));d([...Oe,...et])}else d(Oe||[])}catch(me){console.error("Error fetching attendance by date:",me),A("Gagal memuat data absensi")}finally{u(!1)}},$=fe=>{D(new Date(fe.target.value))},X=()=>{if(c.length===0)return;const me=[["Tanggal","Waktu","Karyawan","ID Karyawan","Departemen","Jenis","Status","Terlambat","Menit Terlambat","Jam Kerja","Lembur","Latitude","Longitude"],...c.map(ke=>{var He,Qe,Ze;const xe=new Date(ke.timestamp),Ae=xe.toLocaleDateString("id-ID"),Ce=xe.toLocaleTimeString("id-ID");return[Ae,Ce,((He=ke.profiles)==null?void 0:He.name)||"Unknown",((Qe=ke.profiles)==null?void 0:Qe.employee_id)||"-",((Ze=ke.profiles)==null?void 0:Ze.department)||"-",ke.type==="masuk"?"Masuk":ke.type==="keluar"?"Keluar":"Tidak Hadir",ke.status,ke.is_late?"Ya":"Tidak",ke.late_minutes||"0",ke.work_hours||"0",ke.overtime_hours||"0",ke.latitude||"",ke.longitude||""]})].map(ke=>ke.join(",")).join(`
`),ne=new Blob([me],{type:"text/csv;charset=utf-8;"}),De=document.createElement("a"),Oe=URL.createObjectURL(ne);De.setAttribute("href",Oe),De.setAttribute("download",`attendance_${S.toISOString().split("T")[0]}.csv`),document.body.appendChild(De),De.click(),document.body.removeChild(De),URL.revokeObjectURL(Oe)},W=fe=>{switch(fe){case"berhasil":return"text-green-600 bg-green-100";case"wajah_tidak_valid":return"text-red-600 bg-red-100";case"lokasi_tidak_valid":return"text-yellow-600 bg-yellow-100";case"tidak_hadir":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},ie=fe=>{switch(fe){case"berhasil":return l.jsx($t,{className:"h-4 w-4"});case"wajah_tidak_valid":case"lokasi_tidak_valid":return l.jsx(Rn,{className:"h-4 w-4"});case"tidak_hadir":return l.jsx(Rn,{className:"h-4 w-4"});default:return l.jsx(Pn,{className:"h-4 w-4"})}},ce=fe=>{switch(fe){case"berhasil":return"Berhasil";case"wajah_tidak_valid":return"Wajah Invalid";case"lokasi_tidak_valid":return"Lokasi Invalid";case"tidak_hadir":return"Tidak Hadir";default:return"Gagal"}},ue=fe=>new Date(fe).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),he=fe=>fe.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),ge=fe=>{const{name:me,value:ne}=fe.target;z(De=>({...De,[me]:ne}))},Ee=c.filter(fe=>{var ke,xe,Ae,Ce;const me=((ke=fe.profiles)==null?void 0:ke.name)&&fe.profiles.name.toLowerCase().includes(f.toLowerCase())||((xe=fe.profiles)==null?void 0:xe.email)&&fe.profiles.email.toLowerCase().includes(f.toLowerCase())||((Ae=fe.profiles)==null?void 0:Ae.employee_id)&&fe.profiles.employee_id.toLowerCase().includes(f.toLowerCase()),ne=!b||((Ce=fe.profiles)==null?void 0:Ce.department)===b,De=!m||fe.status===m,Oe=!y||fe.type===y;return me&&ne&&De&&Oe}),Te=()=>[...new Set(h.map(me=>me.department).filter(Boolean))];return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-2 text-blue-600",children:[l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4 text-base",children:"Memuat data absensi..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsx(eu,{user:t,profile:a}),l.jsxs("div",{className:"flex-1 lg:ml-64 transition-all duration-300 ease-in-out",children:[l.jsx("div",{className:"bg-white shadow-sm border-b sticky top-0 z-10",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"py-4 sm:py-6",children:l.jsxs("div",{className:"flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 truncate",children:"Kelola Absensi"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Lihat dan kelola absensi karyawan berdasarkan tanggal"})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsxs("button",{onClick:()=>E(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm min-w-[48px] h-12",children:[l.jsx(dS,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Jam Kerja"})]}),l.jsxs("button",{onClick:()=>{u(!0),H(S).finally(()=>u(!1))},className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm min-w-[48px] h-12",title:"Refresh Data",children:[l.jsx(_2,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),l.jsxs("button",{onClick:X,disabled:c.length===0,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm h-12",children:[l.jsx(cp,{className:"h-5 w-5"}),l.jsx("span",{children:"Export CSV"})]})]})]})})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[_&&l.jsxs("div",{className:"mb-4 p-4 bg-red-50 rounded-lg flex items-start space-x-3",children:[l.jsx(Pn,{className:"h-6 w-6 text-red-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-red-700 flex-1",children:_}),l.jsx("button",{onClick:()=>A(null),className:"ml-auto text-red-500 hover:text-red-700",children:l.jsx(Ui,{className:"h-5 w-5"})})]}),L&&l.jsxs("div",{className:"mb-4 p-4 bg-green-50 rounded-lg flex items-start space-x-3",children:[l.jsx($t,{className:"h-6 w-6 text-green-500 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-green-700 flex-1",children:L}),l.jsx("button",{onClick:()=>P(null),className:"ml-auto text-green-500 hover:text-green-700",children:l.jsx(Ui,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:l.jsx("div",{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ls,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Pilih Tanggal"})]}),l.jsx("input",{type:"date",value:S.toISOString().split("T")[0],onChange:$,className:"w-full sm:w-48 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[l.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-blue-50",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[l.jsx(ls,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),l.jsxs("h2",{className:"text-base sm:text-lg font-medium text-gray-900 truncate",children:["Absensi: ",he(S)]})]}),l.jsxs("div",{className:"text-sm text-gray-600 flex-shrink-0",children:[Ee.length," data"]})]})}),l.jsx("div",{className:"p-4 border-b border-gray-200 sticky top-16 z-10 bg-white",children:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Jd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Cari nama, email, ID...",value:f,onChange:fe=>g(fe.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),l.jsxs("button",{onClick:()=>O(!U),className:"flex items-center justify-between w-full px-4 py-3 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(uS,{className:"h-5 w-5"}),l.jsx("span",{children:"Filter Data"})]}),U?l.jsx(kT,{className:"h-5 w-5"}):l.jsx(ST,{className:"h-5 w-5"})]}),U&&l.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departemen"}),l.jsxs("select",{value:b,onChange:fe=>w(fe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Departemen"}),Te().map(fe=>l.jsx("option",{value:fe,children:fe},fe))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),l.jsxs("select",{value:m,onChange:fe=>x(fe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Status"}),l.jsx("option",{value:"berhasil",children:"Berhasil"}),l.jsx("option",{value:"wajah_tidak_valid",children:"Wajah Invalid"}),l.jsx("option",{value:"lokasi_tidak_valid",children:"Lokasi Invalid"}),l.jsx("option",{value:"tidak_hadir",children:"Tidak Hadir"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jenis"}),l.jsxs("select",{value:y,onChange:fe=>N(fe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[l.jsx("option",{value:"",children:"Semua Jenis"}),l.jsx("option",{value:"masuk",children:"Masuk"}),l.jsx("option",{value:"keluar",children:"Keluar"}),l.jsx("option",{value:"absent",children:"Tidak Hadir"})]})]})]})]})}),o?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"inline-flex space-x-2 text-blue-600",children:[l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-3 h-3 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}):Ee.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"hidden md:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Waktu"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jenis"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterlambatan"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lokasi"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ee.map(fe=>{var me,ne,De,Oe;return l.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-base",children:((ne=(me=fe.profiles)==null?void 0:me.name)==null?void 0:ne.charAt(0).toUpperCase())||"?"})}),l.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:((De=fe.profiles)==null?void 0:De.name)||"Unknown"}),l.jsx("div",{className:"text-xs text-gray-500 truncate",children:((Oe=fe.profiles)==null?void 0:Oe.employee_id)||"-"})]})]})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm text-gray-900",children:ue(fe.timestamp)}),l.jsx("div",{className:"text-xs text-gray-500",children:he(new Date(fe.timestamp))})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize",children:fe.type==="masuk"?"Masuk":fe.type==="keluar"?"Keluar":"Tidak Hadir"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:`inline-flex items-center space-x-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${W(fe.status)}`,children:[ie(fe.status),l.jsx("span",{children:ce(fe.status)})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:fe.is_late?l.jsx("div",{className:"text-sm text-red-600",children:l.jsxs("span",{className:"font-medium",children:["Terlambat ",fe.late_minutes," menit"]})}):l.jsx("div",{className:"text-sm text-green-600",children:l.jsx("span",{className:"font-medium",children:"Tepat Waktu"})})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:fe.latitude&&fe.longitude?l.jsxs("div",{className:"flex items-center",children:[l.jsx(qi,{className:"h-5 w-5 mr-1 text-gray-400"}),l.jsxs("span",{className:"text-xs",children:[fe.latitude.toFixed(4),", ",fe.longitude.toFixed(4)]})]}):l.jsx("span",{className:"text-gray-400 text-xs",children:"Tidak ada lokasi"})})]},fe.id)})})]})}),l.jsx("div",{className:"md:hidden space-y-4 p-4",children:Ee.map(fe=>{var me,ne,De,Oe,ke;return l.jsxs("div",{className:"bg-gray-50 rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[l.jsx("div",{className:"flex-shrink-0 h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-lg",children:((ne=(me=fe.profiles)==null?void 0:me.name)==null?void 0:ne.charAt(0).toUpperCase())||"?"})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-base font-medium text-gray-900 truncate",children:((De=fe.profiles)==null?void 0:De.name)||"Unknown"}),l.jsxs("p",{className:"text-sm text-gray-500 truncate",children:[((Oe=fe.profiles)==null?void 0:Oe.employee_id)||"-"," • ",((ke=fe.profiles)==null?void 0:ke.department)||"-"]})]})]}),l.jsxs("div",{className:"text-right flex-shrink-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-800 whitespace-nowrap",children:ue(fe.timestamp)}),l.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap",children:he(new Date(fe.timestamp))})]})]}),l.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[l.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-sm font-medium ${W(fe.status)}`,children:[ie(fe.status),l.jsx("span",{className:"ml-1",children:ce(fe.status)})]}),l.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 capitalize",children:fe.type==="masuk"?"Masuk":fe.type==="keluar"?"Keluar":"Tidak Hadir"})]}),l.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[l.jsx("div",{children:fe.is_late?l.jsxs("p",{className:"text-sm text-red-600",children:["Terlambat ",fe.late_minutes," menit"]}):l.jsx("p",{className:"text-sm text-green-600",children:"Tepat Waktu"})}),fe.latitude&&fe.longitude&&l.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[l.jsx(qi,{className:"h-4 w-4 mr-1"}),l.jsxs("span",{children:[fe.latitude.toFixed(2),", ",fe.longitude.toFixed(2)]})]})]})]},fe.id)})})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Bl,{className:"h-10 w-10 text-gray-400"})}),l.jsx("p",{className:"text-gray-500 text-lg",children:"Tidak ada data absensi pada tanggal ini"})]})]})]})]}),j&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pengaturan Jam Kerja"}),l.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ui,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Masuk"}),l.jsx("input",{type:"time",name:"startTime",value:F.startTime,onChange:ge,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Keluar"}),l.jsx("input",{type:"time",name:"endTime",value:F.endTime,onChange:ge,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toleransi Keterlambatan (menit)"}),l.jsx("input",{type:"number",name:"lateThreshold",value:F.lateThreshold,onChange:ge,min:"0",max:"60",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Karyawan dianggap terlambat jika masuk setelah jam masuk + toleransi"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toleransi Pulang Cepat (menit)"}),l.jsx("input",{type:"number",name:"earlyLeaveThreshold",value:F.earlyLeaveThreshold,onChange:ge,min:"0",max:"60",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Karyawan dianggap pulang cepat jika keluar sebelum jam keluar - toleransi"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durasi Istirahat (menit)"}),l.jsx("input",{type:"number",name:"breakDuration",value:F.breakDuration,onChange:ge,min:"0",max:"120",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(vo,{className:"h-5 w-5 text-blue-600"}),l.jsx("h3",{className:"font-medium text-blue-900 text-base",children:"Pengaturan Absensi Otomatis"})]}),l.jsx("p",{className:"text-sm text-blue-700",children:'Sistem akan otomatis menandai karyawan sebagai "Tidak Hadir" jika:'}),l.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1 pl-5 list-disc",children:[l.jsx("li",{children:"Sudah melewati jam keluar kerja"}),l.jsx("li",{children:"Tidak ada catatan absensi masuk pada hari tersebut"}),l.jsx("li",{children:"Karyawan berstatus aktif (bukan admin)"})]})]}),l.jsxs("div",{className:"flex space-x-4 pt-4",children:[l.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Batal"}),l.jsx("button",{onClick:Z,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors text-sm",children:l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(di,{className:"h-5 w-5"}),l.jsx("span",{children:"Simpan"})]})})]})]})]})})})]})},D$=ae.createContext(),T$={id:{loading:"Memuat...",save:"Simpan",cancel:"Batal",edit:"Edit",delete:"Hapus",add:"Tambah",search:"Cari",filter:"Filter",back:"Kembali",next:"Selanjutnya",previous:"Sebelumnya",submit:"Kirim",close:"Tutup",confirm:"Konfirmasi",success:"Berhasil",error:"Error",warning:"Peringatan",info:"Informasi",note:"Catatan",notSet:"Belum diatur",from:"dari",days:"hari",minutes:"menit",hours:"jam",office:"Kantor",login:"Masuk",logout:"Keluar",register:"Daftar",email:"Email",password:"Password",confirmPassword:"Konfirmasi Password",forgotPassword:"Lupa Password",rememberMe:"Ingat Saya",loginTitle:"Portal Karyawan",loginSubtitle:"Masuk untuk mengakses sistem absensi",registerTitle:"Daftar Akun Baru",welcomeBack:"Selamat Datang Kembali",createAccount:"Buat Akun Baru",emailPlaceholder:"Masukkan email Anda",passwordPlaceholder:"Masukkan password Anda",loggingIn:"Sedang Masuk...",registerSuccess:"Pendaftaran Berhasil!",noAccount:"Belum punya akun?",registerHere:"Daftar di sini",demoInfo:"Info",demoDescription:"Pilih role sesuai akses yang diinginkan saat mendaftar",dashboard:"Dashboard",welcome:"Selamat Datang",todayAttendance:"Absensi Hari Ini",monthlyStats:"Statistik Bulanan",recentActivity:"Aktivitas Terbaru",quickActions:"Aksi Cepat",quickAccess:"Akses Manajemen",monthlyAttendance:"Hadir Bulan Ini",onTime:"Tepat Waktu",late:"Terlambat",monthlySalary:"Gaji Bulan Ini",dailySalary:"Gaji Harian",perWorkDay:"per hari kerja",noAttendanceToday:"Belum ada absensi hari ini",attendNow:"Absen Sekarang",noActivity:"Belum ada aktivitas",moreWarnings:"peringatan lainnya",activeWarnings:"Peringatan Aktif",attendance:"Absensi",checkIn:"Masuk",checkOut:"Keluar",attendanceHistory:"Riwayat Absensi",attendanceReport:"Laporan Absensi",lateArrival:"Terlambat",absent:"Tidak Hadir",present:"Hadir",workHours:"Jam Kerja",overtime:"Lembur",faceVerification:"Verifikasi Wajah",locationVerification:"Verifikasi Lokasi",attendanceSummary:"Ringkasan Kehadiran",employees:"Karyawan",employee:"Karyawan",employeeManagement:"Kelola Karyawan",addEmployee:"Tambah Karyawan",editEmployee:"Edit Karyawan",employeeDetails:"Detail Karyawan",personalInfo:"Informasi Pribadi",employmentInfo:"Informasi Pekerjaan",bankingInfo:"Informasi Bank",fullName:"Nama Lengkap",phoneNumber:"Nomor Telepon",address:"Alamat",birthDate:"Tanggal Lahir",gender:"Jenis Kelamin",male:"Laki-laki",female:"Perempuan",position:"Jabatan",department:"Departemen",salary:"Gaji",joinDate:"Tanggal Bergabung",status:"Status",active:"Aktif",inactive:"Tidak Aktif",terminated:"Diberhentikan",bankName:"Nama Bank",bankAccountNumber:"Nomor Rekening",bankAccountName:"Nama Pemegang Rekening",salaryManagement:"Kelola Gaji",positionManagement:"Kelola Jabatan",positions:"Jabatan",addPosition:"Tambah Jabatan",editPosition:"Edit Jabatan",baseSalary:"Gaji Pokok",minSalary:"Gaji Minimum",maxSalary:"Gaji Maksimum",salaryRange:"Rentang Gaji",bonus:"Bonus",deduction:"Potongan",netSalary:"Gaji Bersih",salaryInfo:"Informasi Gaji",settings:"Pengaturan",systemSettings:"Pengaturan Sistem",attendanceSettings:"Pengaturan Absensi",locationSettings:"Pengaturan Lokasi",workingHours:"Jam Kerja",workStartTime:"Jam Masuk",workEndTime:"Jam Keluar",lateThreshold:"Batas Terlambat",earlyLeaveThreshold:"Batas Pulang Cepat",breakDuration:"Durasi Istirahat",officeLocation:"Lokasi Kantor",allowedRadius:"Radius Diizinkan",language:"Bahasa",indonesian:"Bahasa Indonesia",english:"English",systemSettingsDesc:"Kelola lokasi kantor dan radius",reports:"Laporan",salaryReport:"Laporan Gaji",employeeReport:"Laporan Karyawan",exportReport:"Export Laporan",dateRange:"Rentang Tanggal",startDate:"Tanggal Mulai",endDate:"Tanggal Selesai",reportsDesc:"Lihat dan export laporan kehadiran",profile:"Profil",myProfile:"Profil Saya",editProfile:"Edit Profil",changePassword:"Ubah Password",currentPassword:"Password Saat Ini",newPassword:"Password Baru",profilePicture:"Foto Profil",uploadPhoto:"Upload Foto",adminPanel:"Panel Admin",adminRole:"Administrator",employeeRole:"Karyawan",adminDescription:"Kelola semua pengguna dan sistem",employeeDescription:"Absensi pribadi dan riwayat",userManagement:"Kelola Karyawan",userManagementDesc:"Tambah, edit, dan kelola data karyawan",systemLogs:"Log Sistem",activityLogs:"Log Aktivitas",passwordChanges:"Perubahan Password",systemHealth:"Kesehatan Sistem",backupRestore:"Backup & Restore",faceRegistration:"Lengkapi Profil",faceCapture:"Ambil Foto Wajah",faceDetected:"Wajah Terdeteksi",faceNotDetected:"Wajah Tidak Terdeteksi",faceQuality:"Kualitas Wajah",retakePhoto:"Ambil Ulang Foto",faceRegistered:"Wajah Terdaftar",faceNotRegistered:"Profil Belum Lengkap",faceRegistrationRequired:"Anda perlu menambahkan foto wajah untuk dapat melakukan absensi dengan verifikasi wajah.",faceRegistrationDesc:"Untuk dapat melakukan absensi dengan verifikasi wajah, Anda perlu menambahkan foto wajah ke profil.",faceRegistrationNote:"Tanpa foto wajah, Anda tidak dapat melakukan absensi dengan verifikasi keamanan.",registerFace:"Setup Foto Wajah",currentLocation:"Lokasi Saat Ini",officeRadius:"Radius Kantor",insideOfficeArea:"Dalam Area Kantor",outsideOfficeArea:"Di Luar Area Kantor",locationAccuracy:"Akurasi Lokasi",gpsEnabled:"GPS Aktif",gpsDisabled:"GPS Tidak Aktif"},en:{loading:"Loading...",save:"Save",cancel:"Cancel",edit:"Edit",delete:"Delete",add:"Add",search:"Search",filter:"Filter",back:"Back",next:"Next",previous:"Previous",submit:"Submit",close:"Close",confirm:"Confirm",success:"Success",error:"Error",warning:"Warning",info:"Information",note:"Note",notSet:"Not Set",from:"from",days:"days",minutes:"minutes",hours:"hours",office:"Office",login:"Login",logout:"Logout",register:"Register",email:"Email",password:"Password",confirmPassword:"Confirm Password",forgotPassword:"Forgot Password",rememberMe:"Remember Me",loginTitle:"Employee Portal",loginSubtitle:"Login to access attendance system",registerTitle:"Create New Account",welcomeBack:"Welcome Back",createAccount:"Create New Account",emailPlaceholder:"Enter your email",passwordPlaceholder:"Enter your password",loggingIn:"Logging in...",registerSuccess:"Registration Successful!",noAccount:"Don't have an account?",registerHere:"Register here",demoInfo:"Info",demoDescription:"Choose role according to desired access when registering",dashboard:"Dashboard",welcome:"Welcome",todayAttendance:"Today's Attendance",monthlyStats:"Monthly Statistics",recentActivity:"Recent Activity",quickActions:"Quick Actions",quickAccess:"Management Access",monthlyAttendance:"Monthly Attendance",onTime:"On Time",late:"Late",monthlySalary:"Monthly Salary",dailySalary:"Daily Salary",perWorkDay:"per work day",noAttendanceToday:"No attendance today",attendNow:"Attend Now",noActivity:"No activity",moreWarnings:"more warnings",activeWarnings:"Active Warnings",attendance:"Attendance",checkIn:"Check In",checkOut:"Check Out",attendanceHistory:"Attendance History",attendanceReport:"Attendance Report",lateArrival:"Late",absent:"Absent",present:"Present",workHours:"Work Hours",overtime:"Overtime",faceVerification:"Face Verification",locationVerification:"Location Verification",attendanceSummary:"Attendance Summary",employees:"Employees",employee:"Employee",employeeManagement:"Employee Management",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",bankingInfo:"Banking Information",fullName:"Full Name",phoneNumber:"Phone Number",address:"Address",birthDate:"Birth Date",gender:"Gender",male:"Male",female:"Female",position:"Position",department:"Department",salary:"Salary",joinDate:"Join Date",status:"Status",active:"Active",inactive:"Inactive",terminated:"Terminated",bankName:"Bank Name",bankAccountNumber:"Account Number",bankAccountName:"Account Holder Name",salaryManagement:"Salary Management",positionManagement:"Position Management",positions:"Positions",addPosition:"Add Position",editPosition:"Edit Position",baseSalary:"Base Salary",minSalary:"Minimum Salary",maxSalary:"Maximum Salary",salaryRange:"Salary Range",bonus:"Bonus",deduction:"Deduction",netSalary:"Net Salary",salaryInfo:"Salary Information",settings:"Settings",systemSettings:"System Settings",attendanceSettings:"Attendance Settings",locationSettings:"Location Settings",workingHours:"Working Hours",workStartTime:"Work Start Time",workEndTime:"Work End Time",lateThreshold:"Late Threshold",earlyLeaveThreshold:"Early Leave Threshold",breakDuration:"Break Duration",officeLocation:"Office Location",allowedRadius:"Allowed Radius",language:"Language",indonesian:"Bahasa Indonesia",english:"English",systemSettingsDesc:"Manage office location and radius",reports:"Reports",salaryReport:"Salary Report",employeeReport:"Employee Report",exportReport:"Export Report",dateRange:"Date Range",startDate:"Start Date",endDate:"End Date",reportsDesc:"View and export attendance reports",profile:"Profile",myProfile:"My Profile",editProfile:"Edit Profile",changePassword:"Change Password",currentPassword:"Current Password",newPassword:"New Password",profilePicture:"Profile Picture",uploadPhoto:"Upload Photo",adminPanel:"Admin Panel",adminRole:"Administrator",employeeRole:"Employee",adminDescription:"Manage all users and system",employeeDescription:"Personal attendance and history",userManagement:"User Management",userManagementDesc:"Add, edit, and manage employee data",systemLogs:"System Logs",activityLogs:"Activity Logs",passwordChanges:"Password Changes",systemHealth:"System Health",backupRestore:"Backup & Restore",faceRegistration:"Complete Profile",faceCapture:"Capture Face",faceDetected:"Face Detected",faceNotDetected:"Face Not Detected",faceQuality:"Face Quality",retakePhoto:"Retake Photo",faceRegistered:"Face Registered",faceNotRegistered:"Profile Incomplete",faceRegistrationRequired:"You need to add a face photo to perform attendance with face verification.",faceRegistrationDesc:"To perform attendance with face verification, you need to add a face photo to your profile.",faceRegistrationNote:"Without a face photo, you cannot perform attendance with security verification.",registerFace:"Setup Face Photo",currentLocation:"Current Location",officeRadius:"Office Radius",insideOfficeArea:"Inside Office Area",outsideOfficeArea:"Outside Office Area",locationAccuracy:"Location Accuracy",gpsEnabled:"GPS Enabled",gpsDisabled:"GPS Disabled"}},L$=({children:e})=>{const[t,n]=ae.useState("id");ae.useEffect(()=>{const s=localStorage.getItem("language");s&&["id","en"].includes(s)&&n(s)},[]);const a=s=>{["id","en"].includes(s)&&(n(s),localStorage.setItem("language",s))},r=Fg.useCallback(s=>{var o;return((o=T$[t])==null?void 0:o[s])||s},[t]),i=Fg.useMemo(()=>({language:t,changeLanguage:a,t:r,isIndonesian:t==="id",isEnglish:t==="en"}),[t,r]);return l.jsx(D$.Provider,{value:i,children:e})};function P$(){return l.jsx(L$,{children:l.jsx("div",{className:"flex flex-col min-h-screen",children:l.jsx(hT,{children:l.jsx(R$,{})})})})}function R$(){const[e,t]=ae.useState(null),[n,a]=ae.useState(!0),[r,i]=ae.useState(null),s=S2(),o=wr();ae.useEffect(()=>{Pe.auth.getSession().then(({data:{session:d},error:h})=>{h?(console.error("Session error:",h),Pe.auth.signOut(),t(null)):(t(d),d&&u(d.user.id)),a(!1)}).catch(d=>{console.error("Unexpected session error:",d),Pe.auth.signOut(),t(null),a(!1)});const{data:{subscription:c}}=Pe.auth.onAuthStateChange((d,h)=>{t(h),h?u(h.user.id):i(null)});return()=>c.unsubscribe()},[]),ae.useEffect(()=>{!["/login","/register","/dashboard","/profile-setup","/history","/admin","/admin/users","/admin/departments","/admin/positions","/admin/salary-payment","/admin/location","/admin/bank","/admin/attendance","/"].some(h=>s.pathname===h||h!=="/"&&s.pathname.startsWith(h+"/"))&&!n&&o(e?r==="admin"?"/admin":"/dashboard":"/login")},[s.pathname,n,e,r,o]);const u=async c=>{try{const{data:d,error:h}=await Pe.from("profiles").select("role").eq("id",c).single();if(h)throw h;i(d.role)}catch(d){console.error("Error fetching user role:",d),i(null)}};return n?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex space-x-1 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Memuat aplikasi..."})]})}):l.jsx("div",{className:"flex flex-col flex-1",children:l.jsxs(fT,{children:[l.jsx(vr,{path:"/login",element:e?r==="admin"?l.jsx(Vn,{to:"/admin",replace:!0}):l.jsx(Vn,{to:"/dashboard",replace:!0}):l.jsx($8,{})}),l.jsx(vr,{path:"/register",element:e?r==="admin"?l.jsx(Vn,{to:"/admin",replace:!0}):l.jsx(Vn,{to:"/dashboard",replace:!0}):l.jsx(Kq,{})}),l.jsx(vr,{path:"/dashboard",element:e?r==="admin"?l.jsx(Vn,{to:"/admin",replace:!0}):l.jsx(pG,{}):l.jsx(Vn,{to:"/login",replace:!0})}),l.jsx(vr,{path:"/profile-setup",element:e?l.jsx(_$,{}):l.jsx(Vn,{to:"/login",replace:!0})}),l.jsx(vr,{path:"/history",element:e?l.jsx(rD,{}):l.jsx(Vn,{to:"/login",replace:!0})}),l.jsx(vr,{path:"/admin",element:e&&r==="admin"?l.jsx(x$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/users",element:e&&r==="admin"?l.jsx(y$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/departments",element:e&&r==="admin"?l.jsx(k$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/positions",element:e&&r==="admin"?l.jsx(S$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/salary-payment",element:e&&r==="admin"?l.jsx(N$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/location",element:e&&r==="admin"?l.jsx(C$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/bank",element:e&&r==="admin"?l.jsx(A$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/admin/attendance",element:e&&r==="admin"?l.jsx(E$,{}):l.jsx(Vn,{to:e?"/dashboard":"/login",replace:!0})}),l.jsx(vr,{path:"/",element:e?r==="admin"?l.jsx(Vn,{to:"/admin",replace:!0}):l.jsx(Vn,{to:"/dashboard",replace:!0}):l.jsx(Vn,{to:"/login",replace:!0})}),l.jsx(vr,{path:"*",element:e?r==="admin"?l.jsx(Vn,{to:"/admin",replace:!0}):l.jsx(Vn,{to:"/dashboard",replace:!0}):l.jsx(Vn,{to:"/login",replace:!0})})]})})}tR.createRoot(document.getElementById("root")).render(l.jsx(ae.StrictMode,{children:l.jsx(P$,{})}));export{kO as R,hn as _,Sv as a};
